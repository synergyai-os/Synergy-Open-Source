---
alwaysApply: false
---

# üö® DESIGN TOKEN ENFORCEMENT (MANDATORY)

**This rule is AUTOMATICALLY loaded for EVERY .svelte file you edit.**

**NO EXCEPTIONS. NO SPECIAL CASES. NO "BUT THIS TIME..."**

---

## ‚õî HARD RULE #1: NO Hardcoded Values

### ‚ùå FORBIDDEN (Violations will be REJECTED):

**Pixel/rem values as strings:**

```svelte
width="1rem" // ‚ùå REJECTED height="32px" // ‚ùå REJECTED const size = '1rem'; // ‚ùå REJECTED const
dims = '2rem'; // ‚ùå REJECTED
```

**Hex colors:**

```svelte
color="#3b82f6" // ‚ùå REJECTED bg-[#000000] // ‚ùå REJECTED const color = '#fff'; // ‚ùå REJECTED
```

**Decimal opacity:**

```svelte
opacity: 0.5 // ‚ùå REJECTED const alpha = 0.75; // ‚ùå REJECTED
```

**Raw Tailwind utilities:**

```svelte
class="px-4 py-2" // ‚ùå REJECTED class="text-2xl" // ‚ùå REJECTED class="rounded-lg" // ‚ùå REJECTED
class="gap-2" // ‚ùå REJECTED
```

---

### ‚úÖ REQUIRED (Token References ONLY):

**Utility classes (reference tokens):**

```svelte
class="w-icon-sm h-icon-sm" // ‚úÖ Uses var(--size-icon-sm) class="px-button-x py-button-y" // ‚úÖ
Uses var(--spacing-button-x) class="bg-accent-primary" // ‚úÖ Uses var(--color-accent-primary)
class="opacity-disabled" // ‚úÖ Uses var(--opacity-disabled) class="font-heading" // ‚úÖ Uses
var(--fonts-heading)
```

**CSS custom properties (direct references):**

```svelte
<div style="width: var(--size-icon-sm)">      // ‚úÖ Direct token reference
<div style="padding: var(--spacing-button-x)"> // ‚úÖ Direct token reference
```

---

## ‚õî HARD RULE #2: "Matching Values" ‚â† "Using Tokens"

### The #1 Mistake Agents Make:

**‚ùå WRONG thinking:**

```
Token: --size-icon-sm = 1rem
Agent: "I'll use 1rem - it matches the token!" ‚Üê THIS IS HARDCODING
Result: Cascade BROKEN (changing token won't update code)
```

**‚úÖ CORRECT thinking:**

```
Token: --size-icon-sm = 1rem
Agent: "I'll use w-icon-sm utility - it REFERENCES the token"
Result: Cascade WORKS (changing token updates all code automatically)
```

### Real Example from Production:

**‚ùå Agent wrote (REJECTED):**

```svelte
// Agent thought: "These match the token values!" const dimensions = $derived( size === 'sm' ?
'1rem' : size === 'lg' ? '3rem' : '2rem' ); // ‚ùå HARDCODED - Cascade broken, violates design system
```

**‚úÖ Should have been:**

```svelte
// References tokens via CSS classes const sizeClasses = $derived( size === 'sm' ? 'w-icon-sm
h-icon-sm' : size === 'lg' ? 'w-icon-lg h-icon-lg' : 'w-icon-md h-icon-md' ); // ‚úÖ Uses tokens -
Cascade works, design system maintained
```

---

## ‚õî HARD RULE #3: SVG Has NO Special Exception

### Agent Rationalizations (ALL REJECTED):

‚ùå "SVG attributes need actual values"
‚ùå "CSS custom properties don't work in SVG"
‚ùå "This is a special case"
‚ùå "I'll hardcode just this once"

### The Truth:

‚úÖ CSS `width`/`height` properties work on `<svg>` elements
‚úÖ Utility classes apply to SVG just like any other element
‚úÖ There are ZERO special cases - use tokens ALWAYS

### Real Example from Production:

**‚ùå Agent rationalized (REJECTED):**

```svelte
<!-- Agent thought: "SVG needs attributes with values" -->
<svg width="1rem" height="1rem">
	<!-- ‚ùå HARDCODED - Agent broke cascade -->
</svg>
```

**‚úÖ Correct approach:**

```svelte
<!-- CSS classes work perfectly on SVG -->
<svg class="w-icon-sm h-icon-sm animate-spin">
	<!-- ‚úÖ Uses tokens - Cascade maintained -->
</svg>
```

---

## üéØ The Cascade Test (Use BEFORE Writing Code)

**Ask yourself:**

> "If I change `--size-icon-sm` from `1rem` to `1.5rem` in design-system.json, will this code update automatically?"

**Examples:**

```svelte
<!-- TEST: Change --size-icon-sm from 1rem to 1.5rem -->

<!-- ‚ùå FAILS: Hardcoded value stays 1rem -->
<svg width="1rem" height="1rem">

<!-- ‚ùå FAILS: String value stays 1rem -->
const dimensions = '1rem';

<!-- ‚úÖ PASSES: Automatically updates to 1.5rem -->
<svg class="w-icon-sm h-icon-sm">

<!-- ‚úÖ PASSES: Automatically updates to 1.5rem -->
<div style="width: var(--size-icon-sm)">
```

**If cascade test FAILS ‚Üí You're hardcoding ‚Üí FIX IT before writing code**

---

## üìã Token Utility Quick Reference

### Sizes (NOT hardcoded px/rem):

```svelte
‚úÖ w-icon-sm, h-icon-md, w-icon-lg ‚ùå width="1rem", height="32px", w-[16px]
```

### Spacing (NOT raw Tailwind):

```svelte
‚úÖ px-button-x, py-button-y, gap-icon ‚ùå px-4, py-2, gap-2
```

### Colors (NOT hex/named colors):

```svelte
‚úÖ bg-accent-primary, text-primary, border-base ‚ùå bg-blue-600, text-white, bg-[#3b82f6]
```

### Opacity (NOT decimal values):

```svelte
‚úÖ opacity-disabled, opacity-hover, opacity-backdrop ‚ùå opacity-50, opacity: 0.5, bg-*/50
```

### Fonts (NOT base tokens):

```svelte
‚úÖ font-heading, font-body, font-code ‚ùå font-sans, font-mono (these are base, use semantic)
```

### Border Radius (NOT raw Tailwind):

```svelte
‚úÖ rounded-button, rounded-card, rounded-input ‚ùå rounded-md, rounded-lg, rounded-xl
```

### Breakpoints (Tailwind responsive utilities OK):

```svelte
‚úÖ md:grid-cols-3, lg:px-content-padding ‚ùå @media (min-width: 768px), hardcoded breakpoints
```

---

## üö® ENFORCEMENT PROCESS

### Step 1: BEFORE Writing Code

1. Run cascade test mentally for EVERY value
2. If value is literal (`'1rem'`, `'#fff'`, `0.5`) ‚Üí STOP, use token
3. If value matches token ‚Üí Still STOP, reference token instead

### Step 2: DURING Implementation

1. After writing code, run: `npm run tokens:validate`
2. If violations found ‚Üí FIX immediately, don't continue
3. Validate again until clean

### Step 3: BEFORE Committing

1. Run: `npm run lint`
2. If design token violations ‚Üí REJECTED, fix first
3. Pre-commit hook will enforce this

---

## ‚ö†Ô∏è Common Agent Mistakes (Learn from These)

### Mistake #1: "Values match tokens"

**Agent wrote:**

```svelte
size === 'sm' ? '1rem' : '2rem' // "These match --size-icon-sm/md!"
```

**Why rejected:** Hardcoded strings, cascade broken
**Correct:** `size === 'sm' ? 'w-icon-sm' : 'w-icon-md'`

### Mistake #2: "SVG needs attributes"

**Agent wrote:**

```svelte
<svg width="1rem">  // "SVG attributes need values!"
```

**Why rejected:** CSS classes work on SVG, no exceptions
**Correct:** `<svg class="w-icon-sm h-icon-sm">`

### Mistake #3: "Just this once"

**Agent wrote:**

```svelte
const spacing = '8px'; // "Quick fix, will refactor later"
```

**Why rejected:** "Later" never happens, use tokens NOW
**Correct:** `class="gap-icon"` (uses var(--spacing-icon))

### Mistake #4: "Base tokens are fine"

**Agent wrote:**

```svelte
class="font-sans" // "It's a token!"
```

**Why rejected:** Base token, not semantic (no component context)
**Correct:** `class="font-heading"` (semantic, clear usage)

---

## üìñ Where to Find Tokens

**Complete catalog:** `dev-docs/2-areas/design/design-tokens.md`

**Quick search:**

```bash
# Find available size tokens
grep "size-icon" dev-docs/2-areas/design/design-tokens.md

# Find spacing tokens
grep "spacing-button" dev-docs/2-areas/design/design-tokens.md

# Find color tokens
grep "bg-accent" dev-docs/2-areas/design/design-tokens.md
```

**Can't find a token?**

1. Check `dev-docs/2-areas/design/design-tokens.md` FIRST
2. If truly missing ‚Üí Ask user to add it to design-system.json
3. NEVER hardcode as workaround

---

## üéØ Remember

**This is NOT guidance - this is ENFORCEMENT.**

- ‚ùå Writing literal values ‚Üí Code will be REJECTED
- ‚ùå Rationalizing "special cases" ‚Üí REJECTED
- ‚ùå "Matching" token values ‚Üí Still REJECTED (must reference)
- ‚úÖ Using token utilities/references ‚Üí APPROVED

**NO exceptions. NO special cases. NO "but this time..."**

**Use tokens or don't commit. Period.**

---

**Last Updated**: 2025-11-22
**Purpose**: Automatic enforcement of design token usage in ALL Svelte files
**Severity**: CRITICAL - Violations block commits
