=== NEW TEST RUN: 2025-11-15T21:27:32.917Z ===
[2025-11-15T21:27:32.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:32.922Z] Request URL: /auth/login
[2025-11-15T21:27:32.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:32.922Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.922Z] Will use test ID?: true
[2025-11-15T21:27:32.923Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:32.923Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:32.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:32.923Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Current count after filter: 0
[2025-11-15T21:27:32.923Z] Max requests allowed: 5
[2025-11-15T21:27:32.923Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:32.923Z] New count: 1
[2025-11-15T21:27:32.923Z] Remaining: 4
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:32.923Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.090Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.090Z] Request URL: /auth/login
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.090Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Will use test ID?: true
[2025-11-15T21:27:33.090Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.090Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.090Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Current count after filter: 0
[2025-11-15T21:27:33.090Z] Max requests allowed: 5
[2025-11-15T21:27:33.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.090Z] New count: 1
[2025-11-15T21:27:33.090Z] Remaining: 4
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113090
}
[2025-11-15T21:27:33.145Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.145Z] Request URL: /auth/login
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.145Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] Will use test ID?: true
[2025-11-15T21:27:33.145Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.146Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.146Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.146Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Current count after filter: 0
[2025-11-15T21:27:33.146Z] Max requests allowed: 5
[2025-11-15T21:27:33.146Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.146Z] New count: 1
[2025-11-15T21:27:33.146Z] Remaining: 4
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.146Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113146
}
[2025-11-15T21:27:33.147Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.147Z] Request URL: /auth/login
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.147Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Will use test ID?: true
[2025-11-15T21:27:33.147Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.147Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.147Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.147Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Existing timestamps: 1
[2025-11-15T21:27:33.147Z] Current count after filter: 1
[2025-11-15T21:27:33.147Z] Max requests allowed: 5
[2025-11-15T21:27:33.147Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.147Z] New count: 2
[2025-11-15T21:27:33.147Z] Remaining: 3
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.147Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.226Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.226Z] Request URL: /auth/register
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.226Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Will use test ID?: true
[2025-11-15T21:27:33.226Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.226Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.226Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.226Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Current count after filter: 0
[2025-11-15T21:27:33.226Z] Max requests allowed: 3
[2025-11-15T21:27:33.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.226Z] New count: 1
[2025-11-15T21:27:33.226Z] Remaining: 2
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.227Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113226
}
[2025-11-15T21:27:33.234Z] üßπ clearRateLimits: Cleared 4 entries from rate limit store
[2025-11-15T21:27:33.237Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.237Z] Request URL: /auth/login
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.237Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Will use test ID?: true
[2025-11-15T21:27:33.237Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.237Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.237Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.237Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] üìù Creating new entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Current count after filter: 0
[2025-11-15T21:27:33.237Z] Max requests allowed: 5
[2025-11-15T21:27:33.237Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.237Z] New count: 1
[2025-11-15T21:27:33.237Z] Remaining: 4
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.237Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.380Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.380Z] Request URL: /auth/login
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.380Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] Will use test ID?: true
[2025-11-15T21:27:33.380Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.381Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.381Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Current count after filter: 0
[2025-11-15T21:27:33.381Z] Max requests allowed: 5
[2025-11-15T21:27:33.381Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.381Z] New count: 1
[2025-11-15T21:27:33.381Z] Remaining: 4
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.381Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.394Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.394Z] Request URL: /auth/login
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.394Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Will use test ID?: true
[2025-11-15T21:27:33.394Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.394Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.394Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.394Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Current count after filter: 0
[2025-11-15T21:27:33.394Z] Max requests allowed: 5
[2025-11-15T21:27:33.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.394Z] New count: 1
[2025-11-15T21:27:33.394Z] Remaining: 4
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.395Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.421Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.421Z] Request URL: /auth/login
[2025-11-15T21:27:33.421Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.421Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Will use test ID?: true
[2025-11-15T21:27:33.422Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.422Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.422Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.422Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Current count after filter: 0
[2025-11-15T21:27:33.422Z] Max requests allowed: 5
[2025-11-15T21:27:33.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.422Z] New count: 1
[2025-11-15T21:27:33.422Z] Remaining: 4
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.422Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.590Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.590Z] Request URL: /auth/register
[2025-11-15T21:27:33.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.590Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Will use test ID?: true
[2025-11-15T21:27:33.591Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.591Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.591Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.591Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Current count after filter: 0
[2025-11-15T21:27:33.591Z] Max requests allowed: 3
[2025-11-15T21:27:33.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.591Z] New count: 1
[2025-11-15T21:27:33.591Z] Remaining: 2
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.608Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.608Z] Request URL: /auth/login
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.608Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Will use test ID?: true
[2025-11-15T21:27:33.608Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.608Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.608Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Existing timestamps: 1
[2025-11-15T21:27:33.608Z] Current count after filter: 1
[2025-11-15T21:27:33.608Z] Max requests allowed: 5
[2025-11-15T21:27:33.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.608Z] New count: 2
[2025-11-15T21:27:33.609Z] Remaining: 3
[2025-11-15T21:27:33.609Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.609Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.614Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.614Z] Request URL: /auth/login
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.614Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] Will use test ID?: true
[2025-11-15T21:27:33.614Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.614Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.615Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.615Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Existing timestamps: 1
[2025-11-15T21:27:33.615Z] Current count after filter: 1
[2025-11-15T21:27:33.615Z] Max requests allowed: 5
[2025-11-15T21:27:33.615Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.615Z] New count: 2
[2025-11-15T21:27:33.615Z] Remaining: 3
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.615Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.643Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.643Z] Request URL: /auth/login
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.643Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] Will use test ID?: true
[2025-11-15T21:27:33.643Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.644Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.644Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.644Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Existing timestamps: 1
[2025-11-15T21:27:33.644Z] Current count after filter: 1
[2025-11-15T21:27:33.644Z] Max requests allowed: 5
[2025-11-15T21:27:33.644Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.644Z] New count: 2
[2025-11-15T21:27:33.644Z] Remaining: 3
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.644Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.694Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.694Z] Request URL: /auth/login
[2025-11-15T21:27:33.694Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.694Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] Will use test ID?: true
[2025-11-15T21:27:33.695Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.695Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.696Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.696Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Existing timestamps: 1
[2025-11-15T21:27:33.696Z] Current count after filter: 1
[2025-11-15T21:27:33.696Z] Max requests allowed: 5
[2025-11-15T21:27:33.696Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.696Z] New count: 2
[2025-11-15T21:27:33.696Z] Remaining: 3
[2025-11-15T21:27:33.696Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.696Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.913Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.913Z] Request URL: /auth/login
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.914Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Will use test ID?: true
[2025-11-15T21:27:33.914Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.914Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.914Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.914Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.919Z] Existing timestamps: 2
[2025-11-15T21:27:33.919Z] Current count after filter: 2
[2025-11-15T21:27:33.920Z] Max requests allowed: 5
[2025-11-15T21:27:33.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.920Z] New count: 3
[2025-11-15T21:27:33.920Z] Remaining: 2
[2025-11-15T21:27:33.920Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.920Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.922Z] Request URL: /auth/login
[2025-11-15T21:27:33.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.922Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Will use test ID?: true
[2025-11-15T21:27:33.923Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.923Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.923Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Existing timestamps: 2
[2025-11-15T21:27:33.923Z] Current count after filter: 2
[2025-11-15T21:27:33.923Z] Max requests allowed: 5
[2025-11-15T21:27:33.924Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.924Z] New count: 3
[2025-11-15T21:27:33.924Z] Remaining: 2
[2025-11-15T21:27:33.924Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.924Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.929Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.929Z] Request URL: /auth/login
[2025-11-15T21:27:33.929Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.931Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Will use test ID?: true
[2025-11-15T21:27:33.931Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.931Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.931Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.931Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.933Z] Existing timestamps: 2
[2025-11-15T21:27:33.933Z] Current count after filter: 2
[2025-11-15T21:27:33.933Z] Max requests allowed: 5
[2025-11-15T21:27:33.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.934Z] New count: 3
[2025-11-15T21:27:33.934Z] Remaining: 2
[2025-11-15T21:27:33.934Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.934Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.950Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.951Z] Request URL: /auth/register
[2025-11-15T21:27:33.951Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.951Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.952Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] Will use test ID?: true
[2025-11-15T21:27:33.952Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.952Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.954Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.958Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.958Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.959Z] üìñ Found existing entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.960Z] Existing timestamps: 1
[2025-11-15T21:27:33.960Z] Current count after filter: 1
[2025-11-15T21:27:33.960Z] Max requests allowed: 3
[2025-11-15T21:27:33.960Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.960Z] New count: 2
[2025-11-15T21:27:33.961Z] Remaining: 1
[2025-11-15T21:27:33.966Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.966Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.993Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.994Z] Request URL: /auth/login
[2025-11-15T21:27:33.994Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.994Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.994Z] Will use test ID?: true
[2025-11-15T21:27:33.994Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.995Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.995Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.995Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Existing timestamps: 2
[2025-11-15T21:27:33.995Z] Current count after filter: 2
[2025-11-15T21:27:33.995Z] Max requests allowed: 5
[2025-11-15T21:27:33.996Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.996Z] New count: 3
[2025-11-15T21:27:33.996Z] Remaining: 2
[2025-11-15T21:27:33.996Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.996Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:34.151Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.152Z] Request URL: /auth/login
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.152Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Will use test ID?: true
[2025-11-15T21:27:34.152Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.152Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.152Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.152Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Existing timestamps: 3
[2025-11-15T21:27:34.152Z] Current count after filter: 3
[2025-11-15T21:27:34.152Z] Max requests allowed: 5
[2025-11-15T21:27:34.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.152Z] New count: 4
[2025-11-15T21:27:34.152Z] Remaining: 1
[2025-11-15T21:27:34.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:34.181Z] üßπ clearRateLimits: Cleared 5 entries from rate limit store
[2025-11-15T21:27:34.183Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.183Z] Request URL: /auth/login
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.183Z] X-Test-ID header: perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Will use test ID?: true
[2025-11-15T21:27:34.183Z] ‚úÖ Using test identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.183Z] Got identifier from getClientIdentifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.183Z] Identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] üìù Creating new entry for key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Current count after filter: 0
[2025-11-15T21:27:34.183Z] Max requests allowed: 5
[2025-11-15T21:27:34.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.183Z] New count: 1
[2025-11-15T21:27:34.184Z] Remaining: 4
[2025-11-15T21:27:34.184Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.184Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114183
}
[2025-11-15T21:27:34.860Z] üßπ clearRateLimits: Cleared 1 entries from rate limit store
[2025-11-15T21:27:34.868Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.869Z] Request URL: /auth/login
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.869Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Will use test ID?: true
[2025-11-15T21:27:34.869Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.869Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.869Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.869Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] üìù Creating new entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Current count after filter: 0
[2025-11-15T21:27:34.869Z] Max requests allowed: 5
[2025-11-15T21:27:34.870Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.870Z] New count: 1
[2025-11-15T21:27:34.870Z] Remaining: 4
[2025-11-15T21:27:34.870Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.870Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114869
}
[2025-11-15T21:27:35.190Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:35.190Z] Request URL: /auth/login
[2025-11-15T21:27:35.190Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:35.191Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:35.191Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Will use test ID?: true
[2025-11-15T21:27:35.191Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:35.191Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:35.191Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:35.191Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] Existing timestamps: 1
[2025-11-15T21:27:35.192Z] Current count after filter: 1
[2025-11-15T21:27:35.192Z] Max requests allowed: 5
[2025-11-15T21:27:35.192Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:35.192Z] New count: 2
[2025-11-15T21:27:35.192Z] Remaining: 3
[2025-11-15T21:27:35.192Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:35.192Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242114869
}
[2025-11-15T21:32:12.512Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.513Z] Request URL: /auth/login
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.513Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Will use test ID?: true
[2025-11-15T21:32:12.513Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.513Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.513Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] üìù Creating new entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Current count after filter: 0
[2025-11-15T21:32:12.513Z] Max requests allowed: 5
[2025-11-15T21:32:12.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.514Z] New count: 1
[2025-11-15T21:32:12.514Z] Remaining: 4
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.514Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:12.514Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.514Z] Request URL: /auth/login
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.514Z] X-Test-ID header: login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] Will use test ID?: true
[2025-11-15T21:32:12.514Z] ‚úÖ Using test identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.514Z] Got identifier from getClientIdentifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.514Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.514Z] Identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392514
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.515Z] Request URL: /auth/login
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.515Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Will use test ID?: true
[2025-11-15T21:32:12.515Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.515Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.515Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.515Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.515Z] Request URL: /auth/register
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] üìù Creating new entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Current count after filter: 0
[2025-11-15T21:32:12.516Z] Max requests allowed: 3
[2025-11-15T21:32:12.516Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.516Z] New count: 1
[2025-11-15T21:32:12.516Z] Remaining: 2
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.516Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:12.516Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.516Z] Request URL: /auth/register
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] üìù Creating new entry for key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] Current count after filter: 0
[2025-11-15T21:32:12.517Z] Max requests allowed: 3
[2025-11-15T21:32:12.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.517Z] New count: 1
[2025-11-15T21:32:12.517Z] Remaining: 2
[2025-11-15T21:32:12.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.517Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.041Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.041Z] Request URL: /auth/login
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.041Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] Will use test ID?: true
[2025-11-15T21:32:13.041Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.041Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.042Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.042Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Existing timestamps: 1
[2025-11-15T21:32:13.042Z] Current count after filter: 1
[2025-11-15T21:32:13.042Z] Max requests allowed: 5
[2025-11-15T21:32:13.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.042Z] New count: 2
[2025-11-15T21:32:13.042Z] Remaining: 3
[2025-11-15T21:32:13.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.042Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.089Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.089Z] Request URL: /auth/login
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.089Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] Will use test ID?: true
[2025-11-15T21:32:13.089Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.090Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.090Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Existing timestamps: 1
[2025-11-15T21:32:13.090Z] Current count after filter: 1
[2025-11-15T21:32:13.090Z] Max requests allowed: 5
[2025-11-15T21:32:13.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.090Z] New count: 2
[2025-11-15T21:32:13.090Z] Remaining: 3
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.121Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.121Z] Request URL: /auth/login
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.121Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Will use test ID?: true
[2025-11-15T21:32:13.121Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.121Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.121Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.121Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] Current count after filter: 0
[2025-11-15T21:32:13.122Z] Max requests allowed: 5
[2025-11-15T21:32:13.122Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.122Z] New count: 1
[2025-11-15T21:32:13.122Z] Remaining: 4
[2025-11-15T21:32:13.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.122Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.274Z] Request URL: /auth/login
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.274Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Will use test ID?: true
[2025-11-15T21:32:13.274Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.274Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.274Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.274Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.275Z] Existing timestamps: 2
[2025-11-15T21:32:13.275Z] Current count after filter: 2
[2025-11-15T21:32:13.275Z] Max requests allowed: 5
[2025-11-15T21:32:13.275Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.275Z] New count: 3
[2025-11-15T21:32:13.275Z] Remaining: 2
[2025-11-15T21:32:13.275Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.275Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.373Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.373Z] Request URL: /auth/login
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.373Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Will use test ID?: true
[2025-11-15T21:32:13.373Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.373Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.373Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.373Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Existing timestamps: 1
[2025-11-15T21:32:13.373Z] Current count after filter: 1
[2025-11-15T21:32:13.374Z] Max requests allowed: 5
[2025-11-15T21:32:13.374Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.374Z] New count: 2
[2025-11-15T21:32:13.374Z] Remaining: 3
[2025-11-15T21:32:13.374Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.374Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.498Z] Request URL: /auth/login
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.498Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] Will use test ID?: true
[2025-11-15T21:32:13.498Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.498Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.498Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Existing timestamps: 3
[2025-11-15T21:32:13.499Z] Current count after filter: 3
[2025-11-15T21:32:13.499Z] Max requests allowed: 5
[2025-11-15T21:32:13.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.499Z] New count: 4
[2025-11-15T21:32:13.499Z] Remaining: 1
[2025-11-15T21:32:13.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.579Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.580Z] Request URL: /auth/register
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.580Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Will use test ID?: true
[2025-11-15T21:32:13.580Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.580Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.580Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.580Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Existing timestamps: 1
[2025-11-15T21:32:13.580Z] Current count after filter: 1
[2025-11-15T21:32:13.580Z] Max requests allowed: 3
[2025-11-15T21:32:13.580Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.580Z] New count: 2
[2025-11-15T21:32:13.580Z] Remaining: 1
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.580Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.588Z] Request URL: /auth/login
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.588Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Will use test ID?: true
[2025-11-15T21:32:13.588Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.588Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.588Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] üìù Creating new entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] Current count after filter: 0
[2025-11-15T21:32:13.589Z] Max requests allowed: 5
[2025-11-15T21:32:13.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.589Z] New count: 1
[2025-11-15T21:32:13.589Z] Remaining: 4
[2025-11-15T21:32:13.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.589Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.596Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.596Z] Request URL: /auth/login
[2025-11-15T21:32:13.596Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.597Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.597Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Will use test ID?: true
[2025-11-15T21:32:13.597Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.597Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.597Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.597Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Existing timestamps: 2
[2025-11-15T21:32:13.597Z] Current count after filter: 2
[2025-11-15T21:32:13.597Z] Max requests allowed: 5
[2025-11-15T21:32:13.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.597Z] New count: 3
[2025-11-15T21:32:13.597Z] Remaining: 2
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.597Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.598Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.598Z] Request URL: /auth/login
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.598Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Will use test ID?: true
[2025-11-15T21:32:13.598Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.598Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.598Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.598Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Existing timestamps: 2
[2025-11-15T21:32:13.598Z] Current count after filter: 2
[2025-11-15T21:32:13.598Z] Max requests allowed: 5
[2025-11-15T21:32:13.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.598Z] New count: 3
[2025-11-15T21:32:13.598Z] Remaining: 2
[2025-11-15T21:32:13.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.599Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.747Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.747Z] Request URL: /auth/login
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.747Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] Will use test ID?: true
[2025-11-15T21:32:13.747Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.747Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.747Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.748Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Existing timestamps: 4
[2025-11-15T21:32:13.748Z] Current count after filter: 4
[2025-11-15T21:32:13.748Z] Max requests allowed: 5
[2025-11-15T21:32:13.748Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.748Z] New count: 5
[2025-11-15T21:32:13.748Z] Remaining: 0
[2025-11-15T21:32:13.748Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.748Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.798Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.798Z] Request URL: /auth/login
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.798Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] Will use test ID?: true
[2025-11-15T21:32:13.798Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.799Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.799Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.799Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Existing timestamps: 1
[2025-11-15T21:32:13.799Z] Current count after filter: 1
[2025-11-15T21:32:13.799Z] Max requests allowed: 5
[2025-11-15T21:32:13.799Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.799Z] New count: 2
[2025-11-15T21:32:13.799Z] Remaining: 3
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.799Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.832Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.832Z] Request URL: /auth/login
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.832Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] Will use test ID?: true
[2025-11-15T21:32:13.832Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.832Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.832Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.833Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Existing timestamps: 3
[2025-11-15T21:32:13.833Z] Current count after filter: 3
[2025-11-15T21:32:13.833Z] Max requests allowed: 5
[2025-11-15T21:32:13.833Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.833Z] New count: 4
[2025-11-15T21:32:13.833Z] Remaining: 1
[2025-11-15T21:32:13.833Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.833Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.872Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.872Z] Request URL: /auth/login
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.872Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] Will use test ID?: true
[2025-11-15T21:32:13.872Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.873Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.873Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.873Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Existing timestamps: 3
[2025-11-15T21:32:13.873Z] Current count after filter: 3
[2025-11-15T21:32:13.873Z] Max requests allowed: 5
[2025-11-15T21:32:13.873Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.873Z] New count: 4
[2025-11-15T21:32:13.873Z] Remaining: 1
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.873Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.926Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.926Z] Request URL: /auth/register
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.926Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Will use test ID?: true
[2025-11-15T21:32:13.926Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.926Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.926Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.926Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Existing timestamps: 2
[2025-11-15T21:32:13.926Z] Current count after filter: 2
[2025-11-15T21:32:13.926Z] Max requests allowed: 3
[2025-11-15T21:32:13.926Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.926Z] New count: 3
[2025-11-15T21:32:13.926Z] Remaining: 0
[2025-11-15T21:32:13.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.927Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.971Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.971Z] Request URL: /auth/login
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.971Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] Will use test ID?: true
[2025-11-15T21:32:13.971Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.971Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.971Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.972Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Existing timestamps: 5
[2025-11-15T21:32:13.972Z] Current count after filter: 5
[2025-11-15T21:32:13.972Z] Max requests allowed: 5
[2025-11-15T21:32:13.972Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:13.972Z] Current count: 5
[2025-11-15T21:32:13.972Z] Max allowed: 5
[2025-11-15T21:32:13.972Z] Retry after (seconds): 59
[2025-11-15T21:32:13.972Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:13.972Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392513,
  "retryAfter": 59
}
[2025-11-15T21:32:13.984Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.984Z] Request URL: /auth/login
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.984Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] Will use test ID?: true
[2025-11-15T21:32:13.984Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.984Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.985Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.985Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] üìù Creating new entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Current count after filter: 0
[2025-11-15T21:32:13.985Z] Max requests allowed: 5
[2025-11-15T21:32:13.985Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.985Z] New count: 1
[2025-11-15T21:32:13.985Z] Remaining: 4
[2025-11-15T21:32:13.985Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.985Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.033Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.033Z] Request URL: /auth/login
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.033Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Will use test ID?: true
[2025-11-15T21:32:14.033Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.033Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.033Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.033Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Existing timestamps: 2
[2025-11-15T21:32:14.033Z] Current count after filter: 2
[2025-11-15T21:32:14.033Z] Max requests allowed: 5
[2025-11-15T21:32:14.033Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.033Z] New count: 3
[2025-11-15T21:32:14.033Z] Remaining: 2
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:14.091Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.091Z] Request URL: /auth/login
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.091Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Will use test ID?: true
[2025-11-15T21:32:14.091Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.091Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.091Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.091Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.092Z] Existing timestamps: 4
[2025-11-15T21:32:14.092Z] Current count after filter: 4
[2025-11-15T21:32:14.092Z] Max requests allowed: 5
[2025-11-15T21:32:14.092Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.092Z] New count: 5
[2025-11-15T21:32:14.092Z] Remaining: 0
[2025-11-15T21:32:14.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.092Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:14.150Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.150Z] Request URL: /auth/login
[2025-11-15T21:32:14.150Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.151Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Will use test ID?: true
[2025-11-15T21:32:14.151Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.151Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.151Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.151Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Existing timestamps: 4
[2025-11-15T21:32:14.151Z] Current count after filter: 4
[2025-11-15T21:32:14.151Z] Max requests allowed: 5
[2025-11-15T21:32:14.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.151Z] New count: 5
[2025-11-15T21:32:14.151Z] Remaining: 0
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:14.268Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.268Z] Request URL: /auth/login
[2025-11-15T21:32:14.268Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.268Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Will use test ID?: true
[2025-11-15T21:32:14.269Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.269Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.269Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.269Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Existing timestamps: 1
[2025-11-15T21:32:14.269Z] Current count after filter: 1
[2025-11-15T21:32:14.269Z] Max requests allowed: 5
[2025-11-15T21:32:14.269Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.269Z] New count: 2
[2025-11-15T21:32:14.269Z] Remaining: 3
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.269Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.272Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.272Z] Request URL: /auth/register
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.272Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Will use test ID?: true
[2025-11-15T21:32:14.272Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.272Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.272Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.272Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Existing timestamps: 3
[2025-11-15T21:32:14.272Z] Current count after filter: 3
[2025-11-15T21:32:14.272Z] Max requests allowed: 3
[2025-11-15T21:32:14.272Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.272Z] Current count: 3
[2025-11-15T21:32:14.272Z] Max allowed: 3
[2025-11-15T21:32:14.272Z] Retry after (seconds): 59
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.272Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392516,
  "retryAfter": 59
}
[2025-11-15T21:32:14.284Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.284Z] Request URL: /auth/login
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.284Z] X-Test-ID header: perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Will use test ID?: true
[2025-11-15T21:32:14.284Z] ‚úÖ Using test identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.284Z] Got identifier from getClientIdentifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.284Z] Identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] üìù Creating new entry for key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Current count after filter: 0
[2025-11-15T21:32:14.284Z] Max requests allowed: 5
[2025-11-15T21:32:14.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.284Z] New count: 1
[2025-11-15T21:32:14.284Z] Remaining: 4
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242394284
}
[2025-11-15T21:32:14.343Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.343Z] Request URL: /auth/login
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.344Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Will use test ID?: true
[2025-11-15T21:32:14.344Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.344Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.344Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.344Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Existing timestamps: 5
[2025-11-15T21:32:14.344Z] Current count after filter: 5
[2025-11-15T21:32:14.344Z] Max requests allowed: 5
[2025-11-15T21:32:14.344Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.344Z] Current count: 5
[2025-11-15T21:32:14.344Z] Max allowed: 5
[2025-11-15T21:32:14.344Z] Retry after (seconds): 59
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.344Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242393121,
  "retryAfter": 59
}
[2025-11-15T21:32:14.346Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.346Z] Request URL: /auth/register
[2025-11-15T21:32:14.346Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.346Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.346Z] Will use test ID?: true
[2025-11-15T21:32:14.347Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.347Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.347Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.347Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Current count after filter: 0
[2025-11-15T21:32:14.347Z] Max requests allowed: 3
[2025-11-15T21:32:14.347Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.347Z] New count: 1
[2025-11-15T21:32:14.347Z] Remaining: 2
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.347Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242394347
}
[2025-11-15T21:32:14.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.448Z] Request URL: /auth/login
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.449Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Will use test ID?: true
[2025-11-15T21:32:14.449Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.449Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.449Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.449Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Existing timestamps: 5
[2025-11-15T21:32:14.449Z] Current count after filter: 5
[2025-11-15T21:32:14.449Z] Max requests allowed: 5
[2025-11-15T21:32:14.449Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.449Z] Current count: 5
[2025-11-15T21:32:14.449Z] Max allowed: 5
[2025-11-15T21:32:14.449Z] Retry after (seconds): 59
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.449Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392515,
  "retryAfter": 59
}
[2025-11-15T21:36:59.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.426Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.426Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] üìù Creating new entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Current count after filter: 0
[2025-11-15T21:36:59.426Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 1
[2025-11-15T21:36:59.427Z] Remaining: 4
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.427Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.427Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Existing timestamps: 1
[2025-11-15T21:36:59.427Z] Current count after filter: 1
[2025-11-15T21:36:59.427Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 2
[2025-11-15T21:36:59.427Z] Remaining: 3
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.428Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.428Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Existing timestamps: 2
[2025-11-15T21:36:59.428Z] Current count after filter: 2
[2025-11-15T21:36:59.428Z] Max requests allowed: 5
[2025-11-15T21:36:59.428Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.428Z] New count: 3
[2025-11-15T21:36:59.428Z] Remaining: 2
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 3
[2025-11-15T21:36:59.429Z] Current count after filter: 3
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 4
[2025-11-15T21:36:59.429Z] Remaining: 1
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 4
[2025-11-15T21:36:59.429Z] Current count after filter: 4
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 5
[2025-11-15T21:36:59.429Z] Remaining: 0
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìù Creating new entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Current count after filter: 0
[2025-11-15T21:36:59.430Z] Max requests allowed: 5
[2025-11-15T21:36:59.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.430Z] New count: 1
[2025-11-15T21:36:59.430Z] Remaining: 4
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Existing timestamps: 1
[2025-11-15T21:36:59.431Z] Current count after filter: 1
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 2
[2025-11-15T21:36:59.431Z] Remaining: 3
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 2
[2025-11-15T21:36:59.431Z] Current count after filter: 2
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 3
[2025-11-15T21:36:59.431Z] Remaining: 2
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 3
[2025-11-15T21:36:59.431Z] Current count after filter: 3
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 4
[2025-11-15T21:36:59.431Z] Remaining: 1
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 4
[2025-11-15T21:36:59.432Z] Current count after filter: 4
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.432Z] New count: 5
[2025-11-15T21:36:59.432Z] Remaining: 0
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 5
[2025-11-15T21:36:59.432Z] Current count after filter: 5
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.432Z] Current count: 5
[2025-11-15T21:36:59.432Z] Max allowed: 5
[2025-11-15T21:36:59.432Z] Retry after (seconds): 60
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.432Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.432Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìù Creating new entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Current count after filter: 0
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 1
[2025-11-15T21:36:59.433Z] Remaining: 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 1
[2025-11-15T21:36:59.433Z] Current count after filter: 1
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 2
[2025-11-15T21:36:59.433Z] Remaining: 0
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 2
[2025-11-15T21:36:59.433Z] Current count after filter: 2
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.433Z] Current count: 2
[2025-11-15T21:36:59.433Z] Max allowed: 2
[2025-11-15T21:36:59.433Z] Retry after (seconds): 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.585Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.585Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.585Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.585Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.585Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.586Z] Existing timestamps: 2
[2025-11-15T21:36:59.586Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.586Z] Max requests allowed: 2
[2025-11-15T21:36:59.586Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.586Z] New count: 1
[2025-11-15T21:36:59.586Z] Remaining: 1
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.586Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.586Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] üìù Creating new entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 1
[2025-11-15T21:36:59.587Z] Remaining: 4
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 1
[2025-11-15T21:36:59.587Z] Current count after filter: 1
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 2
[2025-11-15T21:36:59.587Z] Remaining: 3
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 2
[2025-11-15T21:36:59.588Z] Current count after filter: 2
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 3
[2025-11-15T21:36:59.588Z] Remaining: 2
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 3
[2025-11-15T21:36:59.588Z] Current count after filter: 3
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 4
[2025-11-15T21:36:59.588Z] Remaining: 1
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 4
[2025-11-15T21:36:59.588Z] Current count after filter: 4
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 5
[2025-11-15T21:36:59.588Z] Remaining: 0
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 5
[2025-11-15T21:36:59.589Z] Current count after filter: 5
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.589Z] Current count: 5
[2025-11-15T21:36:59.589Z] Max allowed: 5
[2025-11-15T21:36:59.589Z] Retry after (seconds): 60
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.589Z] Identifier: test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] üìù Creating new entry for key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Current count after filter: 0
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.589Z] New count: 1
[2025-11-15T21:36:59.589Z] Remaining: 4
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.590Z] Identifier: test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] üìù Creating new entry for key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Current count after filter: 0
[2025-11-15T21:36:59.590Z] Max requests allowed: 5
[2025-11-15T21:36:59.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.590Z] New count: 1
[2025-11-15T21:36:59.590Z] Remaining: 4
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.591Z] X-Test-ID header: null
[2025-11-15T21:36:59.591Z] Will use test ID?: false
[2025-11-15T21:36:59.591Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using real IP: 192.168.1.2
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.593Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.593Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.593Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] üìù Creating new entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Current count after filter: 0
[2025-11-15T21:36:59.593Z] Max requests allowed: 3
[2025-11-15T21:36:59.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.594Z] New count: 1
[2025-11-15T21:36:59.594Z] Remaining: 2
[2025-11-15T21:36:59.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.694Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.695Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.695Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Existing timestamps: 1
[2025-11-15T21:36:59.695Z] Current count after filter: 1
[2025-11-15T21:36:59.695Z] Max requests allowed: 3
[2025-11-15T21:36:59.695Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.695Z] New count: 2
[2025-11-15T21:36:59.695Z] Remaining: 1
[2025-11-15T21:36:59.695Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.795Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.795Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.795Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Existing timestamps: 2
[2025-11-15T21:36:59.795Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:36:59.795Z] Current count after filter: 1
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 2
[2025-11-15T21:36:59.796Z] Remaining: 1
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.796Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.796Z] Identifier: test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] üìù Creating new entry for key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Current count after filter: 0
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 1
[2025-11-15T21:36:59.796Z] Remaining: 2
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìù Creating new entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Current count after filter: 0
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 1
[2025-11-15T21:36:59.797Z] Remaining: 2
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 1
[2025-11-15T21:36:59.797Z] Current count after filter: 1
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 2
[2025-11-15T21:36:59.797Z] Remaining: 1
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 2
[2025-11-15T21:36:59.797Z] Current count after filter: 2
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 3
[2025-11-15T21:36:59.797Z] Remaining: 0
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Existing timestamps: 3
[2025-11-15T21:36:59.798Z] Current count after filter: 3
[2025-11-15T21:36:59.798Z] Max requests allowed: 3
[2025-11-15T21:36:59.798Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.798Z] Current count: 3
[2025-11-15T21:36:59.798Z] Max allowed: 3
[2025-11-15T21:36:59.798Z] Retry after (seconds): 60
[2025-11-15T21:36:59.798Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:17.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:17.151Z] Request URL: /auth/register
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:17.151Z] X-Test-ID header: null
[2025-11-15T21:37:17.151Z] Will use test ID?: false
[2025-11-15T21:37:17.151Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:17.151Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:17.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:17.151Z] Identifier: unknown
[2025-11-15T21:37:17.151Z] Key: register:unknown
[2025-11-15T21:37:17.151Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:37:17.151Z] Current count after filter: 0
[2025-11-15T21:37:17.151Z] Max requests allowed: 3
[2025-11-15T21:37:17.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:17.151Z] New count: 1
[2025-11-15T21:37:17.151Z] Remaining: 2
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:17.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:18.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.498Z] Request URL: /auth/verify-email
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.498Z] X-Test-ID header: null
[2025-11-15T21:37:18.498Z] Will use test ID?: false
[2025-11-15T21:37:18.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.498Z] Identifier: unknown
[2025-11-15T21:37:18.498Z] Key: login:unknown
[2025-11-15T21:37:18.498Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:37:18.498Z] Current count after filter: 0
[2025-11-15T21:37:18.498Z] Max requests allowed: 5
[2025-11-15T21:37:18.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.499Z] New count: 1
[2025-11-15T21:37:18.499Z] Remaining: 4
[2025-11-15T21:37:18.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:18.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.590Z] Request URL: /auth/forgot-password
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.590Z] X-Test-ID header: null
[2025-11-15T21:37:18.590Z] Will use test ID?: false
[2025-11-15T21:37:18.590Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.590Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.590Z] Identifier: unknown
[2025-11-15T21:37:18.590Z] Key: login:unknown
[2025-11-15T21:37:18.590Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:18.590Z] Existing timestamps: 1
[2025-11-15T21:37:18.590Z] Current count after filter: 1
[2025-11-15T21:37:18.590Z] Max requests allowed: 5
[2025-11-15T21:37:18.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.590Z] New count: 2
[2025-11-15T21:37:18.590Z] Remaining: 3
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:20.766Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:20.767Z] Request URL: /auth/reset-password
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:20.767Z] X-Test-ID header: null
[2025-11-15T21:37:20.767Z] Will use test ID?: false
[2025-11-15T21:37:20.767Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:20.767Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:20.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:20.767Z] Identifier: unknown
[2025-11-15T21:37:20.767Z] Key: login:unknown
[2025-11-15T21:37:20.767Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:20.767Z] Existing timestamps: 2
[2025-11-15T21:37:20.767Z] Current count after filter: 2
[2025-11-15T21:37:20.767Z] Max requests allowed: 5
[2025-11-15T21:37:20.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:20.768Z] New count: 3
[2025-11-15T21:37:20.768Z] Remaining: 2
[2025-11-15T21:37:20.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:20.768Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:22.065Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.065Z] Request URL: /auth/login
[2025-11-15T21:37:22.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.066Z] X-Test-ID header: login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Will use test ID?: true
[2025-11-15T21:37:22.066Z] ‚úÖ Using test identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.066Z] Got identifier from getClientIdentifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.066Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.066Z] Identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] üìù Creating new entry for key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Current count after filter: 0
[2025-11-15T21:37:22.066Z] Max requests allowed: 5
[2025-11-15T21:37:22.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.066Z] New count: 1
[2025-11-15T21:37:22.066Z] Remaining: 4
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702066
}
[2025-11-15T21:37:22.140Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.141Z] Request URL: /auth/login
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.141Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Will use test ID?: true
[2025-11-15T21:37:22.141Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.141Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.141Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.141Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] üìù Creating new entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Current count after filter: 0
[2025-11-15T21:37:22.141Z] Max requests allowed: 5
[2025-11-15T21:37:22.141Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.141Z] New count: 1
[2025-11-15T21:37:22.141Z] Remaining: 4
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.141Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.348Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.349Z] Request URL: /auth/login
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.349Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] Will use test ID?: true
[2025-11-15T21:37:22.349Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.349Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.349Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.350Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] üìù Creating new entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Current count after filter: 0
[2025-11-15T21:37:22.350Z] Max requests allowed: 5
[2025-11-15T21:37:22.350Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.350Z] New count: 1
[2025-11-15T21:37:22.350Z] Remaining: 4
[2025-11-15T21:37:22.350Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.350Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.568Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.568Z] Request URL: /auth/login
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.569Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Will use test ID?: true
[2025-11-15T21:37:22.569Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.569Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.569Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] Existing timestamps: 1
[2025-11-15T21:37:22.570Z] Current count after filter: 1
[2025-11-15T21:37:22.570Z] Max requests allowed: 5
[2025-11-15T21:37:22.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.570Z] New count: 2
[2025-11-15T21:37:22.570Z] Remaining: 3
[2025-11-15T21:37:22.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.571Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.581Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.581Z] Request URL: /auth/login
[2025-11-15T21:37:22.581Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.581Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.581Z] Will use test ID?: true
[2025-11-15T21:37:22.582Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.582Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.582Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.582Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Existing timestamps: 1
[2025-11-15T21:37:22.582Z] Current count after filter: 1
[2025-11-15T21:37:22.582Z] Max requests allowed: 5
[2025-11-15T21:37:22.582Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.582Z] New count: 2
[2025-11-15T21:37:22.582Z] Remaining: 3
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.582Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.821Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.821Z] Request URL: /auth/login
[2025-11-15T21:37:22.821Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.821Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.822Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] Will use test ID?: true
[2025-11-15T21:37:22.822Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.822Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.822Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.822Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Existing timestamps: 2
[2025-11-15T21:37:22.823Z] Current count after filter: 2
[2025-11-15T21:37:22.823Z] Max requests allowed: 5
[2025-11-15T21:37:22.824Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.824Z] New count: 3
[2025-11-15T21:37:22.824Z] Remaining: 2
[2025-11-15T21:37:22.824Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.824Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.892Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.892Z] Request URL: /auth/login
[2025-11-15T21:37:22.892Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.892Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Will use test ID?: true
[2025-11-15T21:37:22.893Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.893Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.893Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.893Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Existing timestamps: 2
[2025-11-15T21:37:22.893Z] Current count after filter: 2
[2025-11-15T21:37:22.894Z] Max requests allowed: 5
[2025-11-15T21:37:22.894Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.894Z] New count: 3
[2025-11-15T21:37:22.894Z] Remaining: 2
[2025-11-15T21:37:22.894Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.894Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.099Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.099Z] Request URL: /auth/login
[2025-11-15T21:37:23.099Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.100Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] Will use test ID?: true
[2025-11-15T21:37:23.101Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.101Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.102Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.102Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Existing timestamps: 3
[2025-11-15T21:37:23.102Z] Current count after filter: 3
[2025-11-15T21:37:23.102Z] Max requests allowed: 5
[2025-11-15T21:37:23.102Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.102Z] New count: 4
[2025-11-15T21:37:23.102Z] Remaining: 1
[2025-11-15T21:37:23.102Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.102Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.186Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.186Z] Request URL: /auth/register
[2025-11-15T21:37:23.187Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.187Z] X-Test-ID header: null
[2025-11-15T21:37:23.187Z] Will use test ID?: false
[2025-11-15T21:37:23.188Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.188Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.188Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.188Z] Identifier: unknown
[2025-11-15T21:37:23.188Z] Key: register:unknown
[2025-11-15T21:37:23.188Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:37:23.188Z] Existing timestamps: 1
[2025-11-15T21:37:23.188Z] Current count after filter: 1
[2025-11-15T21:37:23.188Z] Max requests allowed: 3
[2025-11-15T21:37:23.188Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.188Z] New count: 2
[2025-11-15T21:37:23.188Z] Remaining: 1
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.188Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:23.277Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.277Z] Request URL: /auth/login
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.277Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] Will use test ID?: true
[2025-11-15T21:37:23.277Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.277Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.278Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.278Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Existing timestamps: 3
[2025-11-15T21:37:23.279Z] Current count after filter: 3
[2025-11-15T21:37:23.279Z] Max requests allowed: 5
[2025-11-15T21:37:23.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.279Z] New count: 4
[2025-11-15T21:37:23.279Z] Remaining: 1
[2025-11-15T21:37:23.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.279Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.351Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.351Z] Request URL: /auth/login
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.352Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Will use test ID?: true
[2025-11-15T21:37:23.352Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.352Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.352Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.352Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Existing timestamps: 4
[2025-11-15T21:37:23.352Z] Current count after filter: 4
[2025-11-15T21:37:23.352Z] Max requests allowed: 5
[2025-11-15T21:37:23.352Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.352Z] New count: 5
[2025-11-15T21:37:23.352Z] Remaining: 0
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.353Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.588Z] Request URL: /auth/login
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.589Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Will use test ID?: true
[2025-11-15T21:37:23.589Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.589Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.589Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Existing timestamps: 4
[2025-11-15T21:37:23.589Z] Current count after filter: 4
[2025-11-15T21:37:23.589Z] Max requests allowed: 5
[2025-11-15T21:37:23.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.590Z] New count: 5
[2025-11-15T21:37:23.590Z] Remaining: 0
[2025-11-15T21:37:23.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.590Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.605Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.605Z] Request URL: /auth/login
[2025-11-15T21:37:23.605Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.605Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Will use test ID?: true
[2025-11-15T21:37:23.606Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.606Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.606Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.606Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Existing timestamps: 5
[2025-11-15T21:37:23.606Z] Current count after filter: 5
[2025-11-15T21:37:23.606Z] Max requests allowed: 5
[2025-11-15T21:37:23.606Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.606Z] Current count: 5
[2025-11-15T21:37:23.606Z] Max allowed: 5
[2025-11-15T21:37:23.606Z] Retry after (seconds): 59
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.606Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702349,
  "retryAfter": 59
}
[2025-11-15T21:37:23.613Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.613Z] Request URL: /auth/register
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.614Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Will use test ID?: true
[2025-11-15T21:37:23.614Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.614Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.614Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.614Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] üìù Creating new entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Current count after filter: 0
[2025-11-15T21:37:23.614Z] Max requests allowed: 3
[2025-11-15T21:37:23.614Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.614Z] New count: 1
[2025-11-15T21:37:23.614Z] Remaining: 2
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.614Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:23.873Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.873Z] Request URL: /auth/login
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.873Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] Will use test ID?: true
[2025-11-15T21:37:23.873Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.874Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.874Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.874Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Existing timestamps: 5
[2025-11-15T21:37:23.874Z] Current count after filter: 5
[2025-11-15T21:37:23.874Z] Max requests allowed: 5
[2025-11-15T21:37:23.874Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.874Z] Current count: 5
[2025-11-15T21:37:23.874Z] Max allowed: 5
[2025-11-15T21:37:23.874Z] Retry after (seconds): 59
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.874Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702141,
  "retryAfter": 59
}
[2025-11-15T21:37:23.888Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.888Z] Request URL: /auth/register
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.889Z] X-Test-ID header: register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Will use test ID?: true
[2025-11-15T21:37:23.889Z] ‚úÖ Using test identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.889Z] Got identifier from getClientIdentifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.889Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.889Z] Identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] üìù Creating new entry for key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Current count after filter: 0
[2025-11-15T21:37:23.889Z] Max requests allowed: 3
[2025-11-15T21:37:23.889Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.889Z] New count: 1
[2025-11-15T21:37:23.889Z] Remaining: 2
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.889Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703889
}
[2025-11-15T21:37:24.030Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.031Z] Request URL: /auth/register
[2025-11-15T21:37:24.031Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.031Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.031Z] Will use test ID?: true
[2025-11-15T21:37:24.032Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.032Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.032Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.032Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Existing timestamps: 1
[2025-11-15T21:37:24.032Z] Current count after filter: 1
[2025-11-15T21:37:24.032Z] Max requests allowed: 3
[2025-11-15T21:37:24.032Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.032Z] New count: 2
[2025-11-15T21:37:24.033Z] Remaining: 1
[2025-11-15T21:37:24.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.058Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.058Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.058Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] Will use test ID?: true
[2025-11-15T21:37:24.058Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.058Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.058Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.059Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] üìù Creating new entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Current count after filter: 0
[2025-11-15T21:37:24.059Z] Max requests allowed: 5
[2025-11-15T21:37:24.059Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.059Z] New count: 1
[2025-11-15T21:37:24.059Z] Remaining: 4
[2025-11-15T21:37:24.059Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.059Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.366Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.366Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.366Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.366Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Will use test ID?: true
[2025-11-15T21:37:24.367Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.367Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.367Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.367Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Existing timestamps: 1
[2025-11-15T21:37:24.368Z] Current count after filter: 1
[2025-11-15T21:37:24.368Z] Max requests allowed: 5
[2025-11-15T21:37:24.368Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.368Z] New count: 2
[2025-11-15T21:37:24.368Z] Remaining: 3
[2025-11-15T21:37:24.368Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.368Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.410Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.410Z] Request URL: /auth/login
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.410Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] Will use test ID?: true
[2025-11-15T21:37:24.410Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.410Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.411Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Current count after filter: 0
[2025-11-15T21:37:24.411Z] Max requests allowed: 5
[2025-11-15T21:37:24.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.411Z] New count: 1
[2025-11-15T21:37:24.411Z] Remaining: 4
[2025-11-15T21:37:24.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.411Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.703Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.704Z] Request URL: /auth/login
[2025-11-15T21:37:24.705Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.706Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Will use test ID?: true
[2025-11-15T21:37:24.706Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.706Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.706Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.706Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Existing timestamps: 1
[2025-11-15T21:37:24.706Z] Current count after filter: 1
[2025-11-15T21:37:24.706Z] Max requests allowed: 5
[2025-11-15T21:37:24.706Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.707Z] New count: 2
[2025-11-15T21:37:24.707Z] Remaining: 3
[2025-11-15T21:37:24.707Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.707Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.714Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.714Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.715Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Will use test ID?: true
[2025-11-15T21:37:24.715Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.715Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.715Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.715Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Existing timestamps: 2
[2025-11-15T21:37:24.715Z] Current count after filter: 2
[2025-11-15T21:37:24.715Z] Max requests allowed: 5
[2025-11-15T21:37:24.715Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.715Z] New count: 3
[2025-11-15T21:37:24.715Z] Remaining: 2
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.715Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.743Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.743Z] Request URL: /auth/register
[2025-11-15T21:37:24.743Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.743Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.743Z] Will use test ID?: true
[2025-11-15T21:37:24.744Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.744Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.744Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.744Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Existing timestamps: 2
[2025-11-15T21:37:24.744Z] Current count after filter: 2
[2025-11-15T21:37:24.744Z] Max requests allowed: 3
[2025-11-15T21:37:24.744Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.744Z] New count: 3
[2025-11-15T21:37:24.745Z] Remaining: 0
[2025-11-15T21:37:24.745Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.745Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.958Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.958Z] Request URL: /auth/login
[2025-11-15T21:37:24.958Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.958Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Will use test ID?: true
[2025-11-15T21:37:24.959Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.959Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.959Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Existing timestamps: 2
[2025-11-15T21:37:24.959Z] Current count after filter: 2
[2025-11-15T21:37:24.959Z] Max requests allowed: 5
[2025-11-15T21:37:24.959Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.959Z] New count: 3
[2025-11-15T21:37:24.959Z] Remaining: 2
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.959Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.005Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.005Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.005Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] Will use test ID?: true
[2025-11-15T21:37:25.005Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.005Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.005Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.006Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Existing timestamps: 3
[2025-11-15T21:37:25.006Z] Current count after filter: 3
[2025-11-15T21:37:25.006Z] Max requests allowed: 5
[2025-11-15T21:37:25.006Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.006Z] New count: 4
[2025-11-15T21:37:25.006Z] Remaining: 1
[2025-11-15T21:37:25.006Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.006Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.124Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.124Z] Request URL: /auth/register
[2025-11-15T21:37:25.124Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.125Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Will use test ID?: true
[2025-11-15T21:37:25.125Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.125Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.125Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.125Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Existing timestamps: 3
[2025-11-15T21:37:25.125Z] Current count after filter: 3
[2025-11-15T21:37:25.125Z] Max requests allowed: 3
[2025-11-15T21:37:25.125Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.125Z] Current count: 3
[2025-11-15T21:37:25.125Z] Max allowed: 3
[2025-11-15T21:37:25.125Z] Retry after (seconds): 59
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.126Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242703614,
  "retryAfter": 59
}
[2025-11-15T21:37:25.136Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.136Z] Request URL: /auth/login
[2025-11-15T21:37:25.136Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.137Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.137Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Will use test ID?: true
[2025-11-15T21:37:25.137Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.137Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.137Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.137Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] üìù Creating new entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Current count after filter: 0
[2025-11-15T21:37:25.137Z] Max requests allowed: 5
[2025-11-15T21:37:25.137Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.137Z] New count: 1
[2025-11-15T21:37:25.137Z] Remaining: 4
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.137Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.204Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.204Z] Request URL: /auth/login
[2025-11-15T21:37:25.204Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.204Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.206Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Will use test ID?: true
[2025-11-15T21:37:25.206Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.206Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.206Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.206Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Existing timestamps: 3
[2025-11-15T21:37:25.206Z] Current count after filter: 3
[2025-11-15T21:37:25.206Z] Max requests allowed: 5
[2025-11-15T21:37:25.206Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.206Z] New count: 4
[2025-11-15T21:37:25.206Z] Remaining: 1
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.206Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.360Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.360Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.360Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.361Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Will use test ID?: true
[2025-11-15T21:37:25.361Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.361Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.361Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.361Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Existing timestamps: 4
[2025-11-15T21:37:25.361Z] Current count after filter: 4
[2025-11-15T21:37:25.361Z] Max requests allowed: 5
[2025-11-15T21:37:25.361Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.361Z] New count: 5
[2025-11-15T21:37:25.361Z] Remaining: 0
[2025-11-15T21:37:25.362Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.362Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.367Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.368Z] Request URL: /auth/login
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.368Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Will use test ID?: true
[2025-11-15T21:37:25.368Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.368Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.368Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.368Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] Existing timestamps: 1
[2025-11-15T21:37:25.369Z] Current count after filter: 1
[2025-11-15T21:37:25.369Z] Max requests allowed: 5
[2025-11-15T21:37:25.369Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.369Z] New count: 2
[2025-11-15T21:37:25.369Z] Remaining: 3
[2025-11-15T21:37:25.369Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.369Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.432Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.433Z] Request URL: /auth/login
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.433Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] Will use test ID?: true
[2025-11-15T21:37:25.433Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.433Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.434Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.434Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Existing timestamps: 4
[2025-11-15T21:37:25.434Z] Current count after filter: 4
[2025-11-15T21:37:25.434Z] Max requests allowed: 5
[2025-11-15T21:37:25.434Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.434Z] New count: 5
[2025-11-15T21:37:25.435Z] Remaining: 0
[2025-11-15T21:37:25.435Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.435Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.618Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.618Z] Request URL: /auth/login
[2025-11-15T21:37:25.618Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.619Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Will use test ID?: true
[2025-11-15T21:37:25.619Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.619Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.619Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.619Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Existing timestamps: 2
[2025-11-15T21:37:25.619Z] Current count after filter: 2
[2025-11-15T21:37:25.619Z] Max requests allowed: 5
[2025-11-15T21:37:25.619Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.620Z] New count: 3
[2025-11-15T21:37:25.620Z] Remaining: 2
[2025-11-15T21:37:25.620Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.620Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.699Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.699Z] Request URL: /auth/login
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.699Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Will use test ID?: true
[2025-11-15T21:37:25.699Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.699Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.699Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.699Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Existing timestamps: 5
[2025-11-15T21:37:25.699Z] Current count after filter: 5
[2025-11-15T21:37:25.699Z] Max requests allowed: 5
[2025-11-15T21:37:25.699Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.700Z] Current count: 5
[2025-11-15T21:37:25.700Z] Max allowed: 5
[2025-11-15T21:37:25.700Z] Retry after (seconds): 59
[2025-11-15T21:37:25.700Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.700Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242704410,
  "retryAfter": 59
}
[2025-11-15T21:37:25.701Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.701Z] Request URL: /auth/register
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.701Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Will use test ID?: true
[2025-11-15T21:37:25.701Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.701Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.701Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.701Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Current count after filter: 0
[2025-11-15T21:37:25.701Z] Max requests allowed: 3
[2025-11-15T21:37:25.701Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.701Z] New count: 1
[2025-11-15T21:37:25.701Z] Remaining: 2
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.701Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705701
}
[2025-11-15T21:37:25.885Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.885Z] Request URL: /auth/login
[2025-11-15T21:37:25.885Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.886Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Will use test ID?: true
[2025-11-15T21:37:25.886Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.886Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.886Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.886Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] üìù Creating new entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Current count after filter: 0
[2025-11-15T21:37:25.886Z] Max requests allowed: 5
[2025-11-15T21:37:25.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.886Z] New count: 1
[2025-11-15T21:37:25.887Z] Remaining: 4
[2025-11-15T21:37:25.887Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.887Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.127Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.127Z] Request URL: /auth/login
[2025-11-15T21:37:26.127Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.127Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.128Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Will use test ID?: true
[2025-11-15T21:37:26.128Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.128Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.128Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Existing timestamps: 1
[2025-11-15T21:37:26.128Z] Current count after filter: 1
[2025-11-15T21:37:26.128Z] Max requests allowed: 5
[2025-11-15T21:37:26.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.128Z] New count: 2
[2025-11-15T21:37:26.129Z] Remaining: 3
[2025-11-15T21:37:26.129Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.129Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.133Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.133Z] Request URL: /auth/login
[2025-11-15T21:37:26.133Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.133Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.134Z] X-Test-ID header: perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Will use test ID?: true
[2025-11-15T21:37:26.134Z] ‚úÖ Using test identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.134Z] Got identifier from getClientIdentifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.134Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.134Z] Identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] üìù Creating new entry for key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Current count after filter: 0
[2025-11-15T21:37:26.134Z] Max requests allowed: 5
[2025-11-15T21:37:26.134Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.134Z] New count: 1
[2025-11-15T21:37:26.134Z] Remaining: 4
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.134Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242706134
}
[2025-11-15T21:59:17.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.508Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.509Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] üìù Creating new entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Current count after filter: 0
[2025-11-15T21:59:17.510Z] Max requests allowed: 5
[2025-11-15T21:59:17.510Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.510Z] New count: 1
[2025-11-15T21:59:17.510Z] Remaining: 4
[2025-11-15T21:59:17.510Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 1
[2025-11-15T21:59:17.511Z] Current count after filter: 1
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 2
[2025-11-15T21:59:17.511Z] Remaining: 3
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 2
[2025-11-15T21:59:17.511Z] Current count after filter: 2
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 3
[2025-11-15T21:59:17.511Z] Remaining: 2
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] Existing timestamps: 3
[2025-11-15T21:59:17.512Z] Current count after filter: 3
[2025-11-15T21:59:17.512Z] Max requests allowed: 5
[2025-11-15T21:59:17.512Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.512Z] New count: 4
[2025-11-15T21:59:17.512Z] Remaining: 1
[2025-11-15T21:59:17.512Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.513Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Existing timestamps: 4
[2025-11-15T21:59:17.513Z] Current count after filter: 4
[2025-11-15T21:59:17.513Z] Max requests allowed: 5
[2025-11-15T21:59:17.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.513Z] New count: 5
[2025-11-15T21:59:17.514Z] Remaining: 0
[2025-11-15T21:59:17.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.516Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.516Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.516Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] üìù Creating new entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] Current count after filter: 0
[2025-11-15T21:59:17.517Z] Max requests allowed: 5
[2025-11-15T21:59:17.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.517Z] New count: 1
[2025-11-15T21:59:17.517Z] Remaining: 4
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.517Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.517Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.517Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] Existing timestamps: 1
[2025-11-15T21:59:17.518Z] Current count after filter: 1
[2025-11-15T21:59:17.518Z] Max requests allowed: 5
[2025-11-15T21:59:17.518Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.518Z] New count: 2
[2025-11-15T21:59:17.519Z] Remaining: 3
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.519Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.519Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 2
[2025-11-15T21:59:17.520Z] Current count after filter: 2
[2025-11-15T21:59:17.520Z] Max requests allowed: 5
[2025-11-15T21:59:17.520Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.520Z] New count: 3
[2025-11-15T21:59:17.520Z] Remaining: 2
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.520Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.520Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 3
[2025-11-15T21:59:17.521Z] Current count after filter: 3
[2025-11-15T21:59:17.521Z] Max requests allowed: 5
[2025-11-15T21:59:17.521Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.521Z] New count: 4
[2025-11-15T21:59:17.521Z] Remaining: 1
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.521Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.521Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.521Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.521Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 4
[2025-11-15T21:59:17.522Z] Current count after filter: 4
[2025-11-15T21:59:17.522Z] Max requests allowed: 5
[2025-11-15T21:59:17.522Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.522Z] New count: 5
[2025-11-15T21:59:17.522Z] Remaining: 0
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.522Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.522Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.522Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 5
[2025-11-15T21:59:17.522Z] Current count after filter: 5
[2025-11-15T21:59:17.523Z] Max requests allowed: 5
[2025-11-15T21:59:17.523Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.523Z] Current count: 5
[2025-11-15T21:59:17.523Z] Max allowed: 5
[2025-11-15T21:59:17.523Z] Retry after (seconds): 60
[2025-11-15T21:59:17.523Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.525Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.525Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.525Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] üìù Creating new entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Current count after filter: 0
[2025-11-15T21:59:17.525Z] Max requests allowed: 2
[2025-11-15T21:59:17.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.525Z] New count: 1
[2025-11-15T21:59:17.525Z] Remaining: 1
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.526Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.526Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Existing timestamps: 1
[2025-11-15T21:59:17.526Z] Current count after filter: 1
[2025-11-15T21:59:17.526Z] Max requests allowed: 2
[2025-11-15T21:59:17.526Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.526Z] New count: 2
[2025-11-15T21:59:17.526Z] Remaining: 0
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.527Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.527Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Existing timestamps: 2
[2025-11-15T21:59:17.527Z] Current count after filter: 2
[2025-11-15T21:59:17.527Z] Max requests allowed: 2
[2025-11-15T21:59:17.528Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.528Z] Current count: 2
[2025-11-15T21:59:17.528Z] Max allowed: 2
[2025-11-15T21:59:17.528Z] Retry after (seconds): 1
[2025-11-15T21:59:17.528Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.678Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.679Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.679Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Existing timestamps: 2
[2025-11-15T21:59:17.679Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:59:17.679Z] Current count after filter: 0
[2025-11-15T21:59:17.679Z] Max requests allowed: 2
[2025-11-15T21:59:17.679Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.679Z] New count: 1
[2025-11-15T21:59:17.679Z] Remaining: 1
[2025-11-15T21:59:17.679Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìù Creating new entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Current count after filter: 0
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.681Z] New count: 1
[2025-11-15T21:59:17.681Z] Remaining: 4
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Existing timestamps: 1
[2025-11-15T21:59:17.681Z] Current count after filter: 1
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.682Z] New count: 2
[2025-11-15T21:59:17.682Z] Remaining: 3
[2025-11-15T21:59:17.682Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.683Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.683Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.683Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Existing timestamps: 2
[2025-11-15T21:59:17.683Z] Current count after filter: 2
[2025-11-15T21:59:17.683Z] Max requests allowed: 5
[2025-11-15T21:59:17.683Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.683Z] New count: 3
[2025-11-15T21:59:17.683Z] Remaining: 2
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.684Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.684Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Existing timestamps: 3
[2025-11-15T21:59:17.684Z] Current count after filter: 3
[2025-11-15T21:59:17.684Z] Max requests allowed: 5
[2025-11-15T21:59:17.684Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.684Z] New count: 4
[2025-11-15T21:59:17.685Z] Remaining: 1
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.685Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.685Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Existing timestamps: 4
[2025-11-15T21:59:17.685Z] Current count after filter: 4
[2025-11-15T21:59:17.685Z] Max requests allowed: 5
[2025-11-15T21:59:17.685Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.685Z] New count: 5
[2025-11-15T21:59:17.686Z] Remaining: 0
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Existing timestamps: 5
[2025-11-15T21:59:17.686Z] Current count after filter: 5
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.686Z] Current count: 5
[2025-11-15T21:59:17.686Z] Max allowed: 5
[2025-11-15T21:59:17.686Z] Retry after (seconds): 60
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] üìù Creating new entry for key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Current count after filter: 0
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.687Z] New count: 1
[2025-11-15T21:59:17.687Z] Remaining: 4
[2025-11-15T21:59:17.687Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.688Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.688Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.688Z] Identifier: test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] üìù Creating new entry for key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Current count after filter: 0
[2025-11-15T21:59:17.688Z] Max requests allowed: 5
[2025-11-15T21:59:17.689Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.690Z] New count: 1
[2025-11-15T21:59:17.690Z] Remaining: 4
[2025-11-15T21:59:17.690Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.692Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using real IP: 192.168.1.2
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.701Z] X-Test-ID header: null
[2025-11-15T21:59:17.701Z] Will use test ID?: false
[2025-11-15T21:59:17.701Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.702Z] X-Test-ID header: null
[2025-11-15T21:59:17.702Z] Will use test ID?: false
[2025-11-15T21:59:17.702Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.703Z] X-Test-ID header: null
[2025-11-15T21:59:17.703Z] Will use test ID?: false
[2025-11-15T21:59:17.703Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.703Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.703Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] üìù Creating new entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Current count after filter: 0
[2025-11-15T21:59:17.703Z] Max requests allowed: 3
[2025-11-15T21:59:17.703Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.703Z] New count: 1
[2025-11-15T21:59:17.704Z] Remaining: 2
[2025-11-15T21:59:17.704Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.810Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.811Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.812Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Existing timestamps: 1
[2025-11-15T21:59:17.812Z] Current count after filter: 1
[2025-11-15T21:59:17.812Z] Max requests allowed: 3
[2025-11-15T21:59:17.812Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.812Z] New count: 2
[2025-11-15T21:59:17.812Z] Remaining: 1
[2025-11-15T21:59:17.812Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.916Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.916Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.916Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Existing timestamps: 2
[2025-11-15T21:59:17.916Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:59:17.917Z] Current count after filter: 1
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 2
[2025-11-15T21:59:17.917Z] Remaining: 1
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.917Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.917Z] Identifier: test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] üìù Creating new entry for key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Current count after filter: 0
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 1
[2025-11-15T21:59:17.917Z] Remaining: 2
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìù Creating new entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Current count after filter: 0
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 1
[2025-11-15T21:59:17.918Z] Remaining: 2
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Existing timestamps: 1
[2025-11-15T21:59:17.918Z] Current count after filter: 1
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 2
[2025-11-15T21:59:17.918Z] Remaining: 1
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.919Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.919Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.919Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.919Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.920Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.921Z] Existing timestamps: 2
[2025-11-15T21:59:17.921Z] Current count after filter: 2
[2025-11-15T21:59:17.921Z] Max requests allowed: 3
[2025-11-15T21:59:17.921Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.921Z] New count: 3
[2025-11-15T21:59:17.921Z] Remaining: 0
[2025-11-15T21:59:17.921Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.922Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.922Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Existing timestamps: 3
[2025-11-15T21:59:17.922Z] Current count after filter: 3
[2025-11-15T21:59:17.922Z] Max requests allowed: 3
[2025-11-15T21:59:17.922Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.922Z] Current count: 3
[2025-11-15T21:59:17.922Z] Max allowed: 3
[2025-11-15T21:59:17.922Z] Retry after (seconds): 60
[2025-11-15T21:59:17.923Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:26.447Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:26.447Z] Request URL: /auth/token
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:26.448Z] X-Test-ID header: null
[2025-11-15T21:59:26.448Z] Will use test ID?: false
[2025-11-15T21:59:26.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:26.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:26.448Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:26.448Z] Identifier: unknown
[2025-11-15T21:59:26.448Z] Key: token:unknown
[2025-11-15T21:59:26.448Z] üìù Creating new entry for key: token:unknown
[2025-11-15T21:59:26.448Z] Current count after filter: 0
[2025-11-15T21:59:26.448Z] Max requests allowed: 60
[2025-11-15T21:59:26.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:26.448Z] New count: 1
[2025-11-15T21:59:26.448Z] Remaining: 59
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:26.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.104Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.104Z] Request URL: /auth/token
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.105Z] X-Test-ID header: null
[2025-11-15T21:59:27.105Z] Will use test ID?: false
[2025-11-15T21:59:27.105Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.105Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.105Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.105Z] Identifier: unknown
[2025-11-15T21:59:27.105Z] Key: token:unknown
[2025-11-15T21:59:27.105Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.105Z] Existing timestamps: 1
[2025-11-15T21:59:27.105Z] Current count after filter: 1
[2025-11-15T21:59:27.106Z] Max requests allowed: 60
[2025-11-15T21:59:27.106Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.106Z] New count: 2
[2025-11-15T21:59:27.106Z] Remaining: 58
[2025-11-15T21:59:27.106Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.106Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.981Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.982Z] Request URL: /auth/token
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.982Z] X-Test-ID header: null
[2025-11-15T21:59:27.982Z] Will use test ID?: false
[2025-11-15T21:59:27.982Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.982Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.982Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.983Z] Identifier: unknown
[2025-11-15T21:59:27.983Z] Key: token:unknown
[2025-11-15T21:59:27.983Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.983Z] Existing timestamps: 2
[2025-11-15T21:59:27.983Z] Current count after filter: 2
[2025-11-15T21:59:27.983Z] Max requests allowed: 60
[2025-11-15T21:59:27.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.983Z] New count: 3
[2025-11-15T21:59:27.983Z] Remaining: 57
[2025-11-15T21:59:27.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:28.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.448Z] Request URL: /auth/reset-password
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.448Z] X-Test-ID header: null
[2025-11-15T21:59:28.448Z] Will use test ID?: false
[2025-11-15T21:59:28.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.448Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.448Z] Identifier: unknown
[2025-11-15T21:59:28.448Z] Key: login:unknown
[2025-11-15T21:59:28.448Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:59:28.448Z] Current count after filter: 0
[2025-11-15T21:59:28.448Z] Max requests allowed: 5
[2025-11-15T21:59:28.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.448Z] New count: 1
[2025-11-15T21:59:28.448Z] Remaining: 4
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.463Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.463Z] Request URL: /auth/forgot-password
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.463Z] X-Test-ID header: null
[2025-11-15T21:59:28.463Z] Will use test ID?: false
[2025-11-15T21:59:28.463Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.463Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.463Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.463Z] Identifier: unknown
[2025-11-15T21:59:28.463Z] Key: login:unknown
[2025-11-15T21:59:28.463Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:28.463Z] Existing timestamps: 1
[2025-11-15T21:59:28.463Z] Current count after filter: 1
[2025-11-15T21:59:28.463Z] Max requests allowed: 5
[2025-11-15T21:59:28.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.464Z] New count: 2
[2025-11-15T21:59:28.464Z] Remaining: 3
[2025-11-15T21:59:28.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.464Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.498Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.498Z] Request URL: /auth/register
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.498Z] X-Test-ID header: null
[2025-11-15T21:59:28.498Z] Will use test ID?: false
[2025-11-15T21:59:28.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.498Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.498Z] Identifier: unknown
[2025-11-15T21:59:28.498Z] Key: register:unknown
[2025-11-15T21:59:28.498Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:59:28.498Z] Current count after filter: 0
[2025-11-15T21:59:28.498Z] Max requests allowed: 3
[2025-11-15T21:59:28.498Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.499Z] New count: 1
[2025-11-15T21:59:28.499Z] Remaining: 2
[2025-11-15T21:59:28.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:28.932Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.932Z] Request URL: /auth/register
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.932Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Will use test ID?: true
[2025-11-15T21:59:28.932Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.932Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.932Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.932Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] üìù Creating new entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] Current count after filter: 0
[2025-11-15T21:59:28.933Z] Max requests allowed: 3
[2025-11-15T21:59:28.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.933Z] New count: 1
[2025-11-15T21:59:28.933Z] Remaining: 2
[2025-11-15T21:59:28.933Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.933Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:28.982Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.982Z] Request URL: /auth/login
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.983Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Will use test ID?: true
[2025-11-15T21:59:28.983Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.983Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.983Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.983Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] üìù Creating new entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Current count after filter: 0
[2025-11-15T21:59:28.983Z] Max requests allowed: 5
[2025-11-15T21:59:28.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.983Z] New count: 1
[2025-11-15T21:59:28.983Z] Remaining: 4
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.176Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.176Z] Request URL: /auth/login
[2025-11-15T21:59:29.176Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.176Z] X-Test-ID header: login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Will use test ID?: true
[2025-11-15T21:59:29.177Z] ‚úÖ Using test identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.177Z] Got identifier from getClientIdentifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.177Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.177Z] Identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] üìù Creating new entry for key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Current count after filter: 0
[2025-11-15T21:59:29.177Z] Max requests allowed: 5
[2025-11-15T21:59:29.177Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.177Z] New count: 1
[2025-11-15T21:59:29.177Z] Remaining: 4
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.177Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029177
}
[2025-11-15T21:59:29.179Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.179Z] Request URL: /auth/login
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.179Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Will use test ID?: true
[2025-11-15T21:59:29.179Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.179Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.179Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.179Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] üìù Creating new entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Current count after filter: 0
[2025-11-15T21:59:29.179Z] Max requests allowed: 5
[2025-11-15T21:59:29.179Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.179Z] New count: 1
[2025-11-15T21:59:29.179Z] Remaining: 4
[2025-11-15T21:59:29.180Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.180Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.302Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.302Z] Request URL: /auth/login
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.302Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] Will use test ID?: true
[2025-11-15T21:59:29.302Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.302Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.302Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.303Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Existing timestamps: 1
[2025-11-15T21:59:29.303Z] Current count after filter: 1
[2025-11-15T21:59:29.303Z] Max requests allowed: 5
[2025-11-15T21:59:29.303Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.303Z] New count: 2
[2025-11-15T21:59:29.303Z] Remaining: 3
[2025-11-15T21:59:29.303Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.303Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.470Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.471Z] Request URL: /auth/register
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.471Z] X-Test-ID header: register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Will use test ID?: true
[2025-11-15T21:59:29.471Z] ‚úÖ Using test identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.471Z] Got identifier from getClientIdentifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.471Z] Identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] üìù Creating new entry for key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] Current count after filter: 0
[2025-11-15T21:59:29.472Z] Max requests allowed: 3
[2025-11-15T21:59:29.472Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.472Z] New count: 1
[2025-11-15T21:59:29.472Z] Remaining: 2
[2025-11-15T21:59:29.472Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.472Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029471
}
[2025-11-15T21:59:29.552Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.552Z] Request URL: /auth/register
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.552Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] Will use test ID?: true
[2025-11-15T21:59:29.552Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.553Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.553Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.553Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Existing timestamps: 1
[2025-11-15T21:59:29.553Z] Current count after filter: 1
[2025-11-15T21:59:29.553Z] Max requests allowed: 3
[2025-11-15T21:59:29.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.553Z] New count: 2
[2025-11-15T21:59:29.553Z] Remaining: 1
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.553Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.590Z] Request URL: /auth/login
[2025-11-15T21:59:29.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.591Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Will use test ID?: true
[2025-11-15T21:59:29.591Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.591Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.591Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Existing timestamps: 1
[2025-11-15T21:59:29.592Z] Current count after filter: 1
[2025-11-15T21:59:29.592Z] Max requests allowed: 5
[2025-11-15T21:59:29.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.592Z] New count: 2
[2025-11-15T21:59:29.592Z] Remaining: 3
[2025-11-15T21:59:29.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.592Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.606Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.606Z] Request URL: /auth/login
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.606Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] Will use test ID?: true
[2025-11-15T21:59:29.606Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.607Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.607Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.607Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Existing timestamps: 2
[2025-11-15T21:59:29.607Z] Current count after filter: 2
[2025-11-15T21:59:29.607Z] Max requests allowed: 5
[2025-11-15T21:59:29.607Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.607Z] New count: 3
[2025-11-15T21:59:29.607Z] Remaining: 2
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.607Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.850Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.850Z] Request URL: /auth/verify-email
[2025-11-15T21:59:29.850Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.850Z] X-Test-ID header: null
[2025-11-15T21:59:29.850Z] Will use test ID?: false
[2025-11-15T21:59:29.851Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.851Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.851Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.851Z] Identifier: unknown
[2025-11-15T21:59:29.851Z] Key: login:unknown
[2025-11-15T21:59:29.852Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:29.852Z] Existing timestamps: 2
[2025-11-15T21:59:29.852Z] Current count after filter: 2
[2025-11-15T21:59:29.852Z] Max requests allowed: 5
[2025-11-15T21:59:29.852Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.852Z] New count: 3
[2025-11-15T21:59:29.852Z] Remaining: 2
[2025-11-15T21:59:29.852Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.852Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:29.857Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.857Z] Request URL: /auth/login
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.858Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Will use test ID?: true
[2025-11-15T21:59:29.858Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.858Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.858Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.858Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Existing timestamps: 2
[2025-11-15T21:59:29.859Z] Current count after filter: 2
[2025-11-15T21:59:29.859Z] Max requests allowed: 5
[2025-11-15T21:59:29.859Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.859Z] New count: 3
[2025-11-15T21:59:29.859Z] Remaining: 2
[2025-11-15T21:59:29.859Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.859Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.886Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.886Z] Request URL: /auth/register
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.886Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] Will use test ID?: true
[2025-11-15T21:59:29.886Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.886Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.886Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.887Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Existing timestamps: 2
[2025-11-15T21:59:29.887Z] Current count after filter: 2
[2025-11-15T21:59:29.887Z] Max requests allowed: 3
[2025-11-15T21:59:29.887Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.887Z] New count: 3
[2025-11-15T21:59:29.888Z] Remaining: 0
[2025-11-15T21:59:29.888Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.888Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.941Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.941Z] Request URL: /auth/login
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.942Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] Will use test ID?: true
[2025-11-15T21:59:29.942Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.943Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.943Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] üìù Creating new entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Current count after filter: 0
[2025-11-15T21:59:29.943Z] Max requests allowed: 5
[2025-11-15T21:59:29.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.943Z] New count: 1
[2025-11-15T21:59:29.943Z] Remaining: 4
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.081Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.081Z] Request URL: /auth/login
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.081Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] Will use test ID?: true
[2025-11-15T21:59:30.081Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.081Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.082Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.082Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Existing timestamps: 3
[2025-11-15T21:59:30.082Z] Current count after filter: 3
[2025-11-15T21:59:30.082Z] Max requests allowed: 5
[2025-11-15T21:59:30.082Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.082Z] New count: 4
[2025-11-15T21:59:30.082Z] Remaining: 1
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.082Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.108Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.108Z] Request URL: /auth/login
[2025-11-15T21:59:30.108Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.108Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.109Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Will use test ID?: true
[2025-11-15T21:59:30.109Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.109Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.109Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.109Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Existing timestamps: 3
[2025-11-15T21:59:30.109Z] Current count after filter: 3
[2025-11-15T21:59:30.109Z] Max requests allowed: 5
[2025-11-15T21:59:30.109Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.109Z] New count: 4
[2025-11-15T21:59:30.109Z] Remaining: 1
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.109Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.180Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.180Z] Request URL: /auth/login
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.181Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Will use test ID?: true
[2025-11-15T21:59:30.181Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.181Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.181Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.181Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] Existing timestamps: 1
[2025-11-15T21:59:30.182Z] Current count after filter: 1
[2025-11-15T21:59:30.182Z] Max requests allowed: 5
[2025-11-15T21:59:30.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.182Z] New count: 2
[2025-11-15T21:59:30.182Z] Remaining: 3
[2025-11-15T21:59:30.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.182Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.267Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:30.267Z] Request URL: /auth/register
[2025-11-15T21:59:30.267Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.268Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] Will use test ID?: true
[2025-11-15T21:59:30.268Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.268Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.269Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:30.269Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Existing timestamps: 3
[2025-11-15T21:59:30.269Z] Current count after filter: 3
[2025-11-15T21:59:30.269Z] Max requests allowed: 3
[2025-11-15T21:59:30.269Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.269Z] Current count: 3
[2025-11-15T21:59:30.269Z] Max allowed: 3
[2025-11-15T21:59:30.269Z] Retry after (seconds): 59
[2025-11-15T21:59:30.270Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.270Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028932,
  "retryAfter": 59
}
[2025-11-15T21:59:30.283Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.283Z] Request URL: /auth/login
[2025-11-15T21:59:30.283Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.283Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.283Z] Will use test ID?: true
[2025-11-15T21:59:30.283Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.284Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.284Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] üìù Creating new entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Current count after filter: 0
[2025-11-15T21:59:30.284Z] Max requests allowed: 5
[2025-11-15T21:59:30.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.284Z] New count: 1
[2025-11-15T21:59:30.284Z] Remaining: 4
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.340Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.340Z] Request URL: /auth/login
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.340Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] Will use test ID?: true
[2025-11-15T21:59:30.340Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.340Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.340Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.341Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Existing timestamps: 4
[2025-11-15T21:59:30.341Z] Current count after filter: 4
[2025-11-15T21:59:30.341Z] Max requests allowed: 5
[2025-11-15T21:59:30.341Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.341Z] New count: 5
[2025-11-15T21:59:30.341Z] Remaining: 0
[2025-11-15T21:59:30.341Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.341Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.375Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.375Z] Request URL: /auth/login
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.375Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] Will use test ID?: true
[2025-11-15T21:59:30.375Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.375Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.375Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.375Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Existing timestamps: 4
[2025-11-15T21:59:30.376Z] Current count after filter: 4
[2025-11-15T21:59:30.376Z] Max requests allowed: 5
[2025-11-15T21:59:30.376Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.376Z] New count: 5
[2025-11-15T21:59:30.376Z] Remaining: 0
[2025-11-15T21:59:30.376Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.376Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.408Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.408Z] Request URL: /auth/login
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.408Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] Will use test ID?: true
[2025-11-15T21:59:30.408Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.408Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.408Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.409Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Existing timestamps: 2
[2025-11-15T21:59:30.409Z] Current count after filter: 2
[2025-11-15T21:59:30.409Z] Max requests allowed: 5
[2025-11-15T21:59:30.409Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.409Z] New count: 3
[2025-11-15T21:59:30.409Z] Remaining: 2
[2025-11-15T21:59:30.409Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.409Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.601Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.601Z] Request URL: /auth/login
[2025-11-15T21:59:30.601Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.601Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.601Z] Will use test ID?: true
[2025-11-15T21:59:30.601Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.602Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.602Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.602Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Existing timestamps: 5
[2025-11-15T21:59:30.602Z] Current count after filter: 5
[2025-11-15T21:59:30.602Z] Max requests allowed: 5
[2025-11-15T21:59:30.602Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.602Z] Current count: 5
[2025-11-15T21:59:30.602Z] Max allowed: 5
[2025-11-15T21:59:30.602Z] Retry after (seconds): 59
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.602Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029179,
  "retryAfter": 59
}
[2025-11-15T21:59:30.612Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.612Z] Request URL: /auth/login
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.612Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Will use test ID?: true
[2025-11-15T21:59:30.612Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.612Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.612Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] üìù Creating new entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Current count after filter: 0
[2025-11-15T21:59:30.612Z] Max requests allowed: 5
[2025-11-15T21:59:30.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.612Z] New count: 1
[2025-11-15T21:59:30.612Z] Remaining: 4
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.613Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.649Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.649Z] Request URL: /auth/login
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.649Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Will use test ID?: true
[2025-11-15T21:59:30.649Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.649Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.649Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.649Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.650Z] Existing timestamps: 3
[2025-11-15T21:59:30.650Z] Current count after filter: 3
[2025-11-15T21:59:30.650Z] Max requests allowed: 5
[2025-11-15T21:59:30.650Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.650Z] New count: 4
[2025-11-15T21:59:30.650Z] Remaining: 1
[2025-11-15T21:59:30.650Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.650Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.654Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.654Z] Request URL: /auth/login
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.654Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Will use test ID?: true
[2025-11-15T21:59:30.654Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.654Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.654Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.654Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Existing timestamps: 5
[2025-11-15T21:59:30.654Z] Current count after filter: 5
[2025-11-15T21:59:30.654Z] Max requests allowed: 5
[2025-11-15T21:59:30.654Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.654Z] Current count: 5
[2025-11-15T21:59:30.654Z] Max allowed: 5
[2025-11-15T21:59:30.654Z] Retry after (seconds): 59
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.654Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028983,
  "retryAfter": 59
}
[2025-11-15T21:59:30.664Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.664Z] Request URL: /auth/login
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.664Z] X-Test-ID header: perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Will use test ID?: true
[2025-11-15T21:59:30.664Z] ‚úÖ Using test identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.664Z] Got identifier from getClientIdentifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.664Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.664Z] Identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] üìù Creating new entry for key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Current count after filter: 0
[2025-11-15T21:59:30.664Z] Max requests allowed: 5
[2025-11-15T21:59:30.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.664Z] New count: 1
[2025-11-15T21:59:30.664Z] Remaining: 4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.664Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030664
}
[2025-11-15T21:59:30.668Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.668Z] Request URL: /auth/login
[2025-11-15T21:59:30.668Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.668Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Will use test ID?: true
[2025-11-15T21:59:30.669Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.669Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.669Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.669Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Existing timestamps: 1
[2025-11-15T21:59:30.669Z] Current count after filter: 1
[2025-11-15T21:59:30.669Z] Max requests allowed: 5
[2025-11-15T21:59:30.669Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.669Z] New count: 2
[2025-11-15T21:59:30.669Z] Remaining: 3
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.669Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.848Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.848Z] Request URL: /auth/login
[2025-11-15T21:59:30.848Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.848Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.848Z] Will use test ID?: true
[2025-11-15T21:59:30.849Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.849Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.849Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.849Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] üìñ Found existing entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Existing timestamps: 1
[2025-11-15T21:59:30.849Z] Current count after filter: 1
[2025-11-15T21:59:30.849Z] Max requests allowed: 5
[2025-11-15T21:59:30.849Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.849Z] New count: 2
[2025-11-15T21:59:30.849Z] Remaining: 3
[2025-11-15T21:59:30.850Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.850Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.881Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.887Z] Request URL: /auth/login
[2025-11-15T21:59:30.887Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.887Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.888Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.888Z] Will use test ID?: true
[2025-11-15T21:59:30.889Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.889Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.889Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.889Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Existing timestamps: 4
[2025-11-15T21:59:30.889Z] Current count after filter: 4
[2025-11-15T21:59:30.889Z] Max requests allowed: 5
[2025-11-15T21:59:30.890Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.890Z] New count: 5
[2025-11-15T21:59:30.890Z] Remaining: 0
[2025-11-15T21:59:30.890Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.890Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.909Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.909Z] Request URL: /auth/login
[2025-11-15T21:59:30.909Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.910Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Will use test ID?: true
[2025-11-15T21:59:30.910Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.910Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.910Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.910Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] Existing timestamps: 2
[2025-11-15T21:59:30.911Z] Current count after filter: 2
[2025-11-15T21:59:30.911Z] Max requests allowed: 5
[2025-11-15T21:59:30.911Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.911Z] New count: 3
[2025-11-15T21:59:30.911Z] Remaining: 2
[2025-11-15T21:59:30.911Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.911Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:31.137Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:31.137Z] Request URL: /auth/login
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.138Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] Will use test ID?: true
[2025-11-15T21:59:31.138Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.139Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.139Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:31.139Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Existing timestamps: 5
[2025-11-15T21:59:31.139Z] Current count after filter: 5
[2025-11-15T21:59:31.139Z] Max requests allowed: 5
[2025-11-15T21:59:31.140Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:31.140Z] Current count: 5
[2025-11-15T21:59:31.140Z] Max allowed: 5
[2025-11-15T21:59:31.140Z] Retry after (seconds): 59
[2025-11-15T21:59:31.140Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:31.140Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029943,
  "retryAfter": 59
}
[2025-11-15T21:59:31.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:31.150Z] Request URL: /auth/register
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.151Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] Will use test ID?: true
[2025-11-15T21:59:31.151Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.151Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:31.152Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] üìù Creating new entry for key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Current count after filter: 0
[2025-11-15T21:59:31.152Z] Max requests allowed: 3
[2025-11-15T21:59:31.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:31.152Z] New count: 1
[2025-11-15T21:59:31.152Z] Remaining: 2
[2025-11-15T21:59:31.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:31.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244031151
}
[2025-11-15T21:59:34.064Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:34.065Z] Request URL: /auth/register
[2025-11-15T21:59:34.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.065Z] X-Test-ID header: null
[2025-11-15T21:59:34.065Z] Will use test ID?: false
[2025-11-15T21:59:34.066Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.066Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.066Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:34.066Z] Identifier: unknown
[2025-11-15T21:59:34.066Z] Key: register:unknown
[2025-11-15T21:59:34.066Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:59:34.066Z] Existing timestamps: 1
[2025-11-15T21:59:34.066Z] Current count after filter: 1
[2025-11-15T21:59:34.066Z] Max requests allowed: 3
[2025-11-15T21:59:34.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.066Z] New count: 2
[2025-11-15T21:59:34.066Z] Remaining: 1
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:34.942Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:34.943Z] Request URL: /auth/verify-email
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.943Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Will use test ID?: true
[2025-11-15T21:59:34.943Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.943Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:34.943Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] üìù Creating new entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Current count after filter: 0
[2025-11-15T21:59:34.943Z] Max requests allowed: 5
[2025-11-15T21:59:34.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.943Z] New count: 1
[2025-11-15T21:59:34.943Z] Remaining: 4
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.253Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.253Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.253Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.254Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.254Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Will use test ID?: true
[2025-11-15T21:59:35.254Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.254Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.254Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Existing timestamps: 1
[2025-11-15T21:59:35.254Z] Current count after filter: 1
[2025-11-15T21:59:35.254Z] Max requests allowed: 5
[2025-11-15T21:59:35.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.254Z] New count: 2
[2025-11-15T21:59:35.254Z] Remaining: 3
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.255Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.625Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.626Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.626Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Will use test ID?: true
[2025-11-15T21:59:35.626Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.626Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.626Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.626Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Existing timestamps: 2
[2025-11-15T21:59:35.626Z] Current count after filter: 2
[2025-11-15T21:59:35.626Z] Max requests allowed: 5
[2025-11-15T21:59:35.626Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.626Z] New count: 3
[2025-11-15T21:59:35.626Z] Remaining: 2
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.626Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.975Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.975Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.975Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.976Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Will use test ID?: true
[2025-11-15T21:59:35.976Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.976Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.976Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Existing timestamps: 3
[2025-11-15T21:59:35.976Z] Current count after filter: 3
[2025-11-15T21:59:35.976Z] Max requests allowed: 5
[2025-11-15T21:59:35.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.976Z] New count: 4
[2025-11-15T21:59:35.976Z] Remaining: 1
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.976Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:36.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:36.274Z] Request URL: /auth/verify-email
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:36.275Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Will use test ID?: true
[2025-11-15T21:59:36.275Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:36.275Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:36.275Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:36.275Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] Existing timestamps: 4
[2025-11-15T21:59:36.276Z] Current count after filter: 4
[2025-11-15T21:59:36.276Z] Max requests allowed: 5
[2025-11-15T21:59:36.276Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:36.276Z] New count: 5
[2025-11-15T21:59:36.276Z] Remaining: 0
[2025-11-15T21:59:36.276Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:36.276Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244034943
}
[2025-11-17T07:56:21.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.946Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] üìù Creating new entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Current count after filter: 0
[2025-11-17T07:56:21.946Z] Max requests allowed: 5
[2025-11-17T07:56:21.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.946Z] New count: 1
[2025-11-17T07:56:21.946Z] Remaining: 4
[2025-11-17T07:56:21.946Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.946Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.946Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Existing timestamps: 1
[2025-11-17T07:56:21.946Z] Current count after filter: 1
[2025-11-17T07:56:21.946Z] Max requests allowed: 5
[2025-11-17T07:56:21.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.946Z] New count: 2
[2025-11-17T07:56:21.946Z] Remaining: 3
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.947Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Existing timestamps: 2
[2025-11-17T07:56:21.947Z] Current count after filter: 2
[2025-11-17T07:56:21.947Z] Max requests allowed: 5
[2025-11-17T07:56:21.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.947Z] New count: 3
[2025-11-17T07:56:21.947Z] Remaining: 2
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.947Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Existing timestamps: 3
[2025-11-17T07:56:21.947Z] Current count after filter: 3
[2025-11-17T07:56:21.947Z] Max requests allowed: 5
[2025-11-17T07:56:21.948Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.948Z] New count: 4
[2025-11-17T07:56:21.948Z] Remaining: 1
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.948Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.948Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.948Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.948Z] Existing timestamps: 4
[2025-11-17T07:56:21.948Z] Current count after filter: 4
[2025-11-17T07:56:21.948Z] Max requests allowed: 5
[2025-11-17T07:56:21.948Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.948Z] New count: 5
[2025-11-17T07:56:21.948Z] Remaining: 0
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.949Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] üìù Creating new entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] Current count after filter: 0
[2025-11-17T07:56:21.949Z] Max requests allowed: 5
[2025-11-17T07:56:21.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.949Z] New count: 1
[2025-11-17T07:56:21.949Z] Remaining: 4
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.949Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] Existing timestamps: 1
[2025-11-17T07:56:21.949Z] Current count after filter: 1
[2025-11-17T07:56:21.949Z] Max requests allowed: 5
[2025-11-17T07:56:21.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.949Z] New count: 2
[2025-11-17T07:56:21.949Z] Remaining: 3
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 2
[2025-11-17T07:56:21.950Z] Current count after filter: 2
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 3
[2025-11-17T07:56:21.950Z] Remaining: 2
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.950Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 3
[2025-11-17T07:56:21.950Z] Current count after filter: 3
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 4
[2025-11-17T07:56:21.950Z] Remaining: 1
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.950Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 4
[2025-11-17T07:56:21.950Z] Current count after filter: 4
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 5
[2025-11-17T07:56:21.950Z] Remaining: 0
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.951Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.951Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.951Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.951Z] Existing timestamps: 5
[2025-11-17T07:56:21.951Z] Current count after filter: 5
[2025-11-17T07:56:21.951Z] Max requests allowed: 5
[2025-11-17T07:56:21.951Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:21.951Z] Current count: 5
[2025-11-17T07:56:21.951Z] Max allowed: 5
[2025-11-17T07:56:21.951Z] Retry after (seconds): 60
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.951Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.951Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.951Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.951Z] üìù Creating new entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.951Z] Current count after filter: 0
[2025-11-17T07:56:21.951Z] Max requests allowed: 2
[2025-11-17T07:56:21.951Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.951Z] New count: 1
[2025-11-17T07:56:21.951Z] Remaining: 1
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.951Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.951Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Existing timestamps: 1
[2025-11-17T07:56:21.952Z] Current count after filter: 1
[2025-11-17T07:56:21.952Z] Max requests allowed: 2
[2025-11-17T07:56:21.952Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.952Z] New count: 2
[2025-11-17T07:56:21.952Z] Remaining: 0
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.952Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.952Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Existing timestamps: 2
[2025-11-17T07:56:21.952Z] Current count after filter: 2
[2025-11-17T07:56:21.952Z] Max requests allowed: 2
[2025-11-17T07:56:21.952Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:21.952Z] Current count: 2
[2025-11-17T07:56:21.952Z] Max allowed: 2
[2025-11-17T07:56:21.952Z] Retry after (seconds): 1
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:22.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.121Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:22.121Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:22.121Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:22.121Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:22.121Z] Existing timestamps: 2
[2025-11-17T07:56:22.121Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-17T07:56:22.121Z] Current count after filter: 0
[2025-11-17T07:56:22.121Z] Max requests allowed: 2
[2025-11-17T07:56:22.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.121Z] New count: 1
[2025-11-17T07:56:22.122Z] Remaining: 1
[2025-11-17T07:56:22.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.122Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.122Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.122Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] üìù Creating new entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Current count after filter: 0
[2025-11-17T07:56:22.123Z] Max requests allowed: 5
[2025-11-17T07:56:22.123Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.123Z] New count: 1
[2025-11-17T07:56:22.123Z] Remaining: 4
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.123Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.123Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Existing timestamps: 1
[2025-11-17T07:56:22.123Z] Current count after filter: 1
[2025-11-17T07:56:22.123Z] Max requests allowed: 5
[2025-11-17T07:56:22.123Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.123Z] New count: 2
[2025-11-17T07:56:22.123Z] Remaining: 3
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.124Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.124Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Existing timestamps: 2
[2025-11-17T07:56:22.124Z] Current count after filter: 2
[2025-11-17T07:56:22.124Z] Max requests allowed: 5
[2025-11-17T07:56:22.124Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.124Z] New count: 3
[2025-11-17T07:56:22.124Z] Remaining: 2
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.124Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.124Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Existing timestamps: 3
[2025-11-17T07:56:22.124Z] Current count after filter: 3
[2025-11-17T07:56:22.125Z] Max requests allowed: 5
[2025-11-17T07:56:22.125Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.125Z] New count: 4
[2025-11-17T07:56:22.125Z] Remaining: 1
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.125Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.125Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Existing timestamps: 4
[2025-11-17T07:56:22.125Z] Current count after filter: 4
[2025-11-17T07:56:22.125Z] Max requests allowed: 5
[2025-11-17T07:56:22.125Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.125Z] New count: 5
[2025-11-17T07:56:22.125Z] Remaining: 0
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.125Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.125Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.126Z] Existing timestamps: 5
[2025-11-17T07:56:22.126Z] Current count after filter: 5
[2025-11-17T07:56:22.126Z] Max requests allowed: 5
[2025-11-17T07:56:22.126Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:22.126Z] Current count: 5
[2025-11-17T07:56:22.126Z] Max allowed: 5
[2025-11-17T07:56:22.126Z] Retry after (seconds): 60
[2025-11-17T07:56:22.126Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:22.126Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.127Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.127Z] Identifier: test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] Key: login:test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] üìù Creating new entry for key: login:test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] Current count after filter: 0
[2025-11-17T07:56:22.127Z] Max requests allowed: 5
[2025-11-17T07:56:22.127Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.127Z] New count: 1
[2025-11-17T07:56:22.127Z] Remaining: 4
[2025-11-17T07:56:22.127Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.128Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.128Z] Identifier: test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] Key: login:test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] üìù Creating new entry for key: login:test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] Current count after filter: 0
[2025-11-17T07:56:22.128Z] Max requests allowed: 5
[2025-11-17T07:56:22.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.128Z] New count: 1
[2025-11-17T07:56:22.128Z] Remaining: 4
[2025-11-17T07:56:22.128Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.129Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.129Z] X-Test-ID header: null
[2025-11-17T07:56:22.129Z] Will use test ID?: false
[2025-11-17T07:56:22.129Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.129Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.130Z] Using real IP: 192.168.1.2
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.130Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.131Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.131Z] X-Test-ID header: null
[2025-11-17T07:56:22.131Z] Will use test ID?: false
[2025-11-17T07:56:22.131Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.131Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.131Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.131Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] üìù Creating new entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] Current count after filter: 0
[2025-11-17T07:56:22.131Z] Max requests allowed: 3
[2025-11-17T07:56:22.131Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.131Z] New count: 1
[2025-11-17T07:56:22.131Z] Remaining: 2
[2025-11-17T07:56:22.131Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.233Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.233Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] Existing timestamps: 1
[2025-11-17T07:56:22.233Z] Current count after filter: 1
[2025-11-17T07:56:22.233Z] Max requests allowed: 3
[2025-11-17T07:56:22.233Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.233Z] New count: 2
[2025-11-17T07:56:22.233Z] Remaining: 1
[2025-11-17T07:56:22.233Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.335Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.335Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.335Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] Existing timestamps: 2
[2025-11-17T07:56:22.335Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-17T07:56:22.335Z] Current count after filter: 1
[2025-11-17T07:56:22.336Z] Max requests allowed: 3
[2025-11-17T07:56:22.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.336Z] New count: 2
[2025-11-17T07:56:22.336Z] Remaining: 1
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.336Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.336Z] Identifier: test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] Key: register:test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] üìù Creating new entry for key: register:test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] Current count after filter: 0
[2025-11-17T07:56:22.336Z] Max requests allowed: 3
[2025-11-17T07:56:22.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.336Z] New count: 1
[2025-11-17T07:56:22.336Z] Remaining: 2
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìù Creating new entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Current count after filter: 0
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.337Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.337Z] New count: 1
[2025-11-17T07:56:22.337Z] Remaining: 2
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Existing timestamps: 1
[2025-11-17T07:56:22.337Z] Current count after filter: 1
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.337Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.337Z] New count: 2
[2025-11-17T07:56:22.337Z] Remaining: 1
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Existing timestamps: 2
[2025-11-17T07:56:22.337Z] Current count after filter: 2
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.338Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.338Z] New count: 3
[2025-11-17T07:56:22.338Z] Remaining: 0
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.338Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.338Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] Existing timestamps: 3
[2025-11-17T07:56:22.338Z] Current count after filter: 3
[2025-11-17T07:56:22.338Z] Max requests allowed: 3
[2025-11-17T07:56:22.338Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:22.338Z] Current count: 3
[2025-11-17T07:56:22.338Z] Max allowed: 3
[2025-11-17T07:56:22.338Z] Retry after (seconds): 60
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.590Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.590Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.590Z] üìù Creating new entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.590Z] Current count after filter: 0
[2025-11-17T08:01:53.590Z] Max requests allowed: 5
[2025-11-17T08:01:53.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.590Z] New count: 1
[2025-11-17T08:01:53.590Z] Remaining: 4
[2025-11-17T08:01:53.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.591Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Existing timestamps: 1
[2025-11-17T08:01:53.591Z] Current count after filter: 1
[2025-11-17T08:01:53.591Z] Max requests allowed: 5
[2025-11-17T08:01:53.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.591Z] New count: 2
[2025-11-17T08:01:53.591Z] Remaining: 3
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.591Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Existing timestamps: 2
[2025-11-17T08:01:53.591Z] Current count after filter: 2
[2025-11-17T08:01:53.591Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 3
[2025-11-17T08:01:53.592Z] Remaining: 2
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.592Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Existing timestamps: 3
[2025-11-17T08:01:53.592Z] Current count after filter: 3
[2025-11-17T08:01:53.592Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 4
[2025-11-17T08:01:53.592Z] Remaining: 1
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.592Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Existing timestamps: 4
[2025-11-17T08:01:53.592Z] Current count after filter: 4
[2025-11-17T08:01:53.592Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 5
[2025-11-17T08:01:53.592Z] Remaining: 0
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.593Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.593Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] üìù Creating new entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] Current count after filter: 0
[2025-11-17T08:01:53.593Z] Max requests allowed: 5
[2025-11-17T08:01:53.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.593Z] New count: 1
[2025-11-17T08:01:53.593Z] Remaining: 4
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.593Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.593Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] Existing timestamps: 1
[2025-11-17T08:01:53.593Z] Current count after filter: 1
[2025-11-17T08:01:53.593Z] Max requests allowed: 5
[2025-11-17T08:01:53.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.593Z] New count: 2
[2025-11-17T08:01:53.593Z] Remaining: 3
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 2
[2025-11-17T08:01:53.594Z] Current count after filter: 2
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 3
[2025-11-17T08:01:53.594Z] Remaining: 2
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 3
[2025-11-17T08:01:53.594Z] Current count after filter: 3
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 4
[2025-11-17T08:01:53.594Z] Remaining: 1
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 4
[2025-11-17T08:01:53.594Z] Current count after filter: 4
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 5
[2025-11-17T08:01:53.594Z] Remaining: 0
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.595Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.595Z] Existing timestamps: 5
[2025-11-17T08:01:53.595Z] Current count after filter: 5
[2025-11-17T08:01:53.595Z] Max requests allowed: 5
[2025-11-17T08:01:53.595Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.595Z] Current count: 5
[2025-11-17T08:01:53.595Z] Max allowed: 5
[2025-11-17T08:01:53.595Z] Retry after (seconds): 60
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.595Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.595Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] üìù Creating new entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Current count after filter: 0
[2025-11-17T08:01:53.595Z] Max requests allowed: 2
[2025-11-17T08:01:53.595Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.595Z] New count: 1
[2025-11-17T08:01:53.595Z] Remaining: 1
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.595Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.595Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Existing timestamps: 1
[2025-11-17T08:01:53.595Z] Current count after filter: 1
[2025-11-17T08:01:53.595Z] Max requests allowed: 2
[2025-11-17T08:01:53.596Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.596Z] New count: 2
[2025-11-17T08:01:53.596Z] Remaining: 0
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.596Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.596Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.596Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.596Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.596Z] Existing timestamps: 2
[2025-11-17T08:01:53.596Z] Current count after filter: 2
[2025-11-17T08:01:53.596Z] Max requests allowed: 2
[2025-11-17T08:01:53.596Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.596Z] Current count: 2
[2025-11-17T08:01:53.596Z] Max allowed: 2
[2025-11-17T08:01:53.596Z] Retry after (seconds): 1
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.749Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.749Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.749Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.749Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.749Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.749Z] Existing timestamps: 2
[2025-11-17T08:01:53.749Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-17T08:01:53.749Z] Current count after filter: 0
[2025-11-17T08:01:53.749Z] Max requests allowed: 2
[2025-11-17T08:01:53.749Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.749Z] New count: 1
[2025-11-17T08:01:53.750Z] Remaining: 1
[2025-11-17T08:01:53.750Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.751Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.751Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] üìù Creating new entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] Current count after filter: 0
[2025-11-17T08:01:53.751Z] Max requests allowed: 5
[2025-11-17T08:01:53.751Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.751Z] New count: 1
[2025-11-17T08:01:53.751Z] Remaining: 4
[2025-11-17T08:01:53.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.753Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] Existing timestamps: 1
[2025-11-17T08:01:53.754Z] Current count after filter: 1
[2025-11-17T08:01:53.754Z] Max requests allowed: 5
[2025-11-17T08:01:53.754Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.754Z] New count: 2
[2025-11-17T08:01:53.754Z] Remaining: 3
[2025-11-17T08:01:53.754Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.754Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.754Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.755Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] Existing timestamps: 2
[2025-11-17T08:01:53.755Z] Current count after filter: 2
[2025-11-17T08:01:53.755Z] Max requests allowed: 5
[2025-11-17T08:01:53.755Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.755Z] New count: 3
[2025-11-17T08:01:53.755Z] Remaining: 2
[2025-11-17T08:01:53.755Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.755Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.755Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.756Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Existing timestamps: 3
[2025-11-17T08:01:53.756Z] Current count after filter: 3
[2025-11-17T08:01:53.756Z] Max requests allowed: 5
[2025-11-17T08:01:53.756Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.756Z] New count: 4
[2025-11-17T08:01:53.756Z] Remaining: 1
[2025-11-17T08:01:53.756Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.756Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.756Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.756Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Existing timestamps: 4
[2025-11-17T08:01:53.757Z] Current count after filter: 4
[2025-11-17T08:01:53.757Z] Max requests allowed: 5
[2025-11-17T08:01:53.757Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.757Z] New count: 5
[2025-11-17T08:01:53.757Z] Remaining: 0
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.757Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.757Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Existing timestamps: 5
[2025-11-17T08:01:53.757Z] Current count after filter: 5
[2025-11-17T08:01:53.757Z] Max requests allowed: 5
[2025-11-17T08:01:53.757Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.757Z] Current count: 5
[2025-11-17T08:01:53.757Z] Max allowed: 5
[2025-11-17T08:01:53.757Z] Retry after (seconds): 60
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.757Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.757Z] Identifier: test-multi-2-1763366513750
[2025-11-17T08:01:53.757Z] Key: login:test-multi-2-1763366513750
[2025-11-17T08:01:53.759Z] üìù Creating new entry for key: login:test-multi-2-1763366513750
[2025-11-17T08:01:53.759Z] Current count after filter: 0
[2025-11-17T08:01:53.759Z] Max requests allowed: 5
[2025-11-17T08:01:53.759Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.759Z] New count: 1
[2025-11-17T08:01:53.759Z] Remaining: 4
[2025-11-17T08:01:53.759Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.760Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.760Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.760Z] Identifier: test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] Key: login:test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] üìù Creating new entry for key: login:test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] Current count after filter: 0
[2025-11-17T08:01:53.760Z] Max requests allowed: 5
[2025-11-17T08:01:53.760Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.760Z] New count: 1
[2025-11-17T08:01:53.760Z] Remaining: 4
[2025-11-17T08:01:53.760Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.761Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.761Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.761Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.762Z] X-Test-ID header: null
[2025-11-17T08:01:53.762Z] Will use test ID?: false
[2025-11-17T08:01:53.762Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.762Z] X-Test-ID header: null
[2025-11-17T08:01:53.762Z] Will use test ID?: false
[2025-11-17T08:01:53.762Z] Using real IP: 192.168.1.2
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.763Z] X-Test-ID header: null
[2025-11-17T08:01:53.763Z] Will use test ID?: false
[2025-11-17T08:01:53.763Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.763Z] X-Test-ID header: null
[2025-11-17T08:01:53.763Z] Will use test ID?: false
[2025-11-17T08:01:53.763Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.764Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.765Z] X-Test-ID header: null
[2025-11-17T08:01:53.765Z] Will use test ID?: false
[2025-11-17T08:01:53.765Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.765Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.765Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.765Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] üìù Creating new entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] Current count after filter: 0
[2025-11-17T08:01:53.765Z] Max requests allowed: 3
[2025-11-17T08:01:53.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.765Z] New count: 1
[2025-11-17T08:01:53.765Z] Remaining: 2
[2025-11-17T08:01:53.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.866Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.876Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.876Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] Existing timestamps: 1
[2025-11-17T08:01:53.876Z] Current count after filter: 1
[2025-11-17T08:01:53.876Z] Max requests allowed: 3
[2025-11-17T08:01:53.876Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.876Z] New count: 2
[2025-11-17T08:01:53.876Z] Remaining: 1
[2025-11-17T08:01:53.876Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.979Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.979Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] Existing timestamps: 2
[2025-11-17T08:01:53.979Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-17T08:01:53.979Z] Current count after filter: 1
[2025-11-17T08:01:53.979Z] Max requests allowed: 3
[2025-11-17T08:01:53.979Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.979Z] New count: 2
[2025-11-17T08:01:53.979Z] Remaining: 1
[2025-11-17T08:01:53.979Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.980Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.980Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.980Z] Identifier: test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] Key: register:test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] üìù Creating new entry for key: register:test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] Current count after filter: 0
[2025-11-17T08:01:53.980Z] Max requests allowed: 3
[2025-11-17T08:01:53.980Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.980Z] New count: 1
[2025-11-17T08:01:53.980Z] Remaining: 2
[2025-11-17T08:01:53.980Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.981Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.981Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.981Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] üìù Creating new entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] Current count after filter: 0
[2025-11-17T08:01:53.981Z] Max requests allowed: 3
[2025-11-17T08:01:53.981Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.981Z] New count: 1
[2025-11-17T08:01:53.981Z] Remaining: 2
[2025-11-17T08:01:53.981Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.982Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.982Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Existing timestamps: 1
[2025-11-17T08:01:53.982Z] Current count after filter: 1
[2025-11-17T08:01:53.982Z] Max requests allowed: 3
[2025-11-17T08:01:53.982Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.982Z] New count: 2
[2025-11-17T08:01:53.982Z] Remaining: 1
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.982Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.982Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.983Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.983Z] Existing timestamps: 2
[2025-11-17T08:01:53.983Z] Current count after filter: 2
[2025-11-17T08:01:53.983Z] Max requests allowed: 3
[2025-11-17T08:01:53.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.984Z] New count: 3
[2025-11-17T08:01:53.984Z] Remaining: 0
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.985Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.985Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] Existing timestamps: 3
[2025-11-17T08:01:53.985Z] Current count after filter: 3
[2025-11-17T08:01:53.985Z] Max requests allowed: 3
[2025-11-17T08:01:53.985Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.985Z] Current count: 3
[2025-11-17T08:01:53.985Z] Max allowed: 3
[2025-11-17T08:01:53.985Z] Retry after (seconds): 60
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:04.077Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.078Z] Request URL: /auth/forgot-password
[2025-11-17T08:02:04.078Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.078Z] X-Test-ID header: null
[2025-11-17T08:02:04.078Z] Will use test ID?: false
[2025-11-17T08:02:04.078Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.078Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.078Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.078Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.078Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.078Z] Identifier: unknown
[2025-11-17T08:02:04.078Z] Key: login:unknown
[2025-11-17T08:02:04.078Z] üìù Creating new entry for key: login:unknown
[2025-11-17T08:02:04.078Z] Current count after filter: 0
[2025-11-17T08:02:04.078Z] Max requests allowed: 5
[2025-11-17T08:02:04.078Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.078Z] New count: 1
[2025-11-17T08:02:04.078Z] Remaining: 4
[2025-11-17T08:02:04.078Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.079Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:04.109Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:04.113Z] Request URL: /auth/register
[2025-11-17T08:02:04.114Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.114Z] X-Test-ID header: null
[2025-11-17T08:02:04.115Z] Will use test ID?: false
[2025-11-17T08:02:04.115Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.115Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.115Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.115Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.115Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:04.115Z] Identifier: unknown
[2025-11-17T08:02:04.115Z] Key: register:unknown
[2025-11-17T08:02:04.115Z] üìù Creating new entry for key: register:unknown
[2025-11-17T08:02:04.115Z] Current count after filter: 0
[2025-11-17T08:02:04.115Z] Max requests allowed: 3
[2025-11-17T08:02:04.115Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.115Z] New count: 1
[2025-11-17T08:02:04.115Z] Remaining: 2
[2025-11-17T08:02:04.115Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.115Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584115
}
[2025-11-17T08:02:04.194Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.194Z] Request URL: /auth/reset-password
[2025-11-17T08:02:04.194Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.194Z] X-Test-ID header: null
[2025-11-17T08:02:04.194Z] Will use test ID?: false
[2025-11-17T08:02:04.194Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.194Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.194Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.194Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.194Z] Identifier: unknown
[2025-11-17T08:02:04.194Z] Key: login:unknown
[2025-11-17T08:02:04.194Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T08:02:04.194Z] Existing timestamps: 1
[2025-11-17T08:02:04.194Z] Current count after filter: 1
[2025-11-17T08:02:04.194Z] Max requests allowed: 5
[2025-11-17T08:02:04.194Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.194Z] New count: 2
[2025-11-17T08:02:04.194Z] Remaining: 3
[2025-11-17T08:02:04.194Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.195Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:04.660Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.661Z] Request URL: /auth/login
[2025-11-17T08:02:04.661Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.661Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Will use test ID?: true
[2025-11-17T08:02:04.661Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.661Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.661Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.661Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] üìù Creating new entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Current count after filter: 0
[2025-11-17T08:02:04.661Z] Max requests allowed: 5
[2025-11-17T08:02:04.661Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.661Z] New count: 1
[2025-11-17T08:02:04.661Z] Remaining: 4
[2025-11-17T08:02:04.661Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.662Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:04.758Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.758Z] Request URL: /auth/login
[2025-11-17T08:02:04.758Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.759Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Will use test ID?: true
[2025-11-17T08:02:04.759Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.759Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.759Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.759Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] üìù Creating new entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Current count after filter: 0
[2025-11-17T08:02:04.759Z] Max requests allowed: 5
[2025-11-17T08:02:04.759Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.759Z] New count: 1
[2025-11-17T08:02:04.759Z] Remaining: 4
[2025-11-17T08:02:04.759Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.759Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:04.837Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.837Z] Request URL: /auth/login
[2025-11-17T08:02:04.837Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.837Z] X-Test-ID header: login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] Will use test ID?: true
[2025-11-17T08:02:04.837Z] ‚úÖ Using test identifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.837Z] Got identifier from getClientIdentifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.837Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.837Z] Identifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] Key: login:test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] üìù Creating new entry for key: login:test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] Current count after filter: 0
[2025-11-17T08:02:04.838Z] Max requests allowed: 5
[2025-11-17T08:02:04.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.838Z] New count: 1
[2025-11-17T08:02:04.838Z] Remaining: 4
[2025-11-17T08:02:04.838Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.838Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584837
}
[2025-11-17T08:02:04.907Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.907Z] Request URL: /auth/login
[2025-11-17T08:02:04.907Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.907Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.907Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.908Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.908Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Will use test ID?: true
[2025-11-17T08:02:04.908Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.908Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.908Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.908Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Existing timestamps: 1
[2025-11-17T08:02:04.908Z] Current count after filter: 1
[2025-11-17T08:02:04.908Z] Max requests allowed: 5
[2025-11-17T08:02:04.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.908Z] New count: 2
[2025-11-17T08:02:04.908Z] Remaining: 3
[2025-11-17T08:02:04.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.908Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.063Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.063Z] Request URL: /auth/login
[2025-11-17T08:02:05.064Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.064Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Will use test ID?: true
[2025-11-17T08:02:05.064Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.064Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.064Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.064Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Existing timestamps: 1
[2025-11-17T08:02:05.064Z] Current count after filter: 1
[2025-11-17T08:02:05.064Z] Max requests allowed: 5
[2025-11-17T08:02:05.064Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.065Z] New count: 2
[2025-11-17T08:02:05.065Z] Remaining: 3
[2025-11-17T08:02:05.065Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.065Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.120Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.120Z] Request URL: /auth/login
[2025-11-17T08:02:05.120Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.120Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] Will use test ID?: true
[2025-11-17T08:02:05.120Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.120Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.121Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.121Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] Existing timestamps: 2
[2025-11-17T08:02:05.121Z] Current count after filter: 2
[2025-11-17T08:02:05.121Z] Max requests allowed: 5
[2025-11-17T08:02:05.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.121Z] New count: 3
[2025-11-17T08:02:05.121Z] Remaining: 2
[2025-11-17T08:02:05.121Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.121Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.175Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.175Z] Request URL: /auth/register
[2025-11-17T08:02:05.175Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.175Z] X-Test-ID header: register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Will use test ID?: true
[2025-11-17T08:02:05.175Z] ‚úÖ Using test identifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.175Z] Got identifier from getClientIdentifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.175Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.175Z] Identifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Key: register:test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] üìù Creating new entry for key: register:test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Current count after filter: 0
[2025-11-17T08:02:05.175Z] Max requests allowed: 3
[2025-11-17T08:02:05.175Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.175Z] New count: 1
[2025-11-17T08:02:05.176Z] Remaining: 2
[2025-11-17T08:02:05.176Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.176Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585175
}
[2025-11-17T08:02:05.272Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.272Z] Request URL: /auth/register
[2025-11-17T08:02:05.273Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.273Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Will use test ID?: true
[2025-11-17T08:02:05.273Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.273Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.273Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.273Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] üìù Creating new entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Current count after filter: 0
[2025-11-17T08:02:05.273Z] Max requests allowed: 3
[2025-11-17T08:02:05.273Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.274Z] New count: 1
[2025-11-17T08:02:05.274Z] Remaining: 2
[2025-11-17T08:02:05.274Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.274Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:05.330Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.330Z] Request URL: /auth/login
[2025-11-17T08:02:05.330Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.330Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Will use test ID?: true
[2025-11-17T08:02:05.330Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.330Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.330Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.330Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Existing timestamps: 2
[2025-11-17T08:02:05.330Z] Current count after filter: 2
[2025-11-17T08:02:05.330Z] Max requests allowed: 5
[2025-11-17T08:02:05.330Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.330Z] New count: 3
[2025-11-17T08:02:05.330Z] Remaining: 2
[2025-11-17T08:02:05.330Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.330Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.346Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.346Z] Request URL: /auth/login
[2025-11-17T08:02:05.346Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.346Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.346Z] Will use test ID?: true
[2025-11-17T08:02:05.346Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.347Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.347Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.347Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] Existing timestamps: 3
[2025-11-17T08:02:05.347Z] Current count after filter: 3
[2025-11-17T08:02:05.347Z] Max requests allowed: 5
[2025-11-17T08:02:05.347Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.347Z] New count: 4
[2025-11-17T08:02:05.347Z] Remaining: 1
[2025-11-17T08:02:05.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.347Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.443Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.443Z] Request URL: /auth/verify-email
[2025-11-17T08:02:05.443Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.443Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.444Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.444Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.444Z] X-Test-ID header: null
[2025-11-17T08:02:05.444Z] Will use test ID?: false
[2025-11-17T08:02:05.444Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:05.444Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.444Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:05.444Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.444Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.444Z] Identifier: unknown
[2025-11-17T08:02:05.444Z] Key: login:unknown
[2025-11-17T08:02:05.444Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T08:02:05.444Z] Existing timestamps: 2
[2025-11-17T08:02:05.444Z] Current count after filter: 2
[2025-11-17T08:02:05.444Z] Max requests allowed: 5
[2025-11-17T08:02:05.444Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.444Z] New count: 3
[2025-11-17T08:02:05.444Z] Remaining: 2
[2025-11-17T08:02:05.444Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.444Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:05.545Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.545Z] Request URL: /auth/login
[2025-11-17T08:02:05.546Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.546Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Will use test ID?: true
[2025-11-17T08:02:05.546Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.546Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.546Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.546Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] üìù Creating new entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Current count after filter: 0
[2025-11-17T08:02:05.546Z] Max requests allowed: 5
[2025-11-17T08:02:05.546Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.546Z] New count: 1
[2025-11-17T08:02:05.546Z] Remaining: 4
[2025-11-17T08:02:05.546Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.546Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:05.580Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.580Z] Request URL: /auth/login
[2025-11-17T08:02:05.580Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.580Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Will use test ID?: true
[2025-11-17T08:02:05.581Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.581Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.581Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.581Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Existing timestamps: 4
[2025-11-17T08:02:05.581Z] Current count after filter: 4
[2025-11-17T08:02:05.581Z] Max requests allowed: 5
[2025-11-17T08:02:05.581Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.581Z] New count: 5
[2025-11-17T08:02:05.581Z] Remaining: 0
[2025-11-17T08:02:05.581Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.581Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.596Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.596Z] Request URL: /auth/login
[2025-11-17T08:02:05.596Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.597Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Will use test ID?: true
[2025-11-17T08:02:05.597Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.597Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.597Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.597Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Existing timestamps: 3
[2025-11-17T08:02:05.597Z] Current count after filter: 3
[2025-11-17T08:02:05.597Z] Max requests allowed: 5
[2025-11-17T08:02:05.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.597Z] New count: 4
[2025-11-17T08:02:05.597Z] Remaining: 1
[2025-11-17T08:02:05.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.597Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.793Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.793Z] Request URL: /auth/login
[2025-11-17T08:02:05.793Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.793Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.793Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.794Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.794Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Will use test ID?: true
[2025-11-17T08:02:05.794Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.794Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.794Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.794Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Existing timestamps: 1
[2025-11-17T08:02:05.794Z] Current count after filter: 1
[2025-11-17T08:02:05.794Z] Max requests allowed: 5
[2025-11-17T08:02:05.794Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.794Z] New count: 2
[2025-11-17T08:02:05.794Z] Remaining: 3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.794Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:05.795Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.795Z] Request URL: /auth/login
[2025-11-17T08:02:05.795Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.795Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.796Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.796Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.796Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Will use test ID?: true
[2025-11-17T08:02:05.796Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.796Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.796Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.796Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Existing timestamps: 5
[2025-11-17T08:02:05.796Z] Current count after filter: 5
[2025-11-17T08:02:05.796Z] Max requests allowed: 5
[2025-11-17T08:02:05.796Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:05.796Z] Current count: 5
[2025-11-17T08:02:05.796Z] Max allowed: 5
[2025-11-17T08:02:05.796Z] Retry after (seconds): 59
[2025-11-17T08:02:05.796Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:05.796Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366584661,
  "retryAfter": 59
}
[2025-11-17T08:02:05.805Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.805Z] Request URL: /auth/login
[2025-11-17T08:02:05.805Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.805Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.805Z] Will use test ID?: true
[2025-11-17T08:02:05.806Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.806Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.806Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.806Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] üìù Creating new entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] Current count after filter: 0
[2025-11-17T08:02:05.806Z] Max requests allowed: 5
[2025-11-17T08:02:05.806Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.806Z] New count: 1
[2025-11-17T08:02:05.806Z] Remaining: 4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.806Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:05.967Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.967Z] Request URL: /auth/register
[2025-11-17T08:02:05.967Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.967Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Will use test ID?: true
[2025-11-17T08:02:05.967Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.967Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.967Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.967Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Existing timestamps: 1
[2025-11-17T08:02:05.968Z] Current count after filter: 1
[2025-11-17T08:02:05.968Z] Max requests allowed: 3
[2025-11-17T08:02:05.968Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.968Z] New count: 2
[2025-11-17T08:02:05.968Z] Remaining: 1
[2025-11-17T08:02:05.968Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.968Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:05.971Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.971Z] Request URL: /auth/login
[2025-11-17T08:02:05.971Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.971Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] Will use test ID?: true
[2025-11-17T08:02:05.971Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.971Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.971Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.972Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] Existing timestamps: 4
[2025-11-17T08:02:05.972Z] Current count after filter: 4
[2025-11-17T08:02:05.972Z] Max requests allowed: 5
[2025-11-17T08:02:05.972Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.972Z] New count: 5
[2025-11-17T08:02:05.972Z] Remaining: 0
[2025-11-17T08:02:05.972Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.972Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:06.022Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.022Z] Request URL: /auth/login
[2025-11-17T08:02:06.022Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.022Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Will use test ID?: true
[2025-11-17T08:02:06.022Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.022Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.022Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Existing timestamps: 2
[2025-11-17T08:02:06.022Z] Current count after filter: 2
[2025-11-17T08:02:06.022Z] Max requests allowed: 5
[2025-11-17T08:02:06.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.023Z] New count: 3
[2025-11-17T08:02:06.023Z] Remaining: 2
[2025-11-17T08:02:06.023Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.023Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.074Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.074Z] Request URL: /auth/login
[2025-11-17T08:02:06.074Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.074Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Will use test ID?: true
[2025-11-17T08:02:06.075Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.075Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.075Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.075Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] üìñ Found existing entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Existing timestamps: 1
[2025-11-17T08:02:06.075Z] Current count after filter: 1
[2025-11-17T08:02:06.075Z] Max requests allowed: 5
[2025-11-17T08:02:06.075Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.075Z] New count: 2
[2025-11-17T08:02:06.075Z] Remaining: 3
[2025-11-17T08:02:06.075Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.075Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:06.229Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.230Z] Request URL: /auth/login
[2025-11-17T08:02:06.230Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.230Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Will use test ID?: true
[2025-11-17T08:02:06.230Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.230Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.230Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.230Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Existing timestamps: 5
[2025-11-17T08:02:06.230Z] Current count after filter: 5
[2025-11-17T08:02:06.230Z] Max requests allowed: 5
[2025-11-17T08:02:06.230Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.230Z] Current count: 5
[2025-11-17T08:02:06.230Z] Max allowed: 5
[2025-11-17T08:02:06.230Z] Retry after (seconds): 59
[2025-11-17T08:02:06.230Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.230Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366584759,
  "retryAfter": 59
}
[2025-11-17T08:02:06.240Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.240Z] Request URL: /auth/login
[2025-11-17T08:02:06.240Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.240Z] X-Test-ID header: headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Will use test ID?: true
[2025-11-17T08:02:06.240Z] ‚úÖ Using test identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.240Z] Got identifier from getClientIdentifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.240Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.240Z] Identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] üìù Creating new entry for key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Current count after filter: 0
[2025-11-17T08:02:06.240Z] Max requests allowed: 5
[2025-11-17T08:02:06.240Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.240Z] New count: 1
[2025-11-17T08:02:06.240Z] Remaining: 4
[2025-11-17T08:02:06.240Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.240Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366586240
}
[2025-11-17T08:02:06.255Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.255Z] Request URL: /auth/login
[2025-11-17T08:02:06.255Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.255Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.255Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.256Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.256Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Will use test ID?: true
[2025-11-17T08:02:06.256Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.256Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.256Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Existing timestamps: 3
[2025-11-17T08:02:06.256Z] Current count after filter: 3
[2025-11-17T08:02:06.256Z] Max requests allowed: 5
[2025-11-17T08:02:06.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.256Z] New count: 4
[2025-11-17T08:02:06.256Z] Remaining: 1
[2025-11-17T08:02:06.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.256Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.301Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.301Z] Request URL: /auth/login
[2025-11-17T08:02:06.301Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.301Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Will use test ID?: true
[2025-11-17T08:02:06.301Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.301Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.301Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.301Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] üìñ Found existing entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Existing timestamps: 2
[2025-11-17T08:02:06.301Z] Current count after filter: 2
[2025-11-17T08:02:06.301Z] Max requests allowed: 5
[2025-11-17T08:02:06.301Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.301Z] New count: 3
[2025-11-17T08:02:06.301Z] Remaining: 2
[2025-11-17T08:02:06.301Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.301Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:06.391Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.392Z] Request URL: /auth/register
[2025-11-17T08:02:06.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.392Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Will use test ID?: true
[2025-11-17T08:02:06.392Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.392Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.392Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.392Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Existing timestamps: 2
[2025-11-17T08:02:06.392Z] Current count after filter: 2
[2025-11-17T08:02:06.392Z] Max requests allowed: 3
[2025-11-17T08:02:06.392Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.392Z] New count: 3
[2025-11-17T08:02:06.392Z] Remaining: 0
[2025-11-17T08:02:06.392Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.392Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:06.456Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.456Z] Request URL: /auth/login
[2025-11-17T08:02:06.456Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.456Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.456Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.457Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.457Z] X-Test-ID header: headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Will use test ID?: true
[2025-11-17T08:02:06.457Z] ‚úÖ Using test identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.457Z] Got identifier from getClientIdentifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.457Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.457Z] Identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] üìñ Found existing entry for key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Existing timestamps: 1
[2025-11-17T08:02:06.457Z] Current count after filter: 1
[2025-11-17T08:02:06.457Z] Max requests allowed: 5
[2025-11-17T08:02:06.457Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.457Z] New count: 2
[2025-11-17T08:02:06.458Z] Remaining: 3
[2025-11-17T08:02:06.458Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.458Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366586240
}
[2025-11-17T08:02:06.470Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.471Z] Request URL: /auth/login
[2025-11-17T08:02:06.471Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.471Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Will use test ID?: true
[2025-11-17T08:02:06.471Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.471Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.471Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.471Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Existing timestamps: 4
[2025-11-17T08:02:06.471Z] Current count after filter: 4
[2025-11-17T08:02:06.471Z] Max requests allowed: 5
[2025-11-17T08:02:06.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.471Z] New count: 5
[2025-11-17T08:02:06.471Z] Remaining: 0
[2025-11-17T08:02:06.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.471Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.553Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.553Z] Request URL: /auth/login
[2025-11-17T08:02:06.553Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.553Z] X-Test-ID header: perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Will use test ID?: true
[2025-11-17T08:02:06.553Z] ‚úÖ Using test identifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.553Z] Got identifier from getClientIdentifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.553Z] Identifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Key: login:test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] üìù Creating new entry for key: login:test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Current count after filter: 0
[2025-11-17T08:02:06.553Z] Max requests allowed: 5
[2025-11-17T08:02:06.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.553Z] New count: 1
[2025-11-17T08:02:06.553Z] Remaining: 4
[2025-11-17T08:02:06.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.553Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366586553
}
[2025-11-17T08:02:06.702Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.702Z] Request URL: /auth/login
[2025-11-17T08:02:06.702Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.702Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.702Z] Will use test ID?: true
[2025-11-17T08:02:06.703Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.703Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.703Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.703Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] Existing timestamps: 5
[2025-11-17T08:02:06.703Z] Current count after filter: 5
[2025-11-17T08:02:06.703Z] Max requests allowed: 5
[2025-11-17T08:02:06.703Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.703Z] Current count: 5
[2025-11-17T08:02:06.703Z] Max allowed: 5
[2025-11-17T08:02:06.703Z] Retry after (seconds): 59
[2025-11-17T08:02:06.703Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.703Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366585546,
  "retryAfter": 59
}
[2025-11-17T08:02:06.705Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.705Z] Request URL: /auth/register
[2025-11-17T08:02:06.705Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.705Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Will use test ID?: true
[2025-11-17T08:02:06.705Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.705Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.705Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.705Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Key: register:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] üìù Creating new entry for key: register:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Current count after filter: 0
[2025-11-17T08:02:06.705Z] Max requests allowed: 3
[2025-11-17T08:02:06.705Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.705Z] New count: 1
[2025-11-17T08:02:06.705Z] Remaining: 2
[2025-11-17T08:02:06.705Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.705Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366586705
}
[2025-11-17T08:02:06.729Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.730Z] Request URL: /auth/register
[2025-11-17T08:02:06.730Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.730Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Will use test ID?: true
[2025-11-17T08:02:06.730Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.730Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.730Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.730Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Existing timestamps: 3
[2025-11-17T08:02:06.730Z] Current count after filter: 3
[2025-11-17T08:02:06.730Z] Max requests allowed: 3
[2025-11-17T08:02:06.730Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.730Z] Current count: 3
[2025-11-17T08:02:06.730Z] Max allowed: 3
[2025-11-17T08:02:06.730Z] Retry after (seconds): 59
[2025-11-17T08:02:06.730Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.730Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366585273,
  "retryAfter": 59
}
[2025-11-17T08:02:10.622Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:10.622Z] Request URL: /auth/register
[2025-11-17T08:02:10.623Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:10.623Z] X-Test-ID header: null
[2025-11-17T08:02:10.626Z] Will use test ID?: false
[2025-11-17T08:02:10.627Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:10.627Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:10.627Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:10.627Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:10.627Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:10.627Z] Identifier: unknown
[2025-11-17T08:02:10.627Z] Key: register:unknown
[2025-11-17T08:02:10.627Z] üìñ Found existing entry for key: register:unknown
[2025-11-17T08:02:10.627Z] Existing timestamps: 1
[2025-11-17T08:02:10.627Z] Current count after filter: 1
[2025-11-17T08:02:10.627Z] Max requests allowed: 3
[2025-11-17T08:02:10.627Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:10.627Z] New count: 2
[2025-11-17T08:02:10.627Z] Remaining: 1
[2025-11-17T08:02:10.627Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:10.627Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584115
}
[2025-11-17T08:02:10.992Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:10.992Z] Request URL: /auth/verify-email
[2025-11-17T08:02:10.992Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:10.992Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] Will use test ID?: true
[2025-11-17T08:02:10.992Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:10.992Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:10.992Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:10.993Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] üìù Creating new entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] Current count after filter: 0
[2025-11-17T08:02:10.993Z] Max requests allowed: 5
[2025-11-17T08:02:10.993Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:10.993Z] New count: 1
[2025-11-17T08:02:10.993Z] Remaining: 4
[2025-11-17T08:02:10.993Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:10.993Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.279Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.279Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.279Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.279Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Will use test ID?: true
[2025-11-17T08:02:11.279Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.279Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.279Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.279Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Existing timestamps: 1
[2025-11-17T08:02:11.279Z] Current count after filter: 1
[2025-11-17T08:02:11.279Z] Max requests allowed: 5
[2025-11-17T08:02:11.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.279Z] New count: 2
[2025-11-17T08:02:11.279Z] Remaining: 3
[2025-11-17T08:02:11.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.280Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.578Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.579Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.579Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.579Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] Will use test ID?: true
[2025-11-17T08:02:11.579Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.579Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.579Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.579Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.580Z] Existing timestamps: 2
[2025-11-17T08:02:11.580Z] Current count after filter: 2
[2025-11-17T08:02:11.580Z] Max requests allowed: 5
[2025-11-17T08:02:11.580Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.580Z] New count: 3
[2025-11-17T08:02:11.580Z] Remaining: 2
[2025-11-17T08:02:11.580Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.580Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.859Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.859Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.859Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.859Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.859Z] Will use test ID?: true
[2025-11-17T08:02:11.859Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.859Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.859Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.860Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.860Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] Existing timestamps: 3
[2025-11-17T08:02:11.860Z] Current count after filter: 3
[2025-11-17T08:02:11.860Z] Max requests allowed: 5
[2025-11-17T08:02:11.860Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.860Z] New count: 4
[2025-11-17T08:02:11.860Z] Remaining: 1
[2025-11-17T08:02:11.860Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.860Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:12.144Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:12.144Z] Request URL: /auth/verify-email
[2025-11-17T08:02:12.145Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:12.145Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Will use test ID?: true
[2025-11-17T08:02:12.145Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:12.145Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:12.145Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:12.145Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Existing timestamps: 4
[2025-11-17T08:02:12.145Z] Current count after filter: 4
[2025-11-17T08:02:12.145Z] Max requests allowed: 5
[2025-11-17T08:02:12.145Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:12.145Z] New count: 5
[2025-11-17T08:02:12.146Z] Remaining: 0
[2025-11-17T08:02:12.146Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:12.146Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366590992
}
[2025-11-17T12:19:16.398Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-17T12:19:16.399Z] Request URL: /auth/token
[2025-11-17T12:19:16.399Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:16.399Z] X-Test-ID header: null
[2025-11-17T12:19:16.399Z] Will use test ID?: false
[2025-11-17T12:19:16.399Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:16.400Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:16.400Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:16.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:16.400Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-17T12:19:16.400Z] Identifier: unknown
[2025-11-17T12:19:16.400Z] Key: token:unknown
[2025-11-17T12:19:16.400Z] üìù Creating new entry for key: token:unknown
[2025-11-17T12:19:16.400Z] Current count after filter: 0
[2025-11-17T12:19:16.400Z] Max requests allowed: 60
[2025-11-17T12:19:16.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:16.400Z] New count: 1
[2025-11-17T12:19:16.400Z] Remaining: 59
[2025-11-17T12:19:16.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:16.400Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763382016400
}
[2025-11-17T12:19:16.988Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T12:19:16.988Z] Request URL: /auth/register
[2025-11-17T12:19:16.988Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:16.988Z] X-Test-ID header: null
[2025-11-17T12:19:16.988Z] Will use test ID?: false
[2025-11-17T12:19:16.988Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:16.989Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:16.989Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:16.989Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:16.989Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T12:19:16.989Z] Identifier: unknown
[2025-11-17T12:19:16.989Z] Key: register:unknown
[2025-11-17T12:19:16.989Z] üìù Creating new entry for key: register:unknown
[2025-11-17T12:19:16.989Z] Current count after filter: 0
[2025-11-17T12:19:16.989Z] Max requests allowed: 3
[2025-11-17T12:19:16.989Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:16.989Z] New count: 1
[2025-11-17T12:19:16.989Z] Remaining: 2
[2025-11-17T12:19:16.989Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:16.989Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763382016989
}
[2025-11-17T12:19:17.143Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-17T12:19:17.143Z] Request URL: /auth/token
[2025-11-17T12:19:17.143Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.143Z] X-Test-ID header: null
[2025-11-17T12:19:17.143Z] Will use test ID?: false
[2025-11-17T12:19:17.143Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.143Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.143Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.144Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.144Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-17T12:19:17.144Z] Identifier: unknown
[2025-11-17T12:19:17.144Z] Key: token:unknown
[2025-11-17T12:19:17.144Z] üìñ Found existing entry for key: token:unknown
[2025-11-17T12:19:17.144Z] Existing timestamps: 1
[2025-11-17T12:19:17.144Z] Current count after filter: 1
[2025-11-17T12:19:17.144Z] Max requests allowed: 60
[2025-11-17T12:19:17.144Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.144Z] New count: 2
[2025-11-17T12:19:17.144Z] Remaining: 58
[2025-11-17T12:19:17.144Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.144Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763382016400
}
[2025-11-17T12:19:17.241Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:17.241Z] Request URL: /auth/forgot-password
[2025-11-17T12:19:17.241Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.241Z] X-Test-ID header: null
[2025-11-17T12:19:17.241Z] Will use test ID?: false
[2025-11-17T12:19:17.242Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.242Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.242Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.242Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.242Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:17.242Z] Identifier: unknown
[2025-11-17T12:19:17.242Z] Key: login:unknown
[2025-11-17T12:19:17.242Z] üìù Creating new entry for key: login:unknown
[2025-11-17T12:19:17.242Z] Current count after filter: 0
[2025-11-17T12:19:17.242Z] Max requests allowed: 5
[2025-11-17T12:19:17.242Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.242Z] New count: 1
[2025-11-17T12:19:17.242Z] Remaining: 4
[2025-11-17T12:19:17.242Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.242Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763382017242
}
[2025-11-17T12:19:17.361Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:17.364Z] Request URL: /auth/reset-password
[2025-11-17T12:19:17.369Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.378Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.382Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.393Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.394Z] X-Test-ID header: null
[2025-11-17T12:19:17.407Z] Will use test ID?: false
[2025-11-17T12:19:17.413Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.418Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.421Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.421Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:17.422Z] Identifier: unknown
[2025-11-17T12:19:17.422Z] Key: login:unknown
[2025-11-17T12:19:17.422Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T12:19:17.422Z] Existing timestamps: 1
[2025-11-17T12:19:17.422Z] Current count after filter: 1
[2025-11-17T12:19:17.422Z] Max requests allowed: 5
[2025-11-17T12:19:17.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.423Z] New count: 2
[2025-11-17T12:19:17.423Z] Remaining: 3
[2025-11-17T12:19:17.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.423Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763382017242
}
[2025-11-17T12:19:18.325Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:18.325Z] Request URL: /auth/verify-email
[2025-11-17T12:19:18.325Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:18.325Z] X-Test-ID header: null
[2025-11-17T12:19:18.325Z] Will use test ID?: false
[2025-11-17T12:19:18.325Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:18.325Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:18.325Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:18.325Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:18.325Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:18.325Z] Identifier: unknown
[2025-11-17T12:19:18.325Z] Key: login:unknown
[2025-11-17T12:19:18.325Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T12:19:18.325Z] Existing timestamps: 2
[2025-11-17T12:19:18.325Z] Current count after filter: 2
[2025-11-17T12:19:18.325Z] Max requests allowed: 5
[2025-11-17T12:19:18.325Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:18.325Z] New count: 3
[2025-11-17T12:19:18.325Z] Remaining: 2
[2025-11-17T12:19:18.325Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:18.326Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763382017242
}
[2025-11-19T08:01:31.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.593Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.594Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.594Z] üìù Creating new entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.594Z] Current count after filter: 0
[2025-11-19T08:01:31.594Z] Max requests allowed: 5
[2025-11-19T08:01:31.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.598Z] New count: 1
[2025-11-19T08:01:31.598Z] Remaining: 4
[2025-11-19T08:01:31.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.602Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.602Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.602Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.602Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.602Z] Existing timestamps: 1
[2025-11-19T08:01:31.602Z] Current count after filter: 1
[2025-11-19T08:01:31.607Z] Max requests allowed: 5
[2025-11-19T08:01:31.607Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.607Z] New count: 2
[2025-11-19T08:01:31.607Z] Remaining: 3
[2025-11-19T08:01:31.607Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.607Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.607Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.607Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.607Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.607Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.607Z] Existing timestamps: 2
[2025-11-19T08:01:31.607Z] Current count after filter: 2
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 3
[2025-11-19T08:01:31.608Z] Remaining: 2
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.608Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Existing timestamps: 3
[2025-11-19T08:01:31.608Z] Current count after filter: 3
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 4
[2025-11-19T08:01:31.608Z] Remaining: 1
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.608Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Existing timestamps: 4
[2025-11-19T08:01:31.608Z] Current count after filter: 4
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 5
[2025-11-19T08:01:31.608Z] Remaining: 0
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.609Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.609Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.609Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.609Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.609Z] üìù Creating new entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.609Z] Current count after filter: 0
[2025-11-19T08:01:31.609Z] Max requests allowed: 5
[2025-11-19T08:01:31.610Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.610Z] New count: 1
[2025-11-19T08:01:31.610Z] Remaining: 4
[2025-11-19T08:01:31.610Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.610Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.610Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.610Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.610Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] Existing timestamps: 1
[2025-11-19T08:01:31.611Z] Current count after filter: 1
[2025-11-19T08:01:31.611Z] Max requests allowed: 5
[2025-11-19T08:01:31.611Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.611Z] New count: 2
[2025-11-19T08:01:31.611Z] Remaining: 3
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.611Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.611Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.611Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] Existing timestamps: 2
[2025-11-19T08:01:31.611Z] Current count after filter: 2
[2025-11-19T08:01:31.611Z] Max requests allowed: 5
[2025-11-19T08:01:31.611Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.611Z] New count: 3
[2025-11-19T08:01:31.611Z] Remaining: 2
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.611Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 3
[2025-11-19T08:01:31.612Z] Current count after filter: 3
[2025-11-19T08:01:31.612Z] Max requests allowed: 5
[2025-11-19T08:01:31.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.612Z] New count: 4
[2025-11-19T08:01:31.612Z] Remaining: 1
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 4
[2025-11-19T08:01:31.612Z] Current count after filter: 4
[2025-11-19T08:01:31.612Z] Max requests allowed: 5
[2025-11-19T08:01:31.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.612Z] New count: 5
[2025-11-19T08:01:31.612Z] Remaining: 0
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 5
[2025-11-19T08:01:31.613Z] Current count after filter: 5
[2025-11-19T08:01:31.613Z] Max requests allowed: 5
[2025-11-19T08:01:31.613Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.613Z] Current count: 5
[2025-11-19T08:01:31.613Z] Max allowed: 5
[2025-11-19T08:01:31.613Z] Retry after (seconds): 60
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.613Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.613Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.613Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.613Z] üìù Creating new entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.613Z] Current count after filter: 0
[2025-11-19T08:01:31.613Z] Max requests allowed: 2
[2025-11-19T08:01:31.613Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.613Z] New count: 1
[2025-11-19T08:01:31.613Z] Remaining: 1
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.613Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.614Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Existing timestamps: 1
[2025-11-19T08:01:31.614Z] Current count after filter: 1
[2025-11-19T08:01:31.614Z] Max requests allowed: 2
[2025-11-19T08:01:31.614Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.614Z] New count: 2
[2025-11-19T08:01:31.614Z] Remaining: 0
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.614Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.614Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Existing timestamps: 2
[2025-11-19T08:01:31.614Z] Current count after filter: 2
[2025-11-19T08:01:31.614Z] Max requests allowed: 2
[2025-11-19T08:01:31.614Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.614Z] Current count: 2
[2025-11-19T08:01:31.614Z] Max allowed: 2
[2025-11-19T08:01:31.614Z] Retry after (seconds): 1
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.766Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.766Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.766Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.766Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.766Z] Existing timestamps: 2
[2025-11-19T08:01:31.766Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:01:31.766Z] Current count after filter: 0
[2025-11-19T08:01:31.767Z] Max requests allowed: 2
[2025-11-19T08:01:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.767Z] New count: 1
[2025-11-19T08:01:31.767Z] Remaining: 1
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.767Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] üìù Creating new entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Current count after filter: 0
[2025-11-19T08:01:31.767Z] Max requests allowed: 5
[2025-11-19T08:01:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.767Z] New count: 1
[2025-11-19T08:01:31.767Z] Remaining: 4
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.767Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Existing timestamps: 1
[2025-11-19T08:01:31.768Z] Current count after filter: 1
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 2
[2025-11-19T08:01:31.768Z] Remaining: 3
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Existing timestamps: 2
[2025-11-19T08:01:31.768Z] Current count after filter: 2
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 3
[2025-11-19T08:01:31.768Z] Remaining: 2
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Existing timestamps: 3
[2025-11-19T08:01:31.768Z] Current count after filter: 3
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 4
[2025-11-19T08:01:31.768Z] Remaining: 1
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Existing timestamps: 4
[2025-11-19T08:01:31.769Z] Current count after filter: 4
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.769Z] New count: 5
[2025-11-19T08:01:31.769Z] Remaining: 0
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.769Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Existing timestamps: 5
[2025-11-19T08:01:31.769Z] Current count after filter: 5
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.769Z] Current count: 5
[2025-11-19T08:01:31.769Z] Max allowed: 5
[2025-11-19T08:01:31.769Z] Retry after (seconds): 60
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.769Z] Identifier: test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] üìù Creating new entry for key: login:test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] Current count after filter: 0
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.769Z] New count: 1
[2025-11-19T08:01:31.769Z] Remaining: 4
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.770Z] Identifier: test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] Key: login:test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] üìù Creating new entry for key: login:test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] Current count after filter: 0
[2025-11-19T08:01:31.770Z] Max requests allowed: 5
[2025-11-19T08:01:31.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.770Z] New count: 1
[2025-11-19T08:01:31.770Z] Remaining: 4
[2025-11-19T08:01:31.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.771Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.771Z] X-Test-ID header: null
[2025-11-19T08:01:31.771Z] Will use test ID?: false
[2025-11-19T08:01:31.771Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.771Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.772Z] X-Test-ID header: null
[2025-11-19T08:01:31.772Z] Will use test ID?: false
[2025-11-19T08:01:31.772Z] Using real IP: 192.168.1.2
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.772Z] X-Test-ID header: null
[2025-11-19T08:01:31.772Z] Will use test ID?: false
[2025-11-19T08:01:31.772Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.773Z] X-Test-ID header: null
[2025-11-19T08:01:31.773Z] Will use test ID?: false
[2025-11-19T08:01:31.773Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.773Z] X-Test-ID header: null
[2025-11-19T08:01:31.773Z] Will use test ID?: false
[2025-11-19T08:01:31.773Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.773Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.774Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] Current count after filter: 0
[2025-11-19T08:01:31.774Z] Max requests allowed: 3
[2025-11-19T08:01:31.774Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.774Z] New count: 1
[2025-11-19T08:01:31.774Z] Remaining: 2
[2025-11-19T08:01:31.774Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.874Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.875Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.875Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] Existing timestamps: 1
[2025-11-19T08:01:31.875Z] Current count after filter: 1
[2025-11-19T08:01:31.875Z] Max requests allowed: 3
[2025-11-19T08:01:31.875Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.875Z] New count: 2
[2025-11-19T08:01:31.875Z] Remaining: 1
[2025-11-19T08:01:31.875Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.976Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.976Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] Existing timestamps: 2
[2025-11-19T08:01:31.976Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:01:31.976Z] Current count after filter: 1
[2025-11-19T08:01:31.976Z] Max requests allowed: 3
[2025-11-19T08:01:31.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.976Z] New count: 2
[2025-11-19T08:01:31.976Z] Remaining: 1
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.976Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.976Z] Identifier: test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] Key: register:test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] üìù Creating new entry for key: register:test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] Current count after filter: 0
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 1
[2025-11-19T08:01:31.977Z] Remaining: 2
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.977Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] üìù Creating new entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Current count after filter: 0
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 1
[2025-11-19T08:01:31.977Z] Remaining: 2
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.977Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Existing timestamps: 1
[2025-11-19T08:01:31.977Z] Current count after filter: 1
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 2
[2025-11-19T08:01:31.977Z] Remaining: 1
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.978Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Existing timestamps: 2
[2025-11-19T08:01:31.978Z] Current count after filter: 2
[2025-11-19T08:01:31.978Z] Max requests allowed: 3
[2025-11-19T08:01:31.978Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.978Z] New count: 3
[2025-11-19T08:01:31.978Z] Remaining: 0
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.978Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.978Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Existing timestamps: 3
[2025-11-19T08:01:31.978Z] Current count after filter: 3
[2025-11-19T08:01:31.978Z] Max requests allowed: 3
[2025-11-19T08:01:31.978Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.978Z] Current count: 3
[2025-11-19T08:01:31.978Z] Max allowed: 3
[2025-11-19T08:01:31.978Z] Retry after (seconds): 60
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.219Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.220Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.220Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.220Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.220Z] üìù Creating new entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.220Z] Current count after filter: 0
[2025-11-19T08:02:12.220Z] Max requests allowed: 5
[2025-11-19T08:02:12.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.221Z] New count: 1
[2025-11-19T08:02:12.221Z] Remaining: 4
[2025-11-19T08:02:12.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.222Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Existing timestamps: 1
[2025-11-19T08:02:12.222Z] Current count after filter: 1
[2025-11-19T08:02:12.222Z] Max requests allowed: 5
[2025-11-19T08:02:12.222Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.222Z] New count: 2
[2025-11-19T08:02:12.222Z] Remaining: 3
[2025-11-19T08:02:12.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.222Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Existing timestamps: 2
[2025-11-19T08:02:12.222Z] Current count after filter: 2
[2025-11-19T08:02:12.222Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 3
[2025-11-19T08:02:12.223Z] Remaining: 2
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.223Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Existing timestamps: 3
[2025-11-19T08:02:12.223Z] Current count after filter: 3
[2025-11-19T08:02:12.223Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 4
[2025-11-19T08:02:12.223Z] Remaining: 1
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.223Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Existing timestamps: 4
[2025-11-19T08:02:12.223Z] Current count after filter: 4
[2025-11-19T08:02:12.223Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 5
[2025-11-19T08:02:12.223Z] Remaining: 0
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.224Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.224Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.224Z] üìù Creating new entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.224Z] Current count after filter: 0
[2025-11-19T08:02:12.224Z] Max requests allowed: 5
[2025-11-19T08:02:12.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.224Z] New count: 1
[2025-11-19T08:02:12.224Z] Remaining: 4
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.225Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.225Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] Existing timestamps: 1
[2025-11-19T08:02:12.225Z] Current count after filter: 1
[2025-11-19T08:02:12.225Z] Max requests allowed: 5
[2025-11-19T08:02:12.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.225Z] New count: 2
[2025-11-19T08:02:12.225Z] Remaining: 3
[2025-11-19T08:02:12.225Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.225Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.225Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] Existing timestamps: 2
[2025-11-19T08:02:12.225Z] Current count after filter: 2
[2025-11-19T08:02:12.225Z] Max requests allowed: 5
[2025-11-19T08:02:12.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.225Z] New count: 3
[2025-11-19T08:02:12.225Z] Remaining: 2
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.226Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.226Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] Existing timestamps: 3
[2025-11-19T08:02:12.226Z] Current count after filter: 3
[2025-11-19T08:02:12.226Z] Max requests allowed: 5
[2025-11-19T08:02:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.226Z] New count: 4
[2025-11-19T08:02:12.226Z] Remaining: 1
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.226Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.226Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] Existing timestamps: 4
[2025-11-19T08:02:12.226Z] Current count after filter: 4
[2025-11-19T08:02:12.226Z] Max requests allowed: 5
[2025-11-19T08:02:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.226Z] New count: 5
[2025-11-19T08:02:12.227Z] Remaining: 0
[2025-11-19T08:02:12.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.227Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.227Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.227Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.227Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.227Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.227Z] Existing timestamps: 5
[2025-11-19T08:02:12.227Z] Current count after filter: 5
[2025-11-19T08:02:12.227Z] Max requests allowed: 5
[2025-11-19T08:02:12.227Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.227Z] Current count: 5
[2025-11-19T08:02:12.228Z] Max allowed: 5
[2025-11-19T08:02:12.228Z] Retry after (seconds): 60
[2025-11-19T08:02:12.228Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.229Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.229Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.229Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.229Z] üìù Creating new entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.229Z] Current count after filter: 0
[2025-11-19T08:02:12.229Z] Max requests allowed: 2
[2025-11-19T08:02:12.229Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.229Z] New count: 1
[2025-11-19T08:02:12.229Z] Remaining: 1
[2025-11-19T08:02:12.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.230Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.230Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Existing timestamps: 1
[2025-11-19T08:02:12.230Z] Current count after filter: 1
[2025-11-19T08:02:12.230Z] Max requests allowed: 2
[2025-11-19T08:02:12.230Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.230Z] New count: 2
[2025-11-19T08:02:12.230Z] Remaining: 0
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.230Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.230Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Existing timestamps: 2
[2025-11-19T08:02:12.230Z] Current count after filter: 2
[2025-11-19T08:02:12.230Z] Max requests allowed: 2
[2025-11-19T08:02:12.230Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.230Z] Current count: 2
[2025-11-19T08:02:12.230Z] Max allowed: 2
[2025-11-19T08:02:12.230Z] Retry after (seconds): 1
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.382Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.382Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.382Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.382Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.382Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.382Z] Existing timestamps: 2
[2025-11-19T08:02:12.382Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:02:12.382Z] Current count after filter: 0
[2025-11-19T08:02:12.382Z] Max requests allowed: 2
[2025-11-19T08:02:12.382Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.382Z] New count: 1
[2025-11-19T08:02:12.382Z] Remaining: 1
[2025-11-19T08:02:12.382Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.383Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] üìù Creating new entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] Current count after filter: 0
[2025-11-19T08:02:12.383Z] Max requests allowed: 5
[2025-11-19T08:02:12.383Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.383Z] New count: 1
[2025-11-19T08:02:12.383Z] Remaining: 4
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.384Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] Existing timestamps: 1
[2025-11-19T08:02:12.384Z] Current count after filter: 1
[2025-11-19T08:02:12.384Z] Max requests allowed: 5
[2025-11-19T08:02:12.384Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.384Z] New count: 2
[2025-11-19T08:02:12.384Z] Remaining: 3
[2025-11-19T08:02:12.384Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.384Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.384Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 2
[2025-11-19T08:02:12.385Z] Current count after filter: 2
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 3
[2025-11-19T08:02:12.385Z] Remaining: 2
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.385Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 3
[2025-11-19T08:02:12.385Z] Current count after filter: 3
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 4
[2025-11-19T08:02:12.385Z] Remaining: 1
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.385Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 4
[2025-11-19T08:02:12.385Z] Current count after filter: 4
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 5
[2025-11-19T08:02:12.386Z] Remaining: 0
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.386Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] Existing timestamps: 5
[2025-11-19T08:02:12.386Z] Current count after filter: 5
[2025-11-19T08:02:12.386Z] Max requests allowed: 5
[2025-11-19T08:02:12.386Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.386Z] Current count: 5
[2025-11-19T08:02:12.386Z] Max allowed: 5
[2025-11-19T08:02:12.386Z] Retry after (seconds): 60
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.386Z] Identifier: test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] Key: login:test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] üìù Creating new entry for key: login:test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] Current count after filter: 0
[2025-11-19T08:02:12.386Z] Max requests allowed: 5
[2025-11-19T08:02:12.386Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.386Z] New count: 1
[2025-11-19T08:02:12.386Z] Remaining: 4
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.387Z] Identifier: test-reset-time-1763539332387
[2025-11-19T08:02:12.387Z] Key: login:test-reset-time-1763539332387
[2025-11-19T08:02:12.388Z] üìù Creating new entry for key: login:test-reset-time-1763539332387
[2025-11-19T08:02:12.388Z] Current count after filter: 0
[2025-11-19T08:02:12.388Z] Max requests allowed: 5
[2025-11-19T08:02:12.388Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.388Z] New count: 1
[2025-11-19T08:02:12.388Z] Remaining: 4
[2025-11-19T08:02:12.388Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.389Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.390Z] X-Test-ID header: null
[2025-11-19T08:02:12.390Z] Will use test ID?: false
[2025-11-19T08:02:12.390Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.390Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.391Z] X-Test-ID header: null
[2025-11-19T08:02:12.391Z] Will use test ID?: false
[2025-11-19T08:02:12.391Z] Using real IP: 192.168.1.2
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.391Z] X-Test-ID header: null
[2025-11-19T08:02:12.392Z] Will use test ID?: false
[2025-11-19T08:02:12.392Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.392Z] X-Test-ID header: null
[2025-11-19T08:02:12.392Z] Will use test ID?: false
[2025-11-19T08:02:12.392Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.393Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.393Z] X-Test-ID header: null
[2025-11-19T08:02:12.393Z] Will use test ID?: false
[2025-11-19T08:02:12.393Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.393Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.393Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] Current count after filter: 0
[2025-11-19T08:02:12.393Z] Max requests allowed: 3
[2025-11-19T08:02:12.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.393Z] New count: 1
[2025-11-19T08:02:12.393Z] Remaining: 2
[2025-11-19T08:02:12.393Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.495Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.495Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.496Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] Existing timestamps: 1
[2025-11-19T08:02:12.496Z] Current count after filter: 1
[2025-11-19T08:02:12.496Z] Max requests allowed: 3
[2025-11-19T08:02:12.497Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.497Z] New count: 2
[2025-11-19T08:02:12.497Z] Remaining: 1
[2025-11-19T08:02:12.497Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.598Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.598Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] Existing timestamps: 2
[2025-11-19T08:02:12.599Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:02:12.599Z] Current count after filter: 1
[2025-11-19T08:02:12.599Z] Max requests allowed: 3
[2025-11-19T08:02:12.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.599Z] New count: 2
[2025-11-19T08:02:12.599Z] Remaining: 1
[2025-11-19T08:02:12.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.599Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.599Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.599Z] Identifier: test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] Key: register:test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] üìù Creating new entry for key: register:test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] Current count after filter: 0
[2025-11-19T08:02:12.599Z] Max requests allowed: 3
[2025-11-19T08:02:12.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.599Z] New count: 1
[2025-11-19T08:02:12.599Z] Remaining: 2
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìù Creating new entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Current count after filter: 0
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.600Z] New count: 1
[2025-11-19T08:02:12.600Z] Remaining: 2
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Existing timestamps: 1
[2025-11-19T08:02:12.600Z] Current count after filter: 1
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.600Z] New count: 2
[2025-11-19T08:02:12.600Z] Remaining: 1
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Existing timestamps: 2
[2025-11-19T08:02:12.600Z] Current count after filter: 2
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.601Z] New count: 3
[2025-11-19T08:02:12.602Z] Remaining: 0
[2025-11-19T08:02:12.602Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.602Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.602Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.602Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.602Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.602Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.603Z] Existing timestamps: 3
[2025-11-19T08:02:12.603Z] Current count after filter: 3
[2025-11-19T08:02:12.603Z] Max requests allowed: 3
[2025-11-19T08:02:12.603Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.603Z] Current count: 3
[2025-11-19T08:02:12.603Z] Max allowed: 3
[2025-11-19T08:02:12.603Z] Retry after (seconds): 60
[2025-11-19T08:02:12.603Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.020Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.021Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.021Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.021Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.021Z] üìù Creating new entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.021Z] Current count after filter: 0
[2025-11-19T08:02:29.021Z] Max requests allowed: 5
[2025-11-19T08:02:29.021Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.021Z] New count: 1
[2025-11-19T08:02:29.021Z] Remaining: 4
[2025-11-19T08:02:29.021Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.022Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Existing timestamps: 1
[2025-11-19T08:02:29.022Z] Current count after filter: 1
[2025-11-19T08:02:29.022Z] Max requests allowed: 5
[2025-11-19T08:02:29.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.022Z] New count: 2
[2025-11-19T08:02:29.022Z] Remaining: 3
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.022Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Existing timestamps: 2
[2025-11-19T08:02:29.022Z] Current count after filter: 2
[2025-11-19T08:02:29.022Z] Max requests allowed: 5
[2025-11-19T08:02:29.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.022Z] New count: 3
[2025-11-19T08:02:29.022Z] Remaining: 2
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.023Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.023Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Existing timestamps: 3
[2025-11-19T08:02:29.023Z] Current count after filter: 3
[2025-11-19T08:02:29.023Z] Max requests allowed: 5
[2025-11-19T08:02:29.023Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.023Z] New count: 4
[2025-11-19T08:02:29.023Z] Remaining: 1
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.023Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.023Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Existing timestamps: 4
[2025-11-19T08:02:29.023Z] Current count after filter: 4
[2025-11-19T08:02:29.023Z] Max requests allowed: 5
[2025-11-19T08:02:29.023Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.023Z] New count: 5
[2025-11-19T08:02:29.023Z] Remaining: 0
[2025-11-19T08:02:29.024Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.024Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.024Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.024Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.024Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.024Z] üìù Creating new entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.024Z] Current count after filter: 0
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 1
[2025-11-19T08:02:29.025Z] Remaining: 4
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 1
[2025-11-19T08:02:29.025Z] Current count after filter: 1
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 2
[2025-11-19T08:02:29.025Z] Remaining: 3
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 2
[2025-11-19T08:02:29.025Z] Current count after filter: 2
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 3
[2025-11-19T08:02:29.025Z] Remaining: 2
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 3
[2025-11-19T08:02:29.025Z] Current count after filter: 3
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.026Z] New count: 4
[2025-11-19T08:02:29.026Z] Remaining: 1
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.026Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.026Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.026Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] Existing timestamps: 4
[2025-11-19T08:02:29.026Z] Current count after filter: 4
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.026Z] New count: 5
[2025-11-19T08:02:29.026Z] Remaining: 0
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.026Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.026Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.026Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] Existing timestamps: 5
[2025-11-19T08:02:29.026Z] Current count after filter: 5
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.026Z] Current count: 5
[2025-11-19T08:02:29.026Z] Max allowed: 5
[2025-11-19T08:02:29.026Z] Retry after (seconds): 60
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] üìù Creating new entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Current count after filter: 0
[2025-11-19T08:02:29.027Z] Max requests allowed: 2
[2025-11-19T08:02:29.027Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.027Z] New count: 1
[2025-11-19T08:02:29.027Z] Remaining: 1
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Existing timestamps: 1
[2025-11-19T08:02:29.027Z] Current count after filter: 1
[2025-11-19T08:02:29.027Z] Max requests allowed: 2
[2025-11-19T08:02:29.027Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.027Z] New count: 2
[2025-11-19T08:02:29.027Z] Remaining: 0
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.028Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.028Z] Existing timestamps: 2
[2025-11-19T08:02:29.028Z] Current count after filter: 2
[2025-11-19T08:02:29.028Z] Max requests allowed: 2
[2025-11-19T08:02:29.028Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.028Z] Current count: 2
[2025-11-19T08:02:29.028Z] Max allowed: 2
[2025-11-19T08:02:29.028Z] Retry after (seconds): 1
[2025-11-19T08:02:29.028Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.180Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.180Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.180Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.180Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.180Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.180Z] Existing timestamps: 2
[2025-11-19T08:02:29.181Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:02:29.181Z] Current count after filter: 0
[2025-11-19T08:02:29.181Z] Max requests allowed: 2
[2025-11-19T08:02:29.181Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.181Z] New count: 1
[2025-11-19T08:02:29.181Z] Remaining: 1
[2025-11-19T08:02:29.181Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.181Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.181Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.181Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.181Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.181Z] üìù Creating new entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Current count after filter: 0
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.182Z] New count: 1
[2025-11-19T08:02:29.182Z] Remaining: 4
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.182Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.182Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Existing timestamps: 1
[2025-11-19T08:02:29.182Z] Current count after filter: 1
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.182Z] New count: 2
[2025-11-19T08:02:29.182Z] Remaining: 3
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.182Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.182Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Existing timestamps: 2
[2025-11-19T08:02:29.182Z] Current count after filter: 2
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 3
[2025-11-19T08:02:29.183Z] Remaining: 2
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 3
[2025-11-19T08:02:29.183Z] Current count after filter: 3
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 4
[2025-11-19T08:02:29.183Z] Remaining: 1
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 4
[2025-11-19T08:02:29.183Z] Current count after filter: 4
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 5
[2025-11-19T08:02:29.183Z] Remaining: 0
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 5
[2025-11-19T08:02:29.183Z] Current count after filter: 5
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.183Z] Current count: 5
[2025-11-19T08:02:29.183Z] Max allowed: 5
[2025-11-19T08:02:29.184Z] Retry after (seconds): 60
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.184Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.184Z] Identifier: test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] Key: login:test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] üìù Creating new entry for key: login:test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] Current count after filter: 0
[2025-11-19T08:02:29.184Z] Max requests allowed: 5
[2025-11-19T08:02:29.184Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.184Z] New count: 1
[2025-11-19T08:02:29.184Z] Remaining: 4
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.186Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.186Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.186Z] Identifier: test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] Key: login:test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] üìù Creating new entry for key: login:test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] Current count after filter: 0
[2025-11-19T08:02:29.186Z] Max requests allowed: 5
[2025-11-19T08:02:29.186Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.186Z] New count: 1
[2025-11-19T08:02:29.186Z] Remaining: 4
[2025-11-19T08:02:29.186Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.187Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.188Z] X-Test-ID header: null
[2025-11-19T08:02:29.188Z] Will use test ID?: false
[2025-11-19T08:02:29.188Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.188Z] X-Test-ID header: null
[2025-11-19T08:02:29.188Z] Will use test ID?: false
[2025-11-19T08:02:29.188Z] Using real IP: 192.168.1.2
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.189Z] X-Test-ID header: null
[2025-11-19T08:02:29.189Z] Will use test ID?: false
[2025-11-19T08:02:29.189Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.189Z] X-Test-ID header: null
[2025-11-19T08:02:29.189Z] Will use test ID?: false
[2025-11-19T08:02:29.189Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.190Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.190Z] X-Test-ID header: null
[2025-11-19T08:02:29.190Z] Will use test ID?: false
[2025-11-19T08:02:29.190Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.190Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.190Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.190Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.190Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] Current count after filter: 0
[2025-11-19T08:02:29.190Z] Max requests allowed: 3
[2025-11-19T08:02:29.190Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.190Z] New count: 1
[2025-11-19T08:02:29.190Z] Remaining: 2
[2025-11-19T08:02:29.190Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.292Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.292Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.292Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] Existing timestamps: 1
[2025-11-19T08:02:29.292Z] Current count after filter: 1
[2025-11-19T08:02:29.292Z] Max requests allowed: 3
[2025-11-19T08:02:29.292Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.292Z] New count: 2
[2025-11-19T08:02:29.292Z] Remaining: 1
[2025-11-19T08:02:29.292Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.394Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.394Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.394Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.395Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.395Z] Existing timestamps: 2
[2025-11-19T08:02:29.395Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:02:29.395Z] Current count after filter: 1
[2025-11-19T08:02:29.395Z] Max requests allowed: 3
[2025-11-19T08:02:29.395Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.395Z] New count: 2
[2025-11-19T08:02:29.395Z] Remaining: 1
[2025-11-19T08:02:29.395Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.395Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.395Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.395Z] Identifier: test-format-allowed-1763539349395
[2025-11-19T08:02:29.395Z] Key: register:test-format-allowed-1763539349395
[2025-11-19T08:02:29.395Z] üìù Creating new entry for key: register:test-format-allowed-1763539349395
[2025-11-19T08:02:29.396Z] Current count after filter: 0
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.396Z] New count: 1
[2025-11-19T08:02:29.396Z] Remaining: 2
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.396Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.396Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] üìù Creating new entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Current count after filter: 0
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.396Z] New count: 1
[2025-11-19T08:02:29.396Z] Remaining: 2
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.396Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.396Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Existing timestamps: 1
[2025-11-19T08:02:29.396Z] Current count after filter: 1
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.397Z] New count: 2
[2025-11-19T08:02:29.397Z] Remaining: 1
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.397Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.397Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Existing timestamps: 2
[2025-11-19T08:02:29.397Z] Current count after filter: 2
[2025-11-19T08:02:29.397Z] Max requests allowed: 3
[2025-11-19T08:02:29.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.397Z] New count: 3
[2025-11-19T08:02:29.397Z] Remaining: 0
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.397Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.397Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Existing timestamps: 3
[2025-11-19T08:02:29.397Z] Current count after filter: 3
[2025-11-19T08:02:29.397Z] Max requests allowed: 3
[2025-11-19T08:02:29.397Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.398Z] Current count: 3
[2025-11-19T08:02:29.398Z] Max allowed: 3
[2025-11-19T08:02:29.398Z] Retry after (seconds): 60
[2025-11-19T08:02:29.398Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.227Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.227Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.227Z] üìù Creating new entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.227Z] Current count after filter: 0
[2025-11-19T08:04:17.227Z] Max requests allowed: 5
[2025-11-19T08:04:17.227Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.227Z] New count: 1
[2025-11-19T08:04:17.227Z] Remaining: 4
[2025-11-19T08:04:17.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.228Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.228Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Existing timestamps: 1
[2025-11-19T08:04:17.228Z] Current count after filter: 1
[2025-11-19T08:04:17.228Z] Max requests allowed: 5
[2025-11-19T08:04:17.228Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.228Z] New count: 2
[2025-11-19T08:04:17.228Z] Remaining: 3
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.228Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.228Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Existing timestamps: 2
[2025-11-19T08:04:17.228Z] Current count after filter: 2
[2025-11-19T08:04:17.228Z] Max requests allowed: 5
[2025-11-19T08:04:17.228Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.228Z] New count: 3
[2025-11-19T08:04:17.228Z] Remaining: 2
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.229Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.229Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.229Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.229Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.229Z] Existing timestamps: 3
[2025-11-19T08:04:17.229Z] Current count after filter: 3
[2025-11-19T08:04:17.229Z] Max requests allowed: 5
[2025-11-19T08:04:17.229Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.229Z] New count: 4
[2025-11-19T08:04:17.229Z] Remaining: 1
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.230Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.230Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.230Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.230Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.230Z] Existing timestamps: 4
[2025-11-19T08:04:17.230Z] Current count after filter: 4
[2025-11-19T08:04:17.230Z] Max requests allowed: 5
[2025-11-19T08:04:17.230Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.230Z] New count: 5
[2025-11-19T08:04:17.230Z] Remaining: 0
[2025-11-19T08:04:17.230Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.231Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] üìù Creating new entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] Current count after filter: 0
[2025-11-19T08:04:17.231Z] Max requests allowed: 5
[2025-11-19T08:04:17.231Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.231Z] New count: 1
[2025-11-19T08:04:17.231Z] Remaining: 4
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.231Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] Existing timestamps: 1
[2025-11-19T08:04:17.231Z] Current count after filter: 1
[2025-11-19T08:04:17.231Z] Max requests allowed: 5
[2025-11-19T08:04:17.231Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.231Z] New count: 2
[2025-11-19T08:04:17.231Z] Remaining: 3
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 2
[2025-11-19T08:04:17.232Z] Current count after filter: 2
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 3
[2025-11-19T08:04:17.232Z] Remaining: 2
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.232Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.232Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 3
[2025-11-19T08:04:17.232Z] Current count after filter: 3
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 4
[2025-11-19T08:04:17.232Z] Remaining: 1
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.232Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.232Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 4
[2025-11-19T08:04:17.232Z] Current count after filter: 4
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 5
[2025-11-19T08:04:17.233Z] Remaining: 0
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.233Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.233Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.233Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.233Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.233Z] Existing timestamps: 5
[2025-11-19T08:04:17.233Z] Current count after filter: 5
[2025-11-19T08:04:17.233Z] Max requests allowed: 5
[2025-11-19T08:04:17.233Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.233Z] Current count: 5
[2025-11-19T08:04:17.233Z] Max allowed: 5
[2025-11-19T08:04:17.233Z] Retry after (seconds): 60
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.233Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.233Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.233Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.233Z] üìù Creating new entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.233Z] Current count after filter: 0
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.234Z] New count: 1
[2025-11-19T08:04:17.234Z] Remaining: 1
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.234Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.234Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Existing timestamps: 1
[2025-11-19T08:04:17.234Z] Current count after filter: 1
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.234Z] New count: 2
[2025-11-19T08:04:17.234Z] Remaining: 0
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.234Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.234Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Existing timestamps: 2
[2025-11-19T08:04:17.234Z] Current count after filter: 2
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.234Z] Current count: 2
[2025-11-19T08:04:17.234Z] Max allowed: 2
[2025-11-19T08:04:17.234Z] Retry after (seconds): 1
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.385Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.385Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.385Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.385Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.385Z] Existing timestamps: 2
[2025-11-19T08:04:17.385Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:04:17.385Z] Current count after filter: 0
[2025-11-19T08:04:17.385Z] Max requests allowed: 2
[2025-11-19T08:04:17.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.385Z] New count: 1
[2025-11-19T08:04:17.385Z] Remaining: 1
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.386Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] üìù Creating new entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Current count after filter: 0
[2025-11-19T08:04:17.386Z] Max requests allowed: 5
[2025-11-19T08:04:17.386Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.386Z] New count: 1
[2025-11-19T08:04:17.386Z] Remaining: 4
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.386Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Existing timestamps: 1
[2025-11-19T08:04:17.386Z] Current count after filter: 1
[2025-11-19T08:04:17.386Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 2
[2025-11-19T08:04:17.387Z] Remaining: 3
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Existing timestamps: 2
[2025-11-19T08:04:17.387Z] Current count after filter: 2
[2025-11-19T08:04:17.387Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 3
[2025-11-19T08:04:17.387Z] Remaining: 2
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Existing timestamps: 3
[2025-11-19T08:04:17.387Z] Current count after filter: 3
[2025-11-19T08:04:17.387Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 4
[2025-11-19T08:04:17.387Z] Remaining: 1
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Existing timestamps: 4
[2025-11-19T08:04:17.388Z] Current count after filter: 4
[2025-11-19T08:04:17.388Z] Max requests allowed: 5
[2025-11-19T08:04:17.388Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.388Z] New count: 5
[2025-11-19T08:04:17.388Z] Remaining: 0
[2025-11-19T08:04:17.388Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.388Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.388Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.388Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Existing timestamps: 5
[2025-11-19T08:04:17.388Z] Current count after filter: 5
[2025-11-19T08:04:17.388Z] Max requests allowed: 5
[2025-11-19T08:04:17.388Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.388Z] Current count: 5
[2025-11-19T08:04:17.388Z] Max allowed: 5
[2025-11-19T08:04:17.388Z] Retry after (seconds): 60
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.389Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.389Z] Identifier: test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] Key: login:test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] üìù Creating new entry for key: login:test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] Current count after filter: 0
[2025-11-19T08:04:17.389Z] Max requests allowed: 5
[2025-11-19T08:04:17.389Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.389Z] New count: 1
[2025-11-19T08:04:17.389Z] Remaining: 4
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.390Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.390Z] Identifier: test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] Key: login:test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] üìù Creating new entry for key: login:test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] Current count after filter: 0
[2025-11-19T08:04:17.390Z] Max requests allowed: 5
[2025-11-19T08:04:17.390Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.390Z] New count: 1
[2025-11-19T08:04:17.390Z] Remaining: 4
[2025-11-19T08:04:17.390Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.391Z] X-Test-ID header: null
[2025-11-19T08:04:17.391Z] Will use test ID?: false
[2025-11-19T08:04:17.391Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.391Z] X-Test-ID header: null
[2025-11-19T08:04:17.391Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] Using real IP: 192.168.1.2
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.392Z] X-Test-ID header: null
[2025-11-19T08:04:17.392Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.392Z] X-Test-ID header: null
[2025-11-19T08:04:17.392Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.393Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.393Z] X-Test-ID header: null
[2025-11-19T08:04:17.393Z] Will use test ID?: false
[2025-11-19T08:04:17.393Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.393Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.393Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] Current count after filter: 0
[2025-11-19T08:04:17.393Z] Max requests allowed: 3
[2025-11-19T08:04:17.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.393Z] New count: 1
[2025-11-19T08:04:17.393Z] Remaining: 2
[2025-11-19T08:04:17.393Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.493Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.493Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] Existing timestamps: 1
[2025-11-19T08:04:17.494Z] Current count after filter: 1
[2025-11-19T08:04:17.494Z] Max requests allowed: 3
[2025-11-19T08:04:17.494Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.494Z] New count: 2
[2025-11-19T08:04:17.494Z] Remaining: 1
[2025-11-19T08:04:17.494Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.596Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.596Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] Existing timestamps: 2
[2025-11-19T08:04:17.596Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:04:17.596Z] Current count after filter: 1
[2025-11-19T08:04:17.596Z] Max requests allowed: 3
[2025-11-19T08:04:17.596Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.596Z] New count: 2
[2025-11-19T08:04:17.596Z] Remaining: 1
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.596Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.596Z] Identifier: test-format-allowed-1763539457596
[2025-11-19T08:04:17.596Z] Key: register:test-format-allowed-1763539457596
[2025-11-19T08:04:17.596Z] üìù Creating new entry for key: register:test-format-allowed-1763539457596
[2025-11-19T08:04:17.597Z] Current count after filter: 0
[2025-11-19T08:04:17.597Z] Max requests allowed: 3
[2025-11-19T08:04:17.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.597Z] New count: 1
[2025-11-19T08:04:17.597Z] Remaining: 2
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.597Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.597Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] üìù Creating new entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] Current count after filter: 0
[2025-11-19T08:04:17.597Z] Max requests allowed: 3
[2025-11-19T08:04:17.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.597Z] New count: 1
[2025-11-19T08:04:17.597Z] Remaining: 2
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.597Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 1
[2025-11-19T08:04:17.598Z] Current count after filter: 1
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.598Z] New count: 2
[2025-11-19T08:04:17.598Z] Remaining: 1
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.598Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 2
[2025-11-19T08:04:17.598Z] Current count after filter: 2
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.598Z] New count: 3
[2025-11-19T08:04:17.598Z] Remaining: 0
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.598Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 3
[2025-11-19T08:04:17.598Z] Current count after filter: 3
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.598Z] Current count: 3
[2025-11-19T08:04:17.598Z] Max allowed: 3
[2025-11-19T08:04:17.598Z] Retry after (seconds): 60
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.091Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.091Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.091Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.091Z] üìù Creating new entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.091Z] Current count after filter: 0
[2025-11-19T08:06:51.091Z] Max requests allowed: 5
[2025-11-19T08:06:51.091Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.091Z] New count: 1
[2025-11-19T08:06:51.092Z] Remaining: 4
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.092Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.092Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.092Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.092Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.092Z] Existing timestamps: 1
[2025-11-19T08:06:51.092Z] Current count after filter: 1
[2025-11-19T08:06:51.092Z] Max requests allowed: 5
[2025-11-19T08:06:51.092Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.092Z] New count: 2
[2025-11-19T08:06:51.092Z] Remaining: 3
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 2
[2025-11-19T08:06:51.093Z] Current count after filter: 2
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.093Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.093Z] New count: 3
[2025-11-19T08:06:51.093Z] Remaining: 2
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 3
[2025-11-19T08:06:51.093Z] Current count after filter: 3
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.093Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.093Z] New count: 4
[2025-11-19T08:06:51.093Z] Remaining: 1
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 4
[2025-11-19T08:06:51.093Z] Current count after filter: 4
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.094Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.094Z] New count: 5
[2025-11-19T08:06:51.094Z] Remaining: 0
[2025-11-19T08:06:51.094Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.094Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.094Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.094Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.094Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.094Z] üìù Creating new entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.094Z] Current count after filter: 0
[2025-11-19T08:06:51.094Z] Max requests allowed: 5
[2025-11-19T08:06:51.094Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.094Z] New count: 1
[2025-11-19T08:06:51.094Z] Remaining: 4
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.095Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.095Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] Existing timestamps: 1
[2025-11-19T08:06:51.095Z] Current count after filter: 1
[2025-11-19T08:06:51.095Z] Max requests allowed: 5
[2025-11-19T08:06:51.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.095Z] New count: 2
[2025-11-19T08:06:51.095Z] Remaining: 3
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.095Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.095Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] Existing timestamps: 2
[2025-11-19T08:06:51.095Z] Current count after filter: 2
[2025-11-19T08:06:51.095Z] Max requests allowed: 5
[2025-11-19T08:06:51.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.095Z] New count: 3
[2025-11-19T08:06:51.095Z] Remaining: 2
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 3
[2025-11-19T08:06:51.096Z] Current count after filter: 3
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.096Z] New count: 4
[2025-11-19T08:06:51.096Z] Remaining: 1
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 4
[2025-11-19T08:06:51.096Z] Current count after filter: 4
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.096Z] New count: 5
[2025-11-19T08:06:51.096Z] Remaining: 0
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 5
[2025-11-19T08:06:51.096Z] Current count after filter: 5
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.097Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.097Z] Current count: 5
[2025-11-19T08:06:51.097Z] Max allowed: 5
[2025-11-19T08:06:51.097Z] Retry after (seconds): 60
[2025-11-19T08:06:51.097Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.098Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] üìù Creating new entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Current count after filter: 0
[2025-11-19T08:06:51.098Z] Max requests allowed: 2
[2025-11-19T08:06:51.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.098Z] New count: 1
[2025-11-19T08:06:51.098Z] Remaining: 1
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.098Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Existing timestamps: 1
[2025-11-19T08:06:51.098Z] Current count after filter: 1
[2025-11-19T08:06:51.098Z] Max requests allowed: 2
[2025-11-19T08:06:51.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.098Z] New count: 2
[2025-11-19T08:06:51.098Z] Remaining: 0
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.099Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.099Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.099Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.099Z] Existing timestamps: 2
[2025-11-19T08:06:51.099Z] Current count after filter: 2
[2025-11-19T08:06:51.099Z] Max requests allowed: 2
[2025-11-19T08:06:51.099Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.099Z] Current count: 2
[2025-11-19T08:06:51.099Z] Max allowed: 2
[2025-11-19T08:06:51.099Z] Retry after (seconds): 1
[2025-11-19T08:06:51.099Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.250Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.250Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.250Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.250Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.251Z] Existing timestamps: 2
[2025-11-19T08:06:51.251Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:06:51.251Z] Current count after filter: 0
[2025-11-19T08:06:51.251Z] Max requests allowed: 2
[2025-11-19T08:06:51.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.251Z] New count: 1
[2025-11-19T08:06:51.251Z] Remaining: 1
[2025-11-19T08:06:51.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.251Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.251Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] üìù Creating new entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] Current count after filter: 0
[2025-11-19T08:06:51.251Z] Max requests allowed: 5
[2025-11-19T08:06:51.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.251Z] New count: 1
[2025-11-19T08:06:51.251Z] Remaining: 4
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.252Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.252Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Existing timestamps: 1
[2025-11-19T08:06:51.252Z] Current count after filter: 1
[2025-11-19T08:06:51.252Z] Max requests allowed: 5
[2025-11-19T08:06:51.252Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.252Z] New count: 2
[2025-11-19T08:06:51.252Z] Remaining: 3
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.252Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.252Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Existing timestamps: 2
[2025-11-19T08:06:51.252Z] Current count after filter: 2
[2025-11-19T08:06:51.252Z] Max requests allowed: 5
[2025-11-19T08:06:51.253Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.253Z] New count: 3
[2025-11-19T08:06:51.253Z] Remaining: 2
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.253Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.253Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Existing timestamps: 3
[2025-11-19T08:06:51.253Z] Current count after filter: 3
[2025-11-19T08:06:51.253Z] Max requests allowed: 5
[2025-11-19T08:06:51.253Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.253Z] New count: 4
[2025-11-19T08:06:51.253Z] Remaining: 1
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.253Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.253Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Existing timestamps: 4
[2025-11-19T08:06:51.254Z] Current count after filter: 4
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.254Z] New count: 5
[2025-11-19T08:06:51.254Z] Remaining: 0
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.254Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] Existing timestamps: 5
[2025-11-19T08:06:51.254Z] Current count after filter: 5
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.254Z] Current count: 5
[2025-11-19T08:06:51.254Z] Max allowed: 5
[2025-11-19T08:06:51.254Z] Retry after (seconds): 60
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.254Z] Identifier: test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] Key: login:test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] üìù Creating new entry for key: login:test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] Current count after filter: 0
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.254Z] New count: 1
[2025-11-19T08:06:51.254Z] Remaining: 4
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.255Z] Identifier: test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] Key: login:test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] üìù Creating new entry for key: login:test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] Current count after filter: 0
[2025-11-19T08:06:51.255Z] Max requests allowed: 5
[2025-11-19T08:06:51.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.255Z] New count: 1
[2025-11-19T08:06:51.255Z] Remaining: 4
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.256Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.256Z] X-Test-ID header: null
[2025-11-19T08:06:51.257Z] Will use test ID?: false
[2025-11-19T08:06:51.257Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.257Z] X-Test-ID header: null
[2025-11-19T08:06:51.257Z] Will use test ID?: false
[2025-11-19T08:06:51.257Z] Using real IP: 192.168.1.2
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.258Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.258Z] X-Test-ID header: null
[2025-11-19T08:06:51.258Z] Will use test ID?: false
[2025-11-19T08:06:51.258Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.258Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.259Z] X-Test-ID header: null
[2025-11-19T08:06:51.259Z] Will use test ID?: false
[2025-11-19T08:06:51.259Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.260Z] X-Test-ID header: null
[2025-11-19T08:06:51.260Z] Will use test ID?: false
[2025-11-19T08:06:51.260Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.260Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.261Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.261Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.261Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] Current count after filter: 0
[2025-11-19T08:06:51.261Z] Max requests allowed: 3
[2025-11-19T08:06:51.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.261Z] New count: 1
[2025-11-19T08:06:51.261Z] Remaining: 2
[2025-11-19T08:06:51.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.361Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.361Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.361Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.361Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.361Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.362Z] Existing timestamps: 1
[2025-11-19T08:06:51.362Z] Current count after filter: 1
[2025-11-19T08:06:51.362Z] Max requests allowed: 3
[2025-11-19T08:06:51.362Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.362Z] New count: 2
[2025-11-19T08:06:51.362Z] Remaining: 1
[2025-11-19T08:06:51.362Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.463Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.463Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.463Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] Existing timestamps: 2
[2025-11-19T08:06:51.463Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:06:51.463Z] Current count after filter: 1
[2025-11-19T08:06:51.463Z] Max requests allowed: 3
[2025-11-19T08:06:51.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.464Z] New count: 2
[2025-11-19T08:06:51.464Z] Remaining: 1
[2025-11-19T08:06:51.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.464Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.465Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.465Z] Identifier: test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] Key: register:test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] üìù Creating new entry for key: register:test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] Current count after filter: 0
[2025-11-19T08:06:51.465Z] Max requests allowed: 3
[2025-11-19T08:06:51.465Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.465Z] New count: 1
[2025-11-19T08:06:51.465Z] Remaining: 2
[2025-11-19T08:06:51.465Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.466Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.466Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.466Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] üìù Creating new entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Current count after filter: 0
[2025-11-19T08:06:51.467Z] Max requests allowed: 3
[2025-11-19T08:06:51.467Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.467Z] New count: 1
[2025-11-19T08:06:51.467Z] Remaining: 2
[2025-11-19T08:06:51.467Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.467Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.467Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.467Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 1
[2025-11-19T08:06:51.468Z] Current count after filter: 1
[2025-11-19T08:06:51.468Z] Max requests allowed: 3
[2025-11-19T08:06:51.468Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.468Z] New count: 2
[2025-11-19T08:06:51.468Z] Remaining: 1
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.468Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.468Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 2
[2025-11-19T08:06:51.468Z] Current count after filter: 2
[2025-11-19T08:06:51.468Z] Max requests allowed: 3
[2025-11-19T08:06:51.468Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.468Z] New count: 3
[2025-11-19T08:06:51.468Z] Remaining: 0
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.468Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.468Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 3
[2025-11-19T08:06:51.469Z] Current count after filter: 3
[2025-11-19T08:06:51.469Z] Max requests allowed: 3
[2025-11-19T08:06:51.469Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.469Z] Current count: 3
[2025-11-19T08:06:51.469Z] Max allowed: 3
[2025-11-19T08:06:51.469Z] Retry after (seconds): 60
[2025-11-19T08:06:51.469Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.765Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] üìù Creating new entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Current count after filter: 0
[2025-11-19T08:08:39.766Z] Max requests allowed: 5
[2025-11-19T08:08:39.766Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.766Z] New count: 1
[2025-11-19T08:08:39.766Z] Remaining: 4
[2025-11-19T08:08:39.766Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.766Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.766Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Existing timestamps: 1
[2025-11-19T08:08:39.766Z] Current count after filter: 1
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 2
[2025-11-19T08:08:39.767Z] Remaining: 3
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.767Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Existing timestamps: 2
[2025-11-19T08:08:39.767Z] Current count after filter: 2
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 3
[2025-11-19T08:08:39.767Z] Remaining: 2
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.767Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Existing timestamps: 3
[2025-11-19T08:08:39.767Z] Current count after filter: 3
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 4
[2025-11-19T08:08:39.767Z] Remaining: 1
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.768Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.768Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.768Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.768Z] Existing timestamps: 4
[2025-11-19T08:08:39.768Z] Current count after filter: 4
[2025-11-19T08:08:39.768Z] Max requests allowed: 5
[2025-11-19T08:08:39.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.768Z] New count: 5
[2025-11-19T08:08:39.768Z] Remaining: 0
[2025-11-19T08:08:39.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.769Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] üìù Creating new entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] Current count after filter: 0
[2025-11-19T08:08:39.769Z] Max requests allowed: 5
[2025-11-19T08:08:39.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.769Z] New count: 1
[2025-11-19T08:08:39.769Z] Remaining: 4
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.769Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] Existing timestamps: 1
[2025-11-19T08:08:39.769Z] Current count after filter: 1
[2025-11-19T08:08:39.769Z] Max requests allowed: 5
[2025-11-19T08:08:39.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.769Z] New count: 2
[2025-11-19T08:08:39.769Z] Remaining: 3
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 2
[2025-11-19T08:08:39.770Z] Current count after filter: 2
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 3
[2025-11-19T08:08:39.770Z] Remaining: 2
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 3
[2025-11-19T08:08:39.770Z] Current count after filter: 3
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 4
[2025-11-19T08:08:39.770Z] Remaining: 1
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 4
[2025-11-19T08:08:39.770Z] Current count after filter: 4
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 5
[2025-11-19T08:08:39.770Z] Remaining: 0
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 5
[2025-11-19T08:08:39.771Z] Current count after filter: 5
[2025-11-19T08:08:39.771Z] Max requests allowed: 5
[2025-11-19T08:08:39.771Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.771Z] Current count: 5
[2025-11-19T08:08:39.771Z] Max allowed: 5
[2025-11-19T08:08:39.771Z] Retry after (seconds): 60
[2025-11-19T08:08:39.771Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.772Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.772Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] üìù Creating new entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Current count after filter: 0
[2025-11-19T08:08:39.772Z] Max requests allowed: 2
[2025-11-19T08:08:39.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.772Z] New count: 1
[2025-11-19T08:08:39.772Z] Remaining: 1
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.772Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.772Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Existing timestamps: 1
[2025-11-19T08:08:39.772Z] Current count after filter: 1
[2025-11-19T08:08:39.772Z] Max requests allowed: 2
[2025-11-19T08:08:39.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.772Z] New count: 2
[2025-11-19T08:08:39.773Z] Remaining: 0
[2025-11-19T08:08:39.773Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.773Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.773Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.774Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.774Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.774Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.774Z] Existing timestamps: 2
[2025-11-19T08:08:39.774Z] Current count after filter: 2
[2025-11-19T08:08:39.774Z] Max requests allowed: 2
[2025-11-19T08:08:39.774Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.774Z] Current count: 2
[2025-11-19T08:08:39.774Z] Max allowed: 2
[2025-11-19T08:08:39.774Z] Retry after (seconds): 1
[2025-11-19T08:08:39.774Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.926Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.926Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.926Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.926Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.926Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.926Z] Existing timestamps: 2
[2025-11-19T08:08:39.926Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:08:39.926Z] Current count after filter: 0
[2025-11-19T08:08:39.926Z] Max requests allowed: 2
[2025-11-19T08:08:39.926Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.926Z] New count: 1
[2025-11-19T08:08:39.926Z] Remaining: 1
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.927Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] üìù Creating new entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Current count after filter: 0
[2025-11-19T08:08:39.927Z] Max requests allowed: 5
[2025-11-19T08:08:39.927Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.927Z] New count: 1
[2025-11-19T08:08:39.927Z] Remaining: 4
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.927Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.928Z] Existing timestamps: 1
[2025-11-19T08:08:39.928Z] Current count after filter: 1
[2025-11-19T08:08:39.928Z] Max requests allowed: 5
[2025-11-19T08:08:39.928Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.928Z] New count: 2
[2025-11-19T08:08:39.928Z] Remaining: 3
[2025-11-19T08:08:39.928Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.928Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.928Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.928Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.928Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.929Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.929Z] Existing timestamps: 2
[2025-11-19T08:08:39.929Z] Current count after filter: 2
[2025-11-19T08:08:39.929Z] Max requests allowed: 5
[2025-11-19T08:08:39.929Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.929Z] New count: 3
[2025-11-19T08:08:39.930Z] Remaining: 2
[2025-11-19T08:08:39.930Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.930Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.930Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.930Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.930Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.930Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Existing timestamps: 3
[2025-11-19T08:08:39.931Z] Current count after filter: 3
[2025-11-19T08:08:39.931Z] Max requests allowed: 5
[2025-11-19T08:08:39.931Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.931Z] New count: 4
[2025-11-19T08:08:39.931Z] Remaining: 1
[2025-11-19T08:08:39.931Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.931Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.931Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.931Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Existing timestamps: 4
[2025-11-19T08:08:39.931Z] Current count after filter: 4
[2025-11-19T08:08:39.931Z] Max requests allowed: 5
[2025-11-19T08:08:39.931Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.931Z] New count: 5
[2025-11-19T08:08:39.932Z] Remaining: 0
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.932Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.932Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] Existing timestamps: 5
[2025-11-19T08:08:39.932Z] Current count after filter: 5
[2025-11-19T08:08:39.932Z] Max requests allowed: 5
[2025-11-19T08:08:39.932Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.932Z] Current count: 5
[2025-11-19T08:08:39.932Z] Max allowed: 5
[2025-11-19T08:08:39.932Z] Retry after (seconds): 60
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.932Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.932Z] Identifier: test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] Key: login:test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] üìù Creating new entry for key: login:test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] Current count after filter: 0
[2025-11-19T08:08:39.932Z] Max requests allowed: 5
[2025-11-19T08:08:39.932Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.932Z] New count: 1
[2025-11-19T08:08:39.932Z] Remaining: 4
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.933Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.933Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.933Z] Identifier: test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] Key: login:test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] üìù Creating new entry for key: login:test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] Current count after filter: 0
[2025-11-19T08:08:39.933Z] Max requests allowed: 5
[2025-11-19T08:08:39.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.933Z] New count: 1
[2025-11-19T08:08:39.933Z] Remaining: 4
[2025-11-19T08:08:39.933Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.935Z] X-Test-ID header: null
[2025-11-19T08:08:39.935Z] Will use test ID?: false
[2025-11-19T08:08:39.935Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.936Z] X-Test-ID header: null
[2025-11-19T08:08:39.936Z] Will use test ID?: false
[2025-11-19T08:08:39.936Z] Using real IP: 192.168.1.2
[2025-11-19T08:08:39.936Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.937Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.937Z] X-Test-ID header: null
[2025-11-19T08:08:39.937Z] Will use test ID?: false
[2025-11-19T08:08:39.937Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.937Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.938Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.938Z] X-Test-ID header: null
[2025-11-19T08:08:39.938Z] Will use test ID?: false
[2025-11-19T08:08:39.938Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:08:39.938Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.939Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.939Z] X-Test-ID header: null
[2025-11-19T08:08:39.939Z] Will use test ID?: false
[2025-11-19T08:08:39.939Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.939Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.940Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:39.940Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] Current count after filter: 0
[2025-11-19T08:08:39.940Z] Max requests allowed: 3
[2025-11-19T08:08:39.940Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.940Z] New count: 1
[2025-11-19T08:08:39.940Z] Remaining: 2
[2025-11-19T08:08:39.940Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.042Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:40.042Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] Existing timestamps: 1
[2025-11-19T08:08:40.042Z] Current count after filter: 1
[2025-11-19T08:08:40.042Z] Max requests allowed: 3
[2025-11-19T08:08:40.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.047Z] New count: 2
[2025-11-19T08:08:40.048Z] Remaining: 1
[2025-11-19T08:08:40.048Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.149Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.149Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:40.150Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] Existing timestamps: 2
[2025-11-19T08:08:40.150Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:08:40.150Z] Current count after filter: 1
[2025-11-19T08:08:40.150Z] Max requests allowed: 3
[2025-11-19T08:08:40.150Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.150Z] New count: 2
[2025-11-19T08:08:40.150Z] Remaining: 1
[2025-11-19T08:08:40.150Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.150Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.150Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.150Z] Identifier: test-format-allowed-1763539720150
[2025-11-19T08:08:40.150Z] Key: register:test-format-allowed-1763539720150
[2025-11-19T08:08:40.150Z] üìù Creating new entry for key: register:test-format-allowed-1763539720150
[2025-11-19T08:08:40.151Z] Current count after filter: 0
[2025-11-19T08:08:40.151Z] Max requests allowed: 3
[2025-11-19T08:08:40.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.151Z] New count: 1
[2025-11-19T08:08:40.151Z] Remaining: 2
[2025-11-19T08:08:40.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.151Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] üìù Creating new entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] Current count after filter: 0
[2025-11-19T08:08:40.151Z] Max requests allowed: 3
[2025-11-19T08:08:40.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.152Z] New count: 1
[2025-11-19T08:08:40.152Z] Remaining: 2
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.152Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.152Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] Existing timestamps: 1
[2025-11-19T08:08:40.152Z] Current count after filter: 1
[2025-11-19T08:08:40.152Z] Max requests allowed: 3
[2025-11-19T08:08:40.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.152Z] New count: 2
[2025-11-19T08:08:40.152Z] Remaining: 1
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.152Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.153Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Existing timestamps: 2
[2025-11-19T08:08:40.153Z] Current count after filter: 2
[2025-11-19T08:08:40.153Z] Max requests allowed: 3
[2025-11-19T08:08:40.153Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.153Z] New count: 3
[2025-11-19T08:08:40.153Z] Remaining: 0
[2025-11-19T08:08:40.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.153Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.153Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.153Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Existing timestamps: 3
[2025-11-19T08:08:40.153Z] Current count after filter: 3
[2025-11-19T08:08:40.153Z] Max requests allowed: 3
[2025-11-19T08:08:40.153Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:40.153Z] Current count: 3
[2025-11-19T08:08:40.153Z] Max allowed: 3
[2025-11-19T08:08:40.154Z] Retry after (seconds): 60
[2025-11-19T08:08:40.154Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.094Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.095Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.095Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.095Z] üìù Creating new entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.095Z] Current count after filter: 0
[2025-11-19T08:10:08.095Z] Max requests allowed: 5
[2025-11-19T08:10:08.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.095Z] New count: 1
[2025-11-19T08:10:08.096Z] Remaining: 4
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.096Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.096Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.096Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.096Z] Existing timestamps: 1
[2025-11-19T08:10:08.096Z] Current count after filter: 1
[2025-11-19T08:10:08.096Z] Max requests allowed: 5
[2025-11-19T08:10:08.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.096Z] New count: 2
[2025-11-19T08:10:08.096Z] Remaining: 3
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.096Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 2
[2025-11-19T08:10:08.097Z] Current count after filter: 2
[2025-11-19T08:10:08.097Z] Max requests allowed: 5
[2025-11-19T08:10:08.097Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.097Z] New count: 3
[2025-11-19T08:10:08.097Z] Remaining: 2
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.097Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.097Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 3
[2025-11-19T08:10:08.097Z] Current count after filter: 3
[2025-11-19T08:10:08.097Z] Max requests allowed: 5
[2025-11-19T08:10:08.097Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.097Z] New count: 4
[2025-11-19T08:10:08.097Z] Remaining: 1
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.097Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.097Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 4
[2025-11-19T08:10:08.098Z] Current count after filter: 4
[2025-11-19T08:10:08.098Z] Max requests allowed: 5
[2025-11-19T08:10:08.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.098Z] New count: 5
[2025-11-19T08:10:08.098Z] Remaining: 0
[2025-11-19T08:10:08.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.098Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.098Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìù Creating new entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Current count after filter: 0
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 1
[2025-11-19T08:10:08.099Z] Remaining: 4
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Existing timestamps: 1
[2025-11-19T08:10:08.099Z] Current count after filter: 1
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 2
[2025-11-19T08:10:08.099Z] Remaining: 3
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Existing timestamps: 2
[2025-11-19T08:10:08.099Z] Current count after filter: 2
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 3
[2025-11-19T08:10:08.099Z] Remaining: 2
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 3
[2025-11-19T08:10:08.100Z] Current count after filter: 3
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.100Z] New count: 4
[2025-11-19T08:10:08.100Z] Remaining: 1
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.100Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.100Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 4
[2025-11-19T08:10:08.100Z] Current count after filter: 4
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.100Z] New count: 5
[2025-11-19T08:10:08.100Z] Remaining: 0
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.100Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.100Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 5
[2025-11-19T08:10:08.100Z] Current count after filter: 5
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.101Z] Current count: 5
[2025-11-19T08:10:08.101Z] Max allowed: 5
[2025-11-19T08:10:08.101Z] Retry after (seconds): 60
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.101Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.101Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.101Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.101Z] üìù Creating new entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.101Z] Current count after filter: 0
[2025-11-19T08:10:08.101Z] Max requests allowed: 2
[2025-11-19T08:10:08.101Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.101Z] New count: 1
[2025-11-19T08:10:08.101Z] Remaining: 1
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.101Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.101Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Existing timestamps: 1
[2025-11-19T08:10:08.102Z] Current count after filter: 1
[2025-11-19T08:10:08.102Z] Max requests allowed: 2
[2025-11-19T08:10:08.102Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.102Z] New count: 2
[2025-11-19T08:10:08.102Z] Remaining: 0
[2025-11-19T08:10:08.102Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.102Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.102Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.102Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Existing timestamps: 2
[2025-11-19T08:10:08.102Z] Current count after filter: 2
[2025-11-19T08:10:08.102Z] Max requests allowed: 2
[2025-11-19T08:10:08.102Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.102Z] Current count: 2
[2025-11-19T08:10:08.102Z] Max allowed: 2
[2025-11-19T08:10:08.103Z] Retry after (seconds): 1
[2025-11-19T08:10:08.103Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.254Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.254Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.254Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.254Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.254Z] Existing timestamps: 2
[2025-11-19T08:10:08.254Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:10:08.254Z] Current count after filter: 0
[2025-11-19T08:10:08.254Z] Max requests allowed: 2
[2025-11-19T08:10:08.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.255Z] New count: 1
[2025-11-19T08:10:08.255Z] Remaining: 1
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.255Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] üìù Creating new entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] Current count after filter: 0
[2025-11-19T08:10:08.255Z] Max requests allowed: 5
[2025-11-19T08:10:08.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.255Z] New count: 1
[2025-11-19T08:10:08.255Z] Remaining: 4
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.255Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Existing timestamps: 1
[2025-11-19T08:10:08.256Z] Current count after filter: 1
[2025-11-19T08:10:08.256Z] Max requests allowed: 5
[2025-11-19T08:10:08.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.256Z] New count: 2
[2025-11-19T08:10:08.256Z] Remaining: 3
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.256Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Existing timestamps: 2
[2025-11-19T08:10:08.256Z] Current count after filter: 2
[2025-11-19T08:10:08.256Z] Max requests allowed: 5
[2025-11-19T08:10:08.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.256Z] New count: 3
[2025-11-19T08:10:08.256Z] Remaining: 2
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.256Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 3
[2025-11-19T08:10:08.257Z] Current count after filter: 3
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.257Z] New count: 4
[2025-11-19T08:10:08.257Z] Remaining: 1
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.257Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.257Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 4
[2025-11-19T08:10:08.257Z] Current count after filter: 4
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.257Z] New count: 5
[2025-11-19T08:10:08.257Z] Remaining: 0
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.257Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.257Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 5
[2025-11-19T08:10:08.257Z] Current count after filter: 5
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.257Z] Current count: 5
[2025-11-19T08:10:08.257Z] Max allowed: 5
[2025-11-19T08:10:08.257Z] Retry after (seconds): 60
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.258Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.258Z] Identifier: test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] Key: login:test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] üìù Creating new entry for key: login:test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] Current count after filter: 0
[2025-11-19T08:10:08.258Z] Max requests allowed: 5
[2025-11-19T08:10:08.258Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.258Z] New count: 1
[2025-11-19T08:10:08.258Z] Remaining: 4
[2025-11-19T08:10:08.258Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.259Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.259Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.259Z] Identifier: test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] Key: login:test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] üìù Creating new entry for key: login:test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] Current count after filter: 0
[2025-11-19T08:10:08.259Z] Max requests allowed: 5
[2025-11-19T08:10:08.259Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.259Z] New count: 1
[2025-11-19T08:10:08.259Z] Remaining: 4
[2025-11-19T08:10:08.259Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.261Z] X-Test-ID header: null
[2025-11-19T08:10:08.261Z] Will use test ID?: false
[2025-11-19T08:10:08.261Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.261Z] X-Test-ID header: null
[2025-11-19T08:10:08.261Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] Using real IP: 192.168.1.2
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.262Z] X-Test-ID header: null
[2025-11-19T08:10:08.262Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.262Z] X-Test-ID header: null
[2025-11-19T08:10:08.262Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.263Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.263Z] X-Test-ID header: null
[2025-11-19T08:10:08.263Z] Will use test ID?: false
[2025-11-19T08:10:08.263Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.263Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.263Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.263Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.263Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] Current count after filter: 0
[2025-11-19T08:10:08.263Z] Max requests allowed: 3
[2025-11-19T08:10:08.263Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.263Z] New count: 1
[2025-11-19T08:10:08.263Z] Remaining: 2
[2025-11-19T08:10:08.263Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.364Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.365Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.365Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] Existing timestamps: 1
[2025-11-19T08:10:08.365Z] Current count after filter: 1
[2025-11-19T08:10:08.365Z] Max requests allowed: 3
[2025-11-19T08:10:08.365Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.365Z] New count: 2
[2025-11-19T08:10:08.365Z] Remaining: 1
[2025-11-19T08:10:08.365Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.467Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.467Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.467Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.467Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.467Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.468Z] Existing timestamps: 2
[2025-11-19T08:10:08.468Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:10:08.468Z] Current count after filter: 1
[2025-11-19T08:10:08.468Z] Max requests allowed: 3
[2025-11-19T08:10:08.469Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.469Z] New count: 2
[2025-11-19T08:10:08.469Z] Remaining: 1
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.469Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.469Z] Identifier: test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] Key: register:test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] üìù Creating new entry for key: register:test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] Current count after filter: 0
[2025-11-19T08:10:08.469Z] Max requests allowed: 3
[2025-11-19T08:10:08.469Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.469Z] New count: 1
[2025-11-19T08:10:08.469Z] Remaining: 2
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.470Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.470Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] üìù Creating new entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] Current count after filter: 0
[2025-11-19T08:10:08.470Z] Max requests allowed: 3
[2025-11-19T08:10:08.470Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.470Z] New count: 1
[2025-11-19T08:10:08.470Z] Remaining: 2
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.470Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.470Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Existing timestamps: 1
[2025-11-19T08:10:08.471Z] Current count after filter: 1
[2025-11-19T08:10:08.471Z] Max requests allowed: 3
[2025-11-19T08:10:08.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.471Z] New count: 2
[2025-11-19T08:10:08.471Z] Remaining: 1
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.471Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Existing timestamps: 2
[2025-11-19T08:10:08.471Z] Current count after filter: 2
[2025-11-19T08:10:08.471Z] Max requests allowed: 3
[2025-11-19T08:10:08.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.471Z] New count: 3
[2025-11-19T08:10:08.471Z] Remaining: 0
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.472Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] Existing timestamps: 3
[2025-11-19T08:10:08.472Z] Current count after filter: 3
[2025-11-19T08:10:08.472Z] Max requests allowed: 3
[2025-11-19T08:10:08.472Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.472Z] Current count: 3
[2025-11-19T08:10:08.472Z] Max allowed: 3
[2025-11-19T08:10:08.472Z] Retry after (seconds): 60
[2025-11-19T08:10:08.472Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.759Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.760Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.761Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] üìù Creating new entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Current count after filter: 0
[2025-11-19T08:12:12.761Z] Max requests allowed: 5
[2025-11-19T08:12:12.761Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.761Z] New count: 1
[2025-11-19T08:12:12.761Z] Remaining: 4
[2025-11-19T08:12:12.761Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.761Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.761Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.761Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Existing timestamps: 1
[2025-11-19T08:12:12.762Z] Current count after filter: 1
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 2
[2025-11-19T08:12:12.762Z] Remaining: 3
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.762Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Existing timestamps: 2
[2025-11-19T08:12:12.762Z] Current count after filter: 2
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 3
[2025-11-19T08:12:12.762Z] Remaining: 2
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.762Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Existing timestamps: 3
[2025-11-19T08:12:12.762Z] Current count after filter: 3
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 4
[2025-11-19T08:12:12.762Z] Remaining: 1
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.763Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.763Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.763Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.763Z] Existing timestamps: 4
[2025-11-19T08:12:12.763Z] Current count after filter: 4
[2025-11-19T08:12:12.763Z] Max requests allowed: 5
[2025-11-19T08:12:12.763Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.763Z] New count: 5
[2025-11-19T08:12:12.763Z] Remaining: 0
[2025-11-19T08:12:12.763Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.763Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.763Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.763Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìù Creating new entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Current count after filter: 0
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.764Z] New count: 1
[2025-11-19T08:12:12.764Z] Remaining: 4
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.764Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.764Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Existing timestamps: 1
[2025-11-19T08:12:12.764Z] Current count after filter: 1
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.764Z] New count: 2
[2025-11-19T08:12:12.764Z] Remaining: 3
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.764Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.764Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Existing timestamps: 2
[2025-11-19T08:12:12.764Z] Current count after filter: 2
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 3
[2025-11-19T08:12:12.765Z] Remaining: 2
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.765Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.765Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] Existing timestamps: 3
[2025-11-19T08:12:12.765Z] Current count after filter: 3
[2025-11-19T08:12:12.765Z] Max requests allowed: 5
[2025-11-19T08:12:12.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 4
[2025-11-19T08:12:12.765Z] Remaining: 1
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.765Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.765Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] Existing timestamps: 4
[2025-11-19T08:12:12.765Z] Current count after filter: 4
[2025-11-19T08:12:12.765Z] Max requests allowed: 5
[2025-11-19T08:12:12.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 5
[2025-11-19T08:12:12.765Z] Remaining: 0
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.766Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.766Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.766Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.766Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.766Z] Existing timestamps: 5
[2025-11-19T08:12:12.766Z] Current count after filter: 5
[2025-11-19T08:12:12.766Z] Max requests allowed: 5
[2025-11-19T08:12:12.766Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.766Z] Current count: 5
[2025-11-19T08:12:12.766Z] Max allowed: 5
[2025-11-19T08:12:12.766Z] Retry after (seconds): 60
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìù Creating new entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Current count after filter: 0
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.767Z] New count: 1
[2025-11-19T08:12:12.767Z] Remaining: 1
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Existing timestamps: 1
[2025-11-19T08:12:12.767Z] Current count after filter: 1
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.767Z] New count: 2
[2025-11-19T08:12:12.767Z] Remaining: 0
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Existing timestamps: 2
[2025-11-19T08:12:12.767Z] Current count after filter: 2
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.767Z] Current count: 2
[2025-11-19T08:12:12.767Z] Max allowed: 2
[2025-11-19T08:12:12.768Z] Retry after (seconds): 1
[2025-11-19T08:12:12.768Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.919Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.919Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.919Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.919Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.919Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.920Z] Existing timestamps: 2
[2025-11-19T08:12:12.920Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:12:12.920Z] Current count after filter: 0
[2025-11-19T08:12:12.920Z] Max requests allowed: 2
[2025-11-19T08:12:12.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.920Z] New count: 1
[2025-11-19T08:12:12.920Z] Remaining: 1
[2025-11-19T08:12:12.920Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.920Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.920Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.920Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] üìù Creating new entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] Current count after filter: 0
[2025-11-19T08:12:12.920Z] Max requests allowed: 5
[2025-11-19T08:12:12.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.921Z] New count: 1
[2025-11-19T08:12:12.921Z] Remaining: 4
[2025-11-19T08:12:12.921Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.921Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.921Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.921Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] Existing timestamps: 1
[2025-11-19T08:12:12.921Z] Current count after filter: 1
[2025-11-19T08:12:12.921Z] Max requests allowed: 5
[2025-11-19T08:12:12.921Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.921Z] New count: 2
[2025-11-19T08:12:12.922Z] Remaining: 3
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.922Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.922Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Existing timestamps: 2
[2025-11-19T08:12:12.922Z] Current count after filter: 2
[2025-11-19T08:12:12.922Z] Max requests allowed: 5
[2025-11-19T08:12:12.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.922Z] New count: 3
[2025-11-19T08:12:12.922Z] Remaining: 2
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.922Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.922Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Existing timestamps: 3
[2025-11-19T08:12:12.922Z] Current count after filter: 3
[2025-11-19T08:12:12.922Z] Max requests allowed: 5
[2025-11-19T08:12:12.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.922Z] New count: 4
[2025-11-19T08:12:12.923Z] Remaining: 1
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.923Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] Existing timestamps: 4
[2025-11-19T08:12:12.923Z] Current count after filter: 4
[2025-11-19T08:12:12.923Z] Max requests allowed: 5
[2025-11-19T08:12:12.923Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.923Z] New count: 5
[2025-11-19T08:12:12.923Z] Remaining: 0
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.923Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] Existing timestamps: 5
[2025-11-19T08:12:12.924Z] Current count after filter: 5
[2025-11-19T08:12:12.924Z] Max requests allowed: 5
[2025-11-19T08:12:12.924Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.924Z] Current count: 5
[2025-11-19T08:12:12.924Z] Max allowed: 5
[2025-11-19T08:12:12.924Z] Retry after (seconds): 60
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.924Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.924Z] Identifier: test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] Key: login:test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] üìù Creating new entry for key: login:test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] Current count after filter: 0
[2025-11-19T08:12:12.924Z] Max requests allowed: 5
[2025-11-19T08:12:12.924Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.924Z] New count: 1
[2025-11-19T08:12:12.924Z] Remaining: 4
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.925Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.925Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.925Z] Identifier: test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] Key: login:test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] üìù Creating new entry for key: login:test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] Current count after filter: 0
[2025-11-19T08:12:12.925Z] Max requests allowed: 5
[2025-11-19T08:12:12.925Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.925Z] New count: 1
[2025-11-19T08:12:12.925Z] Remaining: 4
[2025-11-19T08:12:12.925Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.926Z] X-Test-ID header: null
[2025-11-19T08:12:12.926Z] Will use test ID?: false
[2025-11-19T08:12:12.926Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.927Z] X-Test-ID header: null
[2025-11-19T08:12:12.927Z] Will use test ID?: false
[2025-11-19T08:12:12.927Z] Using real IP: 192.168.1.2
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.927Z] X-Test-ID header: null
[2025-11-19T08:12:12.927Z] Will use test ID?: false
[2025-11-19T08:12:12.927Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.928Z] X-Test-ID header: null
[2025-11-19T08:12:12.928Z] Will use test ID?: false
[2025-11-19T08:12:12.928Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.928Z] X-Test-ID header: null
[2025-11-19T08:12:12.928Z] Will use test ID?: false
[2025-11-19T08:12:12.928Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.928Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:12.928Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] Current count after filter: 0
[2025-11-19T08:12:12.929Z] Max requests allowed: 3
[2025-11-19T08:12:12.929Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.929Z] New count: 1
[2025-11-19T08:12:12.929Z] Remaining: 2
[2025-11-19T08:12:12.929Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.030Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.030Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:13.030Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:13.030Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.031Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.031Z] Existing timestamps: 1
[2025-11-19T08:12:13.031Z] Current count after filter: 1
[2025-11-19T08:12:13.031Z] Max requests allowed: 3
[2025-11-19T08:12:13.031Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.031Z] New count: 2
[2025-11-19T08:12:13.031Z] Remaining: 1
[2025-11-19T08:12:13.031Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.132Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.133Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:13.133Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] Existing timestamps: 2
[2025-11-19T08:12:13.133Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:12:13.133Z] Current count after filter: 1
[2025-11-19T08:12:13.133Z] Max requests allowed: 3
[2025-11-19T08:12:13.133Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.133Z] New count: 2
[2025-11-19T08:12:13.133Z] Remaining: 1
[2025-11-19T08:12:13.133Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.133Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.134Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.134Z] Identifier: test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] Key: register:test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] üìù Creating new entry for key: register:test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] Current count after filter: 0
[2025-11-19T08:12:13.134Z] Max requests allowed: 3
[2025-11-19T08:12:13.134Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.134Z] New count: 1
[2025-11-19T08:12:13.134Z] Remaining: 2
[2025-11-19T08:12:13.134Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.135Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.135Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.135Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] üìù Creating new entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] Current count after filter: 0
[2025-11-19T08:12:13.136Z] Max requests allowed: 3
[2025-11-19T08:12:13.136Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.136Z] New count: 1
[2025-11-19T08:12:13.136Z] Remaining: 2
[2025-11-19T08:12:13.136Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.136Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.136Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.136Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] Existing timestamps: 1
[2025-11-19T08:12:13.136Z] Current count after filter: 1
[2025-11-19T08:12:13.136Z] Max requests allowed: 3
[2025-11-19T08:12:13.136Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.136Z] New count: 2
[2025-11-19T08:12:13.136Z] Remaining: 1
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.137Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.137Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] Existing timestamps: 2
[2025-11-19T08:12:13.137Z] Current count after filter: 2
[2025-11-19T08:12:13.137Z] Max requests allowed: 3
[2025-11-19T08:12:13.137Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.137Z] New count: 3
[2025-11-19T08:12:13.137Z] Remaining: 0
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.138Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.138Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.138Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] Existing timestamps: 3
[2025-11-19T08:12:13.138Z] Current count after filter: 3
[2025-11-19T08:12:13.138Z] Max requests allowed: 3
[2025-11-19T08:12:13.138Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:13.138Z] Current count: 3
[2025-11-19T08:12:13.138Z] Max allowed: 3
[2025-11-19T08:12:13.138Z] Retry after (seconds): 60
[2025-11-19T08:12:13.138Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.657Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.658Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.658Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.658Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.658Z] üìù Creating new entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.658Z] Current count after filter: 0
[2025-11-19T08:43:39.658Z] Max requests allowed: 5
[2025-11-19T08:43:39.658Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.658Z] New count: 1
[2025-11-19T08:43:39.658Z] Remaining: 4
[2025-11-19T08:43:39.658Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.659Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.659Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Existing timestamps: 1
[2025-11-19T08:43:39.659Z] Current count after filter: 1
[2025-11-19T08:43:39.659Z] Max requests allowed: 5
[2025-11-19T08:43:39.659Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.659Z] New count: 2
[2025-11-19T08:43:39.659Z] Remaining: 3
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.659Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.659Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Existing timestamps: 2
[2025-11-19T08:43:39.659Z] Current count after filter: 2
[2025-11-19T08:43:39.659Z] Max requests allowed: 5
[2025-11-19T08:43:39.659Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.659Z] New count: 3
[2025-11-19T08:43:39.659Z] Remaining: 2
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.660Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Existing timestamps: 3
[2025-11-19T08:43:39.660Z] Current count after filter: 3
[2025-11-19T08:43:39.660Z] Max requests allowed: 5
[2025-11-19T08:43:39.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.660Z] New count: 4
[2025-11-19T08:43:39.660Z] Remaining: 1
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.660Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Existing timestamps: 4
[2025-11-19T08:43:39.660Z] Current count after filter: 4
[2025-11-19T08:43:39.660Z] Max requests allowed: 5
[2025-11-19T08:43:39.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.660Z] New count: 5
[2025-11-19T08:43:39.660Z] Remaining: 0
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.661Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.661Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.661Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.661Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.661Z] üìù Creating new entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.661Z] Current count after filter: 0
[2025-11-19T08:43:39.661Z] Max requests allowed: 5
[2025-11-19T08:43:39.661Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.661Z] New count: 1
[2025-11-19T08:43:39.662Z] Remaining: 4
[2025-11-19T08:43:39.662Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.662Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.662Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.662Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.662Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.662Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.662Z] Existing timestamps: 1
[2025-11-19T08:43:39.662Z] Current count after filter: 1
[2025-11-19T08:43:39.663Z] Max requests allowed: 5
[2025-11-19T08:43:39.663Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.663Z] New count: 2
[2025-11-19T08:43:39.663Z] Remaining: 3
[2025-11-19T08:43:39.663Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.663Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.663Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.663Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.663Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] Existing timestamps: 2
[2025-11-19T08:43:39.664Z] Current count after filter: 2
[2025-11-19T08:43:39.664Z] Max requests allowed: 5
[2025-11-19T08:43:39.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.664Z] New count: 3
[2025-11-19T08:43:39.664Z] Remaining: 2
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.664Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.664Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.664Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] Existing timestamps: 3
[2025-11-19T08:43:39.664Z] Current count after filter: 3
[2025-11-19T08:43:39.664Z] Max requests allowed: 5
[2025-11-19T08:43:39.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.664Z] New count: 4
[2025-11-19T08:43:39.664Z] Remaining: 1
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.665Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.665Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.665Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] Existing timestamps: 4
[2025-11-19T08:43:39.665Z] Current count after filter: 4
[2025-11-19T08:43:39.665Z] Max requests allowed: 5
[2025-11-19T08:43:39.665Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.665Z] New count: 5
[2025-11-19T08:43:39.665Z] Remaining: 0
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.665Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.665Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.665Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] Existing timestamps: 5
[2025-11-19T08:43:39.665Z] Current count after filter: 5
[2025-11-19T08:43:39.665Z] Max requests allowed: 5
[2025-11-19T08:43:39.665Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.665Z] Current count: 5
[2025-11-19T08:43:39.665Z] Max allowed: 5
[2025-11-19T08:43:39.665Z] Retry after (seconds): 60
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.666Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.666Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] üìù Creating new entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Current count after filter: 0
[2025-11-19T08:43:39.666Z] Max requests allowed: 2
[2025-11-19T08:43:39.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.666Z] New count: 1
[2025-11-19T08:43:39.666Z] Remaining: 1
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.666Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.666Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Existing timestamps: 1
[2025-11-19T08:43:39.667Z] Current count after filter: 1
[2025-11-19T08:43:39.667Z] Max requests allowed: 2
[2025-11-19T08:43:39.667Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.667Z] New count: 2
[2025-11-19T08:43:39.667Z] Remaining: 0
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.667Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.667Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.667Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.667Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.667Z] Existing timestamps: 2
[2025-11-19T08:43:39.667Z] Current count after filter: 2
[2025-11-19T08:43:39.667Z] Max requests allowed: 2
[2025-11-19T08:43:39.667Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.667Z] Current count: 2
[2025-11-19T08:43:39.667Z] Max allowed: 2
[2025-11-19T08:43:39.667Z] Retry after (seconds): 1
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.819Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.819Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.819Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.819Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.819Z] Existing timestamps: 2
[2025-11-19T08:43:39.819Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:43:39.819Z] Current count after filter: 0
[2025-11-19T08:43:39.819Z] Max requests allowed: 2
[2025-11-19T08:43:39.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.819Z] New count: 1
[2025-11-19T08:43:39.819Z] Remaining: 1
[2025-11-19T08:43:39.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.820Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] üìù Creating new entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Current count after filter: 0
[2025-11-19T08:43:39.820Z] Max requests allowed: 5
[2025-11-19T08:43:39.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.820Z] New count: 1
[2025-11-19T08:43:39.820Z] Remaining: 4
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.820Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Existing timestamps: 1
[2025-11-19T08:43:39.820Z] Current count after filter: 1
[2025-11-19T08:43:39.820Z] Max requests allowed: 5
[2025-11-19T08:43:39.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.820Z] New count: 2
[2025-11-19T08:43:39.820Z] Remaining: 3
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.821Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.821Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Existing timestamps: 2
[2025-11-19T08:43:39.821Z] Current count after filter: 2
[2025-11-19T08:43:39.821Z] Max requests allowed: 5
[2025-11-19T08:43:39.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.821Z] New count: 3
[2025-11-19T08:43:39.821Z] Remaining: 2
[2025-11-19T08:43:39.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.821Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.821Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.821Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Existing timestamps: 3
[2025-11-19T08:43:39.822Z] Current count after filter: 3
[2025-11-19T08:43:39.822Z] Max requests allowed: 5
[2025-11-19T08:43:39.822Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.822Z] New count: 4
[2025-11-19T08:43:39.822Z] Remaining: 1
[2025-11-19T08:43:39.822Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.822Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.822Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.822Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Existing timestamps: 4
[2025-11-19T08:43:39.823Z] Current count after filter: 4
[2025-11-19T08:43:39.823Z] Max requests allowed: 5
[2025-11-19T08:43:39.823Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.823Z] New count: 5
[2025-11-19T08:43:39.823Z] Remaining: 0
[2025-11-19T08:43:39.823Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.823Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.823Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.823Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] Existing timestamps: 5
[2025-11-19T08:43:39.824Z] Current count after filter: 5
[2025-11-19T08:43:39.824Z] Max requests allowed: 5
[2025-11-19T08:43:39.824Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.824Z] Current count: 5
[2025-11-19T08:43:39.824Z] Max allowed: 5
[2025-11-19T08:43:39.824Z] Retry after (seconds): 60
[2025-11-19T08:43:39.824Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.824Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.824Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.824Z] Identifier: test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] Key: login:test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] üìù Creating new entry for key: login:test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] Current count after filter: 0
[2025-11-19T08:43:39.825Z] Max requests allowed: 5
[2025-11-19T08:43:39.825Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.825Z] New count: 1
[2025-11-19T08:43:39.825Z] Remaining: 4
[2025-11-19T08:43:39.825Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.826Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.826Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.826Z] Identifier: test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] Key: login:test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] üìù Creating new entry for key: login:test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] Current count after filter: 0
[2025-11-19T08:43:39.827Z] Max requests allowed: 5
[2025-11-19T08:43:39.827Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.827Z] New count: 1
[2025-11-19T08:43:39.827Z] Remaining: 4
[2025-11-19T08:43:39.827Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.830Z] X-Test-ID header: null
[2025-11-19T08:43:39.830Z] Will use test ID?: false
[2025-11-19T08:43:39.830Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.831Z] X-Test-ID header: null
[2025-11-19T08:43:39.831Z] Will use test ID?: false
[2025-11-19T08:43:39.831Z] Using real IP: 192.168.1.2
[2025-11-19T08:43:39.831Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.831Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.831Z] X-Test-ID header: null
[2025-11-19T08:43:39.832Z] Will use test ID?: false
[2025-11-19T08:43:39.832Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.832Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.832Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.832Z] X-Test-ID header: null
[2025-11-19T08:43:39.832Z] Will use test ID?: false
[2025-11-19T08:43:39.835Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:43:39.836Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.836Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.836Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.837Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.837Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.837Z] X-Test-ID header: null
[2025-11-19T08:43:39.837Z] Will use test ID?: false
[2025-11-19T08:43:39.837Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.837Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:39.837Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] üìù Creating new entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] Current count after filter: 0
[2025-11-19T08:43:39.837Z] Max requests allowed: 3
[2025-11-19T08:43:39.837Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.837Z] New count: 1
[2025-11-19T08:43:39.837Z] Remaining: 2
[2025-11-19T08:43:39.837Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.938Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.938Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:39.938Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] Existing timestamps: 1
[2025-11-19T08:43:39.938Z] Current count after filter: 1
[2025-11-19T08:43:39.938Z] Max requests allowed: 3
[2025-11-19T08:43:39.939Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.939Z] New count: 2
[2025-11-19T08:43:39.939Z] Remaining: 1
[2025-11-19T08:43:39.939Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.040Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.040Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:40.040Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:40.040Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:40.040Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:40.041Z] Existing timestamps: 2
[2025-11-19T08:43:40.041Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:43:40.041Z] Current count after filter: 1
[2025-11-19T08:43:40.041Z] Max requests allowed: 3
[2025-11-19T08:43:40.041Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.041Z] New count: 2
[2025-11-19T08:43:40.041Z] Remaining: 1
[2025-11-19T08:43:40.041Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.041Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.041Z] Identifier: test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] Key: register:test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] üìù Creating new entry for key: register:test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] Current count after filter: 0
[2025-11-19T08:43:40.042Z] Max requests allowed: 3
[2025-11-19T08:43:40.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.042Z] New count: 1
[2025-11-19T08:43:40.042Z] Remaining: 2
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.042Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.042Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] üìù Creating new entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Current count after filter: 0
[2025-11-19T08:43:40.042Z] Max requests allowed: 3
[2025-11-19T08:43:40.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.042Z] New count: 1
[2025-11-19T08:43:40.042Z] Remaining: 2
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.042Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.042Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Existing timestamps: 1
[2025-11-19T08:43:40.043Z] Current count after filter: 1
[2025-11-19T08:43:40.043Z] Max requests allowed: 3
[2025-11-19T08:43:40.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.043Z] New count: 2
[2025-11-19T08:43:40.043Z] Remaining: 1
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.043Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.043Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Existing timestamps: 2
[2025-11-19T08:43:40.043Z] Current count after filter: 2
[2025-11-19T08:43:40.043Z] Max requests allowed: 3
[2025-11-19T08:43:40.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.043Z] New count: 3
[2025-11-19T08:43:40.043Z] Remaining: 0
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.043Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.043Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Existing timestamps: 3
[2025-11-19T08:43:40.044Z] Current count after filter: 3
[2025-11-19T08:43:40.044Z] Max requests allowed: 3
[2025-11-19T08:43:40.044Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:40.044Z] Current count: 3
[2025-11-19T08:43:40.044Z] Max allowed: 3
[2025-11-19T08:43:40.044Z] Retry after (seconds): 60
[2025-11-19T08:43:40.044Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:25:12.648Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.649Z] Request URL: /auth/login
[2025-11-19T09:25:12.649Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.649Z] X-Test-ID header: null
[2025-11-19T09:25:12.649Z] Will use test ID?: false
[2025-11-19T09:25:12.649Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.649Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.649Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.649Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.649Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.649Z] Identifier: unknown
[2025-11-19T09:25:12.649Z] Key: login:unknown
[2025-11-19T09:25:12.649Z] üìù Creating new entry for key: login:unknown
[2025-11-19T09:25:12.649Z] Current count after filter: 0
[2025-11-19T09:25:12.649Z] Max requests allowed: 5
[2025-11-19T09:25:12.649Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.649Z] New count: 1
[2025-11-19T09:25:12.649Z] Remaining: 4
[2025-11-19T09:25:12.649Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.649Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.650Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.650Z] Request URL: /auth/login
[2025-11-19T09:25:12.650Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.650Z] X-Test-ID header: null
[2025-11-19T09:25:12.650Z] Will use test ID?: false
[2025-11-19T09:25:12.650Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.650Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.650Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.650Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.650Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.650Z] Identifier: unknown
[2025-11-19T09:25:12.650Z] Key: login:unknown
[2025-11-19T09:25:12.650Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.650Z] Existing timestamps: 1
[2025-11-19T09:25:12.651Z] Current count after filter: 1
[2025-11-19T09:25:12.651Z] Max requests allowed: 5
[2025-11-19T09:25:12.651Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.651Z] New count: 2
[2025-11-19T09:25:12.651Z] Remaining: 3
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.651Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.651Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.651Z] Request URL: /auth/login
[2025-11-19T09:25:12.651Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.651Z] X-Test-ID header: null
[2025-11-19T09:25:12.651Z] Will use test ID?: false
[2025-11-19T09:25:12.651Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.651Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.651Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.651Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.651Z] Identifier: unknown
[2025-11-19T09:25:12.651Z] Key: login:unknown
[2025-11-19T09:25:12.651Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.651Z] Existing timestamps: 2
[2025-11-19T09:25:12.651Z] Current count after filter: 2
[2025-11-19T09:25:12.651Z] Max requests allowed: 5
[2025-11-19T09:25:12.651Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.651Z] New count: 3
[2025-11-19T09:25:12.651Z] Remaining: 2
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.651Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.651Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.652Z] Request URL: /auth/login
[2025-11-19T09:25:12.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.652Z] X-Test-ID header: null
[2025-11-19T09:25:12.652Z] Will use test ID?: false
[2025-11-19T09:25:12.652Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.652Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.652Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.652Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.652Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.652Z] Identifier: unknown
[2025-11-19T09:25:12.652Z] Key: login:unknown
[2025-11-19T09:25:12.652Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.652Z] Existing timestamps: 3
[2025-11-19T09:25:12.652Z] Current count after filter: 3
[2025-11-19T09:25:12.652Z] Max requests allowed: 5
[2025-11-19T09:25:12.652Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.652Z] New count: 4
[2025-11-19T09:25:12.652Z] Remaining: 1
[2025-11-19T09:25:12.652Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.652Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763544372649
}
[2025-11-19T09:30:54.835Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.836Z] Request URL: /auth/login
[2025-11-19T09:30:54.836Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.836Z] X-Test-ID header: null
[2025-11-19T09:30:54.836Z] Will use test ID?: false
[2025-11-19T09:30:54.836Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.836Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.836Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.836Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.836Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.836Z] Identifier: unknown
[2025-11-19T09:30:54.836Z] Key: login:unknown
[2025-11-19T09:30:54.836Z] üìù Creating new entry for key: login:unknown
[2025-11-19T09:30:54.836Z] Current count after filter: 0
[2025-11-19T09:30:54.836Z] Max requests allowed: 5
[2025-11-19T09:30:54.836Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.836Z] New count: 1
[2025-11-19T09:30:54.836Z] Remaining: 4
[2025-11-19T09:30:54.836Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.836Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.837Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.837Z] Request URL: /auth/login
[2025-11-19T09:30:54.837Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.837Z] X-Test-ID header: null
[2025-11-19T09:30:54.837Z] Will use test ID?: false
[2025-11-19T09:30:54.837Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.837Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.837Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.837Z] Identifier: unknown
[2025-11-19T09:30:54.838Z] Key: login:unknown
[2025-11-19T09:30:54.838Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.838Z] Existing timestamps: 1
[2025-11-19T09:30:54.838Z] Current count after filter: 1
[2025-11-19T09:30:54.838Z] Max requests allowed: 5
[2025-11-19T09:30:54.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.838Z] New count: 2
[2025-11-19T09:30:54.838Z] Remaining: 3
[2025-11-19T09:30:54.838Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.838Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.838Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.838Z] Request URL: /auth/login
[2025-11-19T09:30:54.838Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.838Z] X-Test-ID header: null
[2025-11-19T09:30:54.838Z] Will use test ID?: false
[2025-11-19T09:30:54.838Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.838Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.838Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.838Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.838Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.838Z] Identifier: unknown
[2025-11-19T09:30:54.838Z] Key: login:unknown
[2025-11-19T09:30:54.838Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.838Z] Existing timestamps: 2
[2025-11-19T09:30:54.838Z] Current count after filter: 2
[2025-11-19T09:30:54.838Z] Max requests allowed: 5
[2025-11-19T09:30:54.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.838Z] New count: 3
[2025-11-19T09:30:54.838Z] Remaining: 2
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.839Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.839Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.839Z] Request URL: /auth/login
[2025-11-19T09:30:54.839Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.839Z] X-Test-ID header: null
[2025-11-19T09:30:54.839Z] Will use test ID?: false
[2025-11-19T09:30:54.839Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.839Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.839Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.839Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.839Z] Identifier: unknown
[2025-11-19T09:30:54.839Z] Key: login:unknown
[2025-11-19T09:30:54.839Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.839Z] Existing timestamps: 3
[2025-11-19T09:30:54.839Z] Current count after filter: 3
[2025-11-19T09:30:54.839Z] Max requests allowed: 5
[2025-11-19T09:30:54.839Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.839Z] New count: 4
[2025-11-19T09:30:54.839Z] Remaining: 1
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.839Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763544714836
}
[2025-11-19T09:31:02.420Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.420Z] Request URL: /auth/token
[2025-11-19T09:31:02.421Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.421Z] X-Test-ID header: null
[2025-11-19T09:31:02.421Z] Will use test ID?: false
[2025-11-19T09:31:02.421Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.421Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.421Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.421Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.421Z] Identifier: unknown
[2025-11-19T09:31:02.421Z] Key: token:unknown
[2025-11-19T09:31:02.421Z] üìù Creating new entry for key: token:unknown
[2025-11-19T09:31:02.421Z] Current count after filter: 0
[2025-11-19T09:31:02.421Z] Max requests allowed: 60
[2025-11-19T09:31:02.421Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.422Z] New count: 1
[2025-11-19T09:31:02.422Z] Remaining: 59
[2025-11-19T09:31:02.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.422Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.422Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.422Z] Request URL: /auth/token
[2025-11-19T09:31:02.422Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.423Z] X-Test-ID header: null
[2025-11-19T09:31:02.423Z] Will use test ID?: false
[2025-11-19T09:31:02.423Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.423Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.423Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.423Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.423Z] Identifier: unknown
[2025-11-19T09:31:02.423Z] Key: token:unknown
[2025-11-19T09:31:02.423Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.423Z] Existing timestamps: 1
[2025-11-19T09:31:02.423Z] Current count after filter: 1
[2025-11-19T09:31:02.423Z] Max requests allowed: 60
[2025-11-19T09:31:02.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.423Z] New count: 2
[2025-11-19T09:31:02.423Z] Remaining: 58
[2025-11-19T09:31:02.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.423Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.451Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.451Z] Request URL: /auth/token
[2025-11-19T09:31:02.451Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.451Z] X-Test-ID header: null
[2025-11-19T09:31:02.451Z] Will use test ID?: false
[2025-11-19T09:31:02.451Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.451Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.451Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.451Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.451Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.451Z] Identifier: unknown
[2025-11-19T09:31:02.451Z] Key: token:unknown
[2025-11-19T09:31:02.451Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.451Z] Existing timestamps: 2
[2025-11-19T09:31:02.451Z] Current count after filter: 2
[2025-11-19T09:31:02.451Z] Max requests allowed: 60
[2025-11-19T09:31:02.451Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.451Z] New count: 3
[2025-11-19T09:31:02.451Z] Remaining: 57
[2025-11-19T09:31:02.451Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.451Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.485Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.485Z] Request URL: /auth/token
[2025-11-19T09:31:02.485Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.485Z] X-Test-ID header: null
[2025-11-19T09:31:02.485Z] Will use test ID?: false
[2025-11-19T09:31:02.485Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.485Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.485Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.485Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.485Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.486Z] Identifier: unknown
[2025-11-19T09:31:02.486Z] Key: token:unknown
[2025-11-19T09:31:02.486Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.486Z] Existing timestamps: 3
[2025-11-19T09:31:02.486Z] Current count after filter: 3
[2025-11-19T09:31:02.486Z] Max requests allowed: 60
[2025-11-19T09:31:02.486Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.486Z] New count: 4
[2025-11-19T09:31:02.486Z] Remaining: 56
[2025-11-19T09:31:02.486Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.486Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.198Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.198Z] Request URL: /auth/token
[2025-11-19T09:31:03.198Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.198Z] X-Test-ID header: null
[2025-11-19T09:31:03.198Z] Will use test ID?: false
[2025-11-19T09:31:03.199Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.199Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.199Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.199Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.199Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.199Z] Identifier: unknown
[2025-11-19T09:31:03.199Z] Key: token:unknown
[2025-11-19T09:31:03.199Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.199Z] Existing timestamps: 4
[2025-11-19T09:31:03.199Z] Current count after filter: 4
[2025-11-19T09:31:03.199Z] Max requests allowed: 60
[2025-11-19T09:31:03.199Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.199Z] New count: 5
[2025-11-19T09:31:03.199Z] Remaining: 55
[2025-11-19T09:31:03.199Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.199Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.203Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.203Z] Request URL: /auth/token
[2025-11-19T09:31:03.203Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.203Z] X-Test-ID header: null
[2025-11-19T09:31:03.203Z] Will use test ID?: false
[2025-11-19T09:31:03.203Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.203Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.203Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.203Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.203Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.203Z] Identifier: unknown
[2025-11-19T09:31:03.203Z] Key: token:unknown
[2025-11-19T09:31:03.203Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.203Z] Existing timestamps: 5
[2025-11-19T09:31:03.203Z] Current count after filter: 5
[2025-11-19T09:31:03.204Z] Max requests allowed: 60
[2025-11-19T09:31:03.204Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.204Z] New count: 6
[2025-11-19T09:31:03.204Z] Remaining: 54
[2025-11-19T09:31:03.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.204Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.225Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.226Z] Request URL: /auth/token
[2025-11-19T09:31:03.226Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.226Z] X-Test-ID header: null
[2025-11-19T09:31:03.226Z] Will use test ID?: false
[2025-11-19T09:31:03.226Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.226Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.226Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.226Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.226Z] Identifier: unknown
[2025-11-19T09:31:03.226Z] Key: token:unknown
[2025-11-19T09:31:03.226Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.226Z] Existing timestamps: 6
[2025-11-19T09:31:03.226Z] Current count after filter: 6
[2025-11-19T09:31:03.226Z] Max requests allowed: 60
[2025-11-19T09:31:03.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.226Z] New count: 7
[2025-11-19T09:31:03.226Z] Remaining: 53
[2025-11-19T09:31:03.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.226Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.231Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.231Z] Request URL: /auth/token
[2025-11-19T09:31:03.231Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.231Z] X-Test-ID header: null
[2025-11-19T09:31:03.231Z] Will use test ID?: false
[2025-11-19T09:31:03.231Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.231Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.231Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.231Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.232Z] Identifier: unknown
[2025-11-19T09:31:03.232Z] Key: token:unknown
[2025-11-19T09:31:03.232Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.232Z] Existing timestamps: 7
[2025-11-19T09:31:03.232Z] Current count after filter: 7
[2025-11-19T09:31:03.232Z] Max requests allowed: 60
[2025-11-19T09:31:03.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.232Z] New count: 8
[2025-11-19T09:31:03.232Z] Remaining: 52
[2025-11-19T09:31:03.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.232Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:07.955Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:07.955Z] Request URL: /auth/token
[2025-11-19T09:31:07.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:07.956Z] X-Test-ID header: null
[2025-11-19T09:31:07.956Z] Will use test ID?: false
[2025-11-19T09:31:07.956Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:07.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:07.956Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:07.956Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:07.956Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:07.956Z] Identifier: unknown
[2025-11-19T09:31:07.956Z] Key: token:unknown
[2025-11-19T09:31:07.956Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:07.956Z] Existing timestamps: 8
[2025-11-19T09:31:07.956Z] Current count after filter: 8
[2025-11-19T09:31:07.956Z] Max requests allowed: 60
[2025-11-19T09:31:07.956Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:07.956Z] New count: 9
[2025-11-19T09:31:07.956Z] Remaining: 51
[2025-11-19T09:31:07.956Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:07.956Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:08.784Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:08.784Z] Request URL: /auth/token
[2025-11-19T09:31:08.785Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:08.785Z] X-Test-ID header: null
[2025-11-19T09:31:08.785Z] Will use test ID?: false
[2025-11-19T09:31:08.785Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:08.785Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:08.785Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:08.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:08.785Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:08.785Z] Identifier: unknown
[2025-11-19T09:31:08.785Z] Key: token:unknown
[2025-11-19T09:31:08.785Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:08.786Z] Existing timestamps: 9
[2025-11-19T09:31:08.786Z] Current count after filter: 9
[2025-11-19T09:31:08.786Z] Max requests allowed: 60
[2025-11-19T09:31:08.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:08.786Z] New count: 10
[2025-11-19T09:31:08.786Z] Remaining: 50
[2025-11-19T09:31:08.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:08.786Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763544722421
}
[2025-11-19T09:32:06.852Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.853Z] Request URL: /auth/token
[2025-11-19T09:32:06.853Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.853Z] X-Test-ID header: null
[2025-11-19T09:32:06.853Z] Will use test ID?: false
[2025-11-19T09:32:06.853Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.853Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.853Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.853Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.853Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.853Z] Identifier: unknown
[2025-11-19T09:32:06.853Z] Key: token:unknown
[2025-11-19T09:32:06.853Z] üìù Creating new entry for key: token:unknown
[2025-11-19T09:32:06.853Z] Current count after filter: 0
[2025-11-19T09:32:06.853Z] Max requests allowed: 60
[2025-11-19T09:32:06.853Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.854Z] New count: 1
[2025-11-19T09:32:06.854Z] Remaining: 59
[2025-11-19T09:32:06.854Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.854Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.854Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.854Z] Request URL: /auth/token
[2025-11-19T09:32:06.854Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.854Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.855Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.855Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.855Z] X-Test-ID header: null
[2025-11-19T09:32:06.855Z] Will use test ID?: false
[2025-11-19T09:32:06.855Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.855Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.855Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.855Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.855Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.855Z] Identifier: unknown
[2025-11-19T09:32:06.855Z] Key: token:unknown
[2025-11-19T09:32:06.855Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.855Z] Existing timestamps: 1
[2025-11-19T09:32:06.855Z] Current count after filter: 1
[2025-11-19T09:32:06.855Z] Max requests allowed: 60
[2025-11-19T09:32:06.855Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.855Z] New count: 2
[2025-11-19T09:32:06.855Z] Remaining: 58
[2025-11-19T09:32:06.855Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.855Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.876Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.877Z] Request URL: /auth/token
[2025-11-19T09:32:06.877Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.877Z] X-Test-ID header: null
[2025-11-19T09:32:06.877Z] Will use test ID?: false
[2025-11-19T09:32:06.877Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.877Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.877Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.877Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.877Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.877Z] Identifier: unknown
[2025-11-19T09:32:06.877Z] Key: token:unknown
[2025-11-19T09:32:06.877Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.877Z] Existing timestamps: 2
[2025-11-19T09:32:06.877Z] Current count after filter: 2
[2025-11-19T09:32:06.877Z] Max requests allowed: 60
[2025-11-19T09:32:06.877Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.877Z] New count: 3
[2025-11-19T09:32:06.877Z] Remaining: 57
[2025-11-19T09:32:06.877Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.877Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.885Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.885Z] Request URL: /auth/token
[2025-11-19T09:32:06.885Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.885Z] X-Test-ID header: null
[2025-11-19T09:32:06.885Z] Will use test ID?: false
[2025-11-19T09:32:06.885Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.885Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.885Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.885Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.885Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.885Z] Identifier: unknown
[2025-11-19T09:32:06.885Z] Key: token:unknown
[2025-11-19T09:32:06.886Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.886Z] Existing timestamps: 3
[2025-11-19T09:32:06.886Z] Current count after filter: 3
[2025-11-19T09:32:06.886Z] Max requests allowed: 60
[2025-11-19T09:32:06.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.886Z] New count: 4
[2025-11-19T09:32:06.886Z] Remaining: 56
[2025-11-19T09:32:06.886Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.886Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.627Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.627Z] Request URL: /auth/token
[2025-11-19T09:32:07.628Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.628Z] X-Test-ID header: null
[2025-11-19T09:32:07.628Z] Will use test ID?: false
[2025-11-19T09:32:07.628Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.628Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.628Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.628Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.628Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.628Z] Identifier: unknown
[2025-11-19T09:32:07.628Z] Key: token:unknown
[2025-11-19T09:32:07.628Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.628Z] Existing timestamps: 4
[2025-11-19T09:32:07.628Z] Current count after filter: 4
[2025-11-19T09:32:07.628Z] Max requests allowed: 60
[2025-11-19T09:32:07.628Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.629Z] New count: 5
[2025-11-19T09:32:07.629Z] Remaining: 55
[2025-11-19T09:32:07.629Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.629Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.630Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.630Z] Request URL: /auth/token
[2025-11-19T09:32:07.630Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.630Z] X-Test-ID header: null
[2025-11-19T09:32:07.630Z] Will use test ID?: false
[2025-11-19T09:32:07.630Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.630Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.630Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.630Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.630Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.630Z] Identifier: unknown
[2025-11-19T09:32:07.630Z] Key: token:unknown
[2025-11-19T09:32:07.630Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.630Z] Existing timestamps: 5
[2025-11-19T09:32:07.630Z] Current count after filter: 5
[2025-11-19T09:32:07.630Z] Max requests allowed: 60
[2025-11-19T09:32:07.630Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.630Z] New count: 6
[2025-11-19T09:32:07.631Z] Remaining: 54
[2025-11-19T09:32:07.631Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.631Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.636Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.636Z] Request URL: /auth/token
[2025-11-19T09:32:07.636Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.636Z] X-Test-ID header: null
[2025-11-19T09:32:07.636Z] Will use test ID?: false
[2025-11-19T09:32:07.637Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.637Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.637Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.637Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.637Z] Identifier: unknown
[2025-11-19T09:32:07.637Z] Key: token:unknown
[2025-11-19T09:32:07.637Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.637Z] Existing timestamps: 6
[2025-11-19T09:32:07.637Z] Current count after filter: 6
[2025-11-19T09:32:07.637Z] Max requests allowed: 60
[2025-11-19T09:32:07.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.637Z] New count: 7
[2025-11-19T09:32:07.637Z] Remaining: 53
[2025-11-19T09:32:07.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.637Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.652Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.652Z] Request URL: /auth/token
[2025-11-19T09:32:07.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.652Z] X-Test-ID header: null
[2025-11-19T09:32:07.652Z] Will use test ID?: false
[2025-11-19T09:32:07.652Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.652Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.652Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.652Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.652Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.652Z] Identifier: unknown
[2025-11-19T09:32:07.652Z] Key: token:unknown
[2025-11-19T09:32:07.652Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.652Z] Existing timestamps: 7
[2025-11-19T09:32:07.652Z] Current count after filter: 7
[2025-11-19T09:32:07.652Z] Max requests allowed: 60
[2025-11-19T09:32:07.652Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.652Z] New count: 8
[2025-11-19T09:32:07.652Z] Remaining: 52
[2025-11-19T09:32:07.652Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.652Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:12.432Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:12.432Z] Request URL: /auth/token
[2025-11-19T09:32:12.432Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:12.432Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:12.432Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:12.433Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:12.433Z] X-Test-ID header: null
[2025-11-19T09:32:12.433Z] Will use test ID?: false
[2025-11-19T09:32:12.433Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:12.433Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:12.433Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:12.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:12.433Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:12.433Z] Identifier: unknown
[2025-11-19T09:32:12.433Z] Key: token:unknown
[2025-11-19T09:32:12.433Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:12.433Z] Existing timestamps: 8
[2025-11-19T09:32:12.433Z] Current count after filter: 8
[2025-11-19T09:32:12.433Z] Max requests allowed: 60
[2025-11-19T09:32:12.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:12.433Z] New count: 9
[2025-11-19T09:32:12.433Z] Remaining: 51
[2025-11-19T09:32:12.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:12.433Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:13.259Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:13.259Z] Request URL: /auth/token
[2025-11-19T09:32:13.260Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:13.260Z] X-Test-ID header: null
[2025-11-19T09:32:13.260Z] Will use test ID?: false
[2025-11-19T09:32:13.260Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:13.260Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:13.260Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:13.260Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:13.260Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:13.260Z] Identifier: unknown
[2025-11-19T09:32:13.260Z] Key: token:unknown
[2025-11-19T09:32:13.260Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:13.260Z] Existing timestamps: 9
[2025-11-19T09:32:13.260Z] Current count after filter: 9
[2025-11-19T09:32:13.261Z] Max requests allowed: 60
[2025-11-19T09:32:13.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:13.261Z] New count: 10
[2025-11-19T09:32:13.261Z] Remaining: 50
[2025-11-19T09:32:13.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:13.261Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763544786853
}
[2025-11-19T09:44:55.472Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.473Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.473Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.473Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.473Z] üìù Creating new entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Current count after filter: 0
[2025-11-19T09:44:55.474Z] Max requests allowed: 5
[2025-11-19T09:44:55.474Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.474Z] New count: 1
[2025-11-19T09:44:55.474Z] Remaining: 4
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.474Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.474Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Existing timestamps: 1
[2025-11-19T09:44:55.474Z] Current count after filter: 1
[2025-11-19T09:44:55.474Z] Max requests allowed: 5
[2025-11-19T09:44:55.474Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.474Z] New count: 2
[2025-11-19T09:44:55.474Z] Remaining: 3
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Existing timestamps: 2
[2025-11-19T09:44:55.475Z] Current count after filter: 2
[2025-11-19T09:44:55.475Z] Max requests allowed: 5
[2025-11-19T09:44:55.475Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.475Z] New count: 3
[2025-11-19T09:44:55.475Z] Remaining: 2
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Existing timestamps: 3
[2025-11-19T09:44:55.475Z] Current count after filter: 3
[2025-11-19T09:44:55.475Z] Max requests allowed: 5
[2025-11-19T09:44:55.475Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.475Z] New count: 4
[2025-11-19T09:44:55.475Z] Remaining: 1
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.476Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.476Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.476Z] Existing timestamps: 4
[2025-11-19T09:44:55.476Z] Current count after filter: 4
[2025-11-19T09:44:55.476Z] Max requests allowed: 5
[2025-11-19T09:44:55.476Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.476Z] New count: 5
[2025-11-19T09:44:55.476Z] Remaining: 0
[2025-11-19T09:44:55.476Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.476Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìù Creating new entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Current count after filter: 0
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 1
[2025-11-19T09:44:55.477Z] Remaining: 4
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Existing timestamps: 1
[2025-11-19T09:44:55.477Z] Current count after filter: 1
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 2
[2025-11-19T09:44:55.477Z] Remaining: 3
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Existing timestamps: 2
[2025-11-19T09:44:55.477Z] Current count after filter: 2
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 3
[2025-11-19T09:44:55.477Z] Remaining: 2
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 3
[2025-11-19T09:44:55.478Z] Current count after filter: 3
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.478Z] New count: 4
[2025-11-19T09:44:55.478Z] Remaining: 1
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.478Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.478Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 4
[2025-11-19T09:44:55.478Z] Current count after filter: 4
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.478Z] New count: 5
[2025-11-19T09:44:55.478Z] Remaining: 0
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.478Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.478Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 5
[2025-11-19T09:44:55.478Z] Current count after filter: 5
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.478Z] Current count: 5
[2025-11-19T09:44:55.478Z] Max allowed: 5
[2025-11-19T09:44:55.478Z] Retry after (seconds): 60
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.479Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.479Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.479Z] üìù Creating new entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Current count after filter: 0
[2025-11-19T09:44:55.479Z] Max requests allowed: 2
[2025-11-19T09:44:55.479Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.479Z] New count: 1
[2025-11-19T09:44:55.479Z] Remaining: 1
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.479Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.479Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Existing timestamps: 1
[2025-11-19T09:44:55.480Z] Current count after filter: 1
[2025-11-19T09:44:55.480Z] Max requests allowed: 2
[2025-11-19T09:44:55.480Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.480Z] New count: 2
[2025-11-19T09:44:55.480Z] Remaining: 0
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.480Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.480Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Existing timestamps: 2
[2025-11-19T09:44:55.480Z] Current count after filter: 2
[2025-11-19T09:44:55.480Z] Max requests allowed: 2
[2025-11-19T09:44:55.480Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.480Z] Current count: 2
[2025-11-19T09:44:55.480Z] Max allowed: 2
[2025-11-19T09:44:55.480Z] Retry after (seconds): 1
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.631Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.632Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.632Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.632Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.632Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.632Z] Existing timestamps: 2
[2025-11-19T09:44:55.632Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:44:55.632Z] Current count after filter: 0
[2025-11-19T09:44:55.633Z] Max requests allowed: 2
[2025-11-19T09:44:55.633Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.633Z] New count: 1
[2025-11-19T09:44:55.633Z] Remaining: 1
[2025-11-19T09:44:55.633Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.633Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.634Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.634Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] üìù Creating new entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] Current count after filter: 0
[2025-11-19T09:44:55.634Z] Max requests allowed: 5
[2025-11-19T09:44:55.634Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.634Z] New count: 1
[2025-11-19T09:44:55.634Z] Remaining: 4
[2025-11-19T09:44:55.634Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.634Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.634Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.634Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.635Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.635Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.636Z] Existing timestamps: 1
[2025-11-19T09:44:55.636Z] Current count after filter: 1
[2025-11-19T09:44:55.636Z] Max requests allowed: 5
[2025-11-19T09:44:55.636Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.636Z] New count: 2
[2025-11-19T09:44:55.636Z] Remaining: 3
[2025-11-19T09:44:55.636Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.636Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.636Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 2
[2025-11-19T09:44:55.637Z] Current count after filter: 2
[2025-11-19T09:44:55.637Z] Max requests allowed: 5
[2025-11-19T09:44:55.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.637Z] New count: 3
[2025-11-19T09:44:55.637Z] Remaining: 2
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.637Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 3
[2025-11-19T09:44:55.637Z] Current count after filter: 3
[2025-11-19T09:44:55.637Z] Max requests allowed: 5
[2025-11-19T09:44:55.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.637Z] New count: 4
[2025-11-19T09:44:55.637Z] Remaining: 1
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.637Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 4
[2025-11-19T09:44:55.637Z] Current count after filter: 4
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.638Z] New count: 5
[2025-11-19T09:44:55.638Z] Remaining: 0
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.638Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.638Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] Existing timestamps: 5
[2025-11-19T09:44:55.638Z] Current count after filter: 5
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.638Z] Current count: 5
[2025-11-19T09:44:55.638Z] Max allowed: 5
[2025-11-19T09:44:55.638Z] Retry after (seconds): 60
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.638Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.638Z] Identifier: test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] Key: login:test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] üìù Creating new entry for key: login:test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] Current count after filter: 0
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.638Z] New count: 1
[2025-11-19T09:44:55.638Z] Remaining: 4
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.639Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.639Z] Identifier: test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] Key: login:test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] üìù Creating new entry for key: login:test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] Current count after filter: 0
[2025-11-19T09:44:55.639Z] Max requests allowed: 5
[2025-11-19T09:44:55.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.639Z] New count: 1
[2025-11-19T09:44:55.639Z] Remaining: 4
[2025-11-19T09:44:55.639Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.640Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.641Z] X-Test-ID header: null
[2025-11-19T09:44:55.641Z] Will use test ID?: false
[2025-11-19T09:44:55.641Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.641Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.642Z] X-Test-ID header: null
[2025-11-19T09:44:55.642Z] Will use test ID?: false
[2025-11-19T09:44:55.642Z] Using real IP: 192.168.1.2
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.642Z] X-Test-ID header: null
[2025-11-19T09:44:55.642Z] Will use test ID?: false
[2025-11-19T09:44:55.642Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.643Z] X-Test-ID header: null
[2025-11-19T09:44:55.643Z] Will use test ID?: false
[2025-11-19T09:44:55.643Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.643Z] X-Test-ID header: null
[2025-11-19T09:44:55.643Z] Will use test ID?: false
[2025-11-19T09:44:55.643Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.644Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.644Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.644Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] Current count after filter: 0
[2025-11-19T09:44:55.645Z] Max requests allowed: 3
[2025-11-19T09:44:55.645Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.645Z] New count: 1
[2025-11-19T09:44:55.645Z] Remaining: 2
[2025-11-19T09:44:55.645Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.746Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.746Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.746Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] Existing timestamps: 1
[2025-11-19T09:44:55.747Z] Current count after filter: 1
[2025-11-19T09:44:55.747Z] Max requests allowed: 3
[2025-11-19T09:44:55.747Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.747Z] New count: 2
[2025-11-19T09:44:55.747Z] Remaining: 1
[2025-11-19T09:44:55.747Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.848Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.848Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.848Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.848Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.849Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.849Z] Existing timestamps: 2
[2025-11-19T09:44:55.849Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:44:55.849Z] Current count after filter: 1
[2025-11-19T09:44:55.849Z] Max requests allowed: 3
[2025-11-19T09:44:55.849Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.849Z] New count: 2
[2025-11-19T09:44:55.849Z] Remaining: 1
[2025-11-19T09:44:55.849Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.849Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.849Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.849Z] Identifier: test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] Key: register:test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] üìù Creating new entry for key: register:test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] Current count after filter: 0
[2025-11-19T09:44:55.849Z] Max requests allowed: 3
[2025-11-19T09:44:55.850Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.850Z] New count: 1
[2025-11-19T09:44:55.850Z] Remaining: 2
[2025-11-19T09:44:55.850Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.850Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.850Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.850Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] üìù Creating new entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Current count after filter: 0
[2025-11-19T09:44:55.851Z] Max requests allowed: 3
[2025-11-19T09:44:55.851Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.851Z] New count: 1
[2025-11-19T09:44:55.851Z] Remaining: 2
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.851Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.851Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Existing timestamps: 1
[2025-11-19T09:44:55.851Z] Current count after filter: 1
[2025-11-19T09:44:55.851Z] Max requests allowed: 3
[2025-11-19T09:44:55.851Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.851Z] New count: 2
[2025-11-19T09:44:55.851Z] Remaining: 1
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.852Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.852Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] Existing timestamps: 2
[2025-11-19T09:44:55.852Z] Current count after filter: 2
[2025-11-19T09:44:55.852Z] Max requests allowed: 3
[2025-11-19T09:44:55.852Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.852Z] New count: 3
[2025-11-19T09:44:55.852Z] Remaining: 0
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.852Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.853Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] Existing timestamps: 3
[2025-11-19T09:44:55.853Z] Current count after filter: 3
[2025-11-19T09:44:55.853Z] Max requests allowed: 3
[2025-11-19T09:44:55.853Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.853Z] Current count: 3
[2025-11-19T09:44:55.853Z] Max allowed: 3
[2025-11-19T09:44:55.853Z] Retry after (seconds): 60
[2025-11-19T09:44:55.853Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.785Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.785Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.785Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.785Z] üìù Creating new entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.785Z] Current count after filter: 0
[2025-11-19T09:45:14.785Z] Max requests allowed: 5
[2025-11-19T09:45:14.785Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.786Z] New count: 1
[2025-11-19T09:45:14.786Z] Remaining: 4
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.786Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Existing timestamps: 1
[2025-11-19T09:45:14.786Z] Current count after filter: 1
[2025-11-19T09:45:14.786Z] Max requests allowed: 5
[2025-11-19T09:45:14.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.786Z] New count: 2
[2025-11-19T09:45:14.786Z] Remaining: 3
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.786Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Existing timestamps: 2
[2025-11-19T09:45:14.786Z] Current count after filter: 2
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 3
[2025-11-19T09:45:14.787Z] Remaining: 2
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.787Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Existing timestamps: 3
[2025-11-19T09:45:14.787Z] Current count after filter: 3
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 4
[2025-11-19T09:45:14.787Z] Remaining: 1
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.787Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Existing timestamps: 4
[2025-11-19T09:45:14.787Z] Current count after filter: 4
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 5
[2025-11-19T09:45:14.787Z] Remaining: 0
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.788Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.788Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] üìù Creating new entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] Current count after filter: 0
[2025-11-19T09:45:14.788Z] Max requests allowed: 5
[2025-11-19T09:45:14.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.788Z] New count: 1
[2025-11-19T09:45:14.788Z] Remaining: 4
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.788Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.788Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] Existing timestamps: 1
[2025-11-19T09:45:14.789Z] Current count after filter: 1
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 2
[2025-11-19T09:45:14.789Z] Remaining: 3
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 2
[2025-11-19T09:45:14.789Z] Current count after filter: 2
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 3
[2025-11-19T09:45:14.789Z] Remaining: 2
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 3
[2025-11-19T09:45:14.789Z] Current count after filter: 3
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 4
[2025-11-19T09:45:14.789Z] Remaining: 1
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 4
[2025-11-19T09:45:14.789Z] Current count after filter: 4
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.790Z] New count: 5
[2025-11-19T09:45:14.790Z] Remaining: 0
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.790Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.790Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.790Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.790Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.790Z] Existing timestamps: 5
[2025-11-19T09:45:14.790Z] Current count after filter: 5
[2025-11-19T09:45:14.790Z] Max requests allowed: 5
[2025-11-19T09:45:14.790Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.790Z] Current count: 5
[2025-11-19T09:45:14.790Z] Max allowed: 5
[2025-11-19T09:45:14.790Z] Retry after (seconds): 60
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.790Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.790Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.790Z] üìù Creating new entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.790Z] Current count after filter: 0
[2025-11-19T09:45:14.791Z] Max requests allowed: 2
[2025-11-19T09:45:14.791Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.791Z] New count: 1
[2025-11-19T09:45:14.791Z] Remaining: 1
[2025-11-19T09:45:14.791Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.791Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.791Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.791Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.791Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.791Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.791Z] Existing timestamps: 1
[2025-11-19T09:45:14.791Z] Current count after filter: 1
[2025-11-19T09:45:14.791Z] Max requests allowed: 2
[2025-11-19T09:45:14.791Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.791Z] New count: 2
[2025-11-19T09:45:14.792Z] Remaining: 0
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.792Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.792Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.792Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.792Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.792Z] Existing timestamps: 2
[2025-11-19T09:45:14.792Z] Current count after filter: 2
[2025-11-19T09:45:14.792Z] Max requests allowed: 2
[2025-11-19T09:45:14.792Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.792Z] Current count: 2
[2025-11-19T09:45:14.792Z] Max allowed: 2
[2025-11-19T09:45:14.792Z] Retry after (seconds): 1
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.947Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.947Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.947Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.947Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.947Z] Existing timestamps: 2
[2025-11-19T09:45:14.947Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:45:14.947Z] Current count after filter: 0
[2025-11-19T09:45:14.947Z] Max requests allowed: 2
[2025-11-19T09:45:14.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.950Z] New count: 1
[2025-11-19T09:45:14.951Z] Remaining: 1
[2025-11-19T09:45:14.951Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.952Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.952Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.952Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.952Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìù Creating new entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Current count after filter: 0
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 1
[2025-11-19T09:45:14.953Z] Remaining: 4
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 1
[2025-11-19T09:45:14.953Z] Current count after filter: 1
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 2
[2025-11-19T09:45:14.953Z] Remaining: 3
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 2
[2025-11-19T09:45:14.953Z] Current count after filter: 2
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 3
[2025-11-19T09:45:14.953Z] Remaining: 2
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 3
[2025-11-19T09:45:14.953Z] Current count after filter: 3
[2025-11-19T09:45:14.956Z] Max requests allowed: 5
[2025-11-19T09:45:14.956Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.956Z] New count: 4
[2025-11-19T09:45:14.956Z] Remaining: 1
[2025-11-19T09:45:14.956Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.956Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.956Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.956Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] Existing timestamps: 4
[2025-11-19T09:45:14.957Z] Current count after filter: 4
[2025-11-19T09:45:14.957Z] Max requests allowed: 5
[2025-11-19T09:45:14.957Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.957Z] New count: 5
[2025-11-19T09:45:14.957Z] Remaining: 0
[2025-11-19T09:45:14.957Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.957Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.957Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.957Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.958Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.959Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.959Z] Existing timestamps: 5
[2025-11-19T09:45:14.959Z] Current count after filter: 5
[2025-11-19T09:45:14.959Z] Max requests allowed: 5
[2025-11-19T09:45:14.959Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.959Z] Current count: 5
[2025-11-19T09:45:14.959Z] Max allowed: 5
[2025-11-19T09:45:14.959Z] Retry after (seconds): 60
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.959Z] Identifier: test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] Key: login:test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] üìù Creating new entry for key: login:test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] Current count after filter: 0
[2025-11-19T09:45:14.959Z] Max requests allowed: 5
[2025-11-19T09:45:14.959Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.959Z] New count: 1
[2025-11-19T09:45:14.959Z] Remaining: 4
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.960Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.960Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.960Z] Identifier: test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] Key: login:test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] üìù Creating new entry for key: login:test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] Current count after filter: 0
[2025-11-19T09:45:14.960Z] Max requests allowed: 5
[2025-11-19T09:45:14.960Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.960Z] New count: 1
[2025-11-19T09:45:14.960Z] Remaining: 4
[2025-11-19T09:45:14.960Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.961Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.962Z] X-Test-ID header: null
[2025-11-19T09:45:14.962Z] Will use test ID?: false
[2025-11-19T09:45:14.962Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.962Z] X-Test-ID header: null
[2025-11-19T09:45:14.962Z] Will use test ID?: false
[2025-11-19T09:45:14.962Z] Using real IP: 192.168.1.2
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.963Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.963Z] X-Test-ID header: null
[2025-11-19T09:45:14.963Z] Will use test ID?: false
[2025-11-19T09:45:14.963Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.963Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.964Z] X-Test-ID header: null
[2025-11-19T09:45:14.964Z] Will use test ID?: false
[2025-11-19T09:45:14.964Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.965Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.965Z] X-Test-ID header: null
[2025-11-19T09:45:14.965Z] Will use test ID?: false
[2025-11-19T09:45:14.965Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.965Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.965Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.965Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:14.965Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] Current count after filter: 0
[2025-11-19T09:45:14.965Z] Max requests allowed: 3
[2025-11-19T09:45:14.965Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.965Z] New count: 1
[2025-11-19T09:45:14.965Z] Remaining: 2
[2025-11-19T09:45:14.965Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.084Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.088Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:15.089Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] Existing timestamps: 1
[2025-11-19T09:45:15.089Z] Current count after filter: 1
[2025-11-19T09:45:15.090Z] Max requests allowed: 3
[2025-11-19T09:45:15.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.090Z] New count: 2
[2025-11-19T09:45:15.090Z] Remaining: 1
[2025-11-19T09:45:15.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.192Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.192Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:15.192Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] Existing timestamps: 2
[2025-11-19T09:45:15.192Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:45:15.192Z] Current count after filter: 1
[2025-11-19T09:45:15.192Z] Max requests allowed: 3
[2025-11-19T09:45:15.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.193Z] New count: 2
[2025-11-19T09:45:15.193Z] Remaining: 1
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.193Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.193Z] Identifier: test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] Key: register:test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] üìù Creating new entry for key: register:test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] Current count after filter: 0
[2025-11-19T09:45:15.193Z] Max requests allowed: 3
[2025-11-19T09:45:15.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.193Z] New count: 1
[2025-11-19T09:45:15.193Z] Remaining: 2
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.194Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.194Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] üìù Creating new entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Current count after filter: 0
[2025-11-19T09:45:15.194Z] Max requests allowed: 3
[2025-11-19T09:45:15.194Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.194Z] New count: 1
[2025-11-19T09:45:15.194Z] Remaining: 2
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.194Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.194Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Existing timestamps: 1
[2025-11-19T09:45:15.194Z] Current count after filter: 1
[2025-11-19T09:45:15.195Z] Max requests allowed: 3
[2025-11-19T09:45:15.195Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.195Z] New count: 2
[2025-11-19T09:45:15.195Z] Remaining: 1
[2025-11-19T09:45:15.195Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.195Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.195Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.196Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] Existing timestamps: 2
[2025-11-19T09:45:15.196Z] Current count after filter: 2
[2025-11-19T09:45:15.196Z] Max requests allowed: 3
[2025-11-19T09:45:15.196Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.196Z] New count: 3
[2025-11-19T09:45:15.197Z] Remaining: 0
[2025-11-19T09:45:15.197Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.197Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.197Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.197Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] Existing timestamps: 3
[2025-11-19T09:45:15.197Z] Current count after filter: 3
[2025-11-19T09:45:15.197Z] Max requests allowed: 3
[2025-11-19T09:45:15.197Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:15.197Z] Current count: 3
[2025-11-19T09:45:15.198Z] Max allowed: 3
[2025-11-19T09:45:15.198Z] Retry after (seconds): 60
[2025-11-19T09:45:15.198Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.395Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.395Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.395Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.395Z] üìù Creating new entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.395Z] Current count after filter: 0
[2025-11-19T09:45:36.396Z] Max requests allowed: 5
[2025-11-19T09:45:36.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.396Z] New count: 1
[2025-11-19T09:45:36.396Z] Remaining: 4
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.396Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.396Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.396Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.396Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.396Z] Existing timestamps: 1
[2025-11-19T09:45:36.396Z] Current count after filter: 1
[2025-11-19T09:45:36.396Z] Max requests allowed: 5
[2025-11-19T09:45:36.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.396Z] New count: 2
[2025-11-19T09:45:36.396Z] Remaining: 3
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.397Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.397Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.397Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.397Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.397Z] Existing timestamps: 2
[2025-11-19T09:45:36.397Z] Current count after filter: 2
[2025-11-19T09:45:36.397Z] Max requests allowed: 5
[2025-11-19T09:45:36.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.397Z] New count: 3
[2025-11-19T09:45:36.397Z] Remaining: 2
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.397Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.397Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Existing timestamps: 3
[2025-11-19T09:45:36.398Z] Current count after filter: 3
[2025-11-19T09:45:36.398Z] Max requests allowed: 5
[2025-11-19T09:45:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.398Z] New count: 4
[2025-11-19T09:45:36.398Z] Remaining: 1
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.398Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.398Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Existing timestamps: 4
[2025-11-19T09:45:36.398Z] Current count after filter: 4
[2025-11-19T09:45:36.398Z] Max requests allowed: 5
[2025-11-19T09:45:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.398Z] New count: 5
[2025-11-19T09:45:36.398Z] Remaining: 0
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.399Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.399Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] üìù Creating new entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] Current count after filter: 0
[2025-11-19T09:45:36.399Z] Max requests allowed: 5
[2025-11-19T09:45:36.399Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.399Z] New count: 1
[2025-11-19T09:45:36.399Z] Remaining: 4
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.399Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.399Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] Existing timestamps: 1
[2025-11-19T09:45:36.399Z] Current count after filter: 1
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 2
[2025-11-19T09:45:36.400Z] Remaining: 3
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] Existing timestamps: 2
[2025-11-19T09:45:36.400Z] Current count after filter: 2
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 3
[2025-11-19T09:45:36.400Z] Remaining: 2
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] Existing timestamps: 3
[2025-11-19T09:45:36.400Z] Current count after filter: 3
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 4
[2025-11-19T09:45:36.400Z] Remaining: 1
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] Existing timestamps: 4
[2025-11-19T09:45:36.401Z] Current count after filter: 4
[2025-11-19T09:45:36.401Z] Max requests allowed: 5
[2025-11-19T09:45:36.401Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.401Z] New count: 5
[2025-11-19T09:45:36.401Z] Remaining: 0
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.401Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.401Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.401Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] Existing timestamps: 5
[2025-11-19T09:45:36.401Z] Current count after filter: 5
[2025-11-19T09:45:36.401Z] Max requests allowed: 5
[2025-11-19T09:45:36.401Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.401Z] Current count: 5
[2025-11-19T09:45:36.401Z] Max allowed: 5
[2025-11-19T09:45:36.401Z] Retry after (seconds): 60
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.401Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.401Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.401Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] üìù Creating new entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] Current count after filter: 0
[2025-11-19T09:45:36.402Z] Max requests allowed: 2
[2025-11-19T09:45:36.402Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.402Z] New count: 1
[2025-11-19T09:45:36.402Z] Remaining: 1
[2025-11-19T09:45:36.402Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.402Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.402Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.402Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.402Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Existing timestamps: 1
[2025-11-19T09:45:36.403Z] Current count after filter: 1
[2025-11-19T09:45:36.403Z] Max requests allowed: 2
[2025-11-19T09:45:36.403Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.403Z] New count: 2
[2025-11-19T09:45:36.403Z] Remaining: 0
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.403Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.403Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Existing timestamps: 2
[2025-11-19T09:45:36.403Z] Current count after filter: 2
[2025-11-19T09:45:36.403Z] Max requests allowed: 2
[2025-11-19T09:45:36.403Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.403Z] Current count: 2
[2025-11-19T09:45:36.403Z] Max allowed: 2
[2025-11-19T09:45:36.403Z] Retry after (seconds): 1
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.554Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.554Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.554Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.554Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.554Z] Existing timestamps: 2
[2025-11-19T09:45:36.554Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:45:36.554Z] Current count after filter: 0
[2025-11-19T09:45:36.554Z] Max requests allowed: 2
[2025-11-19T09:45:36.554Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.555Z] New count: 1
[2025-11-19T09:45:36.555Z] Remaining: 1
[2025-11-19T09:45:36.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.555Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.555Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.555Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] üìù Creating new entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] Current count after filter: 0
[2025-11-19T09:45:36.555Z] Max requests allowed: 5
[2025-11-19T09:45:36.555Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.556Z] New count: 1
[2025-11-19T09:45:36.556Z] Remaining: 4
[2025-11-19T09:45:36.556Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.556Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.556Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.556Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] Existing timestamps: 1
[2025-11-19T09:45:36.556Z] Current count after filter: 1
[2025-11-19T09:45:36.556Z] Max requests allowed: 5
[2025-11-19T09:45:36.556Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.556Z] New count: 2
[2025-11-19T09:45:36.556Z] Remaining: 3
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.557Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.557Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] Existing timestamps: 2
[2025-11-19T09:45:36.557Z] Current count after filter: 2
[2025-11-19T09:45:36.557Z] Max requests allowed: 5
[2025-11-19T09:45:36.557Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.557Z] New count: 3
[2025-11-19T09:45:36.557Z] Remaining: 2
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.557Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.558Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Existing timestamps: 3
[2025-11-19T09:45:36.558Z] Current count after filter: 3
[2025-11-19T09:45:36.558Z] Max requests allowed: 5
[2025-11-19T09:45:36.558Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.558Z] New count: 4
[2025-11-19T09:45:36.558Z] Remaining: 1
[2025-11-19T09:45:36.558Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.558Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.558Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.558Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Existing timestamps: 4
[2025-11-19T09:45:36.558Z] Current count after filter: 4
[2025-11-19T09:45:36.558Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.559Z] New count: 5
[2025-11-19T09:45:36.559Z] Remaining: 0
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.559Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] Existing timestamps: 5
[2025-11-19T09:45:36.559Z] Current count after filter: 5
[2025-11-19T09:45:36.559Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.559Z] Current count: 5
[2025-11-19T09:45:36.559Z] Max allowed: 5
[2025-11-19T09:45:36.559Z] Retry after (seconds): 60
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.559Z] Identifier: test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] Key: login:test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] üìù Creating new entry for key: login:test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] Current count after filter: 0
[2025-11-19T09:45:36.559Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.559Z] New count: 1
[2025-11-19T09:45:36.559Z] Remaining: 4
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.560Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.560Z] Identifier: test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] Key: login:test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] üìù Creating new entry for key: login:test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] Current count after filter: 0
[2025-11-19T09:45:36.560Z] Max requests allowed: 5
[2025-11-19T09:45:36.560Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.560Z] New count: 1
[2025-11-19T09:45:36.560Z] Remaining: 4
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.561Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.561Z] X-Test-ID header: null
[2025-11-19T09:45:36.561Z] Will use test ID?: false
[2025-11-19T09:45:36.561Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.561Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.562Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.562Z] X-Test-ID header: null
[2025-11-19T09:45:36.562Z] Will use test ID?: false
[2025-11-19T09:45:36.562Z] Using real IP: 192.168.1.2
[2025-11-19T09:45:36.562Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.563Z] X-Test-ID header: null
[2025-11-19T09:45:36.563Z] Will use test ID?: false
[2025-11-19T09:45:36.563Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.563Z] X-Test-ID header: null
[2025-11-19T09:45:36.563Z] Will use test ID?: false
[2025-11-19T09:45:36.563Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.564Z] X-Test-ID header: null
[2025-11-19T09:45:36.564Z] Will use test ID?: false
[2025-11-19T09:45:36.564Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.564Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.564Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.564Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.564Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] Current count after filter: 0
[2025-11-19T09:45:36.564Z] Max requests allowed: 3
[2025-11-19T09:45:36.564Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.564Z] New count: 1
[2025-11-19T09:45:36.564Z] Remaining: 2
[2025-11-19T09:45:36.564Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.665Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.666Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] Existing timestamps: 1
[2025-11-19T09:45:36.666Z] Current count after filter: 1
[2025-11-19T09:45:36.666Z] Max requests allowed: 3
[2025-11-19T09:45:36.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.666Z] New count: 2
[2025-11-19T09:45:36.666Z] Remaining: 1
[2025-11-19T09:45:36.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.767Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.767Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] Existing timestamps: 2
[2025-11-19T09:45:36.768Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:45:36.768Z] Current count after filter: 1
[2025-11-19T09:45:36.768Z] Max requests allowed: 3
[2025-11-19T09:45:36.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.768Z] New count: 2
[2025-11-19T09:45:36.768Z] Remaining: 1
[2025-11-19T09:45:36.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.769Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.769Z] Identifier: test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] Key: register:test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] üìù Creating new entry for key: register:test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] Current count after filter: 0
[2025-11-19T09:45:36.770Z] Max requests allowed: 3
[2025-11-19T09:45:36.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.770Z] New count: 1
[2025-11-19T09:45:36.770Z] Remaining: 2
[2025-11-19T09:45:36.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.771Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.771Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] üìù Creating new entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Current count after filter: 0
[2025-11-19T09:45:36.771Z] Max requests allowed: 3
[2025-11-19T09:45:36.771Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.771Z] New count: 1
[2025-11-19T09:45:36.771Z] Remaining: 2
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.771Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.771Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Existing timestamps: 1
[2025-11-19T09:45:36.771Z] Current count after filter: 1
[2025-11-19T09:45:36.772Z] Max requests allowed: 3
[2025-11-19T09:45:36.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.772Z] New count: 2
[2025-11-19T09:45:36.772Z] Remaining: 1
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.772Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.772Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] Existing timestamps: 2
[2025-11-19T09:45:36.772Z] Current count after filter: 2
[2025-11-19T09:45:36.772Z] Max requests allowed: 3
[2025-11-19T09:45:36.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.772Z] New count: 3
[2025-11-19T09:45:36.772Z] Remaining: 0
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.772Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.772Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] Existing timestamps: 3
[2025-11-19T09:45:36.773Z] Current count after filter: 3
[2025-11-19T09:45:36.773Z] Max requests allowed: 3
[2025-11-19T09:45:36.773Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.773Z] Current count: 3
[2025-11-19T09:45:36.773Z] Max allowed: 3
[2025-11-19T09:45:36.773Z] Retry after (seconds): 60
[2025-11-19T09:45:36.774Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.242Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.243Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.243Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.243Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.243Z] üìù Creating new entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.243Z] Current count after filter: 0
[2025-11-19T09:53:48.243Z] Max requests allowed: 5
[2025-11-19T09:53:48.243Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.243Z] New count: 1
[2025-11-19T09:53:48.243Z] Remaining: 4
[2025-11-19T09:53:48.243Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.244Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.244Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.244Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.244Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.244Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.244Z] Existing timestamps: 1
[2025-11-19T09:53:48.244Z] Current count after filter: 1
[2025-11-19T09:53:48.244Z] Max requests allowed: 5
[2025-11-19T09:53:48.244Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.244Z] New count: 2
[2025-11-19T09:53:48.244Z] Remaining: 3
[2025-11-19T09:53:48.244Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.245Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.245Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Existing timestamps: 2
[2025-11-19T09:53:48.245Z] Current count after filter: 2
[2025-11-19T09:53:48.245Z] Max requests allowed: 5
[2025-11-19T09:53:48.245Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.245Z] New count: 3
[2025-11-19T09:53:48.245Z] Remaining: 2
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.245Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.245Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Existing timestamps: 3
[2025-11-19T09:53:48.245Z] Current count after filter: 3
[2025-11-19T09:53:48.245Z] Max requests allowed: 5
[2025-11-19T09:53:48.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.246Z] New count: 4
[2025-11-19T09:53:48.246Z] Remaining: 1
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.246Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.246Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.246Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.246Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.246Z] Existing timestamps: 4
[2025-11-19T09:53:48.246Z] Current count after filter: 4
[2025-11-19T09:53:48.246Z] Max requests allowed: 5
[2025-11-19T09:53:48.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.246Z] New count: 5
[2025-11-19T09:53:48.246Z] Remaining: 0
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.247Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.247Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] üìù Creating new entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] Current count after filter: 0
[2025-11-19T09:53:48.247Z] Max requests allowed: 5
[2025-11-19T09:53:48.247Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.247Z] New count: 1
[2025-11-19T09:53:48.247Z] Remaining: 4
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.247Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.247Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] Existing timestamps: 1
[2025-11-19T09:53:48.247Z] Current count after filter: 1
[2025-11-19T09:53:48.247Z] Max requests allowed: 5
[2025-11-19T09:53:48.247Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.247Z] New count: 2
[2025-11-19T09:53:48.247Z] Remaining: 3
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.248Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.248Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] Existing timestamps: 2
[2025-11-19T09:53:48.248Z] Current count after filter: 2
[2025-11-19T09:53:48.248Z] Max requests allowed: 5
[2025-11-19T09:53:48.248Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.248Z] New count: 3
[2025-11-19T09:53:48.248Z] Remaining: 2
[2025-11-19T09:53:48.248Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.248Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.248Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.248Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.248Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] Existing timestamps: 3
[2025-11-19T09:53:48.248Z] Current count after filter: 3
[2025-11-19T09:53:48.248Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.249Z] New count: 4
[2025-11-19T09:53:48.249Z] Remaining: 1
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.249Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.249Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.249Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] Existing timestamps: 4
[2025-11-19T09:53:48.249Z] Current count after filter: 4
[2025-11-19T09:53:48.249Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.249Z] New count: 5
[2025-11-19T09:53:48.249Z] Remaining: 0
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.249Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.249Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.249Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] Existing timestamps: 5
[2025-11-19T09:53:48.249Z] Current count after filter: 5
[2025-11-19T09:53:48.249Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.249Z] Current count: 5
[2025-11-19T09:53:48.249Z] Max allowed: 5
[2025-11-19T09:53:48.249Z] Retry after (seconds): 60
[2025-11-19T09:53:48.250Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.250Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.250Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.250Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.250Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.250Z] üìù Creating new entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.250Z] Current count after filter: 0
[2025-11-19T09:53:48.250Z] Max requests allowed: 2
[2025-11-19T09:53:48.250Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.250Z] New count: 1
[2025-11-19T09:53:48.251Z] Remaining: 1
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.251Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.251Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Existing timestamps: 1
[2025-11-19T09:53:48.251Z] Current count after filter: 1
[2025-11-19T09:53:48.251Z] Max requests allowed: 2
[2025-11-19T09:53:48.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.251Z] New count: 2
[2025-11-19T09:53:48.251Z] Remaining: 0
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.251Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.251Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Existing timestamps: 2
[2025-11-19T09:53:48.251Z] Current count after filter: 2
[2025-11-19T09:53:48.251Z] Max requests allowed: 2
[2025-11-19T09:53:48.251Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.251Z] Current count: 2
[2025-11-19T09:53:48.251Z] Max allowed: 2
[2025-11-19T09:53:48.251Z] Retry after (seconds): 1
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.402Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.403Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.403Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.403Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.403Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.403Z] Existing timestamps: 2
[2025-11-19T09:53:48.403Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:53:48.403Z] Current count after filter: 0
[2025-11-19T09:53:48.403Z] Max requests allowed: 2
[2025-11-19T09:53:48.403Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.403Z] New count: 1
[2025-11-19T09:53:48.403Z] Remaining: 1
[2025-11-19T09:53:48.403Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.404Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.404Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìù Creating new entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Current count after filter: 0
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 1
[2025-11-19T09:53:48.405Z] Remaining: 4
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.405Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Existing timestamps: 1
[2025-11-19T09:53:48.405Z] Current count after filter: 1
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 2
[2025-11-19T09:53:48.405Z] Remaining: 3
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.405Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Existing timestamps: 2
[2025-11-19T09:53:48.405Z] Current count after filter: 2
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 3
[2025-11-19T09:53:48.405Z] Remaining: 2
[2025-11-19T09:53:48.406Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.406Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.406Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.406Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] Existing timestamps: 3
[2025-11-19T09:53:48.406Z] Current count after filter: 3
[2025-11-19T09:53:48.406Z] Max requests allowed: 5
[2025-11-19T09:53:48.406Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.406Z] New count: 4
[2025-11-19T09:53:48.406Z] Remaining: 1
[2025-11-19T09:53:48.410Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.410Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.410Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] Existing timestamps: 4
[2025-11-19T09:53:48.410Z] Current count after filter: 4
[2025-11-19T09:53:48.410Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.411Z] New count: 5
[2025-11-19T09:53:48.411Z] Remaining: 0
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.411Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] Existing timestamps: 5
[2025-11-19T09:53:48.411Z] Current count after filter: 5
[2025-11-19T09:53:48.411Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.411Z] Current count: 5
[2025-11-19T09:53:48.411Z] Max allowed: 5
[2025-11-19T09:53:48.411Z] Retry after (seconds): 60
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.411Z] Identifier: test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] Key: login:test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] üìù Creating new entry for key: login:test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] Current count after filter: 0
[2025-11-19T09:53:48.411Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.411Z] New count: 1
[2025-11-19T09:53:48.411Z] Remaining: 4
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.413Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.417Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.417Z] Identifier: test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] Key: login:test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] üìù Creating new entry for key: login:test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] Current count after filter: 0
[2025-11-19T09:53:48.417Z] Max requests allowed: 5
[2025-11-19T09:53:48.417Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.417Z] New count: 1
[2025-11-19T09:53:48.417Z] Remaining: 4
[2025-11-19T09:53:48.417Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.418Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.419Z] X-Test-ID header: null
[2025-11-19T09:53:48.419Z] Will use test ID?: false
[2025-11-19T09:53:48.419Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.419Z] X-Test-ID header: null
[2025-11-19T09:53:48.419Z] Will use test ID?: false
[2025-11-19T09:53:48.419Z] Using real IP: 192.168.1.2
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.420Z] Will use test ID?: false
[2025-11-19T09:53:48.420Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.420Z] Will use test ID?: false
[2025-11-19T09:53:48.420Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.421Z] Will use test ID?: false
[2025-11-19T09:53:48.421Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.421Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.422Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.422Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] üìù Creating new entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] Current count after filter: 0
[2025-11-19T09:53:48.422Z] Max requests allowed: 3
[2025-11-19T09:53:48.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.423Z] New count: 1
[2025-11-19T09:53:48.423Z] Remaining: 2
[2025-11-19T09:53:48.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.524Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.525Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.525Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] Existing timestamps: 1
[2025-11-19T09:53:48.525Z] Current count after filter: 1
[2025-11-19T09:53:48.525Z] Max requests allowed: 3
[2025-11-19T09:53:48.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.525Z] New count: 2
[2025-11-19T09:53:48.525Z] Remaining: 1
[2025-11-19T09:53:48.525Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.638Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.638Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] Existing timestamps: 2
[2025-11-19T09:53:48.638Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:53:48.638Z] Current count after filter: 1
[2025-11-19T09:53:48.638Z] Max requests allowed: 3
[2025-11-19T09:53:48.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.638Z] New count: 2
[2025-11-19T09:53:48.638Z] Remaining: 1
[2025-11-19T09:53:48.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.639Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.639Z] Identifier: test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] Key: register:test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] üìù Creating new entry for key: register:test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] Current count after filter: 0
[2025-11-19T09:53:48.639Z] Max requests allowed: 3
[2025-11-19T09:53:48.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.639Z] New count: 1
[2025-11-19T09:53:48.639Z] Remaining: 2
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.639Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.639Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] üìù Creating new entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] Current count after filter: 0
[2025-11-19T09:53:48.639Z] Max requests allowed: 3
[2025-11-19T09:53:48.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.639Z] New count: 1
[2025-11-19T09:53:48.640Z] Remaining: 2
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.640Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.640Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Existing timestamps: 1
[2025-11-19T09:53:48.640Z] Current count after filter: 1
[2025-11-19T09:53:48.640Z] Max requests allowed: 3
[2025-11-19T09:53:48.640Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.640Z] New count: 2
[2025-11-19T09:53:48.640Z] Remaining: 1
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.640Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.640Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Existing timestamps: 2
[2025-11-19T09:53:48.640Z] Current count after filter: 2
[2025-11-19T09:53:48.640Z] Max requests allowed: 3
[2025-11-19T09:53:48.640Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.641Z] New count: 3
[2025-11-19T09:53:48.641Z] Remaining: 0
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.641Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.641Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] Existing timestamps: 3
[2025-11-19T09:53:48.641Z] Current count after filter: 3
[2025-11-19T09:53:48.641Z] Max requests allowed: 3
[2025-11-19T09:53:48.641Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.641Z] Current count: 3
[2025-11-19T09:53:48.641Z] Max allowed: 3
[2025-11-19T09:53:48.641Z] Retry after (seconds): 60
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.040Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.041Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.042Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.042Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.042Z] üìù Creating new entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.042Z] Current count after filter: 0
[2025-11-19T11:18:39.042Z] Max requests allowed: 5
[2025-11-19T11:18:39.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.042Z] New count: 1
[2025-11-19T11:18:39.042Z] Remaining: 4
[2025-11-19T11:18:39.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.042Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 1
[2025-11-19T11:18:39.043Z] Current count after filter: 1
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.043Z] New count: 2
[2025-11-19T11:18:39.043Z] Remaining: 3
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.043Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 2
[2025-11-19T11:18:39.043Z] Current count after filter: 2
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.043Z] New count: 3
[2025-11-19T11:18:39.043Z] Remaining: 2
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.043Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 3
[2025-11-19T11:18:39.043Z] Current count after filter: 3
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.044Z] New count: 4
[2025-11-19T11:18:39.044Z] Remaining: 1
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.044Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.044Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.044Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.044Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.044Z] Existing timestamps: 4
[2025-11-19T11:18:39.044Z] Current count after filter: 4
[2025-11-19T11:18:39.044Z] Max requests allowed: 5
[2025-11-19T11:18:39.044Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.044Z] New count: 5
[2025-11-19T11:18:39.044Z] Remaining: 0
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.045Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] üìù Creating new entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] Current count after filter: 0
[2025-11-19T11:18:39.045Z] Max requests allowed: 5
[2025-11-19T11:18:39.045Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.045Z] New count: 1
[2025-11-19T11:18:39.045Z] Remaining: 4
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.045Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] Existing timestamps: 1
[2025-11-19T11:18:39.045Z] Current count after filter: 1
[2025-11-19T11:18:39.045Z] Max requests allowed: 5
[2025-11-19T11:18:39.045Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.045Z] New count: 2
[2025-11-19T11:18:39.045Z] Remaining: 3
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] Existing timestamps: 2
[2025-11-19T11:18:39.046Z] Current count after filter: 2
[2025-11-19T11:18:39.046Z] Max requests allowed: 5
[2025-11-19T11:18:39.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.046Z] New count: 3
[2025-11-19T11:18:39.046Z] Remaining: 2
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.046Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] Existing timestamps: 3
[2025-11-19T11:18:39.046Z] Current count after filter: 3
[2025-11-19T11:18:39.046Z] Max requests allowed: 5
[2025-11-19T11:18:39.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.046Z] New count: 4
[2025-11-19T11:18:39.046Z] Remaining: 1
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.046Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] Existing timestamps: 4
[2025-11-19T11:18:39.047Z] Current count after filter: 4
[2025-11-19T11:18:39.047Z] Max requests allowed: 5
[2025-11-19T11:18:39.047Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.047Z] New count: 5
[2025-11-19T11:18:39.047Z] Remaining: 0
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.047Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.047Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.047Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] Existing timestamps: 5
[2025-11-19T11:18:39.047Z] Current count after filter: 5
[2025-11-19T11:18:39.047Z] Max requests allowed: 5
[2025-11-19T11:18:39.047Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.047Z] Current count: 5
[2025-11-19T11:18:39.047Z] Max allowed: 5
[2025-11-19T11:18:39.047Z] Retry after (seconds): 60
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.048Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.048Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] üìù Creating new entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Current count after filter: 0
[2025-11-19T11:18:39.048Z] Max requests allowed: 2
[2025-11-19T11:18:39.048Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.048Z] New count: 1
[2025-11-19T11:18:39.048Z] Remaining: 1
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.048Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.048Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Existing timestamps: 1
[2025-11-19T11:18:39.048Z] Current count after filter: 1
[2025-11-19T11:18:39.048Z] Max requests allowed: 2
[2025-11-19T11:18:39.048Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.049Z] New count: 2
[2025-11-19T11:18:39.049Z] Remaining: 0
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.049Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.049Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.049Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.049Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.049Z] Existing timestamps: 2
[2025-11-19T11:18:39.049Z] Current count after filter: 2
[2025-11-19T11:18:39.049Z] Max requests allowed: 2
[2025-11-19T11:18:39.049Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.049Z] Current count: 2
[2025-11-19T11:18:39.049Z] Max allowed: 2
[2025-11-19T11:18:39.049Z] Retry after (seconds): 1
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.201Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.202Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.202Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.202Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.202Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.202Z] Existing timestamps: 2
[2025-11-19T11:18:39.202Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T11:18:39.202Z] Current count after filter: 0
[2025-11-19T11:18:39.202Z] Max requests allowed: 2
[2025-11-19T11:18:39.202Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.202Z] New count: 1
[2025-11-19T11:18:39.202Z] Remaining: 1
[2025-11-19T11:18:39.202Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.202Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.202Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.202Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] üìù Creating new entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] Current count after filter: 0
[2025-11-19T11:18:39.202Z] Max requests allowed: 5
[2025-11-19T11:18:39.203Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.203Z] New count: 1
[2025-11-19T11:18:39.203Z] Remaining: 4
[2025-11-19T11:18:39.203Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.203Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.203Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.203Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] Existing timestamps: 1
[2025-11-19T11:18:39.203Z] Current count after filter: 1
[2025-11-19T11:18:39.203Z] Max requests allowed: 5
[2025-11-19T11:18:39.203Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.204Z] New count: 2
[2025-11-19T11:18:39.204Z] Remaining: 3
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.204Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.204Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Existing timestamps: 2
[2025-11-19T11:18:39.204Z] Current count after filter: 2
[2025-11-19T11:18:39.204Z] Max requests allowed: 5
[2025-11-19T11:18:39.204Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.204Z] New count: 3
[2025-11-19T11:18:39.204Z] Remaining: 2
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.204Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.204Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Existing timestamps: 3
[2025-11-19T11:18:39.205Z] Current count after filter: 3
[2025-11-19T11:18:39.205Z] Max requests allowed: 5
[2025-11-19T11:18:39.205Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.205Z] New count: 4
[2025-11-19T11:18:39.205Z] Remaining: 1
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.205Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.205Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Existing timestamps: 4
[2025-11-19T11:18:39.205Z] Current count after filter: 4
[2025-11-19T11:18:39.205Z] Max requests allowed: 5
[2025-11-19T11:18:39.205Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.205Z] New count: 5
[2025-11-19T11:18:39.205Z] Remaining: 0
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.205Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.206Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] Existing timestamps: 5
[2025-11-19T11:18:39.206Z] Current count after filter: 5
[2025-11-19T11:18:39.206Z] Max requests allowed: 5
[2025-11-19T11:18:39.206Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.206Z] Current count: 5
[2025-11-19T11:18:39.206Z] Max allowed: 5
[2025-11-19T11:18:39.206Z] Retry after (seconds): 60
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.206Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.206Z] Identifier: test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] Key: login:test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] üìù Creating new entry for key: login:test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] Current count after filter: 0
[2025-11-19T11:18:39.206Z] Max requests allowed: 5
[2025-11-19T11:18:39.206Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.206Z] New count: 1
[2025-11-19T11:18:39.206Z] Remaining: 4
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.207Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.210Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.211Z] Identifier: test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] Key: login:test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] üìù Creating new entry for key: login:test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] Current count after filter: 0
[2025-11-19T11:18:39.211Z] Max requests allowed: 5
[2025-11-19T11:18:39.211Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.211Z] New count: 1
[2025-11-19T11:18:39.211Z] Remaining: 4
[2025-11-19T11:18:39.211Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.220Z] X-Test-ID header: null
[2025-11-19T11:18:39.220Z] Will use test ID?: false
[2025-11-19T11:18:39.220Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.220Z] X-Test-ID header: null
[2025-11-19T11:18:39.220Z] Will use test ID?: false
[2025-11-19T11:18:39.220Z] Using real IP: 192.168.1.2
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.221Z] X-Test-ID header: null
[2025-11-19T11:18:39.221Z] Will use test ID?: false
[2025-11-19T11:18:39.221Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.222Z] X-Test-ID header: null
[2025-11-19T11:18:39.222Z] Will use test ID?: false
[2025-11-19T11:18:39.222Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T11:18:39.222Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.223Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.223Z] X-Test-ID header: null
[2025-11-19T11:18:39.223Z] Will use test ID?: false
[2025-11-19T11:18:39.223Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.223Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.224Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.224Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] üìù Creating new entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] Current count after filter: 0
[2025-11-19T11:18:39.224Z] Max requests allowed: 3
[2025-11-19T11:18:39.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.224Z] New count: 1
[2025-11-19T11:18:39.224Z] Remaining: 2
[2025-11-19T11:18:39.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.327Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.327Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.331Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.331Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.331Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.335Z] Existing timestamps: 1
[2025-11-19T11:18:39.336Z] Current count after filter: 1
[2025-11-19T11:18:39.336Z] Max requests allowed: 3
[2025-11-19T11:18:39.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.336Z] New count: 2
[2025-11-19T11:18:39.336Z] Remaining: 1
[2025-11-19T11:18:39.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.438Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.438Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.439Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] Existing timestamps: 2
[2025-11-19T11:18:39.439Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T11:18:39.439Z] Current count after filter: 1
[2025-11-19T11:18:39.439Z] Max requests allowed: 3
[2025-11-19T11:18:39.439Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.439Z] New count: 2
[2025-11-19T11:18:39.439Z] Remaining: 1
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.439Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.439Z] Identifier: test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] Key: register:test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] üìù Creating new entry for key: register:test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] Current count after filter: 0
[2025-11-19T11:18:39.439Z] Max requests allowed: 3
[2025-11-19T11:18:39.439Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.439Z] New count: 1
[2025-11-19T11:18:39.439Z] Remaining: 2
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.440Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] üìù Creating new entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Current count after filter: 0
[2025-11-19T11:18:39.440Z] Max requests allowed: 3
[2025-11-19T11:18:39.440Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.440Z] New count: 1
[2025-11-19T11:18:39.440Z] Remaining: 2
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.440Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Existing timestamps: 1
[2025-11-19T11:18:39.440Z] Current count after filter: 1
[2025-11-19T11:18:39.440Z] Max requests allowed: 3
[2025-11-19T11:18:39.440Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.440Z] New count: 2
[2025-11-19T11:18:39.440Z] Remaining: 1
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.441Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Existing timestamps: 2
[2025-11-19T11:18:39.441Z] Current count after filter: 2
[2025-11-19T11:18:39.441Z] Max requests allowed: 3
[2025-11-19T11:18:39.441Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.441Z] New count: 3
[2025-11-19T11:18:39.441Z] Remaining: 0
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.441Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.441Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Existing timestamps: 3
[2025-11-19T11:18:39.441Z] Current count after filter: 3
[2025-11-19T11:18:39.441Z] Max requests allowed: 3
[2025-11-19T11:18:39.441Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.441Z] Current count: 3
[2025-11-19T11:18:39.441Z] Max allowed: 3
[2025-11-19T11:18:39.441Z] Retry after (seconds): 60
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.779Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.781Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.781Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.781Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] üìù Creating new entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Current count after filter: 0
[2025-11-19T15:14:34.782Z] Max requests allowed: 5
[2025-11-19T15:14:34.782Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.782Z] New count: 1
[2025-11-19T15:14:34.782Z] Remaining: 4
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.782Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.782Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Existing timestamps: 1
[2025-11-19T15:14:34.782Z] Current count after filter: 1
[2025-11-19T15:14:34.782Z] Max requests allowed: 5
[2025-11-19T15:14:34.782Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.782Z] New count: 2
[2025-11-19T15:14:34.782Z] Remaining: 3
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.783Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.783Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.783Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.783Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.783Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.783Z] Existing timestamps: 2
[2025-11-19T15:14:34.783Z] Current count after filter: 2
[2025-11-19T15:14:34.783Z] Max requests allowed: 5
[2025-11-19T15:14:34.783Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.783Z] New count: 3
[2025-11-19T15:14:34.783Z] Remaining: 2
[2025-11-19T15:14:34.783Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.784Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.784Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.784Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.784Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.784Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.784Z] Existing timestamps: 3
[2025-11-19T15:14:34.784Z] Current count after filter: 3
[2025-11-19T15:14:34.784Z] Max requests allowed: 5
[2025-11-19T15:14:34.784Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.784Z] New count: 4
[2025-11-19T15:14:34.784Z] Remaining: 1
[2025-11-19T15:14:34.784Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.785Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.785Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.785Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.785Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.785Z] Existing timestamps: 4
[2025-11-19T15:14:34.785Z] Current count after filter: 4
[2025-11-19T15:14:34.785Z] Max requests allowed: 5
[2025-11-19T15:14:34.785Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.785Z] New count: 5
[2025-11-19T15:14:34.785Z] Remaining: 0
[2025-11-19T15:14:34.785Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.786Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.786Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] üìù Creating new entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] Current count after filter: 0
[2025-11-19T15:14:34.786Z] Max requests allowed: 5
[2025-11-19T15:14:34.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.786Z] New count: 1
[2025-11-19T15:14:34.786Z] Remaining: 4
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.786Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.786Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] Existing timestamps: 1
[2025-11-19T15:14:34.786Z] Current count after filter: 1
[2025-11-19T15:14:34.786Z] Max requests allowed: 5
[2025-11-19T15:14:34.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.786Z] New count: 2
[2025-11-19T15:14:34.786Z] Remaining: 3
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.787Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.787Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] Existing timestamps: 2
[2025-11-19T15:14:34.787Z] Current count after filter: 2
[2025-11-19T15:14:34.787Z] Max requests allowed: 5
[2025-11-19T15:14:34.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.787Z] New count: 3
[2025-11-19T15:14:34.787Z] Remaining: 2
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.787Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.787Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] Existing timestamps: 3
[2025-11-19T15:14:34.787Z] Current count after filter: 3
[2025-11-19T15:14:34.787Z] Max requests allowed: 5
[2025-11-19T15:14:34.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.788Z] New count: 4
[2025-11-19T15:14:34.788Z] Remaining: 1
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.788Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.788Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.788Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.788Z] Existing timestamps: 4
[2025-11-19T15:14:34.788Z] Current count after filter: 4
[2025-11-19T15:14:34.788Z] Max requests allowed: 5
[2025-11-19T15:14:34.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.788Z] New count: 5
[2025-11-19T15:14:34.788Z] Remaining: 0
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.789Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.789Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.789Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.789Z] Existing timestamps: 5
[2025-11-19T15:14:34.789Z] Current count after filter: 5
[2025-11-19T15:14:34.789Z] Max requests allowed: 5
[2025-11-19T15:14:34.789Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.789Z] Current count: 5
[2025-11-19T15:14:34.789Z] Max allowed: 5
[2025-11-19T15:14:34.789Z] Retry after (seconds): 60
[2025-11-19T15:14:34.789Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.789Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.789Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.789Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.789Z] üìù Creating new entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.789Z] Current count after filter: 0
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.790Z] New count: 1
[2025-11-19T15:14:34.790Z] Remaining: 1
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.790Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Existing timestamps: 1
[2025-11-19T15:14:34.790Z] Current count after filter: 1
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.790Z] New count: 2
[2025-11-19T15:14:34.790Z] Remaining: 0
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.790Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Existing timestamps: 2
[2025-11-19T15:14:34.790Z] Current count after filter: 2
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.790Z] Current count: 2
[2025-11-19T15:14:34.790Z] Max allowed: 2
[2025-11-19T15:14:34.790Z] Retry after (seconds): 1
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.943Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.943Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.943Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.943Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.943Z] Existing timestamps: 2
[2025-11-19T15:14:34.943Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T15:14:34.943Z] Current count after filter: 0
[2025-11-19T15:14:34.943Z] Max requests allowed: 2
[2025-11-19T15:14:34.944Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.944Z] New count: 1
[2025-11-19T15:14:34.944Z] Remaining: 1
[2025-11-19T15:14:34.944Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.944Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìù Creating new entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Current count after filter: 0
[2025-11-19T15:14:34.945Z] Max requests allowed: 5
[2025-11-19T15:14:34.945Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.945Z] New count: 1
[2025-11-19T15:14:34.945Z] Remaining: 4
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Existing timestamps: 1
[2025-11-19T15:14:34.945Z] Current count after filter: 1
[2025-11-19T15:14:34.945Z] Max requests allowed: 5
[2025-11-19T15:14:34.945Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.945Z] New count: 2
[2025-11-19T15:14:34.945Z] Remaining: 3
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Existing timestamps: 2
[2025-11-19T15:14:34.945Z] Current count after filter: 2
[2025-11-19T15:14:34.946Z] Max requests allowed: 5
[2025-11-19T15:14:34.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.946Z] New count: 3
[2025-11-19T15:14:34.946Z] Remaining: 2
[2025-11-19T15:14:34.946Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.946Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.946Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] Existing timestamps: 3
[2025-11-19T15:14:34.946Z] Current count after filter: 3
[2025-11-19T15:14:34.946Z] Max requests allowed: 5
[2025-11-19T15:14:34.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.947Z] New count: 4
[2025-11-19T15:14:34.947Z] Remaining: 1
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.947Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] Existing timestamps: 4
[2025-11-19T15:14:34.947Z] Current count after filter: 4
[2025-11-19T15:14:34.947Z] Max requests allowed: 5
[2025-11-19T15:14:34.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.947Z] New count: 5
[2025-11-19T15:14:34.947Z] Remaining: 0
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.948Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] Existing timestamps: 5
[2025-11-19T15:14:34.948Z] Current count after filter: 5
[2025-11-19T15:14:34.948Z] Max requests allowed: 5
[2025-11-19T15:14:34.948Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.948Z] Current count: 5
[2025-11-19T15:14:34.948Z] Max allowed: 5
[2025-11-19T15:14:34.948Z] Retry after (seconds): 60
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.948Z] Identifier: test-multi-2-1763565274944
[2025-11-19T15:14:34.948Z] Key: login:test-multi-2-1763565274944
[2025-11-19T15:14:34.948Z] üìù Creating new entry for key: login:test-multi-2-1763565274944
[2025-11-19T15:14:34.949Z] Current count after filter: 0
[2025-11-19T15:14:34.949Z] Max requests allowed: 5
[2025-11-19T15:14:34.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.949Z] New count: 1
[2025-11-19T15:14:34.949Z] Remaining: 4
[2025-11-19T15:14:34.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.949Z] Identifier: test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] Key: login:test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] üìù Creating new entry for key: login:test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] Current count after filter: 0
[2025-11-19T15:14:34.949Z] Max requests allowed: 5
[2025-11-19T15:14:34.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.950Z] New count: 1
[2025-11-19T15:14:34.950Z] Remaining: 4
[2025-11-19T15:14:34.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.952Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.952Z] X-Test-ID header: null
[2025-11-19T15:14:34.952Z] Will use test ID?: false
[2025-11-19T15:14:34.952Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.952Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.954Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.955Z] X-Test-ID header: null
[2025-11-19T15:14:34.955Z] Will use test ID?: false
[2025-11-19T15:14:34.955Z] Using real IP: 192.168.1.2
[2025-11-19T15:14:34.955Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.955Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.955Z] X-Test-ID header: null
[2025-11-19T15:14:34.955Z] Will use test ID?: false
[2025-11-19T15:14:34.956Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.956Z] X-Test-ID header: null
[2025-11-19T15:14:34.956Z] Will use test ID?: false
[2025-11-19T15:14:34.956Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.958Z] X-Test-ID header: null
[2025-11-19T15:14:34.959Z] Will use test ID?: false
[2025-11-19T15:14:34.959Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.959Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.961Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:34.961Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:34.961Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:34.961Z] üìù Creating new entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:34.962Z] Current count after filter: 0
[2025-11-19T15:14:34.962Z] Max requests allowed: 3
[2025-11-19T15:14:34.962Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.962Z] New count: 1
[2025-11-19T15:14:34.962Z] Remaining: 2
[2025-11-19T15:14:34.962Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.064Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.064Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:35.064Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] Existing timestamps: 1
[2025-11-19T15:14:35.064Z] Current count after filter: 1
[2025-11-19T15:14:35.064Z] Max requests allowed: 3
[2025-11-19T15:14:35.064Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.064Z] New count: 2
[2025-11-19T15:14:35.065Z] Remaining: 1
[2025-11-19T15:14:35.065Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.165Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.166Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:35.166Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] Existing timestamps: 2
[2025-11-19T15:14:35.166Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T15:14:35.166Z] Current count after filter: 1
[2025-11-19T15:14:35.166Z] Max requests allowed: 3
[2025-11-19T15:14:35.166Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.166Z] New count: 2
[2025-11-19T15:14:35.166Z] Remaining: 1
[2025-11-19T15:14:35.166Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.166Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.166Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.166Z] Identifier: test-format-allowed-1763565275166
[2025-11-19T15:14:35.166Z] Key: register:test-format-allowed-1763565275166
[2025-11-19T15:14:35.166Z] üìù Creating new entry for key: register:test-format-allowed-1763565275166
[2025-11-19T15:14:35.167Z] Current count after filter: 0
[2025-11-19T15:14:35.167Z] Max requests allowed: 3
[2025-11-19T15:14:35.167Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.167Z] New count: 1
[2025-11-19T15:14:35.167Z] Remaining: 2
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.167Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.167Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] üìù Creating new entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] Current count after filter: 0
[2025-11-19T15:14:35.167Z] Max requests allowed: 3
[2025-11-19T15:14:35.167Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.167Z] New count: 1
[2025-11-19T15:14:35.167Z] Remaining: 2
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.167Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Existing timestamps: 1
[2025-11-19T15:14:35.168Z] Current count after filter: 1
[2025-11-19T15:14:35.168Z] Max requests allowed: 3
[2025-11-19T15:14:35.168Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.168Z] New count: 2
[2025-11-19T15:14:35.168Z] Remaining: 1
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.168Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Existing timestamps: 2
[2025-11-19T15:14:35.168Z] Current count after filter: 2
[2025-11-19T15:14:35.168Z] Max requests allowed: 3
[2025-11-19T15:14:35.168Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.168Z] New count: 3
[2025-11-19T15:14:35.168Z] Remaining: 0
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.168Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.169Z] Existing timestamps: 3
[2025-11-19T15:14:35.169Z] Current count after filter: 3
[2025-11-19T15:14:35.169Z] Max requests allowed: 3
[2025-11-19T15:14:35.169Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:35.169Z] Current count: 3
[2025-11-19T15:14:35.169Z] Max allowed: 3
[2025-11-19T15:14:35.169Z] Retry after (seconds): 60
[2025-11-19T15:14:35.169Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.565Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.566Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.566Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.566Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.566Z] üìù Creating new entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.566Z] Current count after filter: 0
[2025-11-19T15:14:39.566Z] Max requests allowed: 5
[2025-11-19T15:14:39.566Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.566Z] New count: 1
[2025-11-19T15:14:39.566Z] Remaining: 4
[2025-11-19T15:14:39.567Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.567Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.567Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.567Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.567Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.567Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.567Z] Existing timestamps: 1
[2025-11-19T15:14:39.567Z] Current count after filter: 1
[2025-11-19T15:14:39.567Z] Max requests allowed: 5
[2025-11-19T15:14:39.567Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.567Z] New count: 2
[2025-11-19T15:14:39.567Z] Remaining: 3
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.568Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.568Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Existing timestamps: 2
[2025-11-19T15:14:39.568Z] Current count after filter: 2
[2025-11-19T15:14:39.568Z] Max requests allowed: 5
[2025-11-19T15:14:39.568Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.568Z] New count: 3
[2025-11-19T15:14:39.568Z] Remaining: 2
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.568Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.568Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Existing timestamps: 3
[2025-11-19T15:14:39.568Z] Current count after filter: 3
[2025-11-19T15:14:39.568Z] Max requests allowed: 5
[2025-11-19T15:14:39.568Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.568Z] New count: 4
[2025-11-19T15:14:39.569Z] Remaining: 1
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.569Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.569Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.569Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.569Z] Existing timestamps: 4
[2025-11-19T15:14:39.569Z] Current count after filter: 4
[2025-11-19T15:14:39.569Z] Max requests allowed: 5
[2025-11-19T15:14:39.569Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.569Z] New count: 5
[2025-11-19T15:14:39.569Z] Remaining: 0
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.570Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.570Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.570Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] üìù Creating new entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] Current count after filter: 0
[2025-11-19T15:14:39.570Z] Max requests allowed: 5
[2025-11-19T15:14:39.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.570Z] New count: 1
[2025-11-19T15:14:39.570Z] Remaining: 4
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.570Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.570Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.570Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] Existing timestamps: 1
[2025-11-19T15:14:39.570Z] Current count after filter: 1
[2025-11-19T15:14:39.570Z] Max requests allowed: 5
[2025-11-19T15:14:39.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.570Z] New count: 2
[2025-11-19T15:14:39.570Z] Remaining: 3
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 2
[2025-11-19T15:14:39.571Z] Current count after filter: 2
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 3
[2025-11-19T15:14:39.571Z] Remaining: 2
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 3
[2025-11-19T15:14:39.571Z] Current count after filter: 3
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 4
[2025-11-19T15:14:39.571Z] Remaining: 1
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 4
[2025-11-19T15:14:39.571Z] Current count after filter: 4
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 5
[2025-11-19T15:14:39.571Z] Remaining: 0
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.572Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.572Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.572Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.572Z] Existing timestamps: 5
[2025-11-19T15:14:39.572Z] Current count after filter: 5
[2025-11-19T15:14:39.572Z] Max requests allowed: 5
[2025-11-19T15:14:39.572Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.572Z] Current count: 5
[2025-11-19T15:14:39.572Z] Max allowed: 5
[2025-11-19T15:14:39.572Z] Retry after (seconds): 60
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.572Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.572Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.572Z] üìù Creating new entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Current count after filter: 0
[2025-11-19T15:14:39.572Z] Max requests allowed: 2
[2025-11-19T15:14:39.572Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.572Z] New count: 1
[2025-11-19T15:14:39.572Z] Remaining: 1
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.572Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.572Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Existing timestamps: 1
[2025-11-19T15:14:39.573Z] Current count after filter: 1
[2025-11-19T15:14:39.573Z] Max requests allowed: 2
[2025-11-19T15:14:39.573Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.573Z] New count: 2
[2025-11-19T15:14:39.573Z] Remaining: 0
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.573Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.573Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Existing timestamps: 2
[2025-11-19T15:14:39.573Z] Current count after filter: 2
[2025-11-19T15:14:39.573Z] Max requests allowed: 2
[2025-11-19T15:14:39.573Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.573Z] Current count: 2
[2025-11-19T15:14:39.573Z] Max allowed: 2
[2025-11-19T15:14:39.573Z] Retry after (seconds): 1
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.724Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.725Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.726Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.726Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.727Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.727Z] Existing timestamps: 2
[2025-11-19T15:14:39.727Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T15:14:39.727Z] Current count after filter: 0
[2025-11-19T15:14:39.728Z] Max requests allowed: 2
[2025-11-19T15:14:39.728Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.728Z] New count: 1
[2025-11-19T15:14:39.728Z] Remaining: 1
[2025-11-19T15:14:39.728Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìù Creating new entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Current count after filter: 0
[2025-11-19T15:14:39.729Z] Max requests allowed: 5
[2025-11-19T15:14:39.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.729Z] New count: 1
[2025-11-19T15:14:39.729Z] Remaining: 4
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Existing timestamps: 1
[2025-11-19T15:14:39.729Z] Current count after filter: 1
[2025-11-19T15:14:39.729Z] Max requests allowed: 5
[2025-11-19T15:14:39.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.729Z] New count: 2
[2025-11-19T15:14:39.729Z] Remaining: 3
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Existing timestamps: 2
[2025-11-19T15:14:39.730Z] Current count after filter: 2
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 3
[2025-11-19T15:14:39.730Z] Remaining: 2
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Existing timestamps: 3
[2025-11-19T15:14:39.730Z] Current count after filter: 3
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 4
[2025-11-19T15:14:39.730Z] Remaining: 1
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Existing timestamps: 4
[2025-11-19T15:14:39.730Z] Current count after filter: 4
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 5
[2025-11-19T15:14:39.730Z] Remaining: 0
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.731Z] Existing timestamps: 5
[2025-11-19T15:14:39.731Z] Current count after filter: 5
[2025-11-19T15:14:39.731Z] Max requests allowed: 5
[2025-11-19T15:14:39.731Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.731Z] Current count: 5
[2025-11-19T15:14:39.731Z] Max allowed: 5
[2025-11-19T15:14:39.731Z] Retry after (seconds): 60
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.731Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.731Z] Identifier: test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] Key: login:test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] üìù Creating new entry for key: login:test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] Current count after filter: 0
[2025-11-19T15:14:39.731Z] Max requests allowed: 5
[2025-11-19T15:14:39.731Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.731Z] New count: 1
[2025-11-19T15:14:39.731Z] Remaining: 4
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.732Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.732Z] Identifier: test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] Key: login:test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] üìù Creating new entry for key: login:test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] Current count after filter: 0
[2025-11-19T15:14:39.732Z] Max requests allowed: 5
[2025-11-19T15:14:39.732Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.732Z] New count: 1
[2025-11-19T15:14:39.732Z] Remaining: 4
[2025-11-19T15:14:39.732Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.733Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.733Z] X-Test-ID header: null
[2025-11-19T15:14:39.733Z] Will use test ID?: false
[2025-11-19T15:14:39.734Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.734Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.734Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.735Z] X-Test-ID header: null
[2025-11-19T15:14:39.735Z] Will use test ID?: false
[2025-11-19T15:14:39.735Z] Using real IP: 192.168.1.2
[2025-11-19T15:14:39.735Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.736Z] X-Test-ID header: null
[2025-11-19T15:14:39.736Z] Will use test ID?: false
[2025-11-19T15:14:39.736Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.736Z] X-Test-ID header: null
[2025-11-19T15:14:39.736Z] Will use test ID?: false
[2025-11-19T15:14:39.737Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.737Z] X-Test-ID header: null
[2025-11-19T15:14:39.737Z] Will use test ID?: false
[2025-11-19T15:14:39.737Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.737Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.737Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.737Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] üìù Creating new entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] Current count after filter: 0
[2025-11-19T15:14:39.737Z] Max requests allowed: 3
[2025-11-19T15:14:39.737Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.737Z] New count: 1
[2025-11-19T15:14:39.737Z] Remaining: 2
[2025-11-19T15:14:39.737Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.839Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.839Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.839Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] Existing timestamps: 1
[2025-11-19T15:14:39.840Z] Current count after filter: 1
[2025-11-19T15:14:39.840Z] Max requests allowed: 3
[2025-11-19T15:14:39.840Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.840Z] New count: 2
[2025-11-19T15:14:39.840Z] Remaining: 1
[2025-11-19T15:14:39.840Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.941Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.941Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] Existing timestamps: 2
[2025-11-19T15:14:39.941Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T15:14:39.941Z] Current count after filter: 1
[2025-11-19T15:14:39.941Z] Max requests allowed: 3
[2025-11-19T15:14:39.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.941Z] New count: 2
[2025-11-19T15:14:39.941Z] Remaining: 1
[2025-11-19T15:14:39.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.942Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.942Z] Identifier: test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] Key: register:test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] üìù Creating new entry for key: register:test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] Current count after filter: 0
[2025-11-19T15:14:39.942Z] Max requests allowed: 3
[2025-11-19T15:14:39.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.942Z] New count: 1
[2025-11-19T15:14:39.942Z] Remaining: 2
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.943Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.943Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] üìù Creating new entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Current count after filter: 0
[2025-11-19T15:14:39.943Z] Max requests allowed: 3
[2025-11-19T15:14:39.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.943Z] New count: 1
[2025-11-19T15:14:39.943Z] Remaining: 2
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.943Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.943Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Existing timestamps: 1
[2025-11-19T15:14:39.943Z] Current count after filter: 1
[2025-11-19T15:14:39.943Z] Max requests allowed: 3
[2025-11-19T15:14:39.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.943Z] New count: 2
[2025-11-19T15:14:39.943Z] Remaining: 1
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.944Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.944Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Existing timestamps: 2
[2025-11-19T15:14:39.944Z] Current count after filter: 2
[2025-11-19T15:14:39.944Z] Max requests allowed: 3
[2025-11-19T15:14:39.944Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.944Z] New count: 3
[2025-11-19T15:14:39.944Z] Remaining: 0
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.944Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.944Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Existing timestamps: 3
[2025-11-19T15:14:39.944Z] Current count after filter: 3
[2025-11-19T15:14:39.944Z] Max requests allowed: 3
[2025-11-19T15:14:39.944Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.944Z] Current count: 3
[2025-11-19T15:14:39.944Z] Max allowed: 3
[2025-11-19T15:14:39.944Z] Retry after (seconds): 60
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.482Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.483Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.484Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.484Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.484Z] üìù Creating new entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.484Z] Current count after filter: 0
[2025-11-20T00:07:00.484Z] Max requests allowed: 5
[2025-11-20T00:07:00.484Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.485Z] New count: 1
[2025-11-20T00:07:00.485Z] Remaining: 4
[2025-11-20T00:07:00.485Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.485Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.486Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.486Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.486Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.486Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.486Z] Existing timestamps: 1
[2025-11-20T00:07:00.486Z] Current count after filter: 1
[2025-11-20T00:07:00.487Z] Max requests allowed: 5
[2025-11-20T00:07:00.487Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.487Z] New count: 2
[2025-11-20T00:07:00.487Z] Remaining: 3
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.487Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.487Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Existing timestamps: 2
[2025-11-20T00:07:00.487Z] Current count after filter: 2
[2025-11-20T00:07:00.487Z] Max requests allowed: 5
[2025-11-20T00:07:00.487Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.487Z] New count: 3
[2025-11-20T00:07:00.487Z] Remaining: 2
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.487Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.487Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Existing timestamps: 3
[2025-11-20T00:07:00.487Z] Current count after filter: 3
[2025-11-20T00:07:00.488Z] Max requests allowed: 5
[2025-11-20T00:07:00.488Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.488Z] New count: 4
[2025-11-20T00:07:00.488Z] Remaining: 1
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.488Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.488Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.488Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.488Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.488Z] Existing timestamps: 4
[2025-11-20T00:07:00.488Z] Current count after filter: 4
[2025-11-20T00:07:00.488Z] Max requests allowed: 5
[2025-11-20T00:07:00.488Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.488Z] New count: 5
[2025-11-20T00:07:00.488Z] Remaining: 0
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.489Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.489Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.489Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] üìù Creating new entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] Current count after filter: 0
[2025-11-20T00:07:00.489Z] Max requests allowed: 5
[2025-11-20T00:07:00.489Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.489Z] New count: 1
[2025-11-20T00:07:00.489Z] Remaining: 4
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.489Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.489Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.489Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] Existing timestamps: 1
[2025-11-20T00:07:00.489Z] Current count after filter: 1
[2025-11-20T00:07:00.489Z] Max requests allowed: 5
[2025-11-20T00:07:00.489Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.489Z] New count: 2
[2025-11-20T00:07:00.489Z] Remaining: 3
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.490Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.490Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.490Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] Existing timestamps: 2
[2025-11-20T00:07:00.490Z] Current count after filter: 2
[2025-11-20T00:07:00.490Z] Max requests allowed: 5
[2025-11-20T00:07:00.490Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.490Z] New count: 3
[2025-11-20T00:07:00.490Z] Remaining: 2
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.490Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.490Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.490Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] Existing timestamps: 3
[2025-11-20T00:07:00.490Z] Current count after filter: 3
[2025-11-20T00:07:00.490Z] Max requests allowed: 5
[2025-11-20T00:07:00.490Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.490Z] New count: 4
[2025-11-20T00:07:00.491Z] Remaining: 1
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.491Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.491Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.491Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] Existing timestamps: 4
[2025-11-20T00:07:00.491Z] Current count after filter: 4
[2025-11-20T00:07:00.491Z] Max requests allowed: 5
[2025-11-20T00:07:00.491Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.491Z] New count: 5
[2025-11-20T00:07:00.491Z] Remaining: 0
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.491Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.491Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.491Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] Existing timestamps: 5
[2025-11-20T00:07:00.491Z] Current count after filter: 5
[2025-11-20T00:07:00.491Z] Max requests allowed: 5
[2025-11-20T00:07:00.491Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.491Z] Current count: 5
[2025-11-20T00:07:00.492Z] Max allowed: 5
[2025-11-20T00:07:00.492Z] Retry after (seconds): 60
[2025-11-20T00:07:00.492Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.492Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìù Creating new entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Current count after filter: 0
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.493Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.493Z] New count: 1
[2025-11-20T00:07:00.493Z] Remaining: 1
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Existing timestamps: 1
[2025-11-20T00:07:00.493Z] Current count after filter: 1
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.493Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.493Z] New count: 2
[2025-11-20T00:07:00.493Z] Remaining: 0
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Existing timestamps: 2
[2025-11-20T00:07:00.493Z] Current count after filter: 2
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.494Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.494Z] Current count: 2
[2025-11-20T00:07:00.494Z] Max allowed: 2
[2025-11-20T00:07:00.494Z] Retry after (seconds): 1
[2025-11-20T00:07:00.494Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.645Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.646Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.646Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.646Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.646Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.652Z] Existing timestamps: 2
[2025-11-20T00:07:00.652Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T00:07:00.652Z] Current count after filter: 0
[2025-11-20T00:07:00.653Z] Max requests allowed: 2
[2025-11-20T00:07:00.653Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.653Z] New count: 1
[2025-11-20T00:07:00.653Z] Remaining: 1
[2025-11-20T00:07:00.653Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.654Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.654Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.654Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] üìù Creating new entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] Current count after filter: 0
[2025-11-20T00:07:00.654Z] Max requests allowed: 5
[2025-11-20T00:07:00.654Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.654Z] New count: 1
[2025-11-20T00:07:00.654Z] Remaining: 4
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.655Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.655Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] Existing timestamps: 1
[2025-11-20T00:07:00.655Z] Current count after filter: 1
[2025-11-20T00:07:00.655Z] Max requests allowed: 5
[2025-11-20T00:07:00.655Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.655Z] New count: 2
[2025-11-20T00:07:00.655Z] Remaining: 3
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.655Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.656Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] Existing timestamps: 2
[2025-11-20T00:07:00.656Z] Current count after filter: 2
[2025-11-20T00:07:00.656Z] Max requests allowed: 5
[2025-11-20T00:07:00.656Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.656Z] New count: 3
[2025-11-20T00:07:00.656Z] Remaining: 2
[2025-11-20T00:07:00.656Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.656Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.660Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] Existing timestamps: 3
[2025-11-20T00:07:00.666Z] Current count after filter: 3
[2025-11-20T00:07:00.666Z] Max requests allowed: 5
[2025-11-20T00:07:00.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.666Z] New count: 4
[2025-11-20T00:07:00.666Z] Remaining: 1
[2025-11-20T00:07:00.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.666Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.666Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.666Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.666Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.667Z] Existing timestamps: 4
[2025-11-20T00:07:00.669Z] Current count after filter: 4
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.670Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.670Z] New count: 5
[2025-11-20T00:07:00.670Z] Remaining: 0
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.670Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.670Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] Existing timestamps: 5
[2025-11-20T00:07:00.670Z] Current count after filter: 5
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.670Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.670Z] Current count: 5
[2025-11-20T00:07:00.670Z] Max allowed: 5
[2025-11-20T00:07:00.670Z] Retry after (seconds): 60
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.670Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.670Z] Identifier: test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] Key: login:test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] üìù Creating new entry for key: login:test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] Current count after filter: 0
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.676Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.676Z] New count: 1
[2025-11-20T00:07:00.676Z] Remaining: 4
[2025-11-20T00:07:00.676Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.677Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.681Z] Identifier: test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] Key: login:test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] üìù Creating new entry for key: login:test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] Current count after filter: 0
[2025-11-20T00:07:00.681Z] Max requests allowed: 5
[2025-11-20T00:07:00.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.686Z] New count: 1
[2025-11-20T00:07:00.687Z] Remaining: 4
[2025-11-20T00:07:00.687Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.689Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.692Z] X-Test-ID header: null
[2025-11-20T00:07:00.692Z] Will use test ID?: false
[2025-11-20T00:07:00.692Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.692Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.693Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.693Z] X-Test-ID header: null
[2025-11-20T00:07:00.693Z] Will use test ID?: false
[2025-11-20T00:07:00.693Z] Using real IP: 192.168.1.2
[2025-11-20T00:07:00.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.694Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.694Z] X-Test-ID header: null
[2025-11-20T00:07:00.694Z] Will use test ID?: false
[2025-11-20T00:07:00.694Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.694Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.700Z] X-Test-ID header: null
[2025-11-20T00:07:00.700Z] Will use test ID?: false
[2025-11-20T00:07:00.700Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.700Z] X-Test-ID header: null
[2025-11-20T00:07:00.700Z] Will use test ID?: false
[2025-11-20T00:07:00.700Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.701Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.701Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] üìù Creating new entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] Current count after filter: 0
[2025-11-20T00:07:00.701Z] Max requests allowed: 3
[2025-11-20T00:07:00.706Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.707Z] New count: 1
[2025-11-20T00:07:00.707Z] Remaining: 2
[2025-11-20T00:07:00.707Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.836Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.836Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.837Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] Existing timestamps: 1
[2025-11-20T00:07:00.837Z] Current count after filter: 1
[2025-11-20T00:07:00.837Z] Max requests allowed: 3
[2025-11-20T00:07:00.837Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.837Z] New count: 2
[2025-11-20T00:07:00.837Z] Remaining: 1
[2025-11-20T00:07:00.837Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.938Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.939Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.939Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] Existing timestamps: 2
[2025-11-20T00:07:00.939Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-20T00:07:00.939Z] Current count after filter: 1
[2025-11-20T00:07:00.939Z] Max requests allowed: 3
[2025-11-20T00:07:00.939Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.939Z] New count: 2
[2025-11-20T00:07:00.939Z] Remaining: 1
[2025-11-20T00:07:00.939Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.940Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.940Z] Identifier: test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] Key: register:test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] üìù Creating new entry for key: register:test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] Current count after filter: 0
[2025-11-20T00:07:00.940Z] Max requests allowed: 3
[2025-11-20T00:07:00.940Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.940Z] New count: 1
[2025-11-20T00:07:00.940Z] Remaining: 2
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.940Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.941Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] üìù Creating new entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Current count after filter: 0
[2025-11-20T00:07:00.941Z] Max requests allowed: 3
[2025-11-20T00:07:00.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.941Z] New count: 1
[2025-11-20T00:07:00.941Z] Remaining: 2
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.941Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.941Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Existing timestamps: 1
[2025-11-20T00:07:00.941Z] Current count after filter: 1
[2025-11-20T00:07:00.941Z] Max requests allowed: 3
[2025-11-20T00:07:00.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.941Z] New count: 2
[2025-11-20T00:07:00.941Z] Remaining: 1
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.941Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.942Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] Existing timestamps: 2
[2025-11-20T00:07:00.942Z] Current count after filter: 2
[2025-11-20T00:07:00.942Z] Max requests allowed: 3
[2025-11-20T00:07:00.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.942Z] New count: 3
[2025-11-20T00:07:00.942Z] Remaining: 0
[2025-11-20T00:07:00.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.942Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.942Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] Existing timestamps: 3
[2025-11-20T00:07:00.943Z] Current count after filter: 3
[2025-11-20T00:07:00.943Z] Max requests allowed: 3
[2025-11-20T00:07:00.943Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.943Z] Current count: 3
[2025-11-20T00:07:00.943Z] Max allowed: 3
[2025-11-20T00:07:00.943Z] Retry after (seconds): 60
[2025-11-20T00:07:00.943Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.815Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.815Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.816Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] üìù Creating new entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Current count after filter: 0
[2025-11-20T07:12:01.816Z] Max requests allowed: 5
[2025-11-20T07:12:01.816Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.816Z] New count: 1
[2025-11-20T07:12:01.816Z] Remaining: 4
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.816Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.816Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Existing timestamps: 1
[2025-11-20T07:12:01.816Z] Current count after filter: 1
[2025-11-20T07:12:01.816Z] Max requests allowed: 5
[2025-11-20T07:12:01.816Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.816Z] New count: 2
[2025-11-20T07:12:01.816Z] Remaining: 3
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 2
[2025-11-20T07:12:01.817Z] Current count after filter: 2
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 3
[2025-11-20T07:12:01.817Z] Remaining: 2
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 3
[2025-11-20T07:12:01.817Z] Current count after filter: 3
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 4
[2025-11-20T07:12:01.817Z] Remaining: 1
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 4
[2025-11-20T07:12:01.817Z] Current count after filter: 4
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 5
[2025-11-20T07:12:01.817Z] Remaining: 0
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.818Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.818Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.818Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] üìù Creating new entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] Current count after filter: 0
[2025-11-20T07:12:01.818Z] Max requests allowed: 5
[2025-11-20T07:12:01.818Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.818Z] New count: 1
[2025-11-20T07:12:01.818Z] Remaining: 4
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.818Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.818Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.818Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] Existing timestamps: 1
[2025-11-20T07:12:01.818Z] Current count after filter: 1
[2025-11-20T07:12:01.818Z] Max requests allowed: 5
[2025-11-20T07:12:01.818Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.818Z] New count: 2
[2025-11-20T07:12:01.819Z] Remaining: 3
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 2
[2025-11-20T07:12:01.819Z] Current count after filter: 2
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.819Z] New count: 3
[2025-11-20T07:12:01.819Z] Remaining: 2
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 3
[2025-11-20T07:12:01.819Z] Current count after filter: 3
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.819Z] New count: 4
[2025-11-20T07:12:01.819Z] Remaining: 1
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 4
[2025-11-20T07:12:01.819Z] Current count after filter: 4
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.820Z] New count: 5
[2025-11-20T07:12:01.820Z] Remaining: 0
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.820Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.820Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.820Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.820Z] Existing timestamps: 5
[2025-11-20T07:12:01.820Z] Current count after filter: 5
[2025-11-20T07:12:01.820Z] Max requests allowed: 5
[2025-11-20T07:12:01.820Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.820Z] Current count: 5
[2025-11-20T07:12:01.820Z] Max allowed: 5
[2025-11-20T07:12:01.820Z] Retry after (seconds): 60
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.820Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] üìù Creating new entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Current count after filter: 0
[2025-11-20T07:12:01.820Z] Max requests allowed: 2
[2025-11-20T07:12:01.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.820Z] New count: 1
[2025-11-20T07:12:01.820Z] Remaining: 1
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.820Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Existing timestamps: 1
[2025-11-20T07:12:01.820Z] Current count after filter: 1
[2025-11-20T07:12:01.821Z] Max requests allowed: 2
[2025-11-20T07:12:01.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.821Z] New count: 2
[2025-11-20T07:12:01.821Z] Remaining: 0
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.821Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.821Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.821Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.821Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.821Z] Existing timestamps: 2
[2025-11-20T07:12:01.821Z] Current count after filter: 2
[2025-11-20T07:12:01.821Z] Max requests allowed: 2
[2025-11-20T07:12:01.821Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.821Z] Current count: 2
[2025-11-20T07:12:01.821Z] Max allowed: 2
[2025-11-20T07:12:01.821Z] Retry after (seconds): 1
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.974Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.974Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.974Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.974Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.974Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.974Z] Existing timestamps: 2
[2025-11-20T07:12:01.974Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T07:12:01.974Z] Current count after filter: 0
[2025-11-20T07:12:01.974Z] Max requests allowed: 2
[2025-11-20T07:12:01.974Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.975Z] New count: 1
[2025-11-20T07:12:01.975Z] Remaining: 1
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.975Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.975Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] üìù Creating new entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Current count after filter: 0
[2025-11-20T07:12:01.975Z] Max requests allowed: 5
[2025-11-20T07:12:01.975Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.975Z] New count: 1
[2025-11-20T07:12:01.975Z] Remaining: 4
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.975Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.975Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Existing timestamps: 1
[2025-11-20T07:12:01.975Z] Current count after filter: 1
[2025-11-20T07:12:01.975Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 2
[2025-11-20T07:12:01.976Z] Remaining: 3
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.976Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Existing timestamps: 2
[2025-11-20T07:12:01.976Z] Current count after filter: 2
[2025-11-20T07:12:01.976Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 3
[2025-11-20T07:12:01.976Z] Remaining: 2
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.976Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Existing timestamps: 3
[2025-11-20T07:12:01.976Z] Current count after filter: 3
[2025-11-20T07:12:01.976Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 4
[2025-11-20T07:12:01.976Z] Remaining: 1
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Existing timestamps: 4
[2025-11-20T07:12:01.977Z] Current count after filter: 4
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.977Z] New count: 5
[2025-11-20T07:12:01.977Z] Remaining: 0
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.977Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Existing timestamps: 5
[2025-11-20T07:12:01.977Z] Current count after filter: 5
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.977Z] Current count: 5
[2025-11-20T07:12:01.977Z] Max allowed: 5
[2025-11-20T07:12:01.977Z] Retry after (seconds): 60
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.977Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] üìù Creating new entry for key: login:test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] Current count after filter: 0
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.977Z] New count: 1
[2025-11-20T07:12:01.977Z] Remaining: 4
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.978Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.978Z] Identifier: test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] Key: login:test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] üìù Creating new entry for key: login:test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] Current count after filter: 0
[2025-11-20T07:12:01.978Z] Max requests allowed: 5
[2025-11-20T07:12:01.978Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.978Z] New count: 1
[2025-11-20T07:12:01.978Z] Remaining: 4
[2025-11-20T07:12:01.978Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.979Z] X-Test-ID header: null
[2025-11-20T07:12:01.979Z] Will use test ID?: false
[2025-11-20T07:12:01.979Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] Using real IP: 192.168.1.2
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.981Z] X-Test-ID header: null
[2025-11-20T07:12:01.981Z] Will use test ID?: false
[2025-11-20T07:12:01.981Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.981Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.981Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T07:12:01.981Z] Identifier: test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] Key: test-sliding:test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] üìù Creating new entry for key: test-sliding:test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] Current count after filter: 0
[2025-11-20T07:12:01.981Z] Max requests allowed: 3
[2025-11-20T07:12:01.981Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.981Z] New count: 1
[2025-11-20T07:12:01.981Z] Remaining: 2
[2025-11-20T07:12:01.981Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.048Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.049Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.049Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.049Z] üìù Creating new entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.049Z] Current count after filter: 0
[2025-11-20T11:45:12.049Z] Max requests allowed: 5
[2025-11-20T11:45:12.049Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.049Z] New count: 1
[2025-11-20T11:45:12.049Z] Remaining: 4
[2025-11-20T11:45:12.049Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.049Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.049Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.050Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Existing timestamps: 1
[2025-11-20T11:45:12.050Z] Current count after filter: 1
[2025-11-20T11:45:12.050Z] Max requests allowed: 5
[2025-11-20T11:45:12.050Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.050Z] New count: 2
[2025-11-20T11:45:12.050Z] Remaining: 3
[2025-11-20T11:45:12.050Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.050Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.050Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.050Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Existing timestamps: 2
[2025-11-20T11:45:12.050Z] Current count after filter: 2
[2025-11-20T11:45:12.050Z] Max requests allowed: 5
[2025-11-20T11:45:12.050Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.050Z] New count: 3
[2025-11-20T11:45:12.051Z] Remaining: 2
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.051Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.051Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Existing timestamps: 3
[2025-11-20T11:45:12.051Z] Current count after filter: 3
[2025-11-20T11:45:12.051Z] Max requests allowed: 5
[2025-11-20T11:45:12.051Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.051Z] New count: 4
[2025-11-20T11:45:12.051Z] Remaining: 1
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.051Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.051Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Existing timestamps: 4
[2025-11-20T11:45:12.051Z] Current count after filter: 4
[2025-11-20T11:45:12.051Z] Max requests allowed: 5
[2025-11-20T11:45:12.051Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.051Z] New count: 5
[2025-11-20T11:45:12.052Z] Remaining: 0
[2025-11-20T11:45:12.052Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.053Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.054Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.054Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.054Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.054Z] üìù Creating new entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.054Z] Current count after filter: 0
[2025-11-20T11:45:12.054Z] Max requests allowed: 5
[2025-11-20T11:45:12.054Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.054Z] New count: 1
[2025-11-20T11:45:12.055Z] Remaining: 4
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.055Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.055Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.055Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] Existing timestamps: 1
[2025-11-20T11:45:12.055Z] Current count after filter: 1
[2025-11-20T11:45:12.055Z] Max requests allowed: 5
[2025-11-20T11:45:12.055Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.055Z] New count: 2
[2025-11-20T11:45:12.055Z] Remaining: 3
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.055Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.055Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.055Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] Existing timestamps: 2
[2025-11-20T11:45:12.055Z] Current count after filter: 2
[2025-11-20T11:45:12.055Z] Max requests allowed: 5
[2025-11-20T11:45:12.055Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.055Z] New count: 3
[2025-11-20T11:45:12.056Z] Remaining: 2
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] Existing timestamps: 3
[2025-11-20T11:45:12.056Z] Current count after filter: 3
[2025-11-20T11:45:12.056Z] Max requests allowed: 5
[2025-11-20T11:45:12.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.056Z] New count: 4
[2025-11-20T11:45:12.056Z] Remaining: 1
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] Existing timestamps: 4
[2025-11-20T11:45:12.056Z] Current count after filter: 4
[2025-11-20T11:45:12.056Z] Max requests allowed: 5
[2025-11-20T11:45:12.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.056Z] New count: 5
[2025-11-20T11:45:12.056Z] Remaining: 0
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.057Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.057Z] Existing timestamps: 5
[2025-11-20T11:45:12.057Z] Current count after filter: 5
[2025-11-20T11:45:12.057Z] Max requests allowed: 5
[2025-11-20T11:45:12.057Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.057Z] Current count: 5
[2025-11-20T11:45:12.057Z] Max allowed: 5
[2025-11-20T11:45:12.057Z] Retry after (seconds): 60
[2025-11-20T11:45:12.057Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.057Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.057Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.057Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.057Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.057Z] üìù Creating new entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.057Z] Current count after filter: 0
[2025-11-20T11:45:12.057Z] Max requests allowed: 2
[2025-11-20T11:45:12.057Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.058Z] New count: 1
[2025-11-20T11:45:12.058Z] Remaining: 1
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.058Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.058Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Existing timestamps: 1
[2025-11-20T11:45:12.058Z] Current count after filter: 1
[2025-11-20T11:45:12.058Z] Max requests allowed: 2
[2025-11-20T11:45:12.058Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.058Z] New count: 2
[2025-11-20T11:45:12.058Z] Remaining: 0
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.058Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.058Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Existing timestamps: 2
[2025-11-20T11:45:12.058Z] Current count after filter: 2
[2025-11-20T11:45:12.058Z] Max requests allowed: 2
[2025-11-20T11:45:12.058Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.058Z] Current count: 2
[2025-11-20T11:45:12.058Z] Max allowed: 2
[2025-11-20T11:45:12.058Z] Retry after (seconds): 1
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.210Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.210Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.210Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.210Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.210Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.210Z] Existing timestamps: 2
[2025-11-20T11:45:12.210Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T11:45:12.211Z] Current count after filter: 0
[2025-11-20T11:45:12.211Z] Max requests allowed: 2
[2025-11-20T11:45:12.211Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.211Z] New count: 1
[2025-11-20T11:45:12.211Z] Remaining: 1
[2025-11-20T11:45:12.212Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.212Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.212Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.212Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.212Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.212Z] üìù Creating new entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.213Z] Current count after filter: 0
[2025-11-20T11:45:12.214Z] Max requests allowed: 5
[2025-11-20T11:45:12.214Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.214Z] New count: 1
[2025-11-20T11:45:12.214Z] Remaining: 4
[2025-11-20T11:45:12.214Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.214Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.214Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.215Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Existing timestamps: 1
[2025-11-20T11:45:12.215Z] Current count after filter: 1
[2025-11-20T11:45:12.215Z] Max requests allowed: 5
[2025-11-20T11:45:12.215Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.215Z] New count: 2
[2025-11-20T11:45:12.215Z] Remaining: 3
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.215Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.215Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Existing timestamps: 2
[2025-11-20T11:45:12.215Z] Current count after filter: 2
[2025-11-20T11:45:12.215Z] Max requests allowed: 5
[2025-11-20T11:45:12.215Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.215Z] New count: 3
[2025-11-20T11:45:12.215Z] Remaining: 2
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.216Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.216Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Existing timestamps: 3
[2025-11-20T11:45:12.216Z] Current count after filter: 3
[2025-11-20T11:45:12.216Z] Max requests allowed: 5
[2025-11-20T11:45:12.216Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.216Z] New count: 4
[2025-11-20T11:45:12.216Z] Remaining: 1
[2025-11-20T11:45:12.216Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.216Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.216Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.216Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Existing timestamps: 4
[2025-11-20T11:45:12.216Z] Current count after filter: 4
[2025-11-20T11:45:12.216Z] Max requests allowed: 5
[2025-11-20T11:45:12.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.220Z] New count: 5
[2025-11-20T11:45:12.220Z] Remaining: 0
[2025-11-20T11:45:12.220Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.220Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.220Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.220Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] Existing timestamps: 5
[2025-11-20T11:45:12.220Z] Current count after filter: 5
[2025-11-20T11:45:12.220Z] Max requests allowed: 5
[2025-11-20T11:45:12.220Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.220Z] Current count: 5
[2025-11-20T11:45:12.221Z] Max allowed: 5
[2025-11-20T11:45:12.221Z] Retry after (seconds): 60
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.221Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.221Z] Identifier: test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] Key: login:test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] üìù Creating new entry for key: login:test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] Current count after filter: 0
[2025-11-20T11:45:12.221Z] Max requests allowed: 5
[2025-11-20T11:45:12.221Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.221Z] New count: 1
[2025-11-20T11:45:12.221Z] Remaining: 4
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.222Z] Identifier: test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] Key: login:test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] üìù Creating new entry for key: login:test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] Current count after filter: 0
[2025-11-20T11:45:12.222Z] Max requests allowed: 5
[2025-11-20T11:45:12.222Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.222Z] New count: 1
[2025-11-20T11:45:12.222Z] Remaining: 4
[2025-11-20T11:45:12.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.223Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.223Z] X-Test-ID header: null
[2025-11-20T11:45:12.223Z] Will use test ID?: false
[2025-11-20T11:45:12.223Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.223Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.224Z] X-Test-ID header: null
[2025-11-20T11:45:12.224Z] Will use test ID?: false
[2025-11-20T11:45:12.224Z] Using real IP: 192.168.1.2
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.224Z] X-Test-ID header: null
[2025-11-20T11:45:12.224Z] Will use test ID?: false
[2025-11-20T11:45:12.224Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.225Z] X-Test-ID header: null
[2025-11-20T11:45:12.225Z] Will use test ID?: false
[2025-11-20T11:45:12.225Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.225Z] X-Test-ID header: null
[2025-11-20T11:45:12.225Z] Will use test ID?: false
[2025-11-20T11:45:12.225Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.225Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.225Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] üìù Creating new entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] Current count after filter: 0
[2025-11-20T11:45:12.226Z] Max requests allowed: 3
[2025-11-20T11:45:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.226Z] New count: 1
[2025-11-20T11:45:12.226Z] Remaining: 2
[2025-11-20T11:45:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.327Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.327Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.327Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] Existing timestamps: 1
[2025-11-20T11:45:12.328Z] Current count after filter: 1
[2025-11-20T11:45:12.328Z] Max requests allowed: 3
[2025-11-20T11:45:12.328Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.328Z] New count: 2
[2025-11-20T11:45:12.328Z] Remaining: 1
[2025-11-20T11:45:12.328Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.430Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.430Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] Existing timestamps: 2
[2025-11-20T11:45:12.430Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-20T11:45:12.430Z] Current count after filter: 1
[2025-11-20T11:45:12.430Z] Max requests allowed: 3
[2025-11-20T11:45:12.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.430Z] New count: 2
[2025-11-20T11:45:12.430Z] Remaining: 1
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.430Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.430Z] Identifier: test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] Key: register:test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] üìù Creating new entry for key: register:test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] Current count after filter: 0
[2025-11-20T11:45:12.430Z] Max requests allowed: 3
[2025-11-20T11:45:12.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.430Z] New count: 1
[2025-11-20T11:45:12.430Z] Remaining: 2
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìù Creating new entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Current count after filter: 0
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 1
[2025-11-20T11:45:12.431Z] Remaining: 2
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Existing timestamps: 1
[2025-11-20T11:45:12.431Z] Current count after filter: 1
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 2
[2025-11-20T11:45:12.431Z] Remaining: 1
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Existing timestamps: 2
[2025-11-20T11:45:12.431Z] Current count after filter: 2
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 3
[2025-11-20T11:45:12.431Z] Remaining: 0
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.432Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] Existing timestamps: 3
[2025-11-20T11:45:12.432Z] Current count after filter: 3
[2025-11-20T11:45:12.432Z] Max requests allowed: 3
[2025-11-20T11:45:12.432Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.432Z] Current count: 3
[2025-11-20T11:45:12.432Z] Max allowed: 3
[2025-11-20T11:45:12.432Z] Retry after (seconds): 60
[2025-11-20T11:45:12.432Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:21.382Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:21.383Z] Request URL: /auth/login
[2025-11-20T11:45:21.383Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:21.383Z] X-Test-ID header: null
[2025-11-20T11:45:21.383Z] Will use test ID?: false
[2025-11-20T11:45:21.383Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:21.383Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:21.383Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:21.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:21.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:21.383Z] Identifier: unknown
[2025-11-20T11:45:21.383Z] Key: login:unknown
[2025-11-20T11:45:21.384Z] üìù Creating new entry for key: login:unknown
[2025-11-20T11:45:21.384Z] Current count after filter: 0
[2025-11-20T11:45:21.384Z] Max requests allowed: 5
[2025-11-20T11:45:21.384Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:21.384Z] New count: 1
[2025-11-20T11:45:21.384Z] Remaining: 4
[2025-11-20T11:45:21.384Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:21.384Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:23.921Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.921Z] Request URL: /auth/token
[2025-11-20T11:45:23.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.922Z] X-Test-ID header: null
[2025-11-20T11:45:23.922Z] Will use test ID?: false
[2025-11-20T11:45:23.922Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.922Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.922Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.922Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.922Z] Identifier: unknown
[2025-11-20T11:45:23.922Z] Key: token:unknown
[2025-11-20T11:45:23.922Z] üìù Creating new entry for key: token:unknown
[2025-11-20T11:45:23.922Z] Current count after filter: 0
[2025-11-20T11:45:23.922Z] Max requests allowed: 60
[2025-11-20T11:45:23.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.922Z] New count: 1
[2025-11-20T11:45:23.922Z] Remaining: 59
[2025-11-20T11:45:23.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.922Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:23.968Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.968Z] Request URL: /auth/token
[2025-11-20T11:45:23.968Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.968Z] X-Test-ID header: null
[2025-11-20T11:45:23.969Z] Will use test ID?: false
[2025-11-20T11:45:23.969Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.969Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.969Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.969Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.969Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.969Z] Identifier: unknown
[2025-11-20T11:45:23.969Z] Key: token:unknown
[2025-11-20T11:45:23.969Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:23.969Z] Existing timestamps: 1
[2025-11-20T11:45:23.969Z] Current count after filter: 1
[2025-11-20T11:45:23.969Z] Max requests allowed: 60
[2025-11-20T11:45:23.969Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.969Z] New count: 2
[2025-11-20T11:45:23.969Z] Remaining: 58
[2025-11-20T11:45:23.969Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.969Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:23.970Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.970Z] Request URL: /auth/token
[2025-11-20T11:45:23.970Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.970Z] X-Test-ID header: null
[2025-11-20T11:45:23.970Z] Will use test ID?: false
[2025-11-20T11:45:23.970Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.970Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.970Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.970Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.970Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.970Z] Identifier: unknown
[2025-11-20T11:45:23.970Z] Key: token:unknown
[2025-11-20T11:45:23.970Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:23.970Z] Existing timestamps: 2
[2025-11-20T11:45:23.970Z] Current count after filter: 2
[2025-11-20T11:45:23.970Z] Max requests allowed: 60
[2025-11-20T11:45:23.970Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.970Z] New count: 3
[2025-11-20T11:45:23.970Z] Remaining: 57
[2025-11-20T11:45:23.970Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.970Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.514Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.514Z] Request URL: /auth/token
[2025-11-20T11:45:24.514Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.515Z] X-Test-ID header: null
[2025-11-20T11:45:24.515Z] Will use test ID?: false
[2025-11-20T11:45:24.515Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.515Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.515Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.515Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.515Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.515Z] Identifier: unknown
[2025-11-20T11:45:24.515Z] Key: token:unknown
[2025-11-20T11:45:24.515Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.515Z] Existing timestamps: 3
[2025-11-20T11:45:24.515Z] Current count after filter: 3
[2025-11-20T11:45:24.515Z] Max requests allowed: 60
[2025-11-20T11:45:24.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.515Z] New count: 4
[2025-11-20T11:45:24.515Z] Remaining: 56
[2025-11-20T11:45:24.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.548Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.549Z] Request URL: /auth/token
[2025-11-20T11:45:24.549Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.549Z] X-Test-ID header: null
[2025-11-20T11:45:24.549Z] Will use test ID?: false
[2025-11-20T11:45:24.549Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.549Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.549Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.549Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.549Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.549Z] Identifier: unknown
[2025-11-20T11:45:24.549Z] Key: token:unknown
[2025-11-20T11:45:24.549Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.549Z] Existing timestamps: 4
[2025-11-20T11:45:24.550Z] Current count after filter: 4
[2025-11-20T11:45:24.550Z] Max requests allowed: 60
[2025-11-20T11:45:24.550Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.550Z] New count: 5
[2025-11-20T11:45:24.550Z] Remaining: 55
[2025-11-20T11:45:24.550Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.550Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.552Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.552Z] Request URL: /auth/token
[2025-11-20T11:45:24.552Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.552Z] X-Test-ID header: null
[2025-11-20T11:45:24.552Z] Will use test ID?: false
[2025-11-20T11:45:24.552Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.552Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.552Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.552Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.552Z] Identifier: unknown
[2025-11-20T11:45:24.552Z] Key: token:unknown
[2025-11-20T11:45:24.552Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.552Z] Existing timestamps: 5
[2025-11-20T11:45:24.552Z] Current count after filter: 5
[2025-11-20T11:45:24.552Z] Max requests allowed: 60
[2025-11-20T11:45:24.552Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.552Z] New count: 6
[2025-11-20T11:45:24.552Z] Remaining: 54
[2025-11-20T11:45:24.552Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.552Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:25.490Z] üîí withRateLimit CALLED for endpoint: logout
[2025-11-20T11:45:25.490Z] Request URL: /logout
[2025-11-20T11:45:25.490Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.490Z] X-Test-ID header: null
[2025-11-20T11:45:25.490Z] Will use test ID?: false
[2025-11-20T11:45:25.490Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.490Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.490Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.490Z] Config: {
  "keyPrefix": "logout",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:25.490Z] Identifier: unknown
[2025-11-20T11:45:25.490Z] Key: logout:unknown
[2025-11-20T11:45:25.491Z] üìù Creating new entry for key: logout:unknown
[2025-11-20T11:45:25.491Z] Current count after filter: 0
[2025-11-20T11:45:25.491Z] Max requests allowed: 5
[2025-11-20T11:45:25.491Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.491Z] New count: 1
[2025-11-20T11:45:25.491Z] Remaining: 4
[2025-11-20T11:45:25.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.491Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639185490
}
[2025-11-20T11:45:25.522Z] üîí withRateLimit CALLED for endpoint: logout
[2025-11-20T11:45:25.522Z] Request URL: /logout
[2025-11-20T11:45:25.522Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.522Z] X-Test-ID header: null
[2025-11-20T11:45:25.522Z] Will use test ID?: false
[2025-11-20T11:45:25.522Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.522Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.522Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.522Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.522Z] Config: {
  "keyPrefix": "logout",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:25.522Z] Identifier: unknown
[2025-11-20T11:45:25.522Z] Key: logout:unknown
[2025-11-20T11:45:25.522Z] üìñ Found existing entry for key: logout:unknown
[2025-11-20T11:45:25.522Z] Existing timestamps: 1
[2025-11-20T11:45:25.522Z] Current count after filter: 1
[2025-11-20T11:45:25.523Z] Max requests allowed: 5
[2025-11-20T11:45:25.523Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.523Z] New count: 2
[2025-11-20T11:45:25.523Z] Remaining: 3
[2025-11-20T11:45:25.523Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.523Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639185490
}
[2025-11-20T11:45:25.729Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:25.729Z] Request URL: /auth/token
[2025-11-20T11:45:25.729Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.729Z] X-Test-ID header: null
[2025-11-20T11:45:25.729Z] Will use test ID?: false
[2025-11-20T11:45:25.729Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.729Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.730Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.730Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:25.730Z] Identifier: unknown
[2025-11-20T11:45:25.730Z] Key: token:unknown
[2025-11-20T11:45:25.730Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:25.730Z] Existing timestamps: 6
[2025-11-20T11:45:25.730Z] Current count after filter: 6
[2025-11-20T11:45:25.730Z] Max requests allowed: 60
[2025-11-20T11:45:25.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.730Z] New count: 7
[2025-11-20T11:45:25.730Z] Remaining: 53
[2025-11-20T11:45:25.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.730Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:26.320Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:26.320Z] Request URL: /auth/token
[2025-11-20T11:45:26.320Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:26.320Z] X-Test-ID header: null
[2025-11-20T11:45:26.320Z] Will use test ID?: false
[2025-11-20T11:45:26.320Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:26.320Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:26.320Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:26.320Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:26.320Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:26.321Z] Identifier: unknown
[2025-11-20T11:45:26.321Z] Key: token:unknown
[2025-11-20T11:45:26.321Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:26.321Z] Existing timestamps: 7
[2025-11-20T11:45:26.321Z] Current count after filter: 7
[2025-11-20T11:45:26.321Z] Max requests allowed: 60
[2025-11-20T11:45:26.321Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:26.321Z] New count: 8
[2025-11-20T11:45:26.321Z] Remaining: 52
[2025-11-20T11:45:26.321Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:26.321Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:27.321Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:27.321Z] Request URL: /auth/token
[2025-11-20T11:45:27.322Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:27.322Z] X-Test-ID header: null
[2025-11-20T11:45:27.322Z] Will use test ID?: false
[2025-11-20T11:45:27.322Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:27.322Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:27.322Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:27.322Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:27.322Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:27.322Z] Identifier: unknown
[2025-11-20T11:45:27.322Z] Key: token:unknown
[2025-11-20T11:45:27.322Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:27.322Z] Existing timestamps: 8
[2025-11-20T11:45:27.323Z] Current count after filter: 8
[2025-11-20T11:45:27.323Z] Max requests allowed: 60
[2025-11-20T11:45:27.323Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:27.323Z] New count: 9
[2025-11-20T11:45:27.323Z] Remaining: 51
[2025-11-20T11:45:27.323Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:27.323Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:27.909Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:27.909Z] Request URL: /auth/token
[2025-11-20T11:45:27.909Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:27.909Z] X-Test-ID header: null
[2025-11-20T11:45:27.909Z] Will use test ID?: false
[2025-11-20T11:45:27.910Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:27.910Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:27.910Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:27.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:27.910Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:27.910Z] Identifier: unknown
[2025-11-20T11:45:27.910Z] Key: token:unknown
[2025-11-20T11:45:27.910Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:27.910Z] Existing timestamps: 9
[2025-11-20T11:45:27.910Z] Current count after filter: 9
[2025-11-20T11:45:27.910Z] Max requests allowed: 60
[2025-11-20T11:45:27.910Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:27.910Z] New count: 10
[2025-11-20T11:45:27.910Z] Remaining: 50
[2025-11-20T11:45:27.910Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:27.911Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:28.820Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:28.820Z] Request URL: /auth/token
[2025-11-20T11:45:28.820Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:28.820Z] X-Test-ID header: null
[2025-11-20T11:45:28.820Z] Will use test ID?: false
[2025-11-20T11:45:28.820Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:28.820Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:28.820Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:28.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:28.821Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:28.821Z] Identifier: unknown
[2025-11-20T11:45:28.821Z] Key: token:unknown
[2025-11-20T11:45:28.821Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:28.821Z] Existing timestamps: 10
[2025-11-20T11:45:28.821Z] Current count after filter: 10
[2025-11-20T11:45:28.821Z] Max requests allowed: 60
[2025-11-20T11:45:28.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:28.821Z] New count: 11
[2025-11-20T11:45:28.821Z] Remaining: 49
[2025-11-20T11:45:28.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:28.821Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 49,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.278Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.278Z] Request URL: /auth/token
[2025-11-20T11:45:29.279Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.279Z] X-Test-ID header: null
[2025-11-20T11:45:29.279Z] Will use test ID?: false
[2025-11-20T11:45:29.279Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.279Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.279Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.279Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.279Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.279Z] Identifier: unknown
[2025-11-20T11:45:29.279Z] Key: token:unknown
[2025-11-20T11:45:29.279Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.279Z] Existing timestamps: 11
[2025-11-20T11:45:29.279Z] Current count after filter: 11
[2025-11-20T11:45:29.279Z] Max requests allowed: 60
[2025-11-20T11:45:29.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.279Z] New count: 12
[2025-11-20T11:45:29.279Z] Remaining: 48
[2025-11-20T11:45:29.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.279Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 48,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.404Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.404Z] Request URL: /auth/token
[2025-11-20T11:45:29.404Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.404Z] X-Test-ID header: null
[2025-11-20T11:45:29.404Z] Will use test ID?: false
[2025-11-20T11:45:29.404Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.404Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.405Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.405Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.405Z] Identifier: unknown
[2025-11-20T11:45:29.405Z] Key: token:unknown
[2025-11-20T11:45:29.405Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.405Z] Existing timestamps: 12
[2025-11-20T11:45:29.405Z] Current count after filter: 12
[2025-11-20T11:45:29.405Z] Max requests allowed: 60
[2025-11-20T11:45:29.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.405Z] New count: 13
[2025-11-20T11:45:29.405Z] Remaining: 47
[2025-11-20T11:45:29.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.405Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 47,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.867Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.867Z] Request URL: /auth/token
[2025-11-20T11:45:29.867Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.867Z] X-Test-ID header: null
[2025-11-20T11:45:29.867Z] Will use test ID?: false
[2025-11-20T11:45:29.867Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.868Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.868Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.868Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.868Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.868Z] Identifier: unknown
[2025-11-20T11:45:29.868Z] Key: token:unknown
[2025-11-20T11:45:29.868Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.868Z] Existing timestamps: 13
[2025-11-20T11:45:29.868Z] Current count after filter: 13
[2025-11-20T11:45:29.868Z] Max requests allowed: 60
[2025-11-20T11:45:29.868Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.868Z] New count: 14
[2025-11-20T11:45:29.868Z] Remaining: 46
[2025-11-20T11:45:29.868Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.868Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 46,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.112Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.112Z] Request URL: /auth/token
[2025-11-20T11:45:31.112Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.112Z] X-Test-ID header: null
[2025-11-20T11:45:31.112Z] Will use test ID?: false
[2025-11-20T11:45:31.112Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.112Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.112Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.112Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.112Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.113Z] Identifier: unknown
[2025-11-20T11:45:31.113Z] Key: token:unknown
[2025-11-20T11:45:31.113Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.113Z] Existing timestamps: 14
[2025-11-20T11:45:31.113Z] Current count after filter: 14
[2025-11-20T11:45:31.113Z] Max requests allowed: 60
[2025-11-20T11:45:31.113Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.113Z] New count: 15
[2025-11-20T11:45:31.113Z] Remaining: 45
[2025-11-20T11:45:31.113Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.113Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 45,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.695Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.695Z] Request URL: /auth/token
[2025-11-20T11:45:31.696Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.696Z] X-Test-ID header: null
[2025-11-20T11:45:31.696Z] Will use test ID?: false
[2025-11-20T11:45:31.696Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.696Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.696Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.696Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.696Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.696Z] Identifier: unknown
[2025-11-20T11:45:31.696Z] Key: token:unknown
[2025-11-20T11:45:31.696Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.696Z] Existing timestamps: 15
[2025-11-20T11:45:31.697Z] Current count after filter: 15
[2025-11-20T11:45:31.697Z] Max requests allowed: 60
[2025-11-20T11:45:31.697Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.697Z] New count: 16
[2025-11-20T11:45:31.697Z] Remaining: 44
[2025-11-20T11:45:31.697Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.697Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 44,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.765Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.765Z] Request URL: /auth/token
[2025-11-20T11:45:31.766Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.766Z] X-Test-ID header: null
[2025-11-20T11:45:31.766Z] Will use test ID?: false
[2025-11-20T11:45:31.766Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.766Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.766Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.766Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.766Z] Identifier: unknown
[2025-11-20T11:45:31.766Z] Key: token:unknown
[2025-11-20T11:45:31.766Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.766Z] Existing timestamps: 16
[2025-11-20T11:45:31.766Z] Current count after filter: 16
[2025-11-20T11:45:31.766Z] Max requests allowed: 60
[2025-11-20T11:45:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.767Z] New count: 17
[2025-11-20T11:45:31.767Z] Remaining: 43
[2025-11-20T11:45:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.767Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 43,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.992Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:31.992Z] Request URL: /auth/register
[2025-11-20T11:45:31.992Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.992Z] X-Test-ID header: null
[2025-11-20T11:45:31.992Z] Will use test ID?: false
[2025-11-20T11:45:31.992Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.992Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.992Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.992Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.992Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:31.992Z] Identifier: unknown
[2025-11-20T11:45:31.992Z] Key: register:unknown
[2025-11-20T11:45:31.992Z] üìù Creating new entry for key: register:unknown
[2025-11-20T11:45:31.992Z] Current count after filter: 0
[2025-11-20T11:45:31.992Z] Max requests allowed: 3
[2025-11-20T11:45:31.992Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.992Z] New count: 1
[2025-11-20T11:45:31.992Z] Remaining: 2
[2025-11-20T11:45:31.993Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.993Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639191992
}
[2025-11-20T11:45:32.343Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:32.344Z] Request URL: /auth/token
[2025-11-20T11:45:32.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:32.344Z] X-Test-ID header: null
[2025-11-20T11:45:32.344Z] Will use test ID?: false
[2025-11-20T11:45:32.344Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:32.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:32.344Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:32.344Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:32.344Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:32.344Z] Identifier: unknown
[2025-11-20T11:45:32.344Z] Key: token:unknown
[2025-11-20T11:45:32.344Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:32.344Z] Existing timestamps: 17
[2025-11-20T11:45:32.345Z] Current count after filter: 17
[2025-11-20T11:45:32.345Z] Max requests allowed: 60
[2025-11-20T11:45:32.345Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:32.345Z] New count: 18
[2025-11-20T11:45:32.345Z] Remaining: 42
[2025-11-20T11:45:32.345Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:32.345Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 42,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:33.023Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:33.023Z] Request URL: /auth/verify-email
[2025-11-20T11:45:33.023Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:33.024Z] X-Test-ID header: null
[2025-11-20T11:45:33.024Z] Will use test ID?: false
[2025-11-20T11:45:33.024Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:33.024Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:33.024Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:33.024Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:33.024Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:33.024Z] Identifier: unknown
[2025-11-20T11:45:33.024Z] Key: login:unknown
[2025-11-20T11:45:33.024Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:33.024Z] Existing timestamps: 1
[2025-11-20T11:45:33.024Z] Current count after filter: 1
[2025-11-20T11:45:33.024Z] Max requests allowed: 5
[2025-11-20T11:45:33.024Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:33.024Z] New count: 2
[2025-11-20T11:45:33.024Z] Remaining: 3
[2025-11-20T11:45:33.024Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:33.024Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:34.324Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:34.324Z] Request URL: /auth/forgot-password
[2025-11-20T11:45:34.324Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:34.324Z] X-Test-ID header: null
[2025-11-20T11:45:34.325Z] Will use test ID?: false
[2025-11-20T11:45:34.325Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:34.325Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:34.325Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:34.325Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:34.325Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:34.325Z] Identifier: unknown
[2025-11-20T11:45:34.325Z] Key: login:unknown
[2025-11-20T11:45:34.325Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:34.325Z] Existing timestamps: 2
[2025-11-20T11:45:34.325Z] Current count after filter: 2
[2025-11-20T11:45:34.325Z] Max requests allowed: 5
[2025-11-20T11:45:34.325Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:34.325Z] New count: 3
[2025-11-20T11:45:34.325Z] Remaining: 2
[2025-11-20T11:45:34.325Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:34.325Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:34.659Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:34.659Z] Request URL: /auth/token
[2025-11-20T11:45:34.659Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:34.659Z] X-Test-ID header: null
[2025-11-20T11:45:34.659Z] Will use test ID?: false
[2025-11-20T11:45:34.659Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:34.659Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:34.659Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:34.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:34.659Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:34.659Z] Identifier: unknown
[2025-11-20T11:45:34.659Z] Key: token:unknown
[2025-11-20T11:45:34.659Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:34.659Z] Existing timestamps: 18
[2025-11-20T11:45:34.659Z] Current count after filter: 18
[2025-11-20T11:45:34.659Z] Max requests allowed: 60
[2025-11-20T11:45:34.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:34.660Z] New count: 19
[2025-11-20T11:45:34.660Z] Remaining: 41
[2025-11-20T11:45:34.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:34.660Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 41,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:35.244Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:35.244Z] Request URL: /auth/token
[2025-11-20T11:45:35.245Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:35.245Z] X-Test-ID header: null
[2025-11-20T11:45:35.245Z] Will use test ID?: false
[2025-11-20T11:45:35.245Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:35.245Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:35.245Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:35.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:35.245Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:35.245Z] Identifier: unknown
[2025-11-20T11:45:35.245Z] Key: token:unknown
[2025-11-20T11:45:35.245Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:35.245Z] Existing timestamps: 19
[2025-11-20T11:45:35.245Z] Current count after filter: 19
[2025-11-20T11:45:35.245Z] Max requests allowed: 60
[2025-11-20T11:45:35.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:35.246Z] New count: 20
[2025-11-20T11:45:35.246Z] Remaining: 40
[2025-11-20T11:45:35.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:35.246Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 40,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:35.641Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:35.641Z] Request URL: /auth/reset-password
[2025-11-20T11:45:35.641Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:35.641Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:35.642Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:35.642Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:35.642Z] X-Test-ID header: null
[2025-11-20T11:45:35.642Z] Will use test ID?: false
[2025-11-20T11:45:35.642Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:35.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:35.642Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:35.642Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:35.642Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:35.642Z] Identifier: unknown
[2025-11-20T11:45:35.642Z] Key: login:unknown
[2025-11-20T11:45:35.642Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:35.642Z] Existing timestamps: 3
[2025-11-20T11:45:35.642Z] Current count after filter: 3
[2025-11-20T11:45:35.642Z] Max requests allowed: 5
[2025-11-20T11:45:35.642Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:35.642Z] New count: 4
[2025-11-20T11:45:35.642Z] Remaining: 1
[2025-11-20T11:45:35.642Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:35.642Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:37.270Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.271Z] Request URL: /auth/login
[2025-11-20T11:45:37.271Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.271Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Will use test ID?: true
[2025-11-20T11:45:37.271Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.271Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.271Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.271Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] üìù Creating new entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Current count after filter: 0
[2025-11-20T11:45:37.271Z] Max requests allowed: 5
[2025-11-20T11:45:37.271Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.271Z] New count: 1
[2025-11-20T11:45:37.271Z] Remaining: 4
[2025-11-20T11:45:37.271Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.271Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:37.338Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.338Z] Request URL: /auth/login
[2025-11-20T11:45:37.338Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.338Z] X-Test-ID header: login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Will use test ID?: true
[2025-11-20T11:45:37.339Z] ‚úÖ Using test identifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.339Z] Got identifier from getClientIdentifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.339Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.339Z] Identifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Key: login:test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] üìù Creating new entry for key: login:test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Current count after filter: 0
[2025-11-20T11:45:37.339Z] Max requests allowed: 5
[2025-11-20T11:45:37.339Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.339Z] New count: 1
[2025-11-20T11:45:37.339Z] Remaining: 4
[2025-11-20T11:45:37.339Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.339Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197339
}
[2025-11-20T11:45:37.592Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.592Z] Request URL: /auth/login
[2025-11-20T11:45:37.593Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.593Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] Will use test ID?: true
[2025-11-20T11:45:37.593Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.593Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.593Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.594Z] Existing timestamps: 1
[2025-11-20T11:45:37.594Z] Current count after filter: 1
[2025-11-20T11:45:37.594Z] Max requests allowed: 5
[2025-11-20T11:45:37.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.594Z] New count: 2
[2025-11-20T11:45:37.594Z] Remaining: 3
[2025-11-20T11:45:37.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.594Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:37.641Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.641Z] Request URL: /auth/login
[2025-11-20T11:45:37.641Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.641Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] Will use test ID?: true
[2025-11-20T11:45:37.641Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.641Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.641Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.641Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] üìù Creating new entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.642Z] Current count after filter: 0
[2025-11-20T11:45:37.642Z] Max requests allowed: 5
[2025-11-20T11:45:37.642Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.642Z] New count: 1
[2025-11-20T11:45:37.642Z] Remaining: 4
[2025-11-20T11:45:37.642Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.642Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:37.871Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:37.871Z] Request URL: /auth/register
[2025-11-20T11:45:37.871Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.871Z] X-Test-ID header: null
[2025-11-20T11:45:37.871Z] Will use test ID?: false
[2025-11-20T11:45:37.871Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:37.872Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.872Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:37.872Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.872Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:37.872Z] Identifier: unknown
[2025-11-20T11:45:37.872Z] Key: register:unknown
[2025-11-20T11:45:37.872Z] üìñ Found existing entry for key: register:unknown
[2025-11-20T11:45:37.872Z] Existing timestamps: 1
[2025-11-20T11:45:37.872Z] Current count after filter: 1
[2025-11-20T11:45:37.872Z] Max requests allowed: 3
[2025-11-20T11:45:37.872Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.872Z] New count: 2
[2025-11-20T11:45:37.872Z] Remaining: 1
[2025-11-20T11:45:37.872Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.872Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639191992
}
[2025-11-20T11:45:37.890Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.890Z] Request URL: /auth/login
[2025-11-20T11:45:37.890Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.890Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.890Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.891Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.891Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Will use test ID?: true
[2025-11-20T11:45:37.891Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.891Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.891Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.891Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Existing timestamps: 1
[2025-11-20T11:45:37.891Z] Current count after filter: 1
[2025-11-20T11:45:37.891Z] Max requests allowed: 5
[2025-11-20T11:45:37.891Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.891Z] New count: 2
[2025-11-20T11:45:37.891Z] Remaining: 3
[2025-11-20T11:45:37.891Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.891Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:37.927Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.927Z] Request URL: /auth/login
[2025-11-20T11:45:37.927Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.927Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] Will use test ID?: true
[2025-11-20T11:45:37.927Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.927Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.928Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] Existing timestamps: 2
[2025-11-20T11:45:37.928Z] Current count after filter: 2
[2025-11-20T11:45:37.928Z] Max requests allowed: 5
[2025-11-20T11:45:37.928Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.928Z] New count: 3
[2025-11-20T11:45:37.928Z] Remaining: 2
[2025-11-20T11:45:37.928Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.928Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.045Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.045Z] Request URL: /auth/register
[2025-11-20T11:45:38.045Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.045Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.045Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.046Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.046Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Will use test ID?: true
[2025-11-20T11:45:38.046Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.046Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.046Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.046Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] üìù Creating new entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Current count after filter: 0
[2025-11-20T11:45:38.046Z] Max requests allowed: 3
[2025-11-20T11:45:38.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.046Z] New count: 1
[2025-11-20T11:45:38.046Z] Remaining: 2
[2025-11-20T11:45:38.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.046Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.151Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.151Z] Request URL: /auth/login
[2025-11-20T11:45:38.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.151Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.152Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.152Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.152Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Will use test ID?: true
[2025-11-20T11:45:38.152Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.152Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.152Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.152Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Existing timestamps: 2
[2025-11-20T11:45:38.152Z] Current count after filter: 2
[2025-11-20T11:45:38.152Z] Max requests allowed: 5
[2025-11-20T11:45:38.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.152Z] New count: 3
[2025-11-20T11:45:38.152Z] Remaining: 2
[2025-11-20T11:45:38.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.152Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.239Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.239Z] Request URL: /auth/login
[2025-11-20T11:45:38.239Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.239Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.240Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.240Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.240Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Will use test ID?: true
[2025-11-20T11:45:38.240Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.240Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.240Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.240Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Existing timestamps: 3
[2025-11-20T11:45:38.240Z] Current count after filter: 3
[2025-11-20T11:45:38.240Z] Max requests allowed: 5
[2025-11-20T11:45:38.240Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.240Z] New count: 4
[2025-11-20T11:45:38.240Z] Remaining: 1
[2025-11-20T11:45:38.240Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.240Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.392Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.393Z] Request URL: /auth/login
[2025-11-20T11:45:38.393Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.393Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Will use test ID?: true
[2025-11-20T11:45:38.393Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.393Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.393Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.393Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Existing timestamps: 3
[2025-11-20T11:45:38.393Z] Current count after filter: 3
[2025-11-20T11:45:38.394Z] Max requests allowed: 5
[2025-11-20T11:45:38.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.394Z] New count: 4
[2025-11-20T11:45:38.394Z] Remaining: 1
[2025-11-20T11:45:38.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.394Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.463Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.464Z] Request URL: /auth/register
[2025-11-20T11:45:38.464Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.464Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Will use test ID?: true
[2025-11-20T11:45:38.464Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.464Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.464Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.464Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Existing timestamps: 1
[2025-11-20T11:45:38.464Z] Current count after filter: 1
[2025-11-20T11:45:38.464Z] Max requests allowed: 3
[2025-11-20T11:45:38.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.464Z] New count: 2
[2025-11-20T11:45:38.464Z] Remaining: 1
[2025-11-20T11:45:38.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.464Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.562Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.562Z] Request URL: /auth/login
[2025-11-20T11:45:38.562Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.562Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] Will use test ID?: true
[2025-11-20T11:45:38.562Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.562Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.562Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.562Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] Existing timestamps: 4
[2025-11-20T11:45:38.563Z] Current count after filter: 4
[2025-11-20T11:45:38.563Z] Max requests allowed: 5
[2025-11-20T11:45:38.563Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.563Z] New count: 5
[2025-11-20T11:45:38.563Z] Remaining: 0
[2025-11-20T11:45:38.563Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.563Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.652Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.652Z] Request URL: /auth/login
[2025-11-20T11:45:38.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.652Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.653Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.653Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.653Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Will use test ID?: true
[2025-11-20T11:45:38.653Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.653Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.653Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.653Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Existing timestamps: 4
[2025-11-20T11:45:38.653Z] Current count after filter: 4
[2025-11-20T11:45:38.653Z] Max requests allowed: 5
[2025-11-20T11:45:38.653Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.653Z] New count: 5
[2025-11-20T11:45:38.653Z] Remaining: 0
[2025-11-20T11:45:38.653Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.653Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.739Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.739Z] Request URL: /auth/verify-email
[2025-11-20T11:45:38.739Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.739Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] Will use test ID?: true
[2025-11-20T11:45:38.739Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.739Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.739Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.739Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.740Z] üìù Creating new entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.740Z] Current count after filter: 0
[2025-11-20T11:45:38.740Z] Max requests allowed: 5
[2025-11-20T11:45:38.740Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.740Z] New count: 1
[2025-11-20T11:45:38.740Z] Remaining: 4
[2025-11-20T11:45:38.740Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.740Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:38.807Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.807Z] Request URL: /auth/register
[2025-11-20T11:45:38.807Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.808Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Will use test ID?: true
[2025-11-20T11:45:38.808Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.808Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.808Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.808Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Existing timestamps: 2
[2025-11-20T11:45:38.808Z] Current count after filter: 2
[2025-11-20T11:45:38.808Z] Max requests allowed: 3
[2025-11-20T11:45:38.808Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.808Z] New count: 3
[2025-11-20T11:45:38.808Z] Remaining: 0
[2025-11-20T11:45:38.808Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.808Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.893Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.893Z] Request URL: /auth/login
[2025-11-20T11:45:38.893Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.894Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Will use test ID?: true
[2025-11-20T11:45:38.894Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.894Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.894Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.894Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Existing timestamps: 5
[2025-11-20T11:45:38.894Z] Current count after filter: 5
[2025-11-20T11:45:38.894Z] Max requests allowed: 5
[2025-11-20T11:45:38.894Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:38.894Z] Current count: 5
[2025-11-20T11:45:38.894Z] Max allowed: 5
[2025-11-20T11:45:38.894Z] Retry after (seconds): 59
[2025-11-20T11:45:38.894Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:38.894Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639197641,
  "retryAfter": 59
}
[2025-11-20T11:45:38.898Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.899Z] Request URL: /auth/login
[2025-11-20T11:45:38.899Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.899Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Will use test ID?: true
[2025-11-20T11:45:38.899Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.899Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.899Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.899Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Existing timestamps: 5
[2025-11-20T11:45:38.899Z] Current count after filter: 5
[2025-11-20T11:45:38.899Z] Max requests allowed: 5
[2025-11-20T11:45:38.899Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:38.899Z] Current count: 5
[2025-11-20T11:45:38.899Z] Max allowed: 5
[2025-11-20T11:45:38.899Z] Retry after (seconds): 59
[2025-11-20T11:45:38.899Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:38.899Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639197271,
  "retryAfter": 59
}
[2025-11-20T11:45:38.906Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.906Z] Request URL: /auth/register
[2025-11-20T11:45:38.906Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.906Z] X-Test-ID header: register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.906Z] Will use test ID?: true
[2025-11-20T11:45:38.906Z] ‚úÖ Using test identifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.907Z] Got identifier from getClientIdentifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.907Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.907Z] Identifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] Key: register:test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] üìù Creating new entry for key: register:test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] Current count after filter: 0
[2025-11-20T11:45:38.907Z] Max requests allowed: 3
[2025-11-20T11:45:38.907Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.907Z] New count: 1
[2025-11-20T11:45:38.907Z] Remaining: 2
[2025-11-20T11:45:38.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.907Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198907
}
[2025-11-20T11:45:38.924Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.925Z] Request URL: /auth/login
[2025-11-20T11:45:38.925Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.925Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Will use test ID?: true
[2025-11-20T11:45:38.925Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.925Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.925Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.925Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] üìù Creating new entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Current count after filter: 0
[2025-11-20T11:45:38.925Z] Max requests allowed: 5
[2025-11-20T11:45:38.925Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.925Z] New count: 1
[2025-11-20T11:45:38.925Z] Remaining: 4
[2025-11-20T11:45:38.925Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.925Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.012Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.012Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.013Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.013Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Will use test ID?: true
[2025-11-20T11:45:39.013Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.013Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.013Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.013Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Existing timestamps: 1
[2025-11-20T11:45:39.013Z] Current count after filter: 1
[2025-11-20T11:45:39.013Z] Max requests allowed: 5
[2025-11-20T11:45:39.013Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.013Z] New count: 2
[2025-11-20T11:45:39.013Z] Remaining: 3
[2025-11-20T11:45:39.013Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.013Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.152Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:39.153Z] Request URL: /auth/register
[2025-11-20T11:45:39.153Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.153Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Will use test ID?: true
[2025-11-20T11:45:39.153Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.153Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.153Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:39.153Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Existing timestamps: 3
[2025-11-20T11:45:39.153Z] Current count after filter: 3
[2025-11-20T11:45:39.153Z] Max requests allowed: 3
[2025-11-20T11:45:39.153Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:39.153Z] Current count: 3
[2025-11-20T11:45:39.153Z] Max allowed: 3
[2025-11-20T11:45:39.153Z] Retry after (seconds): 59
[2025-11-20T11:45:39.153Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:39.153Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639198046,
  "retryAfter": 59
}
[2025-11-20T11:45:39.165Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.165Z] Request URL: /auth/login
[2025-11-20T11:45:39.165Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.165Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Will use test ID?: true
[2025-11-20T11:45:39.165Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.165Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.165Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.165Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] üìù Creating new entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Current count after filter: 0
[2025-11-20T11:45:39.165Z] Max requests allowed: 5
[2025-11-20T11:45:39.165Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.166Z] New count: 1
[2025-11-20T11:45:39.166Z] Remaining: 4
[2025-11-20T11:45:39.166Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.166Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.172Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.172Z] Request URL: /auth/login
[2025-11-20T11:45:39.172Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.172Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Will use test ID?: true
[2025-11-20T11:45:39.172Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.172Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.172Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.172Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Existing timestamps: 1
[2025-11-20T11:45:39.172Z] Current count after filter: 1
[2025-11-20T11:45:39.172Z] Max requests allowed: 5
[2025-11-20T11:45:39.172Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.172Z] New count: 2
[2025-11-20T11:45:39.172Z] Remaining: 3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.172Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.271Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.272Z] Request URL: /auth/login
[2025-11-20T11:45:39.272Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.272Z] X-Test-ID header: headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Will use test ID?: true
[2025-11-20T11:45:39.272Z] ‚úÖ Using test identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.272Z] Got identifier from getClientIdentifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.272Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.272Z] Identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] üìù Creating new entry for key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Current count after filter: 0
[2025-11-20T11:45:39.272Z] Max requests allowed: 5
[2025-11-20T11:45:39.272Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.272Z] New count: 1
[2025-11-20T11:45:39.272Z] Remaining: 4
[2025-11-20T11:45:39.272Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.272Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199272
}
[2025-11-20T11:45:39.291Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.291Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.291Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.291Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.291Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.292Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.292Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Will use test ID?: true
[2025-11-20T11:45:39.292Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.292Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.292Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.292Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Existing timestamps: 2
[2025-11-20T11:45:39.292Z] Current count after filter: 2
[2025-11-20T11:45:39.292Z] Max requests allowed: 5
[2025-11-20T11:45:39.292Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.292Z] New count: 3
[2025-11-20T11:45:39.292Z] Remaining: 2
[2025-11-20T11:45:39.292Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.292Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.424Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.424Z] Request URL: /auth/login
[2025-11-20T11:45:39.424Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.424Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Will use test ID?: true
[2025-11-20T11:45:39.425Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.425Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.425Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.425Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Existing timestamps: 2
[2025-11-20T11:45:39.425Z] Current count after filter: 2
[2025-11-20T11:45:39.425Z] Max requests allowed: 5
[2025-11-20T11:45:39.425Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.425Z] New count: 3
[2025-11-20T11:45:39.425Z] Remaining: 2
[2025-11-20T11:45:39.425Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.425Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.478Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.478Z] Request URL: /auth/login
[2025-11-20T11:45:39.479Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.479Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Will use test ID?: true
[2025-11-20T11:45:39.479Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.479Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.479Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.479Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] üìñ Found existing entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Existing timestamps: 1
[2025-11-20T11:45:39.479Z] Current count after filter: 1
[2025-11-20T11:45:39.479Z] Max requests allowed: 5
[2025-11-20T11:45:39.479Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.479Z] New count: 2
[2025-11-20T11:45:39.479Z] Remaining: 3
[2025-11-20T11:45:39.479Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.480Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.507Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.508Z] Request URL: /auth/login
[2025-11-20T11:45:39.508Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.508Z] X-Test-ID header: headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Will use test ID?: true
[2025-11-20T11:45:39.508Z] ‚úÖ Using test identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.508Z] Got identifier from getClientIdentifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.508Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.508Z] Identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] üìñ Found existing entry for key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Existing timestamps: 1
[2025-11-20T11:45:39.508Z] Current count after filter: 1
[2025-11-20T11:45:39.508Z] Max requests allowed: 5
[2025-11-20T11:45:39.508Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.508Z] New count: 2
[2025-11-20T11:45:39.508Z] Remaining: 3
[2025-11-20T11:45:39.508Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.508Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639199272
}
[2025-11-20T11:45:39.558Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.559Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.559Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.559Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Will use test ID?: true
[2025-11-20T11:45:39.559Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.559Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.559Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Existing timestamps: 3
[2025-11-20T11:45:39.559Z] Current count after filter: 3
[2025-11-20T11:45:39.559Z] Max requests allowed: 5
[2025-11-20T11:45:39.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.559Z] New count: 4
[2025-11-20T11:45:39.559Z] Remaining: 1
[2025-11-20T11:45:39.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.559Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.672Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.672Z] Request URL: /auth/login
[2025-11-20T11:45:39.672Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.672Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.672Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.673Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.673Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Will use test ID?: true
[2025-11-20T11:45:39.673Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.673Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.673Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.673Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Existing timestamps: 3
[2025-11-20T11:45:39.673Z] Current count after filter: 3
[2025-11-20T11:45:39.673Z] Max requests allowed: 5
[2025-11-20T11:45:39.673Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.673Z] New count: 4
[2025-11-20T11:45:39.673Z] Remaining: 1
[2025-11-20T11:45:39.673Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.673Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.764Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.765Z] Request URL: /auth/login
[2025-11-20T11:45:39.765Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.765Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] Will use test ID?: true
[2025-11-20T11:45:39.765Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.765Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.765Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.766Z] üìñ Found existing entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.766Z] Existing timestamps: 2
[2025-11-20T11:45:39.766Z] Current count after filter: 2
[2025-11-20T11:45:39.766Z] Max requests allowed: 5
[2025-11-20T11:45:39.766Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.766Z] New count: 3
[2025-11-20T11:45:39.766Z] Remaining: 2
[2025-11-20T11:45:39.766Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.766Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.842Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.842Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.842Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.843Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Will use test ID?: true
[2025-11-20T11:45:39.843Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.843Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.843Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.843Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Existing timestamps: 4
[2025-11-20T11:45:39.843Z] Current count after filter: 4
[2025-11-20T11:45:39.843Z] Max requests allowed: 5
[2025-11-20T11:45:39.843Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.843Z] New count: 5
[2025-11-20T11:45:39.843Z] Remaining: 0
[2025-11-20T11:45:39.843Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.843Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.941Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.941Z] Request URL: /auth/login
[2025-11-20T11:45:39.942Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.942Z] X-Test-ID header: perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Will use test ID?: true
[2025-11-20T11:45:39.942Z] ‚úÖ Using test identifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.942Z] Got identifier from getClientIdentifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.942Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.942Z] Identifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Key: login:test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] üìù Creating new entry for key: login:test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Current count after filter: 0
[2025-11-20T11:45:39.942Z] Max requests allowed: 5
[2025-11-20T11:45:39.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.942Z] New count: 1
[2025-11-20T11:45:39.942Z] Remaining: 4
[2025-11-20T11:45:39.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.942Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199942
}
[2025-11-20T11:45:40.127Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:40.127Z] Request URL: /auth/login
[2025-11-20T11:45:40.127Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.127Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] Will use test ID?: true
[2025-11-20T11:45:40.127Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.127Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:40.128Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] Existing timestamps: 4
[2025-11-20T11:45:40.128Z] Current count after filter: 4
[2025-11-20T11:45:40.128Z] Max requests allowed: 5
[2025-11-20T11:45:40.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:40.128Z] New count: 5
[2025-11-20T11:45:40.128Z] Remaining: 0
[2025-11-20T11:45:40.128Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:40.128Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:40.439Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:40.439Z] Request URL: /auth/login
[2025-11-20T11:45:40.439Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.439Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] Will use test ID?: true
[2025-11-20T11:45:40.439Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.439Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.440Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:40.440Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] Existing timestamps: 5
[2025-11-20T11:45:40.440Z] Current count after filter: 5
[2025-11-20T11:45:40.440Z] Max requests allowed: 5
[2025-11-20T11:45:40.440Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:40.440Z] Current count: 5
[2025-11-20T11:45:40.440Z] Max allowed: 5
[2025-11-20T11:45:40.440Z] Retry after (seconds): 59
[2025-11-20T11:45:40.440Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:40.440Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639198925,
  "retryAfter": 59
}
[2025-11-20T11:45:40.442Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:40.442Z] Request URL: /auth/register
[2025-11-20T11:45:40.442Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.442Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Will use test ID?: true
[2025-11-20T11:45:40.442Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.442Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.442Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:40.442Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Key: register:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] üìù Creating new entry for key: register:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Current count after filter: 0
[2025-11-20T11:45:40.442Z] Max requests allowed: 3
[2025-11-20T11:45:40.442Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:40.442Z] New count: 1
[2025-11-20T11:45:40.442Z] Remaining: 2
[2025-11-20T11:45:40.442Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:40.442Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639200442
}
[2025-11-22T21:21:11.586Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.587Z] Identifier: test-allow-1763846471586
[2025-11-22T21:21:11.587Z] Key: login:test-allow-1763846471586
[2025-11-22T21:21:11.587Z] üìù Creating new entry for key: login:test-allow-1763846471586
[2025-11-22T21:21:11.587Z] Current count after filter: 0
[2025-11-22T21:21:11.587Z] Max requests allowed: 5
[2025-11-22T21:21:11.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.587Z] New count: 1
[2025-11-22T21:21:11.587Z] Remaining: 4
[2025-11-22T21:21:11.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.588Z] Identifier: test-allow-1763846471586
[2025-11-22T21:21:11.588Z] Key: login:test-allow-1763846471586
[2025-11-22T21:21:11.588Z] üìñ Found existing entry for key: login:test-allow-1763846471586
[2025-11-22T21:21:11.588Z] Existing timestamps: 1
[2025-11-22T21:21:11.588Z] Current count after filter: 1
[2025-11-22T21:21:11.588Z] Max requests allowed: 5
[2025-11-22T21:21:11.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.589Z] New count: 2
[2025-11-22T21:21:11.589Z] Remaining: 3
[2025-11-22T21:21:11.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.589Z] Identifier: test-allow-1763846471586
[2025-11-22T21:21:11.589Z] Key: login:test-allow-1763846471586
[2025-11-22T21:21:11.589Z] üìñ Found existing entry for key: login:test-allow-1763846471586
[2025-11-22T21:21:11.589Z] Existing timestamps: 2
[2025-11-22T21:21:11.589Z] Current count after filter: 2
[2025-11-22T21:21:11.589Z] Max requests allowed: 5
[2025-11-22T21:21:11.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.589Z] New count: 3
[2025-11-22T21:21:11.589Z] Remaining: 2
[2025-11-22T21:21:11.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.589Z] Identifier: test-allow-1763846471586
[2025-11-22T21:21:11.589Z] Key: login:test-allow-1763846471586
[2025-11-22T21:21:11.589Z] üìñ Found existing entry for key: login:test-allow-1763846471586
[2025-11-22T21:21:11.589Z] Existing timestamps: 3
[2025-11-22T21:21:11.589Z] Current count after filter: 3
[2025-11-22T21:21:11.589Z] Max requests allowed: 5
[2025-11-22T21:21:11.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.589Z] New count: 4
[2025-11-22T21:21:11.589Z] Remaining: 1
[2025-11-22T21:21:11.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.590Z] Identifier: test-allow-1763846471586
[2025-11-22T21:21:11.590Z] Key: login:test-allow-1763846471586
[2025-11-22T21:21:11.590Z] üìñ Found existing entry for key: login:test-allow-1763846471586
[2025-11-22T21:21:11.590Z] Existing timestamps: 4
[2025-11-22T21:21:11.590Z] Current count after filter: 4
[2025-11-22T21:21:11.590Z] Max requests allowed: 5
[2025-11-22T21:21:11.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.590Z] New count: 5
[2025-11-22T21:21:11.590Z] Remaining: 0
[2025-11-22T21:21:11.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.591Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.591Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.591Z] üìù Creating new entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.591Z] Current count after filter: 0
[2025-11-22T21:21:11.591Z] Max requests allowed: 5
[2025-11-22T21:21:11.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.591Z] New count: 1
[2025-11-22T21:21:11.591Z] Remaining: 4
[2025-11-22T21:21:11.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.592Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.592Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.592Z] üìñ Found existing entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.592Z] Existing timestamps: 1
[2025-11-22T21:21:11.592Z] Current count after filter: 1
[2025-11-22T21:21:11.592Z] Max requests allowed: 5
[2025-11-22T21:21:11.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.592Z] New count: 2
[2025-11-22T21:21:11.592Z] Remaining: 3
[2025-11-22T21:21:11.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.592Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.592Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.592Z] üìñ Found existing entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.592Z] Existing timestamps: 2
[2025-11-22T21:21:11.592Z] Current count after filter: 2
[2025-11-22T21:21:11.592Z] Max requests allowed: 5
[2025-11-22T21:21:11.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.592Z] New count: 3
[2025-11-22T21:21:11.592Z] Remaining: 2
[2025-11-22T21:21:11.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.593Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.593Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] üìñ Found existing entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] Existing timestamps: 3
[2025-11-22T21:21:11.593Z] Current count after filter: 3
[2025-11-22T21:21:11.593Z] Max requests allowed: 5
[2025-11-22T21:21:11.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.593Z] New count: 4
[2025-11-22T21:21:11.593Z] Remaining: 1
[2025-11-22T21:21:11.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.593Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.593Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] üìñ Found existing entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] Existing timestamps: 4
[2025-11-22T21:21:11.593Z] Current count after filter: 4
[2025-11-22T21:21:11.593Z] Max requests allowed: 5
[2025-11-22T21:21:11.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.593Z] New count: 5
[2025-11-22T21:21:11.593Z] Remaining: 0
[2025-11-22T21:21:11.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.593Z] Identifier: test-block-1763846471591
[2025-11-22T21:21:11.593Z] Key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] üìñ Found existing entry for key: login:test-block-1763846471591
[2025-11-22T21:21:11.593Z] Existing timestamps: 5
[2025-11-22T21:21:11.593Z] Current count after filter: 5
[2025-11-22T21:21:11.594Z] Max requests allowed: 5
[2025-11-22T21:21:11.594Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:21:11.594Z] Current count: 5
[2025-11-22T21:21:11.594Z] Max allowed: 5
[2025-11-22T21:21:11.594Z] Retry after (seconds): 60
[2025-11-22T21:21:11.594Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:21:11.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.594Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:21:11.594Z] Identifier: test-reset-1763846471594
[2025-11-22T21:21:11.594Z] Key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.594Z] üìù Creating new entry for key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.594Z] Current count after filter: 0
[2025-11-22T21:21:11.594Z] Max requests allowed: 2
[2025-11-22T21:21:11.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.594Z] New count: 1
[2025-11-22T21:21:11.594Z] Remaining: 1
[2025-11-22T21:21:11.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.594Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:21:11.594Z] Identifier: test-reset-1763846471594
[2025-11-22T21:21:11.595Z] Key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.595Z] üìñ Found existing entry for key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.595Z] Existing timestamps: 1
[2025-11-22T21:21:11.595Z] Current count after filter: 1
[2025-11-22T21:21:11.595Z] Max requests allowed: 2
[2025-11-22T21:21:11.595Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.595Z] New count: 2
[2025-11-22T21:21:11.595Z] Remaining: 0
[2025-11-22T21:21:11.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.595Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:21:11.595Z] Identifier: test-reset-1763846471594
[2025-11-22T21:21:11.595Z] Key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.595Z] üìñ Found existing entry for key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.595Z] Existing timestamps: 2
[2025-11-22T21:21:11.595Z] Current count after filter: 2
[2025-11-22T21:21:11.595Z] Max requests allowed: 2
[2025-11-22T21:21:11.595Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:21:11.595Z] Current count: 2
[2025-11-22T21:21:11.595Z] Max allowed: 2
[2025-11-22T21:21:11.595Z] Retry after (seconds): 1
[2025-11-22T21:21:11.595Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:21:11.747Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.747Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:21:11.747Z] Identifier: test-reset-1763846471594
[2025-11-22T21:21:11.747Z] Key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.747Z] üìñ Found existing entry for key: test-reset:test-reset-1763846471594
[2025-11-22T21:21:11.747Z] Existing timestamps: 2
[2025-11-22T21:21:11.747Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:21:11.747Z] Current count after filter: 0
[2025-11-22T21:21:11.747Z] Max requests allowed: 2
[2025-11-22T21:21:11.748Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.748Z] New count: 1
[2025-11-22T21:21:11.748Z] Remaining: 1
[2025-11-22T21:21:11.748Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.748Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.748Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.748Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.748Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.748Z] üìù Creating new entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.748Z] Current count after filter: 0
[2025-11-22T21:21:11.748Z] Max requests allowed: 5
[2025-11-22T21:21:11.748Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.748Z] New count: 1
[2025-11-22T21:21:11.748Z] Remaining: 4
[2025-11-22T21:21:11.748Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.749Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.749Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.749Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] üìñ Found existing entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] Existing timestamps: 1
[2025-11-22T21:21:11.749Z] Current count after filter: 1
[2025-11-22T21:21:11.749Z] Max requests allowed: 5
[2025-11-22T21:21:11.749Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.749Z] New count: 2
[2025-11-22T21:21:11.749Z] Remaining: 3
[2025-11-22T21:21:11.749Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.749Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.749Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.749Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] üìñ Found existing entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.749Z] Existing timestamps: 2
[2025-11-22T21:21:11.749Z] Current count after filter: 2
[2025-11-22T21:21:11.749Z] Max requests allowed: 5
[2025-11-22T21:21:11.749Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.749Z] New count: 3
[2025-11-22T21:21:11.749Z] Remaining: 2
[2025-11-22T21:21:11.749Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.750Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.750Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] üìñ Found existing entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] Existing timestamps: 3
[2025-11-22T21:21:11.750Z] Current count after filter: 3
[2025-11-22T21:21:11.750Z] Max requests allowed: 5
[2025-11-22T21:21:11.750Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.750Z] New count: 4
[2025-11-22T21:21:11.750Z] Remaining: 1
[2025-11-22T21:21:11.750Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.750Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.750Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] üìñ Found existing entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.750Z] Existing timestamps: 4
[2025-11-22T21:21:11.750Z] Current count after filter: 4
[2025-11-22T21:21:11.750Z] Max requests allowed: 5
[2025-11-22T21:21:11.750Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.751Z] New count: 5
[2025-11-22T21:21:11.751Z] Remaining: 0
[2025-11-22T21:21:11.751Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.751Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.751Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.751Z] Identifier: test-multi-1-1763846471748
[2025-11-22T21:21:11.751Z] Key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.751Z] üìñ Found existing entry for key: login:test-multi-1-1763846471748
[2025-11-22T21:21:11.751Z] Existing timestamps: 5
[2025-11-22T21:21:11.751Z] Current count after filter: 5
[2025-11-22T21:21:11.751Z] Max requests allowed: 5
[2025-11-22T21:21:11.751Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:21:11.752Z] Current count: 5
[2025-11-22T21:21:11.752Z] Max allowed: 5
[2025-11-22T21:21:11.752Z] Retry after (seconds): 60
[2025-11-22T21:21:11.752Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:21:11.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.752Z] Identifier: test-multi-2-1763846471748
[2025-11-22T21:21:11.752Z] Key: login:test-multi-2-1763846471748
[2025-11-22T21:21:11.752Z] üìù Creating new entry for key: login:test-multi-2-1763846471748
[2025-11-22T21:21:11.752Z] Current count after filter: 0
[2025-11-22T21:21:11.752Z] Max requests allowed: 5
[2025-11-22T21:21:11.752Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.752Z] New count: 1
[2025-11-22T21:21:11.752Z] Remaining: 4
[2025-11-22T21:21:11.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.753Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.753Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:21:11.753Z] Identifier: test-reset-time-1763846471753
[2025-11-22T21:21:11.753Z] Key: login:test-reset-time-1763846471753
[2025-11-22T21:21:11.753Z] üìù Creating new entry for key: login:test-reset-time-1763846471753
[2025-11-22T21:21:11.753Z] Current count after filter: 0
[2025-11-22T21:21:11.753Z] Max requests allowed: 5
[2025-11-22T21:21:11.753Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.753Z] New count: 1
[2025-11-22T21:21:11.753Z] Remaining: 4
[2025-11-22T21:21:11.754Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.756Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:21:11.756Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:21:11.756Z] E2E_TEST_MODE (env): true
[2025-11-22T21:21:11.756Z] E2E_TEST_MODE (final): true
[2025-11-22T21:21:11.756Z] X-Test-ID header: null
[2025-11-22T21:21:11.756Z] Will use test ID?: false
[2025-11-22T21:21:11.756Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:21:11.756Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:21:11.757Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (env): true
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (final): true
[2025-11-22T21:21:11.757Z] X-Test-ID header: null
[2025-11-22T21:21:11.757Z] Will use test ID?: false
[2025-11-22T21:21:11.757Z] Using real IP: 192.168.1.2
[2025-11-22T21:21:11.757Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:21:11.757Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (env): true
[2025-11-22T21:21:11.757Z] E2E_TEST_MODE (final): true
[2025-11-22T21:21:11.757Z] X-Test-ID header: null
[2025-11-22T21:21:11.757Z] Will use test ID?: false
[2025-11-22T21:21:11.757Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:21:11.757Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:21:11.757Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (env): true
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (final): true
[2025-11-22T21:21:11.758Z] X-Test-ID header: null
[2025-11-22T21:21:11.758Z] Will use test ID?: false
[2025-11-22T21:21:11.758Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:21:11.758Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:21:11.758Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (env): true
[2025-11-22T21:21:11.758Z] E2E_TEST_MODE (final): true
[2025-11-22T21:21:11.758Z] X-Test-ID header: null
[2025-11-22T21:21:11.758Z] Will use test ID?: false
[2025-11-22T21:21:11.758Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:21:11.758Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:21:11.759Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.759Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:21:11.759Z] Identifier: test-sliding-1763846471759
[2025-11-22T21:21:11.759Z] Key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.759Z] üìù Creating new entry for key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.759Z] Current count after filter: 0
[2025-11-22T21:21:11.759Z] Max requests allowed: 3
[2025-11-22T21:21:11.759Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.759Z] New count: 1
[2025-11-22T21:21:11.759Z] Remaining: 2
[2025-11-22T21:21:11.759Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.860Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.860Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:21:11.860Z] Identifier: test-sliding-1763846471759
[2025-11-22T21:21:11.860Z] Key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.860Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.860Z] Existing timestamps: 1
[2025-11-22T21:21:11.861Z] Current count after filter: 1
[2025-11-22T21:21:11.861Z] Max requests allowed: 3
[2025-11-22T21:21:11.861Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.861Z] New count: 2
[2025-11-22T21:21:11.861Z] Remaining: 1
[2025-11-22T21:21:11.861Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.962Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.962Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:21:11.962Z] Identifier: test-sliding-1763846471759
[2025-11-22T21:21:11.962Z] Key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.962Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846471759
[2025-11-22T21:21:11.962Z] Existing timestamps: 2
[2025-11-22T21:21:11.962Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:21:11.962Z] Current count after filter: 1
[2025-11-22T21:21:11.963Z] Max requests allowed: 3
[2025-11-22T21:21:11.963Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.963Z] New count: 2
[2025-11-22T21:21:11.963Z] Remaining: 1
[2025-11-22T21:21:11.963Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.963Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.963Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:21:11.963Z] Identifier: test-format-allowed-1763846471963
[2025-11-22T21:21:11.963Z] Key: register:test-format-allowed-1763846471963
[2025-11-22T21:21:11.963Z] üìù Creating new entry for key: register:test-format-allowed-1763846471963
[2025-11-22T21:21:11.963Z] Current count after filter: 0
[2025-11-22T21:21:11.963Z] Max requests allowed: 3
[2025-11-22T21:21:11.963Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.963Z] New count: 1
[2025-11-22T21:21:11.963Z] Remaining: 2
[2025-11-22T21:21:11.963Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.964Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.964Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:21:11.964Z] Identifier: test-format-blocked-1763846471964
[2025-11-22T21:21:11.964Z] Key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.964Z] üìù Creating new entry for key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.964Z] Current count after filter: 0
[2025-11-22T21:21:11.964Z] Max requests allowed: 3
[2025-11-22T21:21:11.964Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.964Z] New count: 1
[2025-11-22T21:21:11.964Z] Remaining: 2
[2025-11-22T21:21:11.964Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.964Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.964Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:21:11.964Z] Identifier: test-format-blocked-1763846471964
[2025-11-22T21:21:11.964Z] Key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.964Z] üìñ Found existing entry for key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.965Z] Existing timestamps: 1
[2025-11-22T21:21:11.965Z] Current count after filter: 1
[2025-11-22T21:21:11.965Z] Max requests allowed: 3
[2025-11-22T21:21:11.965Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.965Z] New count: 2
[2025-11-22T21:21:11.965Z] Remaining: 1
[2025-11-22T21:21:11.965Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.965Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.965Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:21:11.965Z] Identifier: test-format-blocked-1763846471964
[2025-11-22T21:21:11.965Z] Key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.965Z] üìñ Found existing entry for key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.965Z] Existing timestamps: 2
[2025-11-22T21:21:11.965Z] Current count after filter: 2
[2025-11-22T21:21:11.965Z] Max requests allowed: 3
[2025-11-22T21:21:11.965Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:21:11.965Z] New count: 3
[2025-11-22T21:21:11.965Z] Remaining: 0
[2025-11-22T21:21:11.965Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:21:11.965Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:21:11.965Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:21:11.965Z] Identifier: test-format-blocked-1763846471964
[2025-11-22T21:21:11.966Z] Key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.966Z] üìñ Found existing entry for key: register:test-format-blocked-1763846471964
[2025-11-22T21:21:11.966Z] Existing timestamps: 3
[2025-11-22T21:21:11.966Z] Current count after filter: 3
[2025-11-22T21:21:11.966Z] Max requests allowed: 3
[2025-11-22T21:21:11.966Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:21:11.966Z] Current count: 3
[2025-11-22T21:21:11.966Z] Max allowed: 3
[2025-11-22T21:21:11.966Z] Retry after (seconds): 60
[2025-11-22T21:21:11.966Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:22:36.391Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.392Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.392Z] Identifier: test-allow-1763846556391
[2025-11-22T21:22:36.392Z] Key: login:test-allow-1763846556391
[2025-11-22T21:22:36.392Z] üìù Creating new entry for key: login:test-allow-1763846556391
[2025-11-22T21:22:36.392Z] Current count after filter: 0
[2025-11-22T21:22:36.392Z] Max requests allowed: 5
[2025-11-22T21:22:36.392Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.392Z] New count: 1
[2025-11-22T21:22:36.392Z] Remaining: 4
[2025-11-22T21:22:36.392Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.393Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.393Z] Identifier: test-allow-1763846556391
[2025-11-22T21:22:36.393Z] Key: login:test-allow-1763846556391
[2025-11-22T21:22:36.393Z] üìñ Found existing entry for key: login:test-allow-1763846556391
[2025-11-22T21:22:36.393Z] Existing timestamps: 1
[2025-11-22T21:22:36.393Z] Current count after filter: 1
[2025-11-22T21:22:36.393Z] Max requests allowed: 5
[2025-11-22T21:22:36.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.393Z] New count: 2
[2025-11-22T21:22:36.393Z] Remaining: 3
[2025-11-22T21:22:36.393Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.393Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.393Z] Identifier: test-allow-1763846556391
[2025-11-22T21:22:36.393Z] Key: login:test-allow-1763846556391
[2025-11-22T21:22:36.393Z] üìñ Found existing entry for key: login:test-allow-1763846556391
[2025-11-22T21:22:36.393Z] Existing timestamps: 2
[2025-11-22T21:22:36.393Z] Current count after filter: 2
[2025-11-22T21:22:36.393Z] Max requests allowed: 5
[2025-11-22T21:22:36.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.393Z] New count: 3
[2025-11-22T21:22:36.394Z] Remaining: 2
[2025-11-22T21:22:36.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.394Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.394Z] Identifier: test-allow-1763846556391
[2025-11-22T21:22:36.394Z] Key: login:test-allow-1763846556391
[2025-11-22T21:22:36.394Z] üìñ Found existing entry for key: login:test-allow-1763846556391
[2025-11-22T21:22:36.394Z] Existing timestamps: 3
[2025-11-22T21:22:36.394Z] Current count after filter: 3
[2025-11-22T21:22:36.394Z] Max requests allowed: 5
[2025-11-22T21:22:36.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.394Z] New count: 4
[2025-11-22T21:22:36.394Z] Remaining: 1
[2025-11-22T21:22:36.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.394Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.395Z] Identifier: test-allow-1763846556391
[2025-11-22T21:22:36.395Z] Key: login:test-allow-1763846556391
[2025-11-22T21:22:36.395Z] üìñ Found existing entry for key: login:test-allow-1763846556391
[2025-11-22T21:22:36.395Z] Existing timestamps: 4
[2025-11-22T21:22:36.395Z] Current count after filter: 4
[2025-11-22T21:22:36.395Z] Max requests allowed: 5
[2025-11-22T21:22:36.395Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.395Z] New count: 5
[2025-11-22T21:22:36.395Z] Remaining: 0
[2025-11-22T21:22:36.395Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.396Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.396Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.396Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.397Z] üìù Creating new entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.397Z] Current count after filter: 0
[2025-11-22T21:22:36.397Z] Max requests allowed: 5
[2025-11-22T21:22:36.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.397Z] New count: 1
[2025-11-22T21:22:36.397Z] Remaining: 4
[2025-11-22T21:22:36.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.397Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.397Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.397Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.397Z] üìñ Found existing entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.397Z] Existing timestamps: 1
[2025-11-22T21:22:36.397Z] Current count after filter: 1
[2025-11-22T21:22:36.397Z] Max requests allowed: 5
[2025-11-22T21:22:36.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.397Z] New count: 2
[2025-11-22T21:22:36.398Z] Remaining: 3
[2025-11-22T21:22:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.398Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.398Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.398Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.398Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.398Z] üìñ Found existing entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.398Z] Existing timestamps: 2
[2025-11-22T21:22:36.398Z] Current count after filter: 2
[2025-11-22T21:22:36.398Z] Max requests allowed: 5
[2025-11-22T21:22:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.398Z] New count: 3
[2025-11-22T21:22:36.398Z] Remaining: 2
[2025-11-22T21:22:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.398Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.398Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.398Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.398Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.398Z] üìñ Found existing entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.398Z] Existing timestamps: 3
[2025-11-22T21:22:36.398Z] Current count after filter: 3
[2025-11-22T21:22:36.398Z] Max requests allowed: 5
[2025-11-22T21:22:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.398Z] New count: 4
[2025-11-22T21:22:36.399Z] Remaining: 1
[2025-11-22T21:22:36.399Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.399Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.399Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.399Z] üìñ Found existing entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.399Z] Existing timestamps: 4
[2025-11-22T21:22:36.399Z] Current count after filter: 4
[2025-11-22T21:22:36.399Z] Max requests allowed: 5
[2025-11-22T21:22:36.399Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.399Z] New count: 5
[2025-11-22T21:22:36.399Z] Remaining: 0
[2025-11-22T21:22:36.399Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.399Z] Identifier: test-block-1763846556396
[2025-11-22T21:22:36.399Z] Key: login:test-block-1763846556396
[2025-11-22T21:22:36.399Z] üìñ Found existing entry for key: login:test-block-1763846556396
[2025-11-22T21:22:36.399Z] Existing timestamps: 5
[2025-11-22T21:22:36.399Z] Current count after filter: 5
[2025-11-22T21:22:36.399Z] Max requests allowed: 5
[2025-11-22T21:22:36.399Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:22:36.399Z] Current count: 5
[2025-11-22T21:22:36.399Z] Max allowed: 5
[2025-11-22T21:22:36.399Z] Retry after (seconds): 60
[2025-11-22T21:22:36.399Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:22:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.400Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:22:36.400Z] Identifier: test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] üìù Creating new entry for key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Current count after filter: 0
[2025-11-22T21:22:36.400Z] Max requests allowed: 2
[2025-11-22T21:22:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.400Z] New count: 1
[2025-11-22T21:22:36.400Z] Remaining: 1
[2025-11-22T21:22:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.400Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:22:36.400Z] Identifier: test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] üìñ Found existing entry for key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Existing timestamps: 1
[2025-11-22T21:22:36.400Z] Current count after filter: 1
[2025-11-22T21:22:36.400Z] Max requests allowed: 2
[2025-11-22T21:22:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.400Z] New count: 2
[2025-11-22T21:22:36.400Z] Remaining: 0
[2025-11-22T21:22:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.400Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:22:36.400Z] Identifier: test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] üìñ Found existing entry for key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.400Z] Existing timestamps: 2
[2025-11-22T21:22:36.400Z] Current count after filter: 2
[2025-11-22T21:22:36.400Z] Max requests allowed: 2
[2025-11-22T21:22:36.400Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:22:36.401Z] Current count: 2
[2025-11-22T21:22:36.401Z] Max allowed: 2
[2025-11-22T21:22:36.401Z] Retry after (seconds): 1
[2025-11-22T21:22:36.401Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:22:36.551Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.551Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:22:36.552Z] Identifier: test-reset-1763846556400
[2025-11-22T21:22:36.552Z] Key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.552Z] üìñ Found existing entry for key: test-reset:test-reset-1763846556400
[2025-11-22T21:22:36.552Z] Existing timestamps: 2
[2025-11-22T21:22:36.552Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:22:36.552Z] Current count after filter: 0
[2025-11-22T21:22:36.552Z] Max requests allowed: 2
[2025-11-22T21:22:36.552Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.552Z] New count: 1
[2025-11-22T21:22:36.552Z] Remaining: 1
[2025-11-22T21:22:36.552Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.552Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.552Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.552Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.552Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.552Z] üìù Creating new entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.552Z] Current count after filter: 0
[2025-11-22T21:22:36.552Z] Max requests allowed: 5
[2025-11-22T21:22:36.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.553Z] New count: 1
[2025-11-22T21:22:36.553Z] Remaining: 4
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.553Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] üìñ Found existing entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Existing timestamps: 1
[2025-11-22T21:22:36.553Z] Current count after filter: 1
[2025-11-22T21:22:36.553Z] Max requests allowed: 5
[2025-11-22T21:22:36.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.553Z] New count: 2
[2025-11-22T21:22:36.553Z] Remaining: 3
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.553Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] üìñ Found existing entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Existing timestamps: 2
[2025-11-22T21:22:36.553Z] Current count after filter: 2
[2025-11-22T21:22:36.553Z] Max requests allowed: 5
[2025-11-22T21:22:36.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.553Z] New count: 3
[2025-11-22T21:22:36.553Z] Remaining: 2
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.553Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] üìñ Found existing entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.553Z] Existing timestamps: 3
[2025-11-22T21:22:36.554Z] Current count after filter: 3
[2025-11-22T21:22:36.554Z] Max requests allowed: 5
[2025-11-22T21:22:36.554Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.554Z] New count: 4
[2025-11-22T21:22:36.554Z] Remaining: 1
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.554Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.554Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] üìñ Found existing entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] Existing timestamps: 4
[2025-11-22T21:22:36.554Z] Current count after filter: 4
[2025-11-22T21:22:36.554Z] Max requests allowed: 5
[2025-11-22T21:22:36.554Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.554Z] New count: 5
[2025-11-22T21:22:36.554Z] Remaining: 0
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.554Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.554Z] Identifier: test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] Key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] üìñ Found existing entry for key: login:test-multi-1-1763846556552
[2025-11-22T21:22:36.554Z] Existing timestamps: 5
[2025-11-22T21:22:36.554Z] Current count after filter: 5
[2025-11-22T21:22:36.554Z] Max requests allowed: 5
[2025-11-22T21:22:36.554Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:22:36.554Z] Current count: 5
[2025-11-22T21:22:36.554Z] Max allowed: 5
[2025-11-22T21:22:36.554Z] Retry after (seconds): 60
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:22:36.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.554Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.554Z] Identifier: test-multi-2-1763846556552
[2025-11-22T21:22:36.555Z] Key: login:test-multi-2-1763846556552
[2025-11-22T21:22:36.555Z] üìù Creating new entry for key: login:test-multi-2-1763846556552
[2025-11-22T21:22:36.555Z] Current count after filter: 0
[2025-11-22T21:22:36.555Z] Max requests allowed: 5
[2025-11-22T21:22:36.555Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.555Z] New count: 1
[2025-11-22T21:22:36.555Z] Remaining: 4
[2025-11-22T21:22:36.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.555Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.555Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:22:36.555Z] Identifier: test-reset-time-1763846556555
[2025-11-22T21:22:36.555Z] Key: login:test-reset-time-1763846556555
[2025-11-22T21:22:36.555Z] üìù Creating new entry for key: login:test-reset-time-1763846556555
[2025-11-22T21:22:36.555Z] Current count after filter: 0
[2025-11-22T21:22:36.555Z] Max requests allowed: 5
[2025-11-22T21:22:36.555Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.555Z] New count: 1
[2025-11-22T21:22:36.555Z] Remaining: 4
[2025-11-22T21:22:36.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (env): true
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (final): true
[2025-11-22T21:22:36.557Z] X-Test-ID header: null
[2025-11-22T21:22:36.557Z] Will use test ID?: false
[2025-11-22T21:22:36.557Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (env): true
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (final): true
[2025-11-22T21:22:36.557Z] X-Test-ID header: null
[2025-11-22T21:22:36.557Z] Will use test ID?: false
[2025-11-22T21:22:36.557Z] Using real IP: 192.168.1.2
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (env): true
[2025-11-22T21:22:36.557Z] E2E_TEST_MODE (final): true
[2025-11-22T21:22:36.557Z] X-Test-ID header: null
[2025-11-22T21:22:36.557Z] Will use test ID?: false
[2025-11-22T21:22:36.557Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:22:36.557Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:22:36.558Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:22:36.558Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:22:36.558Z] E2E_TEST_MODE (env): true
[2025-11-22T21:22:36.558Z] E2E_TEST_MODE (final): true
[2025-11-22T21:22:36.558Z] X-Test-ID header: null
[2025-11-22T21:22:36.558Z] Will use test ID?: false
[2025-11-22T21:22:36.558Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:22:36.558Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:22:36.559Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:22:36.559Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:22:36.559Z] E2E_TEST_MODE (env): true
[2025-11-22T21:22:36.559Z] E2E_TEST_MODE (final): true
[2025-11-22T21:22:36.559Z] X-Test-ID header: null
[2025-11-22T21:22:36.559Z] Will use test ID?: false
[2025-11-22T21:22:36.559Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:22:36.559Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:22:36.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.559Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:22:36.559Z] Identifier: test-sliding-1763846556559
[2025-11-22T21:22:36.559Z] Key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.559Z] üìù Creating new entry for key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.559Z] Current count after filter: 0
[2025-11-22T21:22:36.559Z] Max requests allowed: 3
[2025-11-22T21:22:36.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.559Z] New count: 1
[2025-11-22T21:22:36.559Z] Remaining: 2
[2025-11-22T21:22:36.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.660Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.660Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:22:36.660Z] Identifier: test-sliding-1763846556559
[2025-11-22T21:22:36.660Z] Key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.660Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.660Z] Existing timestamps: 1
[2025-11-22T21:22:36.660Z] Current count after filter: 1
[2025-11-22T21:22:36.660Z] Max requests allowed: 3
[2025-11-22T21:22:36.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.660Z] New count: 2
[2025-11-22T21:22:36.660Z] Remaining: 1
[2025-11-22T21:22:36.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.762Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:22:36.762Z] Identifier: test-sliding-1763846556559
[2025-11-22T21:22:36.762Z] Key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.762Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846556559
[2025-11-22T21:22:36.762Z] Existing timestamps: 2
[2025-11-22T21:22:36.762Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:22:36.762Z] Current count after filter: 1
[2025-11-22T21:22:36.762Z] Max requests allowed: 3
[2025-11-22T21:22:36.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.762Z] New count: 2
[2025-11-22T21:22:36.762Z] Remaining: 1
[2025-11-22T21:22:36.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.762Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:22:36.762Z] Identifier: test-format-allowed-1763846556762
[2025-11-22T21:22:36.762Z] Key: register:test-format-allowed-1763846556762
[2025-11-22T21:22:36.762Z] üìù Creating new entry for key: register:test-format-allowed-1763846556762
[2025-11-22T21:22:36.763Z] Current count after filter: 0
[2025-11-22T21:22:36.763Z] Max requests allowed: 3
[2025-11-22T21:22:36.763Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.763Z] New count: 1
[2025-11-22T21:22:36.763Z] Remaining: 2
[2025-11-22T21:22:36.763Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.763Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.763Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:22:36.763Z] Identifier: test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] Key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] üìù Creating new entry for key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] Current count after filter: 0
[2025-11-22T21:22:36.763Z] Max requests allowed: 3
[2025-11-22T21:22:36.763Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.763Z] New count: 1
[2025-11-22T21:22:36.763Z] Remaining: 2
[2025-11-22T21:22:36.763Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.763Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.763Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:22:36.763Z] Identifier: test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] Key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] üìñ Found existing entry for key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.763Z] Existing timestamps: 1
[2025-11-22T21:22:36.763Z] Current count after filter: 1
[2025-11-22T21:22:36.763Z] Max requests allowed: 3
[2025-11-22T21:22:36.763Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.764Z] New count: 2
[2025-11-22T21:22:36.764Z] Remaining: 1
[2025-11-22T21:22:36.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.764Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:22:36.764Z] Identifier: test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] Key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] üìñ Found existing entry for key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] Existing timestamps: 2
[2025-11-22T21:22:36.764Z] Current count after filter: 2
[2025-11-22T21:22:36.764Z] Max requests allowed: 3
[2025-11-22T21:22:36.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:22:36.764Z] New count: 3
[2025-11-22T21:22:36.764Z] Remaining: 0
[2025-11-22T21:22:36.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:22:36.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:22:36.764Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:22:36.764Z] Identifier: test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] Key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] üìñ Found existing entry for key: register:test-format-blocked-1763846556763
[2025-11-22T21:22:36.764Z] Existing timestamps: 3
[2025-11-22T21:22:36.764Z] Current count after filter: 3
[2025-11-22T21:22:36.764Z] Max requests allowed: 3
[2025-11-22T21:22:36.764Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:22:36.764Z] Current count: 3
[2025-11-22T21:22:36.764Z] Max allowed: 3
[2025-11-22T21:22:36.764Z] Retry after (seconds): 60
[2025-11-22T21:22:36.764Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:26:12.031Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.032Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.032Z] Identifier: test-allow-1763846772031
[2025-11-22T21:26:12.032Z] Key: login:test-allow-1763846772031
[2025-11-22T21:26:12.032Z] üìù Creating new entry for key: login:test-allow-1763846772031
[2025-11-22T21:26:12.032Z] Current count after filter: 0
[2025-11-22T21:26:12.032Z] Max requests allowed: 5
[2025-11-22T21:26:12.032Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.032Z] New count: 1
[2025-11-22T21:26:12.032Z] Remaining: 4
[2025-11-22T21:26:12.032Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.033Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.033Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.033Z] Identifier: test-allow-1763846772031
[2025-11-22T21:26:12.033Z] Key: login:test-allow-1763846772031
[2025-11-22T21:26:12.033Z] üìñ Found existing entry for key: login:test-allow-1763846772031
[2025-11-22T21:26:12.033Z] Existing timestamps: 1
[2025-11-22T21:26:12.033Z] Current count after filter: 1
[2025-11-22T21:26:12.033Z] Max requests allowed: 5
[2025-11-22T21:26:12.033Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.033Z] New count: 2
[2025-11-22T21:26:12.033Z] Remaining: 3
[2025-11-22T21:26:12.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.033Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.033Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.033Z] Identifier: test-allow-1763846772031
[2025-11-22T21:26:12.033Z] Key: login:test-allow-1763846772031
[2025-11-22T21:26:12.033Z] üìñ Found existing entry for key: login:test-allow-1763846772031
[2025-11-22T21:26:12.033Z] Existing timestamps: 2
[2025-11-22T21:26:12.034Z] Current count after filter: 2
[2025-11-22T21:26:12.034Z] Max requests allowed: 5
[2025-11-22T21:26:12.034Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.034Z] New count: 3
[2025-11-22T21:26:12.034Z] Remaining: 2
[2025-11-22T21:26:12.034Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.034Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.034Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.034Z] Identifier: test-allow-1763846772031
[2025-11-22T21:26:12.034Z] Key: login:test-allow-1763846772031
[2025-11-22T21:26:12.034Z] üìñ Found existing entry for key: login:test-allow-1763846772031
[2025-11-22T21:26:12.034Z] Existing timestamps: 3
[2025-11-22T21:26:12.034Z] Current count after filter: 3
[2025-11-22T21:26:12.034Z] Max requests allowed: 5
[2025-11-22T21:26:12.034Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.034Z] New count: 4
[2025-11-22T21:26:12.034Z] Remaining: 1
[2025-11-22T21:26:12.034Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.034Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.034Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.034Z] Identifier: test-allow-1763846772031
[2025-11-22T21:26:12.034Z] Key: login:test-allow-1763846772031
[2025-11-22T21:26:12.034Z] üìñ Found existing entry for key: login:test-allow-1763846772031
[2025-11-22T21:26:12.034Z] Existing timestamps: 4
[2025-11-22T21:26:12.034Z] Current count after filter: 4
[2025-11-22T21:26:12.034Z] Max requests allowed: 5
[2025-11-22T21:26:12.034Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.034Z] New count: 5
[2025-11-22T21:26:12.034Z] Remaining: 0
[2025-11-22T21:26:12.034Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.035Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.035Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.035Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.035Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.035Z] üìù Creating new entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.035Z] Current count after filter: 0
[2025-11-22T21:26:12.035Z] Max requests allowed: 5
[2025-11-22T21:26:12.035Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.035Z] New count: 1
[2025-11-22T21:26:12.035Z] Remaining: 4
[2025-11-22T21:26:12.035Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.035Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.035Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.035Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.036Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] üìñ Found existing entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] Existing timestamps: 1
[2025-11-22T21:26:12.036Z] Current count after filter: 1
[2025-11-22T21:26:12.036Z] Max requests allowed: 5
[2025-11-22T21:26:12.036Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.036Z] New count: 2
[2025-11-22T21:26:12.036Z] Remaining: 3
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.036Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.036Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.036Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] üìñ Found existing entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] Existing timestamps: 2
[2025-11-22T21:26:12.036Z] Current count after filter: 2
[2025-11-22T21:26:12.036Z] Max requests allowed: 5
[2025-11-22T21:26:12.036Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.036Z] New count: 3
[2025-11-22T21:26:12.036Z] Remaining: 2
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.036Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.036Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.036Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] üìñ Found existing entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.036Z] Existing timestamps: 3
[2025-11-22T21:26:12.036Z] Current count after filter: 3
[2025-11-22T21:26:12.036Z] Max requests allowed: 5
[2025-11-22T21:26:12.036Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.036Z] New count: 4
[2025-11-22T21:26:12.036Z] Remaining: 1
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.036Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.036Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.037Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.037Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.037Z] üìñ Found existing entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.037Z] Existing timestamps: 4
[2025-11-22T21:26:12.037Z] Current count after filter: 4
[2025-11-22T21:26:12.037Z] Max requests allowed: 5
[2025-11-22T21:26:12.037Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.037Z] New count: 5
[2025-11-22T21:26:12.037Z] Remaining: 0
[2025-11-22T21:26:12.037Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.037Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.037Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.037Z] Identifier: test-block-1763846772035
[2025-11-22T21:26:12.037Z] Key: login:test-block-1763846772035
[2025-11-22T21:26:12.037Z] üìñ Found existing entry for key: login:test-block-1763846772035
[2025-11-22T21:26:12.037Z] Existing timestamps: 5
[2025-11-22T21:26:12.037Z] Current count after filter: 5
[2025-11-22T21:26:12.037Z] Max requests allowed: 5
[2025-11-22T21:26:12.037Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:26:12.037Z] Current count: 5
[2025-11-22T21:26:12.037Z] Max allowed: 5
[2025-11-22T21:26:12.037Z] Retry after (seconds): 60
[2025-11-22T21:26:12.037Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:26:12.038Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.038Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:26:12.038Z] Identifier: test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] üìù Creating new entry for key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Current count after filter: 0
[2025-11-22T21:26:12.038Z] Max requests allowed: 2
[2025-11-22T21:26:12.038Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.038Z] New count: 1
[2025-11-22T21:26:12.038Z] Remaining: 1
[2025-11-22T21:26:12.038Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.038Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.038Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:26:12.038Z] Identifier: test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] üìñ Found existing entry for key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Existing timestamps: 1
[2025-11-22T21:26:12.038Z] Current count after filter: 1
[2025-11-22T21:26:12.038Z] Max requests allowed: 2
[2025-11-22T21:26:12.038Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.038Z] New count: 2
[2025-11-22T21:26:12.038Z] Remaining: 0
[2025-11-22T21:26:12.038Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.038Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.038Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:26:12.038Z] Identifier: test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] üìñ Found existing entry for key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.038Z] Existing timestamps: 2
[2025-11-22T21:26:12.038Z] Current count after filter: 2
[2025-11-22T21:26:12.039Z] Max requests allowed: 2
[2025-11-22T21:26:12.039Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:26:12.039Z] Current count: 2
[2025-11-22T21:26:12.039Z] Max allowed: 2
[2025-11-22T21:26:12.039Z] Retry after (seconds): 1
[2025-11-22T21:26:12.039Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:26:12.190Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.190Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:26:12.190Z] Identifier: test-reset-1763846772038
[2025-11-22T21:26:12.191Z] Key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.191Z] üìñ Found existing entry for key: test-reset:test-reset-1763846772038
[2025-11-22T21:26:12.191Z] Existing timestamps: 2
[2025-11-22T21:26:12.191Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:26:12.191Z] Current count after filter: 0
[2025-11-22T21:26:12.191Z] Max requests allowed: 2
[2025-11-22T21:26:12.191Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.191Z] New count: 1
[2025-11-22T21:26:12.191Z] Remaining: 1
[2025-11-22T21:26:12.191Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.191Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.191Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.191Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.191Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.191Z] üìù Creating new entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.191Z] Current count after filter: 0
[2025-11-22T21:26:12.191Z] Max requests allowed: 5
[2025-11-22T21:26:12.191Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.191Z] New count: 1
[2025-11-22T21:26:12.191Z] Remaining: 4
[2025-11-22T21:26:12.191Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.191Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.192Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.192Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] üìñ Found existing entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] Existing timestamps: 1
[2025-11-22T21:26:12.192Z] Current count after filter: 1
[2025-11-22T21:26:12.192Z] Max requests allowed: 5
[2025-11-22T21:26:12.192Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.192Z] New count: 2
[2025-11-22T21:26:12.192Z] Remaining: 3
[2025-11-22T21:26:12.192Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.192Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.192Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.192Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] üìñ Found existing entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.192Z] Existing timestamps: 2
[2025-11-22T21:26:12.192Z] Current count after filter: 2
[2025-11-22T21:26:12.192Z] Max requests allowed: 5
[2025-11-22T21:26:12.192Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.192Z] New count: 3
[2025-11-22T21:26:12.192Z] Remaining: 2
[2025-11-22T21:26:12.192Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.192Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.193Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.193Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] üìñ Found existing entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Existing timestamps: 3
[2025-11-22T21:26:12.193Z] Current count after filter: 3
[2025-11-22T21:26:12.193Z] Max requests allowed: 5
[2025-11-22T21:26:12.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.193Z] New count: 4
[2025-11-22T21:26:12.193Z] Remaining: 1
[2025-11-22T21:26:12.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.193Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.193Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.193Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] üìñ Found existing entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Existing timestamps: 4
[2025-11-22T21:26:12.193Z] Current count after filter: 4
[2025-11-22T21:26:12.193Z] Max requests allowed: 5
[2025-11-22T21:26:12.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.193Z] New count: 5
[2025-11-22T21:26:12.193Z] Remaining: 0
[2025-11-22T21:26:12.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.193Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.193Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.193Z] Identifier: test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] üìñ Found existing entry for key: login:test-multi-1-1763846772191
[2025-11-22T21:26:12.193Z] Existing timestamps: 5
[2025-11-22T21:26:12.193Z] Current count after filter: 5
[2025-11-22T21:26:12.194Z] Max requests allowed: 5
[2025-11-22T21:26:12.194Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:26:12.194Z] Current count: 5
[2025-11-22T21:26:12.194Z] Max allowed: 5
[2025-11-22T21:26:12.194Z] Retry after (seconds): 60
[2025-11-22T21:26:12.194Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:26:12.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.194Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.195Z] Identifier: test-multi-2-1763846772191
[2025-11-22T21:26:12.195Z] Key: login:test-multi-2-1763846772191
[2025-11-22T21:26:12.195Z] üìù Creating new entry for key: login:test-multi-2-1763846772191
[2025-11-22T21:26:12.195Z] Current count after filter: 0
[2025-11-22T21:26:12.195Z] Max requests allowed: 5
[2025-11-22T21:26:12.195Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.195Z] New count: 1
[2025-11-22T21:26:12.195Z] Remaining: 4
[2025-11-22T21:26:12.195Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.196Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.197Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:26:12.197Z] Identifier: test-reset-time-1763846772196
[2025-11-22T21:26:12.197Z] Key: login:test-reset-time-1763846772196
[2025-11-22T21:26:12.197Z] üìù Creating new entry for key: login:test-reset-time-1763846772196
[2025-11-22T21:26:12.197Z] Current count after filter: 0
[2025-11-22T21:26:12.197Z] Max requests allowed: 5
[2025-11-22T21:26:12.197Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.197Z] New count: 1
[2025-11-22T21:26:12.197Z] Remaining: 4
[2025-11-22T21:26:12.197Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.199Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:26:12.199Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:26:12.199Z] E2E_TEST_MODE (env): true
[2025-11-22T21:26:12.199Z] E2E_TEST_MODE (final): true
[2025-11-22T21:26:12.199Z] X-Test-ID header: null
[2025-11-22T21:26:12.199Z] Will use test ID?: false
[2025-11-22T21:26:12.199Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:26:12.199Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:26:12.200Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (env): true
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (final): true
[2025-11-22T21:26:12.200Z] X-Test-ID header: null
[2025-11-22T21:26:12.200Z] Will use test ID?: false
[2025-11-22T21:26:12.200Z] Using real IP: 192.168.1.2
[2025-11-22T21:26:12.200Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:26:12.200Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (env): true
[2025-11-22T21:26:12.200Z] E2E_TEST_MODE (final): true
[2025-11-22T21:26:12.200Z] X-Test-ID header: null
[2025-11-22T21:26:12.200Z] Will use test ID?: false
[2025-11-22T21:26:12.200Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:26:12.200Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:26:12.201Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (env): true
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (final): true
[2025-11-22T21:26:12.201Z] X-Test-ID header: null
[2025-11-22T21:26:12.201Z] Will use test ID?: false
[2025-11-22T21:26:12.201Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:26:12.201Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:26:12.201Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (env): true
[2025-11-22T21:26:12.201Z] E2E_TEST_MODE (final): true
[2025-11-22T21:26:12.201Z] X-Test-ID header: null
[2025-11-22T21:26:12.201Z] Will use test ID?: false
[2025-11-22T21:26:12.201Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:26:12.202Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:26:12.202Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.202Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:26:12.202Z] Identifier: test-sliding-1763846772202
[2025-11-22T21:26:12.202Z] Key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.202Z] üìù Creating new entry for key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.202Z] Current count after filter: 0
[2025-11-22T21:26:12.202Z] Max requests allowed: 3
[2025-11-22T21:26:12.202Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.202Z] New count: 1
[2025-11-22T21:26:12.202Z] Remaining: 2
[2025-11-22T21:26:12.203Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.304Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.307Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:26:12.308Z] Identifier: test-sliding-1763846772202
[2025-11-22T21:26:12.308Z] Key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.308Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.308Z] Existing timestamps: 1
[2025-11-22T21:26:12.308Z] Current count after filter: 1
[2025-11-22T21:26:12.308Z] Max requests allowed: 3
[2025-11-22T21:26:12.308Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.308Z] New count: 2
[2025-11-22T21:26:12.308Z] Remaining: 1
[2025-11-22T21:26:12.308Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.411Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:26:12.411Z] Identifier: test-sliding-1763846772202
[2025-11-22T21:26:12.411Z] Key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.411Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846772202
[2025-11-22T21:26:12.412Z] Existing timestamps: 2
[2025-11-22T21:26:12.412Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:26:12.412Z] Current count after filter: 1
[2025-11-22T21:26:12.412Z] Max requests allowed: 3
[2025-11-22T21:26:12.412Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.413Z] New count: 2
[2025-11-22T21:26:12.413Z] Remaining: 1
[2025-11-22T21:26:12.413Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.413Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.414Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:26:12.414Z] Identifier: test-format-allowed-1763846772413
[2025-11-22T21:26:12.414Z] Key: register:test-format-allowed-1763846772413
[2025-11-22T21:26:12.414Z] üìù Creating new entry for key: register:test-format-allowed-1763846772413
[2025-11-22T21:26:12.414Z] Current count after filter: 0
[2025-11-22T21:26:12.414Z] Max requests allowed: 3
[2025-11-22T21:26:12.414Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.414Z] New count: 1
[2025-11-22T21:26:12.414Z] Remaining: 2
[2025-11-22T21:26:12.414Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.415Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.415Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:26:12.415Z] Identifier: test-format-blocked-1763846772415
[2025-11-22T21:26:12.415Z] Key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.415Z] üìù Creating new entry for key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.415Z] Current count after filter: 0
[2025-11-22T21:26:12.416Z] Max requests allowed: 3
[2025-11-22T21:26:12.416Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.416Z] New count: 1
[2025-11-22T21:26:12.416Z] Remaining: 2
[2025-11-22T21:26:12.416Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.416Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.416Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:26:12.416Z] Identifier: test-format-blocked-1763846772415
[2025-11-22T21:26:12.416Z] Key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.416Z] üìñ Found existing entry for key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.416Z] Existing timestamps: 1
[2025-11-22T21:26:12.416Z] Current count after filter: 1
[2025-11-22T21:26:12.416Z] Max requests allowed: 3
[2025-11-22T21:26:12.416Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.416Z] New count: 2
[2025-11-22T21:26:12.416Z] Remaining: 1
[2025-11-22T21:26:12.417Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.417Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.417Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:26:12.417Z] Identifier: test-format-blocked-1763846772415
[2025-11-22T21:26:12.417Z] Key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.417Z] üìñ Found existing entry for key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.417Z] Existing timestamps: 2
[2025-11-22T21:26:12.417Z] Current count after filter: 2
[2025-11-22T21:26:12.417Z] Max requests allowed: 3
[2025-11-22T21:26:12.417Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:26:12.417Z] New count: 3
[2025-11-22T21:26:12.417Z] Remaining: 0
[2025-11-22T21:26:12.417Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:26:12.417Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:26:12.417Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:26:12.418Z] Identifier: test-format-blocked-1763846772415
[2025-11-22T21:26:12.418Z] Key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.418Z] üìñ Found existing entry for key: register:test-format-blocked-1763846772415
[2025-11-22T21:26:12.418Z] Existing timestamps: 3
[2025-11-22T21:26:12.418Z] Current count after filter: 3
[2025-11-22T21:26:12.418Z] Max requests allowed: 3
[2025-11-22T21:26:12.418Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:26:12.418Z] Current count: 3
[2025-11-22T21:26:12.418Z] Max allowed: 3
[2025-11-22T21:26:12.418Z] Retry after (seconds): 60
[2025-11-22T21:26:12.418Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:27:59.219Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.219Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.220Z] Identifier: test-allow-1763846879218
[2025-11-22T21:27:59.220Z] Key: login:test-allow-1763846879218
[2025-11-22T21:27:59.220Z] üìù Creating new entry for key: login:test-allow-1763846879218
[2025-11-22T21:27:59.220Z] Current count after filter: 0
[2025-11-22T21:27:59.220Z] Max requests allowed: 5
[2025-11-22T21:27:59.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.220Z] New count: 1
[2025-11-22T21:27:59.220Z] Remaining: 4
[2025-11-22T21:27:59.220Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.220Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.220Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.220Z] Identifier: test-allow-1763846879218
[2025-11-22T21:27:59.220Z] Key: login:test-allow-1763846879218
[2025-11-22T21:27:59.220Z] üìñ Found existing entry for key: login:test-allow-1763846879218
[2025-11-22T21:27:59.220Z] Existing timestamps: 1
[2025-11-22T21:27:59.220Z] Current count after filter: 1
[2025-11-22T21:27:59.220Z] Max requests allowed: 5
[2025-11-22T21:27:59.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.221Z] New count: 2
[2025-11-22T21:27:59.221Z] Remaining: 3
[2025-11-22T21:27:59.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.221Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.221Z] Identifier: test-allow-1763846879218
[2025-11-22T21:27:59.221Z] Key: login:test-allow-1763846879218
[2025-11-22T21:27:59.221Z] üìñ Found existing entry for key: login:test-allow-1763846879218
[2025-11-22T21:27:59.221Z] Existing timestamps: 2
[2025-11-22T21:27:59.221Z] Current count after filter: 2
[2025-11-22T21:27:59.221Z] Max requests allowed: 5
[2025-11-22T21:27:59.221Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.221Z] New count: 3
[2025-11-22T21:27:59.221Z] Remaining: 2
[2025-11-22T21:27:59.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.221Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.221Z] Identifier: test-allow-1763846879218
[2025-11-22T21:27:59.221Z] Key: login:test-allow-1763846879218
[2025-11-22T21:27:59.221Z] üìñ Found existing entry for key: login:test-allow-1763846879218
[2025-11-22T21:27:59.221Z] Existing timestamps: 3
[2025-11-22T21:27:59.221Z] Current count after filter: 3
[2025-11-22T21:27:59.221Z] Max requests allowed: 5
[2025-11-22T21:27:59.221Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.221Z] New count: 4
[2025-11-22T21:27:59.222Z] Remaining: 1
[2025-11-22T21:27:59.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.222Z] Identifier: test-allow-1763846879218
[2025-11-22T21:27:59.222Z] Key: login:test-allow-1763846879218
[2025-11-22T21:27:59.222Z] üìñ Found existing entry for key: login:test-allow-1763846879218
[2025-11-22T21:27:59.222Z] Existing timestamps: 4
[2025-11-22T21:27:59.222Z] Current count after filter: 4
[2025-11-22T21:27:59.222Z] Max requests allowed: 5
[2025-11-22T21:27:59.222Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.222Z] New count: 5
[2025-11-22T21:27:59.222Z] Remaining: 0
[2025-11-22T21:27:59.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.223Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.223Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.223Z] üìù Creating new entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.223Z] Current count after filter: 0
[2025-11-22T21:27:59.223Z] Max requests allowed: 5
[2025-11-22T21:27:59.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.223Z] New count: 1
[2025-11-22T21:27:59.223Z] Remaining: 4
[2025-11-22T21:27:59.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.223Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.223Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.223Z] üìñ Found existing entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.223Z] Existing timestamps: 1
[2025-11-22T21:27:59.223Z] Current count after filter: 1
[2025-11-22T21:27:59.223Z] Max requests allowed: 5
[2025-11-22T21:27:59.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.223Z] New count: 2
[2025-11-22T21:27:59.224Z] Remaining: 3
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.224Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.224Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] üìñ Found existing entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] Existing timestamps: 2
[2025-11-22T21:27:59.224Z] Current count after filter: 2
[2025-11-22T21:27:59.224Z] Max requests allowed: 5
[2025-11-22T21:27:59.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.224Z] New count: 3
[2025-11-22T21:27:59.224Z] Remaining: 2
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.224Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.224Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] üìñ Found existing entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] Existing timestamps: 3
[2025-11-22T21:27:59.224Z] Current count after filter: 3
[2025-11-22T21:27:59.224Z] Max requests allowed: 5
[2025-11-22T21:27:59.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.224Z] New count: 4
[2025-11-22T21:27:59.224Z] Remaining: 1
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.224Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.224Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] üìñ Found existing entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.224Z] Existing timestamps: 4
[2025-11-22T21:27:59.224Z] Current count after filter: 4
[2025-11-22T21:27:59.225Z] Max requests allowed: 5
[2025-11-22T21:27:59.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.225Z] New count: 5
[2025-11-22T21:27:59.225Z] Remaining: 0
[2025-11-22T21:27:59.225Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.225Z] Identifier: test-block-1763846879223
[2025-11-22T21:27:59.225Z] Key: login:test-block-1763846879223
[2025-11-22T21:27:59.225Z] üìñ Found existing entry for key: login:test-block-1763846879223
[2025-11-22T21:27:59.225Z] Existing timestamps: 5
[2025-11-22T21:27:59.225Z] Current count after filter: 5
[2025-11-22T21:27:59.225Z] Max requests allowed: 5
[2025-11-22T21:27:59.225Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:27:59.225Z] Current count: 5
[2025-11-22T21:27:59.225Z] Max allowed: 5
[2025-11-22T21:27:59.225Z] Retry after (seconds): 60
[2025-11-22T21:27:59.225Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:27:59.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.226Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:27:59.226Z] Identifier: test-reset-1763846879226
[2025-11-22T21:27:59.226Z] Key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.226Z] üìù Creating new entry for key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.226Z] Current count after filter: 0
[2025-11-22T21:27:59.226Z] Max requests allowed: 2
[2025-11-22T21:27:59.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.226Z] New count: 1
[2025-11-22T21:27:59.226Z] Remaining: 1
[2025-11-22T21:27:59.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.226Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:27:59.226Z] Identifier: test-reset-1763846879226
[2025-11-22T21:27:59.226Z] Key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.226Z] üìñ Found existing entry for key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.226Z] Existing timestamps: 1
[2025-11-22T21:27:59.226Z] Current count after filter: 1
[2025-11-22T21:27:59.226Z] Max requests allowed: 2
[2025-11-22T21:27:59.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.226Z] New count: 2
[2025-11-22T21:27:59.226Z] Remaining: 0
[2025-11-22T21:27:59.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.227Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:27:59.227Z] Identifier: test-reset-1763846879226
[2025-11-22T21:27:59.227Z] Key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.227Z] üìñ Found existing entry for key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.227Z] Existing timestamps: 2
[2025-11-22T21:27:59.227Z] Current count after filter: 2
[2025-11-22T21:27:59.227Z] Max requests allowed: 2
[2025-11-22T21:27:59.227Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:27:59.227Z] Current count: 2
[2025-11-22T21:27:59.227Z] Max allowed: 2
[2025-11-22T21:27:59.227Z] Retry after (seconds): 1
[2025-11-22T21:27:59.227Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:27:59.377Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.378Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:27:59.378Z] Identifier: test-reset-1763846879226
[2025-11-22T21:27:59.378Z] Key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.378Z] üìñ Found existing entry for key: test-reset:test-reset-1763846879226
[2025-11-22T21:27:59.378Z] Existing timestamps: 2
[2025-11-22T21:27:59.378Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:27:59.378Z] Current count after filter: 0
[2025-11-22T21:27:59.378Z] Max requests allowed: 2
[2025-11-22T21:27:59.378Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.378Z] New count: 1
[2025-11-22T21:27:59.378Z] Remaining: 1
[2025-11-22T21:27:59.378Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.378Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.378Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.378Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.378Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] üìù Creating new entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] Current count after filter: 0
[2025-11-22T21:27:59.379Z] Max requests allowed: 5
[2025-11-22T21:27:59.379Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.379Z] New count: 1
[2025-11-22T21:27:59.379Z] Remaining: 4
[2025-11-22T21:27:59.379Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.379Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.379Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.379Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] üìñ Found existing entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] Existing timestamps: 1
[2025-11-22T21:27:59.379Z] Current count after filter: 1
[2025-11-22T21:27:59.379Z] Max requests allowed: 5
[2025-11-22T21:27:59.379Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.379Z] New count: 2
[2025-11-22T21:27:59.379Z] Remaining: 3
[2025-11-22T21:27:59.379Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.379Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.379Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.379Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] üìñ Found existing entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.379Z] Existing timestamps: 2
[2025-11-22T21:27:59.379Z] Current count after filter: 2
[2025-11-22T21:27:59.379Z] Max requests allowed: 5
[2025-11-22T21:27:59.379Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.379Z] New count: 3
[2025-11-22T21:27:59.379Z] Remaining: 2
[2025-11-22T21:27:59.380Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.380Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.380Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.380Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] üìñ Found existing entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] Existing timestamps: 3
[2025-11-22T21:27:59.380Z] Current count after filter: 3
[2025-11-22T21:27:59.380Z] Max requests allowed: 5
[2025-11-22T21:27:59.380Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.380Z] New count: 4
[2025-11-22T21:27:59.380Z] Remaining: 1
[2025-11-22T21:27:59.380Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.380Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.380Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.380Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] üìñ Found existing entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.380Z] Existing timestamps: 4
[2025-11-22T21:27:59.380Z] Current count after filter: 4
[2025-11-22T21:27:59.380Z] Max requests allowed: 5
[2025-11-22T21:27:59.380Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.381Z] New count: 5
[2025-11-22T21:27:59.381Z] Remaining: 0
[2025-11-22T21:27:59.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.381Z] Identifier: test-multi-1-1763846879378
[2025-11-22T21:27:59.381Z] Key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.381Z] üìñ Found existing entry for key: login:test-multi-1-1763846879378
[2025-11-22T21:27:59.381Z] Existing timestamps: 5
[2025-11-22T21:27:59.381Z] Current count after filter: 5
[2025-11-22T21:27:59.381Z] Max requests allowed: 5
[2025-11-22T21:27:59.381Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:27:59.381Z] Current count: 5
[2025-11-22T21:27:59.381Z] Max allowed: 5
[2025-11-22T21:27:59.382Z] Retry after (seconds): 60
[2025-11-22T21:27:59.382Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:27:59.382Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.382Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.382Z] Identifier: test-multi-2-1763846879378
[2025-11-22T21:27:59.382Z] Key: login:test-multi-2-1763846879378
[2025-11-22T21:27:59.382Z] üìù Creating new entry for key: login:test-multi-2-1763846879378
[2025-11-22T21:27:59.382Z] Current count after filter: 0
[2025-11-22T21:27:59.382Z] Max requests allowed: 5
[2025-11-22T21:27:59.382Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.382Z] New count: 1
[2025-11-22T21:27:59.382Z] Remaining: 4
[2025-11-22T21:27:59.382Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:27:59.383Z] Identifier: test-reset-time-1763846879383
[2025-11-22T21:27:59.383Z] Key: login:test-reset-time-1763846879383
[2025-11-22T21:27:59.383Z] üìù Creating new entry for key: login:test-reset-time-1763846879383
[2025-11-22T21:27:59.383Z] Current count after filter: 0
[2025-11-22T21:27:59.383Z] Max requests allowed: 5
[2025-11-22T21:27:59.383Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.383Z] New count: 1
[2025-11-22T21:27:59.383Z] Remaining: 4
[2025-11-22T21:27:59.383Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.385Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:27:59.385Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:27:59.385Z] E2E_TEST_MODE (env): true
[2025-11-22T21:27:59.385Z] E2E_TEST_MODE (final): true
[2025-11-22T21:27:59.385Z] X-Test-ID header: null
[2025-11-22T21:27:59.385Z] Will use test ID?: false
[2025-11-22T21:27:59.385Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:27:59.385Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:27:59.386Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:27:59.386Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:27:59.386Z] E2E_TEST_MODE (env): true
[2025-11-22T21:27:59.386Z] E2E_TEST_MODE (final): true
[2025-11-22T21:27:59.386Z] X-Test-ID header: null
[2025-11-22T21:27:59.386Z] Will use test ID?: false
[2025-11-22T21:27:59.386Z] Using real IP: 192.168.1.2
[2025-11-22T21:27:59.386Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:27:59.386Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (env): true
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (final): true
[2025-11-22T21:27:59.387Z] X-Test-ID header: null
[2025-11-22T21:27:59.387Z] Will use test ID?: false
[2025-11-22T21:27:59.387Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:27:59.387Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:27:59.387Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (env): true
[2025-11-22T21:27:59.387Z] E2E_TEST_MODE (final): true
[2025-11-22T21:27:59.387Z] X-Test-ID header: null
[2025-11-22T21:27:59.387Z] Will use test ID?: false
[2025-11-22T21:27:59.387Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:27:59.387Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:27:59.388Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:27:59.388Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:27:59.388Z] E2E_TEST_MODE (env): true
[2025-11-22T21:27:59.388Z] E2E_TEST_MODE (final): true
[2025-11-22T21:27:59.388Z] X-Test-ID header: null
[2025-11-22T21:27:59.388Z] Will use test ID?: false
[2025-11-22T21:27:59.388Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:27:59.388Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:27:59.388Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.388Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:27:59.388Z] Identifier: test-sliding-1763846879388
[2025-11-22T21:27:59.388Z] Key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.388Z] üìù Creating new entry for key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.388Z] Current count after filter: 0
[2025-11-22T21:27:59.388Z] Max requests allowed: 3
[2025-11-22T21:27:59.389Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.389Z] New count: 1
[2025-11-22T21:27:59.389Z] Remaining: 2
[2025-11-22T21:27:59.389Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.489Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.490Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:27:59.490Z] Identifier: test-sliding-1763846879388
[2025-11-22T21:27:59.490Z] Key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.490Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.490Z] Existing timestamps: 1
[2025-11-22T21:27:59.490Z] Current count after filter: 1
[2025-11-22T21:27:59.490Z] Max requests allowed: 3
[2025-11-22T21:27:59.490Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.490Z] New count: 2
[2025-11-22T21:27:59.490Z] Remaining: 1
[2025-11-22T21:27:59.490Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.592Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:27:59.593Z] Identifier: test-sliding-1763846879388
[2025-11-22T21:27:59.593Z] Key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.593Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846879388
[2025-11-22T21:27:59.593Z] Existing timestamps: 2
[2025-11-22T21:27:59.593Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:27:59.593Z] Current count after filter: 1
[2025-11-22T21:27:59.593Z] Max requests allowed: 3
[2025-11-22T21:27:59.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.594Z] New count: 2
[2025-11-22T21:27:59.594Z] Remaining: 1
[2025-11-22T21:27:59.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.596Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:27:59.597Z] Identifier: test-format-allowed-1763846879596
[2025-11-22T21:27:59.598Z] Key: register:test-format-allowed-1763846879596
[2025-11-22T21:27:59.598Z] üìù Creating new entry for key: register:test-format-allowed-1763846879596
[2025-11-22T21:27:59.598Z] Current count after filter: 0
[2025-11-22T21:27:59.598Z] Max requests allowed: 3
[2025-11-22T21:27:59.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.598Z] New count: 1
[2025-11-22T21:27:59.598Z] Remaining: 2
[2025-11-22T21:27:59.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.599Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.599Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:27:59.599Z] Identifier: test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] Key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] üìù Creating new entry for key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] Current count after filter: 0
[2025-11-22T21:27:59.599Z] Max requests allowed: 3
[2025-11-22T21:27:59.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.599Z] New count: 1
[2025-11-22T21:27:59.599Z] Remaining: 2
[2025-11-22T21:27:59.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.599Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.599Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:27:59.599Z] Identifier: test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] Key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] üìñ Found existing entry for key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.599Z] Existing timestamps: 1
[2025-11-22T21:27:59.599Z] Current count after filter: 1
[2025-11-22T21:27:59.599Z] Max requests allowed: 3
[2025-11-22T21:27:59.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.599Z] New count: 2
[2025-11-22T21:27:59.599Z] Remaining: 1
[2025-11-22T21:27:59.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:27:59.600Z] Identifier: test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] Key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] Existing timestamps: 2
[2025-11-22T21:27:59.600Z] Current count after filter: 2
[2025-11-22T21:27:59.600Z] Max requests allowed: 3
[2025-11-22T21:27:59.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:27:59.600Z] New count: 3
[2025-11-22T21:27:59.600Z] Remaining: 0
[2025-11-22T21:27:59.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:27:59.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:27:59.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:27:59.600Z] Identifier: test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] Key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763846879599
[2025-11-22T21:27:59.600Z] Existing timestamps: 3
[2025-11-22T21:27:59.600Z] Current count after filter: 3
[2025-11-22T21:27:59.601Z] Max requests allowed: 3
[2025-11-22T21:27:59.601Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:27:59.601Z] Current count: 3
[2025-11-22T21:27:59.601Z] Max allowed: 3
[2025-11-22T21:27:59.601Z] Retry after (seconds): 60
[2025-11-22T21:27:59.601Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:29:06.283Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.284Z] Identifier: test-allow-1763846946283
[2025-11-22T21:29:06.284Z] Key: login:test-allow-1763846946283
[2025-11-22T21:29:06.284Z] üìù Creating new entry for key: login:test-allow-1763846946283
[2025-11-22T21:29:06.284Z] Current count after filter: 0
[2025-11-22T21:29:06.284Z] Max requests allowed: 5
[2025-11-22T21:29:06.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.284Z] New count: 1
[2025-11-22T21:29:06.284Z] Remaining: 4
[2025-11-22T21:29:06.285Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.285Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.285Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.285Z] Identifier: test-allow-1763846946283
[2025-11-22T21:29:06.285Z] Key: login:test-allow-1763846946283
[2025-11-22T21:29:06.285Z] üìñ Found existing entry for key: login:test-allow-1763846946283
[2025-11-22T21:29:06.285Z] Existing timestamps: 1
[2025-11-22T21:29:06.285Z] Current count after filter: 1
[2025-11-22T21:29:06.285Z] Max requests allowed: 5
[2025-11-22T21:29:06.285Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.285Z] New count: 2
[2025-11-22T21:29:06.285Z] Remaining: 3
[2025-11-22T21:29:06.285Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.285Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.285Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.286Z] Identifier: test-allow-1763846946283
[2025-11-22T21:29:06.286Z] Key: login:test-allow-1763846946283
[2025-11-22T21:29:06.286Z] üìñ Found existing entry for key: login:test-allow-1763846946283
[2025-11-22T21:29:06.286Z] Existing timestamps: 2
[2025-11-22T21:29:06.286Z] Current count after filter: 2
[2025-11-22T21:29:06.286Z] Max requests allowed: 5
[2025-11-22T21:29:06.286Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.286Z] New count: 3
[2025-11-22T21:29:06.286Z] Remaining: 2
[2025-11-22T21:29:06.286Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.286Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.286Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.286Z] Identifier: test-allow-1763846946283
[2025-11-22T21:29:06.286Z] Key: login:test-allow-1763846946283
[2025-11-22T21:29:06.286Z] üìñ Found existing entry for key: login:test-allow-1763846946283
[2025-11-22T21:29:06.286Z] Existing timestamps: 3
[2025-11-22T21:29:06.286Z] Current count after filter: 3
[2025-11-22T21:29:06.287Z] Max requests allowed: 5
[2025-11-22T21:29:06.287Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.287Z] New count: 4
[2025-11-22T21:29:06.287Z] Remaining: 1
[2025-11-22T21:29:06.287Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.287Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.288Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.288Z] Identifier: test-allow-1763846946283
[2025-11-22T21:29:06.288Z] Key: login:test-allow-1763846946283
[2025-11-22T21:29:06.288Z] üìñ Found existing entry for key: login:test-allow-1763846946283
[2025-11-22T21:29:06.288Z] Existing timestamps: 4
[2025-11-22T21:29:06.288Z] Current count after filter: 4
[2025-11-22T21:29:06.288Z] Max requests allowed: 5
[2025-11-22T21:29:06.288Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.288Z] New count: 5
[2025-11-22T21:29:06.288Z] Remaining: 0
[2025-11-22T21:29:06.288Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.289Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.289Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.289Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.289Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.289Z] üìù Creating new entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.289Z] Current count after filter: 0
[2025-11-22T21:29:06.289Z] Max requests allowed: 5
[2025-11-22T21:29:06.289Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.289Z] New count: 1
[2025-11-22T21:29:06.289Z] Remaining: 4
[2025-11-22T21:29:06.289Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.289Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.289Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.289Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.289Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.289Z] üìñ Found existing entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.289Z] Existing timestamps: 1
[2025-11-22T21:29:06.289Z] Current count after filter: 1
[2025-11-22T21:29:06.289Z] Max requests allowed: 5
[2025-11-22T21:29:06.289Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.289Z] New count: 2
[2025-11-22T21:29:06.289Z] Remaining: 3
[2025-11-22T21:29:06.289Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.290Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.290Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.290Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.290Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.290Z] üìñ Found existing entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.290Z] Existing timestamps: 2
[2025-11-22T21:29:06.290Z] Current count after filter: 2
[2025-11-22T21:29:06.290Z] Max requests allowed: 5
[2025-11-22T21:29:06.290Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.290Z] New count: 3
[2025-11-22T21:29:06.290Z] Remaining: 2
[2025-11-22T21:29:06.290Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.290Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.290Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.291Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.291Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] üìñ Found existing entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] Existing timestamps: 3
[2025-11-22T21:29:06.291Z] Current count after filter: 3
[2025-11-22T21:29:06.291Z] Max requests allowed: 5
[2025-11-22T21:29:06.291Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.291Z] New count: 4
[2025-11-22T21:29:06.291Z] Remaining: 1
[2025-11-22T21:29:06.291Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.291Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.291Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.291Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.291Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] üìñ Found existing entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] Existing timestamps: 4
[2025-11-22T21:29:06.291Z] Current count after filter: 4
[2025-11-22T21:29:06.291Z] Max requests allowed: 5
[2025-11-22T21:29:06.291Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.291Z] New count: 5
[2025-11-22T21:29:06.291Z] Remaining: 0
[2025-11-22T21:29:06.291Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.291Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.291Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.291Z] Identifier: test-block-1763846946289
[2025-11-22T21:29:06.291Z] Key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] üìñ Found existing entry for key: login:test-block-1763846946289
[2025-11-22T21:29:06.291Z] Existing timestamps: 5
[2025-11-22T21:29:06.291Z] Current count after filter: 5
[2025-11-22T21:29:06.292Z] Max requests allowed: 5
[2025-11-22T21:29:06.292Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:29:06.292Z] Current count: 5
[2025-11-22T21:29:06.292Z] Max allowed: 5
[2025-11-22T21:29:06.292Z] Retry after (seconds): 60
[2025-11-22T21:29:06.292Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:29:06.292Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.292Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:29:06.292Z] Identifier: test-reset-1763846946292
[2025-11-22T21:29:06.292Z] Key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.292Z] üìù Creating new entry for key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.292Z] Current count after filter: 0
[2025-11-22T21:29:06.292Z] Max requests allowed: 2
[2025-11-22T21:29:06.292Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.292Z] New count: 1
[2025-11-22T21:29:06.292Z] Remaining: 1
[2025-11-22T21:29:06.293Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.293Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.293Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:29:06.293Z] Identifier: test-reset-1763846946292
[2025-11-22T21:29:06.293Z] Key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.293Z] üìñ Found existing entry for key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.293Z] Existing timestamps: 1
[2025-11-22T21:29:06.293Z] Current count after filter: 1
[2025-11-22T21:29:06.293Z] Max requests allowed: 2
[2025-11-22T21:29:06.293Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.293Z] New count: 2
[2025-11-22T21:29:06.293Z] Remaining: 0
[2025-11-22T21:29:06.293Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.293Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.293Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:29:06.293Z] Identifier: test-reset-1763846946292
[2025-11-22T21:29:06.293Z] Key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.293Z] üìñ Found existing entry for key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.293Z] Existing timestamps: 2
[2025-11-22T21:29:06.293Z] Current count after filter: 2
[2025-11-22T21:29:06.293Z] Max requests allowed: 2
[2025-11-22T21:29:06.293Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:29:06.293Z] Current count: 2
[2025-11-22T21:29:06.293Z] Max allowed: 2
[2025-11-22T21:29:06.293Z] Retry after (seconds): 1
[2025-11-22T21:29:06.293Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:29:06.444Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.444Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:29:06.444Z] Identifier: test-reset-1763846946292
[2025-11-22T21:29:06.444Z] Key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.444Z] üìñ Found existing entry for key: test-reset:test-reset-1763846946292
[2025-11-22T21:29:06.444Z] Existing timestamps: 2
[2025-11-22T21:29:06.444Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:29:06.445Z] Current count after filter: 0
[2025-11-22T21:29:06.445Z] Max requests allowed: 2
[2025-11-22T21:29:06.445Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.445Z] New count: 1
[2025-11-22T21:29:06.445Z] Remaining: 1
[2025-11-22T21:29:06.445Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.445Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.445Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.445Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.445Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.445Z] üìù Creating new entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.445Z] Current count after filter: 0
[2025-11-22T21:29:06.445Z] Max requests allowed: 5
[2025-11-22T21:29:06.445Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.445Z] New count: 1
[2025-11-22T21:29:06.446Z] Remaining: 4
[2025-11-22T21:29:06.446Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.446Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.446Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.446Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.446Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.446Z] üìñ Found existing entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.446Z] Existing timestamps: 1
[2025-11-22T21:29:06.446Z] Current count after filter: 1
[2025-11-22T21:29:06.446Z] Max requests allowed: 5
[2025-11-22T21:29:06.447Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.447Z] New count: 2
[2025-11-22T21:29:06.447Z] Remaining: 3
[2025-11-22T21:29:06.447Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.447Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.447Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.447Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.447Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.447Z] üìñ Found existing entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.447Z] Existing timestamps: 2
[2025-11-22T21:29:06.447Z] Current count after filter: 2
[2025-11-22T21:29:06.447Z] Max requests allowed: 5
[2025-11-22T21:29:06.447Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.447Z] New count: 3
[2025-11-22T21:29:06.447Z] Remaining: 2
[2025-11-22T21:29:06.447Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.447Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.447Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.447Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.447Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.448Z] üìñ Found existing entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.448Z] Existing timestamps: 3
[2025-11-22T21:29:06.448Z] Current count after filter: 3
[2025-11-22T21:29:06.448Z] Max requests allowed: 5
[2025-11-22T21:29:06.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.448Z] New count: 4
[2025-11-22T21:29:06.448Z] Remaining: 1
[2025-11-22T21:29:06.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.448Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.448Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.448Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.448Z] üìñ Found existing entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.448Z] Existing timestamps: 4
[2025-11-22T21:29:06.448Z] Current count after filter: 4
[2025-11-22T21:29:06.448Z] Max requests allowed: 5
[2025-11-22T21:29:06.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.448Z] New count: 5
[2025-11-22T21:29:06.448Z] Remaining: 0
[2025-11-22T21:29:06.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.449Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.449Z] Identifier: test-multi-1-1763846946445
[2025-11-22T21:29:06.449Z] Key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.449Z] üìñ Found existing entry for key: login:test-multi-1-1763846946445
[2025-11-22T21:29:06.449Z] Existing timestamps: 5
[2025-11-22T21:29:06.449Z] Current count after filter: 5
[2025-11-22T21:29:06.449Z] Max requests allowed: 5
[2025-11-22T21:29:06.449Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:29:06.449Z] Current count: 5
[2025-11-22T21:29:06.449Z] Max allowed: 5
[2025-11-22T21:29:06.449Z] Retry after (seconds): 60
[2025-11-22T21:29:06.449Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:29:06.449Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.449Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.449Z] Identifier: test-multi-2-1763846946445
[2025-11-22T21:29:06.449Z] Key: login:test-multi-2-1763846946445
[2025-11-22T21:29:06.449Z] üìù Creating new entry for key: login:test-multi-2-1763846946445
[2025-11-22T21:29:06.449Z] Current count after filter: 0
[2025-11-22T21:29:06.450Z] Max requests allowed: 5
[2025-11-22T21:29:06.450Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.450Z] New count: 1
[2025-11-22T21:29:06.450Z] Remaining: 4
[2025-11-22T21:29:06.450Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.450Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.450Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:29:06.450Z] Identifier: test-reset-time-1763846946450
[2025-11-22T21:29:06.450Z] Key: login:test-reset-time-1763846946450
[2025-11-22T21:29:06.450Z] üìù Creating new entry for key: login:test-reset-time-1763846946450
[2025-11-22T21:29:06.450Z] Current count after filter: 0
[2025-11-22T21:29:06.450Z] Max requests allowed: 5
[2025-11-22T21:29:06.450Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.451Z] New count: 1
[2025-11-22T21:29:06.451Z] Remaining: 4
[2025-11-22T21:29:06.451Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.452Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (env): true
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (final): true
[2025-11-22T21:29:06.452Z] X-Test-ID header: null
[2025-11-22T21:29:06.452Z] Will use test ID?: false
[2025-11-22T21:29:06.452Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:29:06.452Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:29:06.452Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (env): true
[2025-11-22T21:29:06.452Z] E2E_TEST_MODE (final): true
[2025-11-22T21:29:06.452Z] X-Test-ID header: null
[2025-11-22T21:29:06.452Z] Will use test ID?: false
[2025-11-22T21:29:06.452Z] Using real IP: 192.168.1.2
[2025-11-22T21:29:06.452Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:29:06.453Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (env): true
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (final): true
[2025-11-22T21:29:06.453Z] X-Test-ID header: null
[2025-11-22T21:29:06.453Z] Will use test ID?: false
[2025-11-22T21:29:06.453Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:29:06.453Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:29:06.453Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (env): true
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (final): true
[2025-11-22T21:29:06.453Z] X-Test-ID header: null
[2025-11-22T21:29:06.453Z] Will use test ID?: false
[2025-11-22T21:29:06.453Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:29:06.453Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:29:06.453Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (env): true
[2025-11-22T21:29:06.453Z] E2E_TEST_MODE (final): true
[2025-11-22T21:29:06.453Z] X-Test-ID header: null
[2025-11-22T21:29:06.453Z] Will use test ID?: false
[2025-11-22T21:29:06.454Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:29:06.454Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:29:06.454Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.454Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:29:06.454Z] Identifier: test-sliding-1763846946454
[2025-11-22T21:29:06.454Z] Key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.454Z] üìù Creating new entry for key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.454Z] Current count after filter: 0
[2025-11-22T21:29:06.454Z] Max requests allowed: 3
[2025-11-22T21:29:06.454Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.454Z] New count: 1
[2025-11-22T21:29:06.454Z] Remaining: 2
[2025-11-22T21:29:06.454Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.555Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:29:06.555Z] Identifier: test-sliding-1763846946454
[2025-11-22T21:29:06.555Z] Key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.555Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.555Z] Existing timestamps: 1
[2025-11-22T21:29:06.555Z] Current count after filter: 1
[2025-11-22T21:29:06.555Z] Max requests allowed: 3
[2025-11-22T21:29:06.555Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.555Z] New count: 2
[2025-11-22T21:29:06.555Z] Remaining: 1
[2025-11-22T21:29:06.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.665Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:29:06.665Z] Identifier: test-sliding-1763846946454
[2025-11-22T21:29:06.665Z] Key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.665Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763846946454
[2025-11-22T21:29:06.665Z] Existing timestamps: 2
[2025-11-22T21:29:06.666Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:29:06.666Z] Current count after filter: 1
[2025-11-22T21:29:06.666Z] Max requests allowed: 3
[2025-11-22T21:29:06.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.666Z] New count: 2
[2025-11-22T21:29:06.666Z] Remaining: 1
[2025-11-22T21:29:06.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.667Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.667Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:29:06.667Z] Identifier: test-format-allowed-1763846946667
[2025-11-22T21:29:06.667Z] Key: register:test-format-allowed-1763846946667
[2025-11-22T21:29:06.667Z] üìù Creating new entry for key: register:test-format-allowed-1763846946667
[2025-11-22T21:29:06.667Z] Current count after filter: 0
[2025-11-22T21:29:06.668Z] Max requests allowed: 3
[2025-11-22T21:29:06.668Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.668Z] New count: 1
[2025-11-22T21:29:06.668Z] Remaining: 2
[2025-11-22T21:29:06.668Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.669Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.669Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:29:06.669Z] Identifier: test-format-blocked-1763846946669
[2025-11-22T21:29:06.669Z] Key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.670Z] üìù Creating new entry for key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.670Z] Current count after filter: 0
[2025-11-22T21:29:06.671Z] Max requests allowed: 3
[2025-11-22T21:29:06.671Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.671Z] New count: 1
[2025-11-22T21:29:06.671Z] Remaining: 2
[2025-11-22T21:29:06.675Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.675Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.675Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:29:06.675Z] Identifier: test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] Key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] üìñ Found existing entry for key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] Existing timestamps: 1
[2025-11-22T21:29:06.675Z] Current count after filter: 1
[2025-11-22T21:29:06.675Z] Max requests allowed: 3
[2025-11-22T21:29:06.675Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.675Z] New count: 2
[2025-11-22T21:29:06.675Z] Remaining: 1
[2025-11-22T21:29:06.675Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.675Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.675Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:29:06.675Z] Identifier: test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] Key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] üìñ Found existing entry for key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.675Z] Existing timestamps: 2
[2025-11-22T21:29:06.675Z] Current count after filter: 2
[2025-11-22T21:29:06.675Z] Max requests allowed: 3
[2025-11-22T21:29:06.676Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:29:06.676Z] New count: 3
[2025-11-22T21:29:06.676Z] Remaining: 0
[2025-11-22T21:29:06.676Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:29:06.676Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:29:06.676Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:29:06.676Z] Identifier: test-format-blocked-1763846946669
[2025-11-22T21:29:06.676Z] Key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.676Z] üìñ Found existing entry for key: register:test-format-blocked-1763846946669
[2025-11-22T21:29:06.676Z] Existing timestamps: 3
[2025-11-22T21:29:06.676Z] Current count after filter: 3
[2025-11-22T21:29:06.676Z] Max requests allowed: 3
[2025-11-22T21:29:06.676Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:29:06.676Z] Current count: 3
[2025-11-22T21:29:06.676Z] Max allowed: 3
[2025-11-22T21:29:06.676Z] Retry after (seconds): 60
[2025-11-22T21:29:06.676Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:33:14.748Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.749Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.749Z] Identifier: test-allow-1763847194748
[2025-11-22T21:33:14.749Z] Key: login:test-allow-1763847194748
[2025-11-22T21:33:14.749Z] üìù Creating new entry for key: login:test-allow-1763847194748
[2025-11-22T21:33:14.749Z] Current count after filter: 0
[2025-11-22T21:33:14.749Z] Max requests allowed: 5
[2025-11-22T21:33:14.749Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.749Z] New count: 1
[2025-11-22T21:33:14.749Z] Remaining: 4
[2025-11-22T21:33:14.749Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.749Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.749Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.750Z] Identifier: test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] üìñ Found existing entry for key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Existing timestamps: 1
[2025-11-22T21:33:14.750Z] Current count after filter: 1
[2025-11-22T21:33:14.750Z] Max requests allowed: 5
[2025-11-22T21:33:14.750Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.750Z] New count: 2
[2025-11-22T21:33:14.750Z] Remaining: 3
[2025-11-22T21:33:14.750Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.750Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.750Z] Identifier: test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] üìñ Found existing entry for key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Existing timestamps: 2
[2025-11-22T21:33:14.750Z] Current count after filter: 2
[2025-11-22T21:33:14.750Z] Max requests allowed: 5
[2025-11-22T21:33:14.750Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.750Z] New count: 3
[2025-11-22T21:33:14.750Z] Remaining: 2
[2025-11-22T21:33:14.750Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.750Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.750Z] Identifier: test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] üìñ Found existing entry for key: login:test-allow-1763847194748
[2025-11-22T21:33:14.750Z] Existing timestamps: 3
[2025-11-22T21:33:14.750Z] Current count after filter: 3
[2025-11-22T21:33:14.750Z] Max requests allowed: 5
[2025-11-22T21:33:14.750Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.751Z] New count: 4
[2025-11-22T21:33:14.751Z] Remaining: 1
[2025-11-22T21:33:14.751Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.751Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.751Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.751Z] Identifier: test-allow-1763847194748
[2025-11-22T21:33:14.751Z] Key: login:test-allow-1763847194748
[2025-11-22T21:33:14.751Z] üìñ Found existing entry for key: login:test-allow-1763847194748
[2025-11-22T21:33:14.751Z] Existing timestamps: 4
[2025-11-22T21:33:14.751Z] Current count after filter: 4
[2025-11-22T21:33:14.751Z] Max requests allowed: 5
[2025-11-22T21:33:14.751Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.751Z] New count: 5
[2025-11-22T21:33:14.751Z] Remaining: 0
[2025-11-22T21:33:14.751Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.751Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.751Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.751Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.752Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] üìù Creating new entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] Current count after filter: 0
[2025-11-22T21:33:14.752Z] Max requests allowed: 5
[2025-11-22T21:33:14.752Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.752Z] New count: 1
[2025-11-22T21:33:14.752Z] Remaining: 4
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.752Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.752Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] üìñ Found existing entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] Existing timestamps: 1
[2025-11-22T21:33:14.752Z] Current count after filter: 1
[2025-11-22T21:33:14.752Z] Max requests allowed: 5
[2025-11-22T21:33:14.752Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.752Z] New count: 2
[2025-11-22T21:33:14.752Z] Remaining: 3
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.752Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.752Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] üìñ Found existing entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] Existing timestamps: 2
[2025-11-22T21:33:14.752Z] Current count after filter: 2
[2025-11-22T21:33:14.752Z] Max requests allowed: 5
[2025-11-22T21:33:14.752Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.752Z] New count: 3
[2025-11-22T21:33:14.752Z] Remaining: 2
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.752Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.752Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] üìñ Found existing entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.752Z] Existing timestamps: 3
[2025-11-22T21:33:14.752Z] Current count after filter: 3
[2025-11-22T21:33:14.752Z] Max requests allowed: 5
[2025-11-22T21:33:14.752Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.752Z] New count: 4
[2025-11-22T21:33:14.753Z] Remaining: 1
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.753Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.753Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.753Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.753Z] üìñ Found existing entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.753Z] Existing timestamps: 4
[2025-11-22T21:33:14.753Z] Current count after filter: 4
[2025-11-22T21:33:14.753Z] Max requests allowed: 5
[2025-11-22T21:33:14.753Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.753Z] New count: 5
[2025-11-22T21:33:14.753Z] Remaining: 0
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.753Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.753Z] Identifier: test-block-1763847194751
[2025-11-22T21:33:14.753Z] Key: login:test-block-1763847194751
[2025-11-22T21:33:14.753Z] üìñ Found existing entry for key: login:test-block-1763847194751
[2025-11-22T21:33:14.753Z] Existing timestamps: 5
[2025-11-22T21:33:14.753Z] Current count after filter: 5
[2025-11-22T21:33:14.753Z] Max requests allowed: 5
[2025-11-22T21:33:14.753Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:33:14.753Z] Current count: 5
[2025-11-22T21:33:14.753Z] Max allowed: 5
[2025-11-22T21:33:14.753Z] Retry after (seconds): 60
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:33:14.753Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.753Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:33:14.753Z] Identifier: test-reset-1763847194753
[2025-11-22T21:33:14.753Z] Key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] üìù Creating new entry for key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] Current count after filter: 0
[2025-11-22T21:33:14.754Z] Max requests allowed: 2
[2025-11-22T21:33:14.754Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.754Z] New count: 1
[2025-11-22T21:33:14.754Z] Remaining: 1
[2025-11-22T21:33:14.754Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.754Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.754Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:33:14.754Z] Identifier: test-reset-1763847194753
[2025-11-22T21:33:14.754Z] Key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] üìñ Found existing entry for key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] Existing timestamps: 1
[2025-11-22T21:33:14.754Z] Current count after filter: 1
[2025-11-22T21:33:14.754Z] Max requests allowed: 2
[2025-11-22T21:33:14.754Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.754Z] New count: 2
[2025-11-22T21:33:14.754Z] Remaining: 0
[2025-11-22T21:33:14.754Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.754Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.754Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:33:14.754Z] Identifier: test-reset-1763847194753
[2025-11-22T21:33:14.754Z] Key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] üìñ Found existing entry for key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.754Z] Existing timestamps: 2
[2025-11-22T21:33:14.754Z] Current count after filter: 2
[2025-11-22T21:33:14.754Z] Max requests allowed: 2
[2025-11-22T21:33:14.754Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:33:14.754Z] Current count: 2
[2025-11-22T21:33:14.754Z] Max allowed: 2
[2025-11-22T21:33:14.754Z] Retry after (seconds): 1
[2025-11-22T21:33:14.754Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:33:14.905Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.905Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:33:14.905Z] Identifier: test-reset-1763847194753
[2025-11-22T21:33:14.905Z] Key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.905Z] üìñ Found existing entry for key: test-reset:test-reset-1763847194753
[2025-11-22T21:33:14.906Z] Existing timestamps: 2
[2025-11-22T21:33:14.906Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:33:14.906Z] Current count after filter: 0
[2025-11-22T21:33:14.906Z] Max requests allowed: 2
[2025-11-22T21:33:14.906Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.906Z] New count: 1
[2025-11-22T21:33:14.906Z] Remaining: 1
[2025-11-22T21:33:14.906Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.906Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.906Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.906Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.906Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.906Z] üìù Creating new entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.906Z] Current count after filter: 0
[2025-11-22T21:33:14.906Z] Max requests allowed: 5
[2025-11-22T21:33:14.906Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.907Z] New count: 1
[2025-11-22T21:33:14.907Z] Remaining: 4
[2025-11-22T21:33:14.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.907Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.907Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.907Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] üìñ Found existing entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] Existing timestamps: 1
[2025-11-22T21:33:14.907Z] Current count after filter: 1
[2025-11-22T21:33:14.907Z] Max requests allowed: 5
[2025-11-22T21:33:14.907Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.907Z] New count: 2
[2025-11-22T21:33:14.907Z] Remaining: 3
[2025-11-22T21:33:14.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.907Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.907Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.907Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] üìñ Found existing entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.907Z] Existing timestamps: 2
[2025-11-22T21:33:14.907Z] Current count after filter: 2
[2025-11-22T21:33:14.907Z] Max requests allowed: 5
[2025-11-22T21:33:14.907Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.907Z] New count: 3
[2025-11-22T21:33:14.907Z] Remaining: 2
[2025-11-22T21:33:14.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.908Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.908Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] üìñ Found existing entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] Existing timestamps: 3
[2025-11-22T21:33:14.908Z] Current count after filter: 3
[2025-11-22T21:33:14.908Z] Max requests allowed: 5
[2025-11-22T21:33:14.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.908Z] New count: 4
[2025-11-22T21:33:14.908Z] Remaining: 1
[2025-11-22T21:33:14.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.908Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.908Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] üìñ Found existing entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.908Z] Existing timestamps: 4
[2025-11-22T21:33:14.908Z] Current count after filter: 4
[2025-11-22T21:33:14.908Z] Max requests allowed: 5
[2025-11-22T21:33:14.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.908Z] New count: 5
[2025-11-22T21:33:14.908Z] Remaining: 0
[2025-11-22T21:33:14.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.908Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.908Z] Identifier: test-multi-1-1763847194906
[2025-11-22T21:33:14.909Z] Key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.909Z] üìñ Found existing entry for key: login:test-multi-1-1763847194906
[2025-11-22T21:33:14.909Z] Existing timestamps: 5
[2025-11-22T21:33:14.909Z] Current count after filter: 5
[2025-11-22T21:33:14.909Z] Max requests allowed: 5
[2025-11-22T21:33:14.909Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:33:14.909Z] Current count: 5
[2025-11-22T21:33:14.909Z] Max allowed: 5
[2025-11-22T21:33:14.909Z] Retry after (seconds): 60
[2025-11-22T21:33:14.909Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:33:14.909Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.909Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.909Z] Identifier: test-multi-2-1763847194906
[2025-11-22T21:33:14.909Z] Key: login:test-multi-2-1763847194906
[2025-11-22T21:33:14.909Z] üìù Creating new entry for key: login:test-multi-2-1763847194906
[2025-11-22T21:33:14.909Z] Current count after filter: 0
[2025-11-22T21:33:14.909Z] Max requests allowed: 5
[2025-11-22T21:33:14.909Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.909Z] New count: 1
[2025-11-22T21:33:14.909Z] Remaining: 4
[2025-11-22T21:33:14.909Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.910Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:33:14.910Z] Identifier: test-reset-time-1763847194910
[2025-11-22T21:33:14.910Z] Key: login:test-reset-time-1763847194910
[2025-11-22T21:33:14.910Z] üìù Creating new entry for key: login:test-reset-time-1763847194910
[2025-11-22T21:33:14.910Z] Current count after filter: 0
[2025-11-22T21:33:14.910Z] Max requests allowed: 5
[2025-11-22T21:33:14.910Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.910Z] New count: 1
[2025-11-22T21:33:14.910Z] Remaining: 4
[2025-11-22T21:33:14.910Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:14.912Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (env): true
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (final): true
[2025-11-22T21:33:14.912Z] X-Test-ID header: null
[2025-11-22T21:33:14.912Z] Will use test ID?: false
[2025-11-22T21:33:14.912Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:33:14.912Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:33:14.912Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (env): true
[2025-11-22T21:33:14.912Z] E2E_TEST_MODE (final): true
[2025-11-22T21:33:14.912Z] X-Test-ID header: null
[2025-11-22T21:33:14.912Z] Will use test ID?: false
[2025-11-22T21:33:14.912Z] Using real IP: 192.168.1.2
[2025-11-22T21:33:14.913Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:33:14.913Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:33:14.913Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:33:14.913Z] E2E_TEST_MODE (env): true
[2025-11-22T21:33:14.913Z] E2E_TEST_MODE (final): true
[2025-11-22T21:33:14.913Z] X-Test-ID header: null
[2025-11-22T21:33:14.913Z] Will use test ID?: false
[2025-11-22T21:33:14.913Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:33:14.913Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:33:14.914Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:33:14.914Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:33:14.914Z] E2E_TEST_MODE (env): true
[2025-11-22T21:33:14.914Z] E2E_TEST_MODE (final): true
[2025-11-22T21:33:14.914Z] X-Test-ID header: null
[2025-11-22T21:33:14.914Z] Will use test ID?: false
[2025-11-22T21:33:14.915Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:33:14.915Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:33:14.915Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:33:14.915Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:33:14.915Z] E2E_TEST_MODE (env): true
[2025-11-22T21:33:14.915Z] E2E_TEST_MODE (final): true
[2025-11-22T21:33:14.915Z] X-Test-ID header: null
[2025-11-22T21:33:14.915Z] Will use test ID?: false
[2025-11-22T21:33:14.916Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:33:14.916Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:33:14.916Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:14.916Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:33:14.916Z] Identifier: test-sliding-1763847194916
[2025-11-22T21:33:14.916Z] Key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:14.916Z] üìù Creating new entry for key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:14.916Z] Current count after filter: 0
[2025-11-22T21:33:14.916Z] Max requests allowed: 3
[2025-11-22T21:33:14.916Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:14.916Z] New count: 1
[2025-11-22T21:33:14.916Z] Remaining: 2
[2025-11-22T21:33:14.916Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.016Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.016Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:33:15.017Z] Identifier: test-sliding-1763847194916
[2025-11-22T21:33:15.017Z] Key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:15.017Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:15.017Z] Existing timestamps: 1
[2025-11-22T21:33:15.017Z] Current count after filter: 1
[2025-11-22T21:33:15.017Z] Max requests allowed: 3
[2025-11-22T21:33:15.017Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.017Z] New count: 2
[2025-11-22T21:33:15.017Z] Remaining: 1
[2025-11-22T21:33:15.017Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.118Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.119Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:33:15.119Z] Identifier: test-sliding-1763847194916
[2025-11-22T21:33:15.119Z] Key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:15.119Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763847194916
[2025-11-22T21:33:15.119Z] Existing timestamps: 2
[2025-11-22T21:33:15.119Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:33:15.119Z] Current count after filter: 1
[2025-11-22T21:33:15.119Z] Max requests allowed: 3
[2025-11-22T21:33:15.119Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.119Z] New count: 2
[2025-11-22T21:33:15.119Z] Remaining: 1
[2025-11-22T21:33:15.119Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.120Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:33:15.120Z] Identifier: test-format-allowed-1763847195120
[2025-11-22T21:33:15.120Z] Key: register:test-format-allowed-1763847195120
[2025-11-22T21:33:15.120Z] üìù Creating new entry for key: register:test-format-allowed-1763847195120
[2025-11-22T21:33:15.120Z] Current count after filter: 0
[2025-11-22T21:33:15.120Z] Max requests allowed: 3
[2025-11-22T21:33:15.120Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.120Z] New count: 1
[2025-11-22T21:33:15.120Z] Remaining: 2
[2025-11-22T21:33:15.120Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.120Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:33:15.121Z] Identifier: test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] üìù Creating new entry for key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Current count after filter: 0
[2025-11-22T21:33:15.121Z] Max requests allowed: 3
[2025-11-22T21:33:15.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.121Z] New count: 1
[2025-11-22T21:33:15.121Z] Remaining: 2
[2025-11-22T21:33:15.121Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.121Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.121Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:33:15.121Z] Identifier: test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] üìñ Found existing entry for key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Existing timestamps: 1
[2025-11-22T21:33:15.121Z] Current count after filter: 1
[2025-11-22T21:33:15.121Z] Max requests allowed: 3
[2025-11-22T21:33:15.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.121Z] New count: 2
[2025-11-22T21:33:15.121Z] Remaining: 1
[2025-11-22T21:33:15.121Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.121Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.121Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:33:15.121Z] Identifier: test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] üìñ Found existing entry for key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.121Z] Existing timestamps: 2
[2025-11-22T21:33:15.121Z] Current count after filter: 2
[2025-11-22T21:33:15.121Z] Max requests allowed: 3
[2025-11-22T21:33:15.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:33:15.122Z] New count: 3
[2025-11-22T21:33:15.122Z] Remaining: 0
[2025-11-22T21:33:15.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:33:15.122Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:33:15.122Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:33:15.122Z] Identifier: test-format-blocked-1763847195120
[2025-11-22T21:33:15.122Z] Key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.122Z] üìñ Found existing entry for key: register:test-format-blocked-1763847195120
[2025-11-22T21:33:15.122Z] Existing timestamps: 3
[2025-11-22T21:33:15.122Z] Current count after filter: 3
[2025-11-22T21:33:15.122Z] Max requests allowed: 3
[2025-11-22T21:33:15.122Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:33:15.122Z] Current count: 3
[2025-11-22T21:33:15.122Z] Max allowed: 3
[2025-11-22T21:33:15.122Z] Retry after (seconds): 60
[2025-11-22T21:33:15.122Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:08.528Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.529Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.530Z] Identifier: test-allow-1763847848528
[2025-11-22T21:44:08.530Z] Key: login:test-allow-1763847848528
[2025-11-22T21:44:08.530Z] üìù Creating new entry for key: login:test-allow-1763847848528
[2025-11-22T21:44:08.530Z] Current count after filter: 0
[2025-11-22T21:44:08.530Z] Max requests allowed: 5
[2025-11-22T21:44:08.530Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.530Z] New count: 1
[2025-11-22T21:44:08.530Z] Remaining: 4
[2025-11-22T21:44:08.530Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.531Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.531Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.531Z] Identifier: test-allow-1763847848528
[2025-11-22T21:44:08.531Z] Key: login:test-allow-1763847848528
[2025-11-22T21:44:08.531Z] üìñ Found existing entry for key: login:test-allow-1763847848528
[2025-11-22T21:44:08.531Z] Existing timestamps: 1
[2025-11-22T21:44:08.531Z] Current count after filter: 1
[2025-11-22T21:44:08.531Z] Max requests allowed: 5
[2025-11-22T21:44:08.531Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.531Z] New count: 2
[2025-11-22T21:44:08.531Z] Remaining: 3
[2025-11-22T21:44:08.531Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.531Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.531Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.531Z] Identifier: test-allow-1763847848528
[2025-11-22T21:44:08.531Z] Key: login:test-allow-1763847848528
[2025-11-22T21:44:08.531Z] üìñ Found existing entry for key: login:test-allow-1763847848528
[2025-11-22T21:44:08.531Z] Existing timestamps: 2
[2025-11-22T21:44:08.531Z] Current count after filter: 2
[2025-11-22T21:44:08.531Z] Max requests allowed: 5
[2025-11-22T21:44:08.532Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.532Z] New count: 3
[2025-11-22T21:44:08.532Z] Remaining: 2
[2025-11-22T21:44:08.532Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.532Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.532Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.532Z] Identifier: test-allow-1763847848528
[2025-11-22T21:44:08.532Z] Key: login:test-allow-1763847848528
[2025-11-22T21:44:08.532Z] üìñ Found existing entry for key: login:test-allow-1763847848528
[2025-11-22T21:44:08.532Z] Existing timestamps: 3
[2025-11-22T21:44:08.532Z] Current count after filter: 3
[2025-11-22T21:44:08.532Z] Max requests allowed: 5
[2025-11-22T21:44:08.532Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.532Z] New count: 4
[2025-11-22T21:44:08.532Z] Remaining: 1
[2025-11-22T21:44:08.532Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.532Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.532Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.532Z] Identifier: test-allow-1763847848528
[2025-11-22T21:44:08.532Z] Key: login:test-allow-1763847848528
[2025-11-22T21:44:08.532Z] üìñ Found existing entry for key: login:test-allow-1763847848528
[2025-11-22T21:44:08.532Z] Existing timestamps: 4
[2025-11-22T21:44:08.532Z] Current count after filter: 4
[2025-11-22T21:44:08.532Z] Max requests allowed: 5
[2025-11-22T21:44:08.532Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.532Z] New count: 5
[2025-11-22T21:44:08.532Z] Remaining: 0
[2025-11-22T21:44:08.532Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.533Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.534Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.534Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.534Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.534Z] üìù Creating new entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.534Z] Current count after filter: 0
[2025-11-22T21:44:08.534Z] Max requests allowed: 5
[2025-11-22T21:44:08.534Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.534Z] New count: 1
[2025-11-22T21:44:08.534Z] Remaining: 4
[2025-11-22T21:44:08.534Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.534Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.534Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.534Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.534Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.534Z] üìñ Found existing entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.534Z] Existing timestamps: 1
[2025-11-22T21:44:08.534Z] Current count after filter: 1
[2025-11-22T21:44:08.534Z] Max requests allowed: 5
[2025-11-22T21:44:08.534Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.534Z] New count: 2
[2025-11-22T21:44:08.534Z] Remaining: 3
[2025-11-22T21:44:08.534Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.534Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.534Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.534Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.534Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] üìñ Found existing entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] Existing timestamps: 2
[2025-11-22T21:44:08.535Z] Current count after filter: 2
[2025-11-22T21:44:08.535Z] Max requests allowed: 5
[2025-11-22T21:44:08.535Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.535Z] New count: 3
[2025-11-22T21:44:08.535Z] Remaining: 2
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.535Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.535Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.535Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] üìñ Found existing entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] Existing timestamps: 3
[2025-11-22T21:44:08.535Z] Current count after filter: 3
[2025-11-22T21:44:08.535Z] Max requests allowed: 5
[2025-11-22T21:44:08.535Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.535Z] New count: 4
[2025-11-22T21:44:08.535Z] Remaining: 1
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.535Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.535Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.535Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] üìñ Found existing entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.535Z] Existing timestamps: 4
[2025-11-22T21:44:08.535Z] Current count after filter: 4
[2025-11-22T21:44:08.535Z] Max requests allowed: 5
[2025-11-22T21:44:08.535Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.535Z] New count: 5
[2025-11-22T21:44:08.535Z] Remaining: 0
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.535Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.535Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.535Z] Identifier: test-block-1763847848533
[2025-11-22T21:44:08.536Z] Key: login:test-block-1763847848533
[2025-11-22T21:44:08.536Z] üìñ Found existing entry for key: login:test-block-1763847848533
[2025-11-22T21:44:08.536Z] Existing timestamps: 5
[2025-11-22T21:44:08.536Z] Current count after filter: 5
[2025-11-22T21:44:08.536Z] Max requests allowed: 5
[2025-11-22T21:44:08.536Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:08.536Z] Current count: 5
[2025-11-22T21:44:08.536Z] Max allowed: 5
[2025-11-22T21:44:08.536Z] Retry after (seconds): 60
[2025-11-22T21:44:08.536Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:08.536Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.536Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:44:08.536Z] Identifier: test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] üìù Creating new entry for key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Current count after filter: 0
[2025-11-22T21:44:08.537Z] Max requests allowed: 2
[2025-11-22T21:44:08.537Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.537Z] New count: 1
[2025-11-22T21:44:08.537Z] Remaining: 1
[2025-11-22T21:44:08.537Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.537Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.537Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:44:08.537Z] Identifier: test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] üìñ Found existing entry for key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Existing timestamps: 1
[2025-11-22T21:44:08.537Z] Current count after filter: 1
[2025-11-22T21:44:08.537Z] Max requests allowed: 2
[2025-11-22T21:44:08.537Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.537Z] New count: 2
[2025-11-22T21:44:08.537Z] Remaining: 0
[2025-11-22T21:44:08.537Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.537Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.537Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:44:08.537Z] Identifier: test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] üìñ Found existing entry for key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.537Z] Existing timestamps: 2
[2025-11-22T21:44:08.537Z] Current count after filter: 2
[2025-11-22T21:44:08.537Z] Max requests allowed: 2
[2025-11-22T21:44:08.537Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:08.537Z] Current count: 2
[2025-11-22T21:44:08.537Z] Max allowed: 2
[2025-11-22T21:44:08.537Z] Retry after (seconds): 1
[2025-11-22T21:44:08.537Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:08.688Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.689Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-22T21:44:08.689Z] Identifier: test-reset-1763847848536
[2025-11-22T21:44:08.689Z] Key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.689Z] üìñ Found existing entry for key: test-reset:test-reset-1763847848536
[2025-11-22T21:44:08.689Z] Existing timestamps: 2
[2025-11-22T21:44:08.689Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-22T21:44:08.689Z] Current count after filter: 0
[2025-11-22T21:44:08.689Z] Max requests allowed: 2
[2025-11-22T21:44:08.689Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.689Z] New count: 1
[2025-11-22T21:44:08.689Z] Remaining: 1
[2025-11-22T21:44:08.690Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.691Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.691Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.691Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.691Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.691Z] üìù Creating new entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.691Z] Current count after filter: 0
[2025-11-22T21:44:08.691Z] Max requests allowed: 5
[2025-11-22T21:44:08.691Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.691Z] New count: 1
[2025-11-22T21:44:08.691Z] Remaining: 4
[2025-11-22T21:44:08.691Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.692Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.692Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.692Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] üìñ Found existing entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Existing timestamps: 1
[2025-11-22T21:44:08.692Z] Current count after filter: 1
[2025-11-22T21:44:08.692Z] Max requests allowed: 5
[2025-11-22T21:44:08.692Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.692Z] New count: 2
[2025-11-22T21:44:08.692Z] Remaining: 3
[2025-11-22T21:44:08.692Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.692Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.692Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.692Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] üìñ Found existing entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Existing timestamps: 2
[2025-11-22T21:44:08.692Z] Current count after filter: 2
[2025-11-22T21:44:08.692Z] Max requests allowed: 5
[2025-11-22T21:44:08.692Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.692Z] New count: 3
[2025-11-22T21:44:08.692Z] Remaining: 2
[2025-11-22T21:44:08.692Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.692Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.692Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.692Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] üìñ Found existing entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.692Z] Existing timestamps: 3
[2025-11-22T21:44:08.692Z] Current count after filter: 3
[2025-11-22T21:44:08.692Z] Max requests allowed: 5
[2025-11-22T21:44:08.692Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.693Z] New count: 4
[2025-11-22T21:44:08.693Z] Remaining: 1
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.693Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.693Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] üìñ Found existing entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] Existing timestamps: 4
[2025-11-22T21:44:08.693Z] Current count after filter: 4
[2025-11-22T21:44:08.693Z] Max requests allowed: 5
[2025-11-22T21:44:08.693Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.693Z] New count: 5
[2025-11-22T21:44:08.693Z] Remaining: 0
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.693Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.693Z] Identifier: test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] Key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] üìñ Found existing entry for key: login:test-multi-1-1763847848691
[2025-11-22T21:44:08.693Z] Existing timestamps: 5
[2025-11-22T21:44:08.693Z] Current count after filter: 5
[2025-11-22T21:44:08.693Z] Max requests allowed: 5
[2025-11-22T21:44:08.693Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:08.693Z] Current count: 5
[2025-11-22T21:44:08.693Z] Max allowed: 5
[2025-11-22T21:44:08.693Z] Retry after (seconds): 60
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:08.693Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.693Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.693Z] Identifier: test-multi-2-1763847848691
[2025-11-22T21:44:08.693Z] Key: login:test-multi-2-1763847848691
[2025-11-22T21:44:08.693Z] üìù Creating new entry for key: login:test-multi-2-1763847848691
[2025-11-22T21:44:08.694Z] Current count after filter: 0
[2025-11-22T21:44:08.694Z] Max requests allowed: 5
[2025-11-22T21:44:08.694Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.694Z] New count: 1
[2025-11-22T21:44:08.694Z] Remaining: 4
[2025-11-22T21:44:08.694Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.694Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.694Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:08.694Z] Identifier: test-reset-time-1763847848694
[2025-11-22T21:44:08.694Z] Key: login:test-reset-time-1763847848694
[2025-11-22T21:44:08.694Z] üìù Creating new entry for key: login:test-reset-time-1763847848694
[2025-11-22T21:44:08.694Z] Current count after filter: 0
[2025-11-22T21:44:08.694Z] Max requests allowed: 5
[2025-11-22T21:44:08.694Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.694Z] New count: 1
[2025-11-22T21:44:08.694Z] Remaining: 4
[2025-11-22T21:44:08.695Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.697Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:08.697Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:44:08.697Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:08.697Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:08.697Z] X-Test-ID header: null
[2025-11-22T21:44:08.697Z] Will use test ID?: false
[2025-11-22T21:44:08.697Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:44:08.697Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:08.698Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:08.698Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:44:08.698Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:08.698Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:08.698Z] X-Test-ID header: null
[2025-11-22T21:44:08.698Z] Will use test ID?: false
[2025-11-22T21:44:08.698Z] Using real IP: 192.168.1.2
[2025-11-22T21:44:08.698Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:08.699Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:08.699Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:44:08.699Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:08.699Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:08.699Z] X-Test-ID header: null
[2025-11-22T21:44:08.699Z] Will use test ID?: false
[2025-11-22T21:44:08.700Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:44:08.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:08.700Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:08.700Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:44:08.700Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:08.700Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:08.700Z] X-Test-ID header: null
[2025-11-22T21:44:08.700Z] Will use test ID?: false
[2025-11-22T21:44:08.700Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:08.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:08.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:08.701Z] E2E_TEST_MODE (process.env): undefined
[2025-11-22T21:44:08.701Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:08.701Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:08.701Z] X-Test-ID header: null
[2025-11-22T21:44:08.701Z] Will use test ID?: false
[2025-11-22T21:44:08.701Z] Using forwarded IP: 192.168.1.1
[2025-11-22T21:44:08.701Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:08.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.701Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:44:08.701Z] Identifier: test-sliding-1763847848701
[2025-11-22T21:44:08.701Z] Key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.701Z] üìù Creating new entry for key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.701Z] Current count after filter: 0
[2025-11-22T21:44:08.702Z] Max requests allowed: 3
[2025-11-22T21:44:08.702Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.703Z] New count: 1
[2025-11-22T21:44:08.703Z] Remaining: 2
[2025-11-22T21:44:08.703Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.804Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.804Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:44:08.805Z] Identifier: test-sliding-1763847848701
[2025-11-22T21:44:08.805Z] Key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.805Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.805Z] Existing timestamps: 1
[2025-11-22T21:44:08.805Z] Current count after filter: 1
[2025-11-22T21:44:08.805Z] Max requests allowed: 3
[2025-11-22T21:44:08.805Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.805Z] New count: 2
[2025-11-22T21:44:08.805Z] Remaining: 1
[2025-11-22T21:44:08.805Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.906Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.907Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-22T21:44:08.907Z] Identifier: test-sliding-1763847848701
[2025-11-22T21:44:08.907Z] Key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.907Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763847848701
[2025-11-22T21:44:08.907Z] Existing timestamps: 2
[2025-11-22T21:44:08.907Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-22T21:44:08.907Z] Current count after filter: 1
[2025-11-22T21:44:08.907Z] Max requests allowed: 3
[2025-11-22T21:44:08.907Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.907Z] New count: 2
[2025-11-22T21:44:08.907Z] Remaining: 1
[2025-11-22T21:44:08.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.907Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.907Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:08.908Z] Identifier: test-format-allowed-1763847848907
[2025-11-22T21:44:08.908Z] Key: register:test-format-allowed-1763847848907
[2025-11-22T21:44:08.908Z] üìù Creating new entry for key: register:test-format-allowed-1763847848907
[2025-11-22T21:44:08.908Z] Current count after filter: 0
[2025-11-22T21:44:08.908Z] Max requests allowed: 3
[2025-11-22T21:44:08.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.908Z] New count: 1
[2025-11-22T21:44:08.908Z] Remaining: 2
[2025-11-22T21:44:08.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.908Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:08.908Z] Identifier: test-format-blocked-1763847848908
[2025-11-22T21:44:08.908Z] Key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.908Z] üìù Creating new entry for key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.908Z] Current count after filter: 0
[2025-11-22T21:44:08.908Z] Max requests allowed: 3
[2025-11-22T21:44:08.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.908Z] New count: 1
[2025-11-22T21:44:08.908Z] Remaining: 2
[2025-11-22T21:44:08.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.909Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:08.909Z] Identifier: test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] üìñ Found existing entry for key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Existing timestamps: 1
[2025-11-22T21:44:08.909Z] Current count after filter: 1
[2025-11-22T21:44:08.909Z] Max requests allowed: 3
[2025-11-22T21:44:08.909Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.909Z] New count: 2
[2025-11-22T21:44:08.909Z] Remaining: 1
[2025-11-22T21:44:08.909Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.909Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.909Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:08.909Z] Identifier: test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] üìñ Found existing entry for key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Existing timestamps: 2
[2025-11-22T21:44:08.909Z] Current count after filter: 2
[2025-11-22T21:44:08.909Z] Max requests allowed: 3
[2025-11-22T21:44:08.909Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:08.909Z] New count: 3
[2025-11-22T21:44:08.909Z] Remaining: 0
[2025-11-22T21:44:08.909Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:08.909Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:08.909Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:08.909Z] Identifier: test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] üìñ Found existing entry for key: register:test-format-blocked-1763847848908
[2025-11-22T21:44:08.909Z] Existing timestamps: 3
[2025-11-22T21:44:08.909Z] Current count after filter: 3
[2025-11-22T21:44:08.909Z] Max requests allowed: 3
[2025-11-22T21:44:08.909Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:08.909Z] Current count: 3
[2025-11-22T21:44:08.909Z] Max allowed: 3
[2025-11-22T21:44:08.909Z] Retry after (seconds): 60
[2025-11-22T21:44:08.909Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:21.229Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:21.230Z] Request URL: /auth/token
[2025-11-22T21:44:21.230Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:21.231Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:21.231Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:21.231Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:21.231Z] X-Test-ID header: null
[2025-11-22T21:44:21.231Z] Will use test ID?: false
[2025-11-22T21:44:21.231Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:21.231Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:21.231Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:21.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:21.231Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:21.231Z] Identifier: unknown
[2025-11-22T21:44:21.231Z] Key: token:unknown
[2025-11-22T21:44:21.231Z] üìù Creating new entry for key: token:unknown
[2025-11-22T21:44:21.231Z] Current count after filter: 0
[2025-11-22T21:44:21.231Z] Max requests allowed: 60
[2025-11-22T21:44:21.231Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:21.231Z] New count: 1
[2025-11-22T21:44:21.231Z] Remaining: 59
[2025-11-22T21:44:21.231Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:21.231Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:21.232Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:21.232Z] Request URL: /auth/token
[2025-11-22T21:44:21.232Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:21.232Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:21.232Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:21.232Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:21.232Z] X-Test-ID header: null
[2025-11-22T21:44:21.232Z] Will use test ID?: false
[2025-11-22T21:44:21.233Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:21.233Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:21.233Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:21.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:21.233Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:21.233Z] Identifier: unknown
[2025-11-22T21:44:21.233Z] Key: token:unknown
[2025-11-22T21:44:21.233Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:21.233Z] Existing timestamps: 1
[2025-11-22T21:44:21.233Z] Current count after filter: 1
[2025-11-22T21:44:21.233Z] Max requests allowed: 60
[2025-11-22T21:44:21.233Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:21.233Z] New count: 2
[2025-11-22T21:44:21.233Z] Remaining: 58
[2025-11-22T21:44:21.233Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:21.233Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:21.829Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:21.829Z] Request URL: /auth/token
[2025-11-22T21:44:21.829Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:21.829Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:21.829Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:21.829Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:21.830Z] X-Test-ID header: null
[2025-11-22T21:44:21.830Z] Will use test ID?: false
[2025-11-22T21:44:21.830Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:21.830Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:21.830Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:21.830Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:21.830Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:21.830Z] Identifier: unknown
[2025-11-22T21:44:21.830Z] Key: token:unknown
[2025-11-22T21:44:21.830Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:21.830Z] Existing timestamps: 2
[2025-11-22T21:44:21.830Z] Current count after filter: 2
[2025-11-22T21:44:21.830Z] Max requests allowed: 60
[2025-11-22T21:44:21.830Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:21.830Z] New count: 3
[2025-11-22T21:44:21.830Z] Remaining: 57
[2025-11-22T21:44:21.830Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:21.830Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:21.831Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:21.831Z] Request URL: /auth/token
[2025-11-22T21:44:21.831Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:21.831Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:21.831Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:21.831Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:21.831Z] X-Test-ID header: null
[2025-11-22T21:44:21.831Z] Will use test ID?: false
[2025-11-22T21:44:21.831Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:21.831Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:21.831Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:21.831Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:21.831Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:21.831Z] Identifier: unknown
[2025-11-22T21:44:21.831Z] Key: token:unknown
[2025-11-22T21:44:21.831Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:21.831Z] Existing timestamps: 3
[2025-11-22T21:44:21.831Z] Current count after filter: 3
[2025-11-22T21:44:21.831Z] Max requests allowed: 60
[2025-11-22T21:44:21.831Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:21.831Z] New count: 4
[2025-11-22T21:44:21.831Z] Remaining: 56
[2025-11-22T21:44:21.831Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:21.831Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:22.454Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:22.454Z] Request URL: /auth/token
[2025-11-22T21:44:22.455Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:22.455Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:22.455Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:22.455Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:22.455Z] X-Test-ID header: null
[2025-11-22T21:44:22.455Z] Will use test ID?: false
[2025-11-22T21:44:22.455Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:22.455Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:22.455Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:22.455Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:22.455Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:22.455Z] Identifier: unknown
[2025-11-22T21:44:22.455Z] Key: token:unknown
[2025-11-22T21:44:22.455Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:22.455Z] Existing timestamps: 4
[2025-11-22T21:44:22.455Z] Current count after filter: 4
[2025-11-22T21:44:22.455Z] Max requests allowed: 60
[2025-11-22T21:44:22.455Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:22.455Z] New count: 5
[2025-11-22T21:44:22.455Z] Remaining: 55
[2025-11-22T21:44:22.455Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:22.456Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:23.061Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:23.061Z] Request URL: /auth/token
[2025-11-22T21:44:23.061Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:23.061Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:23.062Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:23.062Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:23.062Z] X-Test-ID header: null
[2025-11-22T21:44:23.062Z] Will use test ID?: false
[2025-11-22T21:44:23.062Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:23.062Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:23.062Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:23.062Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:23.062Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:23.062Z] Identifier: unknown
[2025-11-22T21:44:23.062Z] Key: token:unknown
[2025-11-22T21:44:23.062Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:23.062Z] Existing timestamps: 5
[2025-11-22T21:44:23.062Z] Current count after filter: 5
[2025-11-22T21:44:23.062Z] Max requests allowed: 60
[2025-11-22T21:44:23.062Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:23.062Z] New count: 6
[2025-11-22T21:44:23.062Z] Remaining: 54
[2025-11-22T21:44:23.062Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:23.062Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:23.905Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:23.905Z] Request URL: /auth/register
[2025-11-22T21:44:23.905Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:23.905Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:23.905Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:23.905Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:23.905Z] X-Test-ID header: null
[2025-11-22T21:44:23.905Z] Will use test ID?: false
[2025-11-22T21:44:23.905Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:23.905Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:23.905Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:23.905Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:23.906Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:23.906Z] Identifier: unknown
[2025-11-22T21:44:23.906Z] Key: register:unknown
[2025-11-22T21:44:23.906Z] üìù Creating new entry for key: register:unknown
[2025-11-22T21:44:23.906Z] Current count after filter: 0
[2025-11-22T21:44:23.906Z] Max requests allowed: 3
[2025-11-22T21:44:23.906Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:23.906Z] New count: 1
[2025-11-22T21:44:23.906Z] Remaining: 2
[2025-11-22T21:44:23.906Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:23.906Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847923905
}
[2025-11-22T21:44:24.632Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:24.633Z] Request URL: /auth/token
[2025-11-22T21:44:24.633Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:24.633Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:24.633Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:24.633Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:24.633Z] X-Test-ID header: null
[2025-11-22T21:44:24.633Z] Will use test ID?: false
[2025-11-22T21:44:24.633Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:24.633Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:24.633Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:24.633Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:24.633Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:24.633Z] Identifier: unknown
[2025-11-22T21:44:24.633Z] Key: token:unknown
[2025-11-22T21:44:24.634Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:24.634Z] Existing timestamps: 6
[2025-11-22T21:44:24.634Z] Current count after filter: 6
[2025-11-22T21:44:24.634Z] Max requests allowed: 60
[2025-11-22T21:44:24.634Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:24.634Z] New count: 7
[2025-11-22T21:44:24.634Z] Remaining: 53
[2025-11-22T21:44:24.634Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:24.634Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:25.221Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-22T21:44:25.221Z] Request URL: /auth/token
[2025-11-22T21:44:25.221Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:25.221Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:25.221Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:25.221Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:25.221Z] X-Test-ID header: null
[2025-11-22T21:44:25.221Z] Will use test ID?: false
[2025-11-22T21:44:25.222Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:25.222Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:25.222Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:25.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:25.222Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-22T21:44:25.222Z] Identifier: unknown
[2025-11-22T21:44:25.222Z] Key: token:unknown
[2025-11-22T21:44:25.222Z] üìñ Found existing entry for key: token:unknown
[2025-11-22T21:44:25.222Z] Existing timestamps: 7
[2025-11-22T21:44:25.222Z] Current count after filter: 7
[2025-11-22T21:44:25.223Z] Max requests allowed: 60
[2025-11-22T21:44:25.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:25.223Z] New count: 8
[2025-11-22T21:44:25.223Z] Remaining: 52
[2025-11-22T21:44:25.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:25.223Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763847921231
}
[2025-11-22T21:44:25.260Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:25.261Z] Request URL: /auth/verify-email
[2025-11-22T21:44:25.261Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:25.261Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:25.261Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:25.261Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:25.261Z] X-Test-ID header: null
[2025-11-22T21:44:25.261Z] Will use test ID?: false
[2025-11-22T21:44:25.261Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:25.261Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:25.261Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:25.262Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:25.262Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:25.262Z] Identifier: unknown
[2025-11-22T21:44:25.262Z] Key: login:unknown
[2025-11-22T21:44:25.262Z] üìù Creating new entry for key: login:unknown
[2025-11-22T21:44:25.262Z] Current count after filter: 0
[2025-11-22T21:44:25.262Z] Max requests allowed: 5
[2025-11-22T21:44:25.262Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:25.263Z] New count: 1
[2025-11-22T21:44:25.263Z] Remaining: 4
[2025-11-22T21:44:25.263Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:25.263Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847925262
}
[2025-11-22T21:44:28.322Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:28.322Z] Request URL: /auth/forgot-password
[2025-11-22T21:44:28.322Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:28.322Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:28.322Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:28.322Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:28.322Z] X-Test-ID header: null
[2025-11-22T21:44:28.322Z] Will use test ID?: false
[2025-11-22T21:44:28.322Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:28.322Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:28.322Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:28.322Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:28.322Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:28.323Z] Identifier: unknown
[2025-11-22T21:44:28.323Z] Key: login:unknown
[2025-11-22T21:44:28.323Z] üìñ Found existing entry for key: login:unknown
[2025-11-22T21:44:28.323Z] Existing timestamps: 1
[2025-11-22T21:44:28.323Z] Current count after filter: 1
[2025-11-22T21:44:28.323Z] Max requests allowed: 5
[2025-11-22T21:44:28.323Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:28.323Z] New count: 2
[2025-11-22T21:44:28.323Z] Remaining: 3
[2025-11-22T21:44:28.323Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:28.323Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847925262
}
[2025-11-22T21:44:30.239Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:30.239Z] Request URL: /auth/register
[2025-11-22T21:44:30.239Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:30.250Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:30.250Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:30.250Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:30.250Z] X-Test-ID header: null
[2025-11-22T21:44:30.250Z] Will use test ID?: false
[2025-11-22T21:44:30.250Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:30.250Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:30.250Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:30.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:30.251Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:30.251Z] Identifier: unknown
[2025-11-22T21:44:30.251Z] Key: register:unknown
[2025-11-22T21:44:30.251Z] üìñ Found existing entry for key: register:unknown
[2025-11-22T21:44:30.251Z] Existing timestamps: 1
[2025-11-22T21:44:30.251Z] Current count after filter: 1
[2025-11-22T21:44:30.251Z] Max requests allowed: 3
[2025-11-22T21:44:30.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:30.251Z] New count: 2
[2025-11-22T21:44:30.251Z] Remaining: 1
[2025-11-22T21:44:30.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:30.251Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847923905
}
[2025-11-22T21:44:30.422Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:30.422Z] Request URL: /auth/reset-password
[2025-11-22T21:44:30.423Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:30.423Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:30.423Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:30.423Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:30.423Z] X-Test-ID header: null
[2025-11-22T21:44:30.423Z] Will use test ID?: false
[2025-11-22T21:44:30.423Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-22T21:44:30.423Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:30.423Z] Got identifier from getClientIdentifier: unknown
[2025-11-22T21:44:30.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:30.423Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:30.423Z] Identifier: unknown
[2025-11-22T21:44:30.423Z] Key: login:unknown
[2025-11-22T21:44:30.423Z] üìñ Found existing entry for key: login:unknown
[2025-11-22T21:44:30.423Z] Existing timestamps: 2
[2025-11-22T21:44:30.423Z] Current count after filter: 2
[2025-11-22T21:44:30.423Z] Max requests allowed: 5
[2025-11-22T21:44:30.428Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:30.434Z] New count: 3
[2025-11-22T21:44:30.434Z] Remaining: 2
[2025-11-22T21:44:30.437Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:30.437Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847925262
}
[2025-11-22T21:44:30.714Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:30.714Z] Request URL: /auth/verify-email
[2025-11-22T21:44:30.714Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:30.714Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:30.716Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:30.716Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:30.716Z] X-Test-ID header: rate-limit-test-1763847869216
[2025-11-22T21:44:30.716Z] Will use test ID?: true
[2025-11-22T21:44:30.717Z] ‚úÖ Using test identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:30.717Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:30.717Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:30.717Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:30.717Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:30.717Z] Identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:30.717Z] Key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:30.717Z] üìù Creating new entry for key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:30.717Z] Current count after filter: 0
[2025-11-22T21:44:30.717Z] Max requests allowed: 5
[2025-11-22T21:44:30.717Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:30.717Z] New count: 1
[2025-11-22T21:44:30.717Z] Remaining: 4
[2025-11-22T21:44:30.717Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:30.717Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847930717
}
[2025-11-22T21:44:31.037Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:31.038Z] Request URL: /auth/verify-email
[2025-11-22T21:44:31.072Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:31.072Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:31.073Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:31.073Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:31.073Z] X-Test-ID header: rate-limit-test-1763847869216
[2025-11-22T21:44:31.073Z] Will use test ID?: true
[2025-11-22T21:44:31.073Z] ‚úÖ Using test identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.073Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:31.074Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.074Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:31.074Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:31.074Z] Identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.074Z] Key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.074Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.074Z] Existing timestamps: 1
[2025-11-22T21:44:31.074Z] Current count after filter: 1
[2025-11-22T21:44:31.074Z] Max requests allowed: 5
[2025-11-22T21:44:31.074Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:31.074Z] New count: 2
[2025-11-22T21:44:31.074Z] Remaining: 3
[2025-11-22T21:44:31.074Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:31.074Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847930717
}
[2025-11-22T21:44:31.385Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:31.385Z] Request URL: /auth/verify-email
[2025-11-22T21:44:31.385Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:31.386Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:31.386Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:31.386Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:31.386Z] X-Test-ID header: rate-limit-test-1763847869216
[2025-11-22T21:44:31.386Z] Will use test ID?: true
[2025-11-22T21:44:31.386Z] ‚úÖ Using test identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.386Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:31.386Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:31.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:31.386Z] Identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.388Z] Key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.388Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.388Z] Existing timestamps: 2
[2025-11-22T21:44:31.389Z] Current count after filter: 2
[2025-11-22T21:44:31.389Z] Max requests allowed: 5
[2025-11-22T21:44:31.389Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:31.389Z] New count: 3
[2025-11-22T21:44:31.389Z] Remaining: 2
[2025-11-22T21:44:31.390Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:31.390Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847930717
}
[2025-11-22T21:44:31.687Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:31.687Z] Request URL: /auth/verify-email
[2025-11-22T21:44:31.687Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:31.687Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:31.687Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:31.687Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:31.687Z] X-Test-ID header: rate-limit-test-1763847869216
[2025-11-22T21:44:31.688Z] Will use test ID?: true
[2025-11-22T21:44:31.688Z] ‚úÖ Using test identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.688Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:31.688Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.688Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:31.688Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:31.689Z] Identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.689Z] Key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.689Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.689Z] Existing timestamps: 3
[2025-11-22T21:44:31.689Z] Current count after filter: 3
[2025-11-22T21:44:31.689Z] Max requests allowed: 5
[2025-11-22T21:44:31.689Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:31.689Z] New count: 4
[2025-11-22T21:44:31.689Z] Remaining: 1
[2025-11-22T21:44:31.690Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:31.690Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847930717
}
[2025-11-22T21:44:31.991Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:31.991Z] Request URL: /auth/verify-email
[2025-11-22T21:44:31.991Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:31.991Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:31.991Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:31.992Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:31.992Z] X-Test-ID header: rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] Will use test ID?: true
[2025-11-22T21:44:31.992Z] ‚úÖ Using test identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:31.992Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:31.992Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:31.992Z] Identifier: test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] Key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763847869216
[2025-11-22T21:44:31.992Z] Existing timestamps: 4
[2025-11-22T21:44:31.992Z] Current count after filter: 4
[2025-11-22T21:44:31.992Z] Max requests allowed: 5
[2025-11-22T21:44:31.992Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:31.992Z] New count: 5
[2025-11-22T21:44:31.992Z] Remaining: 0
[2025-11-22T21:44:31.992Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:31.992Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763847930717
}
[2025-11-22T21:44:33.310Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:33.313Z] Request URL: /auth/login
[2025-11-22T21:44:33.319Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:33.323Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:33.331Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:33.331Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:33.331Z] X-Test-ID header: login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] Will use test ID?: true
[2025-11-22T21:44:33.332Z] ‚úÖ Using test identifier: test:login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:33.332Z] Got identifier from getClientIdentifier: test:login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:33.332Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:33.332Z] Identifier: test:login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] Key: login:test:login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] üìù Creating new entry for key: login:test:login-headers-1763847872956-sm2lr
[2025-11-22T21:44:33.332Z] Current count after filter: 0
[2025-11-22T21:44:33.332Z] Max requests allowed: 5
[2025-11-22T21:44:33.332Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:33.332Z] New count: 1
[2025-11-22T21:44:33.333Z] Remaining: 4
[2025-11-22T21:44:33.333Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:33.333Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847933332
}
[2025-11-22T21:44:33.656Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:33.657Z] Request URL: /auth/register
[2025-11-22T21:44:33.657Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:33.657Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:33.658Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:33.658Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:33.658Z] X-Test-ID header: register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.659Z] Will use test ID?: true
[2025-11-22T21:44:33.659Z] ‚úÖ Using test identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.659Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:33.659Z] Got identifier from getClientIdentifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:33.659Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:33.661Z] Identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.662Z] Key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.662Z] üìù Creating new entry for key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:33.662Z] Current count after filter: 0
[2025-11-22T21:44:33.662Z] Max requests allowed: 3
[2025-11-22T21:44:33.663Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:33.663Z] New count: 1
[2025-11-22T21:44:33.663Z] Remaining: 2
[2025-11-22T21:44:33.665Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:33.665Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847933659
}
[2025-11-22T21:44:33.894Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:33.894Z] Request URL: /auth/login
[2025-11-22T21:44:33.894Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:33.894Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:33.894Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:33.894Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:33.894Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.894Z] Will use test ID?: true
[2025-11-22T21:44:33.894Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.894Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:33.894Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.896Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:33.896Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:33.896Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.896Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.896Z] üìù Creating new entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:33.896Z] Current count after filter: 0
[2025-11-22T21:44:33.896Z] Max requests allowed: 5
[2025-11-22T21:44:33.896Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:33.897Z] New count: 1
[2025-11-22T21:44:33.897Z] Remaining: 4
[2025-11-22T21:44:33.897Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:33.897Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847933896
}
[2025-11-22T21:44:34.002Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:34.002Z] Request URL: /auth/register
[2025-11-22T21:44:34.003Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.003Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.003Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.003Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.003Z] X-Test-ID header: register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] Will use test ID?: true
[2025-11-22T21:44:34.003Z] ‚úÖ Using test identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.003Z] Got identifier from getClientIdentifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.003Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:34.003Z] Identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] Key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] üìñ Found existing entry for key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.003Z] Existing timestamps: 1
[2025-11-22T21:44:34.003Z] Current count after filter: 1
[2025-11-22T21:44:34.003Z] Max requests allowed: 3
[2025-11-22T21:44:34.003Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.003Z] New count: 2
[2025-11-22T21:44:34.003Z] Remaining: 1
[2025-11-22T21:44:34.004Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.004Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847933659
}
[2025-11-22T21:44:34.165Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.165Z] Request URL: /auth/login
[2025-11-22T21:44:34.165Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.165Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.165Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.165Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.165Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.165Z] Will use test ID?: true
[2025-11-22T21:44:34.165Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.165Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.165Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.166Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.166Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.166Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.166Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.166Z] üìñ Found existing entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.166Z] Existing timestamps: 1
[2025-11-22T21:44:34.166Z] Current count after filter: 1
[2025-11-22T21:44:34.166Z] Max requests allowed: 5
[2025-11-22T21:44:34.166Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.166Z] New count: 2
[2025-11-22T21:44:34.166Z] Remaining: 3
[2025-11-22T21:44:34.166Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.166Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847933896
}
[2025-11-22T21:44:34.176Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:34.176Z] Request URL: /auth/register
[2025-11-22T21:44:34.177Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.178Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.178Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.178Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.178Z] X-Test-ID header: register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.178Z] Will use test ID?: true
[2025-11-22T21:44:34.178Z] ‚úÖ Using test identifier: test:register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.179Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.180Z] Got identifier from getClientIdentifier: test:register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.180Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.180Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:34.180Z] Identifier: test:register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.180Z] Key: register:test:register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.180Z] üìù Creating new entry for key: register:test:register-headers-1763847873862-3639zj
[2025-11-22T21:44:34.180Z] Current count after filter: 0
[2025-11-22T21:44:34.180Z] Max requests allowed: 3
[2025-11-22T21:44:34.180Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.180Z] New count: 1
[2025-11-22T21:44:34.180Z] Remaining: 2
[2025-11-22T21:44:34.180Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.180Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847934180
}
[2025-11-22T21:44:34.334Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:34.334Z] Request URL: /auth/register
[2025-11-22T21:44:34.334Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.334Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.334Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.334Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.334Z] X-Test-ID header: register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.334Z] Will use test ID?: true
[2025-11-22T21:44:34.334Z] ‚úÖ Using test identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.335Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.335Z] Got identifier from getClientIdentifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.335Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.335Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:34.335Z] Identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.336Z] Key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.337Z] üìñ Found existing entry for key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.337Z] Existing timestamps: 2
[2025-11-22T21:44:34.337Z] Current count after filter: 2
[2025-11-22T21:44:34.337Z] Max requests allowed: 3
[2025-11-22T21:44:34.337Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.337Z] New count: 3
[2025-11-22T21:44:34.337Z] Remaining: 0
[2025-11-22T21:44:34.337Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.337Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763847933659
}
[2025-11-22T21:44:34.442Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.442Z] Request URL: /auth/login
[2025-11-22T21:44:34.443Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.443Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.443Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.443Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.443Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.443Z] Will use test ID?: true
[2025-11-22T21:44:34.443Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.443Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.444Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.444Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.444Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.444Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.444Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.444Z] üìñ Found existing entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.444Z] Existing timestamps: 2
[2025-11-22T21:44:34.444Z] Current count after filter: 2
[2025-11-22T21:44:34.445Z] Max requests allowed: 5
[2025-11-22T21:44:34.445Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.445Z] New count: 3
[2025-11-22T21:44:34.445Z] Remaining: 2
[2025-11-22T21:44:34.445Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.445Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847933896
}
[2025-11-22T21:44:34.549Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.549Z] Request URL: /auth/login
[2025-11-22T21:44:34.549Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.549Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.550Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.550Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.551Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.551Z] Will use test ID?: true
[2025-11-22T21:44:34.552Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.552Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.552Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.554Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.554Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.554Z] üìù Creating new entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.554Z] Current count after filter: 0
[2025-11-22T21:44:34.554Z] Max requests allowed: 5
[2025-11-22T21:44:34.554Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.555Z] New count: 1
[2025-11-22T21:44:34.555Z] Remaining: 4
[2025-11-22T21:44:34.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.555Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847934552
}
[2025-11-22T21:44:34.740Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.740Z] Request URL: /auth/login
[2025-11-22T21:44:34.741Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.741Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.741Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.741Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.741Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.741Z] Will use test ID?: true
[2025-11-22T21:44:34.742Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.742Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.742Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.742Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.742Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.742Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.742Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.742Z] üìñ Found existing entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:34.742Z] Existing timestamps: 3
[2025-11-22T21:44:34.742Z] Current count after filter: 3
[2025-11-22T21:44:34.742Z] Max requests allowed: 5
[2025-11-22T21:44:34.742Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.742Z] New count: 4
[2025-11-22T21:44:34.743Z] Remaining: 1
[2025-11-22T21:44:34.743Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.743Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847933896
}
[2025-11-22T21:44:34.773Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:34.773Z] Request URL: /auth/register
[2025-11-22T21:44:34.778Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.778Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.779Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.779Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.779Z] X-Test-ID header: register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.779Z] Will use test ID?: true
[2025-11-22T21:44:34.781Z] ‚úÖ Using test identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.782Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.782Z] Got identifier from getClientIdentifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.782Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.782Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:34.782Z] Identifier: test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.782Z] Key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.783Z] üìñ Found existing entry for key: register:test:register-excessive-1763847873652-zyoqwm
[2025-11-22T21:44:34.783Z] Existing timestamps: 3
[2025-11-22T21:44:34.783Z] Current count after filter: 3
[2025-11-22T21:44:34.783Z] Max requests allowed: 3
[2025-11-22T21:44:34.783Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:34.785Z] Current count: 3
[2025-11-22T21:44:34.786Z] Max allowed: 3
[2025-11-22T21:44:34.786Z] Retry after (seconds): 59
[2025-11-22T21:44:34.786Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:34.786Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763847933659,
  "retryAfter": 59
}
[2025-11-22T21:44:34.787Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.787Z] Request URL: /auth/login
[2025-11-22T21:44:34.787Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.787Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.787Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.787Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.788Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] Will use test ID?: true
[2025-11-22T21:44:34.790Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.790Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.790Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.790Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:34.790Z] Existing timestamps: 1
[2025-11-22T21:44:34.790Z] Current count after filter: 1
[2025-11-22T21:44:34.790Z] Max requests allowed: 5
[2025-11-22T21:44:34.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.790Z] New count: 2
[2025-11-22T21:44:34.790Z] Remaining: 3
[2025-11-22T21:44:34.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.790Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847934552
}
[2025-11-22T21:44:34.863Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.863Z] Request URL: /auth/login
[2025-11-22T21:44:34.863Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.863Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.863Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.863Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.863Z] X-Test-ID header: headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.864Z] Will use test ID?: true
[2025-11-22T21:44:34.868Z] ‚úÖ Using test identifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.868Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.868Z] Got identifier from getClientIdentifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.868Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.869Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.869Z] Identifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.869Z] Key: login:test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.869Z] üìù Creating new entry for key: login:test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:34.869Z] Current count after filter: 0
[2025-11-22T21:44:34.880Z] Max requests allowed: 5
[2025-11-22T21:44:34.880Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.880Z] New count: 1
[2025-11-22T21:44:34.882Z] Remaining: 4
[2025-11-22T21:44:34.882Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.882Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847934868
}
[2025-11-22T21:44:34.955Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:34.955Z] Request URL: /auth/login
[2025-11-22T21:44:34.955Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:34.955Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:34.955Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:34.955Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:34.956Z] X-Test-ID header: headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.956Z] Will use test ID?: true
[2025-11-22T21:44:34.956Z] ‚úÖ Using test identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:34.956Z] Got identifier from getClientIdentifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.956Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:34.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:34.959Z] Identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.959Z] Key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.959Z] üìù Creating new entry for key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:34.961Z] Current count after filter: 0
[2025-11-22T21:44:34.962Z] Max requests allowed: 5
[2025-11-22T21:44:34.962Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:34.962Z] New count: 1
[2025-11-22T21:44:34.962Z] Remaining: 4
[2025-11-22T21:44:34.962Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:34.962Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847934956
}
[2025-11-22T21:44:35.049Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.049Z] Request URL: /auth/login
[2025-11-22T21:44:35.050Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.050Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.052Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.052Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.052Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.052Z] Will use test ID?: true
[2025-11-22T21:44:35.052Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.054Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.054Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.054Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.054Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.055Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.055Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.056Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.056Z] Existing timestamps: 2
[2025-11-22T21:44:35.056Z] Current count after filter: 2
[2025-11-22T21:44:35.056Z] Max requests allowed: 5
[2025-11-22T21:44:35.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.057Z] New count: 3
[2025-11-22T21:44:35.057Z] Remaining: 2
[2025-11-22T21:44:35.057Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.057Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847934552
}
[2025-11-22T21:44:35.060Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.060Z] Request URL: /auth/login
[2025-11-22T21:44:35.060Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.061Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.061Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.061Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.061Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.061Z] Will use test ID?: true
[2025-11-22T21:44:35.061Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.061Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.061Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.061Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.061Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.062Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.062Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.062Z] üìñ Found existing entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.063Z] Existing timestamps: 4
[2025-11-22T21:44:35.064Z] Current count after filter: 4
[2025-11-22T21:44:35.064Z] Max requests allowed: 5
[2025-11-22T21:44:35.067Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.067Z] New count: 5
[2025-11-22T21:44:35.067Z] Remaining: 0
[2025-11-22T21:44:35.067Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.068Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763847933896
}
[2025-11-22T21:44:35.142Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.142Z] Request URL: /auth/login
[2025-11-22T21:44:35.144Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.144Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.147Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.147Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.147Z] X-Test-ID header: headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.147Z] Will use test ID?: true
[2025-11-22T21:44:35.147Z] ‚úÖ Using test identifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.148Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.149Z] Got identifier from getClientIdentifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.149Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.149Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.149Z] Identifier: test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.149Z] Key: login:test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.149Z] üìñ Found existing entry for key: login:test:headers-consistent-1763847874858-2k4yt
[2025-11-22T21:44:35.149Z] Existing timestamps: 1
[2025-11-22T21:44:35.149Z] Current count after filter: 1
[2025-11-22T21:44:35.150Z] Max requests allowed: 5
[2025-11-22T21:44:35.150Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.150Z] New count: 2
[2025-11-22T21:44:35.150Z] Remaining: 3
[2025-11-22T21:44:35.150Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847934868
}
[2025-11-22T21:44:35.194Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.195Z] Request URL: /auth/login
[2025-11-22T21:44:35.197Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.197Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.197Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.197Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.197Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.197Z] Will use test ID?: true
[2025-11-22T21:44:35.197Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.197Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.197Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.197Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.197Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.197Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.197Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.197Z] üìù Creating new entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.201Z] Current count after filter: 0
[2025-11-22T21:44:35.201Z] Max requests allowed: 5
[2025-11-22T21:44:35.201Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.201Z] New count: 1
[2025-11-22T21:44:35.201Z] Remaining: 4
[2025-11-22T21:44:35.201Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.201Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847935197
}
[2025-11-22T21:44:35.302Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.302Z] Request URL: /auth/login
[2025-11-22T21:44:35.303Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.303Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.303Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.303Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.303Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.303Z] Will use test ID?: true
[2025-11-22T21:44:35.304Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.304Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.304Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.304Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.304Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.304Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.304Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.304Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.304Z] Existing timestamps: 3
[2025-11-22T21:44:35.304Z] Current count after filter: 3
[2025-11-22T21:44:35.304Z] Max requests allowed: 5
[2025-11-22T21:44:35.304Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.304Z] New count: 4
[2025-11-22T21:44:35.305Z] Remaining: 1
[2025-11-22T21:44:35.305Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.305Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847934552
}
[2025-11-22T21:44:35.363Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.363Z] Request URL: /auth/login
[2025-11-22T21:44:35.364Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.364Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.364Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.364Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.364Z] X-Test-ID header: login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.364Z] Will use test ID?: true
[2025-11-22T21:44:35.366Z] ‚úÖ Using test identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.366Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.366Z] Got identifier from getClientIdentifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.366Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.366Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.369Z] Identifier: test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.369Z] Key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.369Z] üìñ Found existing entry for key: login:test:login-excessive-1763847873549-39mj5p
[2025-11-22T21:44:35.369Z] Existing timestamps: 5
[2025-11-22T21:44:35.370Z] Current count after filter: 5
[2025-11-22T21:44:35.370Z] Max requests allowed: 5
[2025-11-22T21:44:35.370Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:35.370Z] Current count: 5
[2025-11-22T21:44:35.370Z] Max allowed: 5
[2025-11-22T21:44:35.370Z] Retry after (seconds): 59
[2025-11-22T21:44:35.370Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:35.370Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763847933896,
  "retryAfter": 59
}
[2025-11-22T21:44:35.382Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.382Z] Request URL: /auth/login
[2025-11-22T21:44:35.382Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.382Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.382Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.386Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.386Z] X-Test-ID header: headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.387Z] Will use test ID?: true
[2025-11-22T21:44:35.387Z] ‚úÖ Using test identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.387Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.387Z] Got identifier from getClientIdentifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.390Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.391Z] Identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.391Z] Key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.391Z] üìñ Found existing entry for key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.391Z] Existing timestamps: 1
[2025-11-22T21:44:35.391Z] Current count after filter: 1
[2025-11-22T21:44:35.391Z] Max requests allowed: 5
[2025-11-22T21:44:35.391Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.391Z] New count: 2
[2025-11-22T21:44:35.391Z] Remaining: 3
[2025-11-22T21:44:35.391Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.391Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847934956
}
[2025-11-22T21:44:35.402Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.402Z] Request URL: /auth/login
[2025-11-22T21:44:35.404Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.404Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.404Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.404Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.404Z] X-Test-ID header: perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.405Z] Will use test ID?: true
[2025-11-22T21:44:35.405Z] ‚úÖ Using test identifier: test:perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.405Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.406Z] Got identifier from getClientIdentifier: test:perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.406Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.406Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.406Z] Identifier: test:perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.406Z] Key: login:test:perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.406Z] üìù Creating new entry for key: login:test:perf-test-1763847875398-4ivxka
[2025-11-22T21:44:35.406Z] Current count after filter: 0
[2025-11-22T21:44:35.406Z] Max requests allowed: 5
[2025-11-22T21:44:35.406Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.406Z] New count: 1
[2025-11-22T21:44:35.406Z] Remaining: 4
[2025-11-22T21:44:35.406Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.406Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763847935406
}
[2025-11-22T21:44:35.524Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.525Z] Request URL: /auth/login
[2025-11-22T21:44:35.525Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.525Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.525Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.525Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.525Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] Will use test ID?: true
[2025-11-22T21:44:35.525Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.525Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.525Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.525Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.525Z] Existing timestamps: 4
[2025-11-22T21:44:35.525Z] Current count after filter: 4
[2025-11-22T21:44:35.525Z] Max requests allowed: 5
[2025-11-22T21:44:35.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.526Z] New count: 5
[2025-11-22T21:44:35.526Z] Remaining: 0
[2025-11-22T21:44:35.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.526Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763847934552
}
[2025-11-22T21:44:35.567Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.567Z] Request URL: /auth/login
[2025-11-22T21:44:35.567Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.567Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.567Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.567Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.567Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] Will use test ID?: true
[2025-11-22T21:44:35.567Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.567Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.567Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.567Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] üìñ Found existing entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.567Z] Existing timestamps: 1
[2025-11-22T21:44:35.568Z] Current count after filter: 1
[2025-11-22T21:44:35.568Z] Max requests allowed: 5
[2025-11-22T21:44:35.568Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.568Z] New count: 2
[2025-11-22T21:44:35.568Z] Remaining: 3
[2025-11-22T21:44:35.568Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.568Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763847935197
}
[2025-11-22T21:44:35.621Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.621Z] Request URL: /auth/login
[2025-11-22T21:44:35.621Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.621Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.621Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.621Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.621Z] X-Test-ID header: headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.621Z] Will use test ID?: true
[2025-11-22T21:44:35.621Z] ‚úÖ Using test identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.622Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.622Z] Got identifier from getClientIdentifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.622Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.622Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.622Z] Identifier: test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.622Z] Key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.622Z] üìñ Found existing entry for key: login:test:headers-remaining-1763847874567-xr5ygk
[2025-11-22T21:44:35.622Z] Existing timestamps: 2
[2025-11-22T21:44:35.622Z] Current count after filter: 2
[2025-11-22T21:44:35.622Z] Max requests allowed: 5
[2025-11-22T21:44:35.622Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.623Z] New count: 3
[2025-11-22T21:44:35.623Z] Remaining: 2
[2025-11-22T21:44:35.623Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.623Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847934956
}
[2025-11-22T21:44:35.753Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.753Z] Request URL: /auth/login
[2025-11-22T21:44:35.754Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.755Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.755Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.756Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.756Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] Will use test ID?: true
[2025-11-22T21:44:35.756Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.756Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.756Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.756Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] Key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.756Z] Existing timestamps: 5
[2025-11-22T21:44:35.756Z] Current count after filter: 5
[2025-11-22T21:44:35.757Z] Max requests allowed: 5
[2025-11-22T21:44:35.757Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:35.757Z] Current count: 5
[2025-11-22T21:44:35.757Z] Max allowed: 5
[2025-11-22T21:44:35.757Z] Retry after (seconds): 59
[2025-11-22T21:44:35.757Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:35.757Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763847934552,
  "retryAfter": 59
}
[2025-11-22T21:44:35.784Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-22T21:44:35.784Z] Request URL: /auth/register
[2025-11-22T21:44:35.784Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.787Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.789Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.789Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.789Z] X-Test-ID header: independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.790Z] Will use test ID?: true
[2025-11-22T21:44:35.795Z] ‚úÖ Using test identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.795Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.795Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.795Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.795Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-22T21:44:35.795Z] Identifier: test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.795Z] Key: register:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.795Z] üìù Creating new entry for key: register:test:independent-endpoints-1763847874541-w5a4o
[2025-11-22T21:44:35.796Z] Current count after filter: 0
[2025-11-22T21:44:35.796Z] Max requests allowed: 3
[2025-11-22T21:44:35.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.796Z] New count: 1
[2025-11-22T21:44:35.796Z] Remaining: 2
[2025-11-22T21:44:35.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.796Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847935795
}
[2025-11-22T21:44:35.812Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:35.812Z] Request URL: /auth/login
[2025-11-22T21:44:35.812Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:35.812Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:35.813Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:35.813Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:35.813Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] Will use test ID?: true
[2025-11-22T21:44:35.813Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:35.813Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:35.813Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:35.813Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] üìñ Found existing entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:35.813Z] Existing timestamps: 2
[2025-11-22T21:44:35.813Z] Current count after filter: 2
[2025-11-22T21:44:35.813Z] Max requests allowed: 5
[2025-11-22T21:44:35.813Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:35.813Z] New count: 3
[2025-11-22T21:44:35.813Z] Remaining: 2
[2025-11-22T21:44:35.813Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:35.813Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763847935197
}
[2025-11-22T21:44:36.053Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:36.053Z] Request URL: /auth/login
[2025-11-22T21:44:36.054Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:36.054Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:36.054Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:36.054Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:36.054Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.054Z] Will use test ID?: true
[2025-11-22T21:44:36.054Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.054Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:36.055Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.055Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:36.055Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:36.055Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.056Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.056Z] üìñ Found existing entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.056Z] Existing timestamps: 3
[2025-11-22T21:44:36.056Z] Current count after filter: 3
[2025-11-22T21:44:36.056Z] Max requests allowed: 5
[2025-11-22T21:44:36.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:36.056Z] New count: 4
[2025-11-22T21:44:36.057Z] Remaining: 1
[2025-11-22T21:44:36.057Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:36.057Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763847935197
}
[2025-11-22T21:44:36.267Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:36.268Z] Request URL: /auth/login
[2025-11-22T21:44:36.268Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:36.268Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:36.268Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:36.268Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:36.268Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.268Z] Will use test ID?: true
[2025-11-22T21:44:36.268Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.269Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:36.269Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.269Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:36.269Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:36.269Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.269Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.269Z] üìñ Found existing entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.270Z] Existing timestamps: 4
[2025-11-22T21:44:36.270Z] Current count after filter: 4
[2025-11-22T21:44:36.270Z] Max requests allowed: 5
[2025-11-22T21:44:36.270Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-22T21:44:36.270Z] New count: 5
[2025-11-22T21:44:36.270Z] Remaining: 0
[2025-11-22T21:44:36.270Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-22T21:44:36.270Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763847935197
}
[2025-11-22T21:44:36.544Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-22T21:44:36.544Z] Request URL: /auth/login
[2025-11-22T21:44:36.545Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-22T21:44:36.545Z] E2E_TEST_MODE (process.env): true
[2025-11-22T21:44:36.545Z] E2E_TEST_MODE (env): true
[2025-11-22T21:44:36.545Z] E2E_TEST_MODE (final): true
[2025-11-22T21:44:36.545Z] X-Test-ID header: login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.545Z] Will use test ID?: true
[2025-11-22T21:44:36.545Z] ‚úÖ Using test identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.546Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-22T21:44:36.546Z] Got identifier from getClientIdentifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.546Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-22T21:44:36.546Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-22T21:44:36.546Z] Identifier: test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.547Z] Key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.547Z] üìñ Found existing entry for key: login:test:login-retry-after-1763847874784-cjbhp
[2025-11-22T21:44:36.547Z] Existing timestamps: 5
[2025-11-22T21:44:36.547Z] Current count after filter: 5
[2025-11-22T21:44:36.547Z] Max requests allowed: 5
[2025-11-22T21:44:36.547Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-22T21:44:36.547Z] Current count: 5
[2025-11-22T21:44:36.547Z] Max allowed: 5
[2025-11-22T21:44:36.547Z] Retry after (seconds): 59
[2025-11-22T21:44:36.547Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-22T21:44:36.547Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763847935197,
  "retryAfter": 59
}
[2025-11-23T08:04:11.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.223Z] Identifier: test-allow-1763885051221
[2025-11-23T08:04:11.223Z] Key: login:test-allow-1763885051221
[2025-11-23T08:04:11.223Z] üìù Creating new entry for key: login:test-allow-1763885051221
[2025-11-23T08:04:11.223Z] Current count after filter: 0
[2025-11-23T08:04:11.223Z] Max requests allowed: 5
[2025-11-23T08:04:11.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.223Z] New count: 1
[2025-11-23T08:04:11.223Z] Remaining: 4
[2025-11-23T08:04:11.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.223Z] Identifier: test-allow-1763885051221
[2025-11-23T08:04:11.223Z] Key: login:test-allow-1763885051221
[2025-11-23T08:04:11.223Z] üìñ Found existing entry for key: login:test-allow-1763885051221
[2025-11-23T08:04:11.223Z] Existing timestamps: 1
[2025-11-23T08:04:11.223Z] Current count after filter: 1
[2025-11-23T08:04:11.224Z] Max requests allowed: 5
[2025-11-23T08:04:11.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.224Z] New count: 2
[2025-11-23T08:04:11.224Z] Remaining: 3
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.224Z] Identifier: test-allow-1763885051221
[2025-11-23T08:04:11.224Z] Key: login:test-allow-1763885051221
[2025-11-23T08:04:11.224Z] üìñ Found existing entry for key: login:test-allow-1763885051221
[2025-11-23T08:04:11.224Z] Existing timestamps: 2
[2025-11-23T08:04:11.224Z] Current count after filter: 2
[2025-11-23T08:04:11.224Z] Max requests allowed: 5
[2025-11-23T08:04:11.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.224Z] New count: 3
[2025-11-23T08:04:11.224Z] Remaining: 2
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.224Z] Identifier: test-allow-1763885051221
[2025-11-23T08:04:11.224Z] Key: login:test-allow-1763885051221
[2025-11-23T08:04:11.224Z] üìñ Found existing entry for key: login:test-allow-1763885051221
[2025-11-23T08:04:11.224Z] Existing timestamps: 3
[2025-11-23T08:04:11.224Z] Current count after filter: 3
[2025-11-23T08:04:11.224Z] Max requests allowed: 5
[2025-11-23T08:04:11.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.224Z] New count: 4
[2025-11-23T08:04:11.224Z] Remaining: 1
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.224Z] Identifier: test-allow-1763885051221
[2025-11-23T08:04:11.225Z] Key: login:test-allow-1763885051221
[2025-11-23T08:04:11.225Z] üìñ Found existing entry for key: login:test-allow-1763885051221
[2025-11-23T08:04:11.225Z] Existing timestamps: 4
[2025-11-23T08:04:11.225Z] Current count after filter: 4
[2025-11-23T08:04:11.225Z] Max requests allowed: 5
[2025-11-23T08:04:11.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.225Z] New count: 5
[2025-11-23T08:04:11.225Z] Remaining: 0
[2025-11-23T08:04:11.225Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.225Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.225Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.225Z] üìù Creating new entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.225Z] Current count after filter: 0
[2025-11-23T08:04:11.226Z] Max requests allowed: 5
[2025-11-23T08:04:11.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.226Z] New count: 1
[2025-11-23T08:04:11.226Z] Remaining: 4
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.226Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.226Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.226Z] üìñ Found existing entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.226Z] Existing timestamps: 1
[2025-11-23T08:04:11.226Z] Current count after filter: 1
[2025-11-23T08:04:11.226Z] Max requests allowed: 5
[2025-11-23T08:04:11.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.226Z] New count: 2
[2025-11-23T08:04:11.226Z] Remaining: 3
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.226Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.226Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.226Z] üìñ Found existing entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.226Z] Existing timestamps: 2
[2025-11-23T08:04:11.226Z] Current count after filter: 2
[2025-11-23T08:04:11.226Z] Max requests allowed: 5
[2025-11-23T08:04:11.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.226Z] New count: 3
[2025-11-23T08:04:11.226Z] Remaining: 2
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.227Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.227Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] üìñ Found existing entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] Existing timestamps: 3
[2025-11-23T08:04:11.227Z] Current count after filter: 3
[2025-11-23T08:04:11.227Z] Max requests allowed: 5
[2025-11-23T08:04:11.227Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.227Z] New count: 4
[2025-11-23T08:04:11.227Z] Remaining: 1
[2025-11-23T08:04:11.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.227Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.227Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.227Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.227Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] üìñ Found existing entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] Existing timestamps: 4
[2025-11-23T08:04:11.227Z] Current count after filter: 4
[2025-11-23T08:04:11.227Z] Max requests allowed: 5
[2025-11-23T08:04:11.227Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.227Z] New count: 5
[2025-11-23T08:04:11.227Z] Remaining: 0
[2025-11-23T08:04:11.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.227Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.227Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.227Z] Identifier: test-block-1763885051225
[2025-11-23T08:04:11.227Z] Key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] üìñ Found existing entry for key: login:test-block-1763885051225
[2025-11-23T08:04:11.227Z] Existing timestamps: 5
[2025-11-23T08:04:11.227Z] Current count after filter: 5
[2025-11-23T08:04:11.227Z] Max requests allowed: 5
[2025-11-23T08:04:11.227Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:04:11.227Z] Current count: 5
[2025-11-23T08:04:11.228Z] Max allowed: 5
[2025-11-23T08:04:11.228Z] Retry after (seconds): 60
[2025-11-23T08:04:11.228Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:04:11.228Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.228Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:04:11.228Z] Identifier: test-reset-1763885051228
[2025-11-23T08:04:11.228Z] Key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.228Z] üìù Creating new entry for key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.228Z] Current count after filter: 0
[2025-11-23T08:04:11.228Z] Max requests allowed: 2
[2025-11-23T08:04:11.228Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.228Z] New count: 1
[2025-11-23T08:04:11.229Z] Remaining: 1
[2025-11-23T08:04:11.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.229Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:04:11.229Z] Identifier: test-reset-1763885051228
[2025-11-23T08:04:11.229Z] Key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.229Z] üìñ Found existing entry for key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.229Z] Existing timestamps: 1
[2025-11-23T08:04:11.229Z] Current count after filter: 1
[2025-11-23T08:04:11.229Z] Max requests allowed: 2
[2025-11-23T08:04:11.229Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.229Z] New count: 2
[2025-11-23T08:04:11.229Z] Remaining: 0
[2025-11-23T08:04:11.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.229Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:04:11.229Z] Identifier: test-reset-1763885051228
[2025-11-23T08:04:11.229Z] Key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.229Z] üìñ Found existing entry for key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.229Z] Existing timestamps: 2
[2025-11-23T08:04:11.229Z] Current count after filter: 2
[2025-11-23T08:04:11.229Z] Max requests allowed: 2
[2025-11-23T08:04:11.229Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:04:11.229Z] Current count: 2
[2025-11-23T08:04:11.229Z] Max allowed: 2
[2025-11-23T08:04:11.229Z] Retry after (seconds): 1
[2025-11-23T08:04:11.229Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:04:11.380Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.380Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:04:11.380Z] Identifier: test-reset-1763885051228
[2025-11-23T08:04:11.380Z] Key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.380Z] üìñ Found existing entry for key: test-reset:test-reset-1763885051228
[2025-11-23T08:04:11.380Z] Existing timestamps: 2
[2025-11-23T08:04:11.380Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-23T08:04:11.380Z] Current count after filter: 0
[2025-11-23T08:04:11.380Z] Max requests allowed: 2
[2025-11-23T08:04:11.380Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.380Z] New count: 1
[2025-11-23T08:04:11.380Z] Remaining: 1
[2025-11-23T08:04:11.380Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.380Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.380Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.381Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] üìù Creating new entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] Current count after filter: 0
[2025-11-23T08:04:11.381Z] Max requests allowed: 5
[2025-11-23T08:04:11.381Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.381Z] New count: 1
[2025-11-23T08:04:11.381Z] Remaining: 4
[2025-11-23T08:04:11.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.381Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] üìñ Found existing entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] Existing timestamps: 1
[2025-11-23T08:04:11.381Z] Current count after filter: 1
[2025-11-23T08:04:11.381Z] Max requests allowed: 5
[2025-11-23T08:04:11.381Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.381Z] New count: 2
[2025-11-23T08:04:11.381Z] Remaining: 3
[2025-11-23T08:04:11.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.381Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.381Z] üìñ Found existing entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] Existing timestamps: 2
[2025-11-23T08:04:11.382Z] Current count after filter: 2
[2025-11-23T08:04:11.382Z] Max requests allowed: 5
[2025-11-23T08:04:11.382Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.382Z] New count: 3
[2025-11-23T08:04:11.382Z] Remaining: 2
[2025-11-23T08:04:11.382Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.382Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.382Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.382Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] üìñ Found existing entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] Existing timestamps: 3
[2025-11-23T08:04:11.382Z] Current count after filter: 3
[2025-11-23T08:04:11.382Z] Max requests allowed: 5
[2025-11-23T08:04:11.382Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.382Z] New count: 4
[2025-11-23T08:04:11.382Z] Remaining: 1
[2025-11-23T08:04:11.382Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.382Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.382Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.382Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] üìñ Found existing entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.382Z] Existing timestamps: 4
[2025-11-23T08:04:11.383Z] Current count after filter: 4
[2025-11-23T08:04:11.383Z] Max requests allowed: 5
[2025-11-23T08:04:11.383Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.383Z] New count: 5
[2025-11-23T08:04:11.383Z] Remaining: 0
[2025-11-23T08:04:11.383Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.383Z] Identifier: test-multi-1-1763885051380
[2025-11-23T08:04:11.383Z] Key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.383Z] üìñ Found existing entry for key: login:test-multi-1-1763885051380
[2025-11-23T08:04:11.383Z] Existing timestamps: 5
[2025-11-23T08:04:11.383Z] Current count after filter: 5
[2025-11-23T08:04:11.383Z] Max requests allowed: 5
[2025-11-23T08:04:11.383Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:04:11.383Z] Current count: 5
[2025-11-23T08:04:11.383Z] Max allowed: 5
[2025-11-23T08:04:11.383Z] Retry after (seconds): 60
[2025-11-23T08:04:11.383Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:04:11.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.383Z] Identifier: test-multi-2-1763885051380
[2025-11-23T08:04:11.383Z] Key: login:test-multi-2-1763885051380
[2025-11-23T08:04:11.383Z] üìù Creating new entry for key: login:test-multi-2-1763885051380
[2025-11-23T08:04:11.383Z] Current count after filter: 0
[2025-11-23T08:04:11.383Z] Max requests allowed: 5
[2025-11-23T08:04:11.383Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.384Z] New count: 1
[2025-11-23T08:04:11.384Z] Remaining: 4
[2025-11-23T08:04:11.384Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.384Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.384Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:04:11.384Z] Identifier: test-reset-time-1763885051384
[2025-11-23T08:04:11.384Z] Key: login:test-reset-time-1763885051384
[2025-11-23T08:04:11.384Z] üìù Creating new entry for key: login:test-reset-time-1763885051384
[2025-11-23T08:04:11.384Z] Current count after filter: 0
[2025-11-23T08:04:11.385Z] Max requests allowed: 5
[2025-11-23T08:04:11.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.385Z] New count: 1
[2025-11-23T08:04:11.385Z] Remaining: 4
[2025-11-23T08:04:11.385Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.386Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:04:11.386Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:04:11.386Z] E2E_TEST_MODE (env): true
[2025-11-23T08:04:11.386Z] E2E_TEST_MODE (final): true
[2025-11-23T08:04:11.386Z] X-Test-ID header: null
[2025-11-23T08:04:11.386Z] Will use test ID?: false
[2025-11-23T08:04:11.386Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:04:11.386Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:04:11.386Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:04:11.386Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:04:11.387Z] E2E_TEST_MODE (env): true
[2025-11-23T08:04:11.387Z] E2E_TEST_MODE (final): true
[2025-11-23T08:04:11.387Z] X-Test-ID header: null
[2025-11-23T08:04:11.387Z] Will use test ID?: false
[2025-11-23T08:04:11.387Z] Using real IP: 192.168.1.2
[2025-11-23T08:04:11.387Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:04:11.387Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:04:11.387Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:04:11.387Z] E2E_TEST_MODE (env): true
[2025-11-23T08:04:11.387Z] E2E_TEST_MODE (final): true
[2025-11-23T08:04:11.387Z] X-Test-ID header: null
[2025-11-23T08:04:11.387Z] Will use test ID?: false
[2025-11-23T08:04:11.387Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:04:11.387Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:04:11.388Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (env): true
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (final): true
[2025-11-23T08:04:11.388Z] X-Test-ID header: null
[2025-11-23T08:04:11.388Z] Will use test ID?: false
[2025-11-23T08:04:11.388Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-23T08:04:11.388Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:04:11.388Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (env): true
[2025-11-23T08:04:11.388Z] E2E_TEST_MODE (final): true
[2025-11-23T08:04:11.389Z] X-Test-ID header: null
[2025-11-23T08:04:11.389Z] Will use test ID?: false
[2025-11-23T08:04:11.389Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:04:11.389Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:04:11.389Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.389Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:04:11.389Z] Identifier: test-sliding-1763885051389
[2025-11-23T08:04:11.389Z] Key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.389Z] üìù Creating new entry for key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.389Z] Current count after filter: 0
[2025-11-23T08:04:11.390Z] Max requests allowed: 3
[2025-11-23T08:04:11.390Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.390Z] New count: 1
[2025-11-23T08:04:11.390Z] Remaining: 2
[2025-11-23T08:04:11.390Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.491Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:04:11.491Z] Identifier: test-sliding-1763885051389
[2025-11-23T08:04:11.491Z] Key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.491Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.491Z] Existing timestamps: 1
[2025-11-23T08:04:11.491Z] Current count after filter: 1
[2025-11-23T08:04:11.491Z] Max requests allowed: 3
[2025-11-23T08:04:11.491Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.491Z] New count: 2
[2025-11-23T08:04:11.491Z] Remaining: 1
[2025-11-23T08:04:11.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.593Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:04:11.593Z] Identifier: test-sliding-1763885051389
[2025-11-23T08:04:11.593Z] Key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.593Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763885051389
[2025-11-23T08:04:11.593Z] Existing timestamps: 2
[2025-11-23T08:04:11.593Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-23T08:04:11.593Z] Current count after filter: 1
[2025-11-23T08:04:11.593Z] Max requests allowed: 3
[2025-11-23T08:04:11.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.593Z] New count: 2
[2025-11-23T08:04:11.593Z] Remaining: 1
[2025-11-23T08:04:11.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.594Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:04:11.594Z] Identifier: test-format-allowed-1763885051594
[2025-11-23T08:04:11.594Z] Key: register:test-format-allowed-1763885051594
[2025-11-23T08:04:11.594Z] üìù Creating new entry for key: register:test-format-allowed-1763885051594
[2025-11-23T08:04:11.594Z] Current count after filter: 0
[2025-11-23T08:04:11.594Z] Max requests allowed: 3
[2025-11-23T08:04:11.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.594Z] New count: 1
[2025-11-23T08:04:11.594Z] Remaining: 2
[2025-11-23T08:04:11.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.594Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:04:11.594Z] Identifier: test-format-blocked-1763885051594
[2025-11-23T08:04:11.594Z] Key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.594Z] üìù Creating new entry for key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.594Z] Current count after filter: 0
[2025-11-23T08:04:11.594Z] Max requests allowed: 3
[2025-11-23T08:04:11.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.594Z] New count: 1
[2025-11-23T08:04:11.595Z] Remaining: 2
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.595Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:04:11.595Z] Identifier: test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] üìñ Found existing entry for key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Existing timestamps: 1
[2025-11-23T08:04:11.595Z] Current count after filter: 1
[2025-11-23T08:04:11.595Z] Max requests allowed: 3
[2025-11-23T08:04:11.595Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.595Z] New count: 2
[2025-11-23T08:04:11.595Z] Remaining: 1
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.595Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:04:11.595Z] Identifier: test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] üìñ Found existing entry for key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Existing timestamps: 2
[2025-11-23T08:04:11.595Z] Current count after filter: 2
[2025-11-23T08:04:11.595Z] Max requests allowed: 3
[2025-11-23T08:04:11.595Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:04:11.595Z] New count: 3
[2025-11-23T08:04:11.595Z] Remaining: 0
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:04:11.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:04:11.595Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:04:11.595Z] Identifier: test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] üìñ Found existing entry for key: register:test-format-blocked-1763885051594
[2025-11-23T08:04:11.595Z] Existing timestamps: 3
[2025-11-23T08:04:11.595Z] Current count after filter: 3
[2025-11-23T08:04:11.595Z] Max requests allowed: 3
[2025-11-23T08:04:11.595Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:04:11.595Z] Current count: 3
[2025-11-23T08:04:11.595Z] Max allowed: 3
[2025-11-23T08:04:11.596Z] Retry after (seconds): 60
[2025-11-23T08:04:11.596Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:06:56.259Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.260Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.260Z] Identifier: test-allow-1763885216259
[2025-11-23T08:06:56.260Z] Key: login:test-allow-1763885216259
[2025-11-23T08:06:56.260Z] üìù Creating new entry for key: login:test-allow-1763885216259
[2025-11-23T08:06:56.260Z] Current count after filter: 0
[2025-11-23T08:06:56.260Z] Max requests allowed: 5
[2025-11-23T08:06:56.260Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.260Z] New count: 1
[2025-11-23T08:06:56.260Z] Remaining: 4
[2025-11-23T08:06:56.260Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.261Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.261Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.261Z] Identifier: test-allow-1763885216259
[2025-11-23T08:06:56.261Z] Key: login:test-allow-1763885216259
[2025-11-23T08:06:56.261Z] üìñ Found existing entry for key: login:test-allow-1763885216259
[2025-11-23T08:06:56.261Z] Existing timestamps: 1
[2025-11-23T08:06:56.261Z] Current count after filter: 1
[2025-11-23T08:06:56.261Z] Max requests allowed: 5
[2025-11-23T08:06:56.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.261Z] New count: 2
[2025-11-23T08:06:56.261Z] Remaining: 3
[2025-11-23T08:06:56.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.261Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.261Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.261Z] Identifier: test-allow-1763885216259
[2025-11-23T08:06:56.261Z] Key: login:test-allow-1763885216259
[2025-11-23T08:06:56.261Z] üìñ Found existing entry for key: login:test-allow-1763885216259
[2025-11-23T08:06:56.261Z] Existing timestamps: 2
[2025-11-23T08:06:56.261Z] Current count after filter: 2
[2025-11-23T08:06:56.261Z] Max requests allowed: 5
[2025-11-23T08:06:56.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.261Z] New count: 3
[2025-11-23T08:06:56.261Z] Remaining: 2
[2025-11-23T08:06:56.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.262Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.262Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.262Z] Identifier: test-allow-1763885216259
[2025-11-23T08:06:56.262Z] Key: login:test-allow-1763885216259
[2025-11-23T08:06:56.262Z] üìñ Found existing entry for key: login:test-allow-1763885216259
[2025-11-23T08:06:56.262Z] Existing timestamps: 3
[2025-11-23T08:06:56.262Z] Current count after filter: 3
[2025-11-23T08:06:56.262Z] Max requests allowed: 5
[2025-11-23T08:06:56.263Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.263Z] New count: 4
[2025-11-23T08:06:56.263Z] Remaining: 1
[2025-11-23T08:06:56.263Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.263Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.263Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.263Z] Identifier: test-allow-1763885216259
[2025-11-23T08:06:56.263Z] Key: login:test-allow-1763885216259
[2025-11-23T08:06:56.263Z] üìñ Found existing entry for key: login:test-allow-1763885216259
[2025-11-23T08:06:56.263Z] Existing timestamps: 4
[2025-11-23T08:06:56.263Z] Current count after filter: 4
[2025-11-23T08:06:56.263Z] Max requests allowed: 5
[2025-11-23T08:06:56.263Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.263Z] New count: 5
[2025-11-23T08:06:56.263Z] Remaining: 0
[2025-11-23T08:06:56.263Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.264Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.264Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.264Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.264Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.264Z] üìù Creating new entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.264Z] Current count after filter: 0
[2025-11-23T08:06:56.264Z] Max requests allowed: 5
[2025-11-23T08:06:56.264Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.264Z] New count: 1
[2025-11-23T08:06:56.264Z] Remaining: 4
[2025-11-23T08:06:56.264Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.264Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.264Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.264Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.264Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.264Z] üìñ Found existing entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.265Z] Existing timestamps: 1
[2025-11-23T08:06:56.265Z] Current count after filter: 1
[2025-11-23T08:06:56.265Z] Max requests allowed: 5
[2025-11-23T08:06:56.265Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.265Z] New count: 2
[2025-11-23T08:06:56.265Z] Remaining: 3
[2025-11-23T08:06:56.265Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.265Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.265Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.265Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.265Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.265Z] üìñ Found existing entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.265Z] Existing timestamps: 2
[2025-11-23T08:06:56.265Z] Current count after filter: 2
[2025-11-23T08:06:56.265Z] Max requests allowed: 5
[2025-11-23T08:06:56.265Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.265Z] New count: 3
[2025-11-23T08:06:56.265Z] Remaining: 2
[2025-11-23T08:06:56.265Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.265Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.265Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.265Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.265Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.265Z] üìñ Found existing entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.265Z] Existing timestamps: 3
[2025-11-23T08:06:56.265Z] Current count after filter: 3
[2025-11-23T08:06:56.265Z] Max requests allowed: 5
[2025-11-23T08:06:56.265Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.265Z] New count: 4
[2025-11-23T08:06:56.265Z] Remaining: 1
[2025-11-23T08:06:56.265Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.266Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.266Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.266Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.266Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.266Z] üìñ Found existing entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.266Z] Existing timestamps: 4
[2025-11-23T08:06:56.266Z] Current count after filter: 4
[2025-11-23T08:06:56.266Z] Max requests allowed: 5
[2025-11-23T08:06:56.266Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.266Z] New count: 5
[2025-11-23T08:06:56.266Z] Remaining: 0
[2025-11-23T08:06:56.266Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.266Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.266Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.266Z] Identifier: test-block-1763885216264
[2025-11-23T08:06:56.266Z] Key: login:test-block-1763885216264
[2025-11-23T08:06:56.266Z] üìñ Found existing entry for key: login:test-block-1763885216264
[2025-11-23T08:06:56.266Z] Existing timestamps: 5
[2025-11-23T08:06:56.266Z] Current count after filter: 5
[2025-11-23T08:06:56.266Z] Max requests allowed: 5
[2025-11-23T08:06:56.266Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:06:56.266Z] Current count: 5
[2025-11-23T08:06:56.266Z] Max allowed: 5
[2025-11-23T08:06:56.266Z] Retry after (seconds): 60
[2025-11-23T08:06:56.266Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:06:56.267Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.267Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:06:56.267Z] Identifier: test-reset-1763885216267
[2025-11-23T08:06:56.267Z] Key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.267Z] üìù Creating new entry for key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.267Z] Current count after filter: 0
[2025-11-23T08:06:56.267Z] Max requests allowed: 2
[2025-11-23T08:06:56.267Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.267Z] New count: 1
[2025-11-23T08:06:56.267Z] Remaining: 1
[2025-11-23T08:06:56.267Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.267Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.267Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:06:56.267Z] Identifier: test-reset-1763885216267
[2025-11-23T08:06:56.267Z] Key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.268Z] üìñ Found existing entry for key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.268Z] Existing timestamps: 1
[2025-11-23T08:06:56.268Z] Current count after filter: 1
[2025-11-23T08:06:56.268Z] Max requests allowed: 2
[2025-11-23T08:06:56.268Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.268Z] New count: 2
[2025-11-23T08:06:56.268Z] Remaining: 0
[2025-11-23T08:06:56.268Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.268Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.268Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:06:56.268Z] Identifier: test-reset-1763885216267
[2025-11-23T08:06:56.268Z] Key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.268Z] üìñ Found existing entry for key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.268Z] Existing timestamps: 2
[2025-11-23T08:06:56.268Z] Current count after filter: 2
[2025-11-23T08:06:56.268Z] Max requests allowed: 2
[2025-11-23T08:06:56.268Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:06:56.268Z] Current count: 2
[2025-11-23T08:06:56.268Z] Max allowed: 2
[2025-11-23T08:06:56.268Z] Retry after (seconds): 1
[2025-11-23T08:06:56.268Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:06:56.420Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.420Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-23T08:06:56.420Z] Identifier: test-reset-1763885216267
[2025-11-23T08:06:56.420Z] Key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.420Z] üìñ Found existing entry for key: test-reset:test-reset-1763885216267
[2025-11-23T08:06:56.420Z] Existing timestamps: 2
[2025-11-23T08:06:56.420Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-23T08:06:56.420Z] Current count after filter: 0
[2025-11-23T08:06:56.420Z] Max requests allowed: 2
[2025-11-23T08:06:56.420Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.420Z] New count: 1
[2025-11-23T08:06:56.420Z] Remaining: 1
[2025-11-23T08:06:56.420Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.421Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.421Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] üìù Creating new entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] Current count after filter: 0
[2025-11-23T08:06:56.421Z] Max requests allowed: 5
[2025-11-23T08:06:56.421Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.421Z] New count: 1
[2025-11-23T08:06:56.421Z] Remaining: 4
[2025-11-23T08:06:56.421Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.421Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.421Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] üìñ Found existing entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.421Z] Existing timestamps: 1
[2025-11-23T08:06:56.421Z] Current count after filter: 1
[2025-11-23T08:06:56.422Z] Max requests allowed: 5
[2025-11-23T08:06:56.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.422Z] New count: 2
[2025-11-23T08:06:56.422Z] Remaining: 3
[2025-11-23T08:06:56.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.422Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.422Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.422Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.422Z] üìñ Found existing entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.422Z] Existing timestamps: 2
[2025-11-23T08:06:56.422Z] Current count after filter: 2
[2025-11-23T08:06:56.422Z] Max requests allowed: 5
[2025-11-23T08:06:56.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.422Z] New count: 3
[2025-11-23T08:06:56.422Z] Remaining: 2
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.423Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.423Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] üìñ Found existing entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] Existing timestamps: 3
[2025-11-23T08:06:56.423Z] Current count after filter: 3
[2025-11-23T08:06:56.423Z] Max requests allowed: 5
[2025-11-23T08:06:56.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.423Z] New count: 4
[2025-11-23T08:06:56.423Z] Remaining: 1
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.423Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.423Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] üìñ Found existing entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.423Z] Existing timestamps: 4
[2025-11-23T08:06:56.423Z] Current count after filter: 4
[2025-11-23T08:06:56.423Z] Max requests allowed: 5
[2025-11-23T08:06:56.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.423Z] New count: 5
[2025-11-23T08:06:56.423Z] Remaining: 0
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.423Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.423Z] Identifier: test-multi-1-1763885216421
[2025-11-23T08:06:56.424Z] Key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.424Z] üìñ Found existing entry for key: login:test-multi-1-1763885216421
[2025-11-23T08:06:56.424Z] Existing timestamps: 5
[2025-11-23T08:06:56.424Z] Current count after filter: 5
[2025-11-23T08:06:56.424Z] Max requests allowed: 5
[2025-11-23T08:06:56.424Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:06:56.424Z] Current count: 5
[2025-11-23T08:06:56.424Z] Max allowed: 5
[2025-11-23T08:06:56.424Z] Retry after (seconds): 60
[2025-11-23T08:06:56.424Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-23T08:06:56.424Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.424Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.424Z] Identifier: test-multi-2-1763885216421
[2025-11-23T08:06:56.424Z] Key: login:test-multi-2-1763885216421
[2025-11-23T08:06:56.424Z] üìù Creating new entry for key: login:test-multi-2-1763885216421
[2025-11-23T08:06:56.424Z] Current count after filter: 0
[2025-11-23T08:06:56.424Z] Max requests allowed: 5
[2025-11-23T08:06:56.424Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.424Z] New count: 1
[2025-11-23T08:06:56.424Z] Remaining: 4
[2025-11-23T08:06:56.424Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.425Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-23T08:06:56.425Z] Identifier: test-reset-time-1763885216425
[2025-11-23T08:06:56.425Z] Key: login:test-reset-time-1763885216425
[2025-11-23T08:06:56.425Z] üìù Creating new entry for key: login:test-reset-time-1763885216425
[2025-11-23T08:06:56.425Z] Current count after filter: 0
[2025-11-23T08:06:56.425Z] Max requests allowed: 5
[2025-11-23T08:06:56.425Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.425Z] New count: 1
[2025-11-23T08:06:56.425Z] Remaining: 4
[2025-11-23T08:06:56.425Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.427Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (env): true
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (final): true
[2025-11-23T08:06:56.427Z] X-Test-ID header: null
[2025-11-23T08:06:56.427Z] Will use test ID?: false
[2025-11-23T08:06:56.427Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:06:56.427Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:06:56.427Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (env): true
[2025-11-23T08:06:56.427Z] E2E_TEST_MODE (final): true
[2025-11-23T08:06:56.427Z] X-Test-ID header: null
[2025-11-23T08:06:56.427Z] Will use test ID?: false
[2025-11-23T08:06:56.427Z] Using real IP: 192.168.1.2
[2025-11-23T08:06:56.428Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:06:56.428Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (env): true
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (final): true
[2025-11-23T08:06:56.428Z] X-Test-ID header: null
[2025-11-23T08:06:56.428Z] Will use test ID?: false
[2025-11-23T08:06:56.428Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:06:56.428Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:06:56.428Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (env): true
[2025-11-23T08:06:56.428Z] E2E_TEST_MODE (final): true
[2025-11-23T08:06:56.428Z] X-Test-ID header: null
[2025-11-23T08:06:56.428Z] Will use test ID?: false
[2025-11-23T08:06:56.428Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-23T08:06:56.428Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:06:56.429Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-23T08:06:56.429Z] E2E_TEST_MODE (process.env): undefined
[2025-11-23T08:06:56.429Z] E2E_TEST_MODE (env): true
[2025-11-23T08:06:56.429Z] E2E_TEST_MODE (final): true
[2025-11-23T08:06:56.429Z] X-Test-ID header: null
[2025-11-23T08:06:56.429Z] Will use test ID?: false
[2025-11-23T08:06:56.429Z] Using forwarded IP: 192.168.1.1
[2025-11-23T08:06:56.429Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-23T08:06:56.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.429Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:06:56.429Z] Identifier: test-sliding-1763885216429
[2025-11-23T08:06:56.429Z] Key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.429Z] üìù Creating new entry for key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.429Z] Current count after filter: 0
[2025-11-23T08:06:56.429Z] Max requests allowed: 3
[2025-11-23T08:06:56.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.429Z] New count: 1
[2025-11-23T08:06:56.429Z] Remaining: 2
[2025-11-23T08:06:56.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.530Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.530Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:06:56.530Z] Identifier: test-sliding-1763885216429
[2025-11-23T08:06:56.530Z] Key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.530Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.530Z] Existing timestamps: 1
[2025-11-23T08:06:56.530Z] Current count after filter: 1
[2025-11-23T08:06:56.530Z] Max requests allowed: 3
[2025-11-23T08:06:56.530Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.530Z] New count: 2
[2025-11-23T08:06:56.531Z] Remaining: 1
[2025-11-23T08:06:56.531Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.631Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.631Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-23T08:06:56.631Z] Identifier: test-sliding-1763885216429
[2025-11-23T08:06:56.631Z] Key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.631Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763885216429
[2025-11-23T08:06:56.631Z] Existing timestamps: 2
[2025-11-23T08:06:56.631Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-23T08:06:56.631Z] Current count after filter: 1
[2025-11-23T08:06:56.631Z] Max requests allowed: 3
[2025-11-23T08:06:56.631Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.631Z] New count: 2
[2025-11-23T08:06:56.631Z] Remaining: 1
[2025-11-23T08:06:56.631Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.632Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.632Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:06:56.632Z] Identifier: test-format-allowed-1763885216632
[2025-11-23T08:06:56.632Z] Key: register:test-format-allowed-1763885216632
[2025-11-23T08:06:56.632Z] üìù Creating new entry for key: register:test-format-allowed-1763885216632
[2025-11-23T08:06:56.632Z] Current count after filter: 0
[2025-11-23T08:06:56.632Z] Max requests allowed: 3
[2025-11-23T08:06:56.632Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.632Z] New count: 1
[2025-11-23T08:06:56.632Z] Remaining: 2
[2025-11-23T08:06:56.632Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.632Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.632Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:06:56.632Z] Identifier: test-format-blocked-1763885216632
[2025-11-23T08:06:56.632Z] Key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.632Z] üìù Creating new entry for key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] Current count after filter: 0
[2025-11-23T08:06:56.633Z] Max requests allowed: 3
[2025-11-23T08:06:56.633Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.633Z] New count: 1
[2025-11-23T08:06:56.633Z] Remaining: 2
[2025-11-23T08:06:56.633Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.633Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.633Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:06:56.633Z] Identifier: test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] Key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] üìñ Found existing entry for key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] Existing timestamps: 1
[2025-11-23T08:06:56.633Z] Current count after filter: 1
[2025-11-23T08:06:56.633Z] Max requests allowed: 3
[2025-11-23T08:06:56.633Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.633Z] New count: 2
[2025-11-23T08:06:56.633Z] Remaining: 1
[2025-11-23T08:06:56.633Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.633Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.633Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:06:56.633Z] Identifier: test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] Key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] üìñ Found existing entry for key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.633Z] Existing timestamps: 2
[2025-11-23T08:06:56.633Z] Current count after filter: 2
[2025-11-23T08:06:56.633Z] Max requests allowed: 3
[2025-11-23T08:06:56.633Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-23T08:06:56.633Z] New count: 3
[2025-11-23T08:06:56.633Z] Remaining: 0
[2025-11-23T08:06:56.633Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-23T08:06:56.634Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-23T08:06:56.634Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-23T08:06:56.634Z] Identifier: test-format-blocked-1763885216632
[2025-11-23T08:06:56.634Z] Key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.634Z] üìñ Found existing entry for key: register:test-format-blocked-1763885216632
[2025-11-23T08:06:56.634Z] Existing timestamps: 3
[2025-11-23T08:06:56.634Z] Current count after filter: 3
[2025-11-23T08:06:56.634Z] Max requests allowed: 3
[2025-11-23T08:06:56.634Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-23T08:06:56.634Z] Current count: 3
[2025-11-23T08:06:56.634Z] Max allowed: 3
[2025-11-23T08:06:56.634Z] Retry after (seconds): 60
[2025-11-23T08:06:56.634Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-26T19:59:19.167Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.168Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.168Z] Identifier: test-allow-1764187159167
[2025-11-26T19:59:19.168Z] Key: login:test-allow-1764187159167
[2025-11-26T19:59:19.168Z] üìù Creating new entry for key: login:test-allow-1764187159167
[2025-11-26T19:59:19.168Z] Current count after filter: 0
[2025-11-26T19:59:19.168Z] Max requests allowed: 5
[2025-11-26T19:59:19.168Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.168Z] New count: 1
[2025-11-26T19:59:19.168Z] Remaining: 4
[2025-11-26T19:59:19.168Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.169Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.169Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.169Z] Identifier: test-allow-1764187159167
[2025-11-26T19:59:19.169Z] Key: login:test-allow-1764187159167
[2025-11-26T19:59:19.169Z] üìñ Found existing entry for key: login:test-allow-1764187159167
[2025-11-26T19:59:19.169Z] Existing timestamps: 1
[2025-11-26T19:59:19.169Z] Current count after filter: 1
[2025-11-26T19:59:19.169Z] Max requests allowed: 5
[2025-11-26T19:59:19.169Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.169Z] New count: 2
[2025-11-26T19:59:19.169Z] Remaining: 3
[2025-11-26T19:59:19.169Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.169Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.169Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.169Z] Identifier: test-allow-1764187159167
[2025-11-26T19:59:19.169Z] Key: login:test-allow-1764187159167
[2025-11-26T19:59:19.169Z] üìñ Found existing entry for key: login:test-allow-1764187159167
[2025-11-26T19:59:19.169Z] Existing timestamps: 2
[2025-11-26T19:59:19.169Z] Current count after filter: 2
[2025-11-26T19:59:19.169Z] Max requests allowed: 5
[2025-11-26T19:59:19.170Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.170Z] New count: 3
[2025-11-26T19:59:19.170Z] Remaining: 2
[2025-11-26T19:59:19.170Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.170Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.170Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.170Z] Identifier: test-allow-1764187159167
[2025-11-26T19:59:19.170Z] Key: login:test-allow-1764187159167
[2025-11-26T19:59:19.170Z] üìñ Found existing entry for key: login:test-allow-1764187159167
[2025-11-26T19:59:19.170Z] Existing timestamps: 3
[2025-11-26T19:59:19.170Z] Current count after filter: 3
[2025-11-26T19:59:19.170Z] Max requests allowed: 5
[2025-11-26T19:59:19.170Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.170Z] New count: 4
[2025-11-26T19:59:19.170Z] Remaining: 1
[2025-11-26T19:59:19.170Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.170Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.170Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.170Z] Identifier: test-allow-1764187159167
[2025-11-26T19:59:19.170Z] Key: login:test-allow-1764187159167
[2025-11-26T19:59:19.170Z] üìñ Found existing entry for key: login:test-allow-1764187159167
[2025-11-26T19:59:19.170Z] Existing timestamps: 4
[2025-11-26T19:59:19.170Z] Current count after filter: 4
[2025-11-26T19:59:19.170Z] Max requests allowed: 5
[2025-11-26T19:59:19.170Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.170Z] New count: 5
[2025-11-26T19:59:19.170Z] Remaining: 0
[2025-11-26T19:59:19.170Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.171Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.171Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.171Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.171Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.171Z] üìù Creating new entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.171Z] Current count after filter: 0
[2025-11-26T19:59:19.171Z] Max requests allowed: 5
[2025-11-26T19:59:19.171Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.171Z] New count: 1
[2025-11-26T19:59:19.171Z] Remaining: 4
[2025-11-26T19:59:19.171Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.171Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.171Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.171Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.171Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.171Z] üìñ Found existing entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.172Z] Existing timestamps: 1
[2025-11-26T19:59:19.172Z] Current count after filter: 1
[2025-11-26T19:59:19.172Z] Max requests allowed: 5
[2025-11-26T19:59:19.172Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.172Z] New count: 2
[2025-11-26T19:59:19.172Z] Remaining: 3
[2025-11-26T19:59:19.172Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.172Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.172Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.172Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.172Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.172Z] üìñ Found existing entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.172Z] Existing timestamps: 2
[2025-11-26T19:59:19.172Z] Current count after filter: 2
[2025-11-26T19:59:19.172Z] Max requests allowed: 5
[2025-11-26T19:59:19.172Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.172Z] New count: 3
[2025-11-26T19:59:19.172Z] Remaining: 2
[2025-11-26T19:59:19.172Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.172Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.172Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.172Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.172Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.172Z] üìñ Found existing entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.172Z] Existing timestamps: 3
[2025-11-26T19:59:19.172Z] Current count after filter: 3
[2025-11-26T19:59:19.172Z] Max requests allowed: 5
[2025-11-26T19:59:19.173Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.173Z] New count: 4
[2025-11-26T19:59:19.173Z] Remaining: 1
[2025-11-26T19:59:19.173Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.173Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.173Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.173Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.173Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.173Z] üìñ Found existing entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.173Z] Existing timestamps: 4
[2025-11-26T19:59:19.173Z] Current count after filter: 4
[2025-11-26T19:59:19.173Z] Max requests allowed: 5
[2025-11-26T19:59:19.173Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.173Z] New count: 5
[2025-11-26T19:59:19.173Z] Remaining: 0
[2025-11-26T19:59:19.173Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.173Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.173Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.173Z] Identifier: test-block-1764187159171
[2025-11-26T19:59:19.173Z] Key: login:test-block-1764187159171
[2025-11-26T19:59:19.173Z] üìñ Found existing entry for key: login:test-block-1764187159171
[2025-11-26T19:59:19.173Z] Existing timestamps: 5
[2025-11-26T19:59:19.173Z] Current count after filter: 5
[2025-11-26T19:59:19.173Z] Max requests allowed: 5
[2025-11-26T19:59:19.173Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-26T19:59:19.173Z] Current count: 5
[2025-11-26T19:59:19.173Z] Max allowed: 5
[2025-11-26T19:59:19.173Z] Retry after (seconds): 60
[2025-11-26T19:59:19.173Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-26T19:59:19.174Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.174Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-26T19:59:19.174Z] Identifier: test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] üìù Creating new entry for key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Current count after filter: 0
[2025-11-26T19:59:19.174Z] Max requests allowed: 2
[2025-11-26T19:59:19.174Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.174Z] New count: 1
[2025-11-26T19:59:19.174Z] Remaining: 1
[2025-11-26T19:59:19.174Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.174Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.174Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-26T19:59:19.174Z] Identifier: test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] üìñ Found existing entry for key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Existing timestamps: 1
[2025-11-26T19:59:19.174Z] Current count after filter: 1
[2025-11-26T19:59:19.174Z] Max requests allowed: 2
[2025-11-26T19:59:19.174Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.174Z] New count: 2
[2025-11-26T19:59:19.174Z] Remaining: 0
[2025-11-26T19:59:19.174Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.174Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.174Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-26T19:59:19.174Z] Identifier: test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] üìñ Found existing entry for key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.174Z] Existing timestamps: 2
[2025-11-26T19:59:19.174Z] Current count after filter: 2
[2025-11-26T19:59:19.175Z] Max requests allowed: 2
[2025-11-26T19:59:19.175Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-26T19:59:19.175Z] Current count: 2
[2025-11-26T19:59:19.175Z] Max allowed: 2
[2025-11-26T19:59:19.175Z] Retry after (seconds): 1
[2025-11-26T19:59:19.175Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-26T19:59:19.329Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.337Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-26T19:59:19.337Z] Identifier: test-reset-1764187159174
[2025-11-26T19:59:19.337Z] Key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.337Z] üìñ Found existing entry for key: test-reset:test-reset-1764187159174
[2025-11-26T19:59:19.337Z] Existing timestamps: 2
[2025-11-26T19:59:19.338Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-26T19:59:19.338Z] Current count after filter: 0
[2025-11-26T19:59:19.338Z] Max requests allowed: 2
[2025-11-26T19:59:19.338Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.338Z] New count: 1
[2025-11-26T19:59:19.338Z] Remaining: 1
[2025-11-26T19:59:19.338Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.338Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.338Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.338Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.338Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.338Z] üìù Creating new entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.338Z] Current count after filter: 0
[2025-11-26T19:59:19.338Z] Max requests allowed: 5
[2025-11-26T19:59:19.338Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.338Z] New count: 1
[2025-11-26T19:59:19.338Z] Remaining: 4
[2025-11-26T19:59:19.338Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.338Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.338Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.338Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.338Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] üìñ Found existing entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] Existing timestamps: 1
[2025-11-26T19:59:19.339Z] Current count after filter: 1
[2025-11-26T19:59:19.339Z] Max requests allowed: 5
[2025-11-26T19:59:19.339Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.339Z] New count: 2
[2025-11-26T19:59:19.339Z] Remaining: 3
[2025-11-26T19:59:19.339Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.339Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.339Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.339Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] üìñ Found existing entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] Existing timestamps: 2
[2025-11-26T19:59:19.339Z] Current count after filter: 2
[2025-11-26T19:59:19.339Z] Max requests allowed: 5
[2025-11-26T19:59:19.339Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.339Z] New count: 3
[2025-11-26T19:59:19.339Z] Remaining: 2
[2025-11-26T19:59:19.339Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.339Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.339Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.339Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.339Z] üìñ Found existing entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] Existing timestamps: 3
[2025-11-26T19:59:19.340Z] Current count after filter: 3
[2025-11-26T19:59:19.340Z] Max requests allowed: 5
[2025-11-26T19:59:19.340Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.340Z] New count: 4
[2025-11-26T19:59:19.340Z] Remaining: 1
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.340Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.340Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] üìñ Found existing entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] Existing timestamps: 4
[2025-11-26T19:59:19.340Z] Current count after filter: 4
[2025-11-26T19:59:19.340Z] Max requests allowed: 5
[2025-11-26T19:59:19.340Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.340Z] New count: 5
[2025-11-26T19:59:19.340Z] Remaining: 0
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.340Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.340Z] Identifier: test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] Key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] üìñ Found existing entry for key: login:test-multi-1-1764187159338
[2025-11-26T19:59:19.340Z] Existing timestamps: 5
[2025-11-26T19:59:19.340Z] Current count after filter: 5
[2025-11-26T19:59:19.340Z] Max requests allowed: 5
[2025-11-26T19:59:19.340Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-26T19:59:19.340Z] Current count: 5
[2025-11-26T19:59:19.340Z] Max allowed: 5
[2025-11-26T19:59:19.340Z] Retry after (seconds): 60
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-26T19:59:19.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.341Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.341Z] Identifier: test-multi-2-1764187159338
[2025-11-26T19:59:19.341Z] Key: login:test-multi-2-1764187159338
[2025-11-26T19:59:19.341Z] üìù Creating new entry for key: login:test-multi-2-1764187159338
[2025-11-26T19:59:19.341Z] Current count after filter: 0
[2025-11-26T19:59:19.341Z] Max requests allowed: 5
[2025-11-26T19:59:19.341Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.341Z] New count: 1
[2025-11-26T19:59:19.341Z] Remaining: 4
[2025-11-26T19:59:19.341Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.341Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.341Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-26T19:59:19.341Z] Identifier: test-reset-time-1764187159341
[2025-11-26T19:59:19.341Z] Key: login:test-reset-time-1764187159341
[2025-11-26T19:59:19.341Z] üìù Creating new entry for key: login:test-reset-time-1764187159341
[2025-11-26T19:59:19.341Z] Current count after filter: 0
[2025-11-26T19:59:19.341Z] Max requests allowed: 5
[2025-11-26T19:59:19.341Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.342Z] New count: 1
[2025-11-26T19:59:19.342Z] Remaining: 4
[2025-11-26T19:59:19.342Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.343Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (process.env): undefined
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (env): true
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (final): true
[2025-11-26T19:59:19.343Z] X-Test-ID header: null
[2025-11-26T19:59:19.343Z] Will use test ID?: false
[2025-11-26T19:59:19.343Z] Using forwarded IP: 192.168.1.1
[2025-11-26T19:59:19.343Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-26T19:59:19.343Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (process.env): undefined
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (env): true
[2025-11-26T19:59:19.343Z] E2E_TEST_MODE (final): true
[2025-11-26T19:59:19.343Z] X-Test-ID header: null
[2025-11-26T19:59:19.343Z] Will use test ID?: false
[2025-11-26T19:59:19.343Z] Using real IP: 192.168.1.2
[2025-11-26T19:59:19.343Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-26T19:59:19.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-26T19:59:19.344Z] E2E_TEST_MODE (process.env): undefined
[2025-11-26T19:59:19.344Z] E2E_TEST_MODE (env): true
[2025-11-26T19:59:19.344Z] E2E_TEST_MODE (final): true
[2025-11-26T19:59:19.344Z] X-Test-ID header: null
[2025-11-26T19:59:19.344Z] Will use test ID?: false
[2025-11-26T19:59:19.344Z] Using forwarded IP: 192.168.1.1
[2025-11-26T19:59:19.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-26T19:59:19.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-26T19:59:19.344Z] E2E_TEST_MODE (process.env): undefined
[2025-11-26T19:59:19.344Z] E2E_TEST_MODE (env): true
[2025-11-26T19:59:19.345Z] E2E_TEST_MODE (final): true
[2025-11-26T19:59:19.345Z] X-Test-ID header: null
[2025-11-26T19:59:19.345Z] Will use test ID?: false
[2025-11-26T19:59:19.345Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-26T19:59:19.345Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-26T19:59:19.345Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-26T19:59:19.346Z] E2E_TEST_MODE (process.env): undefined
[2025-11-26T19:59:19.346Z] E2E_TEST_MODE (env): true
[2025-11-26T19:59:19.346Z] E2E_TEST_MODE (final): true
[2025-11-26T19:59:19.346Z] X-Test-ID header: null
[2025-11-26T19:59:19.346Z] Will use test ID?: false
[2025-11-26T19:59:19.346Z] Using forwarded IP: 192.168.1.1
[2025-11-26T19:59:19.346Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-26T19:59:19.346Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.346Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-26T19:59:19.346Z] Identifier: test-sliding-1764187159346
[2025-11-26T19:59:19.346Z] Key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.346Z] üìù Creating new entry for key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.346Z] Current count after filter: 0
[2025-11-26T19:59:19.346Z] Max requests allowed: 3
[2025-11-26T19:59:19.346Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.347Z] New count: 1
[2025-11-26T19:59:19.347Z] Remaining: 2
[2025-11-26T19:59:19.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.449Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.452Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-26T19:59:19.452Z] Identifier: test-sliding-1764187159346
[2025-11-26T19:59:19.452Z] Key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.452Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.452Z] Existing timestamps: 1
[2025-11-26T19:59:19.452Z] Current count after filter: 1
[2025-11-26T19:59:19.452Z] Max requests allowed: 3
[2025-11-26T19:59:19.453Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.453Z] New count: 2
[2025-11-26T19:59:19.453Z] Remaining: 1
[2025-11-26T19:59:19.454Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.555Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.555Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-26T19:59:19.555Z] Identifier: test-sliding-1764187159346
[2025-11-26T19:59:19.556Z] Key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.556Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764187159346
[2025-11-26T19:59:19.556Z] Existing timestamps: 2
[2025-11-26T19:59:19.556Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-26T19:59:19.556Z] Current count after filter: 1
[2025-11-26T19:59:19.556Z] Max requests allowed: 3
[2025-11-26T19:59:19.556Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.556Z] New count: 2
[2025-11-26T19:59:19.556Z] Remaining: 1
[2025-11-26T19:59:19.556Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.556Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.557Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-26T19:59:19.557Z] Identifier: test-format-allowed-1764187159556
[2025-11-26T19:59:19.557Z] Key: register:test-format-allowed-1764187159556
[2025-11-26T19:59:19.557Z] üìù Creating new entry for key: register:test-format-allowed-1764187159556
[2025-11-26T19:59:19.557Z] Current count after filter: 0
[2025-11-26T19:59:19.557Z] Max requests allowed: 3
[2025-11-26T19:59:19.557Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.557Z] New count: 1
[2025-11-26T19:59:19.557Z] Remaining: 2
[2025-11-26T19:59:19.557Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.557Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.557Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-26T19:59:19.557Z] Identifier: test-format-blocked-1764187159557
[2025-11-26T19:59:19.557Z] Key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.557Z] üìù Creating new entry for key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.557Z] Current count after filter: 0
[2025-11-26T19:59:19.558Z] Max requests allowed: 3
[2025-11-26T19:59:19.558Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.558Z] New count: 1
[2025-11-26T19:59:19.558Z] Remaining: 2
[2025-11-26T19:59:19.558Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.558Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.558Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-26T19:59:19.558Z] Identifier: test-format-blocked-1764187159557
[2025-11-26T19:59:19.558Z] Key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.558Z] üìñ Found existing entry for key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.558Z] Existing timestamps: 1
[2025-11-26T19:59:19.558Z] Current count after filter: 1
[2025-11-26T19:59:19.558Z] Max requests allowed: 3
[2025-11-26T19:59:19.558Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.558Z] New count: 2
[2025-11-26T19:59:19.558Z] Remaining: 1
[2025-11-26T19:59:19.558Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.558Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.558Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-26T19:59:19.559Z] Identifier: test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] Key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] üìñ Found existing entry for key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] Existing timestamps: 2
[2025-11-26T19:59:19.559Z] Current count after filter: 2
[2025-11-26T19:59:19.559Z] Max requests allowed: 3
[2025-11-26T19:59:19.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-26T19:59:19.559Z] New count: 3
[2025-11-26T19:59:19.559Z] Remaining: 0
[2025-11-26T19:59:19.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-26T19:59:19.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-26T19:59:19.559Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-26T19:59:19.559Z] Identifier: test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] Key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] üìñ Found existing entry for key: register:test-format-blocked-1764187159557
[2025-11-26T19:59:19.559Z] Existing timestamps: 3
[2025-11-26T19:59:19.559Z] Current count after filter: 3
[2025-11-26T19:59:19.559Z] Max requests allowed: 3
[2025-11-26T19:59:19.559Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-26T19:59:19.559Z] Current count: 3
[2025-11-26T19:59:19.560Z] Max allowed: 3
[2025-11-26T19:59:19.560Z] Retry after (seconds): 60
[2025-11-26T19:59:19.560Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:22.346Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.348Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.348Z] Identifier: test-allow-1764513202346
[2025-11-30T14:33:22.349Z] Key: login:test-allow-1764513202346
[2025-11-30T14:33:22.349Z] üìù Creating new entry for key: login:test-allow-1764513202346
[2025-11-30T14:33:22.349Z] Current count after filter: 0
[2025-11-30T14:33:22.349Z] Max requests allowed: 5
[2025-11-30T14:33:22.349Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.349Z] New count: 1
[2025-11-30T14:33:22.349Z] Remaining: 4
[2025-11-30T14:33:22.349Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.349Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.349Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.349Z] Identifier: test-allow-1764513202346
[2025-11-30T14:33:22.349Z] Key: login:test-allow-1764513202346
[2025-11-30T14:33:22.349Z] üìñ Found existing entry for key: login:test-allow-1764513202346
[2025-11-30T14:33:22.349Z] Existing timestamps: 1
[2025-11-30T14:33:22.349Z] Current count after filter: 1
[2025-11-30T14:33:22.350Z] Max requests allowed: 5
[2025-11-30T14:33:22.350Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.350Z] New count: 2
[2025-11-30T14:33:22.350Z] Remaining: 3
[2025-11-30T14:33:22.350Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.350Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.350Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.350Z] Identifier: test-allow-1764513202346
[2025-11-30T14:33:22.350Z] Key: login:test-allow-1764513202346
[2025-11-30T14:33:22.350Z] üìñ Found existing entry for key: login:test-allow-1764513202346
[2025-11-30T14:33:22.350Z] Existing timestamps: 2
[2025-11-30T14:33:22.350Z] Current count after filter: 2
[2025-11-30T14:33:22.350Z] Max requests allowed: 5
[2025-11-30T14:33:22.350Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.350Z] New count: 3
[2025-11-30T14:33:22.350Z] Remaining: 2
[2025-11-30T14:33:22.350Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.350Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.350Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.350Z] Identifier: test-allow-1764513202346
[2025-11-30T14:33:22.350Z] Key: login:test-allow-1764513202346
[2025-11-30T14:33:22.350Z] üìñ Found existing entry for key: login:test-allow-1764513202346
[2025-11-30T14:33:22.350Z] Existing timestamps: 3
[2025-11-30T14:33:22.350Z] Current count after filter: 3
[2025-11-30T14:33:22.350Z] Max requests allowed: 5
[2025-11-30T14:33:22.351Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.351Z] New count: 4
[2025-11-30T14:33:22.351Z] Remaining: 1
[2025-11-30T14:33:22.351Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.351Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.351Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.351Z] Identifier: test-allow-1764513202346
[2025-11-30T14:33:22.351Z] Key: login:test-allow-1764513202346
[2025-11-30T14:33:22.351Z] üìñ Found existing entry for key: login:test-allow-1764513202346
[2025-11-30T14:33:22.351Z] Existing timestamps: 4
[2025-11-30T14:33:22.351Z] Current count after filter: 4
[2025-11-30T14:33:22.351Z] Max requests allowed: 5
[2025-11-30T14:33:22.351Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.351Z] New count: 5
[2025-11-30T14:33:22.351Z] Remaining: 0
[2025-11-30T14:33:22.351Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.352Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.352Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.352Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.352Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.352Z] üìù Creating new entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.352Z] Current count after filter: 0
[2025-11-30T14:33:22.352Z] Max requests allowed: 5
[2025-11-30T14:33:22.352Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.352Z] New count: 1
[2025-11-30T14:33:22.352Z] Remaining: 4
[2025-11-30T14:33:22.352Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.353Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.353Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.353Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.353Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] üìñ Found existing entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] Existing timestamps: 1
[2025-11-30T14:33:22.353Z] Current count after filter: 1
[2025-11-30T14:33:22.353Z] Max requests allowed: 5
[2025-11-30T14:33:22.353Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.353Z] New count: 2
[2025-11-30T14:33:22.353Z] Remaining: 3
[2025-11-30T14:33:22.353Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.353Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.353Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.353Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.353Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] üìñ Found existing entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] Existing timestamps: 2
[2025-11-30T14:33:22.353Z] Current count after filter: 2
[2025-11-30T14:33:22.353Z] Max requests allowed: 5
[2025-11-30T14:33:22.353Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.353Z] New count: 3
[2025-11-30T14:33:22.353Z] Remaining: 2
[2025-11-30T14:33:22.353Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.353Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.353Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.353Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.353Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] üìñ Found existing entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.353Z] Existing timestamps: 3
[2025-11-30T14:33:22.354Z] Current count after filter: 3
[2025-11-30T14:33:22.354Z] Max requests allowed: 5
[2025-11-30T14:33:22.354Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.354Z] New count: 4
[2025-11-30T14:33:22.354Z] Remaining: 1
[2025-11-30T14:33:22.354Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.354Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.354Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.354Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.354Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.354Z] üìñ Found existing entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.354Z] Existing timestamps: 4
[2025-11-30T14:33:22.354Z] Current count after filter: 4
[2025-11-30T14:33:22.354Z] Max requests allowed: 5
[2025-11-30T14:33:22.354Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.354Z] New count: 5
[2025-11-30T14:33:22.354Z] Remaining: 0
[2025-11-30T14:33:22.354Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.354Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.354Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:22.354Z] Identifier: test-block-1764513202352
[2025-11-30T14:33:22.354Z] Key: login:test-block-1764513202352
[2025-11-30T14:33:22.354Z] üìñ Found existing entry for key: login:test-block-1764513202352
[2025-11-30T14:33:22.354Z] Existing timestamps: 5
[2025-11-30T14:33:22.354Z] Current count after filter: 5
[2025-11-30T14:33:22.354Z] Max requests allowed: 5
[2025-11-30T14:33:22.354Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:22.354Z] Current count: 5
[2025-11-30T14:33:22.354Z] Max allowed: 5
[2025-11-30T14:33:22.354Z] Retry after (seconds): 60
[2025-11-30T14:33:22.354Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:22.355Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.355Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:22.355Z] Identifier: test-reset-1764513202355
[2025-11-30T14:33:22.355Z] Key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.355Z] üìù Creating new entry for key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.355Z] Current count after filter: 0
[2025-11-30T14:33:22.355Z] Max requests allowed: 2
[2025-11-30T14:33:22.355Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.355Z] New count: 1
[2025-11-30T14:33:22.355Z] Remaining: 1
[2025-11-30T14:33:22.355Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.355Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.355Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:22.355Z] Identifier: test-reset-1764513202355
[2025-11-30T14:33:22.355Z] Key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.355Z] üìñ Found existing entry for key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.355Z] Existing timestamps: 1
[2025-11-30T14:33:22.355Z] Current count after filter: 1
[2025-11-30T14:33:22.355Z] Max requests allowed: 2
[2025-11-30T14:33:22.355Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:22.356Z] New count: 2
[2025-11-30T14:33:22.356Z] Remaining: 0
[2025-11-30T14:33:22.356Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:22.356Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:22.356Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:22.356Z] Identifier: test-reset-1764513202355
[2025-11-30T14:33:22.356Z] Key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.356Z] üìñ Found existing entry for key: test-reset:test-reset-1764513202355
[2025-11-30T14:33:22.356Z] Existing timestamps: 2
[2025-11-30T14:33:22.356Z] Current count after filter: 2
[2025-11-30T14:33:22.356Z] Max requests allowed: 2
[2025-11-30T14:33:22.356Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:22.356Z] Current count: 2
[2025-11-30T14:33:22.356Z] Max allowed: 2
[2025-11-30T14:33:22.356Z] Retry after (seconds): 1
[2025-11-30T14:33:22.356Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:25.538Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.539Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.539Z] Identifier: test-allow-1764513205538
[2025-11-30T14:33:25.539Z] Key: login:test-allow-1764513205538
[2025-11-30T14:33:25.539Z] üìù Creating new entry for key: login:test-allow-1764513205538
[2025-11-30T14:33:25.539Z] Current count after filter: 0
[2025-11-30T14:33:25.540Z] Max requests allowed: 5
[2025-11-30T14:33:25.540Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.540Z] New count: 1
[2025-11-30T14:33:25.541Z] Remaining: 4
[2025-11-30T14:33:25.541Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.542Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.542Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.543Z] Identifier: test-allow-1764513205538
[2025-11-30T14:33:25.543Z] Key: login:test-allow-1764513205538
[2025-11-30T14:33:25.543Z] üìñ Found existing entry for key: login:test-allow-1764513205538
[2025-11-30T14:33:25.543Z] Existing timestamps: 1
[2025-11-30T14:33:25.543Z] Current count after filter: 1
[2025-11-30T14:33:25.543Z] Max requests allowed: 5
[2025-11-30T14:33:25.543Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.543Z] New count: 2
[2025-11-30T14:33:25.543Z] Remaining: 3
[2025-11-30T14:33:25.543Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.543Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.543Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.543Z] Identifier: test-allow-1764513205538
[2025-11-30T14:33:25.543Z] Key: login:test-allow-1764513205538
[2025-11-30T14:33:25.543Z] üìñ Found existing entry for key: login:test-allow-1764513205538
[2025-11-30T14:33:25.543Z] Existing timestamps: 2
[2025-11-30T14:33:25.543Z] Current count after filter: 2
[2025-11-30T14:33:25.543Z] Max requests allowed: 5
[2025-11-30T14:33:25.543Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.543Z] New count: 3
[2025-11-30T14:33:25.543Z] Remaining: 2
[2025-11-30T14:33:25.543Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.544Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.544Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.544Z] Identifier: test-allow-1764513205538
[2025-11-30T14:33:25.544Z] Key: login:test-allow-1764513205538
[2025-11-30T14:33:25.545Z] üìñ Found existing entry for key: login:test-allow-1764513205538
[2025-11-30T14:33:25.546Z] Existing timestamps: 3
[2025-11-30T14:33:25.546Z] Current count after filter: 3
[2025-11-30T14:33:25.546Z] Max requests allowed: 5
[2025-11-30T14:33:25.546Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.546Z] New count: 4
[2025-11-30T14:33:25.546Z] Remaining: 1
[2025-11-30T14:33:25.546Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.546Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.546Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.546Z] Identifier: test-allow-1764513205538
[2025-11-30T14:33:25.546Z] Key: login:test-allow-1764513205538
[2025-11-30T14:33:25.546Z] üìñ Found existing entry for key: login:test-allow-1764513205538
[2025-11-30T14:33:25.546Z] Existing timestamps: 4
[2025-11-30T14:33:25.546Z] Current count after filter: 4
[2025-11-30T14:33:25.546Z] Max requests allowed: 5
[2025-11-30T14:33:25.546Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.546Z] New count: 5
[2025-11-30T14:33:25.546Z] Remaining: 0
[2025-11-30T14:33:25.546Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.547Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.547Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.547Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.547Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.547Z] üìù Creating new entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.547Z] Current count after filter: 0
[2025-11-30T14:33:25.547Z] Max requests allowed: 5
[2025-11-30T14:33:25.548Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.548Z] New count: 1
[2025-11-30T14:33:25.548Z] Remaining: 4
[2025-11-30T14:33:25.548Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.548Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.548Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.548Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.548Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.548Z] üìñ Found existing entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.548Z] Existing timestamps: 1
[2025-11-30T14:33:25.548Z] Current count after filter: 1
[2025-11-30T14:33:25.551Z] Max requests allowed: 5
[2025-11-30T14:33:25.556Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.557Z] New count: 2
[2025-11-30T14:33:25.561Z] Remaining: 3
[2025-11-30T14:33:25.564Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.564Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.564Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.564Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.564Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.564Z] üìñ Found existing entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.565Z] Existing timestamps: 2
[2025-11-30T14:33:25.565Z] Current count after filter: 2
[2025-11-30T14:33:25.566Z] Max requests allowed: 5
[2025-11-30T14:33:25.566Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.566Z] New count: 3
[2025-11-30T14:33:25.566Z] Remaining: 2
[2025-11-30T14:33:25.566Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.566Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.566Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.566Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.566Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.567Z] üìñ Found existing entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.567Z] Existing timestamps: 3
[2025-11-30T14:33:25.567Z] Current count after filter: 3
[2025-11-30T14:33:25.567Z] Max requests allowed: 5
[2025-11-30T14:33:25.567Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.567Z] New count: 4
[2025-11-30T14:33:25.567Z] Remaining: 1
[2025-11-30T14:33:25.567Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.568Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.568Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.569Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.569Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.569Z] üìñ Found existing entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.569Z] Existing timestamps: 4
[2025-11-30T14:33:25.569Z] Current count after filter: 4
[2025-11-30T14:33:25.569Z] Max requests allowed: 5
[2025-11-30T14:33:25.569Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.569Z] New count: 5
[2025-11-30T14:33:25.569Z] Remaining: 0
[2025-11-30T14:33:25.569Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.570Z] Identifier: test-block-1764513205547
[2025-11-30T14:33:25.570Z] Key: login:test-block-1764513205547
[2025-11-30T14:33:25.570Z] üìñ Found existing entry for key: login:test-block-1764513205547
[2025-11-30T14:33:25.570Z] Existing timestamps: 5
[2025-11-30T14:33:25.570Z] Current count after filter: 5
[2025-11-30T14:33:25.570Z] Max requests allowed: 5
[2025-11-30T14:33:25.570Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:25.570Z] Current count: 5
[2025-11-30T14:33:25.570Z] Max allowed: 5
[2025-11-30T14:33:25.570Z] Retry after (seconds): 60
[2025-11-30T14:33:25.570Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:25.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.571Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:25.571Z] Identifier: test-reset-1764513205571
[2025-11-30T14:33:25.571Z] Key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.571Z] üìù Creating new entry for key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.571Z] Current count after filter: 0
[2025-11-30T14:33:25.571Z] Max requests allowed: 2
[2025-11-30T14:33:25.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.571Z] New count: 1
[2025-11-30T14:33:25.571Z] Remaining: 1
[2025-11-30T14:33:25.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.571Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:25.571Z] Identifier: test-reset-1764513205571
[2025-11-30T14:33:25.571Z] Key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.571Z] üìñ Found existing entry for key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.571Z] Existing timestamps: 1
[2025-11-30T14:33:25.571Z] Current count after filter: 1
[2025-11-30T14:33:25.572Z] Max requests allowed: 2
[2025-11-30T14:33:25.572Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.572Z] New count: 2
[2025-11-30T14:33:25.572Z] Remaining: 0
[2025-11-30T14:33:25.572Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.572Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.572Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:25.572Z] Identifier: test-reset-1764513205571
[2025-11-30T14:33:25.572Z] Key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.573Z] üìñ Found existing entry for key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.573Z] Existing timestamps: 2
[2025-11-30T14:33:25.573Z] Current count after filter: 2
[2025-11-30T14:33:25.573Z] Max requests allowed: 2
[2025-11-30T14:33:25.573Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:25.573Z] Current count: 2
[2025-11-30T14:33:25.573Z] Max allowed: 2
[2025-11-30T14:33:25.573Z] Retry after (seconds): 1
[2025-11-30T14:33:25.573Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:25.725Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.726Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-30T14:33:25.727Z] Identifier: test-reset-1764513205571
[2025-11-30T14:33:25.727Z] Key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.727Z] üìñ Found existing entry for key: test-reset:test-reset-1764513205571
[2025-11-30T14:33:25.727Z] Existing timestamps: 2
[2025-11-30T14:33:25.727Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-30T14:33:25.727Z] Current count after filter: 0
[2025-11-30T14:33:25.728Z] Max requests allowed: 2
[2025-11-30T14:33:25.728Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.728Z] New count: 1
[2025-11-30T14:33:25.728Z] Remaining: 1
[2025-11-30T14:33:25.728Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.728Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.728Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.728Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.728Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.728Z] üìù Creating new entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.728Z] Current count after filter: 0
[2025-11-30T14:33:25.728Z] Max requests allowed: 5
[2025-11-30T14:33:25.728Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.728Z] New count: 1
[2025-11-30T14:33:25.728Z] Remaining: 4
[2025-11-30T14:33:25.728Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.728Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.728Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.729Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] üìñ Found existing entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] Existing timestamps: 1
[2025-11-30T14:33:25.729Z] Current count after filter: 1
[2025-11-30T14:33:25.729Z] Max requests allowed: 5
[2025-11-30T14:33:25.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.729Z] New count: 2
[2025-11-30T14:33:25.729Z] Remaining: 3
[2025-11-30T14:33:25.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.729Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] üìñ Found existing entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.729Z] Existing timestamps: 2
[2025-11-30T14:33:25.729Z] Current count after filter: 2
[2025-11-30T14:33:25.729Z] Max requests allowed: 5
[2025-11-30T14:33:25.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.729Z] New count: 3
[2025-11-30T14:33:25.729Z] Remaining: 2
[2025-11-30T14:33:25.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.729Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] üìñ Found existing entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] Existing timestamps: 3
[2025-11-30T14:33:25.732Z] Current count after filter: 3
[2025-11-30T14:33:25.732Z] Max requests allowed: 5
[2025-11-30T14:33:25.732Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.732Z] New count: 4
[2025-11-30T14:33:25.732Z] Remaining: 1
[2025-11-30T14:33:25.732Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.732Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.732Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.732Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] üìñ Found existing entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.732Z] Existing timestamps: 4
[2025-11-30T14:33:25.732Z] Current count after filter: 4
[2025-11-30T14:33:25.732Z] Max requests allowed: 5
[2025-11-30T14:33:25.732Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.732Z] New count: 5
[2025-11-30T14:33:25.732Z] Remaining: 0
[2025-11-30T14:33:25.732Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.732Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.732Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.733Z] Identifier: test-multi-1-1764513205728
[2025-11-30T14:33:25.733Z] Key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.733Z] üìñ Found existing entry for key: login:test-multi-1-1764513205728
[2025-11-30T14:33:25.733Z] Existing timestamps: 5
[2025-11-30T14:33:25.733Z] Current count after filter: 5
[2025-11-30T14:33:25.733Z] Max requests allowed: 5
[2025-11-30T14:33:25.733Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:25.733Z] Current count: 5
[2025-11-30T14:33:25.733Z] Max allowed: 5
[2025-11-30T14:33:25.733Z] Retry after (seconds): 60
[2025-11-30T14:33:25.733Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-30T14:33:25.733Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.733Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.733Z] Identifier: test-multi-2-1764513205728
[2025-11-30T14:33:25.733Z] Key: login:test-multi-2-1764513205728
[2025-11-30T14:33:25.733Z] üìù Creating new entry for key: login:test-multi-2-1764513205728
[2025-11-30T14:33:25.733Z] Current count after filter: 0
[2025-11-30T14:33:25.733Z] Max requests allowed: 5
[2025-11-30T14:33:25.733Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.733Z] New count: 1
[2025-11-30T14:33:25.733Z] Remaining: 4
[2025-11-30T14:33:25.733Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.734Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.734Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-30T14:33:25.734Z] Identifier: test-reset-time-1764513205734
[2025-11-30T14:33:25.734Z] Key: login:test-reset-time-1764513205734
[2025-11-30T14:33:25.734Z] üìù Creating new entry for key: login:test-reset-time-1764513205734
[2025-11-30T14:33:25.734Z] Current count after filter: 0
[2025-11-30T14:33:25.734Z] Max requests allowed: 5
[2025-11-30T14:33:25.734Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.734Z] New count: 1
[2025-11-30T14:33:25.734Z] Remaining: 4
[2025-11-30T14:33:25.734Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.735Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-30T14:33:25.735Z] E2E_TEST_MODE (process.env): undefined
[2025-11-30T14:33:25.735Z] E2E_TEST_MODE (env): true
[2025-11-30T14:33:25.735Z] E2E_TEST_MODE (final): true
[2025-11-30T14:33:25.735Z] X-Test-ID header: null
[2025-11-30T14:33:25.735Z] Will use test ID?: false
[2025-11-30T14:33:25.735Z] Using forwarded IP: 192.168.1.1
[2025-11-30T14:33:25.735Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-30T14:33:25.735Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-30T14:33:25.735Z] E2E_TEST_MODE (process.env): undefined
[2025-11-30T14:33:25.736Z] E2E_TEST_MODE (env): true
[2025-11-30T14:33:25.736Z] E2E_TEST_MODE (final): true
[2025-11-30T14:33:25.736Z] X-Test-ID header: null
[2025-11-30T14:33:25.736Z] Will use test ID?: false
[2025-11-30T14:33:25.736Z] Using real IP: 192.168.1.2
[2025-11-30T14:33:25.736Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-30T14:33:25.736Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-30T14:33:25.736Z] E2E_TEST_MODE (process.env): undefined
[2025-11-30T14:33:25.736Z] E2E_TEST_MODE (env): true
[2025-11-30T14:33:25.736Z] E2E_TEST_MODE (final): true
[2025-11-30T14:33:25.737Z] X-Test-ID header: null
[2025-11-30T14:33:25.737Z] Will use test ID?: false
[2025-11-30T14:33:25.737Z] Using forwarded IP: 192.168.1.1
[2025-11-30T14:33:25.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-30T14:33:25.737Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-30T14:33:25.737Z] E2E_TEST_MODE (process.env): undefined
[2025-11-30T14:33:25.737Z] E2E_TEST_MODE (env): true
[2025-11-30T14:33:25.737Z] E2E_TEST_MODE (final): true
[2025-11-30T14:33:25.737Z] X-Test-ID header: null
[2025-11-30T14:33:25.737Z] Will use test ID?: false
[2025-11-30T14:33:25.737Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-30T14:33:25.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-30T14:33:25.738Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-30T14:33:25.738Z] E2E_TEST_MODE (process.env): undefined
[2025-11-30T14:33:25.738Z] E2E_TEST_MODE (env): true
[2025-11-30T14:33:25.738Z] E2E_TEST_MODE (final): true
[2025-11-30T14:33:25.738Z] X-Test-ID header: null
[2025-11-30T14:33:25.738Z] Will use test ID?: false
[2025-11-30T14:33:25.738Z] Using forwarded IP: 192.168.1.1
[2025-11-30T14:33:25.738Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-30T14:33:25.738Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.738Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-30T14:33:25.738Z] Identifier: test-sliding-1764513205738
[2025-11-30T14:33:25.738Z] Key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.738Z] üìù Creating new entry for key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.738Z] Current count after filter: 0
[2025-11-30T14:33:25.738Z] Max requests allowed: 3
[2025-11-30T14:33:25.738Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.738Z] New count: 1
[2025-11-30T14:33:25.738Z] Remaining: 2
[2025-11-30T14:33:25.738Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.838Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.839Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-30T14:33:25.839Z] Identifier: test-sliding-1764513205738
[2025-11-30T14:33:25.839Z] Key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.839Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.839Z] Existing timestamps: 1
[2025-11-30T14:33:25.839Z] Current count after filter: 1
[2025-11-30T14:33:25.839Z] Max requests allowed: 3
[2025-11-30T14:33:25.839Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.839Z] New count: 2
[2025-11-30T14:33:25.839Z] Remaining: 1
[2025-11-30T14:33:25.839Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.943Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-30T14:33:25.943Z] Identifier: test-sliding-1764513205738
[2025-11-30T14:33:25.943Z] Key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.943Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764513205738
[2025-11-30T14:33:25.943Z] Existing timestamps: 2
[2025-11-30T14:33:25.943Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-30T14:33:25.943Z] Current count after filter: 1
[2025-11-30T14:33:25.943Z] Max requests allowed: 3
[2025-11-30T14:33:25.944Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.944Z] New count: 2
[2025-11-30T14:33:25.944Z] Remaining: 1
[2025-11-30T14:33:25.944Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.945Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-30T14:33:25.945Z] Identifier: test-format-allowed-1764513205945
[2025-11-30T14:33:25.945Z] Key: register:test-format-allowed-1764513205945
[2025-11-30T14:33:25.945Z] üìù Creating new entry for key: register:test-format-allowed-1764513205945
[2025-11-30T14:33:25.945Z] Current count after filter: 0
[2025-11-30T14:33:25.945Z] Max requests allowed: 3
[2025-11-30T14:33:25.945Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.945Z] New count: 1
[2025-11-30T14:33:25.946Z] Remaining: 2
[2025-11-30T14:33:25.946Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.946Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-30T14:33:25.946Z] Identifier: test-format-blocked-1764513205946
[2025-11-30T14:33:25.946Z] Key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.946Z] üìù Creating new entry for key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.946Z] Current count after filter: 0
[2025-11-30T14:33:25.946Z] Max requests allowed: 3
[2025-11-30T14:33:25.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.946Z] New count: 1
[2025-11-30T14:33:25.946Z] Remaining: 2
[2025-11-30T14:33:25.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.947Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-30T14:33:25.947Z] Identifier: test-format-blocked-1764513205946
[2025-11-30T14:33:25.947Z] Key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.947Z] üìñ Found existing entry for key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.947Z] Existing timestamps: 1
[2025-11-30T14:33:25.947Z] Current count after filter: 1
[2025-11-30T14:33:25.947Z] Max requests allowed: 3
[2025-11-30T14:33:25.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.947Z] New count: 2
[2025-11-30T14:33:25.948Z] Remaining: 1
[2025-11-30T14:33:25.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.948Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-30T14:33:25.948Z] Identifier: test-format-blocked-1764513205946
[2025-11-30T14:33:25.948Z] Key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.948Z] üìñ Found existing entry for key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.948Z] Existing timestamps: 2
[2025-11-30T14:33:25.948Z] Current count after filter: 2
[2025-11-30T14:33:25.948Z] Max requests allowed: 3
[2025-11-30T14:33:25.948Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-30T14:33:25.948Z] New count: 3
[2025-11-30T14:33:25.948Z] Remaining: 0
[2025-11-30T14:33:25.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-30T14:33:25.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-30T14:33:25.949Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-30T14:33:25.949Z] Identifier: test-format-blocked-1764513205946
[2025-11-30T14:33:25.949Z] Key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.949Z] üìñ Found existing entry for key: register:test-format-blocked-1764513205946
[2025-11-30T14:33:25.949Z] Existing timestamps: 3
[2025-11-30T14:33:25.949Z] Current count after filter: 3
[2025-11-30T14:33:25.949Z] Max requests allowed: 3
[2025-11-30T14:33:25.949Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-30T14:33:25.949Z] Current count: 3
[2025-11-30T14:33:25.949Z] Max allowed: 3
[2025-11-30T14:33:25.949Z] Retry after (seconds): 60
[2025-11-30T14:33:25.949Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-12-03T12:44:08.878Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.879Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.879Z] Identifier: test-allow-1764765848878
[2025-12-03T12:44:08.879Z] Key: login:test-allow-1764765848878
[2025-12-03T12:44:08.879Z] üìù Creating new entry for key: login:test-allow-1764765848878
[2025-12-03T12:44:08.880Z] Current count after filter: 0
[2025-12-03T12:44:08.880Z] Max requests allowed: 5
[2025-12-03T12:44:08.880Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.880Z] New count: 1
[2025-12-03T12:44:08.880Z] Remaining: 4
[2025-12-03T12:44:08.880Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.880Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.880Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.880Z] Identifier: test-allow-1764765848878
[2025-12-03T12:44:08.880Z] Key: login:test-allow-1764765848878
[2025-12-03T12:44:08.880Z] üìñ Found existing entry for key: login:test-allow-1764765848878
[2025-12-03T12:44:08.880Z] Existing timestamps: 1
[2025-12-03T12:44:08.880Z] Current count after filter: 1
[2025-12-03T12:44:08.880Z] Max requests allowed: 5
[2025-12-03T12:44:08.880Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.881Z] New count: 2
[2025-12-03T12:44:08.881Z] Remaining: 3
[2025-12-03T12:44:08.881Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.881Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.881Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.881Z] Identifier: test-allow-1764765848878
[2025-12-03T12:44:08.881Z] Key: login:test-allow-1764765848878
[2025-12-03T12:44:08.881Z] üìñ Found existing entry for key: login:test-allow-1764765848878
[2025-12-03T12:44:08.881Z] Existing timestamps: 2
[2025-12-03T12:44:08.881Z] Current count after filter: 2
[2025-12-03T12:44:08.881Z] Max requests allowed: 5
[2025-12-03T12:44:08.881Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.881Z] New count: 3
[2025-12-03T12:44:08.881Z] Remaining: 2
[2025-12-03T12:44:08.881Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.881Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.881Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.881Z] Identifier: test-allow-1764765848878
[2025-12-03T12:44:08.881Z] Key: login:test-allow-1764765848878
[2025-12-03T12:44:08.881Z] üìñ Found existing entry for key: login:test-allow-1764765848878
[2025-12-03T12:44:08.881Z] Existing timestamps: 3
[2025-12-03T12:44:08.882Z] Current count after filter: 3
[2025-12-03T12:44:08.882Z] Max requests allowed: 5
[2025-12-03T12:44:08.882Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.882Z] New count: 4
[2025-12-03T12:44:08.882Z] Remaining: 1
[2025-12-03T12:44:08.882Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.882Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.882Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.882Z] Identifier: test-allow-1764765848878
[2025-12-03T12:44:08.882Z] Key: login:test-allow-1764765848878
[2025-12-03T12:44:08.882Z] üìñ Found existing entry for key: login:test-allow-1764765848878
[2025-12-03T12:44:08.882Z] Existing timestamps: 4
[2025-12-03T12:44:08.882Z] Current count after filter: 4
[2025-12-03T12:44:08.882Z] Max requests allowed: 5
[2025-12-03T12:44:08.882Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.882Z] New count: 5
[2025-12-03T12:44:08.882Z] Remaining: 0
[2025-12-03T12:44:08.882Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.883Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.884Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.884Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.884Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.884Z] üìù Creating new entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.884Z] Current count after filter: 0
[2025-12-03T12:44:08.884Z] Max requests allowed: 5
[2025-12-03T12:44:08.884Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.884Z] New count: 1
[2025-12-03T12:44:08.884Z] Remaining: 4
[2025-12-03T12:44:08.884Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.884Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.884Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.884Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.884Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.884Z] üìñ Found existing entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.884Z] Existing timestamps: 1
[2025-12-03T12:44:08.884Z] Current count after filter: 1
[2025-12-03T12:44:08.884Z] Max requests allowed: 5
[2025-12-03T12:44:08.885Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.885Z] New count: 2
[2025-12-03T12:44:08.885Z] Remaining: 3
[2025-12-03T12:44:08.885Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.885Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.885Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.885Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.885Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.885Z] üìñ Found existing entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.885Z] Existing timestamps: 2
[2025-12-03T12:44:08.885Z] Current count after filter: 2
[2025-12-03T12:44:08.885Z] Max requests allowed: 5
[2025-12-03T12:44:08.885Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.885Z] New count: 3
[2025-12-03T12:44:08.885Z] Remaining: 2
[2025-12-03T12:44:08.885Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.885Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.885Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.885Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.885Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.885Z] üìñ Found existing entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.885Z] Existing timestamps: 3
[2025-12-03T12:44:08.886Z] Current count after filter: 3
[2025-12-03T12:44:08.886Z] Max requests allowed: 5
[2025-12-03T12:44:08.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.886Z] New count: 4
[2025-12-03T12:44:08.886Z] Remaining: 1
[2025-12-03T12:44:08.886Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.886Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.887Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.887Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.887Z] üìñ Found existing entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.887Z] Existing timestamps: 4
[2025-12-03T12:44:08.887Z] Current count after filter: 4
[2025-12-03T12:44:08.887Z] Max requests allowed: 5
[2025-12-03T12:44:08.887Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.887Z] New count: 5
[2025-12-03T12:44:08.887Z] Remaining: 0
[2025-12-03T12:44:08.887Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.887Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.888Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:08.888Z] Identifier: test-block-1764765848883
[2025-12-03T12:44:08.888Z] Key: login:test-block-1764765848883
[2025-12-03T12:44:08.888Z] üìñ Found existing entry for key: login:test-block-1764765848883
[2025-12-03T12:44:08.888Z] Existing timestamps: 5
[2025-12-03T12:44:08.888Z] Current count after filter: 5
[2025-12-03T12:44:08.888Z] Max requests allowed: 5
[2025-12-03T12:44:08.888Z] üö´ RATE LIMIT EXCEEDED!
[2025-12-03T12:44:08.888Z] Current count: 5
[2025-12-03T12:44:08.888Z] Max allowed: 5
[2025-12-03T12:44:08.888Z] Retry after (seconds): 60
[2025-12-03T12:44:08.888Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-12-03T12:44:08.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.889Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-12-03T12:44:08.889Z] Identifier: test-reset-1764765848889
[2025-12-03T12:44:08.890Z] Key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.890Z] üìù Creating new entry for key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.890Z] Current count after filter: 0
[2025-12-03T12:44:08.890Z] Max requests allowed: 2
[2025-12-03T12:44:08.890Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.890Z] New count: 1
[2025-12-03T12:44:08.890Z] Remaining: 1
[2025-12-03T12:44:08.890Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.891Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.891Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-12-03T12:44:08.891Z] Identifier: test-reset-1764765848889
[2025-12-03T12:44:08.891Z] Key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.891Z] üìñ Found existing entry for key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.891Z] Existing timestamps: 1
[2025-12-03T12:44:08.891Z] Current count after filter: 1
[2025-12-03T12:44:08.891Z] Max requests allowed: 2
[2025-12-03T12:44:08.891Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:08.891Z] New count: 2
[2025-12-03T12:44:08.891Z] Remaining: 0
[2025-12-03T12:44:08.891Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:08.891Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:08.892Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-12-03T12:44:08.892Z] Identifier: test-reset-1764765848889
[2025-12-03T12:44:08.892Z] Key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.892Z] üìñ Found existing entry for key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:08.892Z] Existing timestamps: 2
[2025-12-03T12:44:08.892Z] Current count after filter: 2
[2025-12-03T12:44:08.892Z] Max requests allowed: 2
[2025-12-03T12:44:08.892Z] üö´ RATE LIMIT EXCEEDED!
[2025-12-03T12:44:08.892Z] Current count: 2
[2025-12-03T12:44:08.892Z] Max allowed: 2
[2025-12-03T12:44:08.892Z] Retry after (seconds): 1
[2025-12-03T12:44:08.892Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-12-03T12:44:09.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.043Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-12-03T12:44:09.043Z] Identifier: test-reset-1764765848889
[2025-12-03T12:44:09.043Z] Key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:09.043Z] üìñ Found existing entry for key: test-reset:test-reset-1764765848889
[2025-12-03T12:44:09.043Z] Existing timestamps: 2
[2025-12-03T12:44:09.043Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-12-03T12:44:09.043Z] Current count after filter: 0
[2025-12-03T12:44:09.043Z] Max requests allowed: 2
[2025-12-03T12:44:09.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.044Z] New count: 1
[2025-12-03T12:44:09.044Z] Remaining: 1
[2025-12-03T12:44:09.044Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.044Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.044Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.045Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.045Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.045Z] üìù Creating new entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.045Z] Current count after filter: 0
[2025-12-03T12:44:09.045Z] Max requests allowed: 5
[2025-12-03T12:44:09.045Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.045Z] New count: 1
[2025-12-03T12:44:09.045Z] Remaining: 4
[2025-12-03T12:44:09.045Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.045Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.045Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.045Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.046Z] üìñ Found existing entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.046Z] Existing timestamps: 1
[2025-12-03T12:44:09.046Z] Current count after filter: 1
[2025-12-03T12:44:09.046Z] Max requests allowed: 5
[2025-12-03T12:44:09.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.046Z] New count: 2
[2025-12-03T12:44:09.046Z] Remaining: 3
[2025-12-03T12:44:09.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.046Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.046Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.046Z] üìñ Found existing entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.046Z] Existing timestamps: 2
[2025-12-03T12:44:09.046Z] Current count after filter: 2
[2025-12-03T12:44:09.046Z] Max requests allowed: 5
[2025-12-03T12:44:09.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.046Z] New count: 3
[2025-12-03T12:44:09.046Z] Remaining: 2
[2025-12-03T12:44:09.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.046Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.047Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.047Z] üìñ Found existing entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.047Z] Existing timestamps: 3
[2025-12-03T12:44:09.047Z] Current count after filter: 3
[2025-12-03T12:44:09.047Z] Max requests allowed: 5
[2025-12-03T12:44:09.047Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.047Z] New count: 4
[2025-12-03T12:44:09.047Z] Remaining: 1
[2025-12-03T12:44:09.047Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.047Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.047Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.048Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.048Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.048Z] üìñ Found existing entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.048Z] Existing timestamps: 4
[2025-12-03T12:44:09.048Z] Current count after filter: 4
[2025-12-03T12:44:09.048Z] Max requests allowed: 5
[2025-12-03T12:44:09.048Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.048Z] New count: 5
[2025-12-03T12:44:09.048Z] Remaining: 0
[2025-12-03T12:44:09.048Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.049Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.049Z] Identifier: test-multi-1-1764765849044
[2025-12-03T12:44:09.049Z] Key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.049Z] üìñ Found existing entry for key: login:test-multi-1-1764765849044
[2025-12-03T12:44:09.049Z] Existing timestamps: 5
[2025-12-03T12:44:09.049Z] Current count after filter: 5
[2025-12-03T12:44:09.049Z] Max requests allowed: 5
[2025-12-03T12:44:09.049Z] üö´ RATE LIMIT EXCEEDED!
[2025-12-03T12:44:09.049Z] Current count: 5
[2025-12-03T12:44:09.049Z] Max allowed: 5
[2025-12-03T12:44:09.049Z] Retry after (seconds): 60
[2025-12-03T12:44:09.049Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-12-03T12:44:09.049Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.049Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.051Z] Identifier: test-multi-2-1764765849044
[2025-12-03T12:44:09.051Z] Key: login:test-multi-2-1764765849044
[2025-12-03T12:44:09.051Z] üìù Creating new entry for key: login:test-multi-2-1764765849044
[2025-12-03T12:44:09.051Z] Current count after filter: 0
[2025-12-03T12:44:09.051Z] Max requests allowed: 5
[2025-12-03T12:44:09.051Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.051Z] New count: 1
[2025-12-03T12:44:09.052Z] Remaining: 4
[2025-12-03T12:44:09.052Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.052Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.052Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-12-03T12:44:09.052Z] Identifier: test-reset-time-1764765849052
[2025-12-03T12:44:09.052Z] Key: login:test-reset-time-1764765849052
[2025-12-03T12:44:09.052Z] üìù Creating new entry for key: login:test-reset-time-1764765849052
[2025-12-03T12:44:09.052Z] Current count after filter: 0
[2025-12-03T12:44:09.052Z] Max requests allowed: 5
[2025-12-03T12:44:09.052Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.052Z] New count: 1
[2025-12-03T12:44:09.052Z] Remaining: 4
[2025-12-03T12:44:09.052Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.054Z] === RATE LIMIT: getClientIdentifier START ===
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (process.env): undefined
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (env): true
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (final): true
[2025-12-03T12:44:09.054Z] X-Test-ID header: null
[2025-12-03T12:44:09.054Z] Will use test ID?: false
[2025-12-03T12:44:09.054Z] Using forwarded IP: 192.168.1.1
[2025-12-03T12:44:09.054Z] === RATE LIMIT: getClientIdentifier END ===
[2025-12-03T12:44:09.054Z] === RATE LIMIT: getClientIdentifier START ===
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (process.env): undefined
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (env): true
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (final): true
[2025-12-03T12:44:09.054Z] X-Test-ID header: null
[2025-12-03T12:44:09.054Z] Will use test ID?: false
[2025-12-03T12:44:09.054Z] Using real IP: 192.168.1.2
[2025-12-03T12:44:09.054Z] === RATE LIMIT: getClientIdentifier END ===
[2025-12-03T12:44:09.054Z] === RATE LIMIT: getClientIdentifier START ===
[2025-12-03T12:44:09.054Z] E2E_TEST_MODE (process.env): undefined
[2025-12-03T12:44:09.055Z] E2E_TEST_MODE (env): true
[2025-12-03T12:44:09.055Z] E2E_TEST_MODE (final): true
[2025-12-03T12:44:09.055Z] X-Test-ID header: null
[2025-12-03T12:44:09.055Z] Will use test ID?: false
[2025-12-03T12:44:09.055Z] Using forwarded IP: 192.168.1.1
[2025-12-03T12:44:09.055Z] === RATE LIMIT: getClientIdentifier END ===
[2025-12-03T12:44:09.055Z] === RATE LIMIT: getClientIdentifier START ===
[2025-12-03T12:44:09.055Z] E2E_TEST_MODE (process.env): undefined
[2025-12-03T12:44:09.057Z] E2E_TEST_MODE (env): true
[2025-12-03T12:44:09.057Z] E2E_TEST_MODE (final): true
[2025-12-03T12:44:09.058Z] X-Test-ID header: null
[2025-12-03T12:44:09.058Z] Will use test ID?: false
[2025-12-03T12:44:09.058Z] ‚ö†Ô∏è Using fallback: unknown
[2025-12-03T12:44:09.064Z] === RATE LIMIT: getClientIdentifier END ===
[2025-12-03T12:44:09.064Z] === RATE LIMIT: getClientIdentifier START ===
[2025-12-03T12:44:09.064Z] E2E_TEST_MODE (process.env): undefined
[2025-12-03T12:44:09.064Z] E2E_TEST_MODE (env): true
[2025-12-03T12:44:09.064Z] E2E_TEST_MODE (final): true
[2025-12-03T12:44:09.064Z] X-Test-ID header: null
[2025-12-03T12:44:09.064Z] Will use test ID?: false
[2025-12-03T12:44:09.064Z] Using forwarded IP: 192.168.1.1
[2025-12-03T12:44:09.064Z] === RATE LIMIT: getClientIdentifier END ===
[2025-12-03T12:44:09.065Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.065Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-12-03T12:44:09.065Z] Identifier: test-sliding-1764765849065
[2025-12-03T12:44:09.065Z] Key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.066Z] üìù Creating new entry for key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.067Z] Current count after filter: 0
[2025-12-03T12:44:09.067Z] Max requests allowed: 3
[2025-12-03T12:44:09.067Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.069Z] New count: 1
[2025-12-03T12:44:09.069Z] Remaining: 2
[2025-12-03T12:44:09.070Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.170Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.171Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-12-03T12:44:09.171Z] Identifier: test-sliding-1764765849065
[2025-12-03T12:44:09.171Z] Key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.171Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.171Z] Existing timestamps: 1
[2025-12-03T12:44:09.171Z] Current count after filter: 1
[2025-12-03T12:44:09.171Z] Max requests allowed: 3
[2025-12-03T12:44:09.171Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.171Z] New count: 2
[2025-12-03T12:44:09.171Z] Remaining: 1
[2025-12-03T12:44:09.171Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.274Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.274Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-12-03T12:44:09.274Z] Identifier: test-sliding-1764765849065
[2025-12-03T12:44:09.274Z] Key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.274Z] üìñ Found existing entry for key: test-sliding:test-sliding-1764765849065
[2025-12-03T12:44:09.274Z] Existing timestamps: 2
[2025-12-03T12:44:09.274Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-12-03T12:44:09.274Z] Current count after filter: 1
[2025-12-03T12:44:09.274Z] Max requests allowed: 3
[2025-12-03T12:44:09.274Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.274Z] New count: 2
[2025-12-03T12:44:09.274Z] Remaining: 1
[2025-12-03T12:44:09.274Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.275Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.275Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-12-03T12:44:09.275Z] Identifier: test-format-allowed-1764765849275
[2025-12-03T12:44:09.276Z] Key: register:test-format-allowed-1764765849275
[2025-12-03T12:44:09.276Z] üìù Creating new entry for key: register:test-format-allowed-1764765849275
[2025-12-03T12:44:09.276Z] Current count after filter: 0
[2025-12-03T12:44:09.276Z] Max requests allowed: 3
[2025-12-03T12:44:09.276Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.276Z] New count: 1
[2025-12-03T12:44:09.276Z] Remaining: 2
[2025-12-03T12:44:09.276Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.276Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.276Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-12-03T12:44:09.276Z] Identifier: test-format-blocked-1764765849276
[2025-12-03T12:44:09.276Z] Key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.276Z] üìù Creating new entry for key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] Current count after filter: 0
[2025-12-03T12:44:09.277Z] Max requests allowed: 3
[2025-12-03T12:44:09.277Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.277Z] New count: 1
[2025-12-03T12:44:09.277Z] Remaining: 2
[2025-12-03T12:44:09.277Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.277Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.277Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-12-03T12:44:09.277Z] Identifier: test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] Key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] üìñ Found existing entry for key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] Existing timestamps: 1
[2025-12-03T12:44:09.277Z] Current count after filter: 1
[2025-12-03T12:44:09.277Z] Max requests allowed: 3
[2025-12-03T12:44:09.277Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.277Z] New count: 2
[2025-12-03T12:44:09.277Z] Remaining: 1
[2025-12-03T12:44:09.277Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.277Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.277Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-12-03T12:44:09.277Z] Identifier: test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] Key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] üìñ Found existing entry for key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.277Z] Existing timestamps: 2
[2025-12-03T12:44:09.277Z] Current count after filter: 2
[2025-12-03T12:44:09.277Z] Max requests allowed: 3
[2025-12-03T12:44:09.277Z] ‚úÖ Request allowed, recorded timestamp
[2025-12-03T12:44:09.277Z] New count: 3
[2025-12-03T12:44:09.277Z] Remaining: 0
[2025-12-03T12:44:09.278Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-12-03T12:44:09.278Z] === RATE LIMIT: checkRateLimit START ===
[2025-12-03T12:44:09.278Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-12-03T12:44:09.278Z] Identifier: test-format-blocked-1764765849276
[2025-12-03T12:44:09.278Z] Key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.278Z] üìñ Found existing entry for key: register:test-format-blocked-1764765849276
[2025-12-03T12:44:09.278Z] Existing timestamps: 3
[2025-12-03T12:44:09.278Z] Current count after filter: 3
[2025-12-03T12:44:09.278Z] Max requests allowed: 3
[2025-12-03T12:44:09.278Z] üö´ RATE LIMIT EXCEEDED!
[2025-12-03T12:44:09.278Z] Current count: 3
[2025-12-03T12:44:09.278Z] Max allowed: 3
[2025-12-03T12:44:09.278Z] Retry after (seconds): 60
[2025-12-03T12:44:09.278Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-12-06T10:47:58.115Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765018078115",
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.116Z] Creating new entry
{
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.116Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T10:47:58.116Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T10:47:58.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765018078115",
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.117Z] Found existing entry
{
  "key": "login:test-allow-1765018078115",
  "timestampCount": 1
}
[2025-12-06T10:47:58.117Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T10:47:58.117Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T10:47:58.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765018078115",
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.117Z] Found existing entry
{
  "key": "login:test-allow-1765018078115",
  "timestampCount": 2
}
[2025-12-06T10:47:58.117Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T10:47:58.117Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T10:47:58.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765018078115",
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.117Z] Found existing entry
{
  "key": "login:test-allow-1765018078115",
  "timestampCount": 3
}
[2025-12-06T10:47:58.117Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T10:47:58.117Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T10:47:58.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765018078115",
  "key": "login:test-allow-1765018078115"
}
[2025-12-06T10:47:58.117Z] Found existing entry
{
  "key": "login:test-allow-1765018078115",
  "timestampCount": 4
}
[2025-12-06T10:47:58.117Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T10:47:58.117Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Creating new entry
{
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T10:47:58.118Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Found existing entry
{
  "key": "login:test-block-1765018078118",
  "timestampCount": 1
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T10:47:58.118Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Found existing entry
{
  "key": "login:test-block-1765018078118",
  "timestampCount": 2
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T10:47:58.118Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Found existing entry
{
  "key": "login:test-block-1765018078118",
  "timestampCount": 3
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T10:47:58.118Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Found existing entry
{
  "key": "login:test-block-1765018078118",
  "timestampCount": 4
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T10:47:58.118Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T10:47:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765018078118",
  "key": "login:test-block-1765018078118"
}
[2025-12-06T10:47:58.118Z] Found existing entry
{
  "key": "login:test-block-1765018078118",
  "timestampCount": 5
}
[2025-12-06T10:47:58.118Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T10:47:58.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765018078119",
  "key": "test-reset:test-reset-1765018078119"
}
[2025-12-06T10:47:58.119Z] Creating new entry
{
  "key": "test-reset:test-reset-1765018078119"
}
[2025-12-06T10:47:58.119Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T10:47:58.119Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T10:47:58.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765018078119",
  "key": "test-reset:test-reset-1765018078119"
}
[2025-12-06T10:47:58.119Z] Found existing entry
{
  "key": "test-reset:test-reset-1765018078119",
  "timestampCount": 1
}
[2025-12-06T10:47:58.119Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-06T10:47:58.119Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-06T10:47:58.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765018078119",
  "key": "test-reset:test-reset-1765018078119"
}
[2025-12-06T10:47:58.119Z] Found existing entry
{
  "key": "test-reset:test-reset-1765018078119",
  "timestampCount": 2
}
[2025-12-06T10:47:58.119Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-06T10:47:58.270Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765018078119",
  "key": "test-reset:test-reset-1765018078119"
}
[2025-12-06T10:47:58.270Z] Found existing entry
{
  "key": "test-reset:test-reset-1765018078119",
  "timestampCount": 2
}
[2025-12-06T10:47:58.272Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-06T10:47:58.272Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T10:47:58.276Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T10:47:58.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Creating new entry
{
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T10:47:58.277Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T10:47:58.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Found existing entry
{
  "key": "login:test-multi-1-1765018078277",
  "timestampCount": 1
}
[2025-12-06T10:47:58.277Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T10:47:58.277Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T10:47:58.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Found existing entry
{
  "key": "login:test-multi-1-1765018078277",
  "timestampCount": 2
}
[2025-12-06T10:47:58.277Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T10:47:58.277Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T10:47:58.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Found existing entry
{
  "key": "login:test-multi-1-1765018078277",
  "timestampCount": 3
}
[2025-12-06T10:47:58.277Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T10:47:58.277Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T10:47:58.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.277Z] Found existing entry
{
  "key": "login:test-multi-1-1765018078277",
  "timestampCount": 4
}
[2025-12-06T10:47:58.278Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T10:47:58.278Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T10:47:58.278Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765018078277",
  "key": "login:test-multi-1-1765018078277"
}
[2025-12-06T10:47:58.278Z] Found existing entry
{
  "key": "login:test-multi-1-1765018078277",
  "timestampCount": 5
}
[2025-12-06T10:47:58.278Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T10:47:58.278Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765018078277",
  "key": "login:test-multi-2-1765018078277"
}
[2025-12-06T10:47:58.278Z] Creating new entry
{
  "key": "login:test-multi-2-1765018078277"
}
[2025-12-06T10:47:58.278Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T10:47:58.278Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T10:47:58.278Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765018078278",
  "key": "login:test-reset-time-1765018078278"
}
[2025-12-06T10:47:58.278Z] Creating new entry
{
  "key": "login:test-reset-time-1765018078278"
}
[2025-12-06T10:47:58.278Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T10:47:58.279Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T10:47:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T10:47:58.280Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T10:47:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T10:47:58.280Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-06T10:47:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T10:47:58.280Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T10:47:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T10:47:58.280Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-06T10:47:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T10:47:58.280Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T10:47:58.280Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765018078280",
  "key": "test-sliding:test-sliding-1765018078280"
}
[2025-12-06T10:47:58.280Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765018078280"
}
[2025-12-06T10:47:58.280Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T10:47:58.280Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T10:47:58.381Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765018078280",
  "key": "test-sliding:test-sliding-1765018078280"
}
[2025-12-06T10:47:58.381Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765018078280",
  "timestampCount": 1
}
[2025-12-06T10:47:58.381Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T10:47:58.381Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T10:47:58.484Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765018078280",
  "key": "test-sliding:test-sliding-1765018078280"
}
[2025-12-06T10:47:58.484Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765018078280",
  "timestampCount": 2
}
[2025-12-06T10:47:58.484Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-06T10:47:58.484Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T10:47:58.484Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T10:47:58.485Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765018078485",
  "key": "register:test-format-allowed-1765018078485"
}
[2025-12-06T10:47:58.485Z] Creating new entry
{
  "key": "register:test-format-allowed-1765018078485"
}
[2025-12-06T10:47:58.485Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T10:47:58.485Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T10:47:58.485Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765018078485",
  "key": "register:test-format-blocked-1765018078485"
}
[2025-12-06T10:47:58.485Z] Creating new entry
{
  "key": "register:test-format-blocked-1765018078485"
}
[2025-12-06T10:47:58.485Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T10:47:58.486Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T10:47:58.486Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765018078485",
  "key": "register:test-format-blocked-1765018078485"
}
[2025-12-06T10:47:58.487Z] Found existing entry
{
  "key": "register:test-format-blocked-1765018078485",
  "timestampCount": 1
}
[2025-12-06T10:47:58.487Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T10:47:58.487Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T10:47:58.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765018078485",
  "key": "register:test-format-blocked-1765018078485"
}
[2025-12-06T10:47:58.488Z] Found existing entry
{
  "key": "register:test-format-blocked-1765018078485",
  "timestampCount": 2
}
[2025-12-06T10:47:58.488Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-06T10:47:58.488Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-06T10:47:58.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765018078485",
  "key": "register:test-format-blocked-1765018078485"
}
[2025-12-06T10:47:58.488Z] Found existing entry
{
  "key": "register:test-format-blocked-1765018078485",
  "timestampCount": 3
}
[2025-12-06T10:47:58.488Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-06T11:31:33.601Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765020693601",
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.602Z] Creating new entry
{
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.602Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T11:31:33.602Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T11:31:33.602Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765020693601",
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.603Z] Found existing entry
{
  "key": "login:test-allow-1765020693601",
  "timestampCount": 1
}
[2025-12-06T11:31:33.604Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T11:31:33.604Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T11:31:33.604Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765020693601",
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.604Z] Found existing entry
{
  "key": "login:test-allow-1765020693601",
  "timestampCount": 2
}
[2025-12-06T11:31:33.604Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T11:31:33.604Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T11:31:33.604Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765020693601",
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.604Z] Found existing entry
{
  "key": "login:test-allow-1765020693601",
  "timestampCount": 3
}
[2025-12-06T11:31:33.604Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T11:31:33.604Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T11:31:33.604Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765020693601",
  "key": "login:test-allow-1765020693601"
}
[2025-12-06T11:31:33.604Z] Found existing entry
{
  "key": "login:test-allow-1765020693601",
  "timestampCount": 4
}
[2025-12-06T11:31:33.604Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T11:31:33.604Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T11:31:33.605Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.606Z] Creating new entry
{
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.606Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T11:31:33.606Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T11:31:33.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.606Z] Found existing entry
{
  "key": "login:test-block-1765020693605",
  "timestampCount": 1
}
[2025-12-06T11:31:33.606Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T11:31:33.606Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T11:31:33.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.606Z] Found existing entry
{
  "key": "login:test-block-1765020693605",
  "timestampCount": 2
}
[2025-12-06T11:31:33.606Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T11:31:33.606Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T11:31:33.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.606Z] Found existing entry
{
  "key": "login:test-block-1765020693605",
  "timestampCount": 3
}
[2025-12-06T11:31:33.607Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T11:31:33.607Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T11:31:33.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.608Z] Found existing entry
{
  "key": "login:test-block-1765020693605",
  "timestampCount": 4
}
[2025-12-06T11:31:33.608Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T11:31:33.608Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T11:31:33.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765020693605",
  "key": "login:test-block-1765020693605"
}
[2025-12-06T11:31:33.608Z] Found existing entry
{
  "key": "login:test-block-1765020693605",
  "timestampCount": 5
}
[2025-12-06T11:31:33.608Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T11:31:33.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765020693609",
  "key": "test-reset:test-reset-1765020693609"
}
[2025-12-06T11:31:33.609Z] Creating new entry
{
  "key": "test-reset:test-reset-1765020693609"
}
[2025-12-06T11:31:33.609Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T11:31:33.609Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T11:31:33.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765020693609",
  "key": "test-reset:test-reset-1765020693609"
}
[2025-12-06T11:31:33.609Z] Found existing entry
{
  "key": "test-reset:test-reset-1765020693609",
  "timestampCount": 1
}
[2025-12-06T11:31:33.609Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-06T11:31:33.609Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-06T11:31:33.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765020693609",
  "key": "test-reset:test-reset-1765020693609"
}
[2025-12-06T11:31:33.610Z] Found existing entry
{
  "key": "test-reset:test-reset-1765020693609",
  "timestampCount": 2
}
[2025-12-06T11:31:33.610Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-06T11:31:33.762Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765020693609",
  "key": "test-reset:test-reset-1765020693609"
}
[2025-12-06T11:31:33.762Z] Found existing entry
{
  "key": "test-reset:test-reset-1765020693609",
  "timestampCount": 2
}
[2025-12-06T11:31:33.762Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-06T11:31:33.762Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T11:31:33.762Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Creating new entry
{
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T11:31:33.763Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Found existing entry
{
  "key": "login:test-multi-1-1765020693763",
  "timestampCount": 1
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T11:31:33.763Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Found existing entry
{
  "key": "login:test-multi-1-1765020693763",
  "timestampCount": 2
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T11:31:33.763Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Found existing entry
{
  "key": "login:test-multi-1-1765020693763",
  "timestampCount": 3
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T11:31:33.763Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Found existing entry
{
  "key": "login:test-multi-1-1765020693763",
  "timestampCount": 4
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T11:31:33.763Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T11:31:33.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765020693763",
  "key": "login:test-multi-1-1765020693763"
}
[2025-12-06T11:31:33.763Z] Found existing entry
{
  "key": "login:test-multi-1-1765020693763",
  "timestampCount": 5
}
[2025-12-06T11:31:33.763Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T11:31:33.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765020693763",
  "key": "login:test-multi-2-1765020693763"
}
[2025-12-06T11:31:33.764Z] Creating new entry
{
  "key": "login:test-multi-2-1765020693763"
}
[2025-12-06T11:31:33.764Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T11:31:33.764Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T11:31:33.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765020693764",
  "key": "login:test-reset-time-1765020693764"
}
[2025-12-06T11:31:33.764Z] Creating new entry
{
  "key": "login:test-reset-time-1765020693764"
}
[2025-12-06T11:31:33.764Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T11:31:33.764Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T11:31:33.765Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T11:31:33.765Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T11:31:33.765Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T11:31:33.765Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-06T11:31:33.765Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T11:31:33.765Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T11:31:33.765Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T11:31:33.765Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-06T11:31:33.766Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T11:31:33.766Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T11:31:33.766Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765020693766",
  "key": "test-sliding:test-sliding-1765020693766"
}
[2025-12-06T11:31:33.766Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765020693766"
}
[2025-12-06T11:31:33.766Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T11:31:33.766Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T15:07:42.899Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765033662899",
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Creating new entry
{
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T15:07:42.900Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T15:07:42.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765033662899",
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Found existing entry
{
  "key": "login:test-allow-1765033662899",
  "timestampCount": 1
}
[2025-12-06T15:07:42.900Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T15:07:42.900Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T15:07:42.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765033662899",
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Found existing entry
{
  "key": "login:test-allow-1765033662899",
  "timestampCount": 2
}
[2025-12-06T15:07:42.900Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T15:07:42.900Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T15:07:42.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765033662899",
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Found existing entry
{
  "key": "login:test-allow-1765033662899",
  "timestampCount": 3
}
[2025-12-06T15:07:42.900Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T15:07:42.900Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T15:07:42.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765033662899",
  "key": "login:test-allow-1765033662899"
}
[2025-12-06T15:07:42.900Z] Found existing entry
{
  "key": "login:test-allow-1765033662899",
  "timestampCount": 4
}
[2025-12-06T15:07:42.900Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T15:07:42.900Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T15:07:42.901Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Creating new entry
{
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T15:07:42.901Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T15:07:42.901Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Found existing entry
{
  "key": "login:test-block-1765033662901",
  "timestampCount": 1
}
[2025-12-06T15:07:42.901Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T15:07:42.901Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T15:07:42.901Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Found existing entry
{
  "key": "login:test-block-1765033662901",
  "timestampCount": 2
}
[2025-12-06T15:07:42.901Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T15:07:42.901Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T15:07:42.901Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Found existing entry
{
  "key": "login:test-block-1765033662901",
  "timestampCount": 3
}
[2025-12-06T15:07:42.901Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T15:07:42.901Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T15:07:42.901Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.901Z] Found existing entry
{
  "key": "login:test-block-1765033662901",
  "timestampCount": 4
}
[2025-12-06T15:07:42.901Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T15:07:42.901Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T15:07:42.902Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765033662901",
  "key": "login:test-block-1765033662901"
}
[2025-12-06T15:07:42.902Z] Found existing entry
{
  "key": "login:test-block-1765033662901",
  "timestampCount": 5
}
[2025-12-06T15:07:42.902Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T15:07:42.902Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765033662902",
  "key": "test-reset:test-reset-1765033662902"
}
[2025-12-06T15:07:42.902Z] Creating new entry
{
  "key": "test-reset:test-reset-1765033662902"
}
[2025-12-06T15:07:42.902Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T15:07:42.902Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T15:07:42.902Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765033662902",
  "key": "test-reset:test-reset-1765033662902"
}
[2025-12-06T15:07:42.902Z] Found existing entry
{
  "key": "test-reset:test-reset-1765033662902",
  "timestampCount": 1
}
[2025-12-06T15:07:42.902Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-06T15:07:42.902Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-06T15:07:42.903Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765033662902",
  "key": "test-reset:test-reset-1765033662902"
}
[2025-12-06T15:07:42.903Z] Found existing entry
{
  "key": "test-reset:test-reset-1765033662902",
  "timestampCount": 2
}
[2025-12-06T15:07:42.903Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-06T15:07:43.055Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765033662902",
  "key": "test-reset:test-reset-1765033662902"
}
[2025-12-06T15:07:43.057Z] Found existing entry
{
  "key": "test-reset:test-reset-1765033662902",
  "timestampCount": 2
}
[2025-12-06T15:07:43.057Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-06T15:07:43.057Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-06T15:07:43.057Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-06T15:07:43.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.057Z] Creating new entry
{
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.057Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T15:07:43.057Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T15:07:43.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.057Z] Found existing entry
{
  "key": "login:test-multi-1-1765033663057",
  "timestampCount": 1
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-06T15:07:43.058Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-06T15:07:43.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.058Z] Found existing entry
{
  "key": "login:test-multi-1-1765033663057",
  "timestampCount": 2
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-06T15:07:43.058Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-06T15:07:43.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.058Z] Found existing entry
{
  "key": "login:test-multi-1-1765033663057",
  "timestampCount": 3
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-06T15:07:43.058Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-06T15:07:43.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.058Z] Found existing entry
{
  "key": "login:test-multi-1-1765033663057",
  "timestampCount": 4
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-06T15:07:43.058Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-06T15:07:43.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765033663057",
  "key": "login:test-multi-1-1765033663057"
}
[2025-12-06T15:07:43.058Z] Found existing entry
{
  "key": "login:test-multi-1-1765033663057",
  "timestampCount": 5
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-06T15:07:43.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765033663057",
  "key": "login:test-multi-2-1765033663057"
}
[2025-12-06T15:07:43.058Z] Creating new entry
{
  "key": "login:test-multi-2-1765033663057"
}
[2025-12-06T15:07:43.058Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T15:07:43.059Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T15:07:43.059Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765033663059",
  "key": "login:test-reset-time-1765033663059"
}
[2025-12-06T15:07:43.059Z] Creating new entry
{
  "key": "login:test-reset-time-1765033663059"
}
[2025-12-06T15:07:43.059Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-06T15:07:43.059Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-06T15:07:43.060Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T15:07:43.060Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T15:07:43.060Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T15:07:43.060Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-06T15:07:43.060Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T15:07:43.060Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T15:07:43.060Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T15:07:43.060Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-06T15:07:43.061Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-06T15:07:43.061Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-06T15:07:43.061Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765033663061",
  "key": "test-sliding:test-sliding-1765033663061"
}
[2025-12-06T15:07:43.061Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765033663061"
}
[2025-12-06T15:07:43.061Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T15:07:43.061Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T15:07:43.162Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765033663061",
  "key": "test-sliding:test-sliding-1765033663061"
}
[2025-12-06T15:07:43.162Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765033663061",
  "timestampCount": 1
}
[2025-12-06T15:07:43.162Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T15:07:43.162Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T15:07:43.264Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765033663061",
  "key": "test-sliding:test-sliding-1765033663061"
}
[2025-12-06T15:07:43.264Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765033663061",
  "timestampCount": 2
}
[2025-12-06T15:07:43.264Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-06T15:07:43.264Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T15:07:43.264Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T15:07:43.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765033663265",
  "key": "register:test-format-allowed-1765033663265"
}
[2025-12-06T15:07:43.265Z] Creating new entry
{
  "key": "register:test-format-allowed-1765033663265"
}
[2025-12-06T15:07:43.265Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T15:07:43.265Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T15:07:43.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765033663265",
  "key": "register:test-format-blocked-1765033663265"
}
[2025-12-06T15:07:43.265Z] Creating new entry
{
  "key": "register:test-format-blocked-1765033663265"
}
[2025-12-06T15:07:43.265Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-06T15:07:43.265Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-06T15:07:43.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765033663265",
  "key": "register:test-format-blocked-1765033663265"
}
[2025-12-06T15:07:43.265Z] Found existing entry
{
  "key": "register:test-format-blocked-1765033663265",
  "timestampCount": 1
}
[2025-12-06T15:07:43.265Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-06T15:07:43.265Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-06T15:07:43.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765033663265",
  "key": "register:test-format-blocked-1765033663265"
}
[2025-12-06T15:07:43.265Z] Found existing entry
{
  "key": "register:test-format-blocked-1765033663265",
  "timestampCount": 2
}
[2025-12-06T15:07:43.265Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-06T15:07:43.265Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-06T15:07:43.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765033663265",
  "key": "register:test-format-blocked-1765033663265"
}
[2025-12-06T15:07:43.265Z] Found existing entry
{
  "key": "register:test-format-blocked-1765033663265",
  "timestampCount": 3
}
[2025-12-06T15:07:43.265Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-07T12:29:26.318Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765110566317",
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.318Z] Creating new entry
{
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.318Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T12:29:26.318Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T12:29:26.318Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765110566317",
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.318Z] Found existing entry
{
  "key": "login:test-allow-1765110566317",
  "timestampCount": 1
}
[2025-12-07T12:29:26.318Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T12:29:26.318Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765110566317",
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-allow-1765110566317",
  "timestampCount": 2
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765110566317",
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-allow-1765110566317",
  "timestampCount": 3
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765110566317",
  "key": "login:test-allow-1765110566317"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-allow-1765110566317",
  "timestampCount": 4
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.319Z] Creating new entry
{
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-block-1765110566319",
  "timestampCount": 1
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-block-1765110566319",
  "timestampCount": 2
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.319Z] Found existing entry
{
  "key": "login:test-block-1765110566319",
  "timestampCount": 3
}
[2025-12-07T12:29:26.319Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T12:29:26.319Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T12:29:26.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.320Z] Found existing entry
{
  "key": "login:test-block-1765110566319",
  "timestampCount": 4
}
[2025-12-07T12:29:26.320Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T12:29:26.320Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T12:29:26.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765110566319",
  "key": "login:test-block-1765110566319"
}
[2025-12-07T12:29:26.320Z] Found existing entry
{
  "key": "login:test-block-1765110566319",
  "timestampCount": 5
}
[2025-12-07T12:29:26.320Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-07T12:29:26.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765110566320",
  "key": "test-reset:test-reset-1765110566320"
}
[2025-12-07T12:29:26.320Z] Creating new entry
{
  "key": "test-reset:test-reset-1765110566320"
}
[2025-12-07T12:29:26.320Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-07T12:29:26.320Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-07T12:29:26.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765110566320",
  "key": "test-reset:test-reset-1765110566320"
}
[2025-12-07T12:29:26.320Z] Found existing entry
{
  "key": "test-reset:test-reset-1765110566320",
  "timestampCount": 1
}
[2025-12-07T12:29:26.320Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-07T12:29:26.320Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-07T12:29:26.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765110566320",
  "key": "test-reset:test-reset-1765110566320"
}
[2025-12-07T12:29:26.320Z] Found existing entry
{
  "key": "test-reset:test-reset-1765110566320",
  "timestampCount": 2
}
[2025-12-07T12:29:26.320Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-07T12:29:26.472Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765110566320",
  "key": "test-reset:test-reset-1765110566320"
}
[2025-12-07T12:29:26.472Z] Found existing entry
{
  "key": "test-reset:test-reset-1765110566320",
  "timestampCount": 2
}
[2025-12-07T12:29:26.472Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-07T12:29:26.472Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-07T12:29:26.472Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-07T12:29:26.472Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.472Z] Creating new entry
{
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.472Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T12:29:26.472Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T12:29:26.472Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.472Z] Found existing entry
{
  "key": "login:test-multi-1-1765110566472",
  "timestampCount": 1
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T12:29:26.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.473Z] Found existing entry
{
  "key": "login:test-multi-1-1765110566472",
  "timestampCount": 2
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T12:29:26.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.473Z] Found existing entry
{
  "key": "login:test-multi-1-1765110566472",
  "timestampCount": 3
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T12:29:26.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.473Z] Found existing entry
{
  "key": "login:test-multi-1-1765110566472",
  "timestampCount": 4
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T12:29:26.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765110566472",
  "key": "login:test-multi-1-1765110566472"
}
[2025-12-07T12:29:26.473Z] Found existing entry
{
  "key": "login:test-multi-1-1765110566472",
  "timestampCount": 5
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765110566472",
  "key": "login:test-multi-2-1765110566472"
}
[2025-12-07T12:29:26.473Z] Creating new entry
{
  "key": "login:test-multi-2-1765110566472"
}
[2025-12-07T12:29:26.473Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T12:29:26.473Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T12:29:26.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765110566474",
  "key": "login:test-reset-time-1765110566474"
}
[2025-12-07T12:29:26.474Z] Creating new entry
{
  "key": "login:test-reset-time-1765110566474"
}
[2025-12-07T12:29:26.474Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T12:29:26.474Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T12:29:26.475Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T12:29:26.476Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T12:29:26.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T12:29:26.476Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-07T12:29:26.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T12:29:26.476Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T12:29:26.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T12:29:26.476Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-07T12:29:26.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T12:29:26.476Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T12:29:26.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765110566476",
  "key": "test-sliding:test-sliding-1765110566476"
}
[2025-12-07T12:29:26.476Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765110566476"
}
[2025-12-07T12:29:26.476Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T12:29:26.477Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T12:29:26.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765110566476",
  "key": "test-sliding:test-sliding-1765110566476"
}
[2025-12-07T12:29:26.577Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765110566476",
  "timestampCount": 1
}
[2025-12-07T12:29:26.577Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T12:29:26.577Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T12:29:26.681Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765110566476",
  "key": "test-sliding:test-sliding-1765110566476"
}
[2025-12-07T12:29:26.681Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765110566476",
  "timestampCount": 2
}
[2025-12-07T12:29:26.681Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-07T12:29:26.681Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T12:29:26.681Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T12:29:26.681Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765110566681",
  "key": "register:test-format-allowed-1765110566681"
}
[2025-12-07T12:29:26.681Z] Creating new entry
{
  "key": "register:test-format-allowed-1765110566681"
}
[2025-12-07T12:29:26.681Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T12:29:26.681Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T12:29:26.682Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765110566682",
  "key": "register:test-format-blocked-1765110566682"
}
[2025-12-07T12:29:26.682Z] Creating new entry
{
  "key": "register:test-format-blocked-1765110566682"
}
[2025-12-07T12:29:26.682Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T12:29:26.682Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T12:29:26.682Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765110566682",
  "key": "register:test-format-blocked-1765110566682"
}
[2025-12-07T12:29:26.682Z] Found existing entry
{
  "key": "register:test-format-blocked-1765110566682",
  "timestampCount": 1
}
[2025-12-07T12:29:26.682Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T12:29:26.682Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T12:29:26.682Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765110566682",
  "key": "register:test-format-blocked-1765110566682"
}
[2025-12-07T12:29:26.682Z] Found existing entry
{
  "key": "register:test-format-blocked-1765110566682",
  "timestampCount": 2
}
[2025-12-07T12:29:26.682Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-07T12:29:26.682Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-07T12:29:26.682Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765110566682",
  "key": "register:test-format-blocked-1765110566682"
}
[2025-12-07T12:29:26.682Z] Found existing entry
{
  "key": "register:test-format-blocked-1765110566682",
  "timestampCount": 3
}
[2025-12-07T12:29:26.682Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-07T16:05:11.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765123511170",
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Creating new entry
{
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T16:05:11.171Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T16:05:11.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765123511170",
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Found existing entry
{
  "key": "login:test-allow-1765123511170",
  "timestampCount": 1
}
[2025-12-07T16:05:11.171Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T16:05:11.171Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T16:05:11.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765123511170",
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Found existing entry
{
  "key": "login:test-allow-1765123511170",
  "timestampCount": 2
}
[2025-12-07T16:05:11.171Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T16:05:11.171Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T16:05:11.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765123511170",
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Found existing entry
{
  "key": "login:test-allow-1765123511170",
  "timestampCount": 3
}
[2025-12-07T16:05:11.171Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T16:05:11.171Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T16:05:11.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765123511170",
  "key": "login:test-allow-1765123511170"
}
[2025-12-07T16:05:11.171Z] Found existing entry
{
  "key": "login:test-allow-1765123511170",
  "timestampCount": 4
}
[2025-12-07T16:05:11.171Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T16:05:11.171Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Creating new entry
{
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T16:05:11.172Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Found existing entry
{
  "key": "login:test-block-1765123511172",
  "timestampCount": 1
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T16:05:11.172Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Found existing entry
{
  "key": "login:test-block-1765123511172",
  "timestampCount": 2
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T16:05:11.172Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Found existing entry
{
  "key": "login:test-block-1765123511172",
  "timestampCount": 3
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T16:05:11.172Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Found existing entry
{
  "key": "login:test-block-1765123511172",
  "timestampCount": 4
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T16:05:11.172Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T16:05:11.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765123511172",
  "key": "login:test-block-1765123511172"
}
[2025-12-07T16:05:11.172Z] Found existing entry
{
  "key": "login:test-block-1765123511172",
  "timestampCount": 5
}
[2025-12-07T16:05:11.172Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-07T16:05:11.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765123511173",
  "key": "test-reset:test-reset-1765123511173"
}
[2025-12-07T16:05:11.173Z] Creating new entry
{
  "key": "test-reset:test-reset-1765123511173"
}
[2025-12-07T16:05:11.173Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-07T16:05:11.173Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-07T16:05:11.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765123511173",
  "key": "test-reset:test-reset-1765123511173"
}
[2025-12-07T16:05:11.173Z] Found existing entry
{
  "key": "test-reset:test-reset-1765123511173",
  "timestampCount": 1
}
[2025-12-07T16:05:11.173Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-07T16:05:11.173Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-07T16:05:11.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765123511173",
  "key": "test-reset:test-reset-1765123511173"
}
[2025-12-07T16:05:11.173Z] Found existing entry
{
  "key": "test-reset:test-reset-1765123511173",
  "timestampCount": 2
}
[2025-12-07T16:05:11.173Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-07T16:05:11.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765123511173",
  "key": "test-reset:test-reset-1765123511173"
}
[2025-12-07T16:05:11.324Z] Found existing entry
{
  "key": "test-reset:test-reset-1765123511173",
  "timestampCount": 2
}
[2025-12-07T16:05:11.324Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-07T16:05:11.324Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-07T16:05:11.324Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-07T16:05:11.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.324Z] Creating new entry
{
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.324Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T16:05:11.324Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T16:05:11.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.324Z] Found existing entry
{
  "key": "login:test-multi-1-1765123511324",
  "timestampCount": 1
}
[2025-12-07T16:05:11.324Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-07T16:05:11.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.325Z] Found existing entry
{
  "key": "login:test-multi-1-1765123511324",
  "timestampCount": 2
}
[2025-12-07T16:05:11.325Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-07T16:05:11.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.325Z] Found existing entry
{
  "key": "login:test-multi-1-1765123511324",
  "timestampCount": 3
}
[2025-12-07T16:05:11.325Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-07T16:05:11.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.325Z] Found existing entry
{
  "key": "login:test-multi-1-1765123511324",
  "timestampCount": 4
}
[2025-12-07T16:05:11.325Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-07T16:05:11.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765123511324",
  "key": "login:test-multi-1-1765123511324"
}
[2025-12-07T16:05:11.325Z] Found existing entry
{
  "key": "login:test-multi-1-1765123511324",
  "timestampCount": 5
}
[2025-12-07T16:05:11.325Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765123511324",
  "key": "login:test-multi-2-1765123511324"
}
[2025-12-07T16:05:11.325Z] Creating new entry
{
  "key": "login:test-multi-2-1765123511324"
}
[2025-12-07T16:05:11.325Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T16:05:11.325Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T16:05:11.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765123511326",
  "key": "login:test-reset-time-1765123511326"
}
[2025-12-07T16:05:11.326Z] Creating new entry
{
  "key": "login:test-reset-time-1765123511326"
}
[2025-12-07T16:05:11.326Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-07T16:05:11.326Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-07T16:05:11.328Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T16:05:11.328Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T16:05:11.328Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T16:05:11.328Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-07T16:05:11.329Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T16:05:11.329Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T16:05:11.329Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T16:05:11.329Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-07T16:05:11.329Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-07T16:05:11.329Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-07T16:05:11.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765123511329",
  "key": "test-sliding:test-sliding-1765123511329"
}
[2025-12-07T16:05:11.329Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765123511329"
}
[2025-12-07T16:05:11.329Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T16:05:11.329Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T16:05:11.430Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765123511329",
  "key": "test-sliding:test-sliding-1765123511329"
}
[2025-12-07T16:05:11.430Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765123511329",
  "timestampCount": 1
}
[2025-12-07T16:05:11.430Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T16:05:11.430Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T16:05:11.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765123511329",
  "key": "test-sliding:test-sliding-1765123511329"
}
[2025-12-07T16:05:11.531Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765123511329",
  "timestampCount": 2
}
[2025-12-07T16:05:11.531Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-07T16:05:11.531Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T16:05:11.531Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T16:05:11.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765123511531",
  "key": "register:test-format-allowed-1765123511531"
}
[2025-12-07T16:05:11.531Z] Creating new entry
{
  "key": "register:test-format-allowed-1765123511531"
}
[2025-12-07T16:05:11.532Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T16:05:11.532Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T16:05:11.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765123511532",
  "key": "register:test-format-blocked-1765123511532"
}
[2025-12-07T16:05:11.532Z] Creating new entry
{
  "key": "register:test-format-blocked-1765123511532"
}
[2025-12-07T16:05:11.532Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-07T16:05:11.532Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-07T16:05:11.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765123511532",
  "key": "register:test-format-blocked-1765123511532"
}
[2025-12-07T16:05:11.532Z] Found existing entry
{
  "key": "register:test-format-blocked-1765123511532",
  "timestampCount": 1
}
[2025-12-07T16:05:11.532Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-07T16:05:11.532Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-07T16:05:11.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765123511532",
  "key": "register:test-format-blocked-1765123511532"
}
[2025-12-07T16:05:11.532Z] Found existing entry
{
  "key": "register:test-format-blocked-1765123511532",
  "timestampCount": 2
}
[2025-12-07T16:05:11.532Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-07T16:05:11.532Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-07T16:05:11.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765123511532",
  "key": "register:test-format-blocked-1765123511532"
}
[2025-12-07T16:05:11.532Z] Found existing entry
{
  "key": "register:test-format-blocked-1765123511532",
  "timestampCount": 3
}
[2025-12-07T16:05:11.532Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-08T17:27:31.404Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214851404",
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.405Z] Creating new entry
{
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.405Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:27:31.405Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:27:31.405Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214851404",
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.405Z] Found existing entry
{
  "key": "login:test-allow-1765214851404",
  "timestampCount": 1
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:27:31.406Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214851404",
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.406Z] Found existing entry
{
  "key": "login:test-allow-1765214851404",
  "timestampCount": 2
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:27:31.406Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214851404",
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.406Z] Found existing entry
{
  "key": "login:test-allow-1765214851404",
  "timestampCount": 3
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:27:31.406Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214851404",
  "key": "login:test-allow-1765214851404"
}
[2025-12-08T17:27:31.406Z] Found existing entry
{
  "key": "login:test-allow-1765214851404",
  "timestampCount": 4
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:27:31.406Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.406Z] Creating new entry
{
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:27:31.406Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.406Z] Found existing entry
{
  "key": "login:test-block-1765214851406",
  "timestampCount": 1
}
[2025-12-08T17:27:31.406Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:27:31.406Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:27:31.407Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.407Z] Found existing entry
{
  "key": "login:test-block-1765214851406",
  "timestampCount": 2
}
[2025-12-08T17:27:31.407Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:27:31.407Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:27:31.407Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.407Z] Found existing entry
{
  "key": "login:test-block-1765214851406",
  "timestampCount": 3
}
[2025-12-08T17:27:31.407Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:27:31.407Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:27:31.407Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.407Z] Found existing entry
{
  "key": "login:test-block-1765214851406",
  "timestampCount": 4
}
[2025-12-08T17:27:31.407Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:27:31.407Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:27:31.407Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214851406",
  "key": "login:test-block-1765214851406"
}
[2025-12-08T17:27:31.407Z] Found existing entry
{
  "key": "login:test-block-1765214851406",
  "timestampCount": 5
}
[2025-12-08T17:27:31.407Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T17:27:31.407Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214851407",
  "key": "test-reset:test-reset-1765214851407"
}
[2025-12-08T17:27:31.408Z] Creating new entry
{
  "key": "test-reset:test-reset-1765214851407"
}
[2025-12-08T17:27:31.408Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T17:27:31.408Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T17:27:31.408Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214851407",
  "key": "test-reset:test-reset-1765214851407"
}
[2025-12-08T17:27:31.408Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214851407",
  "timestampCount": 1
}
[2025-12-08T17:27:31.408Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-08T17:27:31.408Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-08T17:27:31.408Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214851407",
  "key": "test-reset:test-reset-1765214851407"
}
[2025-12-08T17:27:31.408Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214851407",
  "timestampCount": 2
}
[2025-12-08T17:27:31.408Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-08T17:27:31.574Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214851407",
  "key": "test-reset:test-reset-1765214851407"
}
[2025-12-08T17:27:31.579Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214851407",
  "timestampCount": 2
}
[2025-12-08T17:27:31.579Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-08T17:27:31.579Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T17:27:31.579Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T17:27:31.582Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.582Z] Creating new entry
{
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.582Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:27:31.583Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:27:31.583Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.583Z] Found existing entry
{
  "key": "login:test-multi-1-1765214851582",
  "timestampCount": 1
}
[2025-12-08T17:27:31.583Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:27:31.583Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:27:31.583Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.583Z] Found existing entry
{
  "key": "login:test-multi-1-1765214851582",
  "timestampCount": 2
}
[2025-12-08T17:27:31.583Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:27:31.585Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:27:31.585Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.585Z] Found existing entry
{
  "key": "login:test-multi-1-1765214851582",
  "timestampCount": 3
}
[2025-12-08T17:27:31.585Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:27:31.585Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:27:31.585Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.587Z] Found existing entry
{
  "key": "login:test-multi-1-1765214851582",
  "timestampCount": 4
}
[2025-12-08T17:27:31.587Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:27:31.588Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:27:31.588Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214851582",
  "key": "login:test-multi-1-1765214851582"
}
[2025-12-08T17:27:31.588Z] Found existing entry
{
  "key": "login:test-multi-1-1765214851582",
  "timestampCount": 5
}
[2025-12-08T17:27:31.590Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T17:27:31.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765214851582",
  "key": "login:test-multi-2-1765214851582"
}
[2025-12-08T17:27:31.590Z] Creating new entry
{
  "key": "login:test-multi-2-1765214851582"
}
[2025-12-08T17:27:31.590Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:27:31.590Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:27:31.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765214851592",
  "key": "login:test-reset-time-1765214851592"
}
[2025-12-08T17:27:31.592Z] Creating new entry
{
  "key": "login:test-reset-time-1765214851592"
}
[2025-12-08T17:27:31.593Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:27:31.594Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:27:31.596Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:27:31.596Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:27:31.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:27:31.597Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-08T17:27:31.598Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:27:31.598Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:27:31.599Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:27:31.599Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-08T17:27:31.600Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:27:31.601Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:27:31.601Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214851601",
  "key": "test-sliding:test-sliding-1765214851601"
}
[2025-12-08T17:27:31.601Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765214851601"
}
[2025-12-08T17:27:31.603Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:27:31.603Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:27:31.705Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214851601",
  "key": "test-sliding:test-sliding-1765214851601"
}
[2025-12-08T17:27:31.705Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765214851601",
  "timestampCount": 1
}
[2025-12-08T17:27:31.705Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:27:31.705Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:27:31.810Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214851601",
  "key": "test-sliding:test-sliding-1765214851601"
}
[2025-12-08T17:27:31.810Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765214851601",
  "timestampCount": 2
}
[2025-12-08T17:27:31.810Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-08T17:27:31.810Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:27:31.810Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:27:31.810Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765214851810",
  "key": "register:test-format-allowed-1765214851810"
}
[2025-12-08T17:27:31.810Z] Creating new entry
{
  "key": "register:test-format-allowed-1765214851810"
}
[2025-12-08T17:27:31.810Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:27:31.810Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:27:31.810Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214851810",
  "key": "register:test-format-blocked-1765214851810"
}
[2025-12-08T17:27:31.810Z] Creating new entry
{
  "key": "register:test-format-blocked-1765214851810"
}
[2025-12-08T17:27:31.810Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:27:31.810Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:27:31.811Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214851810",
  "key": "register:test-format-blocked-1765214851810"
}
[2025-12-08T17:27:31.811Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214851810",
  "timestampCount": 1
}
[2025-12-08T17:27:31.811Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:27:31.811Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:27:31.811Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214851810",
  "key": "register:test-format-blocked-1765214851810"
}
[2025-12-08T17:27:31.811Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214851810",
  "timestampCount": 2
}
[2025-12-08T17:27:31.811Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-08T17:27:31.811Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-08T17:27:31.811Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214851810",
  "key": "register:test-format-blocked-1765214851810"
}
[2025-12-08T17:27:31.811Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214851810",
  "timestampCount": 3
}
[2025-12-08T17:27:31.811Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-08T17:29:04.013Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214944013",
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.014Z] Creating new entry
{
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.014Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:29:04.014Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:29:04.015Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214944013",
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.015Z] Found existing entry
{
  "key": "login:test-allow-1765214944013",
  "timestampCount": 1
}
[2025-12-08T17:29:04.015Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:29:04.015Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:29:04.015Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214944013",
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.015Z] Found existing entry
{
  "key": "login:test-allow-1765214944013",
  "timestampCount": 2
}
[2025-12-08T17:29:04.015Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:29:04.015Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:29:04.015Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214944013",
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.015Z] Found existing entry
{
  "key": "login:test-allow-1765214944013",
  "timestampCount": 3
}
[2025-12-08T17:29:04.015Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:29:04.015Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:29:04.015Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765214944013",
  "key": "login:test-allow-1765214944013"
}
[2025-12-08T17:29:04.015Z] Found existing entry
{
  "key": "login:test-allow-1765214944013",
  "timestampCount": 4
}
[2025-12-08T17:29:04.015Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:29:04.015Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:29:04.016Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.016Z] Creating new entry
{
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.016Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:29:04.016Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:29:04.016Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.016Z] Found existing entry
{
  "key": "login:test-block-1765214944016",
  "timestampCount": 1
}
[2025-12-08T17:29:04.016Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:29:04.016Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:29:04.016Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.016Z] Found existing entry
{
  "key": "login:test-block-1765214944016",
  "timestampCount": 2
}
[2025-12-08T17:29:04.016Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:29:04.016Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:29:04.016Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.016Z] Found existing entry
{
  "key": "login:test-block-1765214944016",
  "timestampCount": 3
}
[2025-12-08T17:29:04.017Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:29:04.017Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:29:04.017Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.017Z] Found existing entry
{
  "key": "login:test-block-1765214944016",
  "timestampCount": 4
}
[2025-12-08T17:29:04.017Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:29:04.017Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:29:04.017Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765214944016",
  "key": "login:test-block-1765214944016"
}
[2025-12-08T17:29:04.017Z] Found existing entry
{
  "key": "login:test-block-1765214944016",
  "timestampCount": 5
}
[2025-12-08T17:29:04.017Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T17:29:04.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214944018",
  "key": "test-reset:test-reset-1765214944018"
}
[2025-12-08T17:29:04.018Z] Creating new entry
{
  "key": "test-reset:test-reset-1765214944018"
}
[2025-12-08T17:29:04.018Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T17:29:04.018Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T17:29:04.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214944018",
  "key": "test-reset:test-reset-1765214944018"
}
[2025-12-08T17:29:04.019Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214944018",
  "timestampCount": 1
}
[2025-12-08T17:29:04.019Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-08T17:29:04.019Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-08T17:29:04.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214944018",
  "key": "test-reset:test-reset-1765214944018"
}
[2025-12-08T17:29:04.019Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214944018",
  "timestampCount": 2
}
[2025-12-08T17:29:04.019Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-08T17:29:04.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765214944018",
  "key": "test-reset:test-reset-1765214944018"
}
[2025-12-08T17:29:04.172Z] Found existing entry
{
  "key": "test-reset:test-reset-1765214944018",
  "timestampCount": 2
}
[2025-12-08T17:29:04.172Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-08T17:29:04.172Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T17:29:04.172Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T17:29:04.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.173Z] Creating new entry
{
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.173Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:29:04.173Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:29:04.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.173Z] Found existing entry
{
  "key": "login:test-multi-1-1765214944173",
  "timestampCount": 1
}
[2025-12-08T17:29:04.173Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T17:29:04.174Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T17:29:04.174Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.174Z] Found existing entry
{
  "key": "login:test-multi-1-1765214944173",
  "timestampCount": 2
}
[2025-12-08T17:29:04.174Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T17:29:04.174Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T17:29:04.174Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.174Z] Found existing entry
{
  "key": "login:test-multi-1-1765214944173",
  "timestampCount": 3
}
[2025-12-08T17:29:04.174Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T17:29:04.174Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T17:29:04.174Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.174Z] Found existing entry
{
  "key": "login:test-multi-1-1765214944173",
  "timestampCount": 4
}
[2025-12-08T17:29:04.174Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T17:29:04.174Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T17:29:04.175Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765214944173",
  "key": "login:test-multi-1-1765214944173"
}
[2025-12-08T17:29:04.175Z] Found existing entry
{
  "key": "login:test-multi-1-1765214944173",
  "timestampCount": 5
}
[2025-12-08T17:29:04.175Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T17:29:04.175Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765214944173",
  "key": "login:test-multi-2-1765214944173"
}
[2025-12-08T17:29:04.175Z] Creating new entry
{
  "key": "login:test-multi-2-1765214944173"
}
[2025-12-08T17:29:04.175Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:29:04.175Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:29:04.176Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765214944176",
  "key": "login:test-reset-time-1765214944176"
}
[2025-12-08T17:29:04.176Z] Creating new entry
{
  "key": "login:test-reset-time-1765214944176"
}
[2025-12-08T17:29:04.176Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T17:29:04.176Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T17:29:04.177Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:29:04.177Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:29:04.178Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:29:04.178Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-08T17:29:04.178Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:29:04.178Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:29:04.178Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:29:04.178Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-08T17:29:04.178Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T17:29:04.178Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T17:29:04.178Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214944178",
  "key": "test-sliding:test-sliding-1765214944178"
}
[2025-12-08T17:29:04.178Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765214944178"
}
[2025-12-08T17:29:04.178Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:29:04.178Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:29:04.280Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214944178",
  "key": "test-sliding:test-sliding-1765214944178"
}
[2025-12-08T17:29:04.280Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765214944178",
  "timestampCount": 1
}
[2025-12-08T17:29:04.280Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:29:04.280Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:29:04.381Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765214944178",
  "key": "test-sliding:test-sliding-1765214944178"
}
[2025-12-08T17:29:04.381Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765214944178",
  "timestampCount": 2
}
[2025-12-08T17:29:04.381Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-08T17:29:04.381Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:29:04.381Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:29:04.381Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765214944381",
  "key": "register:test-format-allowed-1765214944381"
}
[2025-12-08T17:29:04.381Z] Creating new entry
{
  "key": "register:test-format-allowed-1765214944381"
}
[2025-12-08T17:29:04.382Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:29:04.382Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:29:04.382Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214944382",
  "key": "register:test-format-blocked-1765214944382"
}
[2025-12-08T17:29:04.382Z] Creating new entry
{
  "key": "register:test-format-blocked-1765214944382"
}
[2025-12-08T17:29:04.382Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T17:29:04.382Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T17:29:04.382Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214944382",
  "key": "register:test-format-blocked-1765214944382"
}
[2025-12-08T17:29:04.382Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214944382",
  "timestampCount": 1
}
[2025-12-08T17:29:04.382Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T17:29:04.382Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T17:29:04.382Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214944382",
  "key": "register:test-format-blocked-1765214944382"
}
[2025-12-08T17:29:04.382Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214944382",
  "timestampCount": 2
}
[2025-12-08T17:29:04.382Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-08T17:29:04.382Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-08T17:29:04.382Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765214944382",
  "key": "register:test-format-blocked-1765214944382"
}
[2025-12-08T17:29:04.382Z] Found existing entry
{
  "key": "register:test-format-blocked-1765214944382",
  "timestampCount": 3
}
[2025-12-08T17:29:04.382Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-08T18:36:12.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765218972102",
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.105Z] Creating new entry
{
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.105Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T18:36:12.105Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T18:36:12.105Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765218972102",
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.106Z] Found existing entry
{
  "key": "login:test-allow-1765218972102",
  "timestampCount": 1
}
[2025-12-08T18:36:12.106Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T18:36:12.106Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T18:36:12.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765218972102",
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.106Z] Found existing entry
{
  "key": "login:test-allow-1765218972102",
  "timestampCount": 2
}
[2025-12-08T18:36:12.106Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T18:36:12.106Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T18:36:12.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765218972102",
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.106Z] Found existing entry
{
  "key": "login:test-allow-1765218972102",
  "timestampCount": 3
}
[2025-12-08T18:36:12.106Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T18:36:12.106Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T18:36:12.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765218972102",
  "key": "login:test-allow-1765218972102"
}
[2025-12-08T18:36:12.106Z] Found existing entry
{
  "key": "login:test-allow-1765218972102",
  "timestampCount": 4
}
[2025-12-08T18:36:12.106Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T18:36:12.106Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T18:36:12.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.106Z] Creating new entry
{
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.106Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T18:36:12.108Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T18:36:12.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.108Z] Found existing entry
{
  "key": "login:test-block-1765218972106",
  "timestampCount": 1
}
[2025-12-08T18:36:12.108Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T18:36:12.108Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T18:36:12.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.108Z] Found existing entry
{
  "key": "login:test-block-1765218972106",
  "timestampCount": 2
}
[2025-12-08T18:36:12.108Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T18:36:12.109Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T18:36:12.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.109Z] Found existing entry
{
  "key": "login:test-block-1765218972106",
  "timestampCount": 3
}
[2025-12-08T18:36:12.109Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T18:36:12.109Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T18:36:12.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.109Z] Found existing entry
{
  "key": "login:test-block-1765218972106",
  "timestampCount": 4
}
[2025-12-08T18:36:12.109Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T18:36:12.109Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T18:36:12.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765218972106",
  "key": "login:test-block-1765218972106"
}
[2025-12-08T18:36:12.109Z] Found existing entry
{
  "key": "login:test-block-1765218972106",
  "timestampCount": 5
}
[2025-12-08T18:36:12.109Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T18:36:12.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765218972110",
  "key": "test-reset:test-reset-1765218972110"
}
[2025-12-08T18:36:12.110Z] Creating new entry
{
  "key": "test-reset:test-reset-1765218972110"
}
[2025-12-08T18:36:12.110Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T18:36:12.110Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T18:36:12.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765218972110",
  "key": "test-reset:test-reset-1765218972110"
}
[2025-12-08T18:36:12.110Z] Found existing entry
{
  "key": "test-reset:test-reset-1765218972110",
  "timestampCount": 1
}
[2025-12-08T18:36:12.110Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-08T18:36:12.110Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-08T18:36:12.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765218972110",
  "key": "test-reset:test-reset-1765218972110"
}
[2025-12-08T18:36:12.111Z] Found existing entry
{
  "key": "test-reset:test-reset-1765218972110",
  "timestampCount": 2
}
[2025-12-08T18:36:12.111Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-08T18:36:12.262Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765218972110",
  "key": "test-reset:test-reset-1765218972110"
}
[2025-12-08T18:36:12.262Z] Found existing entry
{
  "key": "test-reset:test-reset-1765218972110",
  "timestampCount": 2
}
[2025-12-08T18:36:12.262Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-08T18:36:12.262Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T18:36:12.262Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T18:36:12.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.263Z] Creating new entry
{
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.263Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T18:36:12.263Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T18:36:12.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.264Z] Found existing entry
{
  "key": "login:test-multi-1-1765218972263",
  "timestampCount": 1
}
[2025-12-08T18:36:12.264Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T18:36:12.264Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T18:36:12.264Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.264Z] Found existing entry
{
  "key": "login:test-multi-1-1765218972263",
  "timestampCount": 2
}
[2025-12-08T18:36:12.264Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T18:36:12.264Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T18:36:12.264Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.264Z] Found existing entry
{
  "key": "login:test-multi-1-1765218972263",
  "timestampCount": 3
}
[2025-12-08T18:36:12.264Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T18:36:12.264Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T18:36:12.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.265Z] Found existing entry
{
  "key": "login:test-multi-1-1765218972263",
  "timestampCount": 4
}
[2025-12-08T18:36:12.265Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T18:36:12.265Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T18:36:12.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765218972263",
  "key": "login:test-multi-1-1765218972263"
}
[2025-12-08T18:36:12.265Z] Found existing entry
{
  "key": "login:test-multi-1-1765218972263",
  "timestampCount": 5
}
[2025-12-08T18:36:12.265Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T18:36:12.265Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765218972263",
  "key": "login:test-multi-2-1765218972263"
}
[2025-12-08T18:36:12.266Z] Creating new entry
{
  "key": "login:test-multi-2-1765218972263"
}
[2025-12-08T18:36:12.266Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T18:36:12.266Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T18:36:12.266Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765218972266",
  "key": "login:test-reset-time-1765218972266"
}
[2025-12-08T18:36:12.266Z] Creating new entry
{
  "key": "login:test-reset-time-1765218972266"
}
[2025-12-08T18:36:12.266Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T18:36:12.266Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T18:36:12.267Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T18:36:12.267Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T18:36:12.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T18:36:12.268Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-08T18:36:12.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T18:36:12.268Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T18:36:12.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T18:36:12.268Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-08T18:36:12.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T18:36:12.268Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T18:36:12.270Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765218972270",
  "key": "test-sliding:test-sliding-1765218972270"
}
[2025-12-08T18:36:12.270Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765218972270"
}
[2025-12-08T18:36:12.270Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T18:36:12.270Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T18:36:12.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765218972270",
  "key": "test-sliding:test-sliding-1765218972270"
}
[2025-12-08T18:36:12.372Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765218972270",
  "timestampCount": 1
}
[2025-12-08T18:36:12.372Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T18:36:12.372Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T18:36:12.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765218972270",
  "key": "test-sliding:test-sliding-1765218972270"
}
[2025-12-08T18:36:12.475Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765218972270",
  "timestampCount": 2
}
[2025-12-08T18:36:12.475Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-08T18:36:12.475Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T18:36:12.475Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T18:36:12.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765218972476",
  "key": "register:test-format-allowed-1765218972476"
}
[2025-12-08T18:36:12.476Z] Creating new entry
{
  "key": "register:test-format-allowed-1765218972476"
}
[2025-12-08T18:36:12.476Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T18:36:12.477Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T18:36:12.477Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765218972477",
  "key": "register:test-format-blocked-1765218972477"
}
[2025-12-08T18:36:12.477Z] Creating new entry
{
  "key": "register:test-format-blocked-1765218972477"
}
[2025-12-08T18:36:12.477Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T18:36:12.477Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T18:36:12.477Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765218972477",
  "key": "register:test-format-blocked-1765218972477"
}
[2025-12-08T18:36:12.478Z] Found existing entry
{
  "key": "register:test-format-blocked-1765218972477",
  "timestampCount": 1
}
[2025-12-08T18:36:12.478Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T18:36:12.478Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T18:36:12.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765218972477",
  "key": "register:test-format-blocked-1765218972477"
}
[2025-12-08T18:36:12.478Z] Found existing entry
{
  "key": "register:test-format-blocked-1765218972477",
  "timestampCount": 2
}
[2025-12-08T18:36:12.478Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-08T18:36:12.478Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-08T18:36:12.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765218972477",
  "key": "register:test-format-blocked-1765218972477"
}
[2025-12-08T18:36:12.478Z] Found existing entry
{
  "key": "register:test-format-blocked-1765218972477",
  "timestampCount": 3
}
[2025-12-08T18:36:12.478Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-08T20:21:22.007Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765225282007",
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.008Z] Creating new entry
{
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.008Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:21:22.008Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:21:22.008Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765225282007",
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.008Z] Found existing entry
{
  "key": "login:test-allow-1765225282007",
  "timestampCount": 1
}
[2025-12-08T20:21:22.009Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:21:22.009Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:21:22.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765225282007",
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.009Z] Found existing entry
{
  "key": "login:test-allow-1765225282007",
  "timestampCount": 2
}
[2025-12-08T20:21:22.009Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:21:22.009Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:21:22.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765225282007",
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.009Z] Found existing entry
{
  "key": "login:test-allow-1765225282007",
  "timestampCount": 3
}
[2025-12-08T20:21:22.009Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:21:22.009Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:21:22.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765225282007",
  "key": "login:test-allow-1765225282007"
}
[2025-12-08T20:21:22.009Z] Found existing entry
{
  "key": "login:test-allow-1765225282007",
  "timestampCount": 4
}
[2025-12-08T20:21:22.009Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:21:22.009Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:21:22.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.009Z] Creating new entry
{
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.009Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:21:22.009Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:21:22.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.010Z] Found existing entry
{
  "key": "login:test-block-1765225282009",
  "timestampCount": 1
}
[2025-12-08T20:21:22.010Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:21:22.010Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:21:22.010Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.010Z] Found existing entry
{
  "key": "login:test-block-1765225282009",
  "timestampCount": 2
}
[2025-12-08T20:21:22.010Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:21:22.010Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:21:22.010Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.010Z] Found existing entry
{
  "key": "login:test-block-1765225282009",
  "timestampCount": 3
}
[2025-12-08T20:21:22.010Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:21:22.010Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:21:22.010Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.010Z] Found existing entry
{
  "key": "login:test-block-1765225282009",
  "timestampCount": 4
}
[2025-12-08T20:21:22.010Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:21:22.010Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:21:22.010Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765225282009",
  "key": "login:test-block-1765225282009"
}
[2025-12-08T20:21:22.010Z] Found existing entry
{
  "key": "login:test-block-1765225282009",
  "timestampCount": 5
}
[2025-12-08T20:21:22.010Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T20:21:22.011Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765225282011",
  "key": "test-reset:test-reset-1765225282011"
}
[2025-12-08T20:21:22.011Z] Creating new entry
{
  "key": "test-reset:test-reset-1765225282011"
}
[2025-12-08T20:21:22.011Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T20:21:22.011Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T20:21:22.011Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765225282011",
  "key": "test-reset:test-reset-1765225282011"
}
[2025-12-08T20:21:22.011Z] Found existing entry
{
  "key": "test-reset:test-reset-1765225282011",
  "timestampCount": 1
}
[2025-12-08T20:21:22.011Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-08T20:21:22.011Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-08T20:21:22.011Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765225282011",
  "key": "test-reset:test-reset-1765225282011"
}
[2025-12-08T20:21:22.011Z] Found existing entry
{
  "key": "test-reset:test-reset-1765225282011",
  "timestampCount": 2
}
[2025-12-08T20:21:22.011Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-08T20:21:22.163Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765225282011",
  "key": "test-reset:test-reset-1765225282011"
}
[2025-12-08T20:21:22.163Z] Found existing entry
{
  "key": "test-reset:test-reset-1765225282011",
  "timestampCount": 2
}
[2025-12-08T20:21:22.163Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-08T20:21:22.163Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T20:21:22.163Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T20:21:22.163Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.163Z] Creating new entry
{
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.163Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:21:22.163Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:21:22.163Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.164Z] Found existing entry
{
  "key": "login:test-multi-1-1765225282163",
  "timestampCount": 1
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:21:22.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.164Z] Found existing entry
{
  "key": "login:test-multi-1-1765225282163",
  "timestampCount": 2
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:21:22.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.164Z] Found existing entry
{
  "key": "login:test-multi-1-1765225282163",
  "timestampCount": 3
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:21:22.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.164Z] Found existing entry
{
  "key": "login:test-multi-1-1765225282163",
  "timestampCount": 4
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:21:22.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765225282163",
  "key": "login:test-multi-1-1765225282163"
}
[2025-12-08T20:21:22.164Z] Found existing entry
{
  "key": "login:test-multi-1-1765225282163",
  "timestampCount": 5
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765225282163",
  "key": "login:test-multi-2-1765225282163"
}
[2025-12-08T20:21:22.164Z] Creating new entry
{
  "key": "login:test-multi-2-1765225282163"
}
[2025-12-08T20:21:22.164Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:21:22.164Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:21:22.165Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765225282165",
  "key": "login:test-reset-time-1765225282165"
}
[2025-12-08T20:21:22.165Z] Creating new entry
{
  "key": "login:test-reset-time-1765225282165"
}
[2025-12-08T20:21:22.165Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:21:22.165Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:21:22.166Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:21:22.166Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:21:22.166Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:21:22.166Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-08T20:21:22.166Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:21:22.166Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:21:22.166Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:21:22.166Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-08T20:21:22.166Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:21:22.166Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:21:22.166Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765225282166",
  "key": "test-sliding:test-sliding-1765225282166"
}
[2025-12-08T20:21:22.166Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765225282166"
}
[2025-12-08T20:21:22.166Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:21:22.166Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:21:22.267Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765225282166",
  "key": "test-sliding:test-sliding-1765225282166"
}
[2025-12-08T20:21:22.267Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765225282166",
  "timestampCount": 1
}
[2025-12-08T20:21:22.268Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:21:22.268Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:21:22.374Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765225282166",
  "key": "test-sliding:test-sliding-1765225282166"
}
[2025-12-08T20:21:22.375Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765225282166",
  "timestampCount": 2
}
[2025-12-08T20:21:22.375Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-08T20:21:22.375Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:21:22.376Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:21:22.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765225282378",
  "key": "register:test-format-allowed-1765225282378"
}
[2025-12-08T20:21:22.378Z] Creating new entry
{
  "key": "register:test-format-allowed-1765225282378"
}
[2025-12-08T20:21:22.378Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:21:22.379Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:21:22.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765225282379",
  "key": "register:test-format-blocked-1765225282379"
}
[2025-12-08T20:21:22.379Z] Creating new entry
{
  "key": "register:test-format-blocked-1765225282379"
}
[2025-12-08T20:21:22.379Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:21:22.379Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:21:22.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765225282379",
  "key": "register:test-format-blocked-1765225282379"
}
[2025-12-08T20:21:22.379Z] Found existing entry
{
  "key": "register:test-format-blocked-1765225282379",
  "timestampCount": 1
}
[2025-12-08T20:21:22.379Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:21:22.379Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:21:22.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765225282379",
  "key": "register:test-format-blocked-1765225282379"
}
[2025-12-08T20:21:22.379Z] Found existing entry
{
  "key": "register:test-format-blocked-1765225282379",
  "timestampCount": 2
}
[2025-12-08T20:21:22.379Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-08T20:21:22.379Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-08T20:21:22.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765225282379",
  "key": "register:test-format-blocked-1765225282379"
}
[2025-12-08T20:21:22.379Z] Found existing entry
{
  "key": "register:test-format-blocked-1765225282379",
  "timestampCount": 3
}
[2025-12-08T20:21:22.379Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-08T20:44:58.761Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765226698761",
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.761Z] Creating new entry
{
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.761Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:44:58.761Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:44:58.762Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765226698761",
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.762Z] Found existing entry
{
  "key": "login:test-allow-1765226698761",
  "timestampCount": 1
}
[2025-12-08T20:44:58.762Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:44:58.762Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:44:58.762Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765226698761",
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.762Z] Found existing entry
{
  "key": "login:test-allow-1765226698761",
  "timestampCount": 2
}
[2025-12-08T20:44:58.762Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:44:58.762Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:44:58.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765226698761",
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.763Z] Found existing entry
{
  "key": "login:test-allow-1765226698761",
  "timestampCount": 3
}
[2025-12-08T20:44:58.763Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:44:58.763Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:44:58.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765226698761",
  "key": "login:test-allow-1765226698761"
}
[2025-12-08T20:44:58.763Z] Found existing entry
{
  "key": "login:test-allow-1765226698761",
  "timestampCount": 4
}
[2025-12-08T20:44:58.763Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:44:58.763Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:44:58.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.764Z] Creating new entry
{
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.764Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:44:58.764Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:44:58.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.764Z] Found existing entry
{
  "key": "login:test-block-1765226698764",
  "timestampCount": 1
}
[2025-12-08T20:44:58.764Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:44:58.764Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:44:58.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.765Z] Found existing entry
{
  "key": "login:test-block-1765226698764",
  "timestampCount": 2
}
[2025-12-08T20:44:58.765Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:44:58.765Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:44:58.765Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.765Z] Found existing entry
{
  "key": "login:test-block-1765226698764",
  "timestampCount": 3
}
[2025-12-08T20:44:58.765Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:44:58.765Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:44:58.765Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.765Z] Found existing entry
{
  "key": "login:test-block-1765226698764",
  "timestampCount": 4
}
[2025-12-08T20:44:58.765Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:44:58.765Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:44:58.765Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765226698764",
  "key": "login:test-block-1765226698764"
}
[2025-12-08T20:44:58.765Z] Found existing entry
{
  "key": "login:test-block-1765226698764",
  "timestampCount": 5
}
[2025-12-08T20:44:58.766Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T20:44:58.766Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765226698766",
  "key": "test-reset:test-reset-1765226698766"
}
[2025-12-08T20:44:58.766Z] Creating new entry
{
  "key": "test-reset:test-reset-1765226698766"
}
[2025-12-08T20:44:58.766Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T20:44:58.766Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T20:44:58.766Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765226698766",
  "key": "test-reset:test-reset-1765226698766"
}
[2025-12-08T20:44:58.766Z] Found existing entry
{
  "key": "test-reset:test-reset-1765226698766",
  "timestampCount": 1
}
[2025-12-08T20:44:58.766Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-08T20:44:58.766Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-08T20:44:58.767Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765226698766",
  "key": "test-reset:test-reset-1765226698766"
}
[2025-12-08T20:44:58.767Z] Found existing entry
{
  "key": "test-reset:test-reset-1765226698766",
  "timestampCount": 2
}
[2025-12-08T20:44:58.767Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-08T20:44:58.919Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765226698766",
  "key": "test-reset:test-reset-1765226698766"
}
[2025-12-08T20:44:58.919Z] Found existing entry
{
  "key": "test-reset:test-reset-1765226698766",
  "timestampCount": 2
}
[2025-12-08T20:44:58.919Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-08T20:44:58.920Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-08T20:44:58.923Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-08T20:44:58.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.923Z] Creating new entry
{
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.923Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:44:58.924Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:44:58.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.924Z] Found existing entry
{
  "key": "login:test-multi-1-1765226698923",
  "timestampCount": 1
}
[2025-12-08T20:44:58.924Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-08T20:44:58.924Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-08T20:44:58.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.924Z] Found existing entry
{
  "key": "login:test-multi-1-1765226698923",
  "timestampCount": 2
}
[2025-12-08T20:44:58.924Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-08T20:44:58.924Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-08T20:44:58.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.924Z] Found existing entry
{
  "key": "login:test-multi-1-1765226698923",
  "timestampCount": 3
}
[2025-12-08T20:44:58.924Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-08T20:44:58.924Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-08T20:44:58.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.924Z] Found existing entry
{
  "key": "login:test-multi-1-1765226698923",
  "timestampCount": 4
}
[2025-12-08T20:44:58.924Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-08T20:44:58.924Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-08T20:44:58.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765226698923",
  "key": "login:test-multi-1-1765226698923"
}
[2025-12-08T20:44:58.924Z] Found existing entry
{
  "key": "login:test-multi-1-1765226698923",
  "timestampCount": 5
}
[2025-12-08T20:44:58.925Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-08T20:44:58.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765226698923",
  "key": "login:test-multi-2-1765226698923"
}
[2025-12-08T20:44:58.925Z] Creating new entry
{
  "key": "login:test-multi-2-1765226698923"
}
[2025-12-08T20:44:58.925Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:44:58.925Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:44:58.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765226698925",
  "key": "login:test-reset-time-1765226698925"
}
[2025-12-08T20:44:58.925Z] Creating new entry
{
  "key": "login:test-reset-time-1765226698925"
}
[2025-12-08T20:44:58.925Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-08T20:44:58.925Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-08T20:44:58.926Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:44:58.927Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:44:58.927Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:44:58.927Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-08T20:44:58.927Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:44:58.927Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:44:58.927Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:44:58.927Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-08T20:44:58.927Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-08T20:44:58.927Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-08T20:44:58.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765226698928",
  "key": "test-sliding:test-sliding-1765226698928"
}
[2025-12-08T20:44:58.928Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765226698928"
}
[2025-12-08T20:44:58.928Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:44:58.928Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:44:59.029Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765226698928",
  "key": "test-sliding:test-sliding-1765226698928"
}
[2025-12-08T20:44:59.029Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765226698928",
  "timestampCount": 1
}
[2025-12-08T20:44:59.029Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:44:59.029Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:44:59.131Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765226698928",
  "key": "test-sliding:test-sliding-1765226698928"
}
[2025-12-08T20:44:59.131Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765226698928",
  "timestampCount": 2
}
[2025-12-08T20:44:59.131Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-08T20:44:59.131Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:44:59.132Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:44:59.132Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765226699132",
  "key": "register:test-format-allowed-1765226699132"
}
[2025-12-08T20:44:59.132Z] Creating new entry
{
  "key": "register:test-format-allowed-1765226699132"
}
[2025-12-08T20:44:59.133Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:44:59.133Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:44:59.133Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765226699133",
  "key": "register:test-format-blocked-1765226699133"
}
[2025-12-08T20:44:59.133Z] Creating new entry
{
  "key": "register:test-format-blocked-1765226699133"
}
[2025-12-08T20:44:59.133Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-08T20:44:59.133Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-08T20:44:59.133Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765226699133",
  "key": "register:test-format-blocked-1765226699133"
}
[2025-12-08T20:44:59.133Z] Found existing entry
{
  "key": "register:test-format-blocked-1765226699133",
  "timestampCount": 1
}
[2025-12-08T20:44:59.133Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-08T20:44:59.133Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-08T20:44:59.133Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765226699133",
  "key": "register:test-format-blocked-1765226699133"
}
[2025-12-08T20:44:59.133Z] Found existing entry
{
  "key": "register:test-format-blocked-1765226699133",
  "timestampCount": 2
}
[2025-12-08T20:44:59.133Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-08T20:44:59.134Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-08T20:44:59.134Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765226699133",
  "key": "register:test-format-blocked-1765226699133"
}
[2025-12-08T20:44:59.134Z] Found existing entry
{
  "key": "register:test-format-blocked-1765226699133",
  "timestampCount": 3
}
[2025-12-08T20:44:59.134Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T12:18:23.060Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282703060",
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.061Z] Creating new entry
{
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.061Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:18:23.061Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:18:23.061Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282703060",
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.061Z] Found existing entry
{
  "key": "login:test-allow-1765282703060",
  "timestampCount": 1
}
[2025-12-09T12:18:23.061Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:18:23.061Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:18:23.062Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282703060",
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.062Z] Found existing entry
{
  "key": "login:test-allow-1765282703060",
  "timestampCount": 2
}
[2025-12-09T12:18:23.062Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:18:23.062Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:18:23.062Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282703060",
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.062Z] Found existing entry
{
  "key": "login:test-allow-1765282703060",
  "timestampCount": 3
}
[2025-12-09T12:18:23.062Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:18:23.062Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:18:23.062Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282703060",
  "key": "login:test-allow-1765282703060"
}
[2025-12-09T12:18:23.062Z] Found existing entry
{
  "key": "login:test-allow-1765282703060",
  "timestampCount": 4
}
[2025-12-09T12:18:23.062Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:18:23.062Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:18:23.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.063Z] Creating new entry
{
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.063Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:18:23.063Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:18:23.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.063Z] Found existing entry
{
  "key": "login:test-block-1765282703063",
  "timestampCount": 1
}
[2025-12-09T12:18:23.063Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:18:23.063Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:18:23.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.063Z] Found existing entry
{
  "key": "login:test-block-1765282703063",
  "timestampCount": 2
}
[2025-12-09T12:18:23.063Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:18:23.063Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:18:23.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.063Z] Found existing entry
{
  "key": "login:test-block-1765282703063",
  "timestampCount": 3
}
[2025-12-09T12:18:23.064Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:18:23.064Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:18:23.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.064Z] Found existing entry
{
  "key": "login:test-block-1765282703063",
  "timestampCount": 4
}
[2025-12-09T12:18:23.064Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:18:23.064Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:18:23.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282703063",
  "key": "login:test-block-1765282703063"
}
[2025-12-09T12:18:23.064Z] Found existing entry
{
  "key": "login:test-block-1765282703063",
  "timestampCount": 5
}
[2025-12-09T12:18:23.064Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T12:18:23.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282703065",
  "key": "test-reset:test-reset-1765282703065"
}
[2025-12-09T12:18:23.065Z] Creating new entry
{
  "key": "test-reset:test-reset-1765282703065"
}
[2025-12-09T12:18:23.065Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T12:18:23.065Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T12:18:23.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282703065",
  "key": "test-reset:test-reset-1765282703065"
}
[2025-12-09T12:18:23.065Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282703065",
  "timestampCount": 1
}
[2025-12-09T12:18:23.065Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T12:18:23.065Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T12:18:23.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282703065",
  "key": "test-reset:test-reset-1765282703065"
}
[2025-12-09T12:18:23.065Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282703065",
  "timestampCount": 2
}
[2025-12-09T12:18:23.065Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T12:18:23.214Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282703065",
  "key": "test-reset:test-reset-1765282703065"
}
[2025-12-09T12:18:23.215Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282703065",
  "timestampCount": 2
}
[2025-12-09T12:18:23.215Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T12:18:23.215Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T12:18:23.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Creating new entry
{
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:18:23.215Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:18:23.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Found existing entry
{
  "key": "login:test-multi-1-1765282703215",
  "timestampCount": 1
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:18:23.215Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:18:23.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Found existing entry
{
  "key": "login:test-multi-1-1765282703215",
  "timestampCount": 2
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:18:23.215Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:18:23.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Found existing entry
{
  "key": "login:test-multi-1-1765282703215",
  "timestampCount": 3
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:18:23.215Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:18:23.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.215Z] Found existing entry
{
  "key": "login:test-multi-1-1765282703215",
  "timestampCount": 4
}
[2025-12-09T12:18:23.215Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:18:23.216Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:18:23.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282703215",
  "key": "login:test-multi-1-1765282703215"
}
[2025-12-09T12:18:23.216Z] Found existing entry
{
  "key": "login:test-multi-1-1765282703215",
  "timestampCount": 5
}
[2025-12-09T12:18:23.216Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T12:18:23.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765282703215",
  "key": "login:test-multi-2-1765282703215"
}
[2025-12-09T12:18:23.216Z] Creating new entry
{
  "key": "login:test-multi-2-1765282703215"
}
[2025-12-09T12:18:23.216Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:18:23.216Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:18:23.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765282703216",
  "key": "login:test-reset-time-1765282703216"
}
[2025-12-09T12:18:23.216Z] Creating new entry
{
  "key": "login:test-reset-time-1765282703216"
}
[2025-12-09T12:18:23.216Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:18:23.216Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:18:23.217Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:18:23.217Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:18:23.217Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:18:23.217Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T12:18:23.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:18:23.218Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:18:23.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:18:23.218Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T12:18:23.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:18:23.218Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:18:23.218Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282703218",
  "key": "test-sliding:test-sliding-1765282703218"
}
[2025-12-09T12:18:23.218Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765282703218"
}
[2025-12-09T12:18:23.218Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:18:23.218Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:18:23.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282703218",
  "key": "test-sliding:test-sliding-1765282703218"
}
[2025-12-09T12:18:23.319Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765282703218",
  "timestampCount": 1
}
[2025-12-09T12:18:23.319Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:18:23.319Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:18:23.420Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282703218",
  "key": "test-sliding:test-sliding-1765282703218"
}
[2025-12-09T12:18:23.421Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765282703218",
  "timestampCount": 2
}
[2025-12-09T12:18:23.421Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T12:18:23.421Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:18:23.421Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:18:23.421Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765282703421",
  "key": "register:test-format-allowed-1765282703421"
}
[2025-12-09T12:18:23.421Z] Creating new entry
{
  "key": "register:test-format-allowed-1765282703421"
}
[2025-12-09T12:18:23.421Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:18:23.421Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:18:23.421Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282703421",
  "key": "register:test-format-blocked-1765282703421"
}
[2025-12-09T12:18:23.421Z] Creating new entry
{
  "key": "register:test-format-blocked-1765282703421"
}
[2025-12-09T12:18:23.421Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:18:23.421Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:18:23.421Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282703421",
  "key": "register:test-format-blocked-1765282703421"
}
[2025-12-09T12:18:23.421Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282703421",
  "timestampCount": 1
}
[2025-12-09T12:18:23.421Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:18:23.422Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:18:23.422Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282703421",
  "key": "register:test-format-blocked-1765282703421"
}
[2025-12-09T12:18:23.422Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282703421",
  "timestampCount": 2
}
[2025-12-09T12:18:23.422Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T12:18:23.422Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T12:18:23.422Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282703421",
  "key": "register:test-format-blocked-1765282703421"
}
[2025-12-09T12:18:23.422Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282703421",
  "timestampCount": 3
}
[2025-12-09T12:18:23.422Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T12:20:18.664Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282818664",
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.664Z] Creating new entry
{
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.664Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:20:18.665Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:20:18.665Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282818664",
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.665Z] Found existing entry
{
  "key": "login:test-allow-1765282818664",
  "timestampCount": 1
}
[2025-12-09T12:20:18.665Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:20:18.665Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:20:18.665Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282818664",
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.665Z] Found existing entry
{
  "key": "login:test-allow-1765282818664",
  "timestampCount": 2
}
[2025-12-09T12:20:18.665Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:20:18.665Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:20:18.665Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282818664",
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.665Z] Found existing entry
{
  "key": "login:test-allow-1765282818664",
  "timestampCount": 3
}
[2025-12-09T12:20:18.665Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:20:18.665Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:20:18.665Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765282818664",
  "key": "login:test-allow-1765282818664"
}
[2025-12-09T12:20:18.665Z] Found existing entry
{
  "key": "login:test-allow-1765282818664",
  "timestampCount": 4
}
[2025-12-09T12:20:18.665Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:20:18.665Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Creating new entry
{
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:20:18.666Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Found existing entry
{
  "key": "login:test-block-1765282818666",
  "timestampCount": 1
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:20:18.666Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Found existing entry
{
  "key": "login:test-block-1765282818666",
  "timestampCount": 2
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:20:18.666Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Found existing entry
{
  "key": "login:test-block-1765282818666",
  "timestampCount": 3
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:20:18.666Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Found existing entry
{
  "key": "login:test-block-1765282818666",
  "timestampCount": 4
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:20:18.666Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:20:18.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765282818666",
  "key": "login:test-block-1765282818666"
}
[2025-12-09T12:20:18.666Z] Found existing entry
{
  "key": "login:test-block-1765282818666",
  "timestampCount": 5
}
[2025-12-09T12:20:18.666Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T12:20:18.667Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282818667",
  "key": "test-reset:test-reset-1765282818667"
}
[2025-12-09T12:20:18.667Z] Creating new entry
{
  "key": "test-reset:test-reset-1765282818667"
}
[2025-12-09T12:20:18.667Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T12:20:18.667Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T12:20:18.667Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282818667",
  "key": "test-reset:test-reset-1765282818667"
}
[2025-12-09T12:20:18.667Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282818667",
  "timestampCount": 1
}
[2025-12-09T12:20:18.667Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T12:20:18.667Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T12:20:18.667Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282818667",
  "key": "test-reset:test-reset-1765282818667"
}
[2025-12-09T12:20:18.667Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282818667",
  "timestampCount": 2
}
[2025-12-09T12:20:18.667Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T12:20:18.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765282818667",
  "key": "test-reset:test-reset-1765282818667"
}
[2025-12-09T12:20:18.818Z] Found existing entry
{
  "key": "test-reset:test-reset-1765282818667",
  "timestampCount": 2
}
[2025-12-09T12:20:18.818Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T12:20:18.818Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T12:20:18.818Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T12:20:18.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.818Z] Creating new entry
{
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.818Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:20:18.818Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:20:18.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.818Z] Found existing entry
{
  "key": "login:test-multi-1-1765282818818",
  "timestampCount": 1
}
[2025-12-09T12:20:18.818Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T12:20:18.818Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T12:20:18.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.818Z] Found existing entry
{
  "key": "login:test-multi-1-1765282818818",
  "timestampCount": 2
}
[2025-12-09T12:20:18.818Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T12:20:18.818Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T12:20:18.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.819Z] Found existing entry
{
  "key": "login:test-multi-1-1765282818818",
  "timestampCount": 3
}
[2025-12-09T12:20:18.819Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T12:20:18.819Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T12:20:18.819Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.819Z] Found existing entry
{
  "key": "login:test-multi-1-1765282818818",
  "timestampCount": 4
}
[2025-12-09T12:20:18.819Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T12:20:18.819Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T12:20:18.819Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765282818818",
  "key": "login:test-multi-1-1765282818818"
}
[2025-12-09T12:20:18.819Z] Found existing entry
{
  "key": "login:test-multi-1-1765282818818",
  "timestampCount": 5
}
[2025-12-09T12:20:18.819Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T12:20:18.819Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765282818818",
  "key": "login:test-multi-2-1765282818818"
}
[2025-12-09T12:20:18.819Z] Creating new entry
{
  "key": "login:test-multi-2-1765282818818"
}
[2025-12-09T12:20:18.819Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:20:18.819Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:20:18.819Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765282818819",
  "key": "login:test-reset-time-1765282818819"
}
[2025-12-09T12:20:18.819Z] Creating new entry
{
  "key": "login:test-reset-time-1765282818819"
}
[2025-12-09T12:20:18.819Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T12:20:18.819Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T12:20:18.820Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:20:18.820Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:20:18.820Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:20:18.820Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T12:20:18.821Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:20:18.821Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:20:18.821Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:20:18.821Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T12:20:18.821Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T12:20:18.821Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T12:20:18.821Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282818821",
  "key": "test-sliding:test-sliding-1765282818821"
}
[2025-12-09T12:20:18.821Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765282818821"
}
[2025-12-09T12:20:18.821Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:20:18.821Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:20:18.922Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282818821",
  "key": "test-sliding:test-sliding-1765282818821"
}
[2025-12-09T12:20:18.922Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765282818821",
  "timestampCount": 1
}
[2025-12-09T12:20:18.922Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:20:18.922Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:20:19.023Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765282818821",
  "key": "test-sliding:test-sliding-1765282818821"
}
[2025-12-09T12:20:19.023Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765282818821",
  "timestampCount": 2
}
[2025-12-09T12:20:19.023Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T12:20:19.024Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:20:19.024Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:20:19.024Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765282819024",
  "key": "register:test-format-allowed-1765282819024"
}
[2025-12-09T12:20:19.024Z] Creating new entry
{
  "key": "register:test-format-allowed-1765282819024"
}
[2025-12-09T12:20:19.025Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:20:19.025Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:20:19.026Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282819026",
  "key": "register:test-format-blocked-1765282819026"
}
[2025-12-09T12:20:19.026Z] Creating new entry
{
  "key": "register:test-format-blocked-1765282819026"
}
[2025-12-09T12:20:19.026Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T12:20:19.026Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T12:20:19.026Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282819026",
  "key": "register:test-format-blocked-1765282819026"
}
[2025-12-09T12:20:19.026Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282819026",
  "timestampCount": 1
}
[2025-12-09T12:20:19.026Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T12:20:19.026Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T12:20:19.026Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282819026",
  "key": "register:test-format-blocked-1765282819026"
}
[2025-12-09T12:20:19.026Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282819026",
  "timestampCount": 2
}
[2025-12-09T12:20:19.026Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T12:20:19.027Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T12:20:19.027Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765282819026",
  "key": "register:test-format-blocked-1765282819026"
}
[2025-12-09T12:20:19.027Z] Found existing entry
{
  "key": "register:test-format-blocked-1765282819026",
  "timestampCount": 3
}
[2025-12-09T12:20:19.027Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T13:09:43.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765285783922",
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.923Z] Creating new entry
{
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.923Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T13:09:43.923Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T13:09:43.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765285783922",
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.924Z] Found existing entry
{
  "key": "login:test-allow-1765285783922",
  "timestampCount": 1
}
[2025-12-09T13:09:43.924Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T13:09:43.924Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T13:09:43.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765285783922",
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.924Z] Found existing entry
{
  "key": "login:test-allow-1765285783922",
  "timestampCount": 2
}
[2025-12-09T13:09:43.924Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T13:09:43.924Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T13:09:43.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765285783922",
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.924Z] Found existing entry
{
  "key": "login:test-allow-1765285783922",
  "timestampCount": 3
}
[2025-12-09T13:09:43.924Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T13:09:43.924Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T13:09:43.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765285783922",
  "key": "login:test-allow-1765285783922"
}
[2025-12-09T13:09:43.924Z] Found existing entry
{
  "key": "login:test-allow-1765285783922",
  "timestampCount": 4
}
[2025-12-09T13:09:43.924Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T13:09:43.924Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Creating new entry
{
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T13:09:43.925Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Found existing entry
{
  "key": "login:test-block-1765285783925",
  "timestampCount": 1
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T13:09:43.925Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Found existing entry
{
  "key": "login:test-block-1765285783925",
  "timestampCount": 2
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T13:09:43.925Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Found existing entry
{
  "key": "login:test-block-1765285783925",
  "timestampCount": 3
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T13:09:43.925Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Found existing entry
{
  "key": "login:test-block-1765285783925",
  "timestampCount": 4
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T13:09:43.925Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T13:09:43.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765285783925",
  "key": "login:test-block-1765285783925"
}
[2025-12-09T13:09:43.925Z] Found existing entry
{
  "key": "login:test-block-1765285783925",
  "timestampCount": 5
}
[2025-12-09T13:09:43.925Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T13:09:43.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765285783926",
  "key": "test-reset:test-reset-1765285783926"
}
[2025-12-09T13:09:43.926Z] Creating new entry
{
  "key": "test-reset:test-reset-1765285783926"
}
[2025-12-09T13:09:43.926Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T13:09:43.926Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T13:09:43.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765285783926",
  "key": "test-reset:test-reset-1765285783926"
}
[2025-12-09T13:09:43.926Z] Found existing entry
{
  "key": "test-reset:test-reset-1765285783926",
  "timestampCount": 1
}
[2025-12-09T13:09:43.926Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T13:09:43.926Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T13:09:43.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765285783926",
  "key": "test-reset:test-reset-1765285783926"
}
[2025-12-09T13:09:43.926Z] Found existing entry
{
  "key": "test-reset:test-reset-1765285783926",
  "timestampCount": 2
}
[2025-12-09T13:09:43.926Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T13:09:44.077Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765285783926",
  "key": "test-reset:test-reset-1765285783926"
}
[2025-12-09T13:09:44.077Z] Found existing entry
{
  "key": "test-reset:test-reset-1765285783926",
  "timestampCount": 2
}
[2025-12-09T13:09:44.077Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T13:09:44.077Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T13:09:44.077Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T13:09:44.077Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.077Z] Creating new entry
{
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.077Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T13:09:44.077Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.078Z] Found existing entry
{
  "key": "login:test-multi-1-1765285784077",
  "timestampCount": 1
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.078Z] Found existing entry
{
  "key": "login:test-multi-1-1765285784077",
  "timestampCount": 2
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.078Z] Found existing entry
{
  "key": "login:test-multi-1-1765285784077",
  "timestampCount": 3
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.078Z] Found existing entry
{
  "key": "login:test-multi-1-1765285784077",
  "timestampCount": 4
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765285784077",
  "key": "login:test-multi-1-1765285784077"
}
[2025-12-09T13:09:44.078Z] Found existing entry
{
  "key": "login:test-multi-1-1765285784077",
  "timestampCount": 5
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765285784077",
  "key": "login:test-multi-2-1765285784077"
}
[2025-12-09T13:09:44.078Z] Creating new entry
{
  "key": "login:test-multi-2-1765285784077"
}
[2025-12-09T13:09:44.078Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T13:09:44.078Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T13:09:44.079Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765285784079",
  "key": "login:test-reset-time-1765285784079"
}
[2025-12-09T13:09:44.079Z] Creating new entry
{
  "key": "login:test-reset-time-1765285784079"
}
[2025-12-09T13:09:44.079Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T13:09:44.079Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T13:09:44.079Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T13:09:44.080Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T13:09:44.080Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T13:09:44.080Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T13:09:44.080Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T13:09:44.080Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T13:09:44.080Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T13:09:44.080Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T13:09:44.080Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T13:09:44.080Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T13:09:44.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765285784080",
  "key": "test-sliding:test-sliding-1765285784080"
}
[2025-12-09T13:09:44.080Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765285784080"
}
[2025-12-09T13:09:44.080Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T13:09:44.080Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T13:09:44.182Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765285784080",
  "key": "test-sliding:test-sliding-1765285784080"
}
[2025-12-09T13:09:44.183Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765285784080",
  "timestampCount": 1
}
[2025-12-09T13:09:44.183Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T13:09:44.183Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T13:09:44.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765285784080",
  "key": "test-sliding:test-sliding-1765285784080"
}
[2025-12-09T13:09:44.283Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765285784080",
  "timestampCount": 2
}
[2025-12-09T13:09:44.284Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T13:09:44.284Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T13:09:44.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765285784284",
  "key": "register:test-format-allowed-1765285784284"
}
[2025-12-09T13:09:44.284Z] Creating new entry
{
  "key": "register:test-format-allowed-1765285784284"
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T13:09:44.284Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T13:09:44.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765285784284",
  "key": "register:test-format-blocked-1765285784284"
}
[2025-12-09T13:09:44.284Z] Creating new entry
{
  "key": "register:test-format-blocked-1765285784284"
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T13:09:44.284Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T13:09:44.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765285784284",
  "key": "register:test-format-blocked-1765285784284"
}
[2025-12-09T13:09:44.284Z] Found existing entry
{
  "key": "register:test-format-blocked-1765285784284",
  "timestampCount": 1
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T13:09:44.284Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T13:09:44.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765285784284",
  "key": "register:test-format-blocked-1765285784284"
}
[2025-12-09T13:09:44.284Z] Found existing entry
{
  "key": "register:test-format-blocked-1765285784284",
  "timestampCount": 2
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T13:09:44.284Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T13:09:44.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765285784284",
  "key": "register:test-format-blocked-1765285784284"
}
[2025-12-09T13:09:44.284Z] Found existing entry
{
  "key": "register:test-format-blocked-1765285784284",
  "timestampCount": 3
}
[2025-12-09T13:09:44.284Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T14:48:34.244Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765291714244",
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.245Z] Creating new entry
{
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.245Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T14:48:34.245Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T14:48:34.245Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765291714244",
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.245Z] Found existing entry
{
  "key": "login:test-allow-1765291714244",
  "timestampCount": 1
}
[2025-12-09T14:48:34.245Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T14:48:34.246Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T14:48:34.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765291714244",
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.246Z] Found existing entry
{
  "key": "login:test-allow-1765291714244",
  "timestampCount": 2
}
[2025-12-09T14:48:34.246Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T14:48:34.246Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T14:48:34.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765291714244",
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.246Z] Found existing entry
{
  "key": "login:test-allow-1765291714244",
  "timestampCount": 3
}
[2025-12-09T14:48:34.246Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T14:48:34.246Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T14:48:34.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765291714244",
  "key": "login:test-allow-1765291714244"
}
[2025-12-09T14:48:34.246Z] Found existing entry
{
  "key": "login:test-allow-1765291714244",
  "timestampCount": 4
}
[2025-12-09T14:48:34.246Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T14:48:34.246Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T14:48:34.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.246Z] Creating new entry
{
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.246Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T14:48:34.246Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T14:48:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.247Z] Found existing entry
{
  "key": "login:test-block-1765291714246",
  "timestampCount": 1
}
[2025-12-09T14:48:34.247Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T14:48:34.247Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T14:48:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.247Z] Found existing entry
{
  "key": "login:test-block-1765291714246",
  "timestampCount": 2
}
[2025-12-09T14:48:34.247Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T14:48:34.247Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T14:48:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.247Z] Found existing entry
{
  "key": "login:test-block-1765291714246",
  "timestampCount": 3
}
[2025-12-09T14:48:34.247Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T14:48:34.247Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T14:48:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.247Z] Found existing entry
{
  "key": "login:test-block-1765291714246",
  "timestampCount": 4
}
[2025-12-09T14:48:34.247Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T14:48:34.247Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T14:48:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765291714246",
  "key": "login:test-block-1765291714246"
}
[2025-12-09T14:48:34.247Z] Found existing entry
{
  "key": "login:test-block-1765291714246",
  "timestampCount": 5
}
[2025-12-09T14:48:34.247Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T14:48:34.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765291714248",
  "key": "test-reset:test-reset-1765291714248"
}
[2025-12-09T14:48:34.248Z] Creating new entry
{
  "key": "test-reset:test-reset-1765291714248"
}
[2025-12-09T14:48:34.248Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T14:48:34.248Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T14:48:34.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765291714248",
  "key": "test-reset:test-reset-1765291714248"
}
[2025-12-09T14:48:34.248Z] Found existing entry
{
  "key": "test-reset:test-reset-1765291714248",
  "timestampCount": 1
}
[2025-12-09T14:48:34.248Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T14:48:34.248Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T14:48:34.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765291714248",
  "key": "test-reset:test-reset-1765291714248"
}
[2025-12-09T14:48:34.248Z] Found existing entry
{
  "key": "test-reset:test-reset-1765291714248",
  "timestampCount": 2
}
[2025-12-09T14:48:34.248Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T14:48:34.400Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765291714248",
  "key": "test-reset:test-reset-1765291714248"
}
[2025-12-09T14:48:34.400Z] Found existing entry
{
  "key": "test-reset:test-reset-1765291714248",
  "timestampCount": 2
}
[2025-12-09T14:48:34.400Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T14:48:34.400Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T14:48:34.400Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T14:48:34.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Creating new entry
{
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T14:48:34.401Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T14:48:34.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Found existing entry
{
  "key": "login:test-multi-1-1765291714401",
  "timestampCount": 1
}
[2025-12-09T14:48:34.401Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T14:48:34.401Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T14:48:34.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Found existing entry
{
  "key": "login:test-multi-1-1765291714401",
  "timestampCount": 2
}
[2025-12-09T14:48:34.401Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T14:48:34.401Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T14:48:34.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Found existing entry
{
  "key": "login:test-multi-1-1765291714401",
  "timestampCount": 3
}
[2025-12-09T14:48:34.401Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T14:48:34.401Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T14:48:34.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.401Z] Found existing entry
{
  "key": "login:test-multi-1-1765291714401",
  "timestampCount": 4
}
[2025-12-09T14:48:34.402Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T14:48:34.402Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T14:48:34.402Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765291714401",
  "key": "login:test-multi-1-1765291714401"
}
[2025-12-09T14:48:34.402Z] Found existing entry
{
  "key": "login:test-multi-1-1765291714401",
  "timestampCount": 5
}
[2025-12-09T14:48:34.402Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T14:48:34.402Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765291714401",
  "key": "login:test-multi-2-1765291714401"
}
[2025-12-09T14:48:34.402Z] Creating new entry
{
  "key": "login:test-multi-2-1765291714401"
}
[2025-12-09T14:48:34.402Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T14:48:34.402Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T14:48:34.402Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765291714402",
  "key": "login:test-reset-time-1765291714402"
}
[2025-12-09T14:48:34.402Z] Creating new entry
{
  "key": "login:test-reset-time-1765291714402"
}
[2025-12-09T14:48:34.402Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T14:48:34.403Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T14:48:34.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T14:48:34.404Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T14:48:34.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T14:48:34.404Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T14:48:34.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T14:48:34.404Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T14:48:34.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T14:48:34.404Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T14:48:34.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T14:48:34.404Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T14:48:34.404Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765291714404",
  "key": "test-sliding:test-sliding-1765291714404"
}
[2025-12-09T14:48:34.404Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765291714404"
}
[2025-12-09T14:48:34.404Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T14:48:34.404Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T14:48:34.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765291714404",
  "key": "test-sliding:test-sliding-1765291714404"
}
[2025-12-09T14:48:34.505Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765291714404",
  "timestampCount": 1
}
[2025-12-09T14:48:34.505Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T14:48:34.505Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T14:48:34.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765291714404",
  "key": "test-sliding:test-sliding-1765291714404"
}
[2025-12-09T14:48:34.607Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765291714404",
  "timestampCount": 2
}
[2025-12-09T14:48:34.607Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T14:48:34.607Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T14:48:34.607Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T14:48:34.607Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765291714607",
  "key": "register:test-format-allowed-1765291714607"
}
[2025-12-09T14:48:34.607Z] Creating new entry
{
  "key": "register:test-format-allowed-1765291714607"
}
[2025-12-09T14:48:34.607Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T14:48:34.607Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T14:48:34.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765291714608",
  "key": "register:test-format-blocked-1765291714608"
}
[2025-12-09T14:48:34.608Z] Creating new entry
{
  "key": "register:test-format-blocked-1765291714608"
}
[2025-12-09T14:48:34.608Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T14:48:34.608Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T14:48:34.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765291714608",
  "key": "register:test-format-blocked-1765291714608"
}
[2025-12-09T14:48:34.608Z] Found existing entry
{
  "key": "register:test-format-blocked-1765291714608",
  "timestampCount": 1
}
[2025-12-09T14:48:34.608Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T14:48:34.608Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T14:48:34.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765291714608",
  "key": "register:test-format-blocked-1765291714608"
}
[2025-12-09T14:48:34.608Z] Found existing entry
{
  "key": "register:test-format-blocked-1765291714608",
  "timestampCount": 2
}
[2025-12-09T14:48:34.608Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T14:48:34.608Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T14:48:34.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765291714608",
  "key": "register:test-format-blocked-1765291714608"
}
[2025-12-09T14:48:34.608Z] Found existing entry
{
  "key": "register:test-format-blocked-1765291714608",
  "timestampCount": 3
}
[2025-12-09T14:48:34.608Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T16:10:02.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296602369",
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.370Z] Creating new entry
{
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.370Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:10:02.370Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:10:02.370Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296602369",
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.370Z] Found existing entry
{
  "key": "login:test-allow-1765296602369",
  "timestampCount": 1
}
[2025-12-09T16:10:02.370Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:10:02.370Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:10:02.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296602369",
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.371Z] Found existing entry
{
  "key": "login:test-allow-1765296602369",
  "timestampCount": 2
}
[2025-12-09T16:10:02.371Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:10:02.371Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:10:02.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296602369",
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.371Z] Found existing entry
{
  "key": "login:test-allow-1765296602369",
  "timestampCount": 3
}
[2025-12-09T16:10:02.371Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:10:02.371Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:10:02.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296602369",
  "key": "login:test-allow-1765296602369"
}
[2025-12-09T16:10:02.371Z] Found existing entry
{
  "key": "login:test-allow-1765296602369",
  "timestampCount": 4
}
[2025-12-09T16:10:02.371Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:10:02.371Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:10:02.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.371Z] Creating new entry
{
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.371Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:10:02.371Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:10:02.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.371Z] Found existing entry
{
  "key": "login:test-block-1765296602371",
  "timestampCount": 1
}
[2025-12-09T16:10:02.372Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:10:02.372Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:10:02.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.372Z] Found existing entry
{
  "key": "login:test-block-1765296602371",
  "timestampCount": 2
}
[2025-12-09T16:10:02.372Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:10:02.372Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:10:02.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.372Z] Found existing entry
{
  "key": "login:test-block-1765296602371",
  "timestampCount": 3
}
[2025-12-09T16:10:02.372Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:10:02.372Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:10:02.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.372Z] Found existing entry
{
  "key": "login:test-block-1765296602371",
  "timestampCount": 4
}
[2025-12-09T16:10:02.372Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:10:02.372Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:10:02.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296602371",
  "key": "login:test-block-1765296602371"
}
[2025-12-09T16:10:02.372Z] Found existing entry
{
  "key": "login:test-block-1765296602371",
  "timestampCount": 5
}
[2025-12-09T16:10:02.372Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:10:02.373Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296602373",
  "key": "test-reset:test-reset-1765296602373"
}
[2025-12-09T16:10:02.373Z] Creating new entry
{
  "key": "test-reset:test-reset-1765296602373"
}
[2025-12-09T16:10:02.373Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:10:02.373Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:10:02.373Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296602373",
  "key": "test-reset:test-reset-1765296602373"
}
[2025-12-09T16:10:02.373Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296602373",
  "timestampCount": 1
}
[2025-12-09T16:10:02.373Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T16:10:02.373Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T16:10:02.373Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296602373",
  "key": "test-reset:test-reset-1765296602373"
}
[2025-12-09T16:10:02.373Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296602373",
  "timestampCount": 2
}
[2025-12-09T16:10:02.373Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T16:10:02.523Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296602373",
  "key": "test-reset:test-reset-1765296602373"
}
[2025-12-09T16:10:02.523Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296602373",
  "timestampCount": 2
}
[2025-12-09T16:10:02.523Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T16:10:02.523Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:10:02.523Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:10:02.523Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.523Z] Creating new entry
{
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.523Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.524Z] Found existing entry
{
  "key": "login:test-multi-1-1765296602523",
  "timestampCount": 1
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.524Z] Found existing entry
{
  "key": "login:test-multi-1-1765296602523",
  "timestampCount": 2
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.524Z] Found existing entry
{
  "key": "login:test-multi-1-1765296602523",
  "timestampCount": 3
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.524Z] Found existing entry
{
  "key": "login:test-multi-1-1765296602523",
  "timestampCount": 4
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296602523",
  "key": "login:test-multi-1-1765296602523"
}
[2025-12-09T16:10:02.524Z] Found existing entry
{
  "key": "login:test-multi-1-1765296602523",
  "timestampCount": 5
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765296602523",
  "key": "login:test-multi-2-1765296602523"
}
[2025-12-09T16:10:02.524Z] Creating new entry
{
  "key": "login:test-multi-2-1765296602523"
}
[2025-12-09T16:10:02.524Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:10:02.524Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:10:02.525Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765296602525",
  "key": "login:test-reset-time-1765296602525"
}
[2025-12-09T16:10:02.525Z] Creating new entry
{
  "key": "login:test-reset-time-1765296602525"
}
[2025-12-09T16:10:02.525Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:10:02.525Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:10:02.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:10:02.526Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:10:02.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:10:02.526Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T16:10:02.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:10:02.526Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:10:02.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:10:02.526Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T16:10:02.527Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:10:02.527Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:10:02.527Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296602527",
  "key": "test-sliding:test-sliding-1765296602527"
}
[2025-12-09T16:10:02.527Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765296602527"
}
[2025-12-09T16:10:02.527Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:10:02.527Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:10:02.628Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296602527",
  "key": "test-sliding:test-sliding-1765296602527"
}
[2025-12-09T16:10:02.628Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296602527",
  "timestampCount": 1
}
[2025-12-09T16:10:02.628Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:10:02.628Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:10:02.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296602527",
  "key": "test-sliding:test-sliding-1765296602527"
}
[2025-12-09T16:10:02.730Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296602527",
  "timestampCount": 2
}
[2025-12-09T16:10:02.730Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T16:10:02.730Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:10:02.730Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:10:02.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765296602731",
  "key": "register:test-format-allowed-1765296602731"
}
[2025-12-09T16:10:02.731Z] Creating new entry
{
  "key": "register:test-format-allowed-1765296602731"
}
[2025-12-09T16:10:02.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:10:02.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:10:02.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296602731",
  "key": "register:test-format-blocked-1765296602731"
}
[2025-12-09T16:10:02.731Z] Creating new entry
{
  "key": "register:test-format-blocked-1765296602731"
}
[2025-12-09T16:10:02.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:10:02.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:10:02.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296602731",
  "key": "register:test-format-blocked-1765296602731"
}
[2025-12-09T16:10:02.731Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296602731",
  "timestampCount": 1
}
[2025-12-09T16:10:02.731Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:10:02.731Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:10:02.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296602731",
  "key": "register:test-format-blocked-1765296602731"
}
[2025-12-09T16:10:02.731Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296602731",
  "timestampCount": 2
}
[2025-12-09T16:10:02.731Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T16:10:02.731Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T16:10:02.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296602731",
  "key": "register:test-format-blocked-1765296602731"
}
[2025-12-09T16:10:02.732Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296602731",
  "timestampCount": 3
}
[2025-12-09T16:10:02.732Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T16:11:57.565Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296717565",
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Creating new entry
{
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:11:57.566Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:11:57.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296717565",
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Found existing entry
{
  "key": "login:test-allow-1765296717565",
  "timestampCount": 1
}
[2025-12-09T16:11:57.566Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:11:57.566Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:11:57.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296717565",
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Found existing entry
{
  "key": "login:test-allow-1765296717565",
  "timestampCount": 2
}
[2025-12-09T16:11:57.566Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:11:57.566Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:11:57.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296717565",
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Found existing entry
{
  "key": "login:test-allow-1765296717565",
  "timestampCount": 3
}
[2025-12-09T16:11:57.566Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:11:57.566Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:11:57.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296717565",
  "key": "login:test-allow-1765296717565"
}
[2025-12-09T16:11:57.566Z] Found existing entry
{
  "key": "login:test-allow-1765296717565",
  "timestampCount": 4
}
[2025-12-09T16:11:57.566Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:11:57.566Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Creating new entry
{
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:11:57.567Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Found existing entry
{
  "key": "login:test-block-1765296717567",
  "timestampCount": 1
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:11:57.567Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Found existing entry
{
  "key": "login:test-block-1765296717567",
  "timestampCount": 2
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:11:57.567Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Found existing entry
{
  "key": "login:test-block-1765296717567",
  "timestampCount": 3
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:11:57.567Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Found existing entry
{
  "key": "login:test-block-1765296717567",
  "timestampCount": 4
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:11:57.567Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:11:57.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296717567",
  "key": "login:test-block-1765296717567"
}
[2025-12-09T16:11:57.567Z] Found existing entry
{
  "key": "login:test-block-1765296717567",
  "timestampCount": 5
}
[2025-12-09T16:11:57.567Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:11:57.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296717568",
  "key": "test-reset:test-reset-1765296717568"
}
[2025-12-09T16:11:57.568Z] Creating new entry
{
  "key": "test-reset:test-reset-1765296717568"
}
[2025-12-09T16:11:57.568Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:11:57.568Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:11:57.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296717568",
  "key": "test-reset:test-reset-1765296717568"
}
[2025-12-09T16:11:57.568Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296717568",
  "timestampCount": 1
}
[2025-12-09T16:11:57.568Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T16:11:57.568Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T16:11:57.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296717568",
  "key": "test-reset:test-reset-1765296717568"
}
[2025-12-09T16:11:57.568Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296717568",
  "timestampCount": 2
}
[2025-12-09T16:11:57.568Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T16:11:57.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296717568",
  "key": "test-reset:test-reset-1765296717568"
}
[2025-12-09T16:11:57.719Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296717568",
  "timestampCount": 2
}
[2025-12-09T16:11:57.719Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T16:11:57.719Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:11:57.719Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:11:57.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.719Z] Creating new entry
{
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.719Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:11:57.719Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:11:57.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.719Z] Found existing entry
{
  "key": "login:test-multi-1-1765296717719",
  "timestampCount": 1
}
[2025-12-09T16:11:57.719Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:11:57.719Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:11:57.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.719Z] Found existing entry
{
  "key": "login:test-multi-1-1765296717719",
  "timestampCount": 2
}
[2025-12-09T16:11:57.719Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:11:57.719Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:11:57.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.719Z] Found existing entry
{
  "key": "login:test-multi-1-1765296717719",
  "timestampCount": 3
}
[2025-12-09T16:11:57.719Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:11:57.719Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:11:57.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.720Z] Found existing entry
{
  "key": "login:test-multi-1-1765296717719",
  "timestampCount": 4
}
[2025-12-09T16:11:57.720Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:11:57.720Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:11:57.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296717719",
  "key": "login:test-multi-1-1765296717719"
}
[2025-12-09T16:11:57.720Z] Found existing entry
{
  "key": "login:test-multi-1-1765296717719",
  "timestampCount": 5
}
[2025-12-09T16:11:57.720Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:11:57.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765296717719",
  "key": "login:test-multi-2-1765296717719"
}
[2025-12-09T16:11:57.720Z] Creating new entry
{
  "key": "login:test-multi-2-1765296717719"
}
[2025-12-09T16:11:57.720Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:11:57.720Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:11:57.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765296717720",
  "key": "login:test-reset-time-1765296717720"
}
[2025-12-09T16:11:57.720Z] Creating new entry
{
  "key": "login:test-reset-time-1765296717720"
}
[2025-12-09T16:11:57.720Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:11:57.720Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:11:57.721Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:11:57.721Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:11:57.721Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:11:57.721Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T16:11:57.722Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:11:57.722Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:11:57.722Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:11:57.722Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T16:11:57.722Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:11:57.722Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:11:57.722Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296717722",
  "key": "test-sliding:test-sliding-1765296717722"
}
[2025-12-09T16:11:57.722Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765296717722"
}
[2025-12-09T16:11:57.722Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:11:57.722Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:11:57.823Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296717722",
  "key": "test-sliding:test-sliding-1765296717722"
}
[2025-12-09T16:11:57.823Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296717722",
  "timestampCount": 1
}
[2025-12-09T16:11:57.823Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:11:57.823Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:11:57.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296717722",
  "key": "test-sliding:test-sliding-1765296717722"
}
[2025-12-09T16:11:57.925Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296717722",
  "timestampCount": 2
}
[2025-12-09T16:11:57.925Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T16:11:57.925Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:11:57.925Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:11:57.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765296717926",
  "key": "register:test-format-allowed-1765296717926"
}
[2025-12-09T16:11:57.926Z] Creating new entry
{
  "key": "register:test-format-allowed-1765296717926"
}
[2025-12-09T16:11:57.926Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:11:57.926Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:11:57.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296717926",
  "key": "register:test-format-blocked-1765296717926"
}
[2025-12-09T16:11:57.926Z] Creating new entry
{
  "key": "register:test-format-blocked-1765296717926"
}
[2025-12-09T16:11:57.926Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:11:57.926Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:11:57.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296717926",
  "key": "register:test-format-blocked-1765296717926"
}
[2025-12-09T16:11:57.926Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296717926",
  "timestampCount": 1
}
[2025-12-09T16:11:57.926Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:11:57.926Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:11:57.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296717926",
  "key": "register:test-format-blocked-1765296717926"
}
[2025-12-09T16:11:57.926Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296717926",
  "timestampCount": 2
}
[2025-12-09T16:11:57.926Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T16:11:57.926Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T16:11:57.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296717926",
  "key": "register:test-format-blocked-1765296717926"
}
[2025-12-09T16:11:57.926Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296717926",
  "timestampCount": 3
}
[2025-12-09T16:11:57.926Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T16:13:24.945Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296804944",
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.945Z] Creating new entry
{
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.945Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:13:24.945Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:13:24.945Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296804944",
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.946Z] Found existing entry
{
  "key": "login:test-allow-1765296804944",
  "timestampCount": 1
}
[2025-12-09T16:13:24.946Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:13:24.946Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:13:24.946Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296804944",
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.946Z] Found existing entry
{
  "key": "login:test-allow-1765296804944",
  "timestampCount": 2
}
[2025-12-09T16:13:24.946Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:13:24.946Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:13:24.946Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296804944",
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.946Z] Found existing entry
{
  "key": "login:test-allow-1765296804944",
  "timestampCount": 3
}
[2025-12-09T16:13:24.946Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:13:24.946Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:13:24.946Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765296804944",
  "key": "login:test-allow-1765296804944"
}
[2025-12-09T16:13:24.946Z] Found existing entry
{
  "key": "login:test-allow-1765296804944",
  "timestampCount": 4
}
[2025-12-09T16:13:24.946Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:13:24.946Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:13:24.946Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.946Z] Creating new entry
{
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.946Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:13:24.947Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:13:24.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.947Z] Found existing entry
{
  "key": "login:test-block-1765296804946",
  "timestampCount": 1
}
[2025-12-09T16:13:24.947Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:13:24.947Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:13:24.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.947Z] Found existing entry
{
  "key": "login:test-block-1765296804946",
  "timestampCount": 2
}
[2025-12-09T16:13:24.947Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:13:24.947Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:13:24.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.947Z] Found existing entry
{
  "key": "login:test-block-1765296804946",
  "timestampCount": 3
}
[2025-12-09T16:13:24.947Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:13:24.947Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:13:24.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.947Z] Found existing entry
{
  "key": "login:test-block-1765296804946",
  "timestampCount": 4
}
[2025-12-09T16:13:24.947Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:13:24.947Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:13:24.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765296804946",
  "key": "login:test-block-1765296804946"
}
[2025-12-09T16:13:24.947Z] Found existing entry
{
  "key": "login:test-block-1765296804946",
  "timestampCount": 5
}
[2025-12-09T16:13:24.947Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:13:24.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296804948",
  "key": "test-reset:test-reset-1765296804948"
}
[2025-12-09T16:13:24.950Z] Creating new entry
{
  "key": "test-reset:test-reset-1765296804948"
}
[2025-12-09T16:13:24.950Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:13:24.950Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:13:24.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296804948",
  "key": "test-reset:test-reset-1765296804948"
}
[2025-12-09T16:13:24.950Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296804948",
  "timestampCount": 1
}
[2025-12-09T16:13:24.950Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T16:13:24.950Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T16:13:24.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296804948",
  "key": "test-reset:test-reset-1765296804948"
}
[2025-12-09T16:13:24.950Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296804948",
  "timestampCount": 2
}
[2025-12-09T16:13:24.950Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T16:13:25.101Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765296804948",
  "key": "test-reset:test-reset-1765296804948"
}
[2025-12-09T16:13:25.101Z] Found existing entry
{
  "key": "test-reset:test-reset-1765296804948",
  "timestampCount": 2
}
[2025-12-09T16:13:25.101Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T16:13:25.101Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:13:25.101Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:13:25.101Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.101Z] Creating new entry
{
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.101Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:13:25.101Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:13:25.101Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.101Z] Found existing entry
{
  "key": "login:test-multi-1-1765296805101",
  "timestampCount": 1
}
[2025-12-09T16:13:25.101Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:13:25.101Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:13:25.101Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.101Z] Found existing entry
{
  "key": "login:test-multi-1-1765296805101",
  "timestampCount": 2
}
[2025-12-09T16:13:25.101Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:13:25.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.102Z] Found existing entry
{
  "key": "login:test-multi-1-1765296805101",
  "timestampCount": 3
}
[2025-12-09T16:13:25.102Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:13:25.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.102Z] Found existing entry
{
  "key": "login:test-multi-1-1765296805101",
  "timestampCount": 4
}
[2025-12-09T16:13:25.102Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:13:25.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765296805101",
  "key": "login:test-multi-1-1765296805101"
}
[2025-12-09T16:13:25.102Z] Found existing entry
{
  "key": "login:test-multi-1-1765296805101",
  "timestampCount": 5
}
[2025-12-09T16:13:25.102Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765296805101",
  "key": "login:test-multi-2-1765296805101"
}
[2025-12-09T16:13:25.102Z] Creating new entry
{
  "key": "login:test-multi-2-1765296805101"
}
[2025-12-09T16:13:25.102Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:13:25.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765296805102",
  "key": "login:test-reset-time-1765296805102"
}
[2025-12-09T16:13:25.102Z] Creating new entry
{
  "key": "login:test-reset-time-1765296805102"
}
[2025-12-09T16:13:25.102Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:13:25.102Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:13:25.103Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:13:25.104Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:13:25.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:13:25.104Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T16:13:25.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:13:25.104Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:13:25.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:13:25.104Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T16:13:25.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:13:25.104Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:13:25.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296805104",
  "key": "test-sliding:test-sliding-1765296805104"
}
[2025-12-09T16:13:25.104Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765296805104"
}
[2025-12-09T16:13:25.104Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:13:25.104Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:13:25.204Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296805104",
  "key": "test-sliding:test-sliding-1765296805104"
}
[2025-12-09T16:13:25.204Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296805104",
  "timestampCount": 1
}
[2025-12-09T16:13:25.204Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:13:25.204Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:13:25.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765296805104",
  "key": "test-sliding:test-sliding-1765296805104"
}
[2025-12-09T16:13:25.306Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765296805104",
  "timestampCount": 2
}
[2025-12-09T16:13:25.306Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T16:13:25.306Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:13:25.306Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:13:25.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765296805306",
  "key": "register:test-format-allowed-1765296805306"
}
[2025-12-09T16:13:25.306Z] Creating new entry
{
  "key": "register:test-format-allowed-1765296805306"
}
[2025-12-09T16:13:25.306Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:13:25.306Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:13:25.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296805306",
  "key": "register:test-format-blocked-1765296805306"
}
[2025-12-09T16:13:25.306Z] Creating new entry
{
  "key": "register:test-format-blocked-1765296805306"
}
[2025-12-09T16:13:25.306Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:13:25.306Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:13:25.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296805306",
  "key": "register:test-format-blocked-1765296805306"
}
[2025-12-09T16:13:25.306Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296805306",
  "timestampCount": 1
}
[2025-12-09T16:13:25.306Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:13:25.307Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:13:25.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296805306",
  "key": "register:test-format-blocked-1765296805306"
}
[2025-12-09T16:13:25.307Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296805306",
  "timestampCount": 2
}
[2025-12-09T16:13:25.307Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T16:13:25.307Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T16:13:25.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765296805306",
  "key": "register:test-format-blocked-1765296805306"
}
[2025-12-09T16:13:25.307Z] Found existing entry
{
  "key": "register:test-format-blocked-1765296805306",
  "timestampCount": 3
}
[2025-12-09T16:13:25.307Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T16:31:13.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765297873281",
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.282Z] Creating new entry
{
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.282Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:31:13.282Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:31:13.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765297873281",
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.283Z] Found existing entry
{
  "key": "login:test-allow-1765297873281",
  "timestampCount": 1
}
[2025-12-09T16:31:13.283Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:31:13.283Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:31:13.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765297873281",
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.283Z] Found existing entry
{
  "key": "login:test-allow-1765297873281",
  "timestampCount": 2
}
[2025-12-09T16:31:13.283Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:31:13.283Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:31:13.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765297873281",
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.284Z] Found existing entry
{
  "key": "login:test-allow-1765297873281",
  "timestampCount": 3
}
[2025-12-09T16:31:13.284Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:31:13.284Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:31:13.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765297873281",
  "key": "login:test-allow-1765297873281"
}
[2025-12-09T16:31:13.284Z] Found existing entry
{
  "key": "login:test-allow-1765297873281",
  "timestampCount": 4
}
[2025-12-09T16:31:13.284Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:31:13.284Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:31:13.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.284Z] Creating new entry
{
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.285Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:31:13.286Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:31:13.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.286Z] Found existing entry
{
  "key": "login:test-block-1765297873284",
  "timestampCount": 1
}
[2025-12-09T16:31:13.286Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:31:13.286Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:31:13.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.286Z] Found existing entry
{
  "key": "login:test-block-1765297873284",
  "timestampCount": 2
}
[2025-12-09T16:31:13.286Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:31:13.286Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:31:13.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.286Z] Found existing entry
{
  "key": "login:test-block-1765297873284",
  "timestampCount": 3
}
[2025-12-09T16:31:13.286Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:31:13.286Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:31:13.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.286Z] Found existing entry
{
  "key": "login:test-block-1765297873284",
  "timestampCount": 4
}
[2025-12-09T16:31:13.286Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:31:13.286Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:31:13.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765297873284",
  "key": "login:test-block-1765297873284"
}
[2025-12-09T16:31:13.287Z] Found existing entry
{
  "key": "login:test-block-1765297873284",
  "timestampCount": 5
}
[2025-12-09T16:31:13.287Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:31:13.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765297873288",
  "key": "test-reset:test-reset-1765297873288"
}
[2025-12-09T16:31:13.288Z] Creating new entry
{
  "key": "test-reset:test-reset-1765297873288"
}
[2025-12-09T16:31:13.288Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:31:13.288Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:31:13.289Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765297873288",
  "key": "test-reset:test-reset-1765297873288"
}
[2025-12-09T16:31:13.289Z] Found existing entry
{
  "key": "test-reset:test-reset-1765297873288",
  "timestampCount": 1
}
[2025-12-09T16:31:13.289Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T16:31:13.289Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T16:31:13.289Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765297873288",
  "key": "test-reset:test-reset-1765297873288"
}
[2025-12-09T16:31:13.289Z] Found existing entry
{
  "key": "test-reset:test-reset-1765297873288",
  "timestampCount": 2
}
[2025-12-09T16:31:13.289Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T16:31:13.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765297873288",
  "key": "test-reset:test-reset-1765297873288"
}
[2025-12-09T16:31:13.440Z] Found existing entry
{
  "key": "test-reset:test-reset-1765297873288",
  "timestampCount": 2
}
[2025-12-09T16:31:13.440Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T16:31:13.440Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T16:31:13.440Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T16:31:13.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.440Z] Creating new entry
{
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.440Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:31:13.440Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:31:13.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.440Z] Found existing entry
{
  "key": "login:test-multi-1-1765297873440",
  "timestampCount": 1
}
[2025-12-09T16:31:13.440Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T16:31:13.440Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T16:31:13.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.440Z] Found existing entry
{
  "key": "login:test-multi-1-1765297873440",
  "timestampCount": 2
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T16:31:13.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.441Z] Found existing entry
{
  "key": "login:test-multi-1-1765297873440",
  "timestampCount": 3
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T16:31:13.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.441Z] Found existing entry
{
  "key": "login:test-multi-1-1765297873440",
  "timestampCount": 4
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T16:31:13.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765297873440",
  "key": "login:test-multi-1-1765297873440"
}
[2025-12-09T16:31:13.441Z] Found existing entry
{
  "key": "login:test-multi-1-1765297873440",
  "timestampCount": 5
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765297873440",
  "key": "login:test-multi-2-1765297873440"
}
[2025-12-09T16:31:13.441Z] Creating new entry
{
  "key": "login:test-multi-2-1765297873440"
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:31:13.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765297873441",
  "key": "login:test-reset-time-1765297873441"
}
[2025-12-09T16:31:13.441Z] Creating new entry
{
  "key": "login:test-reset-time-1765297873441"
}
[2025-12-09T16:31:13.441Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T16:31:13.441Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T16:31:13.442Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:31:13.442Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:31:13.443Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:31:13.443Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T16:31:13.443Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:31:13.443Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:31:13.443Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:31:13.443Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T16:31:13.444Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T16:31:13.444Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T16:31:13.444Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765297873444",
  "key": "test-sliding:test-sliding-1765297873444"
}
[2025-12-09T16:31:13.444Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765297873444"
}
[2025-12-09T16:31:13.444Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:31:13.444Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:31:13.544Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765297873444",
  "key": "test-sliding:test-sliding-1765297873444"
}
[2025-12-09T16:31:13.544Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765297873444",
  "timestampCount": 1
}
[2025-12-09T16:31:13.544Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:31:13.544Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:31:13.645Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765297873444",
  "key": "test-sliding:test-sliding-1765297873444"
}
[2025-12-09T16:31:13.645Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765297873444",
  "timestampCount": 2
}
[2025-12-09T16:31:13.645Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T16:31:13.645Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:31:13.645Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:31:13.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765297873646",
  "key": "register:test-format-allowed-1765297873646"
}
[2025-12-09T16:31:13.646Z] Creating new entry
{
  "key": "register:test-format-allowed-1765297873646"
}
[2025-12-09T16:31:13.646Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:31:13.646Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:31:13.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765297873646",
  "key": "register:test-format-blocked-1765297873646"
}
[2025-12-09T16:31:13.646Z] Creating new entry
{
  "key": "register:test-format-blocked-1765297873646"
}
[2025-12-09T16:31:13.646Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T16:31:13.646Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T16:31:13.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765297873646",
  "key": "register:test-format-blocked-1765297873646"
}
[2025-12-09T16:31:13.646Z] Found existing entry
{
  "key": "register:test-format-blocked-1765297873646",
  "timestampCount": 1
}
[2025-12-09T16:31:13.646Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T16:31:13.646Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T16:31:13.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765297873646",
  "key": "register:test-format-blocked-1765297873646"
}
[2025-12-09T16:31:13.646Z] Found existing entry
{
  "key": "register:test-format-blocked-1765297873646",
  "timestampCount": 2
}
[2025-12-09T16:31:13.646Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T16:31:13.646Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T16:31:13.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765297873646",
  "key": "register:test-format-blocked-1765297873646"
}
[2025-12-09T16:31:13.646Z] Found existing entry
{
  "key": "register:test-format-blocked-1765297873646",
  "timestampCount": 3
}
[2025-12-09T16:31:13.646Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:29:30.969Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315770968",
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.969Z] Creating new entry
{
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.969Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:29:30.969Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:29:30.969Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315770968",
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.970Z] Found existing entry
{
  "key": "login:test-allow-1765315770968",
  "timestampCount": 1
}
[2025-12-09T21:29:30.970Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:29:30.970Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:29:30.970Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315770968",
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.970Z] Found existing entry
{
  "key": "login:test-allow-1765315770968",
  "timestampCount": 2
}
[2025-12-09T21:29:30.970Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:29:30.970Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:29:30.970Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315770968",
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.970Z] Found existing entry
{
  "key": "login:test-allow-1765315770968",
  "timestampCount": 3
}
[2025-12-09T21:29:30.970Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:29:30.970Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:29:30.970Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315770968",
  "key": "login:test-allow-1765315770968"
}
[2025-12-09T21:29:30.970Z] Found existing entry
{
  "key": "login:test-allow-1765315770968",
  "timestampCount": 4
}
[2025-12-09T21:29:30.970Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:29:30.970Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:29:30.970Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Creating new entry
{
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:29:30.971Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:29:30.971Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Found existing entry
{
  "key": "login:test-block-1765315770970",
  "timestampCount": 1
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:29:30.971Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:29:30.971Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Found existing entry
{
  "key": "login:test-block-1765315770970",
  "timestampCount": 2
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:29:30.971Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:29:30.971Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Found existing entry
{
  "key": "login:test-block-1765315770970",
  "timestampCount": 3
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:29:30.971Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:29:30.971Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Found existing entry
{
  "key": "login:test-block-1765315770970",
  "timestampCount": 4
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:29:30.971Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:29:30.971Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315770970",
  "key": "login:test-block-1765315770970"
}
[2025-12-09T21:29:30.971Z] Found existing entry
{
  "key": "login:test-block-1765315770970",
  "timestampCount": 5
}
[2025-12-09T21:29:30.971Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:29:30.972Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315770972",
  "key": "test-reset:test-reset-1765315770972"
}
[2025-12-09T21:29:30.972Z] Creating new entry
{
  "key": "test-reset:test-reset-1765315770972"
}
[2025-12-09T21:29:30.972Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:29:30.972Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:29:30.972Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315770972",
  "key": "test-reset:test-reset-1765315770972"
}
[2025-12-09T21:29:30.972Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315770972",
  "timestampCount": 1
}
[2025-12-09T21:29:30.972Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:29:30.972Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:29:30.972Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315770972",
  "key": "test-reset:test-reset-1765315770972"
}
[2025-12-09T21:29:30.972Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315770972",
  "timestampCount": 2
}
[2025-12-09T21:29:30.972Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:29:31.123Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315770972",
  "key": "test-reset:test-reset-1765315770972"
}
[2025-12-09T21:29:31.124Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315770972",
  "timestampCount": 2
}
[2025-12-09T21:29:31.124Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:29:31.124Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:29:31.125Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Creating new entry
{
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:29:31.125Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Found existing entry
{
  "key": "login:test-multi-1-1765315771125",
  "timestampCount": 1
}
[2025-12-09T21:29:31.125Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:29:31.125Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Found existing entry
{
  "key": "login:test-multi-1-1765315771125",
  "timestampCount": 2
}
[2025-12-09T21:29:31.125Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:29:31.125Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Found existing entry
{
  "key": "login:test-multi-1-1765315771125",
  "timestampCount": 3
}
[2025-12-09T21:29:31.125Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:29:31.125Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.125Z] Found existing entry
{
  "key": "login:test-multi-1-1765315771125",
  "timestampCount": 4
}
[2025-12-09T21:29:31.125Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:29:31.125Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:29:31.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315771125",
  "key": "login:test-multi-1-1765315771125"
}
[2025-12-09T21:29:31.126Z] Found existing entry
{
  "key": "login:test-multi-1-1765315771125",
  "timestampCount": 5
}
[2025-12-09T21:29:31.126Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:29:31.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765315771125",
  "key": "login:test-multi-2-1765315771125"
}
[2025-12-09T21:29:31.126Z] Creating new entry
{
  "key": "login:test-multi-2-1765315771125"
}
[2025-12-09T21:29:31.126Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:29:31.126Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:29:31.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765315771126",
  "key": "login:test-reset-time-1765315771126"
}
[2025-12-09T21:29:31.126Z] Creating new entry
{
  "key": "login:test-reset-time-1765315771126"
}
[2025-12-09T21:29:31.126Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:29:31.126Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:29:31.127Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:29:31.127Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:29:31.127Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:29:31.127Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:29:31.127Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:29:31.127Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:29:31.128Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:29:31.128Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:29:31.128Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:29:31.128Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:29:31.128Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315771128",
  "key": "test-sliding:test-sliding-1765315771128"
}
[2025-12-09T21:29:31.128Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765315771128"
}
[2025-12-09T21:29:31.128Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:29:31.128Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:29:31.228Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315771128",
  "key": "test-sliding:test-sliding-1765315771128"
}
[2025-12-09T21:29:31.228Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315771128",
  "timestampCount": 1
}
[2025-12-09T21:29:31.228Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:29:31.228Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:29:31.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315771128",
  "key": "test-sliding:test-sliding-1765315771128"
}
[2025-12-09T21:29:31.333Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315771128",
  "timestampCount": 2
}
[2025-12-09T21:29:31.333Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:29:31.333Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:29:31.333Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:29:31.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765315771333",
  "key": "register:test-format-allowed-1765315771333"
}
[2025-12-09T21:29:31.334Z] Creating new entry
{
  "key": "register:test-format-allowed-1765315771333"
}
[2025-12-09T21:29:31.334Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:29:31.334Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:29:31.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315771334",
  "key": "register:test-format-blocked-1765315771334"
}
[2025-12-09T21:29:31.334Z] Creating new entry
{
  "key": "register:test-format-blocked-1765315771334"
}
[2025-12-09T21:29:31.334Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:29:31.334Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:29:31.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315771334",
  "key": "register:test-format-blocked-1765315771334"
}
[2025-12-09T21:29:31.334Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315771334",
  "timestampCount": 1
}
[2025-12-09T21:29:31.334Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:29:31.334Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:29:31.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315771334",
  "key": "register:test-format-blocked-1765315771334"
}
[2025-12-09T21:29:31.334Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315771334",
  "timestampCount": 2
}
[2025-12-09T21:29:31.334Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:29:31.335Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:29:31.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315771334",
  "key": "register:test-format-blocked-1765315771334"
}
[2025-12-09T21:29:31.335Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315771334",
  "timestampCount": 3
}
[2025-12-09T21:29:31.335Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:31:11.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315871490",
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Creating new entry
{
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:31:11.491Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:31:11.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315871490",
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Found existing entry
{
  "key": "login:test-allow-1765315871490",
  "timestampCount": 1
}
[2025-12-09T21:31:11.491Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:31:11.491Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:31:11.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315871490",
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Found existing entry
{
  "key": "login:test-allow-1765315871490",
  "timestampCount": 2
}
[2025-12-09T21:31:11.491Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:31:11.491Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:31:11.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315871490",
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Found existing entry
{
  "key": "login:test-allow-1765315871490",
  "timestampCount": 3
}
[2025-12-09T21:31:11.491Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:31:11.491Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:31:11.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315871490",
  "key": "login:test-allow-1765315871490"
}
[2025-12-09T21:31:11.491Z] Found existing entry
{
  "key": "login:test-allow-1765315871490",
  "timestampCount": 4
}
[2025-12-09T21:31:11.491Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:31:11.491Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Creating new entry
{
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:31:11.492Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Found existing entry
{
  "key": "login:test-block-1765315871492",
  "timestampCount": 1
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:31:11.492Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Found existing entry
{
  "key": "login:test-block-1765315871492",
  "timestampCount": 2
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:31:11.492Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Found existing entry
{
  "key": "login:test-block-1765315871492",
  "timestampCount": 3
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:31:11.492Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Found existing entry
{
  "key": "login:test-block-1765315871492",
  "timestampCount": 4
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:31:11.492Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:31:11.492Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315871492",
  "key": "login:test-block-1765315871492"
}
[2025-12-09T21:31:11.492Z] Found existing entry
{
  "key": "login:test-block-1765315871492",
  "timestampCount": 5
}
[2025-12-09T21:31:11.492Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:31:11.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315871493",
  "key": "test-reset:test-reset-1765315871493"
}
[2025-12-09T21:31:11.493Z] Creating new entry
{
  "key": "test-reset:test-reset-1765315871493"
}
[2025-12-09T21:31:11.493Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:31:11.493Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:31:11.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315871493",
  "key": "test-reset:test-reset-1765315871493"
}
[2025-12-09T21:31:11.493Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315871493",
  "timestampCount": 1
}
[2025-12-09T21:31:11.493Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:31:11.493Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:31:11.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315871493",
  "key": "test-reset:test-reset-1765315871493"
}
[2025-12-09T21:31:11.493Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315871493",
  "timestampCount": 2
}
[2025-12-09T21:31:11.493Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:31:11.645Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315871493",
  "key": "test-reset:test-reset-1765315871493"
}
[2025-12-09T21:31:11.645Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315871493",
  "timestampCount": 2
}
[2025-12-09T21:31:11.645Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:31:11.645Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:31:11.645Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:31:11.645Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Creating new entry
{
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Found existing entry
{
  "key": "login:test-multi-1-1765315871645",
  "timestampCount": 1
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Found existing entry
{
  "key": "login:test-multi-1-1765315871645",
  "timestampCount": 2
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Found existing entry
{
  "key": "login:test-multi-1-1765315871645",
  "timestampCount": 3
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Found existing entry
{
  "key": "login:test-multi-1-1765315871645",
  "timestampCount": 4
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315871645",
  "key": "login:test-multi-1-1765315871645"
}
[2025-12-09T21:31:11.646Z] Found existing entry
{
  "key": "login:test-multi-1-1765315871645",
  "timestampCount": 5
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765315871645",
  "key": "login:test-multi-2-1765315871645"
}
[2025-12-09T21:31:11.646Z] Creating new entry
{
  "key": "login:test-multi-2-1765315871645"
}
[2025-12-09T21:31:11.646Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:31:11.646Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:31:11.647Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765315871647",
  "key": "login:test-reset-time-1765315871647"
}
[2025-12-09T21:31:11.647Z] Creating new entry
{
  "key": "login:test-reset-time-1765315871647"
}
[2025-12-09T21:31:11.647Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:31:11.647Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:31:11.648Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:31:11.648Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:31:11.648Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:31:11.648Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:31:11.648Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:31:11.648Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:31:11.648Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:31:11.648Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:31:11.648Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:31:11.649Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:31:11.649Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315871649",
  "key": "test-sliding:test-sliding-1765315871649"
}
[2025-12-09T21:31:11.649Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765315871649"
}
[2025-12-09T21:31:11.649Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:31:11.649Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:31:11.749Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315871649",
  "key": "test-sliding:test-sliding-1765315871649"
}
[2025-12-09T21:31:11.749Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315871649",
  "timestampCount": 1
}
[2025-12-09T21:31:11.749Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:31:11.749Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:31:11.851Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315871649",
  "key": "test-sliding:test-sliding-1765315871649"
}
[2025-12-09T21:31:11.851Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315871649",
  "timestampCount": 2
}
[2025-12-09T21:31:11.851Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:31:11.851Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:31:11.851Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:31:11.851Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765315871851",
  "key": "register:test-format-allowed-1765315871851"
}
[2025-12-09T21:31:11.852Z] Creating new entry
{
  "key": "register:test-format-allowed-1765315871851"
}
[2025-12-09T21:31:11.852Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:31:11.852Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:31:11.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315871852",
  "key": "register:test-format-blocked-1765315871852"
}
[2025-12-09T21:31:11.852Z] Creating new entry
{
  "key": "register:test-format-blocked-1765315871852"
}
[2025-12-09T21:31:11.852Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:31:11.852Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:31:11.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315871852",
  "key": "register:test-format-blocked-1765315871852"
}
[2025-12-09T21:31:11.852Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315871852",
  "timestampCount": 1
}
[2025-12-09T21:31:11.852Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:31:11.852Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:31:11.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315871852",
  "key": "register:test-format-blocked-1765315871852"
}
[2025-12-09T21:31:11.852Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315871852",
  "timestampCount": 2
}
[2025-12-09T21:31:11.852Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:31:11.852Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:31:11.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315871852",
  "key": "register:test-format-blocked-1765315871852"
}
[2025-12-09T21:31:11.852Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315871852",
  "timestampCount": 3
}
[2025-12-09T21:31:11.852Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:32:28.354Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315948354",
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.355Z] Creating new entry
{
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.355Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:32:28.355Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:32:28.355Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315948354",
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.355Z] Found existing entry
{
  "key": "login:test-allow-1765315948354",
  "timestampCount": 1
}
[2025-12-09T21:32:28.355Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:32:28.355Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:32:28.355Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315948354",
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.355Z] Found existing entry
{
  "key": "login:test-allow-1765315948354",
  "timestampCount": 2
}
[2025-12-09T21:32:28.356Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:32:28.356Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:32:28.356Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315948354",
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.356Z] Found existing entry
{
  "key": "login:test-allow-1765315948354",
  "timestampCount": 3
}
[2025-12-09T21:32:28.356Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:32:28.356Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:32:28.356Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765315948354",
  "key": "login:test-allow-1765315948354"
}
[2025-12-09T21:32:28.356Z] Found existing entry
{
  "key": "login:test-allow-1765315948354",
  "timestampCount": 4
}
[2025-12-09T21:32:28.356Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:32:28.356Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:32:28.356Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.356Z] Creating new entry
{
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.356Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:32:28.356Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:32:28.356Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.356Z] Found existing entry
{
  "key": "login:test-block-1765315948356",
  "timestampCount": 1
}
[2025-12-09T21:32:28.356Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:32:28.356Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:32:28.356Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.356Z] Found existing entry
{
  "key": "login:test-block-1765315948356",
  "timestampCount": 2
}
[2025-12-09T21:32:28.357Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:32:28.357Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:32:28.357Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.357Z] Found existing entry
{
  "key": "login:test-block-1765315948356",
  "timestampCount": 3
}
[2025-12-09T21:32:28.357Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:32:28.357Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:32:28.357Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.357Z] Found existing entry
{
  "key": "login:test-block-1765315948356",
  "timestampCount": 4
}
[2025-12-09T21:32:28.357Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:32:28.357Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:32:28.357Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765315948356",
  "key": "login:test-block-1765315948356"
}
[2025-12-09T21:32:28.357Z] Found existing entry
{
  "key": "login:test-block-1765315948356",
  "timestampCount": 5
}
[2025-12-09T21:32:28.357Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:32:28.358Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315948358",
  "key": "test-reset:test-reset-1765315948358"
}
[2025-12-09T21:32:28.358Z] Creating new entry
{
  "key": "test-reset:test-reset-1765315948358"
}
[2025-12-09T21:32:28.358Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:32:28.358Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:32:28.358Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315948358",
  "key": "test-reset:test-reset-1765315948358"
}
[2025-12-09T21:32:28.358Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315948358",
  "timestampCount": 1
}
[2025-12-09T21:32:28.358Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:32:28.358Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:32:28.358Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315948358",
  "key": "test-reset:test-reset-1765315948358"
}
[2025-12-09T21:32:28.358Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315948358",
  "timestampCount": 2
}
[2025-12-09T21:32:28.358Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:32:28.509Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765315948358",
  "key": "test-reset:test-reset-1765315948358"
}
[2025-12-09T21:32:28.509Z] Found existing entry
{
  "key": "test-reset:test-reset-1765315948358",
  "timestampCount": 2
}
[2025-12-09T21:32:28.509Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:32:28.509Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:32:28.510Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:32:28.510Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.510Z] Creating new entry
{
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.510Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:32:28.510Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:32:28.510Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.510Z] Found existing entry
{
  "key": "login:test-multi-1-1765315948510",
  "timestampCount": 1
}
[2025-12-09T21:32:28.510Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:32:28.510Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:32:28.510Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.510Z] Found existing entry
{
  "key": "login:test-multi-1-1765315948510",
  "timestampCount": 2
}
[2025-12-09T21:32:28.510Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:32:28.510Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:32:28.510Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.510Z] Found existing entry
{
  "key": "login:test-multi-1-1765315948510",
  "timestampCount": 3
}
[2025-12-09T21:32:28.510Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:32:28.511Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:32:28.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.511Z] Found existing entry
{
  "key": "login:test-multi-1-1765315948510",
  "timestampCount": 4
}
[2025-12-09T21:32:28.511Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:32:28.511Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:32:28.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765315948510",
  "key": "login:test-multi-1-1765315948510"
}
[2025-12-09T21:32:28.511Z] Found existing entry
{
  "key": "login:test-multi-1-1765315948510",
  "timestampCount": 5
}
[2025-12-09T21:32:28.511Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:32:28.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765315948510",
  "key": "login:test-multi-2-1765315948510"
}
[2025-12-09T21:32:28.511Z] Creating new entry
{
  "key": "login:test-multi-2-1765315948510"
}
[2025-12-09T21:32:28.511Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:32:28.511Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:32:28.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765315948511",
  "key": "login:test-reset-time-1765315948511"
}
[2025-12-09T21:32:28.511Z] Creating new entry
{
  "key": "login:test-reset-time-1765315948511"
}
[2025-12-09T21:32:28.511Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:32:28.512Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:32:28.513Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:32:28.513Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:32:28.513Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:32:28.513Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:32:28.513Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:32:28.513Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:32:28.513Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:32:28.513Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:32:28.514Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:32:28.514Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:32:28.514Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315948514",
  "key": "test-sliding:test-sliding-1765315948514"
}
[2025-12-09T21:32:28.514Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765315948514"
}
[2025-12-09T21:32:28.514Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:32:28.514Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:32:28.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315948514",
  "key": "test-sliding:test-sliding-1765315948514"
}
[2025-12-09T21:32:28.614Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315948514",
  "timestampCount": 1
}
[2025-12-09T21:32:28.614Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:32:28.614Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:32:28.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765315948514",
  "key": "test-sliding:test-sliding-1765315948514"
}
[2025-12-09T21:32:28.715Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765315948514",
  "timestampCount": 2
}
[2025-12-09T21:32:28.715Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:32:28.715Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:32:28.715Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:32:28.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765315948715",
  "key": "register:test-format-allowed-1765315948715"
}
[2025-12-09T21:32:28.715Z] Creating new entry
{
  "key": "register:test-format-allowed-1765315948715"
}
[2025-12-09T21:32:28.715Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:32:28.715Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:32:28.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315948715",
  "key": "register:test-format-blocked-1765315948715"
}
[2025-12-09T21:32:28.716Z] Creating new entry
{
  "key": "register:test-format-blocked-1765315948715"
}
[2025-12-09T21:32:28.716Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:32:28.716Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:32:28.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315948715",
  "key": "register:test-format-blocked-1765315948715"
}
[2025-12-09T21:32:28.716Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315948715",
  "timestampCount": 1
}
[2025-12-09T21:32:28.716Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:32:28.716Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:32:28.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315948715",
  "key": "register:test-format-blocked-1765315948715"
}
[2025-12-09T21:32:28.716Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315948715",
  "timestampCount": 2
}
[2025-12-09T21:32:28.716Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:32:28.716Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:32:28.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765315948715",
  "key": "register:test-format-blocked-1765315948715"
}
[2025-12-09T21:32:28.716Z] Found existing entry
{
  "key": "register:test-format-blocked-1765315948715",
  "timestampCount": 3
}
[2025-12-09T21:32:28.716Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:54:04.296Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317244296",
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.296Z] Creating new entry
{
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.296Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:04.296Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:04.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317244296",
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.297Z] Found existing entry
{
  "key": "login:test-allow-1765317244296",
  "timestampCount": 1
}
[2025-12-09T21:54:04.297Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:04.297Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:04.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317244296",
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.297Z] Found existing entry
{
  "key": "login:test-allow-1765317244296",
  "timestampCount": 2
}
[2025-12-09T21:54:04.297Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:04.297Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:04.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317244296",
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.297Z] Found existing entry
{
  "key": "login:test-allow-1765317244296",
  "timestampCount": 3
}
[2025-12-09T21:54:04.297Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:04.297Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:04.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317244296",
  "key": "login:test-allow-1765317244296"
}
[2025-12-09T21:54:04.297Z] Found existing entry
{
  "key": "login:test-allow-1765317244296",
  "timestampCount": 4
}
[2025-12-09T21:54:04.297Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:04.297Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:04.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Creating new entry
{
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:04.298Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:04.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Found existing entry
{
  "key": "login:test-block-1765317244298",
  "timestampCount": 1
}
[2025-12-09T21:54:04.298Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:04.298Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:04.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Found existing entry
{
  "key": "login:test-block-1765317244298",
  "timestampCount": 2
}
[2025-12-09T21:54:04.298Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:04.298Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:04.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Found existing entry
{
  "key": "login:test-block-1765317244298",
  "timestampCount": 3
}
[2025-12-09T21:54:04.298Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:04.298Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:04.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.298Z] Found existing entry
{
  "key": "login:test-block-1765317244298",
  "timestampCount": 4
}
[2025-12-09T21:54:04.298Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:04.299Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:04.299Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317244298",
  "key": "login:test-block-1765317244298"
}
[2025-12-09T21:54:04.299Z] Found existing entry
{
  "key": "login:test-block-1765317244298",
  "timestampCount": 5
}
[2025-12-09T21:54:04.299Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:54:04.299Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317244299",
  "key": "test-reset:test-reset-1765317244299"
}
[2025-12-09T21:54:04.299Z] Creating new entry
{
  "key": "test-reset:test-reset-1765317244299"
}
[2025-12-09T21:54:04.299Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:54:04.299Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:54:04.299Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317244299",
  "key": "test-reset:test-reset-1765317244299"
}
[2025-12-09T21:54:04.299Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317244299",
  "timestampCount": 1
}
[2025-12-09T21:54:04.299Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:54:04.300Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:54:04.300Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317244299",
  "key": "test-reset:test-reset-1765317244299"
}
[2025-12-09T21:54:04.300Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317244299",
  "timestampCount": 2
}
[2025-12-09T21:54:04.300Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:54:04.450Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317244299",
  "key": "test-reset:test-reset-1765317244299"
}
[2025-12-09T21:54:04.450Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317244299",
  "timestampCount": 2
}
[2025-12-09T21:54:04.450Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Creating new entry
{
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Found existing entry
{
  "key": "login:test-multi-1-1765317244451",
  "timestampCount": 1
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Found existing entry
{
  "key": "login:test-multi-1-1765317244451",
  "timestampCount": 2
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Found existing entry
{
  "key": "login:test-multi-1-1765317244451",
  "timestampCount": 3
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Found existing entry
{
  "key": "login:test-multi-1-1765317244451",
  "timestampCount": 4
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:04.451Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:04.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317244451",
  "key": "login:test-multi-1-1765317244451"
}
[2025-12-09T21:54:04.451Z] Found existing entry
{
  "key": "login:test-multi-1-1765317244451",
  "timestampCount": 5
}
[2025-12-09T21:54:04.451Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:54:04.452Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765317244451",
  "key": "login:test-multi-2-1765317244451"
}
[2025-12-09T21:54:04.452Z] Creating new entry
{
  "key": "login:test-multi-2-1765317244451"
}
[2025-12-09T21:54:04.452Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:04.452Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:04.452Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765317244452",
  "key": "login:test-reset-time-1765317244452"
}
[2025-12-09T21:54:04.452Z] Creating new entry
{
  "key": "login:test-reset-time-1765317244452"
}
[2025-12-09T21:54:04.452Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:04.452Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:04.453Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:04.453Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:04.453Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:04.453Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:54:04.453Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:04.454Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:04.454Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:04.454Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:54:04.454Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:04.454Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:04.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317244454",
  "key": "test-sliding:test-sliding-1765317244454"
}
[2025-12-09T21:54:04.454Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765317244454"
}
[2025-12-09T21:54:04.454Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:04.454Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:04.553Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317244454",
  "key": "test-sliding:test-sliding-1765317244454"
}
[2025-12-09T21:54:04.553Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317244454",
  "timestampCount": 1
}
[2025-12-09T21:54:04.554Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:04.554Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:04.655Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317244454",
  "key": "test-sliding:test-sliding-1765317244454"
}
[2025-12-09T21:54:04.656Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317244454",
  "timestampCount": 2
}
[2025-12-09T21:54:04.656Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:54:04.656Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:04.656Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:04.656Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765317244656",
  "key": "register:test-format-allowed-1765317244656"
}
[2025-12-09T21:54:04.656Z] Creating new entry
{
  "key": "register:test-format-allowed-1765317244656"
}
[2025-12-09T21:54:04.656Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:04.656Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:04.656Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317244656",
  "key": "register:test-format-blocked-1765317244656"
}
[2025-12-09T21:54:04.656Z] Creating new entry
{
  "key": "register:test-format-blocked-1765317244656"
}
[2025-12-09T21:54:04.656Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:04.656Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:04.656Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317244656",
  "key": "register:test-format-blocked-1765317244656"
}
[2025-12-09T21:54:04.656Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317244656",
  "timestampCount": 1
}
[2025-12-09T21:54:04.656Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:04.656Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:04.656Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317244656",
  "key": "register:test-format-blocked-1765317244656"
}
[2025-12-09T21:54:04.656Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317244656",
  "timestampCount": 2
}
[2025-12-09T21:54:04.657Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:54:04.657Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:54:04.657Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317244656",
  "key": "register:test-format-blocked-1765317244656"
}
[2025-12-09T21:54:04.657Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317244656",
  "timestampCount": 3
}
[2025-12-09T21:54:04.657Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:54:40.054Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317280053",
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.055Z] Creating new entry
{
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.055Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:40.055Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:40.055Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317280053",
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.055Z] Found existing entry
{
  "key": "login:test-allow-1765317280053",
  "timestampCount": 1
}
[2025-12-09T21:54:40.055Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:40.055Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:40.055Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317280053",
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.055Z] Found existing entry
{
  "key": "login:test-allow-1765317280053",
  "timestampCount": 2
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:40.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317280053",
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.056Z] Found existing entry
{
  "key": "login:test-allow-1765317280053",
  "timestampCount": 3
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:40.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317280053",
  "key": "login:test-allow-1765317280053"
}
[2025-12-09T21:54:40.056Z] Found existing entry
{
  "key": "login:test-allow-1765317280053",
  "timestampCount": 4
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:40.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.056Z] Creating new entry
{
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:40.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.056Z] Found existing entry
{
  "key": "login:test-block-1765317280056",
  "timestampCount": 1
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:40.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.056Z] Found existing entry
{
  "key": "login:test-block-1765317280056",
  "timestampCount": 2
}
[2025-12-09T21:54:40.056Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:40.056Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:40.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.057Z] Found existing entry
{
  "key": "login:test-block-1765317280056",
  "timestampCount": 3
}
[2025-12-09T21:54:40.057Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:40.057Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:40.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.057Z] Found existing entry
{
  "key": "login:test-block-1765317280056",
  "timestampCount": 4
}
[2025-12-09T21:54:40.057Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:40.057Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:40.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317280056",
  "key": "login:test-block-1765317280056"
}
[2025-12-09T21:54:40.057Z] Found existing entry
{
  "key": "login:test-block-1765317280056",
  "timestampCount": 5
}
[2025-12-09T21:54:40.057Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:54:40.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317280057",
  "key": "test-reset:test-reset-1765317280057"
}
[2025-12-09T21:54:40.057Z] Creating new entry
{
  "key": "test-reset:test-reset-1765317280057"
}
[2025-12-09T21:54:40.057Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:54:40.057Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:54:40.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317280057",
  "key": "test-reset:test-reset-1765317280057"
}
[2025-12-09T21:54:40.058Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317280057",
  "timestampCount": 1
}
[2025-12-09T21:54:40.058Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:54:40.058Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:54:40.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317280057",
  "key": "test-reset:test-reset-1765317280057"
}
[2025-12-09T21:54:40.058Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317280057",
  "timestampCount": 2
}
[2025-12-09T21:54:40.058Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:54:40.208Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317280057",
  "key": "test-reset:test-reset-1765317280057"
}
[2025-12-09T21:54:40.208Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317280057",
  "timestampCount": 2
}
[2025-12-09T21:54:40.208Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:54:40.208Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:54:40.208Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:54:40.208Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Creating new entry
{
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Found existing entry
{
  "key": "login:test-multi-1-1765317280208",
  "timestampCount": 1
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Found existing entry
{
  "key": "login:test-multi-1-1765317280208",
  "timestampCount": 2
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Found existing entry
{
  "key": "login:test-multi-1-1765317280208",
  "timestampCount": 3
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Found existing entry
{
  "key": "login:test-multi-1-1765317280208",
  "timestampCount": 4
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317280208",
  "key": "login:test-multi-1-1765317280208"
}
[2025-12-09T21:54:40.209Z] Found existing entry
{
  "key": "login:test-multi-1-1765317280208",
  "timestampCount": 5
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765317280208",
  "key": "login:test-multi-2-1765317280208"
}
[2025-12-09T21:54:40.209Z] Creating new entry
{
  "key": "login:test-multi-2-1765317280208"
}
[2025-12-09T21:54:40.209Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:40.209Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:40.210Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765317280210",
  "key": "login:test-reset-time-1765317280210"
}
[2025-12-09T21:54:40.210Z] Creating new entry
{
  "key": "login:test-reset-time-1765317280210"
}
[2025-12-09T21:54:40.210Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:54:40.210Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:54:40.211Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:40.211Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:40.211Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:40.211Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:54:40.211Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:40.211Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:40.212Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:40.212Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:54:40.212Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:54:40.212Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:54:40.212Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317280212",
  "key": "test-sliding:test-sliding-1765317280212"
}
[2025-12-09T21:54:40.212Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765317280212"
}
[2025-12-09T21:54:40.212Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:40.212Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:40.312Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317280212",
  "key": "test-sliding:test-sliding-1765317280212"
}
[2025-12-09T21:54:40.312Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317280212",
  "timestampCount": 1
}
[2025-12-09T21:54:40.312Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:40.312Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:40.413Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317280212",
  "key": "test-sliding:test-sliding-1765317280212"
}
[2025-12-09T21:54:40.413Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317280212",
  "timestampCount": 2
}
[2025-12-09T21:54:40.413Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:54:40.413Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:40.413Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:40.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765317280414",
  "key": "register:test-format-allowed-1765317280414"
}
[2025-12-09T21:54:40.414Z] Creating new entry
{
  "key": "register:test-format-allowed-1765317280414"
}
[2025-12-09T21:54:40.414Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:40.414Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:40.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317280414",
  "key": "register:test-format-blocked-1765317280414"
}
[2025-12-09T21:54:40.414Z] Creating new entry
{
  "key": "register:test-format-blocked-1765317280414"
}
[2025-12-09T21:54:40.414Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:54:40.414Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:54:40.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317280414",
  "key": "register:test-format-blocked-1765317280414"
}
[2025-12-09T21:54:40.414Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317280414",
  "timestampCount": 1
}
[2025-12-09T21:54:40.414Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:54:40.414Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:54:40.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317280414",
  "key": "register:test-format-blocked-1765317280414"
}
[2025-12-09T21:54:40.414Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317280414",
  "timestampCount": 2
}
[2025-12-09T21:54:40.414Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:54:40.414Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:54:40.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317280414",
  "key": "register:test-format-blocked-1765317280414"
}
[2025-12-09T21:54:40.414Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317280414",
  "timestampCount": 3
}
[2025-12-09T21:54:40.414Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:56:43.166Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317403166",
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Creating new entry
{
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:56:43.167Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:56:43.167Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317403166",
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Found existing entry
{
  "key": "login:test-allow-1765317403166",
  "timestampCount": 1
}
[2025-12-09T21:56:43.167Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:56:43.167Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:56:43.167Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317403166",
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Found existing entry
{
  "key": "login:test-allow-1765317403166",
  "timestampCount": 2
}
[2025-12-09T21:56:43.167Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:56:43.167Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:56:43.167Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317403166",
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Found existing entry
{
  "key": "login:test-allow-1765317403166",
  "timestampCount": 3
}
[2025-12-09T21:56:43.167Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:56:43.167Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:56:43.167Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317403166",
  "key": "login:test-allow-1765317403166"
}
[2025-12-09T21:56:43.167Z] Found existing entry
{
  "key": "login:test-allow-1765317403166",
  "timestampCount": 4
}
[2025-12-09T21:56:43.167Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Creating new entry
{
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Found existing entry
{
  "key": "login:test-block-1765317403168",
  "timestampCount": 1
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Found existing entry
{
  "key": "login:test-block-1765317403168",
  "timestampCount": 2
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Found existing entry
{
  "key": "login:test-block-1765317403168",
  "timestampCount": 3
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Found existing entry
{
  "key": "login:test-block-1765317403168",
  "timestampCount": 4
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:56:43.168Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:56:43.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317403168",
  "key": "login:test-block-1765317403168"
}
[2025-12-09T21:56:43.168Z] Found existing entry
{
  "key": "login:test-block-1765317403168",
  "timestampCount": 5
}
[2025-12-09T21:56:43.168Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:56:43.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317403169",
  "key": "test-reset:test-reset-1765317403169"
}
[2025-12-09T21:56:43.169Z] Creating new entry
{
  "key": "test-reset:test-reset-1765317403169"
}
[2025-12-09T21:56:43.169Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:56:43.169Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:56:43.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317403169",
  "key": "test-reset:test-reset-1765317403169"
}
[2025-12-09T21:56:43.169Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317403169",
  "timestampCount": 1
}
[2025-12-09T21:56:43.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:56:43.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:56:43.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317403169",
  "key": "test-reset:test-reset-1765317403169"
}
[2025-12-09T21:56:43.170Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317403169",
  "timestampCount": 2
}
[2025-12-09T21:56:43.170Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:56:43.321Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317403169",
  "key": "test-reset:test-reset-1765317403169"
}
[2025-12-09T21:56:43.321Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317403169",
  "timestampCount": 2
}
[2025-12-09T21:56:43.321Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:56:43.321Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:56:43.321Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Creating new entry
{
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Found existing entry
{
  "key": "login:test-multi-1-1765317403322",
  "timestampCount": 1
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Found existing entry
{
  "key": "login:test-multi-1-1765317403322",
  "timestampCount": 2
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Found existing entry
{
  "key": "login:test-multi-1-1765317403322",
  "timestampCount": 3
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Found existing entry
{
  "key": "login:test-multi-1-1765317403322",
  "timestampCount": 4
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317403322",
  "key": "login:test-multi-1-1765317403322"
}
[2025-12-09T21:56:43.322Z] Found existing entry
{
  "key": "login:test-multi-1-1765317403322",
  "timestampCount": 5
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765317403322",
  "key": "login:test-multi-2-1765317403322"
}
[2025-12-09T21:56:43.322Z] Creating new entry
{
  "key": "login:test-multi-2-1765317403322"
}
[2025-12-09T21:56:43.322Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:56:43.322Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:56:43.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765317403323",
  "key": "login:test-reset-time-1765317403323"
}
[2025-12-09T21:56:43.323Z] Creating new entry
{
  "key": "login:test-reset-time-1765317403323"
}
[2025-12-09T21:56:43.323Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:56:43.323Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:56:43.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:56:43.325Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:56:43.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:56:43.325Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:56:43.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:56:43.325Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:56:43.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:56:43.325Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:56:43.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:56:43.325Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:56:43.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317403326",
  "key": "test-sliding:test-sliding-1765317403326"
}
[2025-12-09T21:56:43.326Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765317403326"
}
[2025-12-09T21:56:43.326Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:56:43.326Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:56:43.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317403326",
  "key": "test-sliding:test-sliding-1765317403326"
}
[2025-12-09T21:56:43.426Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317403326",
  "timestampCount": 1
}
[2025-12-09T21:56:43.426Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:56:43.427Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:56:43.528Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317403326",
  "key": "test-sliding:test-sliding-1765317403326"
}
[2025-12-09T21:56:43.528Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317403326",
  "timestampCount": 2
}
[2025-12-09T21:56:43.528Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:56:43.528Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:56:43.528Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:56:43.529Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765317403529",
  "key": "register:test-format-allowed-1765317403529"
}
[2025-12-09T21:56:43.529Z] Creating new entry
{
  "key": "register:test-format-allowed-1765317403529"
}
[2025-12-09T21:56:43.529Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:56:43.529Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:56:43.530Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317403530",
  "key": "register:test-format-blocked-1765317403530"
}
[2025-12-09T21:56:43.530Z] Creating new entry
{
  "key": "register:test-format-blocked-1765317403530"
}
[2025-12-09T21:56:43.530Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:56:43.530Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:56:43.530Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317403530",
  "key": "register:test-format-blocked-1765317403530"
}
[2025-12-09T21:56:43.530Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317403530",
  "timestampCount": 1
}
[2025-12-09T21:56:43.530Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:56:43.530Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:56:43.530Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317403530",
  "key": "register:test-format-blocked-1765317403530"
}
[2025-12-09T21:56:43.530Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317403530",
  "timestampCount": 2
}
[2025-12-09T21:56:43.531Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:56:43.531Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:56:43.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317403530",
  "key": "register:test-format-blocked-1765317403530"
}
[2025-12-09T21:56:43.531Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317403530",
  "timestampCount": 3
}
[2025-12-09T21:56:43.531Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:57:16.446Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317436446",
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.453Z] Creating new entry
{
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.453Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:57:16.453Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:57:16.453Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317436446",
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.453Z] Found existing entry
{
  "key": "login:test-allow-1765317436446",
  "timestampCount": 1
}
[2025-12-09T21:57:16.453Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:57:16.453Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:57:16.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317436446",
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.454Z] Found existing entry
{
  "key": "login:test-allow-1765317436446",
  "timestampCount": 2
}
[2025-12-09T21:57:16.454Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:57:16.454Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:57:16.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317436446",
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.454Z] Found existing entry
{
  "key": "login:test-allow-1765317436446",
  "timestampCount": 3
}
[2025-12-09T21:57:16.454Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:57:16.454Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:57:16.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317436446",
  "key": "login:test-allow-1765317436446"
}
[2025-12-09T21:57:16.454Z] Found existing entry
{
  "key": "login:test-allow-1765317436446",
  "timestampCount": 4
}
[2025-12-09T21:57:16.454Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:57:16.454Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:57:16.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.454Z] Creating new entry
{
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.454Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:57:16.454Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:57:16.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.454Z] Found existing entry
{
  "key": "login:test-block-1765317436454",
  "timestampCount": 1
}
[2025-12-09T21:57:16.455Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:57:16.455Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:57:16.455Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.455Z] Found existing entry
{
  "key": "login:test-block-1765317436454",
  "timestampCount": 2
}
[2025-12-09T21:57:16.455Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:57:16.455Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:57:16.455Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.455Z] Found existing entry
{
  "key": "login:test-block-1765317436454",
  "timestampCount": 3
}
[2025-12-09T21:57:16.455Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:57:16.455Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:57:16.455Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.455Z] Found existing entry
{
  "key": "login:test-block-1765317436454",
  "timestampCount": 4
}
[2025-12-09T21:57:16.455Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:57:16.455Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:57:16.455Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317436454",
  "key": "login:test-block-1765317436454"
}
[2025-12-09T21:57:16.455Z] Found existing entry
{
  "key": "login:test-block-1765317436454",
  "timestampCount": 5
}
[2025-12-09T21:57:16.455Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:57:16.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317436456",
  "key": "test-reset:test-reset-1765317436456"
}
[2025-12-09T21:57:16.456Z] Creating new entry
{
  "key": "test-reset:test-reset-1765317436456"
}
[2025-12-09T21:57:16.456Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:57:16.456Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:57:16.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317436456",
  "key": "test-reset:test-reset-1765317436456"
}
[2025-12-09T21:57:16.456Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317436456",
  "timestampCount": 1
}
[2025-12-09T21:57:16.456Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:57:16.456Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:57:16.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317436456",
  "key": "test-reset:test-reset-1765317436456"
}
[2025-12-09T21:57:16.456Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317436456",
  "timestampCount": 2
}
[2025-12-09T21:57:16.456Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:57:16.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317436456",
  "key": "test-reset:test-reset-1765317436456"
}
[2025-12-09T21:57:16.610Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317436456",
  "timestampCount": 2
}
[2025-12-09T21:57:16.610Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:57:16.610Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:57:16.610Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:57:16.613Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Creating new entry
{
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:57:16.614Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:57:16.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765317436613",
  "timestampCount": 1
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:57:16.614Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:57:16.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765317436613",
  "timestampCount": 2
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:57:16.614Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:57:16.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765317436613",
  "timestampCount": 3
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:57:16.614Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:57:16.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765317436613",
  "timestampCount": 4
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:57:16.614Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:57:16.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317436613",
  "key": "login:test-multi-1-1765317436613"
}
[2025-12-09T21:57:16.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765317436613",
  "timestampCount": 5
}
[2025-12-09T21:57:16.614Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:57:16.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765317436613",
  "key": "login:test-multi-2-1765317436613"
}
[2025-12-09T21:57:16.615Z] Creating new entry
{
  "key": "login:test-multi-2-1765317436613"
}
[2025-12-09T21:57:16.615Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:57:16.615Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:57:16.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765317436615",
  "key": "login:test-reset-time-1765317436615"
}
[2025-12-09T21:57:16.615Z] Creating new entry
{
  "key": "login:test-reset-time-1765317436615"
}
[2025-12-09T21:57:16.615Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:57:16.615Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:57:16.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:57:16.617Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:57:16.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:57:16.617Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:57:16.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:57:16.617Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:57:16.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:57:16.617Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:57:16.618Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:57:16.618Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:57:16.618Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317436618",
  "key": "test-sliding:test-sliding-1765317436618"
}
[2025-12-09T21:57:16.618Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765317436618"
}
[2025-12-09T21:57:16.618Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:57:16.618Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:57:16.722Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317436618",
  "key": "test-sliding:test-sliding-1765317436618"
}
[2025-12-09T21:57:16.723Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317436618",
  "timestampCount": 1
}
[2025-12-09T21:57:16.724Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:57:16.724Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:57:16.825Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317436618",
  "key": "test-sliding:test-sliding-1765317436618"
}
[2025-12-09T21:57:16.825Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317436618",
  "timestampCount": 2
}
[2025-12-09T21:57:16.826Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:57:16.826Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:57:16.826Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:57:16.826Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765317436826",
  "key": "register:test-format-allowed-1765317436826"
}
[2025-12-09T21:57:16.826Z] Creating new entry
{
  "key": "register:test-format-allowed-1765317436826"
}
[2025-12-09T21:57:16.826Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:57:16.826Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:57:16.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317436827",
  "key": "register:test-format-blocked-1765317436827"
}
[2025-12-09T21:57:16.827Z] Creating new entry
{
  "key": "register:test-format-blocked-1765317436827"
}
[2025-12-09T21:57:16.827Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:57:16.827Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:57:16.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317436827",
  "key": "register:test-format-blocked-1765317436827"
}
[2025-12-09T21:57:16.827Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317436827",
  "timestampCount": 1
}
[2025-12-09T21:57:16.827Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:57:16.827Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:57:16.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317436827",
  "key": "register:test-format-blocked-1765317436827"
}
[2025-12-09T21:57:16.827Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317436827",
  "timestampCount": 2
}
[2025-12-09T21:57:16.827Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:57:16.827Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:57:16.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317436827",
  "key": "register:test-format-blocked-1765317436827"
}
[2025-12-09T21:57:16.828Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317436827",
  "timestampCount": 3
}
[2025-12-09T21:57:16.828Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T21:58:12.030Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317492030",
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.030Z] Creating new entry
{
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.030Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:58:12.030Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:58:12.031Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317492030",
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.031Z] Found existing entry
{
  "key": "login:test-allow-1765317492030",
  "timestampCount": 1
}
[2025-12-09T21:58:12.031Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:58:12.031Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:58:12.031Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317492030",
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.031Z] Found existing entry
{
  "key": "login:test-allow-1765317492030",
  "timestampCount": 2
}
[2025-12-09T21:58:12.031Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:58:12.031Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:58:12.031Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317492030",
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.031Z] Found existing entry
{
  "key": "login:test-allow-1765317492030",
  "timestampCount": 3
}
[2025-12-09T21:58:12.031Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:58:12.031Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:58:12.031Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765317492030",
  "key": "login:test-allow-1765317492030"
}
[2025-12-09T21:58:12.031Z] Found existing entry
{
  "key": "login:test-allow-1765317492030",
  "timestampCount": 4
}
[2025-12-09T21:58:12.031Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:58:12.031Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Creating new entry
{
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:58:12.032Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Found existing entry
{
  "key": "login:test-block-1765317492032",
  "timestampCount": 1
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:58:12.032Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Found existing entry
{
  "key": "login:test-block-1765317492032",
  "timestampCount": 2
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:58:12.032Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Found existing entry
{
  "key": "login:test-block-1765317492032",
  "timestampCount": 3
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:58:12.032Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Found existing entry
{
  "key": "login:test-block-1765317492032",
  "timestampCount": 4
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:58:12.032Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:58:12.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765317492032",
  "key": "login:test-block-1765317492032"
}
[2025-12-09T21:58:12.032Z] Found existing entry
{
  "key": "login:test-block-1765317492032",
  "timestampCount": 5
}
[2025-12-09T21:58:12.032Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:58:12.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317492033",
  "key": "test-reset:test-reset-1765317492033"
}
[2025-12-09T21:58:12.033Z] Creating new entry
{
  "key": "test-reset:test-reset-1765317492033"
}
[2025-12-09T21:58:12.033Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:58:12.033Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:58:12.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317492033",
  "key": "test-reset:test-reset-1765317492033"
}
[2025-12-09T21:58:12.033Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317492033",
  "timestampCount": 1
}
[2025-12-09T21:58:12.033Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T21:58:12.033Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T21:58:12.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317492033",
  "key": "test-reset:test-reset-1765317492033"
}
[2025-12-09T21:58:12.033Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317492033",
  "timestampCount": 2
}
[2025-12-09T21:58:12.033Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T21:58:12.184Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765317492033",
  "key": "test-reset:test-reset-1765317492033"
}
[2025-12-09T21:58:12.184Z] Found existing entry
{
  "key": "test-reset:test-reset-1765317492033",
  "timestampCount": 2
}
[2025-12-09T21:58:12.185Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T21:58:12.185Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T21:58:12.185Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T21:58:12.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.185Z] Creating new entry
{
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.185Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:58:12.186Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:58:12.191Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.191Z] Found existing entry
{
  "key": "login:test-multi-1-1765317492185",
  "timestampCount": 1
}
[2025-12-09T21:58:12.191Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T21:58:12.191Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T21:58:12.191Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.191Z] Found existing entry
{
  "key": "login:test-multi-1-1765317492185",
  "timestampCount": 2
}
[2025-12-09T21:58:12.191Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T21:58:12.191Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T21:58:12.191Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.191Z] Found existing entry
{
  "key": "login:test-multi-1-1765317492185",
  "timestampCount": 3
}
[2025-12-09T21:58:12.191Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T21:58:12.191Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T21:58:12.191Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.191Z] Found existing entry
{
  "key": "login:test-multi-1-1765317492185",
  "timestampCount": 4
}
[2025-12-09T21:58:12.191Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T21:58:12.192Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T21:58:12.192Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765317492185",
  "key": "login:test-multi-1-1765317492185"
}
[2025-12-09T21:58:12.192Z] Found existing entry
{
  "key": "login:test-multi-1-1765317492185",
  "timestampCount": 5
}
[2025-12-09T21:58:12.192Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T21:58:12.192Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765317492185",
  "key": "login:test-multi-2-1765317492185"
}
[2025-12-09T21:58:12.192Z] Creating new entry
{
  "key": "login:test-multi-2-1765317492185"
}
[2025-12-09T21:58:12.192Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:58:12.192Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:58:12.192Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765317492192",
  "key": "login:test-reset-time-1765317492192"
}
[2025-12-09T21:58:12.192Z] Creating new entry
{
  "key": "login:test-reset-time-1765317492192"
}
[2025-12-09T21:58:12.192Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T21:58:12.192Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T21:58:12.193Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:58:12.193Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:58:12.194Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:58:12.194Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T21:58:12.194Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:58:12.194Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:58:12.194Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:58:12.194Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T21:58:12.194Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T21:58:12.194Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T21:58:12.194Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317492194",
  "key": "test-sliding:test-sliding-1765317492194"
}
[2025-12-09T21:58:12.194Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765317492194"
}
[2025-12-09T21:58:12.194Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:58:12.194Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:58:12.295Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317492194",
  "key": "test-sliding:test-sliding-1765317492194"
}
[2025-12-09T21:58:12.295Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317492194",
  "timestampCount": 1
}
[2025-12-09T21:58:12.295Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:58:12.296Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:58:12.396Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765317492194",
  "key": "test-sliding:test-sliding-1765317492194"
}
[2025-12-09T21:58:12.396Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765317492194",
  "timestampCount": 2
}
[2025-12-09T21:58:12.396Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T21:58:12.396Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:58:12.396Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:58:12.396Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765317492396",
  "key": "register:test-format-allowed-1765317492396"
}
[2025-12-09T21:58:12.396Z] Creating new entry
{
  "key": "register:test-format-allowed-1765317492396"
}
[2025-12-09T21:58:12.396Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:58:12.396Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:58:12.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317492397",
  "key": "register:test-format-blocked-1765317492397"
}
[2025-12-09T21:58:12.397Z] Creating new entry
{
  "key": "register:test-format-blocked-1765317492397"
}
[2025-12-09T21:58:12.397Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T21:58:12.397Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T21:58:12.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317492397",
  "key": "register:test-format-blocked-1765317492397"
}
[2025-12-09T21:58:12.397Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317492397",
  "timestampCount": 1
}
[2025-12-09T21:58:12.397Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T21:58:12.397Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T21:58:12.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317492397",
  "key": "register:test-format-blocked-1765317492397"
}
[2025-12-09T21:58:12.397Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317492397",
  "timestampCount": 2
}
[2025-12-09T21:58:12.397Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T21:58:12.397Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T21:58:12.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765317492397",
  "key": "register:test-format-blocked-1765317492397"
}
[2025-12-09T21:58:12.397Z] Found existing entry
{
  "key": "register:test-format-blocked-1765317492397",
  "timestampCount": 3
}
[2025-12-09T21:58:12.397Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:05:18.629Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765321518629",
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.630Z] Creating new entry
{
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.630Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:05:18.630Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:05:18.630Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765321518629",
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.630Z] Found existing entry
{
  "key": "login:test-allow-1765321518629",
  "timestampCount": 1
}
[2025-12-09T23:05:18.630Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:05:18.630Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:05:18.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765321518629",
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.631Z] Found existing entry
{
  "key": "login:test-allow-1765321518629",
  "timestampCount": 2
}
[2025-12-09T23:05:18.631Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:05:18.631Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:05:18.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765321518629",
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.631Z] Found existing entry
{
  "key": "login:test-allow-1765321518629",
  "timestampCount": 3
}
[2025-12-09T23:05:18.631Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:05:18.631Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:05:18.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765321518629",
  "key": "login:test-allow-1765321518629"
}
[2025-12-09T23:05:18.631Z] Found existing entry
{
  "key": "login:test-allow-1765321518629",
  "timestampCount": 4
}
[2025-12-09T23:05:18.631Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:05:18.631Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:05:18.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.631Z] Creating new entry
{
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.631Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:05:18.631Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:05:18.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.631Z] Found existing entry
{
  "key": "login:test-block-1765321518631",
  "timestampCount": 1
}
[2025-12-09T23:05:18.631Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:05:18.631Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:05:18.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.632Z] Found existing entry
{
  "key": "login:test-block-1765321518631",
  "timestampCount": 2
}
[2025-12-09T23:05:18.632Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:05:18.632Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:05:18.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.632Z] Found existing entry
{
  "key": "login:test-block-1765321518631",
  "timestampCount": 3
}
[2025-12-09T23:05:18.632Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:05:18.632Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:05:18.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.632Z] Found existing entry
{
  "key": "login:test-block-1765321518631",
  "timestampCount": 4
}
[2025-12-09T23:05:18.632Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:05:18.632Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:05:18.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765321518631",
  "key": "login:test-block-1765321518631"
}
[2025-12-09T23:05:18.632Z] Found existing entry
{
  "key": "login:test-block-1765321518631",
  "timestampCount": 5
}
[2025-12-09T23:05:18.632Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:05:18.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765321518632",
  "key": "test-reset:test-reset-1765321518632"
}
[2025-12-09T23:05:18.632Z] Creating new entry
{
  "key": "test-reset:test-reset-1765321518632"
}
[2025-12-09T23:05:18.632Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:05:18.633Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:05:18.633Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765321518632",
  "key": "test-reset:test-reset-1765321518632"
}
[2025-12-09T23:05:18.633Z] Found existing entry
{
  "key": "test-reset:test-reset-1765321518632",
  "timestampCount": 1
}
[2025-12-09T23:05:18.633Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T23:05:18.633Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T23:05:18.633Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765321518632",
  "key": "test-reset:test-reset-1765321518632"
}
[2025-12-09T23:05:18.633Z] Found existing entry
{
  "key": "test-reset:test-reset-1765321518632",
  "timestampCount": 2
}
[2025-12-09T23:05:18.633Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T23:05:18.784Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765321518632",
  "key": "test-reset:test-reset-1765321518632"
}
[2025-12-09T23:05:18.784Z] Found existing entry
{
  "key": "test-reset:test-reset-1765321518632",
  "timestampCount": 2
}
[2025-12-09T23:05:18.784Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T23:05:18.784Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:05:18.784Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Creating new entry
{
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Found existing entry
{
  "key": "login:test-multi-1-1765321518785",
  "timestampCount": 1
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Found existing entry
{
  "key": "login:test-multi-1-1765321518785",
  "timestampCount": 2
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Found existing entry
{
  "key": "login:test-multi-1-1765321518785",
  "timestampCount": 3
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Found existing entry
{
  "key": "login:test-multi-1-1765321518785",
  "timestampCount": 4
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765321518785",
  "key": "login:test-multi-1-1765321518785"
}
[2025-12-09T23:05:18.785Z] Found existing entry
{
  "key": "login:test-multi-1-1765321518785",
  "timestampCount": 5
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765321518785",
  "key": "login:test-multi-2-1765321518785"
}
[2025-12-09T23:05:18.785Z] Creating new entry
{
  "key": "login:test-multi-2-1765321518785"
}
[2025-12-09T23:05:18.785Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:05:18.785Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:05:18.786Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765321518786",
  "key": "login:test-reset-time-1765321518786"
}
[2025-12-09T23:05:18.786Z] Creating new entry
{
  "key": "login:test-reset-time-1765321518786"
}
[2025-12-09T23:05:18.786Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:05:18.786Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:05:18.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:05:18.787Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:05:18.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:05:18.787Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T23:05:18.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:05:18.787Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:05:18.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:05:18.787Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:05:18.788Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:05:18.788Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:05:18.788Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765321518788",
  "key": "test-sliding:test-sliding-1765321518788"
}
[2025-12-09T23:05:18.788Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765321518788"
}
[2025-12-09T23:05:18.788Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:05:18.788Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:05:18.888Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765321518788",
  "key": "test-sliding:test-sliding-1765321518788"
}
[2025-12-09T23:05:18.888Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765321518788",
  "timestampCount": 1
}
[2025-12-09T23:05:18.888Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:05:18.888Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:05:18.988Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765321518788",
  "key": "test-sliding:test-sliding-1765321518788"
}
[2025-12-09T23:05:18.988Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765321518788",
  "timestampCount": 2
}
[2025-12-09T23:05:18.988Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T23:05:18.988Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:05:18.988Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:05:18.989Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765321518989",
  "key": "register:test-format-allowed-1765321518989"
}
[2025-12-09T23:05:18.989Z] Creating new entry
{
  "key": "register:test-format-allowed-1765321518989"
}
[2025-12-09T23:05:18.989Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:05:18.989Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:05:18.989Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765321518989",
  "key": "register:test-format-blocked-1765321518989"
}
[2025-12-09T23:05:18.989Z] Creating new entry
{
  "key": "register:test-format-blocked-1765321518989"
}
[2025-12-09T23:05:18.989Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:05:18.989Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:05:18.989Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765321518989",
  "key": "register:test-format-blocked-1765321518989"
}
[2025-12-09T23:05:18.989Z] Found existing entry
{
  "key": "register:test-format-blocked-1765321518989",
  "timestampCount": 1
}
[2025-12-09T23:05:18.989Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:05:18.989Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:05:18.989Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765321518989",
  "key": "register:test-format-blocked-1765321518989"
}
[2025-12-09T23:05:18.989Z] Found existing entry
{
  "key": "register:test-format-blocked-1765321518989",
  "timestampCount": 2
}
[2025-12-09T23:05:18.989Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T23:05:18.989Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T23:05:18.989Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765321518989",
  "key": "register:test-format-blocked-1765321518989"
}
[2025-12-09T23:05:18.989Z] Found existing entry
{
  "key": "register:test-format-blocked-1765321518989",
  "timestampCount": 3
}
[2025-12-09T23:05:18.989Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:17:20.575Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322240575",
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.576Z] Creating new entry
{
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.576Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:17:20.576Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:17:20.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322240575",
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.576Z] Found existing entry
{
  "key": "login:test-allow-1765322240575",
  "timestampCount": 1
}
[2025-12-09T23:17:20.576Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:17:20.576Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:17:20.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322240575",
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.577Z] Found existing entry
{
  "key": "login:test-allow-1765322240575",
  "timestampCount": 2
}
[2025-12-09T23:17:20.577Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:17:20.577Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:17:20.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322240575",
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.577Z] Found existing entry
{
  "key": "login:test-allow-1765322240575",
  "timestampCount": 3
}
[2025-12-09T23:17:20.577Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:17:20.577Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:17:20.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322240575",
  "key": "login:test-allow-1765322240575"
}
[2025-12-09T23:17:20.577Z] Found existing entry
{
  "key": "login:test-allow-1765322240575",
  "timestampCount": 4
}
[2025-12-09T23:17:20.577Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:17:20.577Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:17:20.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.577Z] Creating new entry
{
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.577Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:17:20.577Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:17:20.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.578Z] Found existing entry
{
  "key": "login:test-block-1765322240577",
  "timestampCount": 1
}
[2025-12-09T23:17:20.578Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:17:20.578Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:17:20.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.578Z] Found existing entry
{
  "key": "login:test-block-1765322240577",
  "timestampCount": 2
}
[2025-12-09T23:17:20.578Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:17:20.578Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:17:20.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.578Z] Found existing entry
{
  "key": "login:test-block-1765322240577",
  "timestampCount": 3
}
[2025-12-09T23:17:20.578Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:17:20.578Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:17:20.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.578Z] Found existing entry
{
  "key": "login:test-block-1765322240577",
  "timestampCount": 4
}
[2025-12-09T23:17:20.578Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:17:20.578Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:17:20.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322240577",
  "key": "login:test-block-1765322240577"
}
[2025-12-09T23:17:20.578Z] Found existing entry
{
  "key": "login:test-block-1765322240577",
  "timestampCount": 5
}
[2025-12-09T23:17:20.578Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:17:20.579Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322240579",
  "key": "test-reset:test-reset-1765322240579"
}
[2025-12-09T23:17:20.579Z] Creating new entry
{
  "key": "test-reset:test-reset-1765322240579"
}
[2025-12-09T23:17:20.579Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:17:20.579Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:17:20.579Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322240579",
  "key": "test-reset:test-reset-1765322240579"
}
[2025-12-09T23:17:20.579Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322240579",
  "timestampCount": 1
}
[2025-12-09T23:17:20.579Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T23:17:20.579Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T23:17:20.579Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322240579",
  "key": "test-reset:test-reset-1765322240579"
}
[2025-12-09T23:17:20.579Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322240579",
  "timestampCount": 2
}
[2025-12-09T23:17:20.579Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T23:17:20.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322240579",
  "key": "test-reset:test-reset-1765322240579"
}
[2025-12-09T23:17:20.731Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322240579",
  "timestampCount": 2
}
[2025-12-09T23:17:20.731Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T23:17:20.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:17:20.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:17:20.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.731Z] Creating new entry
{
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:17:20.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:17:20.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.731Z] Found existing entry
{
  "key": "login:test-multi-1-1765322240731",
  "timestampCount": 1
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:17:20.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.732Z] Found existing entry
{
  "key": "login:test-multi-1-1765322240731",
  "timestampCount": 2
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:17:20.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.732Z] Found existing entry
{
  "key": "login:test-multi-1-1765322240731",
  "timestampCount": 3
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:17:20.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.732Z] Found existing entry
{
  "key": "login:test-multi-1-1765322240731",
  "timestampCount": 4
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:17:20.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322240731",
  "key": "login:test-multi-1-1765322240731"
}
[2025-12-09T23:17:20.732Z] Found existing entry
{
  "key": "login:test-multi-1-1765322240731",
  "timestampCount": 5
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765322240731",
  "key": "login:test-multi-2-1765322240731"
}
[2025-12-09T23:17:20.732Z] Creating new entry
{
  "key": "login:test-multi-2-1765322240731"
}
[2025-12-09T23:17:20.732Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:17:20.732Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:17:20.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765322240733",
  "key": "login:test-reset-time-1765322240733"
}
[2025-12-09T23:17:20.733Z] Creating new entry
{
  "key": "login:test-reset-time-1765322240733"
}
[2025-12-09T23:17:20.733Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:17:20.733Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:17:20.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:17:20.734Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:17:20.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:17:20.734Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T23:17:20.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:17:20.734Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:17:20.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:17:20.734Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:17:20.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:17:20.734Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:17:20.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322240735",
  "key": "test-sliding:test-sliding-1765322240735"
}
[2025-12-09T23:17:20.735Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765322240735"
}
[2025-12-09T23:17:20.735Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:17:20.735Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:17:20.835Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322240735",
  "key": "test-sliding:test-sliding-1765322240735"
}
[2025-12-09T23:17:20.835Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322240735",
  "timestampCount": 1
}
[2025-12-09T23:17:20.835Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:17:20.835Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:17:20.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322240735",
  "key": "test-sliding:test-sliding-1765322240735"
}
[2025-12-09T23:17:20.937Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322240735",
  "timestampCount": 2
}
[2025-12-09T23:17:20.937Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T23:17:20.937Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:17:20.937Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:17:20.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765322240937",
  "key": "register:test-format-allowed-1765322240937"
}
[2025-12-09T23:17:20.937Z] Creating new entry
{
  "key": "register:test-format-allowed-1765322240937"
}
[2025-12-09T23:17:20.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:17:20.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:17:20.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322240937",
  "key": "register:test-format-blocked-1765322240937"
}
[2025-12-09T23:17:20.937Z] Creating new entry
{
  "key": "register:test-format-blocked-1765322240937"
}
[2025-12-09T23:17:20.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:17:20.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:17:20.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322240937",
  "key": "register:test-format-blocked-1765322240937"
}
[2025-12-09T23:17:20.937Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322240937",
  "timestampCount": 1
}
[2025-12-09T23:17:20.937Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:17:20.937Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:17:20.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322240937",
  "key": "register:test-format-blocked-1765322240937"
}
[2025-12-09T23:17:20.938Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322240937",
  "timestampCount": 2
}
[2025-12-09T23:17:20.938Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T23:17:20.938Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T23:17:20.938Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322240937",
  "key": "register:test-format-blocked-1765322240937"
}
[2025-12-09T23:17:20.938Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322240937",
  "timestampCount": 3
}
[2025-12-09T23:17:20.938Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:19:20.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322360595",
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.596Z] Creating new entry
{
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.596Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:19:20.596Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:19:20.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322360595",
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.597Z] Found existing entry
{
  "key": "login:test-allow-1765322360595",
  "timestampCount": 1
}
[2025-12-09T23:19:20.597Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:19:20.597Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:19:20.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322360595",
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.597Z] Found existing entry
{
  "key": "login:test-allow-1765322360595",
  "timestampCount": 2
}
[2025-12-09T23:19:20.597Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:19:20.597Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:19:20.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322360595",
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.597Z] Found existing entry
{
  "key": "login:test-allow-1765322360595",
  "timestampCount": 3
}
[2025-12-09T23:19:20.597Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:19:20.597Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:19:20.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322360595",
  "key": "login:test-allow-1765322360595"
}
[2025-12-09T23:19:20.597Z] Found existing entry
{
  "key": "login:test-allow-1765322360595",
  "timestampCount": 4
}
[2025-12-09T23:19:20.597Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:19:20.597Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:19:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Creating new entry
{
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:19:20.598Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:19:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Found existing entry
{
  "key": "login:test-block-1765322360598",
  "timestampCount": 1
}
[2025-12-09T23:19:20.598Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:19:20.598Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:19:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Found existing entry
{
  "key": "login:test-block-1765322360598",
  "timestampCount": 2
}
[2025-12-09T23:19:20.598Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:19:20.598Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:19:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Found existing entry
{
  "key": "login:test-block-1765322360598",
  "timestampCount": 3
}
[2025-12-09T23:19:20.598Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:19:20.598Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:19:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.598Z] Found existing entry
{
  "key": "login:test-block-1765322360598",
  "timestampCount": 4
}
[2025-12-09T23:19:20.598Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:19:20.598Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:19:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322360598",
  "key": "login:test-block-1765322360598"
}
[2025-12-09T23:19:20.599Z] Found existing entry
{
  "key": "login:test-block-1765322360598",
  "timestampCount": 5
}
[2025-12-09T23:19:20.599Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:19:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322360599",
  "key": "test-reset:test-reset-1765322360599"
}
[2025-12-09T23:19:20.599Z] Creating new entry
{
  "key": "test-reset:test-reset-1765322360599"
}
[2025-12-09T23:19:20.599Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:19:20.599Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:19:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322360599",
  "key": "test-reset:test-reset-1765322360599"
}
[2025-12-09T23:19:20.599Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322360599",
  "timestampCount": 1
}
[2025-12-09T23:19:20.599Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T23:19:20.599Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T23:19:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322360599",
  "key": "test-reset:test-reset-1765322360599"
}
[2025-12-09T23:19:20.600Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322360599",
  "timestampCount": 2
}
[2025-12-09T23:19:20.600Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T23:19:20.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322360599",
  "key": "test-reset:test-reset-1765322360599"
}
[2025-12-09T23:19:20.750Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322360599",
  "timestampCount": 2
}
[2025-12-09T23:19:20.750Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T23:19:20.750Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:19:20.750Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Creating new entry
{
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:19:20.751Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Found existing entry
{
  "key": "login:test-multi-1-1765322360751",
  "timestampCount": 1
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:19:20.751Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Found existing entry
{
  "key": "login:test-multi-1-1765322360751",
  "timestampCount": 2
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:19:20.751Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Found existing entry
{
  "key": "login:test-multi-1-1765322360751",
  "timestampCount": 3
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:19:20.751Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Found existing entry
{
  "key": "login:test-multi-1-1765322360751",
  "timestampCount": 4
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:19:20.751Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:19:20.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322360751",
  "key": "login:test-multi-1-1765322360751"
}
[2025-12-09T23:19:20.751Z] Found existing entry
{
  "key": "login:test-multi-1-1765322360751",
  "timestampCount": 5
}
[2025-12-09T23:19:20.751Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:19:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765322360751",
  "key": "login:test-multi-2-1765322360751"
}
[2025-12-09T23:19:20.752Z] Creating new entry
{
  "key": "login:test-multi-2-1765322360751"
}
[2025-12-09T23:19:20.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:19:20.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:19:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765322360752",
  "key": "login:test-reset-time-1765322360752"
}
[2025-12-09T23:19:20.752Z] Creating new entry
{
  "key": "login:test-reset-time-1765322360752"
}
[2025-12-09T23:19:20.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:19:20.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:19:20.753Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:19:20.753Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:19:20.753Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:19:20.753Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T23:19:20.753Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:19:20.753Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:19:20.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:19:20.754Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:19:20.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:19:20.754Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:19:20.754Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322360754",
  "key": "test-sliding:test-sliding-1765322360754"
}
[2025-12-09T23:19:20.754Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765322360754"
}
[2025-12-09T23:19:20.754Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:19:20.754Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:19:20.854Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322360754",
  "key": "test-sliding:test-sliding-1765322360754"
}
[2025-12-09T23:19:20.854Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322360754",
  "timestampCount": 1
}
[2025-12-09T23:19:20.854Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:19:20.854Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:19:20.955Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322360754",
  "key": "test-sliding:test-sliding-1765322360754"
}
[2025-12-09T23:19:20.955Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322360754",
  "timestampCount": 2
}
[2025-12-09T23:19:20.955Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T23:19:20.955Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:19:20.955Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:19:20.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765322360956",
  "key": "register:test-format-allowed-1765322360956"
}
[2025-12-09T23:19:20.956Z] Creating new entry
{
  "key": "register:test-format-allowed-1765322360956"
}
[2025-12-09T23:19:20.956Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:19:20.956Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:19:20.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322360956",
  "key": "register:test-format-blocked-1765322360956"
}
[2025-12-09T23:19:20.956Z] Creating new entry
{
  "key": "register:test-format-blocked-1765322360956"
}
[2025-12-09T23:19:20.956Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:19:20.956Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:19:20.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322360956",
  "key": "register:test-format-blocked-1765322360956"
}
[2025-12-09T23:19:20.956Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322360956",
  "timestampCount": 1
}
[2025-12-09T23:19:20.956Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:19:20.956Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:19:20.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322360956",
  "key": "register:test-format-blocked-1765322360956"
}
[2025-12-09T23:19:20.956Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322360956",
  "timestampCount": 2
}
[2025-12-09T23:19:20.956Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T23:19:20.956Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T23:19:20.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322360956",
  "key": "register:test-format-blocked-1765322360956"
}
[2025-12-09T23:19:20.956Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322360956",
  "timestampCount": 3
}
[2025-12-09T23:19:20.956Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:23:19.863Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322599863",
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.863Z] Creating new entry
{
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.864Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:23:19.864Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:23:19.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322599863",
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.864Z] Found existing entry
{
  "key": "login:test-allow-1765322599863",
  "timestampCount": 1
}
[2025-12-09T23:23:19.864Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:23:19.864Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:23:19.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322599863",
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.864Z] Found existing entry
{
  "key": "login:test-allow-1765322599863",
  "timestampCount": 2
}
[2025-12-09T23:23:19.864Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:23:19.864Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:23:19.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322599863",
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.864Z] Found existing entry
{
  "key": "login:test-allow-1765322599863",
  "timestampCount": 3
}
[2025-12-09T23:23:19.864Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:23:19.864Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:23:19.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765322599863",
  "key": "login:test-allow-1765322599863"
}
[2025-12-09T23:23:19.864Z] Found existing entry
{
  "key": "login:test-allow-1765322599863",
  "timestampCount": 4
}
[2025-12-09T23:23:19.864Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:23:19.864Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Creating new entry
{
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:23:19.865Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Found existing entry
{
  "key": "login:test-block-1765322599865",
  "timestampCount": 1
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:23:19.865Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Found existing entry
{
  "key": "login:test-block-1765322599865",
  "timestampCount": 2
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:23:19.865Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Found existing entry
{
  "key": "login:test-block-1765322599865",
  "timestampCount": 3
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:23:19.865Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Found existing entry
{
  "key": "login:test-block-1765322599865",
  "timestampCount": 4
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:23:19.865Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:23:19.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765322599865",
  "key": "login:test-block-1765322599865"
}
[2025-12-09T23:23:19.865Z] Found existing entry
{
  "key": "login:test-block-1765322599865",
  "timestampCount": 5
}
[2025-12-09T23:23:19.865Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:23:19.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322599866",
  "key": "test-reset:test-reset-1765322599866"
}
[2025-12-09T23:23:19.866Z] Creating new entry
{
  "key": "test-reset:test-reset-1765322599866"
}
[2025-12-09T23:23:19.866Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:23:19.866Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:23:19.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322599866",
  "key": "test-reset:test-reset-1765322599866"
}
[2025-12-09T23:23:19.866Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322599866",
  "timestampCount": 1
}
[2025-12-09T23:23:19.866Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-09T23:23:19.866Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-09T23:23:19.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322599866",
  "key": "test-reset:test-reset-1765322599866"
}
[2025-12-09T23:23:19.866Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322599866",
  "timestampCount": 2
}
[2025-12-09T23:23:19.866Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-09T23:23:20.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765322599866",
  "key": "test-reset:test-reset-1765322599866"
}
[2025-12-09T23:23:20.018Z] Found existing entry
{
  "key": "test-reset:test-reset-1765322599866",
  "timestampCount": 2
}
[2025-12-09T23:23:20.018Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-09T23:23:20.018Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-09T23:23:20.018Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Creating new entry
{
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Found existing entry
{
  "key": "login:test-multi-1-1765322600019",
  "timestampCount": 1
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Found existing entry
{
  "key": "login:test-multi-1-1765322600019",
  "timestampCount": 2
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Found existing entry
{
  "key": "login:test-multi-1-1765322600019",
  "timestampCount": 3
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Found existing entry
{
  "key": "login:test-multi-1-1765322600019",
  "timestampCount": 4
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765322600019",
  "key": "login:test-multi-1-1765322600019"
}
[2025-12-09T23:23:20.019Z] Found existing entry
{
  "key": "login:test-multi-1-1765322600019",
  "timestampCount": 5
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765322600019",
  "key": "login:test-multi-2-1765322600019"
}
[2025-12-09T23:23:20.019Z] Creating new entry
{
  "key": "login:test-multi-2-1765322600019"
}
[2025-12-09T23:23:20.019Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:23:20.019Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:23:20.019Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765322600019",
  "key": "login:test-reset-time-1765322600019"
}
[2025-12-09T23:23:20.020Z] Creating new entry
{
  "key": "login:test-reset-time-1765322600019"
}
[2025-12-09T23:23:20.020Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:23:20.020Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:23:20.021Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:20.021Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:23:20.021Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:20.021Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-09T23:23:20.021Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:20.021Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:23:20.021Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:20.021Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:20.022Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:20.022Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-09T23:23:20.022Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322600022",
  "key": "test-sliding:test-sliding-1765322600022"
}
[2025-12-09T23:23:20.022Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765322600022"
}
[2025-12-09T23:23:20.022Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:23:20.022Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:23:20.121Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322600022",
  "key": "test-sliding:test-sliding-1765322600022"
}
[2025-12-09T23:23:20.122Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322600022",
  "timestampCount": 1
}
[2025-12-09T23:23:20.122Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:23:20.122Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:23:20.224Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765322600022",
  "key": "test-sliding:test-sliding-1765322600022"
}
[2025-12-09T23:23:20.224Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765322600022",
  "timestampCount": 2
}
[2025-12-09T23:23:20.224Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-09T23:23:20.225Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:23:20.225Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:23:20.225Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765322600225",
  "key": "register:test-format-allowed-1765322600225"
}
[2025-12-09T23:23:20.225Z] Creating new entry
{
  "key": "register:test-format-allowed-1765322600225"
}
[2025-12-09T23:23:20.225Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:23:20.225Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:23:20.226Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322600226",
  "key": "register:test-format-blocked-1765322600226"
}
[2025-12-09T23:23:20.226Z] Creating new entry
{
  "key": "register:test-format-blocked-1765322600226"
}
[2025-12-09T23:23:20.226Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:23:20.226Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:23:20.226Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322600226",
  "key": "register:test-format-blocked-1765322600226"
}
[2025-12-09T23:23:20.226Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322600226",
  "timestampCount": 1
}
[2025-12-09T23:23:20.226Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:23:20.226Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:23:20.226Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322600226",
  "key": "register:test-format-blocked-1765322600226"
}
[2025-12-09T23:23:20.226Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322600226",
  "timestampCount": 2
}
[2025-12-09T23:23:20.226Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T23:23:20.226Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T23:23:20.226Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765322600226",
  "key": "register:test-format-blocked-1765322600226"
}
[2025-12-09T23:23:20.226Z] Found existing entry
{
  "key": "register:test-format-blocked-1765322600226",
  "timestampCount": 3
}
[2025-12-09T23:23:20.226Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:23:38.853Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:38.854Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:38.854Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:38.854Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:38.854Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-09T23:23:38.854Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-09T23:23:38.854Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-09T23:23:38.854Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:23:38.868Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:38.868Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:38.868Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:38.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:38.868Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-09T23:23:38.868Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-09T23:23:38.868Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-09T23:23:38.869Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:23:39.445Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:39.445Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:39.445Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:39.445Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:39.445Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-09T23:23:39.446Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-09T23:23:39.446Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-09T23:23:39.446Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:23:39.731Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:39.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:39.732Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:39.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:39.732Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-09T23:23:39.732Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-09T23:23:39.732Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-09T23:23:39.732Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:23:39.733Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:39.733Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:39.734Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:39.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:39.734Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-09T23:23:39.734Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-09T23:23:39.734Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-09T23:23:39.734Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:23:40.304Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-09T23:23:40.304Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:23:40.305Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:23:40.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-09T23:23:40.305Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-09T23:23:40.305Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-09T23:23:40.305Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-09T23:23:40.305Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-09T23:24:38.854Z"
  }
}
[2025-12-09T23:24:08.455Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-09T23:24:08.455Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:24:08.455Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:24:08.455Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-09T23:24:08.455Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-09T23:24:08.455Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:08.455Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:08.456Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:08.455Z"
  }
}
[2025-12-09T23:24:08.521Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-09T23:24:08.521Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-09T23:24:08.522Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-09T23:24:08.522Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-09T23:24:08.522Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-09T23:24:08.522Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:08.522Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:08.522Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:08.455Z"
  }
}
[2025-12-09T23:24:09.535Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:09.535Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1765322649491-dufoo",
  "willUseTestId": true
}
[2025-12-09T23:24:09.535Z] Using test identifier
{
  "identifier": "test:login-headers-1765322649491-dufoo"
}
[2025-12-09T23:24:09.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1765322649491-dufoo",
  "key": "login:test:login-headers-1765322649491-dufoo"
}
[2025-12-09T23:24:09.535Z] Creating new entry
{
  "key": "login:test:login-headers-1765322649491-dufoo"
}
[2025-12-09T23:24:09.535Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:09.536Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:09.536Z] Rate limit check result
{
  "identifier": "test:login-headers-1765322649491-dufoo",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:09.535Z"
  }
}
[2025-12-09T23:24:09.842Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:09.842Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:09.843Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:09.843Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:09.843Z] Creating new entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:09.843Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:09.843Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:09.843Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:10.107Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:10.107Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.107Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.107Z] Creating new entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.107Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:10.107Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:10.107Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:10.111Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.111Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:10.111Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.111Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8",
  "timestampCount": 1
}
[2025-12-09T23:24:10.111Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:10.111Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:10.111Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:10.345Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.345Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:10.345Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.345Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.345Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8",
  "timestampCount": 2
}
[2025-12-09T23:24:10.346Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:24:10.346Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:24:10.346Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:10.392Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:10.392Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.392Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.392Z] Found existing entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9",
  "timestampCount": 1
}
[2025-12-09T23:24:10.392Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:10.392Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:10.392Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:10.606Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.606Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:10.606Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.606Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8",
  "timestampCount": 3
}
[2025-12-09T23:24:10.607Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:24:10.607Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:24:10.607Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:10.686Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.686Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:10.686Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.686Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.686Z] Found existing entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9",
  "timestampCount": 2
}
[2025-12-09T23:24:10.686Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:24:10.686Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:24:10.687Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:10.861Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.861Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:10.861Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:10.862Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8",
  "timestampCount": 4
}
[2025-12-09T23:24:10.862Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:24:10.862Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:24:10.862Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:10.977Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:10.978Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:10.978Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.978Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:10.978Z] Found existing entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9",
  "timestampCount": 3
}
[2025-12-09T23:24:10.978Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:24:10.978Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:24:10.978Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:11.113Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.113Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765322649840-ynvvm8",
  "willUseTestId": true
}
[2025-12-09T23:24:11.114Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:11.114Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "key": "login:test:login-retry-after-1765322649840-ynvvm8"
}
[2025-12-09T23:24:11.114Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765322649840-ynvvm8",
  "timestampCount": 5
}
[2025-12-09T23:24:11.114Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:24:11.116Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765322649840-ynvvm8",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:09.843Z"
  }
}
[2025-12-09T23:24:11.153Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:11.153Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1765322651138-nwohnl",
  "willUseTestId": true
}
[2025-12-09T23:24:11.154Z] Using test identifier
{
  "identifier": "test:register-headers-1765322651138-nwohnl"
}
[2025-12-09T23:24:11.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1765322651138-nwohnl",
  "key": "register:test:register-headers-1765322651138-nwohnl"
}
[2025-12-09T23:24:11.154Z] Creating new entry
{
  "key": "register:test:register-headers-1765322651138-nwohnl"
}
[2025-12-09T23:24:11.154Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:24:11.154Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:24:11.154Z] Rate limit check result
{
  "identifier": "test:register-headers-1765322651138-nwohnl",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:11.154Z"
  }
}
[2025-12-09T23:24:11.227Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:11.227Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765322651105-agjf37k",
  "willUseTestId": true
}
[2025-12-09T23:24:11.227Z] Using test identifier
{
  "identifier": "test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.227Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "key": "register:test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.227Z] Creating new entry
{
  "key": "register:test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.228Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:24:11.228Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:24:11.228Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:11.227Z"
  }
}
[2025-12-09T23:24:11.268Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:11.268Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:11.268Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:11.268Z] Found existing entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9",
  "timestampCount": 4
}
[2025-12-09T23:24:11.268Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:24:11.268Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:24:11.268Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:11.568Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.568Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765322650092-l02v9",
  "willUseTestId": true
}
[2025-12-09T23:24:11.568Z] Using test identifier
{
  "identifier": "test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:11.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "key": "login:test:login-excessive-1765322650092-l02v9"
}
[2025-12-09T23:24:11.568Z] Found existing entry
{
  "key": "login:test:login-excessive-1765322650092-l02v9",
  "timestampCount": 5
}
[2025-12-09T23:24:11.569Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:24:11.569Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765322650092-l02v9",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:10.107Z"
  }
}
[2025-12-09T23:24:11.624Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:11.625Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765322651105-agjf37k",
  "willUseTestId": true
}
[2025-12-09T23:24:11.625Z] Using test identifier
{
  "identifier": "test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.625Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "key": "register:test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.625Z] Found existing entry
{
  "key": "register:test:register-excessive-1765322651105-agjf37k",
  "timestampCount": 1
}
[2025-12-09T23:24:11.625Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-09T23:24:11.625Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-09T23:24:11.625Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-09T23:25:11.227Z"
  }
}
[2025-12-09T23:24:11.633Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.633Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:11.633Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:11.633Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:11.634Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:11.634Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:11.634Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:11.634Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:11.826Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.827Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765322651809-4f0v",
  "willUseTestId": true
}
[2025-12-09T23:24:11.827Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:11.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "key": "login:test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:11.827Z] Creating new entry
{
  "key": "login:test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:11.827Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:11.827Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:11.827Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:11.827Z"
  }
}
[2025-12-09T23:24:11.853Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:11.853Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:11.853Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:11.853Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:11.853Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4",
  "timestampCount": 1
}
[2025-12-09T23:24:11.853Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:11.853Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:11.854Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:11.945Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:11.945Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765322651105-agjf37k",
  "willUseTestId": true
}
[2025-12-09T23:24:11.945Z] Using test identifier
{
  "identifier": "test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.946Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "key": "register:test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:11.946Z] Found existing entry
{
  "key": "register:test:register-excessive-1765322651105-agjf37k",
  "timestampCount": 2
}
[2025-12-09T23:24:11.946Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-09T23:24:11.946Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-09T23:24:11.946Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:11.227Z"
  }
}
[2025-12-09T23:24:12.057Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.058Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765322651809-4f0v",
  "willUseTestId": true
}
[2025-12-09T23:24:12.058Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:12.058Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "key": "login:test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:12.058Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765322651809-4f0v",
  "timestampCount": 1
}
[2025-12-09T23:24:12.058Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:12.058Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:12.058Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:11.827Z"
  }
}
[2025-12-09T23:24:12.104Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:12.104Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.104Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4",
  "timestampCount": 2
}
[2025-12-09T23:24:12.104Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:24:12.104Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:24:12.104Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:12.249Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:12.249Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765322651105-agjf37k",
  "willUseTestId": true
}
[2025-12-09T23:24:12.249Z] Using test identifier
{
  "identifier": "test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:12.250Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "key": "register:test:register-excessive-1765322651105-agjf37k"
}
[2025-12-09T23:24:12.250Z] Found existing entry
{
  "key": "register:test:register-excessive-1765322651105-agjf37k",
  "timestampCount": 3
}
[2025-12-09T23:24:12.250Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-09T23:24:12.250Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765322651105-agjf37k",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:11.227Z"
  }
}
[2025-12-09T23:24:12.273Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.273Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765322652269-z87rbc",
  "willUseTestId": true
}
[2025-12-09T23:24:12.273Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765322652269-z87rbc"
}
[2025-12-09T23:24:12.274Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765322652269-z87rbc",
  "key": "login:test:headers-consistent-1765322652269-z87rbc"
}
[2025-12-09T23:24:12.274Z] Creating new entry
{
  "key": "login:test:headers-consistent-1765322652269-z87rbc"
}
[2025-12-09T23:24:12.274Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:12.274Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:12.274Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765322652269-z87rbc",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:12.274Z"
  }
}
[2025-12-09T23:24:12.282Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.282Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765322651809-4f0v",
  "willUseTestId": true
}
[2025-12-09T23:24:12.282Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:12.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "key": "login:test:headers-remaining-1765322651809-4f0v"
}
[2025-12-09T23:24:12.283Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765322651809-4f0v",
  "timestampCount": 2
}
[2025-12-09T23:24:12.283Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-09T23:24:12.283Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-09T23:24:12.283Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765322651809-4f0v",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:11.827Z"
  }
}
[2025-12-09T23:24:12.318Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.319Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:12.319Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.319Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.319Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4",
  "timestampCount": 3
}
[2025-12-09T23:24:12.319Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-09T23:24:12.319Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-09T23:24:12.319Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:12.523Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.523Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765322652269-z87rbc",
  "willUseTestId": true
}
[2025-12-09T23:24:12.524Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765322652269-z87rbc"
}
[2025-12-09T23:24:12.524Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765322652269-z87rbc",
  "key": "login:test:headers-consistent-1765322652269-z87rbc"
}
[2025-12-09T23:24:12.524Z] Found existing entry
{
  "key": "login:test:headers-consistent-1765322652269-z87rbc",
  "timestampCount": 1
}
[2025-12-09T23:24:12.524Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-09T23:24:12.524Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-09T23:24:12.525Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765322652269-z87rbc",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-09T23:25:12.274Z"
  }
}
[2025-12-09T23:24:12.561Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.561Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:12.561Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.561Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.561Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4",
  "timestampCount": 4
}
[2025-12-09T23:24:12.561Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-09T23:24:12.561Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-09T23:24:12.562Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:12.711Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.711Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1765322652708-05xpl5",
  "willUseTestId": true
}
[2025-12-09T23:24:12.711Z] Using test identifier
{
  "identifier": "test:perf-test-1765322652708-05xpl5"
}
[2025-12-09T23:24:12.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1765322652708-05xpl5",
  "key": "login:test:perf-test-1765322652708-05xpl5"
}
[2025-12-09T23:24:12.711Z] Creating new entry
{
  "key": "login:test:perf-test-1765322652708-05xpl5"
}
[2025-12-09T23:24:12.712Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-09T23:24:12.712Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-09T23:24:12.712Z] Rate limit check result
{
  "identifier": "test:perf-test-1765322652708-05xpl5",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-09T23:25:12.711Z"
  }
}
[2025-12-09T23:24:12.800Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-09T23:24:12.801Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:12.801Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "login:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.801Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765322651629-71gx4",
  "timestampCount": 5
}
[2025-12-09T23:24:12.801Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-09T23:24:12.801Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-09T23:25:11.633Z"
  }
}
[2025-12-09T23:24:12.806Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-09T23:24:12.806Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765322651629-71gx4",
  "willUseTestId": true
}
[2025-12-09T23:24:12.806Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.806Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "key": "register:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.806Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1765322651629-71gx4"
}
[2025-12-09T23:24:12.806Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-09T23:24:12.806Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-09T23:24:12.806Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765322651629-71gx4",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-09T23:25:12.806Z"
  }
}
[2025-12-10T07:01:35.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765350095042",
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.042Z] Creating new entry
{
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.042Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T07:01:35.042Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T07:01:35.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765350095042",
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.043Z] Found existing entry
{
  "key": "login:test-allow-1765350095042",
  "timestampCount": 1
}
[2025-12-10T07:01:35.043Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T07:01:35.043Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T07:01:35.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765350095042",
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.043Z] Found existing entry
{
  "key": "login:test-allow-1765350095042",
  "timestampCount": 2
}
[2025-12-10T07:01:35.043Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T07:01:35.043Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T07:01:35.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765350095042",
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.043Z] Found existing entry
{
  "key": "login:test-allow-1765350095042",
  "timestampCount": 3
}
[2025-12-10T07:01:35.043Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T07:01:35.043Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765350095042",
  "key": "login:test-allow-1765350095042"
}
[2025-12-10T07:01:35.044Z] Found existing entry
{
  "key": "login:test-allow-1765350095042",
  "timestampCount": 4
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Creating new entry
{
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Found existing entry
{
  "key": "login:test-block-1765350095044",
  "timestampCount": 1
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Found existing entry
{
  "key": "login:test-block-1765350095044",
  "timestampCount": 2
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Found existing entry
{
  "key": "login:test-block-1765350095044",
  "timestampCount": 3
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.044Z] Found existing entry
{
  "key": "login:test-block-1765350095044",
  "timestampCount": 4
}
[2025-12-10T07:01:35.044Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T07:01:35.044Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T07:01:35.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765350095044",
  "key": "login:test-block-1765350095044"
}
[2025-12-10T07:01:35.045Z] Found existing entry
{
  "key": "login:test-block-1765350095044",
  "timestampCount": 5
}
[2025-12-10T07:01:35.045Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T07:01:35.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765350095045",
  "key": "test-reset:test-reset-1765350095045"
}
[2025-12-10T07:01:35.045Z] Creating new entry
{
  "key": "test-reset:test-reset-1765350095045"
}
[2025-12-10T07:01:35.045Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T07:01:35.045Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T07:01:35.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765350095045",
  "key": "test-reset:test-reset-1765350095045"
}
[2025-12-10T07:01:35.045Z] Found existing entry
{
  "key": "test-reset:test-reset-1765350095045",
  "timestampCount": 1
}
[2025-12-10T07:01:35.045Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T07:01:35.045Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T07:01:35.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765350095045",
  "key": "test-reset:test-reset-1765350095045"
}
[2025-12-10T07:01:35.045Z] Found existing entry
{
  "key": "test-reset:test-reset-1765350095045",
  "timestampCount": 2
}
[2025-12-10T07:01:35.045Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T07:01:35.197Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765350095045",
  "key": "test-reset:test-reset-1765350095045"
}
[2025-12-10T07:01:35.197Z] Found existing entry
{
  "key": "test-reset:test-reset-1765350095045",
  "timestampCount": 2
}
[2025-12-10T07:01:35.198Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Creating new entry
{
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Found existing entry
{
  "key": "login:test-multi-1-1765350095198",
  "timestampCount": 1
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Found existing entry
{
  "key": "login:test-multi-1-1765350095198",
  "timestampCount": 2
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Found existing entry
{
  "key": "login:test-multi-1-1765350095198",
  "timestampCount": 3
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Found existing entry
{
  "key": "login:test-multi-1-1765350095198",
  "timestampCount": 4
}
[2025-12-10T07:01:35.198Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T07:01:35.198Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T07:01:35.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765350095198",
  "key": "login:test-multi-1-1765350095198"
}
[2025-12-10T07:01:35.198Z] Found existing entry
{
  "key": "login:test-multi-1-1765350095198",
  "timestampCount": 5
}
[2025-12-10T07:01:35.199Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T07:01:35.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765350095198",
  "key": "login:test-multi-2-1765350095198"
}
[2025-12-10T07:01:35.199Z] Creating new entry
{
  "key": "login:test-multi-2-1765350095198"
}
[2025-12-10T07:01:35.199Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T07:01:35.199Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T07:01:35.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765350095199",
  "key": "login:test-reset-time-1765350095199"
}
[2025-12-10T07:01:35.199Z] Creating new entry
{
  "key": "login:test-reset-time-1765350095199"
}
[2025-12-10T07:01:35.199Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T07:01:35.199Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T07:01:35.200Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T07:01:35.200Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T07:01:35.200Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T07:01:35.200Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T07:01:35.201Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T07:01:35.201Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T07:01:35.201Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T07:01:35.201Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T07:01:35.201Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T07:01:35.201Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T07:01:35.201Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765350095201",
  "key": "test-sliding:test-sliding-1765350095201"
}
[2025-12-10T07:01:35.201Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765350095201"
}
[2025-12-10T07:01:35.201Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T07:01:35.201Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T07:01:35.301Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765350095201",
  "key": "test-sliding:test-sliding-1765350095201"
}
[2025-12-10T07:01:35.301Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765350095201",
  "timestampCount": 1
}
[2025-12-10T07:01:35.301Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T07:01:35.301Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T07:01:35.402Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765350095201",
  "key": "test-sliding:test-sliding-1765350095201"
}
[2025-12-10T07:01:35.402Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765350095201",
  "timestampCount": 2
}
[2025-12-10T07:01:35.402Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T07:01:35.402Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T07:01:35.402Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T07:01:35.402Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765350095402",
  "key": "register:test-format-allowed-1765350095402"
}
[2025-12-10T07:01:35.402Z] Creating new entry
{
  "key": "register:test-format-allowed-1765350095402"
}
[2025-12-10T07:01:35.403Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T07:01:35.403Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T07:01:35.403Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765350095403",
  "key": "register:test-format-blocked-1765350095403"
}
[2025-12-10T07:01:35.403Z] Creating new entry
{
  "key": "register:test-format-blocked-1765350095403"
}
[2025-12-10T07:01:35.403Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T07:01:35.403Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T07:01:35.403Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765350095403",
  "key": "register:test-format-blocked-1765350095403"
}
[2025-12-10T07:01:35.403Z] Found existing entry
{
  "key": "register:test-format-blocked-1765350095403",
  "timestampCount": 1
}
[2025-12-10T07:01:35.403Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T07:01:35.403Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T07:01:35.403Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765350095403",
  "key": "register:test-format-blocked-1765350095403"
}
[2025-12-10T07:01:35.403Z] Found existing entry
{
  "key": "register:test-format-blocked-1765350095403",
  "timestampCount": 2
}
[2025-12-10T07:01:35.403Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T07:01:35.403Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T07:01:35.404Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765350095403",
  "key": "register:test-format-blocked-1765350095403"
}
[2025-12-10T07:01:35.404Z] Found existing entry
{
  "key": "register:test-format-blocked-1765350095403",
  "timestampCount": 3
}
[2025-12-10T07:01:35.404Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:47:19.713Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356439713",
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.714Z] Creating new entry
{
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.714Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:19.714Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:19.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356439713",
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.715Z] Found existing entry
{
  "key": "login:test-allow-1765356439713",
  "timestampCount": 1
}
[2025-12-10T08:47:19.715Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:19.715Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:19.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356439713",
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.715Z] Found existing entry
{
  "key": "login:test-allow-1765356439713",
  "timestampCount": 2
}
[2025-12-10T08:47:19.715Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:19.715Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:19.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356439713",
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.715Z] Found existing entry
{
  "key": "login:test-allow-1765356439713",
  "timestampCount": 3
}
[2025-12-10T08:47:19.715Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:19.715Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:19.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356439713",
  "key": "login:test-allow-1765356439713"
}
[2025-12-10T08:47:19.716Z] Found existing entry
{
  "key": "login:test-allow-1765356439713",
  "timestampCount": 4
}
[2025-12-10T08:47:19.716Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:19.716Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:19.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.716Z] Creating new entry
{
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.716Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:19.716Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:19.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.716Z] Found existing entry
{
  "key": "login:test-block-1765356439716",
  "timestampCount": 1
}
[2025-12-10T08:47:19.716Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:19.716Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:19.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.716Z] Found existing entry
{
  "key": "login:test-block-1765356439716",
  "timestampCount": 2
}
[2025-12-10T08:47:19.716Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:19.716Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:19.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.716Z] Found existing entry
{
  "key": "login:test-block-1765356439716",
  "timestampCount": 3
}
[2025-12-10T08:47:19.717Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:19.717Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:19.717Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.717Z] Found existing entry
{
  "key": "login:test-block-1765356439716",
  "timestampCount": 4
}
[2025-12-10T08:47:19.717Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:19.717Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:19.717Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356439716",
  "key": "login:test-block-1765356439716"
}
[2025-12-10T08:47:19.717Z] Found existing entry
{
  "key": "login:test-block-1765356439716",
  "timestampCount": 5
}
[2025-12-10T08:47:19.717Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:19.717Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356439717",
  "key": "test-reset:test-reset-1765356439717"
}
[2025-12-10T08:47:19.717Z] Creating new entry
{
  "key": "test-reset:test-reset-1765356439717"
}
[2025-12-10T08:47:19.717Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:47:19.718Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:47:19.718Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356439717",
  "key": "test-reset:test-reset-1765356439717"
}
[2025-12-10T08:47:19.718Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356439717",
  "timestampCount": 1
}
[2025-12-10T08:47:19.718Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T08:47:19.718Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T08:47:19.718Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356439717",
  "key": "test-reset:test-reset-1765356439717"
}
[2025-12-10T08:47:19.718Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356439717",
  "timestampCount": 2
}
[2025-12-10T08:47:19.718Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T08:47:19.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356439717",
  "key": "test-reset:test-reset-1765356439717"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356439717",
  "timestampCount": 2
}
[2025-12-10T08:47:19.869Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Creating new entry
{
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "login:test-multi-1-1765356439869",
  "timestampCount": 1
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "login:test-multi-1-1765356439869",
  "timestampCount": 2
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "login:test-multi-1-1765356439869",
  "timestampCount": 3
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "login:test-multi-1-1765356439869",
  "timestampCount": 4
}
[2025-12-10T08:47:19.869Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:19.869Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:19.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356439869",
  "key": "login:test-multi-1-1765356439869"
}
[2025-12-10T08:47:19.869Z] Found existing entry
{
  "key": "login:test-multi-1-1765356439869",
  "timestampCount": 5
}
[2025-12-10T08:47:19.870Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:19.870Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765356439869",
  "key": "login:test-multi-2-1765356439869"
}
[2025-12-10T08:47:19.870Z] Creating new entry
{
  "key": "login:test-multi-2-1765356439869"
}
[2025-12-10T08:47:19.870Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:19.870Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:19.870Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765356439870",
  "key": "login:test-reset-time-1765356439870"
}
[2025-12-10T08:47:19.870Z] Creating new entry
{
  "key": "login:test-reset-time-1765356439870"
}
[2025-12-10T08:47:19.870Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:19.870Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:19.871Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:19.871Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:19.871Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:19.871Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T08:47:19.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:19.872Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:19.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:19.872Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:19.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:19.872Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:19.872Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356439872",
  "key": "test-sliding:test-sliding-1765356439872"
}
[2025-12-10T08:47:19.872Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765356439872"
}
[2025-12-10T08:47:19.872Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:19.872Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:28.699Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356448699",
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.699Z] Creating new entry
{
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.699Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:28.699Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:28.699Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356448699",
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.699Z] Found existing entry
{
  "key": "login:test-allow-1765356448699",
  "timestampCount": 1
}
[2025-12-10T08:47:28.699Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:28.700Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:28.700Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356448699",
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.700Z] Found existing entry
{
  "key": "login:test-allow-1765356448699",
  "timestampCount": 2
}
[2025-12-10T08:47:28.700Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:28.700Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:28.700Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356448699",
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.700Z] Found existing entry
{
  "key": "login:test-allow-1765356448699",
  "timestampCount": 3
}
[2025-12-10T08:47:28.700Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:28.700Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:28.700Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356448699",
  "key": "login:test-allow-1765356448699"
}
[2025-12-10T08:47:28.700Z] Found existing entry
{
  "key": "login:test-allow-1765356448699",
  "timestampCount": 4
}
[2025-12-10T08:47:28.700Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:28.700Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:28.700Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.700Z] Creating new entry
{
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.700Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:28.700Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:28.700Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.700Z] Found existing entry
{
  "key": "login:test-block-1765356448700",
  "timestampCount": 1
}
[2025-12-10T08:47:28.700Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:28.701Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:28.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.701Z] Found existing entry
{
  "key": "login:test-block-1765356448700",
  "timestampCount": 2
}
[2025-12-10T08:47:28.701Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:28.701Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:28.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.701Z] Found existing entry
{
  "key": "login:test-block-1765356448700",
  "timestampCount": 3
}
[2025-12-10T08:47:28.701Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:28.701Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:28.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.701Z] Found existing entry
{
  "key": "login:test-block-1765356448700",
  "timestampCount": 4
}
[2025-12-10T08:47:28.701Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:28.701Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:28.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356448700",
  "key": "login:test-block-1765356448700"
}
[2025-12-10T08:47:28.701Z] Found existing entry
{
  "key": "login:test-block-1765356448700",
  "timestampCount": 5
}
[2025-12-10T08:47:28.701Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:28.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356448702",
  "key": "test-reset:test-reset-1765356448702"
}
[2025-12-10T08:47:28.702Z] Creating new entry
{
  "key": "test-reset:test-reset-1765356448702"
}
[2025-12-10T08:47:28.702Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:47:28.702Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:47:28.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356448702",
  "key": "test-reset:test-reset-1765356448702"
}
[2025-12-10T08:47:28.702Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356448702",
  "timestampCount": 1
}
[2025-12-10T08:47:28.702Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T08:47:28.702Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T08:47:28.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356448702",
  "key": "test-reset:test-reset-1765356448702"
}
[2025-12-10T08:47:28.702Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356448702",
  "timestampCount": 2
}
[2025-12-10T08:47:28.702Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T08:47:28.853Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356448702",
  "key": "test-reset:test-reset-1765356448702"
}
[2025-12-10T08:47:28.854Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356448702",
  "timestampCount": 2
}
[2025-12-10T08:47:28.854Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T08:47:28.854Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:47:28.854Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:47:28.854Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.854Z] Creating new entry
{
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.855Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:28.855Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:28.855Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.855Z] Found existing entry
{
  "key": "login:test-multi-1-1765356448854",
  "timestampCount": 1
}
[2025-12-10T08:47:28.855Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:28.855Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:28.855Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.855Z] Found existing entry
{
  "key": "login:test-multi-1-1765356448854",
  "timestampCount": 2
}
[2025-12-10T08:47:28.855Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:28.855Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:28.855Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.855Z] Found existing entry
{
  "key": "login:test-multi-1-1765356448854",
  "timestampCount": 3
}
[2025-12-10T08:47:28.855Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:28.856Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:28.856Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.856Z] Found existing entry
{
  "key": "login:test-multi-1-1765356448854",
  "timestampCount": 4
}
[2025-12-10T08:47:28.856Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:28.856Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:28.856Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356448854",
  "key": "login:test-multi-1-1765356448854"
}
[2025-12-10T08:47:28.856Z] Found existing entry
{
  "key": "login:test-multi-1-1765356448854",
  "timestampCount": 5
}
[2025-12-10T08:47:28.856Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:28.856Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765356448854",
  "key": "login:test-multi-2-1765356448854"
}
[2025-12-10T08:47:28.857Z] Creating new entry
{
  "key": "login:test-multi-2-1765356448854"
}
[2025-12-10T08:47:28.857Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:28.857Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:28.857Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765356448857",
  "key": "login:test-reset-time-1765356448857"
}
[2025-12-10T08:47:28.857Z] Creating new entry
{
  "key": "login:test-reset-time-1765356448857"
}
[2025-12-10T08:47:28.857Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:28.858Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:28.859Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:28.859Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:28.860Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:28.860Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T08:47:28.860Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:28.860Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:28.860Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:28.860Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:28.860Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:28.860Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:47:28.860Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356448860",
  "key": "test-sliding:test-sliding-1765356448860"
}
[2025-12-10T08:47:28.860Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765356448860"
}
[2025-12-10T08:47:28.860Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:28.860Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:28.962Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356448860",
  "key": "test-sliding:test-sliding-1765356448860"
}
[2025-12-10T08:47:28.962Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356448860",
  "timestampCount": 1
}
[2025-12-10T08:47:28.962Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:47:28.962Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:47:29.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356448860",
  "key": "test-sliding:test-sliding-1765356448860"
}
[2025-12-10T08:47:29.064Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356448860",
  "timestampCount": 2
}
[2025-12-10T08:47:29.064Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T08:47:29.064Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:47:29.064Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:47:29.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765356449064",
  "key": "register:test-format-allowed-1765356449064"
}
[2025-12-10T08:47:29.064Z] Creating new entry
{
  "key": "register:test-format-allowed-1765356449064"
}
[2025-12-10T08:47:29.064Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:29.064Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:29.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356449064",
  "key": "register:test-format-blocked-1765356449064"
}
[2025-12-10T08:47:29.064Z] Creating new entry
{
  "key": "register:test-format-blocked-1765356449064"
}
[2025-12-10T08:47:29.064Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:29.064Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:29.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356449064",
  "key": "register:test-format-blocked-1765356449064"
}
[2025-12-10T08:47:29.065Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356449064",
  "timestampCount": 1
}
[2025-12-10T08:47:29.065Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:47:29.065Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:47:29.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356449064",
  "key": "register:test-format-blocked-1765356449064"
}
[2025-12-10T08:47:29.065Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356449064",
  "timestampCount": 2
}
[2025-12-10T08:47:29.065Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:47:29.065Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:47:29.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356449064",
  "key": "register:test-format-blocked-1765356449064"
}
[2025-12-10T08:47:29.065Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356449064",
  "timestampCount": 3
}
[2025-12-10T08:47:29.065Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:47:44.700Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:44.700Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:44.700Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:44.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:44.701Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-10T08:47:44.701Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-10T08:47:44.701Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-10T08:47:44.701Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:44.703Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:44.703Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:44.703Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:44.703Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:44.703Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-10T08:47:44.703Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-10T08:47:44.703Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-10T08:47:44.703Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:45.383Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:45.384Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:45.384Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:45.384Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:45.384Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-10T08:47:45.384Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-10T08:47:45.384Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-10T08:47:45.384Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:45.388Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:45.388Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:45.388Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:45.388Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:45.388Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-10T08:47:45.388Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-10T08:47:45.388Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-10T08:47:45.388Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:47.544Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:47.544Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:47.544Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:47.544Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:47.544Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-10T08:47:47.544Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-10T08:47:47.544Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-10T08:47:47.544Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:48.129Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:47:48.129Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:48.129Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:48.129Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:47:48.129Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-10T08:47:48.129Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-10T08:47:48.129Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-10T08:47:48.129Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-10T08:48:44.701Z"
  }
}
[2025-12-10T08:47:48.246Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:47:48.246Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:48.246Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:48.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:47:48.246Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T08:47:48.246Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:48.246Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:48.247Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:48.246Z"
  }
}
[2025-12-10T08:47:48.249Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:48.249Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:48.249Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:48.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:47:48.249Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T08:47:48.249Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:48.249Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:48.249Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:48.249Z"
  }
}
[2025-12-10T08:47:49.045Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T08:47:49.045Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:49.045Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:49.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:47:49.045Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T08:47:49.045Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:49.045Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:49.045Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:48.246Z"
  }
}
[2025-12-10T08:47:49.109Z] withRateLimit called
{
  "endpoint": "logout",
  "requestUrl": "/logout"
}
[2025-12-10T08:47:49.110Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:49.110Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:49.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "logout",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "logout:unknown"
}
[2025-12-10T08:47:49.110Z] Creating new entry
{
  "key": "logout:unknown"
}
[2025-12-10T08:47:49.110Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:49.110Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:49.110Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:49.110Z"
  }
}
[2025-12-10T08:47:51.201Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.201Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1765356471187-g1wv9",
  "willUseTestId": true
}
[2025-12-10T08:47:51.201Z] Using test identifier
{
  "identifier": "test:login-headers-1765356471187-g1wv9"
}
[2025-12-10T08:47:51.201Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1765356471187-g1wv9",
  "key": "login:test:login-headers-1765356471187-g1wv9"
}
[2025-12-10T08:47:51.201Z] Creating new entry
{
  "key": "login:test:login-headers-1765356471187-g1wv9"
}
[2025-12-10T08:47:51.201Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:51.201Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:51.201Z] Rate limit check result
{
  "identifier": "test:login-headers-1765356471187-g1wv9",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:51.201Z"
  }
}
[2025-12-10T08:47:51.375Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.375Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:51.376Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.376Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.376Z] Creating new entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.376Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:51.376Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:51.376Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:51.462Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.462Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:51.463Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.463Z] Creating new entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.463Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:51.463Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:51.463Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:51.628Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.628Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:51.628Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.628Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.629Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c",
  "timestampCount": 1
}
[2025-12-10T08:47:51.629Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:51.629Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:51.629Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:51.685Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.685Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:51.685Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.685Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.685Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1",
  "timestampCount": 1
}
[2025-12-10T08:47:51.685Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:51.685Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:51.685Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:51.895Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.896Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:51.896Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.896Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:51.896Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c",
  "timestampCount": 2
}
[2025-12-10T08:47:51.896Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:51.896Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:51.896Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:51.899Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:51.899Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:51.900Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:51.900Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1",
  "timestampCount": 2
}
[2025-12-10T08:47:51.900Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:51.900Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:51.900Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:52.119Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.119Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:52.119Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.119Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1",
  "timestampCount": 3
}
[2025-12-10T08:47:52.119Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:52.119Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:52.119Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:52.179Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.180Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:52.180Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.180Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.180Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c",
  "timestampCount": 3
}
[2025-12-10T08:47:52.180Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:52.180Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:52.180Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:52.354Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.355Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:52.355Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.355Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.355Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1",
  "timestampCount": 4
}
[2025-12-10T08:47:52.355Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:52.355Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:52.355Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:52.459Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.459Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:52.459Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.459Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c",
  "timestampCount": 4
}
[2025-12-10T08:47:52.459Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:52.459Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:52.459Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:52.548Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.548Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356471461-j10v1",
  "willUseTestId": true
}
[2025-12-10T08:47:52.548Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.548Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "key": "login:test:login-retry-after-1765356471461-j10v1"
}
[2025-12-10T08:47:52.548Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356471461-j10v1",
  "timestampCount": 5
}
[2025-12-10T08:47:52.548Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:52.548Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356471461-j10v1",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:51.463Z"
  }
}
[2025-12-10T08:47:52.558Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:52.558Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1765356472557-udn6wv",
  "willUseTestId": true
}
[2025-12-10T08:47:52.558Z] Using test identifier
{
  "identifier": "test:register-headers-1765356472557-udn6wv"
}
[2025-12-10T08:47:52.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1765356472557-udn6wv",
  "key": "register:test:register-headers-1765356472557-udn6wv"
}
[2025-12-10T08:47:52.559Z] Creating new entry
{
  "key": "register:test:register-headers-1765356472557-udn6wv"
}
[2025-12-10T08:47:52.559Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:52.559Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:52.559Z] Rate limit check result
{
  "identifier": "test:register-headers-1765356472557-udn6wv",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:52.558Z"
  }
}
[2025-12-10T08:47:52.720Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.720Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356471366-bu4z7c",
  "willUseTestId": true
}
[2025-12-10T08:47:52.720Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.721Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "key": "login:test:login-excessive-1765356471366-bu4z7c"
}
[2025-12-10T08:47:52.721Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356471366-bu4z7c",
  "timestampCount": 5
}
[2025-12-10T08:47:52.721Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:52.721Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356471366-bu4z7c",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:51.376Z"
  }
}
[2025-12-10T08:47:52.776Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:52.776Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:52.777Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:52.777Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:52.777Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:52.777Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:52.777Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:52.818Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:52.818Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356472809-zvt9a",
  "willUseTestId": true
}
[2025-12-10T08:47:52.818Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:52.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "key": "register:test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:52.818Z] Creating new entry
{
  "key": "register:test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:52.818Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:52.819Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:52.819Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:52.818Z"
  }
}
[2025-12-10T08:47:52.874Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.874Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356472872-qx1gqm",
  "willUseTestId": true
}
[2025-12-10T08:47:52.874Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:52.875Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "key": "login:test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:52.875Z] Creating new entry
{
  "key": "login:test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:52.875Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:52.875Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:52.875Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:52.875Z"
  }
}
[2025-12-10T08:47:52.982Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:52.982Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:52.982Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:52.983Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:52.983Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w",
  "timestampCount": 1
}
[2025-12-10T08:47:52.983Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:52.983Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:52.983Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:53.126Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:53.126Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356472809-zvt9a",
  "willUseTestId": true
}
[2025-12-10T08:47:53.126Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "key": "register:test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.126Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356472809-zvt9a",
  "timestampCount": 1
}
[2025-12-10T08:47:53.126Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:47:53.126Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:47:53.126Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:52.818Z"
  }
}
[2025-12-10T08:47:53.186Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.186Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:53.186Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.186Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.186Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w",
  "timestampCount": 2
}
[2025-12-10T08:47:53.186Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:53.186Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:53.187Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:53.208Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.208Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356472872-qx1gqm",
  "willUseTestId": true
}
[2025-12-10T08:47:53.208Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:53.208Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "key": "login:test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:53.208Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765356472872-qx1gqm",
  "timestampCount": 1
}
[2025-12-10T08:47:53.208Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:53.208Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:53.208Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:52.875Z"
  }
}
[2025-12-10T08:47:53.397Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.397Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:53.397Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.397Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w",
  "timestampCount": 3
}
[2025-12-10T08:47:53.397Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:47:53.397Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:47:53.397Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:53.430Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.430Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356472872-qx1gqm",
  "willUseTestId": true
}
[2025-12-10T08:47:53.430Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:53.430Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "key": "login:test:headers-remaining-1765356472872-qx1gqm"
}
[2025-12-10T08:47:53.430Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765356472872-qx1gqm",
  "timestampCount": 2
}
[2025-12-10T08:47:53.430Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:53.430Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:53.430Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356472872-qx1gqm",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:52.875Z"
  }
}
[2025-12-10T08:47:53.432Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:53.432Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356472809-zvt9a",
  "willUseTestId": true
}
[2025-12-10T08:47:53.432Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.432Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "key": "register:test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.432Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356472809-zvt9a",
  "timestampCount": 2
}
[2025-12-10T08:47:53.432Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:47:53.432Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:47:53.432Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:52.818Z"
  }
}
[2025-12-10T08:47:53.608Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.608Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:53.608Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.608Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w",
  "timestampCount": 4
}
[2025-12-10T08:47:53.608Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:47:53.608Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:47:53.608Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:53.647Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.647Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765356473645-h6waeu",
  "willUseTestId": true
}
[2025-12-10T08:47:53.647Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765356473645-h6waeu"
}
[2025-12-10T08:47:53.648Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765356473645-h6waeu",
  "key": "login:test:headers-consistent-1765356473645-h6waeu"
}
[2025-12-10T08:47:53.648Z] Creating new entry
{
  "key": "login:test:headers-consistent-1765356473645-h6waeu"
}
[2025-12-10T08:47:53.648Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:53.648Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:53.648Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765356473645-h6waeu",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:53.648Z"
  }
}
[2025-12-10T08:47:53.738Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:53.738Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356472809-zvt9a",
  "willUseTestId": true
}
[2025-12-10T08:47:53.738Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.738Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "key": "register:test:register-excessive-1765356472809-zvt9a"
}
[2025-12-10T08:47:53.742Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356472809-zvt9a",
  "timestampCount": 3
}
[2025-12-10T08:47:53.742Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:47:53.742Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356472809-zvt9a",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:52.818Z"
  }
}
[2025-12-10T08:47:53.755Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1765356473753-je1bib",
  "willUseTestId": true
}
[2025-12-10T08:47:53.755Z] Using test identifier
{
  "identifier": "test:perf-test-1765356473753-je1bib"
}
[2025-12-10T08:47:53.755Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1765356473753-je1bib",
  "key": "login:test:perf-test-1765356473753-je1bib"
}
[2025-12-10T08:47:53.755Z] Creating new entry
{
  "key": "login:test:perf-test-1765356473753-je1bib"
}
[2025-12-10T08:47:53.756Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:47:53.756Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:47:53.756Z] Rate limit check result
{
  "identifier": "test:perf-test-1765356473753-je1bib",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:48:53.755Z"
  }
}
[2025-12-10T08:47:53.831Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.831Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:53.831Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "login:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.831Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356472775-a0as2w",
  "timestampCount": 5
}
[2025-12-10T08:47:53.831Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:47:53.831Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:52.777Z"
  }
}
[2025-12-10T08:47:53.834Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:47:53.834Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356472775-a0as2w",
  "willUseTestId": true
}
[2025-12-10T08:47:53.834Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "key": "register:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.834Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1765356472775-a0as2w"
}
[2025-12-10T08:47:53.834Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:47:53.834Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:47:53.834Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356472775-a0as2w",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:53.834Z"
  }
}
[2025-12-10T08:47:53.953Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:47:53.953Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765356473645-h6waeu",
  "willUseTestId": true
}
[2025-12-10T08:47:53.953Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765356473645-h6waeu"
}
[2025-12-10T08:47:53.953Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765356473645-h6waeu",
  "key": "login:test:headers-consistent-1765356473645-h6waeu"
}
[2025-12-10T08:47:53.953Z] Found existing entry
{
  "key": "login:test:headers-consistent-1765356473645-h6waeu",
  "timestampCount": 1
}
[2025-12-10T08:47:53.953Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:47:53.953Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:47:53.953Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765356473645-h6waeu",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:48:53.648Z"
  }
}
[2025-12-10T08:47:55.108Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:47:55.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:47:55.108Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:47:55.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:47:55.108Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-10T08:47:55.109Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:47:55.109Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:47:55.109Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:48:48.246Z"
  }
}
[2025-12-10T08:48:00.007Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:48:00.007Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:48:00.007Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:48:00.007Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:48:00.008Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2025-12-10T08:48:00.008Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:48:00.008Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:48:00.008Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:48.249Z"
  }
}
[2025-12-10T08:48:02.189Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:48:02.190Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:48:02.190Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:48:02.190Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:48:02.190Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 3
}
[2025-12-10T08:48:02.190Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:48:02.190Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:48:02.190Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:48:48.246Z"
  }
}
[2025-12-10T08:48:12.089Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:48:12.090Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:48:12.090Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:48:12.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:48:12.090Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 2
}
[2025-12-10T08:48:12.090Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:48:12.090Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:48:12.090Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:48:48.249Z"
  }
}
[2025-12-10T08:49:19.623Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356559622",
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.624Z] Creating new entry
{
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.624Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:19.624Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:19.625Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356559622",
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.625Z] Found existing entry
{
  "key": "login:test-allow-1765356559622",
  "timestampCount": 1
}
[2025-12-10T08:49:19.625Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:19.625Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:19.626Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356559622",
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.626Z] Found existing entry
{
  "key": "login:test-allow-1765356559622",
  "timestampCount": 2
}
[2025-12-10T08:49:19.626Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:19.626Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:19.626Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356559622",
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.626Z] Found existing entry
{
  "key": "login:test-allow-1765356559622",
  "timestampCount": 3
}
[2025-12-10T08:49:19.626Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:19.626Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:19.627Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356559622",
  "key": "login:test-allow-1765356559622"
}
[2025-12-10T08:49:19.627Z] Found existing entry
{
  "key": "login:test-allow-1765356559622",
  "timestampCount": 4
}
[2025-12-10T08:49:19.627Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:19.627Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:19.629Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.629Z] Creating new entry
{
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.629Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:19.630Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:19.630Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.631Z] Found existing entry
{
  "key": "login:test-block-1765356559628",
  "timestampCount": 1
}
[2025-12-10T08:49:19.631Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:19.631Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:19.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.631Z] Found existing entry
{
  "key": "login:test-block-1765356559628",
  "timestampCount": 2
}
[2025-12-10T08:49:19.631Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:19.631Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:19.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.631Z] Found existing entry
{
  "key": "login:test-block-1765356559628",
  "timestampCount": 3
}
[2025-12-10T08:49:19.632Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:19.632Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:19.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.632Z] Found existing entry
{
  "key": "login:test-block-1765356559628",
  "timestampCount": 4
}
[2025-12-10T08:49:19.632Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:19.632Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:19.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356559628",
  "key": "login:test-block-1765356559628"
}
[2025-12-10T08:49:19.633Z] Found existing entry
{
  "key": "login:test-block-1765356559628",
  "timestampCount": 5
}
[2025-12-10T08:49:19.633Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:49:19.635Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356559635",
  "key": "test-reset:test-reset-1765356559635"
}
[2025-12-10T08:49:19.635Z] Creating new entry
{
  "key": "test-reset:test-reset-1765356559635"
}
[2025-12-10T08:49:19.635Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:49:19.636Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:49:19.636Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356559635",
  "key": "test-reset:test-reset-1765356559635"
}
[2025-12-10T08:49:19.637Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356559635",
  "timestampCount": 1
}
[2025-12-10T08:49:19.637Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T08:49:19.638Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T08:49:19.638Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356559635",
  "key": "test-reset:test-reset-1765356559635"
}
[2025-12-10T08:49:19.638Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356559635",
  "timestampCount": 2
}
[2025-12-10T08:49:19.639Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T08:49:19.791Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356559635",
  "key": "test-reset:test-reset-1765356559635"
}
[2025-12-10T08:49:19.791Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356559635",
  "timestampCount": 2
}
[2025-12-10T08:49:19.791Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T08:49:19.791Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:49:19.792Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:49:19.792Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.793Z] Creating new entry
{
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.793Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:19.793Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:19.793Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.793Z] Found existing entry
{
  "key": "login:test-multi-1-1765356559792",
  "timestampCount": 1
}
[2025-12-10T08:49:19.793Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:19.793Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:19.793Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.793Z] Found existing entry
{
  "key": "login:test-multi-1-1765356559792",
  "timestampCount": 2
}
[2025-12-10T08:49:19.793Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:19.793Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:19.793Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.793Z] Found existing entry
{
  "key": "login:test-multi-1-1765356559792",
  "timestampCount": 3
}
[2025-12-10T08:49:19.794Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:19.794Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:19.794Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.794Z] Found existing entry
{
  "key": "login:test-multi-1-1765356559792",
  "timestampCount": 4
}
[2025-12-10T08:49:19.794Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:19.794Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:19.794Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356559792",
  "key": "login:test-multi-1-1765356559792"
}
[2025-12-10T08:49:19.794Z] Found existing entry
{
  "key": "login:test-multi-1-1765356559792",
  "timestampCount": 5
}
[2025-12-10T08:49:19.794Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:49:19.795Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765356559792",
  "key": "login:test-multi-2-1765356559792"
}
[2025-12-10T08:49:19.795Z] Creating new entry
{
  "key": "login:test-multi-2-1765356559792"
}
[2025-12-10T08:49:19.795Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:19.796Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:19.797Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765356559797",
  "key": "login:test-reset-time-1765356559797"
}
[2025-12-10T08:49:19.797Z] Creating new entry
{
  "key": "login:test-reset-time-1765356559797"
}
[2025-12-10T08:49:19.797Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:19.797Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:19.800Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:19.800Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:19.801Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:19.801Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T08:49:19.802Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:19.802Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:19.802Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:19.802Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:49:19.803Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:19.803Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:19.803Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356559803",
  "key": "test-sliding:test-sliding-1765356559803"
}
[2025-12-10T08:49:19.803Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765356559803"
}
[2025-12-10T08:49:19.803Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:19.803Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:19.903Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356559803",
  "key": "test-sliding:test-sliding-1765356559803"
}
[2025-12-10T08:49:19.903Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356559803",
  "timestampCount": 1
}
[2025-12-10T08:49:19.903Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:19.903Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:20.004Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356559803",
  "key": "test-sliding:test-sliding-1765356559803"
}
[2025-12-10T08:49:20.005Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356559803",
  "timestampCount": 2
}
[2025-12-10T08:49:20.005Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T08:49:20.005Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:20.005Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:20.006Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765356560006",
  "key": "register:test-format-allowed-1765356560006"
}
[2025-12-10T08:49:20.006Z] Creating new entry
{
  "key": "register:test-format-allowed-1765356560006"
}
[2025-12-10T08:49:20.006Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:20.006Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:20.006Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356560006",
  "key": "register:test-format-blocked-1765356560006"
}
[2025-12-10T08:49:20.006Z] Creating new entry
{
  "key": "register:test-format-blocked-1765356560006"
}
[2025-12-10T08:49:20.006Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:20.006Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:20.006Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356560006",
  "key": "register:test-format-blocked-1765356560006"
}
[2025-12-10T08:49:20.006Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356560006",
  "timestampCount": 1
}
[2025-12-10T08:49:20.006Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:20.006Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:20.007Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356560006",
  "key": "register:test-format-blocked-1765356560006"
}
[2025-12-10T08:49:20.007Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356560006",
  "timestampCount": 2
}
[2025-12-10T08:49:20.007Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:49:20.007Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:49:20.007Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356560006",
  "key": "register:test-format-blocked-1765356560006"
}
[2025-12-10T08:49:20.007Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356560006",
  "timestampCount": 3
}
[2025-12-10T08:49:20.007Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:49:35.698Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356575697",
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.699Z] Creating new entry
{
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.699Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:35.699Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:35.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356575697",
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.701Z] Found existing entry
{
  "key": "login:test-allow-1765356575697",
  "timestampCount": 1
}
[2025-12-10T08:49:35.701Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:35.701Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:35.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356575697",
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.701Z] Found existing entry
{
  "key": "login:test-allow-1765356575697",
  "timestampCount": 2
}
[2025-12-10T08:49:35.701Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:35.701Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:35.701Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356575697",
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.701Z] Found existing entry
{
  "key": "login:test-allow-1765356575697",
  "timestampCount": 3
}
[2025-12-10T08:49:35.702Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:35.702Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:35.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765356575697",
  "key": "login:test-allow-1765356575697"
}
[2025-12-10T08:49:35.702Z] Found existing entry
{
  "key": "login:test-allow-1765356575697",
  "timestampCount": 4
}
[2025-12-10T08:49:35.702Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:35.702Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:35.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.702Z] Creating new entry
{
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.703Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:35.703Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:35.703Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.703Z] Found existing entry
{
  "key": "login:test-block-1765356575702",
  "timestampCount": 1
}
[2025-12-10T08:49:35.703Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:35.703Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:35.703Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.703Z] Found existing entry
{
  "key": "login:test-block-1765356575702",
  "timestampCount": 2
}
[2025-12-10T08:49:35.703Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:35.703Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:35.703Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.703Z] Found existing entry
{
  "key": "login:test-block-1765356575702",
  "timestampCount": 3
}
[2025-12-10T08:49:35.704Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:35.704Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.704Z] Found existing entry
{
  "key": "login:test-block-1765356575702",
  "timestampCount": 4
}
[2025-12-10T08:49:35.704Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:35.704Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765356575702",
  "key": "login:test-block-1765356575702"
}
[2025-12-10T08:49:35.704Z] Found existing entry
{
  "key": "login:test-block-1765356575702",
  "timestampCount": 5
}
[2025-12-10T08:49:35.704Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:49:35.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356575707",
  "key": "test-reset:test-reset-1765356575707"
}
[2025-12-10T08:49:35.709Z] Creating new entry
{
  "key": "test-reset:test-reset-1765356575707"
}
[2025-12-10T08:49:35.709Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:49:35.709Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:49:35.709Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356575707",
  "key": "test-reset:test-reset-1765356575707"
}
[2025-12-10T08:49:35.709Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356575707",
  "timestampCount": 1
}
[2025-12-10T08:49:35.709Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T08:49:35.709Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T08:49:35.709Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356575707",
  "key": "test-reset:test-reset-1765356575707"
}
[2025-12-10T08:49:35.709Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356575707",
  "timestampCount": 2
}
[2025-12-10T08:49:35.709Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T08:49:35.861Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765356575707",
  "key": "test-reset:test-reset-1765356575707"
}
[2025-12-10T08:49:35.861Z] Found existing entry
{
  "key": "test-reset:test-reset-1765356575707",
  "timestampCount": 2
}
[2025-12-10T08:49:35.861Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T08:49:35.861Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T08:49:35.861Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T08:49:35.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.862Z] Creating new entry
{
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.862Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:35.862Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:35.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.862Z] Found existing entry
{
  "key": "login:test-multi-1-1765356575862",
  "timestampCount": 1
}
[2025-12-10T08:49:35.863Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:49:35.863Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:49:35.863Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.863Z] Found existing entry
{
  "key": "login:test-multi-1-1765356575862",
  "timestampCount": 2
}
[2025-12-10T08:49:35.864Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:49:35.864Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:49:35.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.866Z] Found existing entry
{
  "key": "login:test-multi-1-1765356575862",
  "timestampCount": 3
}
[2025-12-10T08:49:35.866Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:49:35.866Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:49:35.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.866Z] Found existing entry
{
  "key": "login:test-multi-1-1765356575862",
  "timestampCount": 4
}
[2025-12-10T08:49:35.866Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:49:35.866Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:49:35.867Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765356575862",
  "key": "login:test-multi-1-1765356575862"
}
[2025-12-10T08:49:35.867Z] Found existing entry
{
  "key": "login:test-multi-1-1765356575862",
  "timestampCount": 5
}
[2025-12-10T08:49:35.867Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:49:35.867Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765356575862",
  "key": "login:test-multi-2-1765356575862"
}
[2025-12-10T08:49:35.867Z] Creating new entry
{
  "key": "login:test-multi-2-1765356575862"
}
[2025-12-10T08:49:35.868Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:35.868Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:35.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765356575868",
  "key": "login:test-reset-time-1765356575868"
}
[2025-12-10T08:49:35.868Z] Creating new entry
{
  "key": "login:test-reset-time-1765356575868"
}
[2025-12-10T08:49:35.868Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:49:35.868Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:49:35.869Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:35.869Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:35.870Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:35.870Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T08:49:35.870Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:35.871Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:35.871Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:35.872Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:49:35.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:49:35.872Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T08:49:35.872Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356575872",
  "key": "test-sliding:test-sliding-1765356575872"
}
[2025-12-10T08:49:35.872Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765356575872"
}
[2025-12-10T08:49:35.873Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:35.873Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:35.974Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356575872",
  "key": "test-sliding:test-sliding-1765356575872"
}
[2025-12-10T08:49:35.974Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356575872",
  "timestampCount": 1
}
[2025-12-10T08:49:35.974Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:35.974Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:36.075Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765356575872",
  "key": "test-sliding:test-sliding-1765356575872"
}
[2025-12-10T08:49:36.075Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765356575872",
  "timestampCount": 2
}
[2025-12-10T08:49:36.075Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T08:49:36.075Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:36.075Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:36.075Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765356576075",
  "key": "register:test-format-allowed-1765356576075"
}
[2025-12-10T08:49:36.076Z] Creating new entry
{
  "key": "register:test-format-allowed-1765356576075"
}
[2025-12-10T08:49:36.076Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:36.076Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:36.076Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356576076",
  "key": "register:test-format-blocked-1765356576076"
}
[2025-12-10T08:49:36.076Z] Creating new entry
{
  "key": "register:test-format-blocked-1765356576076"
}
[2025-12-10T08:49:36.076Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:49:36.076Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:49:36.076Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356576076",
  "key": "register:test-format-blocked-1765356576076"
}
[2025-12-10T08:49:36.076Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356576076",
  "timestampCount": 1
}
[2025-12-10T08:49:36.076Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:49:36.076Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:49:36.076Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356576076",
  "key": "register:test-format-blocked-1765356576076"
}
[2025-12-10T08:49:36.076Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356576076",
  "timestampCount": 2
}
[2025-12-10T08:49:36.076Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:49:36.076Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:49:36.076Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765356576076",
  "key": "register:test-format-blocked-1765356576076"
}
[2025-12-10T08:49:36.076Z] Found existing entry
{
  "key": "register:test-format-blocked-1765356576076",
  "timestampCount": 3
}
[2025-12-10T08:49:36.077Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:50:03.523Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:50:03.524Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:03.524Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:03.525Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:50:03.525Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-10T08:50:03.525Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-10T08:50:03.525Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-10T08:50:03.525Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-10T08:51:03.525Z"
  }
}
[2025-12-10T08:50:03.545Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:50:03.545Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:03.545Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:03.545Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:50:03.545Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-10T08:50:03.545Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-10T08:50:03.545Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-10T08:50:03.545Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-10T08:51:03.525Z"
  }
}
[2025-12-10T08:50:04.113Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:50:04.113Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:04.113Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:04.113Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:50:04.113Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-10T08:50:04.113Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-10T08:50:04.113Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-10T08:50:04.113Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-10T08:51:03.525Z"
  }
}
[2025-12-10T08:50:04.151Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-10T08:50:04.154Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:04.154Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:04.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-10T08:50:04.154Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-10T08:50:04.154Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-10T08:50:04.154Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-10T08:50:04.154Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-10T08:51:03.525Z"
  }
}
[2025-12-10T08:50:06.473Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:06.473Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:06.473Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:06.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:50:06.473Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T08:50:06.473Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:50:06.473Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:50:06.473Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:06.473Z"
  }
}
[2025-12-10T08:50:06.834Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:50:06.834Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:06.834Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:06.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:50:06.835Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T08:50:06.835Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:06.835Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:06.835Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:06.834Z"
  }
}
[2025-12-10T08:50:07.169Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T08:50:07.170Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:07.170Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:07.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:50:07.170Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T08:50:07.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:07.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:07.170Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:06.834Z"
  }
}
[2025-12-10T08:50:07.666Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:07.666Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:07.666Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:07.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:07.667Z] Creating new entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:07.667Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:07.667Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:07.667Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:07.983Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:07.983Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:07.983Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:07.983Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:07.983Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr",
  "timestampCount": 1
}
[2025-12-10T08:50:07.983Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:07.983Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:07.984Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:08.211Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:08.211Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1765356608203-7mh4y",
  "willUseTestId": true
}
[2025-12-10T08:50:08.211Z] Using test identifier
{
  "identifier": "test:login-headers-1765356608203-7mh4y"
}
[2025-12-10T08:50:08.211Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1765356608203-7mh4y",
  "key": "login:test:login-headers-1765356608203-7mh4y"
}
[2025-12-10T08:50:08.211Z] Creating new entry
{
  "key": "login:test:login-headers-1765356608203-7mh4y"
}
[2025-12-10T08:50:08.211Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:08.211Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:08.211Z] Rate limit check result
{
  "identifier": "test:login-headers-1765356608203-7mh4y",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:08.211Z"
  }
}
[2025-12-10T08:50:08.272Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:08.272Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:08.272Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.272Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.272Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr",
  "timestampCount": 2
}
[2025-12-10T08:50:08.272Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:50:08.272Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:50:08.272Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:08.538Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:08.538Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:08.539Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.539Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.539Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr",
  "timestampCount": 3
}
[2025-12-10T08:50:08.539Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:50:08.539Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:50:08.539Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:08.591Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:08.591Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356608590-cjedj9",
  "willUseTestId": true
}
[2025-12-10T08:50:08.592Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:08.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "key": "register:test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:08.592Z] Creating new entry
{
  "key": "register:test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:08.592Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:50:08.592Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:50:08.592Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:08.592Z"
  }
}
[2025-12-10T08:50:08.724Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:08.724Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:08.725Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:08.725Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:08.725Z] Creating new entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:08.725Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:08.725Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:08.725Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:08.815Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:08.815Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:08.815Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.815Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:08.815Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr",
  "timestampCount": 4
}
[2025-12-10T08:50:08.815Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:50:08.815Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:50:08.815Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:08.904Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:08.904Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356608590-cjedj9",
  "willUseTestId": true
}
[2025-12-10T08:50:08.904Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:08.904Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "key": "register:test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:08.904Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356608590-cjedj9",
  "timestampCount": 1
}
[2025-12-10T08:50:08.904Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:50:08.904Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:50:08.904Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:08.592Z"
  }
}
[2025-12-10T08:50:09.050Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.050Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:09.050Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.050Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.051Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv",
  "timestampCount": 1
}
[2025-12-10T08:50:09.051Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:09.051Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:09.051Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:09.081Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.081Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765356607653-fle5rr",
  "willUseTestId": true
}
[2025-12-10T08:50:09.081Z] Using test identifier
{
  "identifier": "test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:09.081Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "key": "login:test:login-excessive-1765356607653-fle5rr"
}
[2025-12-10T08:50:09.081Z] Found existing entry
{
  "key": "login:test:login-excessive-1765356607653-fle5rr",
  "timestampCount": 5
}
[2025-12-10T08:50:09.081Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:50:09.081Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765356607653-fle5rr",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:07.666Z"
  }
}
[2025-12-10T08:50:09.090Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:09.090Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1765356609089-b75pjm",
  "willUseTestId": true
}
[2025-12-10T08:50:09.090Z] Using test identifier
{
  "identifier": "test:register-headers-1765356609089-b75pjm"
}
[2025-12-10T08:50:09.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1765356609089-b75pjm",
  "key": "register:test:register-headers-1765356609089-b75pjm"
}
[2025-12-10T08:50:09.090Z] Creating new entry
{
  "key": "register:test:register-headers-1765356609089-b75pjm"
}
[2025-12-10T08:50:09.090Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:50:09.090Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:50:09.090Z] Rate limit check result
{
  "identifier": "test:register-headers-1765356609089-b75pjm",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:09.090Z"
  }
}
[2025-12-10T08:50:09.187Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:09.187Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356608590-cjedj9",
  "willUseTestId": true
}
[2025-12-10T08:50:09.187Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:09.187Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "key": "register:test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:09.187Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356608590-cjedj9",
  "timestampCount": 2
}
[2025-12-10T08:50:09.187Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:50:09.187Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:50:09.187Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:08.592Z"
  }
}
[2025-12-10T08:50:09.263Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.263Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:09.263Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.263Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv",
  "timestampCount": 2
}
[2025-12-10T08:50:09.263Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:50:09.263Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:50:09.263Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:09.426Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.427Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:09.427Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.427Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.427Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:09.427Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:09.427Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:09.475Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.475Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:09.475Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.475Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.475Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv",
  "timestampCount": 3
}
[2025-12-10T08:50:09.475Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:50:09.475Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:50:09.475Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:09.646Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.646Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:09.646Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.646Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.646Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn",
  "timestampCount": 1
}
[2025-12-10T08:50:09.646Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:09.646Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:09.646Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:09.678Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.678Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:09.678Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.678Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.678Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv",
  "timestampCount": 4
}
[2025-12-10T08:50:09.678Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:50:09.678Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:50:09.678Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:09.737Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:09.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765356608590-cjedj9",
  "willUseTestId": true
}
[2025-12-10T08:50:09.738Z] Using test identifier
{
  "identifier": "test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:09.738Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "key": "register:test:register-excessive-1765356608590-cjedj9"
}
[2025-12-10T08:50:09.738Z] Found existing entry
{
  "key": "register:test:register-excessive-1765356608590-cjedj9",
  "timestampCount": 3
}
[2025-12-10T08:50:09.738Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T08:50:09.738Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765356608590-cjedj9",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:08.592Z"
  }
}
[2025-12-10T08:50:09.746Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.746Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356609745-kcd3p5",
  "willUseTestId": true
}
[2025-12-10T08:50:09.746Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:09.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "key": "login:test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:09.746Z] Creating new entry
{
  "key": "login:test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:09.746Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:09.746Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:09.746Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:09.746Z"
  }
}
[2025-12-10T08:50:09.867Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.867Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:09.867Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.867Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:09.867Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn",
  "timestampCount": 2
}
[2025-12-10T08:50:09.867Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:50:09.867Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:50:09.867Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:09.924Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.924Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765356608716-z73xpv",
  "willUseTestId": true
}
[2025-12-10T08:50:09.924Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "key": "login:test:login-retry-after-1765356608716-z73xpv"
}
[2025-12-10T08:50:09.924Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765356608716-z73xpv",
  "timestampCount": 5
}
[2025-12-10T08:50:09.924Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:50:09.924Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765356608716-z73xpv",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:08.725Z"
  }
}
[2025-12-10T08:50:09.937Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.937Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765356609935-qghj4t",
  "willUseTestId": true
}
[2025-12-10T08:50:09.937Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765356609935-qghj4t"
}
[2025-12-10T08:50:09.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765356609935-qghj4t",
  "key": "login:test:headers-consistent-1765356609935-qghj4t"
}
[2025-12-10T08:50:09.937Z] Creating new entry
{
  "key": "login:test:headers-consistent-1765356609935-qghj4t"
}
[2025-12-10T08:50:09.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:09.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:09.937Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765356609935-qghj4t",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:09.937Z"
  }
}
[2025-12-10T08:50:09.962Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:09.962Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356609745-kcd3p5",
  "willUseTestId": true
}
[2025-12-10T08:50:09.963Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:09.963Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "key": "login:test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:09.963Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765356609745-kcd3p5",
  "timestampCount": 1
}
[2025-12-10T08:50:09.963Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:09.963Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:09.963Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:09.746Z"
  }
}
[2025-12-10T08:50:10.085Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.085Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:10.086Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.086Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.086Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn",
  "timestampCount": 3
}
[2025-12-10T08:50:10.086Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:50:10.086Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:50:10.086Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:10.172Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.172Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765356609745-kcd3p5",
  "willUseTestId": true
}
[2025-12-10T08:50:10.172Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:10.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "key": "login:test:headers-remaining-1765356609745-kcd3p5"
}
[2025-12-10T08:50:10.172Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765356609745-kcd3p5",
  "timestampCount": 2
}
[2025-12-10T08:50:10.173Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:50:10.173Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:50:10.173Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765356609745-kcd3p5",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:09.746Z"
  }
}
[2025-12-10T08:50:10.181Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.181Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765356609935-qghj4t",
  "willUseTestId": true
}
[2025-12-10T08:50:10.181Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765356609935-qghj4t"
}
[2025-12-10T08:50:10.181Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765356609935-qghj4t",
  "key": "login:test:headers-consistent-1765356609935-qghj4t"
}
[2025-12-10T08:50:10.181Z] Found existing entry
{
  "key": "login:test:headers-consistent-1765356609935-qghj4t",
  "timestampCount": 1
}
[2025-12-10T08:50:10.181Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T08:50:10.181Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T08:50:10.181Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765356609935-qghj4t",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T08:51:09.937Z"
  }
}
[2025-12-10T08:50:10.284Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.284Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:10.285Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.285Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.285Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn",
  "timestampCount": 4
}
[2025-12-10T08:50:10.285Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T08:50:10.285Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T08:50:10.285Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:10.386Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.386Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1765356610385-5fggzg",
  "willUseTestId": true
}
[2025-12-10T08:50:10.386Z] Using test identifier
{
  "identifier": "test:perf-test-1765356610385-5fggzg"
}
[2025-12-10T08:50:10.387Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1765356610385-5fggzg",
  "key": "login:test:perf-test-1765356610385-5fggzg"
}
[2025-12-10T08:50:10.387Z] Creating new entry
{
  "key": "login:test:perf-test-1765356610385-5fggzg"
}
[2025-12-10T08:50:10.387Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T08:50:10.387Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T08:50:10.387Z] Rate limit check result
{
  "identifier": "test:perf-test-1765356610385-5fggzg",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T08:51:10.387Z"
  }
}
[2025-12-10T08:50:10.693Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T08:50:10.693Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:10.694Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.694Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "login:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.694Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765356609425-yoewrn",
  "timestampCount": 5
}
[2025-12-10T08:50:10.694Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T08:50:10.694Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:09.427Z"
  }
}
[2025-12-10T08:50:10.696Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:10.696Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765356609425-yoewrn",
  "willUseTestId": true
}
[2025-12-10T08:50:10.696Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "key": "register:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.696Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1765356609425-yoewrn"
}
[2025-12-10T08:50:10.696Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T08:50:10.696Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T08:50:10.696Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765356609425-yoewrn",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:10.696Z"
  }
}
[2025-12-10T08:50:13.565Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:50:13.566Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:13.566Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:13.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:50:13.566Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-10T08:50:13.566Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T08:50:13.566Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T08:50:13.566Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T08:51:06.834Z"
  }
}
[2025-12-10T08:50:18.370Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:18.370Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:18.371Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:18.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:50:18.371Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2025-12-10T08:50:18.371Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T08:50:18.371Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T08:50:18.371Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:06.473Z"
  }
}
[2025-12-10T08:50:20.884Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T08:50:20.884Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:20.884Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:20.884Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T08:50:20.884Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 3
}
[2025-12-10T08:50:20.884Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T08:50:20.884Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T08:50:20.884Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T08:51:06.834Z"
  }
}
[2025-12-10T08:50:30.133Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T08:50:30.133Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T08:50:30.133Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T08:50:30.133Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T08:50:30.133Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 2
}
[2025-12-10T08:50:30.133Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T08:50:30.133Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T08:50:30.133Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T08:51:06.473Z"
  }
}
[2025-12-10T10:34:17.815Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T10:34:17.816Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:34:17.816Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:34:17.816Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T10:34:17.816Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T10:34:17.816Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T10:34:17.816Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T10:34:17.816Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T10:35:17.816Z"
  }
}
[2025-12-10T10:34:17.817Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T10:34:17.817Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:34:17.821Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:34:17.821Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T10:34:17.821Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T10:34:17.821Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T10:34:17.821Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T10:34:17.821Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T10:35:17.816Z"
  }
}
[2025-12-10T10:34:17.835Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T10:34:17.835Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:34:17.835Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:34:17.835Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T10:34:17.835Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T10:34:17.835Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T10:34:17.835Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T10:34:17.835Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T10:35:17.835Z"
  }
}
[2025-12-10T10:41:44.308Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T10:41:44.308Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:41:44.308Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:41:44.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T10:41:44.308Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T10:41:44.309Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T10:41:44.309Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T10:41:44.309Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T10:42:44.308Z"
  }
}
[2025-12-10T10:41:44.316Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T10:41:44.316Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:41:44.316Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:41:44.316Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T10:41:44.316Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T10:41:44.316Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T10:41:44.316Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T10:41:44.316Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T10:42:44.308Z"
  }
}
[2025-12-10T10:41:44.337Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T10:41:44.337Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:41:44.337Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:41:44.337Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T10:41:44.337Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T10:41:44.337Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T10:41:44.337Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T10:41:44.338Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T10:42:44.337Z"
  }
}
[2025-12-10T10:41:55.990Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T10:41:55.990Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:41:55.990Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:41:55.990Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T10:41:55.990Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2025-12-10T10:41:55.990Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T10:41:55.990Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T10:41:55.990Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T10:42:44.337Z"
  }
}
[2025-12-10T10:42:07.660Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T10:42:07.660Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T10:42:07.660Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T10:42:07.660Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T10:42:07.660Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 2
}
[2025-12-10T10:42:07.661Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T10:42:07.661Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T10:42:07.661Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T10:42:44.337Z"
  }
}
[2025-12-10T11:13:52.349Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365232349",
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.350Z] Creating new entry
{
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.350Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:52.351Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:52.351Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365232349",
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.351Z] Found existing entry
{
  "key": "login:test-allow-1765365232349",
  "timestampCount": 1
}
[2025-12-10T11:13:52.351Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:13:52.351Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:13:52.351Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365232349",
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.351Z] Found existing entry
{
  "key": "login:test-allow-1765365232349",
  "timestampCount": 2
}
[2025-12-10T11:13:52.351Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:13:52.351Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:13:52.351Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365232349",
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.351Z] Found existing entry
{
  "key": "login:test-allow-1765365232349",
  "timestampCount": 3
}
[2025-12-10T11:13:52.351Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:13:52.351Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:13:52.351Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365232349",
  "key": "login:test-allow-1765365232349"
}
[2025-12-10T11:13:52.351Z] Found existing entry
{
  "key": "login:test-allow-1765365232349",
  "timestampCount": 4
}
[2025-12-10T11:13:52.351Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:13:52.352Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:13:52.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.352Z] Creating new entry
{
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.352Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:52.352Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:52.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.352Z] Found existing entry
{
  "key": "login:test-block-1765365232352",
  "timestampCount": 1
}
[2025-12-10T11:13:52.352Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:13:52.352Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:13:52.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.352Z] Found existing entry
{
  "key": "login:test-block-1765365232352",
  "timestampCount": 2
}
[2025-12-10T11:13:52.352Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:13:52.352Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:13:52.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.352Z] Found existing entry
{
  "key": "login:test-block-1765365232352",
  "timestampCount": 3
}
[2025-12-10T11:13:52.352Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:13:52.352Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:13:52.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.353Z] Found existing entry
{
  "key": "login:test-block-1765365232352",
  "timestampCount": 4
}
[2025-12-10T11:13:52.353Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:13:52.353Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:13:52.353Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365232352",
  "key": "login:test-block-1765365232352"
}
[2025-12-10T11:13:52.353Z] Found existing entry
{
  "key": "login:test-block-1765365232352",
  "timestampCount": 5
}
[2025-12-10T11:13:52.353Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:13:52.353Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365232353",
  "key": "test-reset:test-reset-1765365232353"
}
[2025-12-10T11:13:52.354Z] Creating new entry
{
  "key": "test-reset:test-reset-1765365232353"
}
[2025-12-10T11:13:52.354Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:13:52.354Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:13:52.354Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365232353",
  "key": "test-reset:test-reset-1765365232353"
}
[2025-12-10T11:13:52.354Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365232353",
  "timestampCount": 1
}
[2025-12-10T11:13:52.354Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T11:13:52.354Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T11:13:52.354Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365232353",
  "key": "test-reset:test-reset-1765365232353"
}
[2025-12-10T11:13:52.354Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365232353",
  "timestampCount": 2
}
[2025-12-10T11:13:52.354Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T11:13:52.504Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365232353",
  "key": "test-reset:test-reset-1765365232353"
}
[2025-12-10T11:13:52.504Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365232353",
  "timestampCount": 2
}
[2025-12-10T11:13:52.504Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T11:13:52.504Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:13:52.504Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:13:52.504Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.504Z] Creating new entry
{
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.504Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:52.504Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:52.504Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.504Z] Found existing entry
{
  "key": "login:test-multi-1-1765365232504",
  "timestampCount": 1
}
[2025-12-10T11:13:52.504Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.505Z] Found existing entry
{
  "key": "login:test-multi-1-1765365232504",
  "timestampCount": 2
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.505Z] Found existing entry
{
  "key": "login:test-multi-1-1765365232504",
  "timestampCount": 3
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.505Z] Found existing entry
{
  "key": "login:test-multi-1-1765365232504",
  "timestampCount": 4
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365232504",
  "key": "login:test-multi-1-1765365232504"
}
[2025-12-10T11:13:52.505Z] Found existing entry
{
  "key": "login:test-multi-1-1765365232504",
  "timestampCount": 5
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765365232504",
  "key": "login:test-multi-2-1765365232504"
}
[2025-12-10T11:13:52.505Z] Creating new entry
{
  "key": "login:test-multi-2-1765365232504"
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:52.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765365232505",
  "key": "login:test-reset-time-1765365232505"
}
[2025-12-10T11:13:52.505Z] Creating new entry
{
  "key": "login:test-reset-time-1765365232505"
}
[2025-12-10T11:13:52.505Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:52.505Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:52.506Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:13:52.506Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:13:52.507Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:13:52.507Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T11:13:52.507Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:13:52.507Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:13:52.507Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:13:52.507Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:13:52.507Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:13:52.507Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:13:52.508Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365232508",
  "key": "test-sliding:test-sliding-1765365232508"
}
[2025-12-10T11:13:52.508Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765365232508"
}
[2025-12-10T11:13:52.508Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:13:52.508Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:13:59.871Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365239871",
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.871Z] Creating new entry
{
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.871Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:59.871Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:59.872Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365239871",
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.872Z] Found existing entry
{
  "key": "login:test-allow-1765365239871",
  "timestampCount": 1
}
[2025-12-10T11:13:59.872Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:13:59.872Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:13:59.872Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365239871",
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.872Z] Found existing entry
{
  "key": "login:test-allow-1765365239871",
  "timestampCount": 2
}
[2025-12-10T11:13:59.872Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:13:59.872Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:13:59.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365239871",
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.873Z] Found existing entry
{
  "key": "login:test-allow-1765365239871",
  "timestampCount": 3
}
[2025-12-10T11:13:59.873Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:13:59.873Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:13:59.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365239871",
  "key": "login:test-allow-1765365239871"
}
[2025-12-10T11:13:59.873Z] Found existing entry
{
  "key": "login:test-allow-1765365239871",
  "timestampCount": 4
}
[2025-12-10T11:13:59.873Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:13:59.873Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:13:59.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.873Z] Creating new entry
{
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.873Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:13:59.873Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:13:59.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.873Z] Found existing entry
{
  "key": "login:test-block-1765365239873",
  "timestampCount": 1
}
[2025-12-10T11:13:59.873Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:13:59.873Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:13:59.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.874Z] Found existing entry
{
  "key": "login:test-block-1765365239873",
  "timestampCount": 2
}
[2025-12-10T11:13:59.874Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:13:59.874Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:13:59.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.874Z] Found existing entry
{
  "key": "login:test-block-1765365239873",
  "timestampCount": 3
}
[2025-12-10T11:13:59.874Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:13:59.874Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:13:59.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.875Z] Found existing entry
{
  "key": "login:test-block-1765365239873",
  "timestampCount": 4
}
[2025-12-10T11:13:59.875Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:13:59.875Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:13:59.875Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365239873",
  "key": "login:test-block-1765365239873"
}
[2025-12-10T11:13:59.875Z] Found existing entry
{
  "key": "login:test-block-1765365239873",
  "timestampCount": 5
}
[2025-12-10T11:13:59.875Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:13:59.877Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365239877",
  "key": "test-reset:test-reset-1765365239877"
}
[2025-12-10T11:13:59.877Z] Creating new entry
{
  "key": "test-reset:test-reset-1765365239877"
}
[2025-12-10T11:13:59.877Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:13:59.877Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:13:59.877Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365239877",
  "key": "test-reset:test-reset-1765365239877"
}
[2025-12-10T11:13:59.877Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365239877",
  "timestampCount": 1
}
[2025-12-10T11:13:59.877Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T11:13:59.877Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T11:13:59.877Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365239877",
  "key": "test-reset:test-reset-1765365239877"
}
[2025-12-10T11:13:59.877Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365239877",
  "timestampCount": 2
}
[2025-12-10T11:13:59.877Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T11:14:00.030Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365239877",
  "key": "test-reset:test-reset-1765365239877"
}
[2025-12-10T11:14:00.031Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365239877",
  "timestampCount": 2
}
[2025-12-10T11:14:00.031Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T11:14:00.032Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:14:00.032Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:14:00.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.032Z] Creating new entry
{
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.032Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:14:00.032Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:14:00.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.033Z] Found existing entry
{
  "key": "login:test-multi-1-1765365240032",
  "timestampCount": 1
}
[2025-12-10T11:14:00.033Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:14:00.033Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:14:00.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.033Z] Found existing entry
{
  "key": "login:test-multi-1-1765365240032",
  "timestampCount": 2
}
[2025-12-10T11:14:00.033Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:14:00.033Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:14:00.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.033Z] Found existing entry
{
  "key": "login:test-multi-1-1765365240032",
  "timestampCount": 3
}
[2025-12-10T11:14:00.033Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:14:00.033Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:14:00.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.033Z] Found existing entry
{
  "key": "login:test-multi-1-1765365240032",
  "timestampCount": 4
}
[2025-12-10T11:14:00.033Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:14:00.033Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:14:00.034Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365240032",
  "key": "login:test-multi-1-1765365240032"
}
[2025-12-10T11:14:00.034Z] Found existing entry
{
  "key": "login:test-multi-1-1765365240032",
  "timestampCount": 5
}
[2025-12-10T11:14:00.034Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:14:00.034Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765365240032",
  "key": "login:test-multi-2-1765365240032"
}
[2025-12-10T11:14:00.034Z] Creating new entry
{
  "key": "login:test-multi-2-1765365240032"
}
[2025-12-10T11:14:00.034Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:14:00.034Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:14:00.034Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765365240034",
  "key": "login:test-reset-time-1765365240034"
}
[2025-12-10T11:14:00.034Z] Creating new entry
{
  "key": "login:test-reset-time-1765365240034"
}
[2025-12-10T11:14:00.034Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:14:00.034Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:14:00.036Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:14:00.036Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:14:00.037Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:14:00.037Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T11:14:00.037Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:14:00.037Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:14:00.038Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:14:00.038Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:14:00.038Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:14:00.038Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:14:00.038Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365240038",
  "key": "test-sliding:test-sliding-1765365240038"
}
[2025-12-10T11:14:00.038Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765365240038"
}
[2025-12-10T11:14:00.038Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:14:00.038Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:14:00.141Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365240038",
  "key": "test-sliding:test-sliding-1765365240038"
}
[2025-12-10T11:14:00.141Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765365240038",
  "timestampCount": 1
}
[2025-12-10T11:14:00.141Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:14:00.141Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:14:00.243Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365240038",
  "key": "test-sliding:test-sliding-1765365240038"
}
[2025-12-10T11:14:00.243Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765365240038",
  "timestampCount": 2
}
[2025-12-10T11:14:00.243Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T11:14:00.243Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:14:00.243Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:14:00.244Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765365240244",
  "key": "register:test-format-allowed-1765365240244"
}
[2025-12-10T11:14:00.244Z] Creating new entry
{
  "key": "register:test-format-allowed-1765365240244"
}
[2025-12-10T11:14:00.244Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:14:00.244Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:14:00.245Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365240245",
  "key": "register:test-format-blocked-1765365240245"
}
[2025-12-10T11:14:00.245Z] Creating new entry
{
  "key": "register:test-format-blocked-1765365240245"
}
[2025-12-10T11:14:00.245Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:14:00.245Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:14:00.245Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365240245",
  "key": "register:test-format-blocked-1765365240245"
}
[2025-12-10T11:14:00.245Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365240245",
  "timestampCount": 1
}
[2025-12-10T11:14:00.245Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:14:00.246Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:14:00.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365240245",
  "key": "register:test-format-blocked-1765365240245"
}
[2025-12-10T11:14:00.246Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365240245",
  "timestampCount": 2
}
[2025-12-10T11:14:00.246Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T11:14:00.246Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T11:14:00.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365240245",
  "key": "register:test-format-blocked-1765365240245"
}
[2025-12-10T11:14:00.246Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365240245",
  "timestampCount": 3
}
[2025-12-10T11:14:00.246Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T11:16:13.179Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365373179",
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.181Z] Creating new entry
{
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.181Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:16:13.181Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:16:13.182Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365373179",
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.182Z] Found existing entry
{
  "key": "login:test-allow-1765365373179",
  "timestampCount": 1
}
[2025-12-10T11:16:13.182Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:16:13.182Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:16:13.182Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365373179",
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.183Z] Found existing entry
{
  "key": "login:test-allow-1765365373179",
  "timestampCount": 2
}
[2025-12-10T11:16:13.183Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:16:13.183Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:16:13.183Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365373179",
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.183Z] Found existing entry
{
  "key": "login:test-allow-1765365373179",
  "timestampCount": 3
}
[2025-12-10T11:16:13.183Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:16:13.183Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:16:13.183Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765365373179",
  "key": "login:test-allow-1765365373179"
}
[2025-12-10T11:16:13.183Z] Found existing entry
{
  "key": "login:test-allow-1765365373179",
  "timestampCount": 4
}
[2025-12-10T11:16:13.183Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:16:13.183Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:16:13.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.185Z] Creating new entry
{
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.185Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:16:13.185Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:16:13.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.186Z] Found existing entry
{
  "key": "login:test-block-1765365373184",
  "timestampCount": 1
}
[2025-12-10T11:16:13.186Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:16:13.186Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:16:13.186Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.186Z] Found existing entry
{
  "key": "login:test-block-1765365373184",
  "timestampCount": 2
}
[2025-12-10T11:16:13.186Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:16:13.186Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:16:13.186Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.186Z] Found existing entry
{
  "key": "login:test-block-1765365373184",
  "timestampCount": 3
}
[2025-12-10T11:16:13.186Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:16:13.186Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:16:13.186Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.186Z] Found existing entry
{
  "key": "login:test-block-1765365373184",
  "timestampCount": 4
}
[2025-12-10T11:16:13.187Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:16:13.187Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:16:13.187Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765365373184",
  "key": "login:test-block-1765365373184"
}
[2025-12-10T11:16:13.187Z] Found existing entry
{
  "key": "login:test-block-1765365373184",
  "timestampCount": 5
}
[2025-12-10T11:16:13.187Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:16:13.189Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365373189",
  "key": "test-reset:test-reset-1765365373189"
}
[2025-12-10T11:16:13.189Z] Creating new entry
{
  "key": "test-reset:test-reset-1765365373189"
}
[2025-12-10T11:16:13.189Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:16:13.189Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:16:13.189Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365373189",
  "key": "test-reset:test-reset-1765365373189"
}
[2025-12-10T11:16:13.189Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365373189",
  "timestampCount": 1
}
[2025-12-10T11:16:13.189Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T11:16:13.189Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T11:16:13.190Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365373189",
  "key": "test-reset:test-reset-1765365373189"
}
[2025-12-10T11:16:13.190Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365373189",
  "timestampCount": 2
}
[2025-12-10T11:16:13.190Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T11:16:13.341Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765365373189",
  "key": "test-reset:test-reset-1765365373189"
}
[2025-12-10T11:16:13.342Z] Found existing entry
{
  "key": "test-reset:test-reset-1765365373189",
  "timestampCount": 2
}
[2025-12-10T11:16:13.342Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T11:16:13.342Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T11:16:13.342Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T11:16:13.342Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.342Z] Creating new entry
{
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.342Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:16:13.342Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:16:13.342Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.342Z] Found existing entry
{
  "key": "login:test-multi-1-1765365373342",
  "timestampCount": 1
}
[2025-12-10T11:16:13.343Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:16:13.343Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:16:13.343Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.343Z] Found existing entry
{
  "key": "login:test-multi-1-1765365373342",
  "timestampCount": 2
}
[2025-12-10T11:16:13.343Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:16:13.343Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:16:13.343Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.343Z] Found existing entry
{
  "key": "login:test-multi-1-1765365373342",
  "timestampCount": 3
}
[2025-12-10T11:16:13.343Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T11:16:13.343Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T11:16:13.343Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.343Z] Found existing entry
{
  "key": "login:test-multi-1-1765365373342",
  "timestampCount": 4
}
[2025-12-10T11:16:13.343Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T11:16:13.343Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T11:16:13.343Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765365373342",
  "key": "login:test-multi-1-1765365373342"
}
[2025-12-10T11:16:13.343Z] Found existing entry
{
  "key": "login:test-multi-1-1765365373342",
  "timestampCount": 5
}
[2025-12-10T11:16:13.343Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T11:16:13.343Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765365373342",
  "key": "login:test-multi-2-1765365373342"
}
[2025-12-10T11:16:13.343Z] Creating new entry
{
  "key": "login:test-multi-2-1765365373342"
}
[2025-12-10T11:16:13.344Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:16:13.344Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:16:13.345Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765365373345",
  "key": "login:test-reset-time-1765365373345"
}
[2025-12-10T11:16:13.345Z] Creating new entry
{
  "key": "login:test-reset-time-1765365373345"
}
[2025-12-10T11:16:13.345Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:16:13.345Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:16:13.347Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:16:13.347Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:16:13.347Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:16:13.347Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T11:16:13.348Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:16:13.348Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:16:13.348Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:16:13.348Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:16:13.348Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:16:13.348Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T11:16:13.348Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365373348",
  "key": "test-sliding:test-sliding-1765365373348"
}
[2025-12-10T11:16:13.349Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765365373348"
}
[2025-12-10T11:16:13.349Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:16:13.349Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:16:13.450Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365373348",
  "key": "test-sliding:test-sliding-1765365373348"
}
[2025-12-10T11:16:13.450Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765365373348",
  "timestampCount": 1
}
[2025-12-10T11:16:13.450Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:16:13.450Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:16:13.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765365373348",
  "key": "test-sliding:test-sliding-1765365373348"
}
[2025-12-10T11:16:13.551Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765365373348",
  "timestampCount": 2
}
[2025-12-10T11:16:13.551Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T11:16:13.551Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:16:13.551Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:16:13.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765365373552",
  "key": "register:test-format-allowed-1765365373552"
}
[2025-12-10T11:16:13.552Z] Creating new entry
{
  "key": "register:test-format-allowed-1765365373552"
}
[2025-12-10T11:16:13.552Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:16:13.552Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:16:13.553Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365373553",
  "key": "register:test-format-blocked-1765365373553"
}
[2025-12-10T11:16:13.553Z] Creating new entry
{
  "key": "register:test-format-blocked-1765365373553"
}
[2025-12-10T11:16:13.553Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:16:13.553Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:16:13.553Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365373553",
  "key": "register:test-format-blocked-1765365373553"
}
[2025-12-10T11:16:13.553Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365373553",
  "timestampCount": 1
}
[2025-12-10T11:16:13.553Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T11:16:13.553Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T11:16:13.554Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365373553",
  "key": "register:test-format-blocked-1765365373553"
}
[2025-12-10T11:16:13.554Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365373553",
  "timestampCount": 2
}
[2025-12-10T11:16:13.554Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T11:16:13.554Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T11:16:13.554Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765365373553",
  "key": "register:test-format-blocked-1765365373553"
}
[2025-12-10T11:16:13.554Z] Found existing entry
{
  "key": "register:test-format-blocked-1765365373553",
  "timestampCount": 3
}
[2025-12-10T11:16:13.554Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T11:21:59.587Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T11:21:59.587Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:21:59.588Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:21:59.588Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T11:21:59.588Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T11:21:59.588Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T11:21:59.588Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T11:21:59.588Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T11:22:59.588Z"
  }
}
[2025-12-10T11:21:59.594Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T11:21:59.595Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:21:59.595Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:21:59.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T11:21:59.595Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T11:21:59.595Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T11:21:59.599Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T11:21:59.599Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T11:22:59.588Z"
  }
}
[2025-12-10T11:21:59.620Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T11:21:59.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:21:59.620Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:21:59.620Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T11:21:59.620Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T11:21:59.620Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T11:21:59.620Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T11:21:59.620Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T11:22:59.620Z"
  }
}
[2025-12-10T11:22:00.664Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T11:22:00.666Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T11:22:00.666Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T11:22:00.666Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T11:22:00.666Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-10T11:22:00.666Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T11:22:00.666Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T11:22:00.666Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T11:22:59.588Z"
  }
}
[2025-12-10T15:12:48.150Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379568150",
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.152Z] Creating new entry
{
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.152Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:48.152Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:48.152Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379568150",
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.152Z] Found existing entry
{
  "key": "login:test-allow-1765379568150",
  "timestampCount": 1
}
[2025-12-10T15:12:48.152Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:48.152Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:48.152Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379568150",
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.152Z] Found existing entry
{
  "key": "login:test-allow-1765379568150",
  "timestampCount": 2
}
[2025-12-10T15:12:48.152Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:48.152Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379568150",
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.153Z] Found existing entry
{
  "key": "login:test-allow-1765379568150",
  "timestampCount": 3
}
[2025-12-10T15:12:48.153Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:48.153Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379568150",
  "key": "login:test-allow-1765379568150"
}
[2025-12-10T15:12:48.153Z] Found existing entry
{
  "key": "login:test-allow-1765379568150",
  "timestampCount": 4
}
[2025-12-10T15:12:48.153Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:48.153Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.153Z] Creating new entry
{
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.153Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:48.153Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.153Z] Found existing entry
{
  "key": "login:test-block-1765379568153",
  "timestampCount": 1
}
[2025-12-10T15:12:48.153Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:48.153Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.153Z] Found existing entry
{
  "key": "login:test-block-1765379568153",
  "timestampCount": 2
}
[2025-12-10T15:12:48.153Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:48.153Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:48.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.154Z] Found existing entry
{
  "key": "login:test-block-1765379568153",
  "timestampCount": 3
}
[2025-12-10T15:12:48.154Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:48.154Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:48.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.154Z] Found existing entry
{
  "key": "login:test-block-1765379568153",
  "timestampCount": 4
}
[2025-12-10T15:12:48.154Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:48.154Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:48.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379568153",
  "key": "login:test-block-1765379568153"
}
[2025-12-10T15:12:48.154Z] Found existing entry
{
  "key": "login:test-block-1765379568153",
  "timestampCount": 5
}
[2025-12-10T15:12:48.154Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:12:48.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379568154",
  "key": "test-reset:test-reset-1765379568154"
}
[2025-12-10T15:12:48.154Z] Creating new entry
{
  "key": "test-reset:test-reset-1765379568154"
}
[2025-12-10T15:12:48.155Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:12:48.155Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:12:48.155Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379568154",
  "key": "test-reset:test-reset-1765379568154"
}
[2025-12-10T15:12:48.155Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379568154",
  "timestampCount": 1
}
[2025-12-10T15:12:48.155Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:12:48.155Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:12:48.155Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379568154",
  "key": "test-reset:test-reset-1765379568154"
}
[2025-12-10T15:12:48.155Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379568154",
  "timestampCount": 2
}
[2025-12-10T15:12:48.155Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:12:48.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379568154",
  "key": "test-reset:test-reset-1765379568154"
}
[2025-12-10T15:12:48.305Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379568154",
  "timestampCount": 2
}
[2025-12-10T15:12:48.305Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:12:48.305Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:12:48.305Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:12:48.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.305Z] Creating new entry
{
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.305Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:48.305Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:48.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.305Z] Found existing entry
{
  "key": "login:test-multi-1-1765379568305",
  "timestampCount": 1
}
[2025-12-10T15:12:48.305Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.306Z] Found existing entry
{
  "key": "login:test-multi-1-1765379568305",
  "timestampCount": 2
}
[2025-12-10T15:12:48.306Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.306Z] Found existing entry
{
  "key": "login:test-multi-1-1765379568305",
  "timestampCount": 3
}
[2025-12-10T15:12:48.306Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.306Z] Found existing entry
{
  "key": "login:test-multi-1-1765379568305",
  "timestampCount": 4
}
[2025-12-10T15:12:48.306Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379568305",
  "key": "login:test-multi-1-1765379568305"
}
[2025-12-10T15:12:48.306Z] Found existing entry
{
  "key": "login:test-multi-1-1765379568305",
  "timestampCount": 5
}
[2025-12-10T15:12:48.306Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765379568305",
  "key": "login:test-multi-2-1765379568305"
}
[2025-12-10T15:12:48.306Z] Creating new entry
{
  "key": "login:test-multi-2-1765379568305"
}
[2025-12-10T15:12:48.306Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:48.306Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:48.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765379568306",
  "key": "login:test-reset-time-1765379568306"
}
[2025-12-10T15:12:48.307Z] Creating new entry
{
  "key": "login:test-reset-time-1765379568306"
}
[2025-12-10T15:12:48.307Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:48.307Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:48.308Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:48.308Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:48.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:48.309Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:12:48.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:48.309Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:48.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:48.309Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:12:48.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:48.309Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:48.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765379568309",
  "key": "test-sliding:test-sliding-1765379568309"
}
[2025-12-10T15:12:48.309Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765379568309"
}
[2025-12-10T15:12:48.309Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:12:48.309Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:12:54.934Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379574934",
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.934Z] Creating new entry
{
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.934Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:54.934Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379574934",
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.935Z] Found existing entry
{
  "key": "login:test-allow-1765379574934",
  "timestampCount": 1
}
[2025-12-10T15:12:54.935Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:54.935Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379574934",
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.935Z] Found existing entry
{
  "key": "login:test-allow-1765379574934",
  "timestampCount": 2
}
[2025-12-10T15:12:54.935Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:54.935Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379574934",
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.935Z] Found existing entry
{
  "key": "login:test-allow-1765379574934",
  "timestampCount": 3
}
[2025-12-10T15:12:54.935Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:54.935Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765379574934",
  "key": "login:test-allow-1765379574934"
}
[2025-12-10T15:12:54.935Z] Found existing entry
{
  "key": "login:test-allow-1765379574934",
  "timestampCount": 4
}
[2025-12-10T15:12:54.935Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:54.935Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.935Z] Creating new entry
{
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.935Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:54.935Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:54.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.935Z] Found existing entry
{
  "key": "login:test-block-1765379574935",
  "timestampCount": 1
}
[2025-12-10T15:12:54.936Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:54.936Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:54.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.936Z] Found existing entry
{
  "key": "login:test-block-1765379574935",
  "timestampCount": 2
}
[2025-12-10T15:12:54.936Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:54.936Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:54.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.936Z] Found existing entry
{
  "key": "login:test-block-1765379574935",
  "timestampCount": 3
}
[2025-12-10T15:12:54.936Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:54.936Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:54.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.936Z] Found existing entry
{
  "key": "login:test-block-1765379574935",
  "timestampCount": 4
}
[2025-12-10T15:12:54.936Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:54.936Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:54.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765379574935",
  "key": "login:test-block-1765379574935"
}
[2025-12-10T15:12:54.936Z] Found existing entry
{
  "key": "login:test-block-1765379574935",
  "timestampCount": 5
}
[2025-12-10T15:12:54.936Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:12:54.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379574937",
  "key": "test-reset:test-reset-1765379574937"
}
[2025-12-10T15:12:54.937Z] Creating new entry
{
  "key": "test-reset:test-reset-1765379574937"
}
[2025-12-10T15:12:54.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:12:54.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:12:54.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379574937",
  "key": "test-reset:test-reset-1765379574937"
}
[2025-12-10T15:12:54.937Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379574937",
  "timestampCount": 1
}
[2025-12-10T15:12:54.937Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:12:54.937Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:12:54.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379574937",
  "key": "test-reset:test-reset-1765379574937"
}
[2025-12-10T15:12:54.937Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379574937",
  "timestampCount": 2
}
[2025-12-10T15:12:54.937Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:12:55.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765379574937",
  "key": "test-reset:test-reset-1765379574937"
}
[2025-12-10T15:12:55.089Z] Found existing entry
{
  "key": "test-reset:test-reset-1765379574937",
  "timestampCount": 2
}
[2025-12-10T15:12:55.089Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:12:55.089Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:12:55.089Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:12:55.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.090Z] Creating new entry
{
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.090Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:55.090Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:55.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.090Z] Found existing entry
{
  "key": "login:test-multi-1-1765379575090",
  "timestampCount": 1
}
[2025-12-10T15:12:55.090Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:12:55.090Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:12:55.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.090Z] Found existing entry
{
  "key": "login:test-multi-1-1765379575090",
  "timestampCount": 2
}
[2025-12-10T15:12:55.090Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:12:55.090Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:12:55.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.091Z] Found existing entry
{
  "key": "login:test-multi-1-1765379575090",
  "timestampCount": 3
}
[2025-12-10T15:12:55.091Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:12:55.091Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:12:55.091Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.091Z] Found existing entry
{
  "key": "login:test-multi-1-1765379575090",
  "timestampCount": 4
}
[2025-12-10T15:12:55.091Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:12:55.091Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:12:55.092Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765379575090",
  "key": "login:test-multi-1-1765379575090"
}
[2025-12-10T15:12:55.092Z] Found existing entry
{
  "key": "login:test-multi-1-1765379575090",
  "timestampCount": 5
}
[2025-12-10T15:12:55.092Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:12:55.092Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765379575090",
  "key": "login:test-multi-2-1765379575090"
}
[2025-12-10T15:12:55.092Z] Creating new entry
{
  "key": "login:test-multi-2-1765379575090"
}
[2025-12-10T15:12:55.093Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:55.093Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:55.093Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765379575093",
  "key": "login:test-reset-time-1765379575093"
}
[2025-12-10T15:12:55.093Z] Creating new entry
{
  "key": "login:test-reset-time-1765379575093"
}
[2025-12-10T15:12:55.093Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:12:55.093Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:12:55.094Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:55.094Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:55.095Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:55.095Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:12:55.095Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:55.095Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:55.095Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:55.095Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:12:55.095Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:12:55.095Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:12:55.095Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765379575095",
  "key": "test-sliding:test-sliding-1765379575095"
}
[2025-12-10T15:12:55.095Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765379575095"
}
[2025-12-10T15:12:55.095Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:12:55.095Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:12:55.196Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765379575095",
  "key": "test-sliding:test-sliding-1765379575095"
}
[2025-12-10T15:12:55.196Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765379575095",
  "timestampCount": 1
}
[2025-12-10T15:12:55.196Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:12:55.196Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:12:55.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765379575095",
  "key": "test-sliding:test-sliding-1765379575095"
}
[2025-12-10T15:12:55.297Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765379575095",
  "timestampCount": 2
}
[2025-12-10T15:12:55.297Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:12:55.297Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:12:55.297Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:12:55.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765379575297",
  "key": "register:test-format-allowed-1765379575297"
}
[2025-12-10T15:12:55.297Z] Creating new entry
{
  "key": "register:test-format-allowed-1765379575297"
}
[2025-12-10T15:12:55.297Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:12:55.297Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:12:55.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765379575297",
  "key": "register:test-format-blocked-1765379575297"
}
[2025-12-10T15:12:55.297Z] Creating new entry
{
  "key": "register:test-format-blocked-1765379575297"
}
[2025-12-10T15:12:55.298Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:12:55.298Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:12:55.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765379575297",
  "key": "register:test-format-blocked-1765379575297"
}
[2025-12-10T15:12:55.298Z] Found existing entry
{
  "key": "register:test-format-blocked-1765379575297",
  "timestampCount": 1
}
[2025-12-10T15:12:55.298Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:12:55.298Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:12:55.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765379575297",
  "key": "register:test-format-blocked-1765379575297"
}
[2025-12-10T15:12:55.298Z] Found existing entry
{
  "key": "register:test-format-blocked-1765379575297",
  "timestampCount": 2
}
[2025-12-10T15:12:55.298Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:12:55.298Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:12:55.298Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765379575297",
  "key": "register:test-format-blocked-1765379575297"
}
[2025-12-10T15:12:55.298Z] Found existing entry
{
  "key": "register:test-format-blocked-1765379575297",
  "timestampCount": 3
}
[2025-12-10T15:12:55.298Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:20:44.575Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380044575",
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.575Z] Creating new entry
{
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.575Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:20:44.575Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:20:44.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380044575",
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.576Z] Found existing entry
{
  "key": "login:test-allow-1765380044575",
  "timestampCount": 1
}
[2025-12-10T15:20:44.576Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:20:44.576Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:20:44.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380044575",
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.576Z] Found existing entry
{
  "key": "login:test-allow-1765380044575",
  "timestampCount": 2
}
[2025-12-10T15:20:44.576Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:20:44.576Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:20:44.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380044575",
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.576Z] Found existing entry
{
  "key": "login:test-allow-1765380044575",
  "timestampCount": 3
}
[2025-12-10T15:20:44.576Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:20:44.576Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:20:44.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380044575",
  "key": "login:test-allow-1765380044575"
}
[2025-12-10T15:20:44.576Z] Found existing entry
{
  "key": "login:test-allow-1765380044575",
  "timestampCount": 4
}
[2025-12-10T15:20:44.576Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:20:44.576Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Creating new entry
{
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:20:44.577Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Found existing entry
{
  "key": "login:test-block-1765380044577",
  "timestampCount": 1
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:20:44.577Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Found existing entry
{
  "key": "login:test-block-1765380044577",
  "timestampCount": 2
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:20:44.577Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Found existing entry
{
  "key": "login:test-block-1765380044577",
  "timestampCount": 3
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:20:44.577Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Found existing entry
{
  "key": "login:test-block-1765380044577",
  "timestampCount": 4
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:20:44.577Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:20:44.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380044577",
  "key": "login:test-block-1765380044577"
}
[2025-12-10T15:20:44.577Z] Found existing entry
{
  "key": "login:test-block-1765380044577",
  "timestampCount": 5
}
[2025-12-10T15:20:44.577Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:20:44.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380044578",
  "key": "test-reset:test-reset-1765380044578"
}
[2025-12-10T15:20:44.578Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380044578"
}
[2025-12-10T15:20:44.578Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:20:44.578Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:20:44.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380044578",
  "key": "test-reset:test-reset-1765380044578"
}
[2025-12-10T15:20:44.578Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380044578",
  "timestampCount": 1
}
[2025-12-10T15:20:44.578Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:20:44.578Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:20:44.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380044578",
  "key": "test-reset:test-reset-1765380044578"
}
[2025-12-10T15:20:44.578Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380044578",
  "timestampCount": 2
}
[2025-12-10T15:20:44.578Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:20:44.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380044578",
  "key": "test-reset:test-reset-1765380044578"
}
[2025-12-10T15:20:44.733Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380044578",
  "timestampCount": 2
}
[2025-12-10T15:20:44.733Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:20:44.733Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:20:44.733Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:20:44.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.733Z] Creating new entry
{
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.733Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:20:44.733Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:20:44.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.733Z] Found existing entry
{
  "key": "login:test-multi-1-1765380044733",
  "timestampCount": 1
}
[2025-12-10T15:20:44.733Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:20:44.734Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:20:44.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.734Z] Found existing entry
{
  "key": "login:test-multi-1-1765380044733",
  "timestampCount": 2
}
[2025-12-10T15:20:44.734Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:20:44.734Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:20:44.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.734Z] Found existing entry
{
  "key": "login:test-multi-1-1765380044733",
  "timestampCount": 3
}
[2025-12-10T15:20:44.734Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:20:44.734Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:20:44.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.734Z] Found existing entry
{
  "key": "login:test-multi-1-1765380044733",
  "timestampCount": 4
}
[2025-12-10T15:20:44.734Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:20:44.734Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:20:44.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380044733",
  "key": "login:test-multi-1-1765380044733"
}
[2025-12-10T15:20:44.734Z] Found existing entry
{
  "key": "login:test-multi-1-1765380044733",
  "timestampCount": 5
}
[2025-12-10T15:20:44.734Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:20:44.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380044733",
  "key": "login:test-multi-2-1765380044733"
}
[2025-12-10T15:20:44.735Z] Creating new entry
{
  "key": "login:test-multi-2-1765380044733"
}
[2025-12-10T15:20:44.735Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:20:44.735Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:20:44.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380044735",
  "key": "login:test-reset-time-1765380044735"
}
[2025-12-10T15:20:44.735Z] Creating new entry
{
  "key": "login:test-reset-time-1765380044735"
}
[2025-12-10T15:20:44.735Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:20:44.735Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:20:44.736Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:20:44.736Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:20:44.736Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:20:44.736Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:20:44.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:20:44.737Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:20:44.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:20:44.737Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:20:44.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:20:44.737Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:20:44.737Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380044737",
  "key": "test-sliding:test-sliding-1765380044737"
}
[2025-12-10T15:20:44.737Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380044737"
}
[2025-12-10T15:20:44.737Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:20:44.737Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:20:44.837Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380044737",
  "key": "test-sliding:test-sliding-1765380044737"
}
[2025-12-10T15:20:44.837Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380044737",
  "timestampCount": 1
}
[2025-12-10T15:20:44.837Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:20:44.837Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:20:44.940Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380044737",
  "key": "test-sliding:test-sliding-1765380044737"
}
[2025-12-10T15:20:44.940Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380044737",
  "timestampCount": 2
}
[2025-12-10T15:20:44.940Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:20:44.940Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:20:44.941Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:20:44.941Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380044941",
  "key": "register:test-format-allowed-1765380044941"
}
[2025-12-10T15:20:44.941Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380044941"
}
[2025-12-10T15:20:44.941Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:20:44.941Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:20:44.941Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380044941",
  "key": "register:test-format-blocked-1765380044941"
}
[2025-12-10T15:20:44.941Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380044941"
}
[2025-12-10T15:20:44.941Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:20:44.941Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:20:44.941Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380044941",
  "key": "register:test-format-blocked-1765380044941"
}
[2025-12-10T15:20:44.942Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380044941",
  "timestampCount": 1
}
[2025-12-10T15:20:44.942Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:20:44.942Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:20:44.942Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380044941",
  "key": "register:test-format-blocked-1765380044941"
}
[2025-12-10T15:20:44.942Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380044941",
  "timestampCount": 2
}
[2025-12-10T15:20:44.942Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:20:44.942Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:20:44.942Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380044941",
  "key": "register:test-format-blocked-1765380044941"
}
[2025-12-10T15:20:44.942Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380044941",
  "timestampCount": 3
}
[2025-12-10T15:20:44.942Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:24:28.755Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380268755",
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.756Z] Creating new entry
{
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.756Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:24:28.756Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:24:28.756Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380268755",
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.756Z] Found existing entry
{
  "key": "login:test-allow-1765380268755",
  "timestampCount": 1
}
[2025-12-10T15:24:28.756Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:24:28.756Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:24:28.756Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380268755",
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.757Z] Found existing entry
{
  "key": "login:test-allow-1765380268755",
  "timestampCount": 2
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380268755",
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.757Z] Found existing entry
{
  "key": "login:test-allow-1765380268755",
  "timestampCount": 3
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380268755",
  "key": "login:test-allow-1765380268755"
}
[2025-12-10T15:24:28.757Z] Found existing entry
{
  "key": "login:test-allow-1765380268755",
  "timestampCount": 4
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.757Z] Creating new entry
{
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.757Z] Found existing entry
{
  "key": "login:test-block-1765380268757",
  "timestampCount": 1
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.757Z] Found existing entry
{
  "key": "login:test-block-1765380268757",
  "timestampCount": 2
}
[2025-12-10T15:24:28.757Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:24:28.757Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:24:28.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.758Z] Found existing entry
{
  "key": "login:test-block-1765380268757",
  "timestampCount": 3
}
[2025-12-10T15:24:28.758Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:24:28.758Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:24:28.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.758Z] Found existing entry
{
  "key": "login:test-block-1765380268757",
  "timestampCount": 4
}
[2025-12-10T15:24:28.758Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:24:28.758Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:24:28.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380268757",
  "key": "login:test-block-1765380268757"
}
[2025-12-10T15:24:28.758Z] Found existing entry
{
  "key": "login:test-block-1765380268757",
  "timestampCount": 5
}
[2025-12-10T15:24:28.758Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:24:28.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380268758",
  "key": "test-reset:test-reset-1765380268758"
}
[2025-12-10T15:24:28.758Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380268758"
}
[2025-12-10T15:24:28.758Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:24:28.758Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:24:28.759Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380268758",
  "key": "test-reset:test-reset-1765380268758"
}
[2025-12-10T15:24:28.759Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380268758",
  "timestampCount": 1
}
[2025-12-10T15:24:28.759Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:24:28.759Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:24:28.759Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380268758",
  "key": "test-reset:test-reset-1765380268758"
}
[2025-12-10T15:24:28.759Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380268758",
  "timestampCount": 2
}
[2025-12-10T15:24:28.759Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:24:28.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380268758",
  "key": "test-reset:test-reset-1765380268758"
}
[2025-12-10T15:24:28.910Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380268758",
  "timestampCount": 2
}
[2025-12-10T15:24:28.910Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:24:28.910Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Creating new entry
{
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Found existing entry
{
  "key": "login:test-multi-1-1765380268911",
  "timestampCount": 1
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Found existing entry
{
  "key": "login:test-multi-1-1765380268911",
  "timestampCount": 2
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Found existing entry
{
  "key": "login:test-multi-1-1765380268911",
  "timestampCount": 3
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Found existing entry
{
  "key": "login:test-multi-1-1765380268911",
  "timestampCount": 4
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:24:28.911Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:24:28.911Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380268911",
  "key": "login:test-multi-1-1765380268911"
}
[2025-12-10T15:24:28.911Z] Found existing entry
{
  "key": "login:test-multi-1-1765380268911",
  "timestampCount": 5
}
[2025-12-10T15:24:28.911Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:24:28.912Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380268911",
  "key": "login:test-multi-2-1765380268911"
}
[2025-12-10T15:24:28.912Z] Creating new entry
{
  "key": "login:test-multi-2-1765380268911"
}
[2025-12-10T15:24:28.912Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:24:28.912Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:24:28.912Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380268912",
  "key": "login:test-reset-time-1765380268912"
}
[2025-12-10T15:24:28.912Z] Creating new entry
{
  "key": "login:test-reset-time-1765380268912"
}
[2025-12-10T15:24:28.912Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:24:28.912Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:24:28.913Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:24:28.913Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:24:28.913Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:24:28.914Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:24:28.914Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:24:28.914Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:24:28.914Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:24:28.914Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:24:28.914Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:24:28.914Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:24:28.914Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380268914",
  "key": "test-sliding:test-sliding-1765380268914"
}
[2025-12-10T15:24:28.914Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380268914"
}
[2025-12-10T15:24:28.914Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:24:28.914Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:24:29.016Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380268914",
  "key": "test-sliding:test-sliding-1765380268914"
}
[2025-12-10T15:24:29.016Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380268914",
  "timestampCount": 1
}
[2025-12-10T15:24:29.016Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:24:29.016Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:24:29.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380268914",
  "key": "test-sliding:test-sliding-1765380268914"
}
[2025-12-10T15:24:29.118Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380268914",
  "timestampCount": 2
}
[2025-12-10T15:24:29.118Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:24:29.118Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:24:29.118Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:24:29.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380269118",
  "key": "register:test-format-allowed-1765380269118"
}
[2025-12-10T15:24:29.118Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380269118"
}
[2025-12-10T15:24:29.118Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:24:29.118Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:24:29.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380269119",
  "key": "register:test-format-blocked-1765380269119"
}
[2025-12-10T15:24:29.119Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380269119"
}
[2025-12-10T15:24:29.119Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:24:29.119Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:24:29.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380269119",
  "key": "register:test-format-blocked-1765380269119"
}
[2025-12-10T15:24:29.119Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380269119",
  "timestampCount": 1
}
[2025-12-10T15:24:29.119Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:24:29.119Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:24:29.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380269119",
  "key": "register:test-format-blocked-1765380269119"
}
[2025-12-10T15:24:29.119Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380269119",
  "timestampCount": 2
}
[2025-12-10T15:24:29.119Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:24:29.119Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:24:29.119Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380269119",
  "key": "register:test-format-blocked-1765380269119"
}
[2025-12-10T15:24:29.119Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380269119",
  "timestampCount": 3
}
[2025-12-10T15:24:29.119Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:27:04.934Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380424934",
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.935Z] Creating new entry
{
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.935Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:27:04.935Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:27:04.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380424934",
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.935Z] Found existing entry
{
  "key": "login:test-allow-1765380424934",
  "timestampCount": 1
}
[2025-12-10T15:27:04.935Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:27:04.935Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380424934",
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.936Z] Found existing entry
{
  "key": "login:test-allow-1765380424934",
  "timestampCount": 2
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380424934",
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.936Z] Found existing entry
{
  "key": "login:test-allow-1765380424934",
  "timestampCount": 3
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380424934",
  "key": "login:test-allow-1765380424934"
}
[2025-12-10T15:27:04.936Z] Found existing entry
{
  "key": "login:test-allow-1765380424934",
  "timestampCount": 4
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.936Z] Creating new entry
{
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.936Z] Found existing entry
{
  "key": "login:test-block-1765380424936",
  "timestampCount": 1
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:27:04.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.936Z] Found existing entry
{
  "key": "login:test-block-1765380424936",
  "timestampCount": 2
}
[2025-12-10T15:27:04.936Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:27:04.936Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:27:04.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.937Z] Found existing entry
{
  "key": "login:test-block-1765380424936",
  "timestampCount": 3
}
[2025-12-10T15:27:04.937Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:27:04.937Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:27:04.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.937Z] Found existing entry
{
  "key": "login:test-block-1765380424936",
  "timestampCount": 4
}
[2025-12-10T15:27:04.937Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:27:04.937Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:27:04.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380424936",
  "key": "login:test-block-1765380424936"
}
[2025-12-10T15:27:04.937Z] Found existing entry
{
  "key": "login:test-block-1765380424936",
  "timestampCount": 5
}
[2025-12-10T15:27:04.937Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:27:04.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380424937",
  "key": "test-reset:test-reset-1765380424937"
}
[2025-12-10T15:27:04.937Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380424937"
}
[2025-12-10T15:27:04.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:27:04.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:27:04.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380424937",
  "key": "test-reset:test-reset-1765380424937"
}
[2025-12-10T15:27:04.938Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380424937",
  "timestampCount": 1
}
[2025-12-10T15:27:04.938Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:27:04.938Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:27:04.938Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380424937",
  "key": "test-reset:test-reset-1765380424937"
}
[2025-12-10T15:27:04.938Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380424937",
  "timestampCount": 2
}
[2025-12-10T15:27:04.938Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:27:05.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380424937",
  "key": "test-reset:test-reset-1765380424937"
}
[2025-12-10T15:27:05.089Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380424937",
  "timestampCount": 2
}
[2025-12-10T15:27:05.089Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:27:05.089Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:27:05.089Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:27:05.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.089Z] Creating new entry
{
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.089Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:27:05.089Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:27:05.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.089Z] Found existing entry
{
  "key": "login:test-multi-1-1765380425089",
  "timestampCount": 1
}
[2025-12-10T15:27:05.089Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:27:05.089Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:27:05.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.089Z] Found existing entry
{
  "key": "login:test-multi-1-1765380425089",
  "timestampCount": 2
}
[2025-12-10T15:27:05.089Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:27:05.089Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:27:05.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.089Z] Found existing entry
{
  "key": "login:test-multi-1-1765380425089",
  "timestampCount": 3
}
[2025-12-10T15:27:05.090Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:27:05.090Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:27:05.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.090Z] Found existing entry
{
  "key": "login:test-multi-1-1765380425089",
  "timestampCount": 4
}
[2025-12-10T15:27:05.090Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:27:05.090Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:27:05.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380425089",
  "key": "login:test-multi-1-1765380425089"
}
[2025-12-10T15:27:05.090Z] Found existing entry
{
  "key": "login:test-multi-1-1765380425089",
  "timestampCount": 5
}
[2025-12-10T15:27:05.090Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:27:05.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380425089",
  "key": "login:test-multi-2-1765380425089"
}
[2025-12-10T15:27:05.090Z] Creating new entry
{
  "key": "login:test-multi-2-1765380425089"
}
[2025-12-10T15:27:05.090Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:27:05.090Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:27:05.090Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380425090",
  "key": "login:test-reset-time-1765380425090"
}
[2025-12-10T15:27:05.090Z] Creating new entry
{
  "key": "login:test-reset-time-1765380425090"
}
[2025-12-10T15:27:05.090Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:27:05.090Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:27:05.091Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:27:05.091Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:27:05.092Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:27:05.092Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:27:05.092Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:27:05.092Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:27:05.092Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:27:05.092Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:27:05.092Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:27:05.092Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:27:05.092Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380425092",
  "key": "test-sliding:test-sliding-1765380425092"
}
[2025-12-10T15:27:05.092Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380425092"
}
[2025-12-10T15:27:05.092Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:27:05.092Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:27:05.192Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380425092",
  "key": "test-sliding:test-sliding-1765380425092"
}
[2025-12-10T15:27:05.192Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380425092",
  "timestampCount": 1
}
[2025-12-10T15:27:05.192Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:27:05.193Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:27:05.295Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380425092",
  "key": "test-sliding:test-sliding-1765380425092"
}
[2025-12-10T15:27:05.295Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380425092",
  "timestampCount": 2
}
[2025-12-10T15:27:05.295Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:27:05.295Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:27:05.295Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:27:05.296Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380425296",
  "key": "register:test-format-allowed-1765380425296"
}
[2025-12-10T15:27:05.296Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380425296"
}
[2025-12-10T15:27:05.296Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:27:05.296Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:27:05.296Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380425296",
  "key": "register:test-format-blocked-1765380425296"
}
[2025-12-10T15:27:05.296Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380425296"
}
[2025-12-10T15:27:05.297Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:27:05.297Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:27:05.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380425296",
  "key": "register:test-format-blocked-1765380425296"
}
[2025-12-10T15:27:05.297Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380425296",
  "timestampCount": 1
}
[2025-12-10T15:27:05.297Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:27:05.297Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:27:05.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380425296",
  "key": "register:test-format-blocked-1765380425296"
}
[2025-12-10T15:27:05.297Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380425296",
  "timestampCount": 2
}
[2025-12-10T15:27:05.297Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:27:05.297Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:27:05.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380425296",
  "key": "register:test-format-blocked-1765380425296"
}
[2025-12-10T15:27:05.297Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380425296",
  "timestampCount": 3
}
[2025-12-10T15:27:05.297Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:28:28.462Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380508461",
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Creating new entry
{
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:28:28.463Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:28:28.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380508461",
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Found existing entry
{
  "key": "login:test-allow-1765380508461",
  "timestampCount": 1
}
[2025-12-10T15:28:28.463Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:28:28.463Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:28:28.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380508461",
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Found existing entry
{
  "key": "login:test-allow-1765380508461",
  "timestampCount": 2
}
[2025-12-10T15:28:28.463Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:28:28.463Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:28:28.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380508461",
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Found existing entry
{
  "key": "login:test-allow-1765380508461",
  "timestampCount": 3
}
[2025-12-10T15:28:28.463Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:28:28.463Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:28:28.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380508461",
  "key": "login:test-allow-1765380508461"
}
[2025-12-10T15:28:28.463Z] Found existing entry
{
  "key": "login:test-allow-1765380508461",
  "timestampCount": 4
}
[2025-12-10T15:28:28.463Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:28:28.463Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Creating new entry
{
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:28:28.464Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Found existing entry
{
  "key": "login:test-block-1765380508464",
  "timestampCount": 1
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:28:28.464Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Found existing entry
{
  "key": "login:test-block-1765380508464",
  "timestampCount": 2
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:28:28.464Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Found existing entry
{
  "key": "login:test-block-1765380508464",
  "timestampCount": 3
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:28:28.464Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Found existing entry
{
  "key": "login:test-block-1765380508464",
  "timestampCount": 4
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:28:28.464Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:28:28.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380508464",
  "key": "login:test-block-1765380508464"
}
[2025-12-10T15:28:28.464Z] Found existing entry
{
  "key": "login:test-block-1765380508464",
  "timestampCount": 5
}
[2025-12-10T15:28:28.464Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:28:28.465Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380508465",
  "key": "test-reset:test-reset-1765380508465"
}
[2025-12-10T15:28:28.465Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380508465"
}
[2025-12-10T15:28:28.465Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:28:28.465Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:28:28.465Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380508465",
  "key": "test-reset:test-reset-1765380508465"
}
[2025-12-10T15:28:28.465Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380508465",
  "timestampCount": 1
}
[2025-12-10T15:28:28.465Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:28:28.465Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:28:28.465Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380508465",
  "key": "test-reset:test-reset-1765380508465"
}
[2025-12-10T15:28:28.465Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380508465",
  "timestampCount": 2
}
[2025-12-10T15:28:28.465Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:28:28.616Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380508465",
  "key": "test-reset:test-reset-1765380508465"
}
[2025-12-10T15:28:28.616Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380508465",
  "timestampCount": 2
}
[2025-12-10T15:28:28.616Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:28:28.616Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:28:28.616Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:28:28.616Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Creating new entry
{
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Found existing entry
{
  "key": "login:test-multi-1-1765380508616",
  "timestampCount": 1
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Found existing entry
{
  "key": "login:test-multi-1-1765380508616",
  "timestampCount": 2
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Found existing entry
{
  "key": "login:test-multi-1-1765380508616",
  "timestampCount": 3
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Found existing entry
{
  "key": "login:test-multi-1-1765380508616",
  "timestampCount": 4
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380508616",
  "key": "login:test-multi-1-1765380508616"
}
[2025-12-10T15:28:28.617Z] Found existing entry
{
  "key": "login:test-multi-1-1765380508616",
  "timestampCount": 5
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380508616",
  "key": "login:test-multi-2-1765380508616"
}
[2025-12-10T15:28:28.617Z] Creating new entry
{
  "key": "login:test-multi-2-1765380508616"
}
[2025-12-10T15:28:28.617Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:28:28.617Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:28:28.618Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380508618",
  "key": "login:test-reset-time-1765380508618"
}
[2025-12-10T15:28:28.618Z] Creating new entry
{
  "key": "login:test-reset-time-1765380508618"
}
[2025-12-10T15:28:28.618Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:28:28.618Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:28:28.619Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:28:28.619Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:28:28.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:28:28.620Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:28:28.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:28:28.620Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:28:28.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:28:28.620Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:28:28.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:28:28.620Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:28:28.620Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380508620",
  "key": "test-sliding:test-sliding-1765380508620"
}
[2025-12-10T15:28:28.620Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380508620"
}
[2025-12-10T15:28:28.620Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:28:28.620Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:28:28.721Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380508620",
  "key": "test-sliding:test-sliding-1765380508620"
}
[2025-12-10T15:28:28.721Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380508620",
  "timestampCount": 1
}
[2025-12-10T15:28:28.721Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:28:28.721Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:28:28.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380508620",
  "key": "test-sliding:test-sliding-1765380508620"
}
[2025-12-10T15:28:28.833Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380508620",
  "timestampCount": 2
}
[2025-12-10T15:28:28.833Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:28:28.833Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:28:28.834Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:28:28.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380508834",
  "key": "register:test-format-allowed-1765380508834"
}
[2025-12-10T15:28:28.834Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380508834"
}
[2025-12-10T15:28:28.834Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:28:28.834Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:28:28.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380508834",
  "key": "register:test-format-blocked-1765380508834"
}
[2025-12-10T15:28:28.834Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380508834"
}
[2025-12-10T15:28:28.834Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:28:28.834Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:28:28.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380508834",
  "key": "register:test-format-blocked-1765380508834"
}
[2025-12-10T15:28:28.834Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380508834",
  "timestampCount": 1
}
[2025-12-10T15:28:28.835Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:28:28.835Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:28:28.835Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380508834",
  "key": "register:test-format-blocked-1765380508834"
}
[2025-12-10T15:28:28.835Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380508834",
  "timestampCount": 2
}
[2025-12-10T15:28:28.835Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:28:28.835Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:28:28.835Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380508834",
  "key": "register:test-format-blocked-1765380508834"
}
[2025-12-10T15:28:28.835Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380508834",
  "timestampCount": 3
}
[2025-12-10T15:28:28.835Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:29:40.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380580476",
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.477Z] Creating new entry
{
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.477Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:29:40.477Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:29:40.477Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380580476",
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.477Z] Found existing entry
{
  "key": "login:test-allow-1765380580476",
  "timestampCount": 1
}
[2025-12-10T15:29:40.478Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:29:40.478Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:29:40.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380580476",
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.478Z] Found existing entry
{
  "key": "login:test-allow-1765380580476",
  "timestampCount": 2
}
[2025-12-10T15:29:40.478Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:29:40.478Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:29:40.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380580476",
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.478Z] Found existing entry
{
  "key": "login:test-allow-1765380580476",
  "timestampCount": 3
}
[2025-12-10T15:29:40.478Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:29:40.478Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:29:40.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380580476",
  "key": "login:test-allow-1765380580476"
}
[2025-12-10T15:29:40.478Z] Found existing entry
{
  "key": "login:test-allow-1765380580476",
  "timestampCount": 4
}
[2025-12-10T15:29:40.478Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:29:40.478Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:29:40.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.478Z] Creating new entry
{
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.478Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:29:40.478Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:29:40.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.479Z] Found existing entry
{
  "key": "login:test-block-1765380580478",
  "timestampCount": 1
}
[2025-12-10T15:29:40.479Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:29:40.479Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:29:40.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.479Z] Found existing entry
{
  "key": "login:test-block-1765380580478",
  "timestampCount": 2
}
[2025-12-10T15:29:40.479Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:29:40.479Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:29:40.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.479Z] Found existing entry
{
  "key": "login:test-block-1765380580478",
  "timestampCount": 3
}
[2025-12-10T15:29:40.479Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:29:40.479Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:29:40.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.479Z] Found existing entry
{
  "key": "login:test-block-1765380580478",
  "timestampCount": 4
}
[2025-12-10T15:29:40.479Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:29:40.479Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:29:40.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380580478",
  "key": "login:test-block-1765380580478"
}
[2025-12-10T15:29:40.479Z] Found existing entry
{
  "key": "login:test-block-1765380580478",
  "timestampCount": 5
}
[2025-12-10T15:29:40.479Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:29:40.480Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380580480",
  "key": "test-reset:test-reset-1765380580480"
}
[2025-12-10T15:29:40.480Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380580480"
}
[2025-12-10T15:29:40.480Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:29:40.480Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:29:40.480Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380580480",
  "key": "test-reset:test-reset-1765380580480"
}
[2025-12-10T15:29:40.480Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380580480",
  "timestampCount": 1
}
[2025-12-10T15:29:40.480Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:29:40.480Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:29:40.480Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380580480",
  "key": "test-reset:test-reset-1765380580480"
}
[2025-12-10T15:29:40.480Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380580480",
  "timestampCount": 2
}
[2025-12-10T15:29:40.480Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:29:40.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380580480",
  "key": "test-reset:test-reset-1765380580480"
}
[2025-12-10T15:29:40.631Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380580480",
  "timestampCount": 2
}
[2025-12-10T15:29:40.631Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Creating new entry
{
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Found existing entry
{
  "key": "login:test-multi-1-1765380580632",
  "timestampCount": 1
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Found existing entry
{
  "key": "login:test-multi-1-1765380580632",
  "timestampCount": 2
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Found existing entry
{
  "key": "login:test-multi-1-1765380580632",
  "timestampCount": 3
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Found existing entry
{
  "key": "login:test-multi-1-1765380580632",
  "timestampCount": 4
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:29:40.632Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:29:40.632Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380580632",
  "key": "login:test-multi-1-1765380580632"
}
[2025-12-10T15:29:40.632Z] Found existing entry
{
  "key": "login:test-multi-1-1765380580632",
  "timestampCount": 5
}
[2025-12-10T15:29:40.632Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:29:40.633Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380580632",
  "key": "login:test-multi-2-1765380580632"
}
[2025-12-10T15:29:40.633Z] Creating new entry
{
  "key": "login:test-multi-2-1765380580632"
}
[2025-12-10T15:29:40.633Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:29:40.633Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:29:40.633Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380580633",
  "key": "login:test-reset-time-1765380580633"
}
[2025-12-10T15:29:40.633Z] Creating new entry
{
  "key": "login:test-reset-time-1765380580633"
}
[2025-12-10T15:29:40.633Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:29:40.633Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:29:40.634Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:29:40.634Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:29:40.634Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:29:40.634Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:29:40.634Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:29:40.634Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:29:40.635Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:29:40.635Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:29:40.635Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:29:40.635Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:29:40.635Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380580635",
  "key": "test-sliding:test-sliding-1765380580635"
}
[2025-12-10T15:29:40.635Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380580635"
}
[2025-12-10T15:29:40.635Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:29:40.635Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:29:40.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380580635",
  "key": "test-sliding:test-sliding-1765380580635"
}
[2025-12-10T15:29:40.735Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380580635",
  "timestampCount": 1
}
[2025-12-10T15:29:40.735Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:29:40.735Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:29:40.836Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380580635",
  "key": "test-sliding:test-sliding-1765380580635"
}
[2025-12-10T15:29:40.836Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380580635",
  "timestampCount": 2
}
[2025-12-10T15:29:40.836Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:29:40.836Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:29:40.837Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:29:40.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380580838",
  "key": "register:test-format-allowed-1765380580838"
}
[2025-12-10T15:29:40.838Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380580838"
}
[2025-12-10T15:29:40.838Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:29:40.838Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:29:40.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380580838",
  "key": "register:test-format-blocked-1765380580838"
}
[2025-12-10T15:29:40.838Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380580838"
}
[2025-12-10T15:29:40.838Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:29:40.838Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:29:40.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380580838",
  "key": "register:test-format-blocked-1765380580838"
}
[2025-12-10T15:29:40.838Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380580838",
  "timestampCount": 1
}
[2025-12-10T15:29:40.838Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:29:40.838Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:29:40.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380580838",
  "key": "register:test-format-blocked-1765380580838"
}
[2025-12-10T15:29:40.838Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380580838",
  "timestampCount": 2
}
[2025-12-10T15:29:40.839Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:29:40.839Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:29:40.839Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380580838",
  "key": "register:test-format-blocked-1765380580838"
}
[2025-12-10T15:29:40.839Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380580838",
  "timestampCount": 3
}
[2025-12-10T15:29:40.839Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T15:30:31.496Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380631496",
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.497Z] Creating new entry
{
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.497Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:30:31.497Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:30:31.497Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380631496",
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.498Z] Found existing entry
{
  "key": "login:test-allow-1765380631496",
  "timestampCount": 1
}
[2025-12-10T15:30:31.498Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:30:31.498Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:30:31.498Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380631496",
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.498Z] Found existing entry
{
  "key": "login:test-allow-1765380631496",
  "timestampCount": 2
}
[2025-12-10T15:30:31.498Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:30:31.498Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:30:31.498Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380631496",
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.498Z] Found existing entry
{
  "key": "login:test-allow-1765380631496",
  "timestampCount": 3
}
[2025-12-10T15:30:31.498Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:30:31.498Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:30:31.498Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765380631496",
  "key": "login:test-allow-1765380631496"
}
[2025-12-10T15:30:31.498Z] Found existing entry
{
  "key": "login:test-allow-1765380631496",
  "timestampCount": 4
}
[2025-12-10T15:30:31.498Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:30:31.498Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Creating new entry
{
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:30:31.499Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Found existing entry
{
  "key": "login:test-block-1765380631499",
  "timestampCount": 1
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:30:31.499Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Found existing entry
{
  "key": "login:test-block-1765380631499",
  "timestampCount": 2
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:30:31.499Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Found existing entry
{
  "key": "login:test-block-1765380631499",
  "timestampCount": 3
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:30:31.499Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Found existing entry
{
  "key": "login:test-block-1765380631499",
  "timestampCount": 4
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:30:31.499Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:30:31.499Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765380631499",
  "key": "login:test-block-1765380631499"
}
[2025-12-10T15:30:31.499Z] Found existing entry
{
  "key": "login:test-block-1765380631499",
  "timestampCount": 5
}
[2025-12-10T15:30:31.499Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:30:31.500Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380631500",
  "key": "test-reset:test-reset-1765380631500"
}
[2025-12-10T15:30:31.500Z] Creating new entry
{
  "key": "test-reset:test-reset-1765380631500"
}
[2025-12-10T15:30:31.500Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:30:31.500Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:30:31.500Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380631500",
  "key": "test-reset:test-reset-1765380631500"
}
[2025-12-10T15:30:31.500Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380631500",
  "timestampCount": 1
}
[2025-12-10T15:30:31.500Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T15:30:31.500Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T15:30:31.500Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380631500",
  "key": "test-reset:test-reset-1765380631500"
}
[2025-12-10T15:30:31.500Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380631500",
  "timestampCount": 2
}
[2025-12-10T15:30:31.500Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T15:30:31.651Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765380631500",
  "key": "test-reset:test-reset-1765380631500"
}
[2025-12-10T15:30:31.651Z] Found existing entry
{
  "key": "test-reset:test-reset-1765380631500",
  "timestampCount": 2
}
[2025-12-10T15:30:31.651Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T15:30:31.651Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T15:30:31.651Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T15:30:31.651Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.651Z] Creating new entry
{
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.651Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:30:31.651Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:30:31.651Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.651Z] Found existing entry
{
  "key": "login:test-multi-1-1765380631651",
  "timestampCount": 1
}
[2025-12-10T15:30:31.652Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T15:30:31.652Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T15:30:31.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.652Z] Found existing entry
{
  "key": "login:test-multi-1-1765380631651",
  "timestampCount": 2
}
[2025-12-10T15:30:31.652Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T15:30:31.652Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T15:30:31.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.652Z] Found existing entry
{
  "key": "login:test-multi-1-1765380631651",
  "timestampCount": 3
}
[2025-12-10T15:30:31.652Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T15:30:31.652Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T15:30:31.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.652Z] Found existing entry
{
  "key": "login:test-multi-1-1765380631651",
  "timestampCount": 4
}
[2025-12-10T15:30:31.652Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T15:30:31.652Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T15:30:31.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765380631651",
  "key": "login:test-multi-1-1765380631651"
}
[2025-12-10T15:30:31.652Z] Found existing entry
{
  "key": "login:test-multi-1-1765380631651",
  "timestampCount": 5
}
[2025-12-10T15:30:31.652Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T15:30:31.653Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765380631651",
  "key": "login:test-multi-2-1765380631651"
}
[2025-12-10T15:30:31.653Z] Creating new entry
{
  "key": "login:test-multi-2-1765380631651"
}
[2025-12-10T15:30:31.653Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:30:31.653Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:30:31.653Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765380631653",
  "key": "login:test-reset-time-1765380631653"
}
[2025-12-10T15:30:31.653Z] Creating new entry
{
  "key": "login:test-reset-time-1765380631653"
}
[2025-12-10T15:30:31.653Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T15:30:31.653Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T15:30:31.654Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:30:31.654Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:30:31.654Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:30:31.654Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T15:30:31.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:30:31.655Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:30:31.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:30:31.655Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T15:30:31.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T15:30:31.655Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T15:30:31.655Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380631655",
  "key": "test-sliding:test-sliding-1765380631655"
}
[2025-12-10T15:30:31.655Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765380631655"
}
[2025-12-10T15:30:31.655Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:30:31.655Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:30:31.755Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380631655",
  "key": "test-sliding:test-sliding-1765380631655"
}
[2025-12-10T15:30:31.755Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380631655",
  "timestampCount": 1
}
[2025-12-10T15:30:31.755Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:30:31.755Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:30:31.857Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765380631655",
  "key": "test-sliding:test-sliding-1765380631655"
}
[2025-12-10T15:30:31.857Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765380631655",
  "timestampCount": 2
}
[2025-12-10T15:30:31.857Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T15:30:31.857Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:30:31.857Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:30:31.857Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765380631857",
  "key": "register:test-format-allowed-1765380631857"
}
[2025-12-10T15:30:31.857Z] Creating new entry
{
  "key": "register:test-format-allowed-1765380631857"
}
[2025-12-10T15:30:31.858Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:30:31.858Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:30:31.858Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380631858",
  "key": "register:test-format-blocked-1765380631858"
}
[2025-12-10T15:30:31.858Z] Creating new entry
{
  "key": "register:test-format-blocked-1765380631858"
}
[2025-12-10T15:30:31.858Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T15:30:31.858Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T15:30:31.858Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380631858",
  "key": "register:test-format-blocked-1765380631858"
}
[2025-12-10T15:30:31.858Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380631858",
  "timestampCount": 1
}
[2025-12-10T15:30:31.858Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T15:30:31.858Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T15:30:31.858Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380631858",
  "key": "register:test-format-blocked-1765380631858"
}
[2025-12-10T15:30:31.858Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380631858",
  "timestampCount": 2
}
[2025-12-10T15:30:31.858Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T15:30:31.858Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T15:30:31.858Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765380631858",
  "key": "register:test-format-blocked-1765380631858"
}
[2025-12-10T15:30:31.859Z] Found existing entry
{
  "key": "register:test-format-blocked-1765380631858",
  "timestampCount": 3
}
[2025-12-10T15:30:31.859Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:01:12.777Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382472777",
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.779Z] Creating new entry
{
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.779Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:12.779Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:12.779Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382472777",
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.779Z] Found existing entry
{
  "key": "login:test-allow-1765382472777",
  "timestampCount": 1
}
[2025-12-10T16:01:12.779Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:12.780Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:12.780Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382472777",
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.780Z] Found existing entry
{
  "key": "login:test-allow-1765382472777",
  "timestampCount": 2
}
[2025-12-10T16:01:12.780Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:12.780Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:12.780Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382472777",
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.780Z] Found existing entry
{
  "key": "login:test-allow-1765382472777",
  "timestampCount": 3
}
[2025-12-10T16:01:12.780Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:12.780Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:12.780Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382472777",
  "key": "login:test-allow-1765382472777"
}
[2025-12-10T16:01:12.780Z] Found existing entry
{
  "key": "login:test-allow-1765382472777",
  "timestampCount": 4
}
[2025-12-10T16:01:12.780Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:12.780Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:12.780Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Creating new entry
{
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:12.781Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:12.781Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Found existing entry
{
  "key": "login:test-block-1765382472780",
  "timestampCount": 1
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:12.781Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:12.781Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Found existing entry
{
  "key": "login:test-block-1765382472780",
  "timestampCount": 2
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:12.781Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:12.781Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Found existing entry
{
  "key": "login:test-block-1765382472780",
  "timestampCount": 3
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:12.781Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:12.781Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Found existing entry
{
  "key": "login:test-block-1765382472780",
  "timestampCount": 4
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:12.781Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:12.781Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382472780",
  "key": "login:test-block-1765382472780"
}
[2025-12-10T16:01:12.781Z] Found existing entry
{
  "key": "login:test-block-1765382472780",
  "timestampCount": 5
}
[2025-12-10T16:01:12.781Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:01:12.782Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382472782",
  "key": "test-reset:test-reset-1765382472782"
}
[2025-12-10T16:01:12.782Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382472782"
}
[2025-12-10T16:01:12.782Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:01:12.782Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:01:12.782Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382472782",
  "key": "test-reset:test-reset-1765382472782"
}
[2025-12-10T16:01:12.782Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382472782",
  "timestampCount": 1
}
[2025-12-10T16:01:12.782Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:01:12.782Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:01:12.782Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382472782",
  "key": "test-reset:test-reset-1765382472782"
}
[2025-12-10T16:01:12.782Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382472782",
  "timestampCount": 2
}
[2025-12-10T16:01:12.782Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:01:18.036Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382478036",
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.036Z] Creating new entry
{
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.036Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:18.036Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:18.037Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382478036",
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.037Z] Found existing entry
{
  "key": "login:test-allow-1765382478036",
  "timestampCount": 1
}
[2025-12-10T16:01:18.037Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:18.037Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:18.037Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382478036",
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.037Z] Found existing entry
{
  "key": "login:test-allow-1765382478036",
  "timestampCount": 2
}
[2025-12-10T16:01:18.037Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:18.037Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:18.037Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382478036",
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.037Z] Found existing entry
{
  "key": "login:test-allow-1765382478036",
  "timestampCount": 3
}
[2025-12-10T16:01:18.037Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:18.037Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:18.037Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382478036",
  "key": "login:test-allow-1765382478036"
}
[2025-12-10T16:01:18.037Z] Found existing entry
{
  "key": "login:test-allow-1765382478036",
  "timestampCount": 4
}
[2025-12-10T16:01:18.037Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:18.037Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:18.040Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.041Z] Creating new entry
{
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.041Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:18.042Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:18.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.042Z] Found existing entry
{
  "key": "login:test-block-1765382478040",
  "timestampCount": 1
}
[2025-12-10T16:01:18.042Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:18.042Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:18.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.042Z] Found existing entry
{
  "key": "login:test-block-1765382478040",
  "timestampCount": 2
}
[2025-12-10T16:01:18.043Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:18.043Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:18.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.043Z] Found existing entry
{
  "key": "login:test-block-1765382478040",
  "timestampCount": 3
}
[2025-12-10T16:01:18.044Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:18.044Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:18.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.044Z] Found existing entry
{
  "key": "login:test-block-1765382478040",
  "timestampCount": 4
}
[2025-12-10T16:01:18.044Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:18.044Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:18.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382478040",
  "key": "login:test-block-1765382478040"
}
[2025-12-10T16:01:18.044Z] Found existing entry
{
  "key": "login:test-block-1765382478040",
  "timestampCount": 5
}
[2025-12-10T16:01:18.044Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:01:18.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382478045",
  "key": "test-reset:test-reset-1765382478045"
}
[2025-12-10T16:01:18.045Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382478045"
}
[2025-12-10T16:01:18.045Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:01:18.045Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:01:18.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382478045",
  "key": "test-reset:test-reset-1765382478045"
}
[2025-12-10T16:01:18.045Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382478045",
  "timestampCount": 1
}
[2025-12-10T16:01:18.045Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:01:18.046Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:01:18.046Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382478045",
  "key": "test-reset:test-reset-1765382478045"
}
[2025-12-10T16:01:18.046Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382478045",
  "timestampCount": 2
}
[2025-12-10T16:01:18.046Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:01:18.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382478045",
  "key": "test-reset:test-reset-1765382478045"
}
[2025-12-10T16:01:18.199Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382478045",
  "timestampCount": 2
}
[2025-12-10T16:01:18.199Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:01:18.199Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:01:18.199Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:01:18.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.199Z] Creating new entry
{
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.199Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:18.199Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:18.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.199Z] Found existing entry
{
  "key": "login:test-multi-1-1765382478199",
  "timestampCount": 1
}
[2025-12-10T16:01:18.199Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:18.199Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:18.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.200Z] Found existing entry
{
  "key": "login:test-multi-1-1765382478199",
  "timestampCount": 2
}
[2025-12-10T16:01:18.200Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:18.200Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:18.200Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.200Z] Found existing entry
{
  "key": "login:test-multi-1-1765382478199",
  "timestampCount": 3
}
[2025-12-10T16:01:18.200Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:18.201Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:18.202Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.202Z] Found existing entry
{
  "key": "login:test-multi-1-1765382478199",
  "timestampCount": 4
}
[2025-12-10T16:01:18.202Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:18.202Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:18.202Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382478199",
  "key": "login:test-multi-1-1765382478199"
}
[2025-12-10T16:01:18.202Z] Found existing entry
{
  "key": "login:test-multi-1-1765382478199",
  "timestampCount": 5
}
[2025-12-10T16:01:18.202Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:01:18.204Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765382478199",
  "key": "login:test-multi-2-1765382478199"
}
[2025-12-10T16:01:18.204Z] Creating new entry
{
  "key": "login:test-multi-2-1765382478199"
}
[2025-12-10T16:01:18.204Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:18.204Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:18.205Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765382478205",
  "key": "login:test-reset-time-1765382478205"
}
[2025-12-10T16:01:18.205Z] Creating new entry
{
  "key": "login:test-reset-time-1765382478205"
}
[2025-12-10T16:01:18.205Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:18.205Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:18.206Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:18.206Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:18.207Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:18.207Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:01:18.207Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:18.207Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:18.207Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:18.207Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:01:18.207Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:18.207Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:18.207Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382478207",
  "key": "test-sliding:test-sliding-1765382478207"
}
[2025-12-10T16:01:18.208Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765382478207"
}
[2025-12-10T16:01:18.208Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:18.208Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:18.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382478207",
  "key": "test-sliding:test-sliding-1765382478207"
}
[2025-12-10T16:01:18.308Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382478207",
  "timestampCount": 1
}
[2025-12-10T16:01:18.309Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:18.309Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:18.410Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382478207",
  "key": "test-sliding:test-sliding-1765382478207"
}
[2025-12-10T16:01:18.411Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382478207",
  "timestampCount": 2
}
[2025-12-10T16:01:18.411Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T16:01:18.417Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:18.425Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:18.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765382478426",
  "key": "register:test-format-allowed-1765382478426"
}
[2025-12-10T16:01:18.426Z] Creating new entry
{
  "key": "register:test-format-allowed-1765382478426"
}
[2025-12-10T16:01:18.426Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:18.426Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:18.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382478426",
  "key": "register:test-format-blocked-1765382478426"
}
[2025-12-10T16:01:18.426Z] Creating new entry
{
  "key": "register:test-format-blocked-1765382478426"
}
[2025-12-10T16:01:18.427Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:18.427Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:18.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382478426",
  "key": "register:test-format-blocked-1765382478426"
}
[2025-12-10T16:01:18.427Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382478426",
  "timestampCount": 1
}
[2025-12-10T16:01:18.427Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:18.427Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:18.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382478426",
  "key": "register:test-format-blocked-1765382478426"
}
[2025-12-10T16:01:18.427Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382478426",
  "timestampCount": 2
}
[2025-12-10T16:01:18.427Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:01:18.427Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:01:18.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382478426",
  "key": "register:test-format-blocked-1765382478426"
}
[2025-12-10T16:01:18.427Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382478426",
  "timestampCount": 3
}
[2025-12-10T16:01:18.427Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:01:56.374Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382516374",
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.375Z] Creating new entry
{
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.375Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:56.375Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:56.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382516374",
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.377Z] Found existing entry
{
  "key": "login:test-allow-1765382516374",
  "timestampCount": 1
}
[2025-12-10T16:01:56.377Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:56.377Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:56.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382516374",
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.377Z] Found existing entry
{
  "key": "login:test-allow-1765382516374",
  "timestampCount": 2
}
[2025-12-10T16:01:56.377Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:56.377Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:56.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382516374",
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.377Z] Found existing entry
{
  "key": "login:test-allow-1765382516374",
  "timestampCount": 3
}
[2025-12-10T16:01:56.377Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:56.377Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:56.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382516374",
  "key": "login:test-allow-1765382516374"
}
[2025-12-10T16:01:56.377Z] Found existing entry
{
  "key": "login:test-allow-1765382516374",
  "timestampCount": 4
}
[2025-12-10T16:01:56.377Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:56.377Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:56.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Creating new entry
{
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:56.378Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:56.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Found existing entry
{
  "key": "login:test-block-1765382516378",
  "timestampCount": 1
}
[2025-12-10T16:01:56.378Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:56.378Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:56.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Found existing entry
{
  "key": "login:test-block-1765382516378",
  "timestampCount": 2
}
[2025-12-10T16:01:56.378Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:56.378Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:56.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Found existing entry
{
  "key": "login:test-block-1765382516378",
  "timestampCount": 3
}
[2025-12-10T16:01:56.378Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:56.378Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:56.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.378Z] Found existing entry
{
  "key": "login:test-block-1765382516378",
  "timestampCount": 4
}
[2025-12-10T16:01:56.378Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:56.379Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:56.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382516378",
  "key": "login:test-block-1765382516378"
}
[2025-12-10T16:01:56.379Z] Found existing entry
{
  "key": "login:test-block-1765382516378",
  "timestampCount": 5
}
[2025-12-10T16:01:56.379Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:01:56.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382516379",
  "key": "test-reset:test-reset-1765382516379"
}
[2025-12-10T16:01:56.379Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382516379"
}
[2025-12-10T16:01:56.379Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:01:56.379Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:01:56.379Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382516379",
  "key": "test-reset:test-reset-1765382516379"
}
[2025-12-10T16:01:56.379Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382516379",
  "timestampCount": 1
}
[2025-12-10T16:01:56.380Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:01:56.380Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:01:56.380Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382516379",
  "key": "test-reset:test-reset-1765382516379"
}
[2025-12-10T16:01:56.380Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382516379",
  "timestampCount": 2
}
[2025-12-10T16:01:56.380Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:01:56.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382516379",
  "key": "test-reset:test-reset-1765382516379"
}
[2025-12-10T16:01:56.531Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382516379",
  "timestampCount": 2
}
[2025-12-10T16:01:56.531Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:01:56.531Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:01:56.531Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:01:56.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.531Z] Creating new entry
{
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.531Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:56.531Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.532Z] Found existing entry
{
  "key": "login:test-multi-1-1765382516531",
  "timestampCount": 1
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.532Z] Found existing entry
{
  "key": "login:test-multi-1-1765382516531",
  "timestampCount": 2
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.532Z] Found existing entry
{
  "key": "login:test-multi-1-1765382516531",
  "timestampCount": 3
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.532Z] Found existing entry
{
  "key": "login:test-multi-1-1765382516531",
  "timestampCount": 4
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382516531",
  "key": "login:test-multi-1-1765382516531"
}
[2025-12-10T16:01:56.532Z] Found existing entry
{
  "key": "login:test-multi-1-1765382516531",
  "timestampCount": 5
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765382516531",
  "key": "login:test-multi-2-1765382516531"
}
[2025-12-10T16:01:56.532Z] Creating new entry
{
  "key": "login:test-multi-2-1765382516531"
}
[2025-12-10T16:01:56.532Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:56.532Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:56.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765382516533",
  "key": "login:test-reset-time-1765382516533"
}
[2025-12-10T16:01:56.533Z] Creating new entry
{
  "key": "login:test-reset-time-1765382516533"
}
[2025-12-10T16:01:56.533Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:01:56.533Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:01:56.534Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:56.534Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:56.534Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:56.534Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:01:56.534Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:56.535Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:56.535Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:56.535Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:01:56.535Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:01:56.535Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:01:56.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382516535",
  "key": "test-sliding:test-sliding-1765382516535"
}
[2025-12-10T16:01:56.535Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765382516535"
}
[2025-12-10T16:01:56.535Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:56.535Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:56.636Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382516535",
  "key": "test-sliding:test-sliding-1765382516535"
}
[2025-12-10T16:01:56.636Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382516535",
  "timestampCount": 1
}
[2025-12-10T16:01:56.636Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:56.636Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:56.738Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382516535",
  "key": "test-sliding:test-sliding-1765382516535"
}
[2025-12-10T16:01:56.738Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382516535",
  "timestampCount": 2
}
[2025-12-10T16:01:56.738Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T16:01:56.738Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:56.738Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:56.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765382516739",
  "key": "register:test-format-allowed-1765382516739"
}
[2025-12-10T16:01:56.739Z] Creating new entry
{
  "key": "register:test-format-allowed-1765382516739"
}
[2025-12-10T16:01:56.739Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:56.739Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:56.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382516739",
  "key": "register:test-format-blocked-1765382516739"
}
[2025-12-10T16:01:56.739Z] Creating new entry
{
  "key": "register:test-format-blocked-1765382516739"
}
[2025-12-10T16:01:56.739Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:01:56.739Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:01:56.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382516739",
  "key": "register:test-format-blocked-1765382516739"
}
[2025-12-10T16:01:56.739Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382516739",
  "timestampCount": 1
}
[2025-12-10T16:01:56.739Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:01:56.739Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:01:56.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382516739",
  "key": "register:test-format-blocked-1765382516739"
}
[2025-12-10T16:01:56.739Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382516739",
  "timestampCount": 2
}
[2025-12-10T16:01:56.739Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:01:56.739Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:01:56.740Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382516739",
  "key": "register:test-format-blocked-1765382516739"
}
[2025-12-10T16:01:56.740Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382516739",
  "timestampCount": 3
}
[2025-12-10T16:01:56.740Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:02:17.306Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:17.306Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:17.307Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:17.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:02:17.307Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T16:02:17.307Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:02:17.307Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:02:17.307Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:17.307Z"
  }
}
[2025-12-10T16:02:17.398Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T16:02:17.398Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:17.398Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:17.398Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:02:17.398Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T16:02:17.398Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:17.398Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:17.398Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:17.398Z"
  }
}
[2025-12-10T16:02:17.529Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T16:02:17.529Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:17.529Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:17.529Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:02:17.529Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T16:02:17.529Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:17.529Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:17.529Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:17.398Z"
  }
}
[2025-12-10T16:02:18.387Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:02:18.387Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:18.387Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:18.387Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:02:18.387Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-10T16:02:18.387Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:02:18.387Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:02:18.387Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:17.398Z"
  }
}
[2025-12-10T16:02:18.433Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:18.434Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:18.434Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:18.434Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:18.434Z] Creating new entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:18.434Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:18.434Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:18.434Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:18.603Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:18.604Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1765382538602-h8d82f",
  "willUseTestId": true
}
[2025-12-10T16:02:18.604Z] Using test identifier
{
  "identifier": "test:login-headers-1765382538602-h8d82f"
}
[2025-12-10T16:02:18.604Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1765382538602-h8d82f",
  "key": "login:test:login-headers-1765382538602-h8d82f"
}
[2025-12-10T16:02:18.604Z] Creating new entry
{
  "key": "login:test:login-headers-1765382538602-h8d82f"
}
[2025-12-10T16:02:18.604Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:18.604Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:18.604Z] Rate limit check result
{
  "identifier": "test:login-headers-1765382538602-h8d82f",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:18.604Z"
  }
}
[2025-12-10T16:02:18.788Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:18.788Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:18.788Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:18.788Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:18.788Z] Creating new entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:18.788Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:18.788Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:18.788Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:18.881Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:18.881Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:18.881Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:18.881Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:18.881Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae",
  "timestampCount": 1
}
[2025-12-10T16:02:18.881Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:18.881Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:18.881Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:18.942Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:18.942Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382538941-jrip5l",
  "willUseTestId": true
}
[2025-12-10T16:02:18.942Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:18.942Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "key": "register:test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:18.942Z] Creating new entry
{
  "key": "register:test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:18.942Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:02:18.942Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:02:18.942Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:18.942Z"
  }
}
[2025-12-10T16:02:19.096Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.096Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:19.096Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.096Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.096Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon",
  "timestampCount": 1
}
[2025-12-10T16:02:19.096Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:19.096Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:19.096Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:19.184Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.184Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:19.185Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.185Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae",
  "timestampCount": 2
}
[2025-12-10T16:02:19.185Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:02:19.185Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:02:19.185Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:19.299Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.299Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:19.299Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.299Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.299Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon",
  "timestampCount": 2
}
[2025-12-10T16:02:19.299Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:02:19.299Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:02:19.299Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:19.426Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:19.426Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382538941-jrip5l",
  "willUseTestId": true
}
[2025-12-10T16:02:19.427Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:19.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "key": "register:test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:19.427Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382538941-jrip5l",
  "timestampCount": 1
}
[2025-12-10T16:02:19.427Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:02:19.427Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:02:19.427Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:18.942Z"
  }
}
[2025-12-10T16:02:19.464Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.464Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:19.464Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.464Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae",
  "timestampCount": 3
}
[2025-12-10T16:02:19.464Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:02:19.464Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:02:19.464Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:19.495Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.495Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:19.495Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.495Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.495Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon",
  "timestampCount": 3
}
[2025-12-10T16:02:19.495Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:02:19.495Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:02:19.495Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:19.718Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.718Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:19.718Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.718Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.718Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon",
  "timestampCount": 4
}
[2025-12-10T16:02:19.718Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:02:19.718Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:02:19.719Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:19.741Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.742Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:19.742Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:19.742Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae",
  "timestampCount": 4
}
[2025-12-10T16:02:19.742Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:02:19.742Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:02:19.742Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:19.748Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:19.748Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382538941-jrip5l",
  "willUseTestId": true
}
[2025-12-10T16:02:19.748Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:19.748Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "key": "register:test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:19.748Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382538941-jrip5l",
  "timestampCount": 2
}
[2025-12-10T16:02:19.748Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:02:19.748Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:02:19.748Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.942Z"
  }
}
[2025-12-10T16:02:19.944Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:19.944Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382538780-f85eon",
  "willUseTestId": true
}
[2025-12-10T16:02:19.944Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.944Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "key": "login:test:login-retry-after-1765382538780-f85eon"
}
[2025-12-10T16:02:19.944Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382538780-f85eon",
  "timestampCount": 5
}
[2025-12-10T16:02:19.944Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:02:19.945Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382538780-f85eon",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.788Z"
  }
}
[2025-12-10T16:02:19.954Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:19.954Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1765382539953-gugu6t",
  "willUseTestId": true
}
[2025-12-10T16:02:19.954Z] Using test identifier
{
  "identifier": "test:register-headers-1765382539953-gugu6t"
}
[2025-12-10T16:02:19.954Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1765382539953-gugu6t",
  "key": "register:test:register-headers-1765382539953-gugu6t"
}
[2025-12-10T16:02:19.954Z] Creating new entry
{
  "key": "register:test:register-headers-1765382539953-gugu6t"
}
[2025-12-10T16:02:19.954Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:02:19.954Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:02:19.954Z] Rate limit check result
{
  "identifier": "test:register-headers-1765382539953-gugu6t",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:19.954Z"
  }
}
[2025-12-10T16:02:20.042Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.043Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382538420-6naijae",
  "willUseTestId": true
}
[2025-12-10T16:02:20.043Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:20.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "key": "login:test:login-excessive-1765382538420-6naijae"
}
[2025-12-10T16:02:20.043Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382538420-6naijae",
  "timestampCount": 5
}
[2025-12-10T16:02:20.044Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:02:20.044Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382538420-6naijae",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.434Z"
  }
}
[2025-12-10T16:02:20.070Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.070Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:20.070Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.070Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.070Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.070Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:20.070Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:20.070Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:20.072Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:20.072Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382538941-jrip5l",
  "willUseTestId": true
}
[2025-12-10T16:02:20.072Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:20.072Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "key": "register:test:register-excessive-1765382538941-jrip5l"
}
[2025-12-10T16:02:20.072Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382538941-jrip5l",
  "timestampCount": 3
}
[2025-12-10T16:02:20.072Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:02:20.072Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382538941-jrip5l",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:18.942Z"
  }
}
[2025-12-10T16:02:20.080Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.081Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382540079-jlry9",
  "willUseTestId": true
}
[2025-12-10T16:02:20.081Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.081Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "key": "login:test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.081Z] Creating new entry
{
  "key": "login:test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.081Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:20.081Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:20.081Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:20.081Z"
  }
}
[2025-12-10T16:02:20.299Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.299Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382540079-jlry9",
  "willUseTestId": true
}
[2025-12-10T16:02:20.299Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.299Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "key": "login:test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.299Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765382540079-jlry9",
  "timestampCount": 1
}
[2025-12-10T16:02:20.299Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:20.299Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:20.299Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:20.081Z"
  }
}
[2025-12-10T16:02:20.307Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.308Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765382540306-cr1tc",
  "willUseTestId": true
}
[2025-12-10T16:02:20.308Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765382540306-cr1tc"
}
[2025-12-10T16:02:20.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765382540306-cr1tc",
  "key": "login:test:headers-consistent-1765382540306-cr1tc"
}
[2025-12-10T16:02:20.308Z] Creating new entry
{
  "key": "login:test:headers-consistent-1765382540306-cr1tc"
}
[2025-12-10T16:02:20.308Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:20.308Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:20.308Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765382540306-cr1tc",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:20.308Z"
  }
}
[2025-12-10T16:02:20.349Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.349Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:20.349Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.349Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.349Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l",
  "timestampCount": 1
}
[2025-12-10T16:02:20.349Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:20.349Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:20.349Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:20.508Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.508Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382540079-jlry9",
  "willUseTestId": true
}
[2025-12-10T16:02:20.508Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.508Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "key": "login:test:headers-remaining-1765382540079-jlry9"
}
[2025-12-10T16:02:20.508Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765382540079-jlry9",
  "timestampCount": 2
}
[2025-12-10T16:02:20.509Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:02:20.509Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:02:20.509Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382540079-jlry9",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:20.081Z"
  }
}
[2025-12-10T16:02:20.551Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.552Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765382540306-cr1tc",
  "willUseTestId": true
}
[2025-12-10T16:02:20.552Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765382540306-cr1tc"
}
[2025-12-10T16:02:20.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765382540306-cr1tc",
  "key": "login:test:headers-consistent-1765382540306-cr1tc"
}
[2025-12-10T16:02:20.552Z] Found existing entry
{
  "key": "login:test:headers-consistent-1765382540306-cr1tc",
  "timestampCount": 1
}
[2025-12-10T16:02:20.552Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:02:20.552Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:02:20.552Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765382540306-cr1tc",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:03:20.308Z"
  }
}
[2025-12-10T16:02:20.594Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.594Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:20.594Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.594Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l",
  "timestampCount": 2
}
[2025-12-10T16:02:20.594Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:02:20.594Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:02:20.594Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:20.761Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.761Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1765382540760-6xy6l8",
  "willUseTestId": true
}
[2025-12-10T16:02:20.761Z] Using test identifier
{
  "identifier": "test:perf-test-1765382540760-6xy6l8"
}
[2025-12-10T16:02:20.761Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1765382540760-6xy6l8",
  "key": "login:test:perf-test-1765382540760-6xy6l8"
}
[2025-12-10T16:02:20.761Z] Creating new entry
{
  "key": "login:test:perf-test-1765382540760-6xy6l8"
}
[2025-12-10T16:02:20.761Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:02:20.761Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:02:20.761Z] Rate limit check result
{
  "identifier": "test:perf-test-1765382540760-6xy6l8",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:03:20.761Z"
  }
}
[2025-12-10T16:02:20.819Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:20.820Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:20.820Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.820Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:20.820Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l",
  "timestampCount": 3
}
[2025-12-10T16:02:20.820Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:02:20.820Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:02:20.820Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:21.085Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:21.085Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:21.085Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.085Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.085Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l",
  "timestampCount": 4
}
[2025-12-10T16:02:21.086Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:02:21.086Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:02:21.086Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:21.309Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:02:21.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:21.309Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "login:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.309Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382540069-a5p7l",
  "timestampCount": 5
}
[2025-12-10T16:02:21.309Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:02:21.309Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:20.070Z"
  }
}
[2025-12-10T16:02:21.311Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:21.311Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382540069-a5p7l",
  "willUseTestId": true
}
[2025-12-10T16:02:21.311Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.311Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "key": "register:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.311Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1765382540069-a5p7l"
}
[2025-12-10T16:02:21.311Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:02:21.311Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:02:21.311Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382540069-a5p7l",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:03:21.311Z"
  }
}
[2025-12-10T16:02:30.814Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:30.814Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:30.814Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:30.814Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:02:30.814Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2025-12-10T16:02:30.814Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:02:30.814Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:02:30.814Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:17.307Z"
  }
}
[2025-12-10T16:02:31.864Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:02:31.865Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:31.865Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:31.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:02:31.865Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 3
}
[2025-12-10T16:02:31.865Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:02:31.865Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:02:31.865Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:03:17.398Z"
  }
}
[2025-12-10T16:02:43.844Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:02:43.845Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:43.845Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:43.845Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:02:43.845Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 2
}
[2025-12-10T16:02:43.845Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:02:43.845Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:02:43.845Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:17.307Z"
  }
}
[2025-12-10T16:02:44.877Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:02:44.877Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:02:44.877Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:02:44.877Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:02:44.877Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 4
}
[2025-12-10T16:02:44.877Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:02:44.877Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:02:44.877Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:03:17.398Z"
  }
}
[2025-12-10T16:03:23.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382603531",
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.532Z] Creating new entry
{
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.532Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:03:23.532Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:03:23.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382603531",
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.532Z] Found existing entry
{
  "key": "login:test-allow-1765382603531",
  "timestampCount": 1
}
[2025-12-10T16:03:23.532Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:03:23.532Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:03:23.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382603531",
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.532Z] Found existing entry
{
  "key": "login:test-allow-1765382603531",
  "timestampCount": 2
}
[2025-12-10T16:03:23.532Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:03:23.532Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:03:23.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382603531",
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-allow-1765382603531",
  "timestampCount": 3
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382603531",
  "key": "login:test-allow-1765382603531"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-allow-1765382603531",
  "timestampCount": 4
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Creating new entry
{
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-block-1765382603533",
  "timestampCount": 1
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-block-1765382603533",
  "timestampCount": 2
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-block-1765382603533",
  "timestampCount": 3
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:03:23.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.533Z] Found existing entry
{
  "key": "login:test-block-1765382603533",
  "timestampCount": 4
}
[2025-12-10T16:03:23.533Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:03:23.533Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:03:23.534Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382603533",
  "key": "login:test-block-1765382603533"
}
[2025-12-10T16:03:23.534Z] Found existing entry
{
  "key": "login:test-block-1765382603533",
  "timestampCount": 5
}
[2025-12-10T16:03:23.534Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:03:23.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382603535",
  "key": "test-reset:test-reset-1765382603535"
}
[2025-12-10T16:03:23.535Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382603535"
}
[2025-12-10T16:03:23.535Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:03:23.535Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:03:23.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382603535",
  "key": "test-reset:test-reset-1765382603535"
}
[2025-12-10T16:03:23.535Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382603535",
  "timestampCount": 1
}
[2025-12-10T16:03:23.535Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:03:23.535Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:03:23.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382603535",
  "key": "test-reset:test-reset-1765382603535"
}
[2025-12-10T16:03:23.535Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382603535",
  "timestampCount": 2
}
[2025-12-10T16:03:23.535Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:03:23.687Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382603535",
  "key": "test-reset:test-reset-1765382603535"
}
[2025-12-10T16:03:23.687Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382603535",
  "timestampCount": 2
}
[2025-12-10T16:03:23.687Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:03:23.687Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:03:23.687Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:03:23.687Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Creating new entry
{
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Found existing entry
{
  "key": "login:test-multi-1-1765382603687",
  "timestampCount": 1
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Found existing entry
{
  "key": "login:test-multi-1-1765382603687",
  "timestampCount": 2
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Found existing entry
{
  "key": "login:test-multi-1-1765382603687",
  "timestampCount": 3
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Found existing entry
{
  "key": "login:test-multi-1-1765382603687",
  "timestampCount": 4
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382603687",
  "key": "login:test-multi-1-1765382603687"
}
[2025-12-10T16:03:23.688Z] Found existing entry
{
  "key": "login:test-multi-1-1765382603687",
  "timestampCount": 5
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765382603687",
  "key": "login:test-multi-2-1765382603687"
}
[2025-12-10T16:03:23.688Z] Creating new entry
{
  "key": "login:test-multi-2-1765382603687"
}
[2025-12-10T16:03:23.688Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:03:23.688Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:03:23.689Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765382603689",
  "key": "login:test-reset-time-1765382603689"
}
[2025-12-10T16:03:23.689Z] Creating new entry
{
  "key": "login:test-reset-time-1765382603689"
}
[2025-12-10T16:03:23.689Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:03:23.689Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:03:23.690Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:03:23.690Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:03:23.690Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:03:23.690Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:03:23.690Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:03:23.690Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:03:23.690Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:03:23.690Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:03:23.690Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:03:23.691Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:03:23.691Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382603691",
  "key": "test-sliding:test-sliding-1765382603691"
}
[2025-12-10T16:03:23.691Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765382603691"
}
[2025-12-10T16:03:23.691Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:03:23.691Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:03:23.792Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382603691",
  "key": "test-sliding:test-sliding-1765382603691"
}
[2025-12-10T16:03:23.793Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382603691",
  "timestampCount": 1
}
[2025-12-10T16:03:23.793Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:03:23.793Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:03:23.896Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382603691",
  "key": "test-sliding:test-sliding-1765382603691"
}
[2025-12-10T16:03:23.896Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382603691",
  "timestampCount": 2
}
[2025-12-10T16:03:23.896Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T16:03:23.896Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:03:23.896Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:03:23.897Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765382603897",
  "key": "register:test-format-allowed-1765382603897"
}
[2025-12-10T16:03:23.897Z] Creating new entry
{
  "key": "register:test-format-allowed-1765382603897"
}
[2025-12-10T16:03:23.897Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:03:23.897Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:03:23.897Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382603897",
  "key": "register:test-format-blocked-1765382603897"
}
[2025-12-10T16:03:23.897Z] Creating new entry
{
  "key": "register:test-format-blocked-1765382603897"
}
[2025-12-10T16:03:23.897Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:03:23.897Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:03:23.897Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382603897",
  "key": "register:test-format-blocked-1765382603897"
}
[2025-12-10T16:03:23.897Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382603897",
  "timestampCount": 1
}
[2025-12-10T16:03:23.897Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:03:23.897Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:03:23.897Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382603897",
  "key": "register:test-format-blocked-1765382603897"
}
[2025-12-10T16:03:23.898Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382603897",
  "timestampCount": 2
}
[2025-12-10T16:03:23.898Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:03:23.898Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:03:23.898Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382603897",
  "key": "register:test-format-blocked-1765382603897"
}
[2025-12-10T16:03:23.898Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382603897",
  "timestampCount": 3
}
[2025-12-10T16:03:23.898Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:05:53.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382753169",
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.170Z] Creating new entry
{
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.170Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:05:53.170Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:05:53.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382753169",
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.170Z] Found existing entry
{
  "key": "login:test-allow-1765382753169",
  "timestampCount": 1
}
[2025-12-10T16:05:53.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:05:53.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:05:53.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382753169",
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.170Z] Found existing entry
{
  "key": "login:test-allow-1765382753169",
  "timestampCount": 2
}
[2025-12-10T16:05:53.170Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:05:53.170Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:05:53.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382753169",
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.170Z] Found existing entry
{
  "key": "login:test-allow-1765382753169",
  "timestampCount": 3
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:05:53.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382753169",
  "key": "login:test-allow-1765382753169"
}
[2025-12-10T16:05:53.171Z] Found existing entry
{
  "key": "login:test-allow-1765382753169",
  "timestampCount": 4
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:05:53.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.171Z] Creating new entry
{
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:05:53.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.171Z] Found existing entry
{
  "key": "login:test-block-1765382753171",
  "timestampCount": 1
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:05:53.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.171Z] Found existing entry
{
  "key": "login:test-block-1765382753171",
  "timestampCount": 2
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:05:53.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.171Z] Found existing entry
{
  "key": "login:test-block-1765382753171",
  "timestampCount": 3
}
[2025-12-10T16:05:53.171Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:05:53.171Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:05:53.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.172Z] Found existing entry
{
  "key": "login:test-block-1765382753171",
  "timestampCount": 4
}
[2025-12-10T16:05:53.172Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:05:53.172Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:05:53.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382753171",
  "key": "login:test-block-1765382753171"
}
[2025-12-10T16:05:53.172Z] Found existing entry
{
  "key": "login:test-block-1765382753171",
  "timestampCount": 5
}
[2025-12-10T16:05:53.172Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:05:53.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382753172",
  "key": "test-reset:test-reset-1765382753172"
}
[2025-12-10T16:05:53.172Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382753172"
}
[2025-12-10T16:05:53.172Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:05:53.172Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:05:53.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382753172",
  "key": "test-reset:test-reset-1765382753172"
}
[2025-12-10T16:05:53.172Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382753172",
  "timestampCount": 1
}
[2025-12-10T16:05:53.172Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:05:53.172Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:05:53.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382753172",
  "key": "test-reset:test-reset-1765382753172"
}
[2025-12-10T16:05:53.173Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382753172",
  "timestampCount": 2
}
[2025-12-10T16:05:53.173Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:05:53.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382753172",
  "key": "test-reset:test-reset-1765382753172"
}
[2025-12-10T16:05:53.323Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382753172",
  "timestampCount": 2
}
[2025-12-10T16:05:53.323Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:05:53.323Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:05:53.323Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:05:53.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.323Z] Creating new entry
{
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.323Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:05:53.323Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:05:53.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.323Z] Found existing entry
{
  "key": "login:test-multi-1-1765382753323",
  "timestampCount": 1
}
[2025-12-10T16:05:53.323Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:05:53.323Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:05:53.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.323Z] Found existing entry
{
  "key": "login:test-multi-1-1765382753323",
  "timestampCount": 2
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:05:53.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.324Z] Found existing entry
{
  "key": "login:test-multi-1-1765382753323",
  "timestampCount": 3
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:05:53.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.324Z] Found existing entry
{
  "key": "login:test-multi-1-1765382753323",
  "timestampCount": 4
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:05:53.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382753323",
  "key": "login:test-multi-1-1765382753323"
}
[2025-12-10T16:05:53.324Z] Found existing entry
{
  "key": "login:test-multi-1-1765382753323",
  "timestampCount": 5
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765382753323",
  "key": "login:test-multi-2-1765382753323"
}
[2025-12-10T16:05:53.324Z] Creating new entry
{
  "key": "login:test-multi-2-1765382753323"
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:05:53.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765382753324",
  "key": "login:test-reset-time-1765382753324"
}
[2025-12-10T16:05:53.324Z] Creating new entry
{
  "key": "login:test-reset-time-1765382753324"
}
[2025-12-10T16:05:53.324Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:05:53.324Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:05:53.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:05:53.325Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:05:53.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:05:53.326Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:05:53.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:05:53.326Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:05:53.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:05:53.326Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:05:53.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:05:53.326Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:05:53.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382753326",
  "key": "test-sliding:test-sliding-1765382753326"
}
[2025-12-10T16:05:53.326Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765382753326"
}
[2025-12-10T16:05:53.326Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:05:53.326Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:06.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382766456",
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.457Z] Creating new entry
{
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.457Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:06.457Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:06.457Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382766456",
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.458Z] Found existing entry
{
  "key": "login:test-allow-1765382766456",
  "timestampCount": 1
}
[2025-12-10T16:06:06.458Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:06.458Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:06.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382766456",
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.458Z] Found existing entry
{
  "key": "login:test-allow-1765382766456",
  "timestampCount": 2
}
[2025-12-10T16:06:06.458Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:06.458Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:06.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382766456",
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.458Z] Found existing entry
{
  "key": "login:test-allow-1765382766456",
  "timestampCount": 3
}
[2025-12-10T16:06:06.458Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:06.458Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:06.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765382766456",
  "key": "login:test-allow-1765382766456"
}
[2025-12-10T16:06:06.458Z] Found existing entry
{
  "key": "login:test-allow-1765382766456",
  "timestampCount": 4
}
[2025-12-10T16:06:06.458Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:06.458Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:06.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.458Z] Creating new entry
{
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.458Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:06.459Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:06.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.459Z] Found existing entry
{
  "key": "login:test-block-1765382766458",
  "timestampCount": 1
}
[2025-12-10T16:06:06.459Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:06.459Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:06.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.459Z] Found existing entry
{
  "key": "login:test-block-1765382766458",
  "timestampCount": 2
}
[2025-12-10T16:06:06.459Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:06.459Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:06.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.459Z] Found existing entry
{
  "key": "login:test-block-1765382766458",
  "timestampCount": 3
}
[2025-12-10T16:06:06.459Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:06.459Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:06.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.459Z] Found existing entry
{
  "key": "login:test-block-1765382766458",
  "timestampCount": 4
}
[2025-12-10T16:06:06.459Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:06.459Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:06.459Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765382766458",
  "key": "login:test-block-1765382766458"
}
[2025-12-10T16:06:06.459Z] Found existing entry
{
  "key": "login:test-block-1765382766458",
  "timestampCount": 5
}
[2025-12-10T16:06:06.459Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:06:06.460Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382766460",
  "key": "test-reset:test-reset-1765382766460"
}
[2025-12-10T16:06:06.460Z] Creating new entry
{
  "key": "test-reset:test-reset-1765382766460"
}
[2025-12-10T16:06:06.460Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:06:06.460Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:06:06.460Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382766460",
  "key": "test-reset:test-reset-1765382766460"
}
[2025-12-10T16:06:06.460Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382766460",
  "timestampCount": 1
}
[2025-12-10T16:06:06.460Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:06:06.461Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:06:06.461Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382766460",
  "key": "test-reset:test-reset-1765382766460"
}
[2025-12-10T16:06:06.461Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382766460",
  "timestampCount": 2
}
[2025-12-10T16:06:06.461Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:06:06.613Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765382766460",
  "key": "test-reset:test-reset-1765382766460"
}
[2025-12-10T16:06:06.613Z] Found existing entry
{
  "key": "test-reset:test-reset-1765382766460",
  "timestampCount": 2
}
[2025-12-10T16:06:06.613Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:06:06.613Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:06:06.613Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:06:06.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.614Z] Creating new entry
{
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.614Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:06.614Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:06.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765382766613",
  "timestampCount": 1
}
[2025-12-10T16:06:06.614Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:06.614Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:06.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765382766613",
  "timestampCount": 2
}
[2025-12-10T16:06:06.614Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:06.614Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:06.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.614Z] Found existing entry
{
  "key": "login:test-multi-1-1765382766613",
  "timestampCount": 3
}
[2025-12-10T16:06:06.614Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:06.614Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:06.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.615Z] Found existing entry
{
  "key": "login:test-multi-1-1765382766613",
  "timestampCount": 4
}
[2025-12-10T16:06:06.615Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:06.615Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:06.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765382766613",
  "key": "login:test-multi-1-1765382766613"
}
[2025-12-10T16:06:06.615Z] Found existing entry
{
  "key": "login:test-multi-1-1765382766613",
  "timestampCount": 5
}
[2025-12-10T16:06:06.615Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:06:06.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765382766613",
  "key": "login:test-multi-2-1765382766613"
}
[2025-12-10T16:06:06.615Z] Creating new entry
{
  "key": "login:test-multi-2-1765382766613"
}
[2025-12-10T16:06:06.615Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:06.615Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:06.616Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765382766616",
  "key": "login:test-reset-time-1765382766616"
}
[2025-12-10T16:06:06.616Z] Creating new entry
{
  "key": "login:test-reset-time-1765382766616"
}
[2025-12-10T16:06:06.616Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:06.616Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:06.619Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:06.619Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:06:06.619Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:06.619Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:06:06.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:06.620Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:06:06.621Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:06.621Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:06:06.621Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:06.621Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:06:06.621Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382766621",
  "key": "test-sliding:test-sliding-1765382766621"
}
[2025-12-10T16:06:06.621Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765382766621"
}
[2025-12-10T16:06:06.621Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:06.621Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:06.723Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382766621",
  "key": "test-sliding:test-sliding-1765382766621"
}
[2025-12-10T16:06:06.724Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382766621",
  "timestampCount": 1
}
[2025-12-10T16:06:06.724Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:06:06.724Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:06:06.825Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765382766621",
  "key": "test-sliding:test-sliding-1765382766621"
}
[2025-12-10T16:06:06.828Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765382766621",
  "timestampCount": 2
}
[2025-12-10T16:06:06.829Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T16:06:06.829Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:06:06.829Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:06:06.830Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765382766830",
  "key": "register:test-format-allowed-1765382766830"
}
[2025-12-10T16:06:06.830Z] Creating new entry
{
  "key": "register:test-format-allowed-1765382766830"
}
[2025-12-10T16:06:06.830Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:06.830Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:06.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382766831",
  "key": "register:test-format-blocked-1765382766831"
}
[2025-12-10T16:06:06.831Z] Creating new entry
{
  "key": "register:test-format-blocked-1765382766831"
}
[2025-12-10T16:06:06.831Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:06.831Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:06.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382766831",
  "key": "register:test-format-blocked-1765382766831"
}
[2025-12-10T16:06:06.831Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382766831",
  "timestampCount": 1
}
[2025-12-10T16:06:06.831Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:06:06.831Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:06:06.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382766831",
  "key": "register:test-format-blocked-1765382766831"
}
[2025-12-10T16:06:06.832Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382766831",
  "timestampCount": 2
}
[2025-12-10T16:06:06.832Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:06:06.832Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:06:06.832Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765382766831",
  "key": "register:test-format-blocked-1765382766831"
}
[2025-12-10T16:06:06.832Z] Found existing entry
{
  "key": "register:test-format-blocked-1765382766831",
  "timestampCount": 3
}
[2025-12-10T16:06:06.832Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:06:46.961Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:46.965Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:46.966Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:06:46.967Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:06:46.967Z] Creating new entry
{
  "key": "register:unknown"
}
[2025-12-10T16:06:46.967Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:46.967Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:46.967Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:46.967Z"
  }
}
[2025-12-10T16:06:46.995Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-10T16:06:46.995Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:46.995Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:06:46.995Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:06:46.995Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-10T16:06:46.995Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:46.995Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:46.995Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:46.995Z"
  }
}
[2025-12-10T16:06:47.023Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-10T16:06:47.024Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:47.024Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:06:47.024Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:06:47.024Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-10T16:06:47.024Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:47.024Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:47.024Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:46.995Z"
  }
}
[2025-12-10T16:06:48.000Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:48.000Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:48.000Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.000Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.000Z] Creating new entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.000Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:48.000Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:48.001Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:48.350Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:48.350Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1765382808285-95xos9",
  "willUseTestId": true
}
[2025-12-10T16:06:48.350Z] Using test identifier
{
  "identifier": "test:login-headers-1765382808285-95xos9"
}
[2025-12-10T16:06:48.350Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1765382808285-95xos9",
  "key": "login:test:login-headers-1765382808285-95xos9"
}
[2025-12-10T16:06:48.351Z] Creating new entry
{
  "key": "login:test:login-headers-1765382808285-95xos9"
}
[2025-12-10T16:06:48.351Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:48.351Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:48.351Z] Rate limit check result
{
  "identifier": "test:login-headers-1765382808285-95xos9",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:48.350Z"
  }
}
[2025-12-10T16:06:48.402Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:48.403Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:48.403Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.403Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.403Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc",
  "timestampCount": 1
}
[2025-12-10T16:06:48.403Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:48.403Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:48.403Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:48.718Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:48.718Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:48.718Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.718Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:48.718Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc",
  "timestampCount": 2
}
[2025-12-10T16:06:48.718Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:48.718Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:48.718Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:48.789Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:48.790Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:48.790Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:48.790Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:48.790Z] Creating new entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:48.790Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:48.790Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:48.790Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:49.014Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.015Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:49.015Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.015Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.015Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc",
  "timestampCount": 3
}
[2025-12-10T16:06:49.015Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:49.015Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:49.015Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:49.044Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.044Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:49.044Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.045Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae",
  "timestampCount": 1
}
[2025-12-10T16:06:49.045Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:49.045Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:49.046Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:49.049Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:49.049Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382809017-ylbggk",
  "willUseTestId": true
}
[2025-12-10T16:06:49.049Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.049Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "key": "register:test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.049Z] Creating new entry
{
  "key": "register:test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.049Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:49.049Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:49.049Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:49.049Z"
  }
}
[2025-12-10T16:06:49.071Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:06:49.071Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:06:49.071Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:06:49.071Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:06:49.072Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-10T16:06:49.072Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:49.072Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:49.072Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:46.995Z"
  }
}
[2025-12-10T16:06:49.316Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.316Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:49.316Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.316Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.317Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc",
  "timestampCount": 4
}
[2025-12-10T16:06:49.317Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:49.317Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:49.317Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:49.334Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.335Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:49.335Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.335Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae",
  "timestampCount": 2
}
[2025-12-10T16:06:49.336Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:49.336Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:49.336Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:49.440Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:49.440Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382809017-ylbggk",
  "willUseTestId": true
}
[2025-12-10T16:06:49.440Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "key": "register:test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.440Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382809017-ylbggk",
  "timestampCount": 1
}
[2025-12-10T16:06:49.440Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:06:49.440Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:06:49.440Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:49.049Z"
  }
}
[2025-12-10T16:06:49.607Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.608Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:49.608Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.608Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae",
  "timestampCount": 3
}
[2025-12-10T16:06:49.608Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:49.608Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:49.608Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:49.647Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.647Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1765382807955-4t3vc",
  "willUseTestId": true
}
[2025-12-10T16:06:49.647Z] Using test identifier
{
  "identifier": "test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.647Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "key": "login:test:login-excessive-1765382807955-4t3vc"
}
[2025-12-10T16:06:49.647Z] Found existing entry
{
  "key": "login:test:login-excessive-1765382807955-4t3vc",
  "timestampCount": 5
}
[2025-12-10T16:06:49.647Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:06:49.649Z] Rate limit check result
{
  "identifier": "test:login-excessive-1765382807955-4t3vc",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:48.000Z"
  }
}
[2025-12-10T16:06:49.842Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:49.842Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1765382809832-dpvx4c",
  "willUseTestId": true
}
[2025-12-10T16:06:49.843Z] Using test identifier
{
  "identifier": "test:register-headers-1765382809832-dpvx4c"
}
[2025-12-10T16:06:49.843Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1765382809832-dpvx4c",
  "key": "register:test:register-headers-1765382809832-dpvx4c"
}
[2025-12-10T16:06:49.843Z] Creating new entry
{
  "key": "register:test:register-headers-1765382809832-dpvx4c"
}
[2025-12-10T16:06:49.843Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:49.843Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:49.843Z] Rate limit check result
{
  "identifier": "test:register-headers-1765382809832-dpvx4c",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:49.843Z"
  }
}
[2025-12-10T16:06:49.882Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:49.883Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:49.883Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.883Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:49.883Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae",
  "timestampCount": 4
}
[2025-12-10T16:06:49.883Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:49.883Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:49.884Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:49.972Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:49.973Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382809017-ylbggk",
  "willUseTestId": true
}
[2025-12-10T16:06:49.973Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.973Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "key": "register:test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:49.973Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382809017-ylbggk",
  "timestampCount": 2
}
[2025-12-10T16:06:49.973Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:06:49.973Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:06:49.973Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:49.049Z"
  }
}
[2025-12-10T16:06:50.135Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.135Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1765382808768-7onsae",
  "willUseTestId": true
}
[2025-12-10T16:06:50.135Z] Using test identifier
{
  "identifier": "test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:50.135Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "key": "login:test:login-retry-after-1765382808768-7onsae"
}
[2025-12-10T16:06:50.135Z] Found existing entry
{
  "key": "login:test:login-retry-after-1765382808768-7onsae",
  "timestampCount": 5
}
[2025-12-10T16:06:50.135Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:06:50.136Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1765382808768-7onsae",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:48.790Z"
  }
}
[2025-12-10T16:06:50.472Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.472Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382810457-ohz2i7",
  "willUseTestId": true
}
[2025-12-10T16:06:50.473Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:50.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "key": "login:test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:50.474Z] Creating new entry
{
  "key": "login:test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:50.474Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:50.475Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:50.475Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:50.473Z"
  }
}
[2025-12-10T16:06:50.529Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.529Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:50.529Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:50.529Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:50.529Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:50.529Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:50.529Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:50.529Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:50.726Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:50.727Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1765382809017-ylbggk",
  "willUseTestId": true
}
[2025-12-10T16:06:50.727Z] Using test identifier
{
  "identifier": "test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:50.727Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "key": "register:test:register-excessive-1765382809017-ylbggk"
}
[2025-12-10T16:06:50.727Z] Found existing entry
{
  "key": "register:test:register-excessive-1765382809017-ylbggk",
  "timestampCount": 3
}
[2025-12-10T16:06:50.727Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-10T16:06:50.728Z] Rate limit check result
{
  "identifier": "test:register-excessive-1765382809017-ylbggk",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:49.049Z"
  }
}
[2025-12-10T16:06:50.733Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.733Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382810457-ohz2i7",
  "willUseTestId": true
}
[2025-12-10T16:06:50.733Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:50.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "key": "login:test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:50.733Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765382810457-ohz2i7",
  "timestampCount": 1
}
[2025-12-10T16:06:50.733Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:50.733Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:50.734Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:50.473Z"
  }
}
[2025-12-10T16:06:50.770Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.770Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:50.770Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:50.770Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:50.770Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq",
  "timestampCount": 1
}
[2025-12-10T16:06:50.770Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:50.770Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:50.770Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:50.879Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:50.880Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765382810829-i1tewp",
  "willUseTestId": true
}
[2025-12-10T16:06:50.880Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765382810829-i1tewp"
}
[2025-12-10T16:06:50.880Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765382810829-i1tewp",
  "key": "login:test:headers-consistent-1765382810829-i1tewp"
}
[2025-12-10T16:06:50.880Z] Creating new entry
{
  "key": "login:test:headers-consistent-1765382810829-i1tewp"
}
[2025-12-10T16:06:50.880Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:50.880Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:50.880Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765382810829-i1tewp",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:50.880Z"
  }
}
[2025-12-10T16:06:50.971Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.006Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1765382810457-ohz2i7",
  "willUseTestId": true
}
[2025-12-10T16:06:51.006Z] Using test identifier
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:51.006Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "key": "login:test:headers-remaining-1765382810457-ohz2i7"
}
[2025-12-10T16:06:51.006Z] Found existing entry
{
  "key": "login:test:headers-remaining-1765382810457-ohz2i7",
  "timestampCount": 2
}
[2025-12-10T16:06:51.006Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:51.006Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:51.006Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1765382810457-ohz2i7",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:50.473Z"
  }
}
[2025-12-10T16:06:51.115Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.115Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1765382810829-i1tewp",
  "willUseTestId": true
}
[2025-12-10T16:06:51.115Z] Using test identifier
{
  "identifier": "test:headers-consistent-1765382810829-i1tewp"
}
[2025-12-10T16:06:51.115Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1765382810829-i1tewp",
  "key": "login:test:headers-consistent-1765382810829-i1tewp"
}
[2025-12-10T16:06:51.115Z] Found existing entry
{
  "key": "login:test:headers-consistent-1765382810829-i1tewp",
  "timestampCount": 1
}
[2025-12-10T16:06:51.115Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:06:51.115Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:06:51.115Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1765382810829-i1tewp",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-10T16:07:50.880Z"
  }
}
[2025-12-10T16:06:51.161Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.162Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:51.162Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.162Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.162Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq",
  "timestampCount": 2
}
[2025-12-10T16:06:51.162Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:06:51.162Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:06:51.162Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:51.363Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.363Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1765382811351-6vsnjn",
  "willUseTestId": true
}
[2025-12-10T16:06:51.363Z] Using test identifier
{
  "identifier": "test:perf-test-1765382811351-6vsnjn"
}
[2025-12-10T16:06:51.363Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1765382811351-6vsnjn",
  "key": "login:test:perf-test-1765382811351-6vsnjn"
}
[2025-12-10T16:06:51.363Z] Creating new entry
{
  "key": "login:test:perf-test-1765382811351-6vsnjn"
}
[2025-12-10T16:06:51.363Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:06:51.364Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:06:51.364Z] Rate limit check result
{
  "identifier": "test:perf-test-1765382811351-6vsnjn",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-10T16:07:51.363Z"
  }
}
[2025-12-10T16:06:51.370Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.370Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:51.370Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.370Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.371Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq",
  "timestampCount": 3
}
[2025-12-10T16:06:51.371Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:06:51.371Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:06:51.371Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:51.625Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.625Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:51.625Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.625Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.625Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq",
  "timestampCount": 4
}
[2025-12-10T16:06:51.625Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:06:51.626Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:06:51.626Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:51.894Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-10T16:06:51.894Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:51.894Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.895Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "login:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.895Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1765382810515-2exzoq",
  "timestampCount": 5
}
[2025-12-10T16:06:51.895Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:06:51.896Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:50.529Z"
  }
}
[2025-12-10T16:06:51.913Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:06:51.913Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1765382810515-2exzoq",
  "willUseTestId": true
}
[2025-12-10T16:06:51.913Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.913Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "key": "register:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.913Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1765382810515-2exzoq"
}
[2025-12-10T16:06:51.913Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:06:51.913Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:06:51.913Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1765382810515-2exzoq",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-10T16:07:51.913Z"
  }
}
[2025-12-10T16:07:03.324Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:07:03.327Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:07:03.327Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:07:03.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:07:03.327Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2025-12-10T16:07:03.328Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:07:03.328Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:07:03.328Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:46.967Z"
  }
}
[2025-12-10T16:07:05.567Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:07:05.569Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:07:05.573Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:07:05.573Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:07:05.573Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 3
}
[2025-12-10T16:07:05.574Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:07:05.574Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:07:05.574Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2025-12-10T16:07:46.995Z"
  }
}
[2025-12-10T16:07:26.444Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2025-12-10T16:07:26.453Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:07:26.453Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:07:26.453Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2025-12-10T16:07:26.453Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 2
}
[2025-12-10T16:07:26.453Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:07:26.453Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:07:26.453Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:46.967Z"
  }
}
[2025-12-10T16:07:28.663Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2025-12-10T16:07:28.663Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:07:28.663Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:07:28.663Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-10T16:07:28.663Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 4
}
[2025-12-10T16:07:28.663Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:07:28.664Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:07:28.664Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2025-12-10T16:07:46.995Z"
  }
}
[2025-12-10T16:27:33.555Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384053555",
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.556Z] Creating new entry
{
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.556Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:27:33.556Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:27:33.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384053555",
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.557Z] Found existing entry
{
  "key": "login:test-allow-1765384053555",
  "timestampCount": 1
}
[2025-12-10T16:27:33.557Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:27:33.557Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:27:33.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384053555",
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.557Z] Found existing entry
{
  "key": "login:test-allow-1765384053555",
  "timestampCount": 2
}
[2025-12-10T16:27:33.557Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:27:33.557Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:27:33.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384053555",
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.557Z] Found existing entry
{
  "key": "login:test-allow-1765384053555",
  "timestampCount": 3
}
[2025-12-10T16:27:33.557Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:27:33.557Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:27:33.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384053555",
  "key": "login:test-allow-1765384053555"
}
[2025-12-10T16:27:33.558Z] Found existing entry
{
  "key": "login:test-allow-1765384053555",
  "timestampCount": 4
}
[2025-12-10T16:27:33.558Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:27:33.558Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:27:33.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.558Z] Creating new entry
{
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.558Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:27:33.558Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:27:33.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.558Z] Found existing entry
{
  "key": "login:test-block-1765384053558",
  "timestampCount": 1
}
[2025-12-10T16:27:33.558Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:27:33.558Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:27:33.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.558Z] Found existing entry
{
  "key": "login:test-block-1765384053558",
  "timestampCount": 2
}
[2025-12-10T16:27:33.559Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:27:33.559Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:27:33.559Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.559Z] Found existing entry
{
  "key": "login:test-block-1765384053558",
  "timestampCount": 3
}
[2025-12-10T16:27:33.559Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:27:33.559Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:27:33.559Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.559Z] Found existing entry
{
  "key": "login:test-block-1765384053558",
  "timestampCount": 4
}
[2025-12-10T16:27:33.559Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:27:33.559Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:27:33.559Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384053558",
  "key": "login:test-block-1765384053558"
}
[2025-12-10T16:27:33.559Z] Found existing entry
{
  "key": "login:test-block-1765384053558",
  "timestampCount": 5
}
[2025-12-10T16:27:33.559Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:27:33.560Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384053560",
  "key": "test-reset:test-reset-1765384053560"
}
[2025-12-10T16:27:33.560Z] Creating new entry
{
  "key": "test-reset:test-reset-1765384053560"
}
[2025-12-10T16:27:33.560Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:27:33.560Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:27:33.560Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384053560",
  "key": "test-reset:test-reset-1765384053560"
}
[2025-12-10T16:27:33.560Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384053560",
  "timestampCount": 1
}
[2025-12-10T16:27:33.560Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:27:33.560Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:27:33.560Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384053560",
  "key": "test-reset:test-reset-1765384053560"
}
[2025-12-10T16:27:33.560Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384053560",
  "timestampCount": 2
}
[2025-12-10T16:27:33.560Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:27:33.710Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384053560",
  "key": "test-reset:test-reset-1765384053560"
}
[2025-12-10T16:27:33.710Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384053560",
  "timestampCount": 2
}
[2025-12-10T16:27:33.710Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:27:33.710Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:27:33.710Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:27:33.710Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.710Z] Creating new entry
{
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.710Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:27:33.710Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.711Z] Found existing entry
{
  "key": "login:test-multi-1-1765384053710",
  "timestampCount": 1
}
[2025-12-10T16:27:33.711Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:27:33.711Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.711Z] Found existing entry
{
  "key": "login:test-multi-1-1765384053710",
  "timestampCount": 2
}
[2025-12-10T16:27:33.711Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:27:33.711Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.711Z] Found existing entry
{
  "key": "login:test-multi-1-1765384053710",
  "timestampCount": 3
}
[2025-12-10T16:27:33.711Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:27:33.711Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.711Z] Found existing entry
{
  "key": "login:test-multi-1-1765384053710",
  "timestampCount": 4
}
[2025-12-10T16:27:33.711Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:27:33.711Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384053710",
  "key": "login:test-multi-1-1765384053710"
}
[2025-12-10T16:27:33.711Z] Found existing entry
{
  "key": "login:test-multi-1-1765384053710",
  "timestampCount": 5
}
[2025-12-10T16:27:33.711Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:27:33.711Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765384053710",
  "key": "login:test-multi-2-1765384053710"
}
[2025-12-10T16:27:33.711Z] Creating new entry
{
  "key": "login:test-multi-2-1765384053710"
}
[2025-12-10T16:27:33.712Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:27:33.712Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:27:33.712Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765384053712",
  "key": "login:test-reset-time-1765384053712"
}
[2025-12-10T16:27:33.712Z] Creating new entry
{
  "key": "login:test-reset-time-1765384053712"
}
[2025-12-10T16:27:33.712Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:27:33.712Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:27:33.713Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:27:33.713Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:27:33.713Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:27:33.713Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:27:33.713Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:27:33.713Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:27:33.713Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:27:33.714Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:27:33.714Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:27:33.714Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:27:33.714Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765384053714",
  "key": "test-sliding:test-sliding-1765384053714"
}
[2025-12-10T16:27:33.714Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765384053714"
}
[2025-12-10T16:27:33.714Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:27:33.714Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:31:56.321Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384316321",
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.336Z] Creating new entry
{
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.337Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:31:56.337Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:31:56.337Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384316321",
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.337Z] Found existing entry
{
  "key": "login:test-allow-1765384316321",
  "timestampCount": 1
}
[2025-12-10T16:31:56.338Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:31:56.338Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:31:56.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384316321",
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.338Z] Found existing entry
{
  "key": "login:test-allow-1765384316321",
  "timestampCount": 2
}
[2025-12-10T16:31:56.338Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:31:56.338Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:31:56.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384316321",
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.338Z] Found existing entry
{
  "key": "login:test-allow-1765384316321",
  "timestampCount": 3
}
[2025-12-10T16:31:56.338Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:31:56.338Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:31:56.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765384316321",
  "key": "login:test-allow-1765384316321"
}
[2025-12-10T16:31:56.338Z] Found existing entry
{
  "key": "login:test-allow-1765384316321",
  "timestampCount": 4
}
[2025-12-10T16:31:56.338Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:31:56.338Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:31:56.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.338Z] Creating new entry
{
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.339Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:31:56.339Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:31:56.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.339Z] Found existing entry
{
  "key": "login:test-block-1765384316338",
  "timestampCount": 1
}
[2025-12-10T16:31:56.339Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:31:56.339Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:31:56.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.339Z] Found existing entry
{
  "key": "login:test-block-1765384316338",
  "timestampCount": 2
}
[2025-12-10T16:31:56.339Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:31:56.339Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:31:56.345Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.345Z] Found existing entry
{
  "key": "login:test-block-1765384316338",
  "timestampCount": 3
}
[2025-12-10T16:31:56.345Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:31:56.345Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:31:56.345Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.345Z] Found existing entry
{
  "key": "login:test-block-1765384316338",
  "timestampCount": 4
}
[2025-12-10T16:31:56.345Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:31:56.345Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:31:56.346Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765384316338",
  "key": "login:test-block-1765384316338"
}
[2025-12-10T16:31:56.346Z] Found existing entry
{
  "key": "login:test-block-1765384316338",
  "timestampCount": 5
}
[2025-12-10T16:31:56.346Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:31:56.346Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384316346",
  "key": "test-reset:test-reset-1765384316346"
}
[2025-12-10T16:31:56.346Z] Creating new entry
{
  "key": "test-reset:test-reset-1765384316346"
}
[2025-12-10T16:31:56.346Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:31:56.346Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:31:56.346Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384316346",
  "key": "test-reset:test-reset-1765384316346"
}
[2025-12-10T16:31:56.346Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384316346",
  "timestampCount": 1
}
[2025-12-10T16:31:56.347Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-10T16:31:56.347Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-10T16:31:56.347Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384316346",
  "key": "test-reset:test-reset-1765384316346"
}
[2025-12-10T16:31:56.347Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384316346",
  "timestampCount": 2
}
[2025-12-10T16:31:56.347Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-10T16:31:56.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765384316346",
  "key": "test-reset:test-reset-1765384316346"
}
[2025-12-10T16:31:56.511Z] Found existing entry
{
  "key": "test-reset:test-reset-1765384316346",
  "timestampCount": 2
}
[2025-12-10T16:31:56.511Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-10T16:31:56.512Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-10T16:31:56.512Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-10T16:31:56.512Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.512Z] Creating new entry
{
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.512Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:31:56.512Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:31:56.512Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.513Z] Found existing entry
{
  "key": "login:test-multi-1-1765384316512",
  "timestampCount": 1
}
[2025-12-10T16:31:56.513Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-10T16:31:56.513Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-10T16:31:56.513Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.514Z] Found existing entry
{
  "key": "login:test-multi-1-1765384316512",
  "timestampCount": 2
}
[2025-12-10T16:31:56.515Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-10T16:31:56.515Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-10T16:31:56.515Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.515Z] Found existing entry
{
  "key": "login:test-multi-1-1765384316512",
  "timestampCount": 3
}
[2025-12-10T16:31:56.515Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-10T16:31:56.515Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-10T16:31:56.515Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.515Z] Found existing entry
{
  "key": "login:test-multi-1-1765384316512",
  "timestampCount": 4
}
[2025-12-10T16:31:56.515Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-10T16:31:56.515Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-10T16:31:56.515Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765384316512",
  "key": "login:test-multi-1-1765384316512"
}
[2025-12-10T16:31:56.515Z] Found existing entry
{
  "key": "login:test-multi-1-1765384316512",
  "timestampCount": 5
}
[2025-12-10T16:31:56.515Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-10T16:31:56.515Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765384316512",
  "key": "login:test-multi-2-1765384316512"
}
[2025-12-10T16:31:56.516Z] Creating new entry
{
  "key": "login:test-multi-2-1765384316512"
}
[2025-12-10T16:31:56.516Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:31:56.516Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:31:56.516Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765384316516",
  "key": "login:test-reset-time-1765384316516"
}
[2025-12-10T16:31:56.517Z] Creating new entry
{
  "key": "login:test-reset-time-1765384316516"
}
[2025-12-10T16:31:56.517Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-10T16:31:56.517Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-10T16:31:56.519Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:31:56.519Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:31:56.519Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:31:56.519Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-10T16:31:56.520Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:31:56.520Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:31:56.520Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:31:56.520Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-10T16:31:56.520Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-10T16:31:56.520Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-10T16:31:56.520Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765384316520",
  "key": "test-sliding:test-sliding-1765384316520"
}
[2025-12-10T16:31:56.520Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765384316520"
}
[2025-12-10T16:31:56.520Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:31:56.520Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:31:56.620Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765384316520",
  "key": "test-sliding:test-sliding-1765384316520"
}
[2025-12-10T16:31:56.620Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765384316520",
  "timestampCount": 1
}
[2025-12-10T16:31:56.620Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:31:56.620Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:31:56.721Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765384316520",
  "key": "test-sliding:test-sliding-1765384316520"
}
[2025-12-10T16:31:56.733Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765384316520",
  "timestampCount": 2
}
[2025-12-10T16:31:56.733Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-10T16:31:56.733Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:31:56.733Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:31:56.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765384316733",
  "key": "register:test-format-allowed-1765384316733"
}
[2025-12-10T16:31:56.734Z] Creating new entry
{
  "key": "register:test-format-allowed-1765384316733"
}
[2025-12-10T16:31:56.734Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:31:56.734Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:31:56.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765384316734",
  "key": "register:test-format-blocked-1765384316734"
}
[2025-12-10T16:31:56.734Z] Creating new entry
{
  "key": "register:test-format-blocked-1765384316734"
}
[2025-12-10T16:31:56.734Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-10T16:31:56.734Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-10T16:31:56.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765384316734",
  "key": "register:test-format-blocked-1765384316734"
}
[2025-12-10T16:31:56.734Z] Found existing entry
{
  "key": "register:test-format-blocked-1765384316734",
  "timestampCount": 1
}
[2025-12-10T16:31:56.734Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-10T16:31:56.734Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-10T16:31:56.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765384316734",
  "key": "register:test-format-blocked-1765384316734"
}
[2025-12-10T16:31:56.735Z] Found existing entry
{
  "key": "register:test-format-blocked-1765384316734",
  "timestampCount": 2
}
[2025-12-10T16:31:56.735Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-10T16:31:56.735Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-10T16:31:56.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765384316734",
  "key": "register:test-format-blocked-1765384316734"
}
[2025-12-10T16:31:56.735Z] Found existing entry
{
  "key": "register:test-format-blocked-1765384316734",
  "timestampCount": 3
}
[2025-12-10T16:31:56.735Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-12T06:49:40.107Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-12T06:49:40.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:49:40.109Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:49:40.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T06:49:40.109Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-12T06:49:40.109Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T06:49:40.109Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T06:49:40.109Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-12T06:50:40.109Z"
  }
}
[2025-12-12T06:49:55.872Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2025-12-12T06:49:55.873Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:49:55.873Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:49:55.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T06:49:55.873Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2025-12-12T06:49:55.873Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T06:49:55.873Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T06:49:55.873Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-12T06:50:40.109Z"
  }
}
[2025-12-12T06:50:41.463Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2025-12-12T06:50:41.464Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:50:41.468Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:50:41.468Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T06:50:41.468Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-12T06:50:41.468Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-12T06:50:41.468Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T06:50:41.468Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T06:50:41.468Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2025-12-12T06:50:55.873Z"
  }
}
[2025-12-12T06:50:50.556Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-12T06:50:50.558Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:50:50.558Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:50:50.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T06:50:50.558Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2025-12-12T06:50:50.558Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T06:50:50.558Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T06:50:50.558Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2025-12-12T06:50:55.873Z"
  }
}
[2025-12-12T06:53:48.434Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:53:48.435Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:53:48.435Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:53:48.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:53:48.441Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T06:53:48.441Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T06:53:48.442Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T06:53:48.442Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T06:54:48.439Z"
  }
}
[2025-12-12T06:53:49.380Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:53:49.380Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:53:49.380Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:53:49.380Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:53:49.380Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T06:53:49.380Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T06:53:49.380Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T06:53:49.381Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T06:54:48.439Z"
  }
}
[2025-12-12T06:55:59.276Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:55:59.276Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:55:59.277Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:55:59.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:55:59.277Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T06:55:59.277Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T06:55:59.277Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T06:55:59.277Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T06:55:59.277Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T06:56:59.277Z"
  }
}
[2025-12-12T06:56:00.209Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:56:00.209Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:56:00.209Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:56:00.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:56:00.209Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T06:56:00.209Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T06:56:00.209Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T06:56:00.209Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T06:56:59.277Z"
  }
}
[2025-12-12T06:56:41.100Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:56:41.101Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:56:41.102Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:56:41.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:56:41.102Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T06:56:41.102Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-12T06:56:41.102Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-12T06:56:41.102Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-12T06:56:59.277Z"
  }
}
[2025-12-12T06:56:41.842Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T06:56:41.842Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T06:56:41.843Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T06:56:41.843Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T06:56:41.843Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-12T06:56:41.843Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-12T06:56:41.843Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-12T06:56:41.843Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-12T06:56:59.277Z"
  }
}
[2025-12-12T07:59:22.884Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765526362884",
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.885Z] Creating new entry
{
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.885Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T07:59:22.885Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T07:59:22.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765526362884",
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.886Z] Found existing entry
{
  "key": "login:test-allow-1765526362884",
  "timestampCount": 1
}
[2025-12-12T07:59:22.886Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T07:59:22.886Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T07:59:22.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765526362884",
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.886Z] Found existing entry
{
  "key": "login:test-allow-1765526362884",
  "timestampCount": 2
}
[2025-12-12T07:59:22.886Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T07:59:22.886Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T07:59:22.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765526362884",
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.886Z] Found existing entry
{
  "key": "login:test-allow-1765526362884",
  "timestampCount": 3
}
[2025-12-12T07:59:22.886Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T07:59:22.886Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T07:59:22.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765526362884",
  "key": "login:test-allow-1765526362884"
}
[2025-12-12T07:59:22.886Z] Found existing entry
{
  "key": "login:test-allow-1765526362884",
  "timestampCount": 4
}
[2025-12-12T07:59:22.886Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T07:59:22.886Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Creating new entry
{
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T07:59:22.887Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Found existing entry
{
  "key": "login:test-block-1765526362887",
  "timestampCount": 1
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T07:59:22.887Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Found existing entry
{
  "key": "login:test-block-1765526362887",
  "timestampCount": 2
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T07:59:22.887Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Found existing entry
{
  "key": "login:test-block-1765526362887",
  "timestampCount": 3
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T07:59:22.887Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Found existing entry
{
  "key": "login:test-block-1765526362887",
  "timestampCount": 4
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T07:59:22.887Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T07:59:22.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765526362887",
  "key": "login:test-block-1765526362887"
}
[2025-12-12T07:59:22.887Z] Found existing entry
{
  "key": "login:test-block-1765526362887",
  "timestampCount": 5
}
[2025-12-12T07:59:22.887Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T07:59:22.888Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765526362888",
  "key": "test-reset:test-reset-1765526362888"
}
[2025-12-12T07:59:22.888Z] Creating new entry
{
  "key": "test-reset:test-reset-1765526362888"
}
[2025-12-12T07:59:22.888Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T07:59:22.888Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T07:59:22.888Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765526362888",
  "key": "test-reset:test-reset-1765526362888"
}
[2025-12-12T07:59:22.888Z] Found existing entry
{
  "key": "test-reset:test-reset-1765526362888",
  "timestampCount": 1
}
[2025-12-12T07:59:22.888Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-12T07:59:22.888Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-12T07:59:22.889Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765526362888",
  "key": "test-reset:test-reset-1765526362888"
}
[2025-12-12T07:59:22.889Z] Found existing entry
{
  "key": "test-reset:test-reset-1765526362888",
  "timestampCount": 2
}
[2025-12-12T07:59:22.889Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-12T07:59:23.041Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765526362888",
  "key": "test-reset:test-reset-1765526362888"
}
[2025-12-12T07:59:23.041Z] Found existing entry
{
  "key": "test-reset:test-reset-1765526362888",
  "timestampCount": 2
}
[2025-12-12T07:59:23.041Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T07:59:23.041Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T07:59:23.041Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T07:59:23.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.042Z] Creating new entry
{
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.042Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T07:59:23.042Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T07:59:23.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.042Z] Found existing entry
{
  "key": "login:test-multi-1-1765526363042",
  "timestampCount": 1
}
[2025-12-12T07:59:23.042Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T07:59:23.042Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T07:59:23.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.043Z] Found existing entry
{
  "key": "login:test-multi-1-1765526363042",
  "timestampCount": 2
}
[2025-12-12T07:59:23.043Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T07:59:23.043Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T07:59:23.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.043Z] Found existing entry
{
  "key": "login:test-multi-1-1765526363042",
  "timestampCount": 3
}
[2025-12-12T07:59:23.043Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T07:59:23.043Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T07:59:23.043Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.043Z] Found existing entry
{
  "key": "login:test-multi-1-1765526363042",
  "timestampCount": 4
}
[2025-12-12T07:59:23.044Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T07:59:23.044Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T07:59:23.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765526363042",
  "key": "login:test-multi-1-1765526363042"
}
[2025-12-12T07:59:23.044Z] Found existing entry
{
  "key": "login:test-multi-1-1765526363042",
  "timestampCount": 5
}
[2025-12-12T07:59:23.044Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T07:59:23.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765526363042",
  "key": "login:test-multi-2-1765526363042"
}
[2025-12-12T07:59:23.044Z] Creating new entry
{
  "key": "login:test-multi-2-1765526363042"
}
[2025-12-12T07:59:23.044Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T07:59:23.044Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T07:59:23.045Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765526363045",
  "key": "login:test-reset-time-1765526363045"
}
[2025-12-12T07:59:23.045Z] Creating new entry
{
  "key": "login:test-reset-time-1765526363045"
}
[2025-12-12T07:59:23.045Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T07:59:23.045Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T07:59:23.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:23.046Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T07:59:23.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:23.046Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-12T07:59:23.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:23.046Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T07:59:23.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:23.046Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T07:59:23.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:23.046Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T07:59:23.046Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765526363046",
  "key": "test-sliding:test-sliding-1765526363046"
}
[2025-12-12T07:59:23.047Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765526363046"
}
[2025-12-12T07:59:23.047Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T07:59:23.047Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T07:59:23.147Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765526363046",
  "key": "test-sliding:test-sliding-1765526363046"
}
[2025-12-12T07:59:23.147Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765526363046",
  "timestampCount": 1
}
[2025-12-12T07:59:23.147Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T07:59:23.147Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T07:59:23.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765526363046",
  "key": "test-sliding:test-sliding-1765526363046"
}
[2025-12-12T07:59:23.247Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765526363046",
  "timestampCount": 2
}
[2025-12-12T07:59:23.247Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-12T07:59:23.248Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T07:59:23.248Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T07:59:23.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765526363248",
  "key": "register:test-format-allowed-1765526363248"
}
[2025-12-12T07:59:23.248Z] Creating new entry
{
  "key": "register:test-format-allowed-1765526363248"
}
[2025-12-12T07:59:23.248Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T07:59:23.248Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T07:59:23.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765526363248",
  "key": "register:test-format-blocked-1765526363248"
}
[2025-12-12T07:59:23.248Z] Creating new entry
{
  "key": "register:test-format-blocked-1765526363248"
}
[2025-12-12T07:59:23.248Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T07:59:23.248Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T07:59:23.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765526363248",
  "key": "register:test-format-blocked-1765526363248"
}
[2025-12-12T07:59:23.248Z] Found existing entry
{
  "key": "register:test-format-blocked-1765526363248",
  "timestampCount": 1
}
[2025-12-12T07:59:23.248Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T07:59:23.248Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T07:59:23.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765526363248",
  "key": "register:test-format-blocked-1765526363248"
}
[2025-12-12T07:59:23.249Z] Found existing entry
{
  "key": "register:test-format-blocked-1765526363248",
  "timestampCount": 2
}
[2025-12-12T07:59:23.249Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-12T07:59:23.249Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-12T07:59:23.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765526363248",
  "key": "register:test-format-blocked-1765526363248"
}
[2025-12-12T07:59:23.249Z] Found existing entry
{
  "key": "register:test-format-blocked-1765526363248",
  "timestampCount": 3
}
[2025-12-12T07:59:23.249Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-12T07:59:29.296Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T07:59:29.296Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:29.296Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T07:59:29.296Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T07:59:29.296Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T07:59:29.296Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T07:59:29.296Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T07:59:29.296Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T08:00:29.296Z"
  }
}
[2025-12-12T07:59:30.404Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T07:59:30.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T07:59:30.405Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T07:59:30.405Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T07:59:30.405Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T07:59:30.405Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T07:59:30.405Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T07:59:30.405Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T08:00:29.296Z"
  }
}
[2025-12-12T09:32:28.211Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765531948211",
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.213Z] Creating new entry
{
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.213Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T09:32:28.213Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T09:32:28.214Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765531948211",
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.214Z] Found existing entry
{
  "key": "login:test-allow-1765531948211",
  "timestampCount": 1
}
[2025-12-12T09:32:28.214Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T09:32:28.214Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T09:32:28.214Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765531948211",
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.214Z] Found existing entry
{
  "key": "login:test-allow-1765531948211",
  "timestampCount": 2
}
[2025-12-12T09:32:28.214Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T09:32:28.214Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T09:32:28.214Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765531948211",
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.214Z] Found existing entry
{
  "key": "login:test-allow-1765531948211",
  "timestampCount": 3
}
[2025-12-12T09:32:28.214Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T09:32:28.214Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T09:32:28.214Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765531948211",
  "key": "login:test-allow-1765531948211"
}
[2025-12-12T09:32:28.214Z] Found existing entry
{
  "key": "login:test-allow-1765531948211",
  "timestampCount": 4
}
[2025-12-12T09:32:28.214Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T09:32:28.214Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Creating new entry
{
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T09:32:28.215Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Found existing entry
{
  "key": "login:test-block-1765531948215",
  "timestampCount": 1
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T09:32:28.215Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Found existing entry
{
  "key": "login:test-block-1765531948215",
  "timestampCount": 2
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T09:32:28.215Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Found existing entry
{
  "key": "login:test-block-1765531948215",
  "timestampCount": 3
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T09:32:28.215Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Found existing entry
{
  "key": "login:test-block-1765531948215",
  "timestampCount": 4
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T09:32:28.215Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T09:32:28.215Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765531948215",
  "key": "login:test-block-1765531948215"
}
[2025-12-12T09:32:28.215Z] Found existing entry
{
  "key": "login:test-block-1765531948215",
  "timestampCount": 5
}
[2025-12-12T09:32:28.215Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T09:32:28.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765531948216",
  "key": "test-reset:test-reset-1765531948216"
}
[2025-12-12T09:32:28.216Z] Creating new entry
{
  "key": "test-reset:test-reset-1765531948216"
}
[2025-12-12T09:32:28.216Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T09:32:28.216Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T09:32:28.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765531948216",
  "key": "test-reset:test-reset-1765531948216"
}
[2025-12-12T09:32:28.216Z] Found existing entry
{
  "key": "test-reset:test-reset-1765531948216",
  "timestampCount": 1
}
[2025-12-12T09:32:28.216Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-12T09:32:28.216Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-12T09:32:28.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765531948216",
  "key": "test-reset:test-reset-1765531948216"
}
[2025-12-12T09:32:28.216Z] Found existing entry
{
  "key": "test-reset:test-reset-1765531948216",
  "timestampCount": 2
}
[2025-12-12T09:32:28.216Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-12T09:32:28.367Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765531948216",
  "key": "test-reset:test-reset-1765531948216"
}
[2025-12-12T09:32:28.368Z] Found existing entry
{
  "key": "test-reset:test-reset-1765531948216",
  "timestampCount": 2
}
[2025-12-12T09:32:28.368Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T09:32:28.368Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T09:32:28.369Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T09:32:28.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.369Z] Creating new entry
{
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.369Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T09:32:28.369Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T09:32:28.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.369Z] Found existing entry
{
  "key": "login:test-multi-1-1765531948369",
  "timestampCount": 1
}
[2025-12-12T09:32:28.369Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T09:32:28.369Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T09:32:28.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.369Z] Found existing entry
{
  "key": "login:test-multi-1-1765531948369",
  "timestampCount": 2
}
[2025-12-12T09:32:28.369Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T09:32:28.369Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T09:32:28.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.369Z] Found existing entry
{
  "key": "login:test-multi-1-1765531948369",
  "timestampCount": 3
}
[2025-12-12T09:32:28.370Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T09:32:28.370Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T09:32:28.370Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.370Z] Found existing entry
{
  "key": "login:test-multi-1-1765531948369",
  "timestampCount": 4
}
[2025-12-12T09:32:28.370Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T09:32:28.370Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T09:32:28.370Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765531948369",
  "key": "login:test-multi-1-1765531948369"
}
[2025-12-12T09:32:28.370Z] Found existing entry
{
  "key": "login:test-multi-1-1765531948369",
  "timestampCount": 5
}
[2025-12-12T09:32:28.370Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T09:32:28.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765531948369",
  "key": "login:test-multi-2-1765531948369"
}
[2025-12-12T09:32:28.371Z] Creating new entry
{
  "key": "login:test-multi-2-1765531948369"
}
[2025-12-12T09:32:28.371Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T09:32:28.371Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T09:32:28.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765531948371",
  "key": "login:test-reset-time-1765531948371"
}
[2025-12-12T09:32:28.371Z] Creating new entry
{
  "key": "login:test-reset-time-1765531948371"
}
[2025-12-12T09:32:28.371Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T09:32:28.371Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T09:32:28.372Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T09:32:28.373Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T09:32:28.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T09:32:28.373Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-12T09:32:28.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T09:32:28.373Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T09:32:28.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T09:32:28.373Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T09:32:28.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T09:32:28.373Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T09:32:28.374Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765531948374",
  "key": "test-sliding:test-sliding-1765531948374"
}
[2025-12-12T09:32:28.374Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765531948374"
}
[2025-12-12T09:32:28.374Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T09:32:28.374Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T09:32:28.475Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765531948374",
  "key": "test-sliding:test-sliding-1765531948374"
}
[2025-12-12T09:32:28.475Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765531948374",
  "timestampCount": 1
}
[2025-12-12T09:32:28.476Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T09:32:28.476Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T09:32:28.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765531948374",
  "key": "test-sliding:test-sliding-1765531948374"
}
[2025-12-12T09:32:28.577Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765531948374",
  "timestampCount": 2
}
[2025-12-12T09:32:28.577Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-12T09:32:28.577Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T09:32:28.577Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T09:32:28.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765531948578",
  "key": "register:test-format-allowed-1765531948578"
}
[2025-12-12T09:32:28.578Z] Creating new entry
{
  "key": "register:test-format-allowed-1765531948578"
}
[2025-12-12T09:32:28.578Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T09:32:28.578Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T09:32:28.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765531948578",
  "key": "register:test-format-blocked-1765531948578"
}
[2025-12-12T09:32:28.578Z] Creating new entry
{
  "key": "register:test-format-blocked-1765531948578"
}
[2025-12-12T09:32:28.578Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T09:32:28.578Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T09:32:28.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765531948578",
  "key": "register:test-format-blocked-1765531948578"
}
[2025-12-12T09:32:28.578Z] Found existing entry
{
  "key": "register:test-format-blocked-1765531948578",
  "timestampCount": 1
}
[2025-12-12T09:32:28.578Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T09:32:28.578Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T09:32:28.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765531948578",
  "key": "register:test-format-blocked-1765531948578"
}
[2025-12-12T09:32:28.578Z] Found existing entry
{
  "key": "register:test-format-blocked-1765531948578",
  "timestampCount": 2
}
[2025-12-12T09:32:28.578Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-12T09:32:28.578Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-12T09:32:28.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765531948578",
  "key": "register:test-format-blocked-1765531948578"
}
[2025-12-12T09:32:28.578Z] Found existing entry
{
  "key": "register:test-format-blocked-1765531948578",
  "timestampCount": 3
}
[2025-12-12T09:32:28.578Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-12T11:22:11.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765538531608",
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.609Z] Creating new entry
{
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.609Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T11:22:11.609Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T11:22:11.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765538531608",
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.609Z] Found existing entry
{
  "key": "login:test-allow-1765538531608",
  "timestampCount": 1
}
[2025-12-12T11:22:11.609Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T11:22:11.609Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T11:22:11.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765538531608",
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.609Z] Found existing entry
{
  "key": "login:test-allow-1765538531608",
  "timestampCount": 2
}
[2025-12-12T11:22:11.610Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T11:22:11.610Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T11:22:11.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765538531608",
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.610Z] Found existing entry
{
  "key": "login:test-allow-1765538531608",
  "timestampCount": 3
}
[2025-12-12T11:22:11.610Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T11:22:11.610Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T11:22:11.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765538531608",
  "key": "login:test-allow-1765538531608"
}
[2025-12-12T11:22:11.610Z] Found existing entry
{
  "key": "login:test-allow-1765538531608",
  "timestampCount": 4
}
[2025-12-12T11:22:11.610Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T11:22:11.610Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T11:22:11.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.610Z] Creating new entry
{
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.610Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T11:22:11.610Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T11:22:11.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.610Z] Found existing entry
{
  "key": "login:test-block-1765538531610",
  "timestampCount": 1
}
[2025-12-12T11:22:11.610Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T11:22:11.611Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T11:22:11.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.611Z] Found existing entry
{
  "key": "login:test-block-1765538531610",
  "timestampCount": 2
}
[2025-12-12T11:22:11.611Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T11:22:11.611Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T11:22:11.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.611Z] Found existing entry
{
  "key": "login:test-block-1765538531610",
  "timestampCount": 3
}
[2025-12-12T11:22:11.611Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T11:22:11.611Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T11:22:11.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.611Z] Found existing entry
{
  "key": "login:test-block-1765538531610",
  "timestampCount": 4
}
[2025-12-12T11:22:11.611Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T11:22:11.611Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T11:22:11.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765538531610",
  "key": "login:test-block-1765538531610"
}
[2025-12-12T11:22:11.611Z] Found existing entry
{
  "key": "login:test-block-1765538531610",
  "timestampCount": 5
}
[2025-12-12T11:22:11.611Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T11:22:11.612Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765538531612",
  "key": "test-reset:test-reset-1765538531612"
}
[2025-12-12T11:22:11.612Z] Creating new entry
{
  "key": "test-reset:test-reset-1765538531612"
}
[2025-12-12T11:22:11.612Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T11:22:11.612Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T11:22:11.612Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765538531612",
  "key": "test-reset:test-reset-1765538531612"
}
[2025-12-12T11:22:11.612Z] Found existing entry
{
  "key": "test-reset:test-reset-1765538531612",
  "timestampCount": 1
}
[2025-12-12T11:22:11.612Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-12T11:22:11.612Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-12T11:22:11.612Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765538531612",
  "key": "test-reset:test-reset-1765538531612"
}
[2025-12-12T11:22:11.612Z] Found existing entry
{
  "key": "test-reset:test-reset-1765538531612",
  "timestampCount": 2
}
[2025-12-12T11:22:11.612Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-12T11:22:11.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765538531612",
  "key": "test-reset:test-reset-1765538531612"
}
[2025-12-12T11:22:11.764Z] Found existing entry
{
  "key": "test-reset:test-reset-1765538531612",
  "timestampCount": 2
}
[2025-12-12T11:22:11.764Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T11:22:11.764Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-12T11:22:11.764Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-12T11:22:11.765Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.768Z] Creating new entry
{
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.768Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T11:22:11.768Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T11:22:11.768Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.768Z] Found existing entry
{
  "key": "login:test-multi-1-1765538531765",
  "timestampCount": 1
}
[2025-12-12T11:22:11.768Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-12T11:22:11.768Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-12T11:22:11.768Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.768Z] Found existing entry
{
  "key": "login:test-multi-1-1765538531765",
  "timestampCount": 2
}
[2025-12-12T11:22:11.768Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-12T11:22:11.768Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-12T11:22:11.774Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.774Z] Found existing entry
{
  "key": "login:test-multi-1-1765538531765",
  "timestampCount": 3
}
[2025-12-12T11:22:11.774Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-12T11:22:11.774Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-12T11:22:11.774Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.774Z] Found existing entry
{
  "key": "login:test-multi-1-1765538531765",
  "timestampCount": 4
}
[2025-12-12T11:22:11.774Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-12T11:22:11.774Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-12T11:22:11.774Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765538531765",
  "key": "login:test-multi-1-1765538531765"
}
[2025-12-12T11:22:11.774Z] Found existing entry
{
  "key": "login:test-multi-1-1765538531765",
  "timestampCount": 5
}
[2025-12-12T11:22:11.774Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-12T11:22:11.774Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765538531765",
  "key": "login:test-multi-2-1765538531765"
}
[2025-12-12T11:22:11.774Z] Creating new entry
{
  "key": "login:test-multi-2-1765538531765"
}
[2025-12-12T11:22:11.774Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T11:22:11.774Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T11:22:11.775Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765538531775",
  "key": "login:test-reset-time-1765538531775"
}
[2025-12-12T11:22:11.775Z] Creating new entry
{
  "key": "login:test-reset-time-1765538531775"
}
[2025-12-12T11:22:11.775Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T11:22:11.775Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T11:22:11.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T11:22:11.776Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T11:22:11.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T11:22:11.776Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-12T11:22:11.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T11:22:11.776Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T11:22:11.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T11:22:11.776Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T11:22:11.777Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T11:22:11.777Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-12T11:22:11.777Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765538531777",
  "key": "test-sliding:test-sliding-1765538531777"
}
[2025-12-12T11:22:11.777Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765538531777"
}
[2025-12-12T11:22:11.777Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T11:22:11.777Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T11:22:11.878Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765538531777",
  "key": "test-sliding:test-sliding-1765538531777"
}
[2025-12-12T11:22:11.878Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765538531777",
  "timestampCount": 1
}
[2025-12-12T11:22:11.878Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T11:22:11.878Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T11:22:11.980Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765538531777",
  "key": "test-sliding:test-sliding-1765538531777"
}
[2025-12-12T11:22:11.980Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765538531777",
  "timestampCount": 2
}
[2025-12-12T11:22:11.980Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-12T11:22:11.980Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T11:22:11.980Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T11:22:11.980Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765538531980",
  "key": "register:test-format-allowed-1765538531980"
}
[2025-12-12T11:22:11.980Z] Creating new entry
{
  "key": "register:test-format-allowed-1765538531980"
}
[2025-12-12T11:22:11.980Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T11:22:11.980Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T11:22:11.981Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765538531981",
  "key": "register:test-format-blocked-1765538531981"
}
[2025-12-12T11:22:11.981Z] Creating new entry
{
  "key": "register:test-format-blocked-1765538531981"
}
[2025-12-12T11:22:11.981Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-12T11:22:11.981Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-12T11:22:11.981Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765538531981",
  "key": "register:test-format-blocked-1765538531981"
}
[2025-12-12T11:22:11.981Z] Found existing entry
{
  "key": "register:test-format-blocked-1765538531981",
  "timestampCount": 1
}
[2025-12-12T11:22:11.981Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-12T11:22:11.981Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-12T11:22:11.981Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765538531981",
  "key": "register:test-format-blocked-1765538531981"
}
[2025-12-12T11:22:11.981Z] Found existing entry
{
  "key": "register:test-format-blocked-1765538531981",
  "timestampCount": 2
}
[2025-12-12T11:22:11.981Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-12T11:22:11.981Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-12T11:22:11.981Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765538531981",
  "key": "register:test-format-blocked-1765538531981"
}
[2025-12-12T11:22:11.981Z] Found existing entry
{
  "key": "register:test-format-blocked-1765538531981",
  "timestampCount": 3
}
[2025-12-12T11:22:11.981Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-12T13:17:01.504Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:17:01.505Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:17:01.505Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:17:01.505Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:17:01.505Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T13:17:01.505Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T13:17:01.505Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T13:17:01.505Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T13:18:01.505Z"
  }
}
[2025-12-12T13:17:02.506Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:17:02.508Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:17:02.508Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:17:02.508Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:17:02.508Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T13:17:02.509Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T13:17:02.509Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T13:17:02.509Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T13:18:01.505Z"
  }
}
[2025-12-12T13:22:24.025Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:22:24.026Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:22:24.026Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:22:24.026Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:22:24.026Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T13:22:24.026Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T13:22:24.026Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T13:22:24.026Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T13:23:24.026Z"
  }
}
[2025-12-12T13:22:25.063Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:22:25.063Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:22:25.064Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:22:25.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:22:25.064Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T13:22:25.064Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T13:22:25.064Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T13:22:25.064Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T13:23:24.026Z"
  }
}
[2025-12-12T13:45:18.099Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:18.099Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:18.100Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:18.100Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:18.100Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T13:45:18.100Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T13:45:18.100Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T13:45:18.100Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:45:18.993Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:18.994Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:18.994Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:18.994Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:18.994Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T13:45:18.994Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T13:45:18.994Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T13:45:18.994Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:45:26.275Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:26.276Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:26.276Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:26.276Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:26.276Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T13:45:26.276Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-12T13:45:26.276Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-12T13:45:26.276Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:45:26.882Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:26.882Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:26.883Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:26.883Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:26.883Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-12T13:45:26.883Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-12T13:45:26.883Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-12T13:45:26.883Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:45:30.138Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:30.138Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:30.138Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:30.138Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:30.138Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-12T13:45:30.139Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-12T13:45:30.139Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-12T13:45:30.139Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:45:30.750Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:45:30.750Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:45:30.750Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:45:30.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:45:30.751Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-12T13:45:30.751Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-12T13:45:30.751Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-12T13:45:30.751Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-12T13:46:18.100Z"
  }
}
[2025-12-12T13:47:13.094Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-12T13:47:13.094Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:47:13.095Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:47:13.095Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T13:47:13.095Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-12T13:47:13.095Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T13:47:13.095Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T13:47:13.095Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-12T13:48:13.095Z"
  }
}
[2025-12-12T13:47:18.306Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:47:18.310Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:47:18.310Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:47:18.310Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:47:18.314Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-12T13:47:18.314Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-12T13:47:18.318Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T13:47:18.318Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T13:47:18.318Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T13:48:18.310Z"
  }
}
[2025-12-12T13:47:19.144Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T13:47:19.144Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T13:47:19.145Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T13:47:19.145Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T13:47:19.145Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T13:47:19.145Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T13:47:19.145Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T13:47:19.145Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T13:48:18.310Z"
  }
}
[2025-12-12T14:06:12.814Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-12T14:06:12.816Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T14:06:12.816Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T14:06:12.816Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-12T14:06:12.816Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-12T14:06:12.816Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-12T14:06:12.816Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-12T14:06:12.817Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-12T14:07:12.816Z"
  }
}
[2025-12-12T14:06:17.936Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T14:06:17.937Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T14:06:17.937Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T14:06:17.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T14:06:17.937Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T14:06:17.937Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T14:06:17.937Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T14:06:17.937Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T14:07:17.937Z"
  }
}
[2025-12-12T14:06:18.839Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T14:06:18.839Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T14:06:18.840Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T14:06:18.840Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T14:06:18.840Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T14:06:18.840Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T14:06:18.840Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T14:06:18.840Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T14:07:17.937Z"
  }
}
[2025-12-12T15:00:11.743Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:00:11.743Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:00:11.744Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:00:11.744Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:00:11.744Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T15:00:11.744Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T15:00:11.744Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T15:00:11.744Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T15:01:11.744Z"
  }
}
[2025-12-12T15:00:12.720Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:00:12.721Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:00:12.721Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:00:12.721Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:00:12.721Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T15:00:12.721Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T15:00:12.721Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T15:00:12.721Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T15:01:11.744Z"
  }
}
[2025-12-12T15:00:58.639Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:00:58.640Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:00:58.640Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:00:58.640Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:00:58.640Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T15:00:58.640Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-12T15:00:58.640Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-12T15:00:58.640Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-12T15:01:11.744Z"
  }
}
[2025-12-12T15:00:59.477Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:00:59.477Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:00:59.478Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:00:59.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:00:59.478Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-12T15:00:59.478Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-12T15:00:59.478Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-12T15:00:59.478Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-12T15:01:11.744Z"
  }
}
[2025-12-12T15:08:56.196Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:08:56.196Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:08:56.196Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:08:56.196Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:08:56.196Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-12T15:08:56.196Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-12T15:08:56.196Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T15:08:56.196Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T15:08:56.196Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T15:09:56.196Z"
  }
}
[2025-12-12T15:08:57.162Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:08:57.162Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:08:57.162Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:08:57.162Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:08:57.162Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T15:08:57.162Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T15:08:57.162Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T15:08:57.162Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T15:09:56.196Z"
  }
}
[2025-12-12T15:59:40.172Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:59:40.173Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:59:40.173Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:59:40.173Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:59:40.173Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T15:59:40.174Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T15:59:40.174Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T15:59:40.174Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T16:00:40.173Z"
  }
}
[2025-12-12T15:59:41.069Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T15:59:41.070Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T15:59:41.070Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T15:59:41.070Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T15:59:41.070Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T15:59:41.071Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T15:59:41.071Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T15:59:41.071Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T16:00:40.173Z"
  }
}
[2025-12-12T16:05:46.438Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T16:05:46.440Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T16:05:46.440Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T16:05:46.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T16:05:46.440Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T16:05:46.440Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T16:05:46.441Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T16:05:46.441Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T16:05:46.441Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T16:06:46.440Z"
  }
}
[2025-12-12T16:05:47.336Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T16:05:47.337Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T16:05:47.337Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T16:05:47.337Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T16:05:47.337Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T16:05:47.337Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T16:05:47.337Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T16:05:47.337Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T16:06:46.440Z"
  }
}
[2025-12-12T16:11:33.141Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T16:11:33.142Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T16:11:33.142Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T16:11:33.142Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T16:11:33.142Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-12T16:11:33.142Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-12T16:11:33.142Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T16:11:33.142Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T16:11:33.142Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T16:12:33.142Z"
  }
}
[2025-12-12T16:13:34.419Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T16:13:34.420Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T16:13:34.420Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T16:13:34.420Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T16:13:34.420Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T16:13:34.420Z] Filtered old timestamps
{
  "before": 1,
  "after": 0,
  "removed": 1
}
[2025-12-12T16:13:34.420Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T16:13:34.420Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T16:13:34.420Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T16:14:34.420Z"
  }
}
[2025-12-12T16:13:35.315Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T16:13:35.315Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T16:13:35.315Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T16:13:35.315Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T16:13:35.315Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T16:13:35.315Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T16:13:35.316Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T16:13:35.316Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T16:14:34.420Z"
  }
}
[2025-12-12T20:28:02.108Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T20:28:02.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T20:28:02.109Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T20:28:02.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T20:28:02.109Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-12T20:28:02.109Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-12T20:28:02.109Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-12T20:28:02.109Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-12T20:29:02.109Z"
  }
}
[2025-12-12T20:28:02.990Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-12T20:28:02.991Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-12T20:28:02.991Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-12T20:28:02.992Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-12T20:28:02.992Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-12T20:28:02.992Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-12T20:28:02.992Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-12T20:28:02.993Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-12T20:29:02.109Z"
  }
}
[2025-12-13T08:50:48.279Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615848279",
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.280Z] Creating new entry
{
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.280Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:50:48.281Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:50:48.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615848279",
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.281Z] Found existing entry
{
  "key": "login:test-allow-1765615848279",
  "timestampCount": 1
}
[2025-12-13T08:50:48.281Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:50:48.281Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:50:48.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615848279",
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.281Z] Found existing entry
{
  "key": "login:test-allow-1765615848279",
  "timestampCount": 2
}
[2025-12-13T08:50:48.281Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:50:48.281Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:50:48.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615848279",
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.281Z] Found existing entry
{
  "key": "login:test-allow-1765615848279",
  "timestampCount": 3
}
[2025-12-13T08:50:48.281Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:50:48.281Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:50:48.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615848279",
  "key": "login:test-allow-1765615848279"
}
[2025-12-13T08:50:48.281Z] Found existing entry
{
  "key": "login:test-allow-1765615848279",
  "timestampCount": 4
}
[2025-12-13T08:50:48.281Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:50:48.281Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Creating new entry
{
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:50:48.282Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Found existing entry
{
  "key": "login:test-block-1765615848282",
  "timestampCount": 1
}
[2025-12-13T08:50:48.282Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:50:48.282Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Found existing entry
{
  "key": "login:test-block-1765615848282",
  "timestampCount": 2
}
[2025-12-13T08:50:48.282Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:50:48.282Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Found existing entry
{
  "key": "login:test-block-1765615848282",
  "timestampCount": 3
}
[2025-12-13T08:50:48.282Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:50:48.282Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Found existing entry
{
  "key": "login:test-block-1765615848282",
  "timestampCount": 4
}
[2025-12-13T08:50:48.282Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:50:48.282Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:50:48.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615848282",
  "key": "login:test-block-1765615848282"
}
[2025-12-13T08:50:48.282Z] Found existing entry
{
  "key": "login:test-block-1765615848282",
  "timestampCount": 5
}
[2025-12-13T08:50:48.283Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:50:48.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615848283",
  "key": "test-reset:test-reset-1765615848283"
}
[2025-12-13T08:50:48.283Z] Creating new entry
{
  "key": "test-reset:test-reset-1765615848283"
}
[2025-12-13T08:50:48.283Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:50:48.283Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:50:48.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615848283",
  "key": "test-reset:test-reset-1765615848283"
}
[2025-12-13T08:50:48.283Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615848283",
  "timestampCount": 1
}
[2025-12-13T08:50:48.283Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-13T08:50:48.283Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-13T08:50:48.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615848283",
  "key": "test-reset:test-reset-1765615848283"
}
[2025-12-13T08:50:48.283Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615848283",
  "timestampCount": 2
}
[2025-12-13T08:50:48.284Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-13T08:50:48.434Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615848283",
  "key": "test-reset:test-reset-1765615848283"
}
[2025-12-13T08:50:48.435Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615848283",
  "timestampCount": 2
}
[2025-12-13T08:50:48.435Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T08:50:48.435Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:50:48.435Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:50:48.435Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.435Z] Creating new entry
{
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.435Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:50:48.435Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.436Z] Found existing entry
{
  "key": "login:test-multi-1-1765615848435",
  "timestampCount": 1
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.436Z] Found existing entry
{
  "key": "login:test-multi-1-1765615848435",
  "timestampCount": 2
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.436Z] Found existing entry
{
  "key": "login:test-multi-1-1765615848435",
  "timestampCount": 3
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.436Z] Found existing entry
{
  "key": "login:test-multi-1-1765615848435",
  "timestampCount": 4
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615848435",
  "key": "login:test-multi-1-1765615848435"
}
[2025-12-13T08:50:48.436Z] Found existing entry
{
  "key": "login:test-multi-1-1765615848435",
  "timestampCount": 5
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765615848435",
  "key": "login:test-multi-2-1765615848435"
}
[2025-12-13T08:50:48.436Z] Creating new entry
{
  "key": "login:test-multi-2-1765615848435"
}
[2025-12-13T08:50:48.436Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:50:48.436Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:50:48.437Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765615848437",
  "key": "login:test-reset-time-1765615848437"
}
[2025-12-13T08:50:48.437Z] Creating new entry
{
  "key": "login:test-reset-time-1765615848437"
}
[2025-12-13T08:50:48.437Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:50:48.437Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:50:48.438Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:50:48.438Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:50:48.438Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:50:48.438Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-13T08:50:48.438Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:50:48.438Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:50:48.439Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:50:48.439Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T08:50:48.439Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:50:48.439Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:50:48.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615848439",
  "key": "test-sliding:test-sliding-1765615848439"
}
[2025-12-13T08:50:48.440Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765615848439"
}
[2025-12-13T08:50:48.440Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:50:48.440Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:50:48.539Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615848439",
  "key": "test-sliding:test-sliding-1765615848439"
}
[2025-12-13T08:50:48.539Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765615848439",
  "timestampCount": 1
}
[2025-12-13T08:50:48.539Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:50:48.540Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:50:48.640Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615848439",
  "key": "test-sliding:test-sliding-1765615848439"
}
[2025-12-13T08:50:48.640Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765615848439",
  "timestampCount": 2
}
[2025-12-13T08:50:48.640Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-13T08:50:48.640Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:50:48.641Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:50:48.641Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765615848641",
  "key": "register:test-format-allowed-1765615848641"
}
[2025-12-13T08:50:48.641Z] Creating new entry
{
  "key": "register:test-format-allowed-1765615848641"
}
[2025-12-13T08:50:48.641Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:50:48.641Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:50:48.642Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615848642",
  "key": "register:test-format-blocked-1765615848642"
}
[2025-12-13T08:50:48.642Z] Creating new entry
{
  "key": "register:test-format-blocked-1765615848642"
}
[2025-12-13T08:50:48.642Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:50:48.642Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:50:48.642Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615848642",
  "key": "register:test-format-blocked-1765615848642"
}
[2025-12-13T08:50:48.642Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615848642",
  "timestampCount": 1
}
[2025-12-13T08:50:48.642Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:50:48.642Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:50:48.642Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615848642",
  "key": "register:test-format-blocked-1765615848642"
}
[2025-12-13T08:50:48.642Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615848642",
  "timestampCount": 2
}
[2025-12-13T08:50:48.642Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-13T08:50:48.642Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-13T08:50:48.642Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615848642",
  "key": "register:test-format-blocked-1765615848642"
}
[2025-12-13T08:50:48.642Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615848642",
  "timestampCount": 3
}
[2025-12-13T08:50:48.642Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-13T08:53:19.574Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615999574",
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.575Z] Creating new entry
{
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.575Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:53:19.575Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:53:19.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615999574",
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.576Z] Found existing entry
{
  "key": "login:test-allow-1765615999574",
  "timestampCount": 1
}
[2025-12-13T08:53:19.576Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:53:19.576Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:53:19.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615999574",
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.576Z] Found existing entry
{
  "key": "login:test-allow-1765615999574",
  "timestampCount": 2
}
[2025-12-13T08:53:19.576Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:53:19.576Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:53:19.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615999574",
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.576Z] Found existing entry
{
  "key": "login:test-allow-1765615999574",
  "timestampCount": 3
}
[2025-12-13T08:53:19.576Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:53:19.576Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:53:19.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765615999574",
  "key": "login:test-allow-1765615999574"
}
[2025-12-13T08:53:19.576Z] Found existing entry
{
  "key": "login:test-allow-1765615999574",
  "timestampCount": 4
}
[2025-12-13T08:53:19.576Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:53:19.576Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Creating new entry
{
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:53:19.577Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Found existing entry
{
  "key": "login:test-block-1765615999577",
  "timestampCount": 1
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:53:19.577Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Found existing entry
{
  "key": "login:test-block-1765615999577",
  "timestampCount": 2
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:53:19.577Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Found existing entry
{
  "key": "login:test-block-1765615999577",
  "timestampCount": 3
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:53:19.577Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Found existing entry
{
  "key": "login:test-block-1765615999577",
  "timestampCount": 4
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:53:19.577Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:53:19.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765615999577",
  "key": "login:test-block-1765615999577"
}
[2025-12-13T08:53:19.577Z] Found existing entry
{
  "key": "login:test-block-1765615999577",
  "timestampCount": 5
}
[2025-12-13T08:53:19.577Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:53:19.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615999578",
  "key": "test-reset:test-reset-1765615999578"
}
[2025-12-13T08:53:19.578Z] Creating new entry
{
  "key": "test-reset:test-reset-1765615999578"
}
[2025-12-13T08:53:19.578Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:53:19.578Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:53:19.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615999578",
  "key": "test-reset:test-reset-1765615999578"
}
[2025-12-13T08:53:19.578Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615999578",
  "timestampCount": 1
}
[2025-12-13T08:53:19.578Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-13T08:53:19.578Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-13T08:53:19.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615999578",
  "key": "test-reset:test-reset-1765615999578"
}
[2025-12-13T08:53:19.578Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615999578",
  "timestampCount": 2
}
[2025-12-13T08:53:19.578Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-13T08:53:19.729Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765615999578",
  "key": "test-reset:test-reset-1765615999578"
}
[2025-12-13T08:53:19.729Z] Found existing entry
{
  "key": "test-reset:test-reset-1765615999578",
  "timestampCount": 2
}
[2025-12-13T08:53:19.729Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T08:53:19.729Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:53:19.729Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:53:19.729Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.729Z] Creating new entry
{
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.729Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:53:19.729Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:53:19.729Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.729Z] Found existing entry
{
  "key": "login:test-multi-1-1765615999729",
  "timestampCount": 1
}
[2025-12-13T08:53:19.729Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:53:19.729Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:53:19.729Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.729Z] Found existing entry
{
  "key": "login:test-multi-1-1765615999729",
  "timestampCount": 2
}
[2025-12-13T08:53:19.729Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:53:19.730Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:53:19.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.730Z] Found existing entry
{
  "key": "login:test-multi-1-1765615999729",
  "timestampCount": 3
}
[2025-12-13T08:53:19.730Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:53:19.730Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:53:19.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.730Z] Found existing entry
{
  "key": "login:test-multi-1-1765615999729",
  "timestampCount": 4
}
[2025-12-13T08:53:19.730Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:53:19.730Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:53:19.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765615999729",
  "key": "login:test-multi-1-1765615999729"
}
[2025-12-13T08:53:19.730Z] Found existing entry
{
  "key": "login:test-multi-1-1765615999729",
  "timestampCount": 5
}
[2025-12-13T08:53:19.730Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:53:19.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765615999729",
  "key": "login:test-multi-2-1765615999729"
}
[2025-12-13T08:53:19.730Z] Creating new entry
{
  "key": "login:test-multi-2-1765615999729"
}
[2025-12-13T08:53:19.730Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:53:19.730Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:53:19.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765615999731",
  "key": "login:test-reset-time-1765615999731"
}
[2025-12-13T08:53:19.731Z] Creating new entry
{
  "key": "login:test-reset-time-1765615999731"
}
[2025-12-13T08:53:19.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:53:19.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:53:19.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:53:19.732Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:53:19.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:53:19.732Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-13T08:53:19.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:53:19.732Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:53:19.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:53:19.732Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T08:53:19.733Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:53:19.733Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:53:19.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615999733",
  "key": "test-sliding:test-sliding-1765615999733"
}
[2025-12-13T08:53:19.733Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765615999733"
}
[2025-12-13T08:53:19.733Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:53:19.733Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:53:19.833Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615999733",
  "key": "test-sliding:test-sliding-1765615999733"
}
[2025-12-13T08:53:19.833Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765615999733",
  "timestampCount": 1
}
[2025-12-13T08:53:19.833Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:53:19.833Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:53:19.934Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765615999733",
  "key": "test-sliding:test-sliding-1765615999733"
}
[2025-12-13T08:53:19.935Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765615999733",
  "timestampCount": 2
}
[2025-12-13T08:53:19.935Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-13T08:53:19.935Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:53:19.935Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:53:19.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765615999935",
  "key": "register:test-format-allowed-1765615999935"
}
[2025-12-13T08:53:19.935Z] Creating new entry
{
  "key": "register:test-format-allowed-1765615999935"
}
[2025-12-13T08:53:19.935Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:53:19.936Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:53:19.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615999936",
  "key": "register:test-format-blocked-1765615999936"
}
[2025-12-13T08:53:19.936Z] Creating new entry
{
  "key": "register:test-format-blocked-1765615999936"
}
[2025-12-13T08:53:19.936Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:53:19.936Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:53:19.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615999936",
  "key": "register:test-format-blocked-1765615999936"
}
[2025-12-13T08:53:19.937Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615999936",
  "timestampCount": 1
}
[2025-12-13T08:53:19.937Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:53:19.937Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:53:19.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615999936",
  "key": "register:test-format-blocked-1765615999936"
}
[2025-12-13T08:53:19.937Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615999936",
  "timestampCount": 2
}
[2025-12-13T08:53:19.937Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-13T08:53:19.937Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-13T08:53:19.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765615999936",
  "key": "register:test-format-blocked-1765615999936"
}
[2025-12-13T08:53:19.937Z] Found existing entry
{
  "key": "register:test-format-blocked-1765615999936",
  "timestampCount": 3
}
[2025-12-13T08:53:19.937Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-13T08:54:16.437Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616056437",
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.438Z] Creating new entry
{
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.438Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:54:16.438Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:54:16.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616056437",
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.439Z] Found existing entry
{
  "key": "login:test-allow-1765616056437",
  "timestampCount": 1
}
[2025-12-13T08:54:16.439Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:54:16.439Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:54:16.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616056437",
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.439Z] Found existing entry
{
  "key": "login:test-allow-1765616056437",
  "timestampCount": 2
}
[2025-12-13T08:54:16.439Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:54:16.439Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:54:16.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616056437",
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.439Z] Found existing entry
{
  "key": "login:test-allow-1765616056437",
  "timestampCount": 3
}
[2025-12-13T08:54:16.439Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:54:16.439Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:54:16.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616056437",
  "key": "login:test-allow-1765616056437"
}
[2025-12-13T08:54:16.440Z] Found existing entry
{
  "key": "login:test-allow-1765616056437",
  "timestampCount": 4
}
[2025-12-13T08:54:16.440Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:54:16.440Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:54:16.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.440Z] Creating new entry
{
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.440Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:54:16.440Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:54:16.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.441Z] Found existing entry
{
  "key": "login:test-block-1765616056440",
  "timestampCount": 1
}
[2025-12-13T08:54:16.441Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:54:16.441Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:54:16.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.441Z] Found existing entry
{
  "key": "login:test-block-1765616056440",
  "timestampCount": 2
}
[2025-12-13T08:54:16.441Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:54:16.441Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:54:16.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.441Z] Found existing entry
{
  "key": "login:test-block-1765616056440",
  "timestampCount": 3
}
[2025-12-13T08:54:16.441Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:54:16.441Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:54:16.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.441Z] Found existing entry
{
  "key": "login:test-block-1765616056440",
  "timestampCount": 4
}
[2025-12-13T08:54:16.441Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:54:16.441Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:54:16.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616056440",
  "key": "login:test-block-1765616056440"
}
[2025-12-13T08:54:16.441Z] Found existing entry
{
  "key": "login:test-block-1765616056440",
  "timestampCount": 5
}
[2025-12-13T08:54:16.441Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:54:16.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616056442",
  "key": "test-reset:test-reset-1765616056442"
}
[2025-12-13T08:54:16.442Z] Creating new entry
{
  "key": "test-reset:test-reset-1765616056442"
}
[2025-12-13T08:54:16.442Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:54:16.442Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:54:16.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616056442",
  "key": "test-reset:test-reset-1765616056442"
}
[2025-12-13T08:54:16.442Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616056442",
  "timestampCount": 1
}
[2025-12-13T08:54:16.442Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-13T08:54:16.442Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-13T08:54:16.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616056442",
  "key": "test-reset:test-reset-1765616056442"
}
[2025-12-13T08:54:16.442Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616056442",
  "timestampCount": 2
}
[2025-12-13T08:54:16.443Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-13T08:54:16.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616056442",
  "key": "test-reset:test-reset-1765616056442"
}
[2025-12-13T08:54:16.594Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616056442",
  "timestampCount": 2
}
[2025-12-13T08:54:16.594Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T08:54:16.594Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T08:54:16.594Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T08:54:16.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Creating new entry
{
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Found existing entry
{
  "key": "login:test-multi-1-1765616056594",
  "timestampCount": 1
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Found existing entry
{
  "key": "login:test-multi-1-1765616056594",
  "timestampCount": 2
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Found existing entry
{
  "key": "login:test-multi-1-1765616056594",
  "timestampCount": 3
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Found existing entry
{
  "key": "login:test-multi-1-1765616056594",
  "timestampCount": 4
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616056594",
  "key": "login:test-multi-1-1765616056594"
}
[2025-12-13T08:54:16.595Z] Found existing entry
{
  "key": "login:test-multi-1-1765616056594",
  "timestampCount": 5
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765616056594",
  "key": "login:test-multi-2-1765616056594"
}
[2025-12-13T08:54:16.595Z] Creating new entry
{
  "key": "login:test-multi-2-1765616056594"
}
[2025-12-13T08:54:16.595Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:54:16.595Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:54:16.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765616056596",
  "key": "login:test-reset-time-1765616056596"
}
[2025-12-13T08:54:16.596Z] Creating new entry
{
  "key": "login:test-reset-time-1765616056596"
}
[2025-12-13T08:54:16.596Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T08:54:16.596Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T08:54:16.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:54:16.597Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:54:16.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:54:16.597Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-13T08:54:16.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:54:16.597Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:54:16.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:54:16.597Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T08:54:16.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T08:54:16.597Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T08:54:16.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616056598",
  "key": "test-sliding:test-sliding-1765616056598"
}
[2025-12-13T08:54:16.598Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765616056598"
}
[2025-12-13T08:54:16.598Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:54:16.598Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:54:16.699Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616056598",
  "key": "test-sliding:test-sliding-1765616056598"
}
[2025-12-13T08:54:16.699Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765616056598",
  "timestampCount": 1
}
[2025-12-13T08:54:16.699Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:54:16.699Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:54:16.800Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616056598",
  "key": "test-sliding:test-sliding-1765616056598"
}
[2025-12-13T08:54:16.800Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765616056598",
  "timestampCount": 2
}
[2025-12-13T08:54:16.800Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-13T08:54:16.800Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:54:16.800Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:54:16.800Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765616056800",
  "key": "register:test-format-allowed-1765616056800"
}
[2025-12-13T08:54:16.800Z] Creating new entry
{
  "key": "register:test-format-allowed-1765616056800"
}
[2025-12-13T08:54:16.800Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:54:16.801Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:54:16.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616056801",
  "key": "register:test-format-blocked-1765616056801"
}
[2025-12-13T08:54:16.801Z] Creating new entry
{
  "key": "register:test-format-blocked-1765616056801"
}
[2025-12-13T08:54:16.801Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T08:54:16.801Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T08:54:16.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616056801",
  "key": "register:test-format-blocked-1765616056801"
}
[2025-12-13T08:54:16.801Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616056801",
  "timestampCount": 1
}
[2025-12-13T08:54:16.801Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T08:54:16.801Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T08:54:16.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616056801",
  "key": "register:test-format-blocked-1765616056801"
}
[2025-12-13T08:54:16.801Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616056801",
  "timestampCount": 2
}
[2025-12-13T08:54:16.801Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-13T08:54:16.801Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-13T08:54:16.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616056801",
  "key": "register:test-format-blocked-1765616056801"
}
[2025-12-13T08:54:16.801Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616056801",
  "timestampCount": 3
}
[2025-12-13T08:54:16.801Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-13T09:03:20.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616600597",
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.598Z] Creating new entry
{
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.598Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T09:03:20.598Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T09:03:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616600597",
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.598Z] Found existing entry
{
  "key": "login:test-allow-1765616600597",
  "timestampCount": 1
}
[2025-12-13T09:03:20.598Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T09:03:20.598Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T09:03:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616600597",
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.598Z] Found existing entry
{
  "key": "login:test-allow-1765616600597",
  "timestampCount": 2
}
[2025-12-13T09:03:20.598Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T09:03:20.598Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T09:03:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616600597",
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.598Z] Found existing entry
{
  "key": "login:test-allow-1765616600597",
  "timestampCount": 3
}
[2025-12-13T09:03:20.598Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T09:03:20.598Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T09:03:20.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765616600597",
  "key": "login:test-allow-1765616600597"
}
[2025-12-13T09:03:20.599Z] Found existing entry
{
  "key": "login:test-allow-1765616600597",
  "timestampCount": 4
}
[2025-12-13T09:03:20.599Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T09:03:20.599Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T09:03:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.599Z] Creating new entry
{
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.599Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T09:03:20.599Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T09:03:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.599Z] Found existing entry
{
  "key": "login:test-block-1765616600599",
  "timestampCount": 1
}
[2025-12-13T09:03:20.599Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T09:03:20.599Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T09:03:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.599Z] Found existing entry
{
  "key": "login:test-block-1765616600599",
  "timestampCount": 2
}
[2025-12-13T09:03:20.599Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T09:03:20.599Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T09:03:20.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.599Z] Found existing entry
{
  "key": "login:test-block-1765616600599",
  "timestampCount": 3
}
[2025-12-13T09:03:20.599Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T09:03:20.599Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T09:03:20.600Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.600Z] Found existing entry
{
  "key": "login:test-block-1765616600599",
  "timestampCount": 4
}
[2025-12-13T09:03:20.600Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T09:03:20.600Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T09:03:20.600Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765616600599",
  "key": "login:test-block-1765616600599"
}
[2025-12-13T09:03:20.600Z] Found existing entry
{
  "key": "login:test-block-1765616600599",
  "timestampCount": 5
}
[2025-12-13T09:03:20.600Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T09:03:20.600Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616600600",
  "key": "test-reset:test-reset-1765616600600"
}
[2025-12-13T09:03:20.600Z] Creating new entry
{
  "key": "test-reset:test-reset-1765616600600"
}
[2025-12-13T09:03:20.600Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T09:03:20.600Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T09:03:20.600Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616600600",
  "key": "test-reset:test-reset-1765616600600"
}
[2025-12-13T09:03:20.600Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616600600",
  "timestampCount": 1
}
[2025-12-13T09:03:20.601Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-13T09:03:20.601Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-13T09:03:20.601Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616600600",
  "key": "test-reset:test-reset-1765616600600"
}
[2025-12-13T09:03:20.601Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616600600",
  "timestampCount": 2
}
[2025-12-13T09:03:20.601Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765616600600",
  "key": "test-reset:test-reset-1765616600600"
}
[2025-12-13T09:03:20.752Z] Found existing entry
{
  "key": "test-reset:test-reset-1765616600600",
  "timestampCount": 2
}
[2025-12-13T09:03:20.752Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T09:03:20.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T09:03:20.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.752Z] Creating new entry
{
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T09:03:20.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.752Z] Found existing entry
{
  "key": "login:test-multi-1-1765616600752",
  "timestampCount": 1
}
[2025-12-13T09:03:20.752Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T09:03:20.752Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.752Z] Found existing entry
{
  "key": "login:test-multi-1-1765616600752",
  "timestampCount": 2
}
[2025-12-13T09:03:20.752Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T09:03:20.752Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.752Z] Found existing entry
{
  "key": "login:test-multi-1-1765616600752",
  "timestampCount": 3
}
[2025-12-13T09:03:20.752Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T09:03:20.752Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T09:03:20.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.753Z] Found existing entry
{
  "key": "login:test-multi-1-1765616600752",
  "timestampCount": 4
}
[2025-12-13T09:03:20.753Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T09:03:20.753Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T09:03:20.753Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765616600752",
  "key": "login:test-multi-1-1765616600752"
}
[2025-12-13T09:03:20.753Z] Found existing entry
{
  "key": "login:test-multi-1-1765616600752",
  "timestampCount": 5
}
[2025-12-13T09:03:20.753Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T09:03:20.753Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765616600752",
  "key": "login:test-multi-2-1765616600752"
}
[2025-12-13T09:03:20.753Z] Creating new entry
{
  "key": "login:test-multi-2-1765616600752"
}
[2025-12-13T09:03:20.753Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T09:03:20.753Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T09:03:20.753Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765616600753",
  "key": "login:test-reset-time-1765616600753"
}
[2025-12-13T09:03:20.753Z] Creating new entry
{
  "key": "login:test-reset-time-1765616600753"
}
[2025-12-13T09:03:20.753Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T09:03:20.753Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T09:03:20.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:03:20.754Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T09:03:20.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:03:20.755Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-13T09:03:20.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:03:20.755Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T09:03:20.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:03:20.755Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T09:03:20.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:03:20.755Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T09:03:20.756Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616600756",
  "key": "test-sliding:test-sliding-1765616600756"
}
[2025-12-13T09:03:20.756Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765616600756"
}
[2025-12-13T09:03:20.756Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T09:03:20.756Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T09:03:20.857Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616600756",
  "key": "test-sliding:test-sliding-1765616600756"
}
[2025-12-13T09:03:20.857Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765616600756",
  "timestampCount": 1
}
[2025-12-13T09:03:20.857Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T09:03:20.857Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T09:03:20.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765616600756",
  "key": "test-sliding:test-sliding-1765616600756"
}
[2025-12-13T09:03:20.958Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765616600756",
  "timestampCount": 2
}
[2025-12-13T09:03:20.958Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-13T09:03:20.958Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T09:03:20.958Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T09:03:20.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765616600959",
  "key": "register:test-format-allowed-1765616600959"
}
[2025-12-13T09:03:20.959Z] Creating new entry
{
  "key": "register:test-format-allowed-1765616600959"
}
[2025-12-13T09:03:20.959Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T09:03:20.959Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T09:03:20.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616600959",
  "key": "register:test-format-blocked-1765616600959"
}
[2025-12-13T09:03:20.959Z] Creating new entry
{
  "key": "register:test-format-blocked-1765616600959"
}
[2025-12-13T09:03:20.959Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T09:03:20.959Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T09:03:20.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616600959",
  "key": "register:test-format-blocked-1765616600959"
}
[2025-12-13T09:03:20.959Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616600959",
  "timestampCount": 1
}
[2025-12-13T09:03:20.959Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-13T09:03:20.959Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-13T09:03:20.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616600959",
  "key": "register:test-format-blocked-1765616600959"
}
[2025-12-13T09:03:20.959Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616600959",
  "timestampCount": 2
}
[2025-12-13T09:03:20.959Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-13T09:03:20.959Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-13T09:03:20.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765616600959",
  "key": "register:test-format-blocked-1765616600959"
}
[2025-12-13T09:03:20.959Z] Found existing entry
{
  "key": "register:test-format-blocked-1765616600959",
  "timestampCount": 3
}
[2025-12-13T09:03:20.959Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-13T09:11:18.494Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T09:11:18.495Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:11:18.495Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T09:11:18.495Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T09:11:18.495Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-13T09:11:18.495Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-13T09:11:18.496Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-13T09:11:18.496Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-13T09:12:18.495Z"
  }
}
[2025-12-13T09:11:19.398Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T09:11:19.398Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:11:19.398Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T09:11:19.398Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T09:11:19.398Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-13T09:11:19.398Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-13T09:11:19.398Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-13T09:11:19.398Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-13T09:12:18.495Z"
  }
}
[2025-12-13T09:15:56.869Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T09:15:56.869Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:15:56.869Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T09:15:56.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T09:15:56.869Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-13T09:15:56.869Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T09:15:56.870Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-13T09:15:56.870Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-13T09:15:56.870Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-13T09:16:56.869Z"
  }
}
[2025-12-13T09:15:57.763Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T09:15:57.764Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T09:15:57.764Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T09:15:57.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T09:15:57.764Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-13T09:15:57.764Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-13T09:15:57.764Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-13T09:15:57.764Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-13T09:16:56.869Z"
  }
}
[2025-12-13T13:39:15.831Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T13:39:15.831Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T13:39:15.831Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T13:39:15.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T13:39:15.831Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-13T13:39:15.832Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-13T13:39:15.832Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-13T13:39:15.832Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-13T13:40:15.831Z"
  }
}
[2025-12-13T13:39:16.742Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T13:39:16.742Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T13:39:16.743Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T13:39:16.743Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T13:39:16.743Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-13T13:39:16.743Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-13T13:39:16.743Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-13T13:39:16.743Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-13T13:40:15.831Z"
  }
}
[2025-12-13T13:39:57.614Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T13:39:57.615Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T13:39:57.615Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T13:39:57.615Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T13:39:57.615Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-13T13:39:57.615Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-13T13:39:57.615Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-13T13:39:57.615Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-13T13:40:15.831Z"
  }
}
[2025-12-13T13:39:58.444Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T13:39:58.444Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T13:39:58.445Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T13:39:58.445Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T13:39:58.445Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-13T13:39:58.445Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-13T13:39:58.445Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-13T13:39:58.445Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-13T13:40:15.831Z"
  }
}
[2025-12-13T14:29:00.561Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765636140561",
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Creating new entry
{
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T14:29:00.562Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T14:29:00.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765636140561",
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Found existing entry
{
  "key": "login:test-allow-1765636140561",
  "timestampCount": 1
}
[2025-12-13T14:29:00.562Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T14:29:00.562Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T14:29:00.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765636140561",
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Found existing entry
{
  "key": "login:test-allow-1765636140561",
  "timestampCount": 2
}
[2025-12-13T14:29:00.562Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T14:29:00.562Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T14:29:00.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765636140561",
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Found existing entry
{
  "key": "login:test-allow-1765636140561",
  "timestampCount": 3
}
[2025-12-13T14:29:00.562Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T14:29:00.562Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T14:29:00.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765636140561",
  "key": "login:test-allow-1765636140561"
}
[2025-12-13T14:29:00.562Z] Found existing entry
{
  "key": "login:test-allow-1765636140561",
  "timestampCount": 4
}
[2025-12-13T14:29:00.562Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T14:29:00.562Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Creating new entry
{
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T14:29:00.563Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Found existing entry
{
  "key": "login:test-block-1765636140563",
  "timestampCount": 1
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T14:29:00.563Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Found existing entry
{
  "key": "login:test-block-1765636140563",
  "timestampCount": 2
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T14:29:00.563Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Found existing entry
{
  "key": "login:test-block-1765636140563",
  "timestampCount": 3
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T14:29:00.563Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Found existing entry
{
  "key": "login:test-block-1765636140563",
  "timestampCount": 4
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T14:29:00.563Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T14:29:00.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765636140563",
  "key": "login:test-block-1765636140563"
}
[2025-12-13T14:29:00.563Z] Found existing entry
{
  "key": "login:test-block-1765636140563",
  "timestampCount": 5
}
[2025-12-13T14:29:00.563Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T14:29:00.564Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765636140564",
  "key": "test-reset:test-reset-1765636140564"
}
[2025-12-13T14:29:00.564Z] Creating new entry
{
  "key": "test-reset:test-reset-1765636140564"
}
[2025-12-13T14:29:00.564Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T14:29:00.564Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T14:29:00.564Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765636140564",
  "key": "test-reset:test-reset-1765636140564"
}
[2025-12-13T14:29:00.564Z] Found existing entry
{
  "key": "test-reset:test-reset-1765636140564",
  "timestampCount": 1
}
[2025-12-13T14:29:00.564Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-13T14:29:00.564Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-13T14:29:00.564Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765636140564",
  "key": "test-reset:test-reset-1765636140564"
}
[2025-12-13T14:29:00.564Z] Found existing entry
{
  "key": "test-reset:test-reset-1765636140564",
  "timestampCount": 2
}
[2025-12-13T14:29:00.564Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-13T14:29:00.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765636140564",
  "key": "test-reset:test-reset-1765636140564"
}
[2025-12-13T14:29:00.715Z] Found existing entry
{
  "key": "test-reset:test-reset-1765636140564",
  "timestampCount": 2
}
[2025-12-13T14:29:00.715Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-13T14:29:00.715Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-13T14:29:00.715Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Creating new entry
{
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Found existing entry
{
  "key": "login:test-multi-1-1765636140716",
  "timestampCount": 1
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Found existing entry
{
  "key": "login:test-multi-1-1765636140716",
  "timestampCount": 2
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Found existing entry
{
  "key": "login:test-multi-1-1765636140716",
  "timestampCount": 3
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Found existing entry
{
  "key": "login:test-multi-1-1765636140716",
  "timestampCount": 4
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765636140716",
  "key": "login:test-multi-1-1765636140716"
}
[2025-12-13T14:29:00.716Z] Found existing entry
{
  "key": "login:test-multi-1-1765636140716",
  "timestampCount": 5
}
[2025-12-13T14:29:00.716Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-13T14:29:00.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765636140716",
  "key": "login:test-multi-2-1765636140716"
}
[2025-12-13T14:29:00.716Z] Creating new entry
{
  "key": "login:test-multi-2-1765636140716"
}
[2025-12-13T14:29:00.717Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T14:29:00.717Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T14:29:00.717Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765636140717",
  "key": "login:test-reset-time-1765636140717"
}
[2025-12-13T14:29:00.717Z] Creating new entry
{
  "key": "login:test-reset-time-1765636140717"
}
[2025-12-13T14:29:00.717Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-13T14:29:00.717Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-13T14:29:00.718Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:00.718Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T14:29:00.718Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:00.718Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-13T14:29:00.718Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:00.718Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T14:29:00.719Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:00.719Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:29:00.719Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:00.719Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-13T14:29:00.719Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765636140719",
  "key": "test-sliding:test-sliding-1765636140719"
}
[2025-12-13T14:29:00.719Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765636140719"
}
[2025-12-13T14:29:00.719Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-13T14:29:00.719Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-13T14:29:06.510Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:29:06.510Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:06.511Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:29:06.511Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:29:06.511Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-13T14:29:06.511Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-13T14:29:06.511Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-13T14:29:06.511Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-13T14:30:06.511Z"
  }
}
[2025-12-13T14:29:07.612Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:29:07.612Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:07.612Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:29:07.612Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:29:07.612Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-13T14:29:07.612Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-13T14:29:07.612Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-13T14:29:07.612Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-13T14:30:06.511Z"
  }
}
[2025-12-13T14:29:13.200Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:29:13.201Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:13.201Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:29:13.202Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:29:13.202Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-13T14:29:13.202Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-13T14:29:13.202Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-13T14:29:13.202Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-13T14:30:06.511Z"
  }
}
[2025-12-13T14:29:14.053Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:29:14.053Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:29:14.053Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:29:14.053Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:29:14.053Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-13T14:29:14.053Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-13T14:29:14.053Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-13T14:29:14.053Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-13T14:30:06.511Z"
  }
}
[2025-12-13T14:30:07.553Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:30:07.555Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:30:07.555Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:30:07.555Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:30:07.556Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-13T14:30:07.557Z] Filtered old timestamps
{
  "before": 4,
  "after": 3,
  "removed": 1
}
[2025-12-13T14:30:07.557Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-13T14:30:07.557Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-13T14:30:07.557Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-13T14:30:07.612Z"
  }
}
[2025-12-13T14:30:08.371Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:30:08.371Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:30:08.371Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:30:08.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:30:08.371Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-13T14:30:08.371Z] Filtered old timestamps
{
  "before": 4,
  "after": 3,
  "removed": 1
}
[2025-12-13T14:30:08.371Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-13T14:30:08.371Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-13T14:30:08.372Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-13T14:30:13.202Z"
  }
}
[2025-12-13T14:31:15.970Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:31:16.226Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:31:16.228Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:31:16.587Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:31:16.587Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-13T14:31:16.587Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-13T14:31:16.587Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-13T14:31:16.587Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-13T14:31:16.587Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-13T14:32:16.587Z"
  }
}
[2025-12-13T14:31:17.353Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-13T14:31:17.614Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-13T14:31:17.618Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-13T14:31:17.618Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-13T14:31:17.618Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-13T14:31:17.619Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-13T14:31:17.619Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-13T14:31:17.619Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-13T14:32:16.587Z"
  }
}
[2025-12-14T08:25:05.244Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700705243",
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.245Z] Creating new entry
{
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.245Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:25:05.245Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:25:05.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700705243",
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.246Z] Found existing entry
{
  "key": "login:test-allow-1765700705243",
  "timestampCount": 1
}
[2025-12-14T08:25:05.246Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T08:25:05.246Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T08:25:05.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700705243",
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.246Z] Found existing entry
{
  "key": "login:test-allow-1765700705243",
  "timestampCount": 2
}
[2025-12-14T08:25:05.246Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T08:25:05.246Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T08:25:05.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700705243",
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.246Z] Found existing entry
{
  "key": "login:test-allow-1765700705243",
  "timestampCount": 3
}
[2025-12-14T08:25:05.246Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T08:25:05.246Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T08:25:05.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700705243",
  "key": "login:test-allow-1765700705243"
}
[2025-12-14T08:25:05.246Z] Found existing entry
{
  "key": "login:test-allow-1765700705243",
  "timestampCount": 4
}
[2025-12-14T08:25:05.246Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T08:25:05.246Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T08:25:05.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.247Z] Creating new entry
{
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.247Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:25:05.247Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:25:05.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.247Z] Found existing entry
{
  "key": "login:test-block-1765700705247",
  "timestampCount": 1
}
[2025-12-14T08:25:05.247Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T08:25:05.247Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T08:25:05.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.247Z] Found existing entry
{
  "key": "login:test-block-1765700705247",
  "timestampCount": 2
}
[2025-12-14T08:25:05.247Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T08:25:05.247Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T08:25:05.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.247Z] Found existing entry
{
  "key": "login:test-block-1765700705247",
  "timestampCount": 3
}
[2025-12-14T08:25:05.247Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T08:25:05.247Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T08:25:05.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.248Z] Found existing entry
{
  "key": "login:test-block-1765700705247",
  "timestampCount": 4
}
[2025-12-14T08:25:05.248Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T08:25:05.248Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T08:25:05.248Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700705247",
  "key": "login:test-block-1765700705247"
}
[2025-12-14T08:25:05.248Z] Found existing entry
{
  "key": "login:test-block-1765700705247",
  "timestampCount": 5
}
[2025-12-14T08:25:05.248Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-14T08:25:05.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700705249",
  "key": "test-reset:test-reset-1765700705249"
}
[2025-12-14T08:25:05.249Z] Creating new entry
{
  "key": "test-reset:test-reset-1765700705249"
}
[2025-12-14T08:25:05.249Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-14T08:25:05.249Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-14T08:25:05.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700705249",
  "key": "test-reset:test-reset-1765700705249"
}
[2025-12-14T08:25:05.249Z] Found existing entry
{
  "key": "test-reset:test-reset-1765700705249",
  "timestampCount": 1
}
[2025-12-14T08:25:05.249Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-14T08:25:05.249Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-14T08:25:05.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700705249",
  "key": "test-reset:test-reset-1765700705249"
}
[2025-12-14T08:25:05.249Z] Found existing entry
{
  "key": "test-reset:test-reset-1765700705249",
  "timestampCount": 2
}
[2025-12-14T08:25:05.249Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-14T08:28:35.548Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700915548",
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.549Z] Creating new entry
{
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.549Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:28:35.549Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:28:35.550Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700915548",
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.550Z] Found existing entry
{
  "key": "login:test-allow-1765700915548",
  "timestampCount": 1
}
[2025-12-14T08:28:35.550Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T08:28:35.550Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T08:28:35.550Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700915548",
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.550Z] Found existing entry
{
  "key": "login:test-allow-1765700915548",
  "timestampCount": 2
}
[2025-12-14T08:28:35.550Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T08:28:35.550Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T08:28:35.550Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700915548",
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.550Z] Found existing entry
{
  "key": "login:test-allow-1765700915548",
  "timestampCount": 3
}
[2025-12-14T08:28:35.550Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T08:28:35.550Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T08:28:35.550Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765700915548",
  "key": "login:test-allow-1765700915548"
}
[2025-12-14T08:28:35.550Z] Found existing entry
{
  "key": "login:test-allow-1765700915548",
  "timestampCount": 4
}
[2025-12-14T08:28:35.550Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T08:28:35.550Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Creating new entry
{
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:28:35.551Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Found existing entry
{
  "key": "login:test-block-1765700915551",
  "timestampCount": 1
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T08:28:35.551Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Found existing entry
{
  "key": "login:test-block-1765700915551",
  "timestampCount": 2
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T08:28:35.551Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Found existing entry
{
  "key": "login:test-block-1765700915551",
  "timestampCount": 3
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T08:28:35.551Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Found existing entry
{
  "key": "login:test-block-1765700915551",
  "timestampCount": 4
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T08:28:35.551Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T08:28:35.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765700915551",
  "key": "login:test-block-1765700915551"
}
[2025-12-14T08:28:35.551Z] Found existing entry
{
  "key": "login:test-block-1765700915551",
  "timestampCount": 5
}
[2025-12-14T08:28:35.551Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-14T08:28:35.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700915552",
  "key": "test-reset:test-reset-1765700915552"
}
[2025-12-14T08:28:35.552Z] Creating new entry
{
  "key": "test-reset:test-reset-1765700915552"
}
[2025-12-14T08:28:35.552Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-14T08:28:35.552Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-14T08:28:35.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700915552",
  "key": "test-reset:test-reset-1765700915552"
}
[2025-12-14T08:28:35.552Z] Found existing entry
{
  "key": "test-reset:test-reset-1765700915552",
  "timestampCount": 1
}
[2025-12-14T08:28:35.552Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-14T08:28:35.552Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-14T08:28:35.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700915552",
  "key": "test-reset:test-reset-1765700915552"
}
[2025-12-14T08:28:35.552Z] Found existing entry
{
  "key": "test-reset:test-reset-1765700915552",
  "timestampCount": 2
}
[2025-12-14T08:28:35.552Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765700915552",
  "key": "test-reset:test-reset-1765700915552"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "test-reset:test-reset-1765700915552",
  "timestampCount": 2
}
[2025-12-14T08:28:35.704Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Creating new entry
{
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "login:test-multi-1-1765700915704",
  "timestampCount": 1
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "login:test-multi-1-1765700915704",
  "timestampCount": 2
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "login:test-multi-1-1765700915704",
  "timestampCount": 3
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "login:test-multi-1-1765700915704",
  "timestampCount": 4
}
[2025-12-14T08:28:35.704Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T08:28:35.704Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T08:28:35.704Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765700915704",
  "key": "login:test-multi-1-1765700915704"
}
[2025-12-14T08:28:35.704Z] Found existing entry
{
  "key": "login:test-multi-1-1765700915704",
  "timestampCount": 5
}
[2025-12-14T08:28:35.705Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-14T08:28:35.705Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765700915704",
  "key": "login:test-multi-2-1765700915704"
}
[2025-12-14T08:28:35.705Z] Creating new entry
{
  "key": "login:test-multi-2-1765700915704"
}
[2025-12-14T08:28:35.705Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:28:35.705Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:28:35.705Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765700915705",
  "key": "login:test-reset-time-1765700915705"
}
[2025-12-14T08:28:35.705Z] Creating new entry
{
  "key": "login:test-reset-time-1765700915705"
}
[2025-12-14T08:28:35.705Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T08:28:35.705Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T08:28:35.706Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-14T08:28:35.706Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-14T08:28:35.706Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-14T08:28:35.706Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-14T08:28:35.706Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-14T08:28:35.706Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-14T08:28:35.706Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-14T08:28:35.707Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-14T08:28:35.707Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-14T08:28:35.707Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-14T08:28:35.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765700915707",
  "key": "test-sliding:test-sliding-1765700915707"
}
[2025-12-14T08:28:35.707Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765700915707"
}
[2025-12-14T08:28:35.707Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-14T08:28:35.707Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-14T08:28:35.807Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765700915707",
  "key": "test-sliding:test-sliding-1765700915707"
}
[2025-12-14T08:28:35.807Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765700915707",
  "timestampCount": 1
}
[2025-12-14T08:28:35.807Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-14T08:28:35.807Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-14T08:28:35.909Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765700915707",
  "key": "test-sliding:test-sliding-1765700915707"
}
[2025-12-14T08:28:35.909Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765700915707",
  "timestampCount": 2
}
[2025-12-14T08:28:35.909Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-14T08:28:35.909Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-14T08:28:35.909Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-14T08:28:35.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765700915910",
  "key": "register:test-format-allowed-1765700915910"
}
[2025-12-14T08:28:35.910Z] Creating new entry
{
  "key": "register:test-format-allowed-1765700915910"
}
[2025-12-14T08:28:35.910Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-14T08:28:35.910Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-14T08:28:35.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765700915910",
  "key": "register:test-format-blocked-1765700915910"
}
[2025-12-14T08:28:35.910Z] Creating new entry
{
  "key": "register:test-format-blocked-1765700915910"
}
[2025-12-14T08:28:35.910Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-14T08:28:35.910Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-14T08:28:35.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765700915910",
  "key": "register:test-format-blocked-1765700915910"
}
[2025-12-14T08:28:35.910Z] Found existing entry
{
  "key": "register:test-format-blocked-1765700915910",
  "timestampCount": 1
}
[2025-12-14T08:28:35.910Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-14T08:28:35.910Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-14T08:28:35.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765700915910",
  "key": "register:test-format-blocked-1765700915910"
}
[2025-12-14T08:28:35.910Z] Found existing entry
{
  "key": "register:test-format-blocked-1765700915910",
  "timestampCount": 2
}
[2025-12-14T08:28:35.910Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-14T08:28:35.910Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-14T08:28:35.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765700915910",
  "key": "register:test-format-blocked-1765700915910"
}
[2025-12-14T08:28:35.910Z] Found existing entry
{
  "key": "register:test-format-blocked-1765700915910",
  "timestampCount": 3
}
[2025-12-14T08:28:35.910Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-14T11:03:54.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765710234926",
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.927Z] Creating new entry
{
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.927Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T11:03:54.927Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T11:03:54.927Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765710234926",
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.927Z] Found existing entry
{
  "key": "login:test-allow-1765710234926",
  "timestampCount": 1
}
[2025-12-14T11:03:54.927Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T11:03:54.927Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T11:03:54.927Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765710234926",
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.928Z] Found existing entry
{
  "key": "login:test-allow-1765710234926",
  "timestampCount": 2
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T11:03:54.928Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T11:03:54.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765710234926",
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.928Z] Found existing entry
{
  "key": "login:test-allow-1765710234926",
  "timestampCount": 3
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T11:03:54.928Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T11:03:54.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765710234926",
  "key": "login:test-allow-1765710234926"
}
[2025-12-14T11:03:54.928Z] Found existing entry
{
  "key": "login:test-allow-1765710234926",
  "timestampCount": 4
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T11:03:54.928Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T11:03:54.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.928Z] Creating new entry
{
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-14T11:03:54.928Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-14T11:03:54.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.928Z] Found existing entry
{
  "key": "login:test-block-1765710234928",
  "timestampCount": 1
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-14T11:03:54.928Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-14T11:03:54.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.928Z] Found existing entry
{
  "key": "login:test-block-1765710234928",
  "timestampCount": 2
}
[2025-12-14T11:03:54.928Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-14T11:03:54.929Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-14T11:03:54.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.929Z] Found existing entry
{
  "key": "login:test-block-1765710234928",
  "timestampCount": 3
}
[2025-12-14T11:03:54.929Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-14T11:03:54.929Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-14T11:03:54.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.929Z] Found existing entry
{
  "key": "login:test-block-1765710234928",
  "timestampCount": 4
}
[2025-12-14T11:03:54.929Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-14T11:03:54.929Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-14T11:03:54.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765710234928",
  "key": "login:test-block-1765710234928"
}
[2025-12-14T11:03:54.929Z] Found existing entry
{
  "key": "login:test-block-1765710234928",
  "timestampCount": 5
}
[2025-12-14T11:03:54.929Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-14T11:03:54.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765710234929",
  "key": "test-reset:test-reset-1765710234929"
}
[2025-12-14T11:03:54.929Z] Creating new entry
{
  "key": "test-reset:test-reset-1765710234929"
}
[2025-12-14T11:03:54.930Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-14T11:03:54.930Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-14T11:03:54.930Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765710234929",
  "key": "test-reset:test-reset-1765710234929"
}
[2025-12-14T11:03:54.930Z] Found existing entry
{
  "key": "test-reset:test-reset-1765710234929",
  "timestampCount": 1
}
[2025-12-14T11:03:54.930Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-14T11:03:54.930Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-14T11:03:54.930Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765710234929",
  "key": "test-reset:test-reset-1765710234929"
}
[2025-12-14T11:03:54.930Z] Found existing entry
{
  "key": "test-reset:test-reset-1765710234929",
  "timestampCount": 2
}
[2025-12-14T11:03:54.930Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-15T14:49:05.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765810145947",
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.948Z] Creating new entry
{
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.948Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T14:49:05.948Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T14:49:05.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765810145947",
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.948Z] Found existing entry
{
  "key": "login:test-allow-1765810145947",
  "timestampCount": 1
}
[2025-12-15T14:49:05.948Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-15T14:49:05.948Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-15T14:49:05.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765810145947",
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.948Z] Found existing entry
{
  "key": "login:test-allow-1765810145947",
  "timestampCount": 2
}
[2025-12-15T14:49:05.948Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-15T14:49:05.949Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-15T14:49:05.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765810145947",
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.949Z] Found existing entry
{
  "key": "login:test-allow-1765810145947",
  "timestampCount": 3
}
[2025-12-15T14:49:05.949Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-15T14:49:05.949Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-15T14:49:05.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1765810145947",
  "key": "login:test-allow-1765810145947"
}
[2025-12-15T14:49:05.949Z] Found existing entry
{
  "key": "login:test-allow-1765810145947",
  "timestampCount": 4
}
[2025-12-15T14:49:05.949Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-15T14:49:05.949Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-15T14:49:05.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.949Z] Creating new entry
{
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.949Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T14:49:05.949Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T14:49:05.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.949Z] Found existing entry
{
  "key": "login:test-block-1765810145949",
  "timestampCount": 1
}
[2025-12-15T14:49:05.949Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-15T14:49:05.949Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-15T14:49:05.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.949Z] Found existing entry
{
  "key": "login:test-block-1765810145949",
  "timestampCount": 2
}
[2025-12-15T14:49:05.949Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-15T14:49:05.950Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-15T14:49:05.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.950Z] Found existing entry
{
  "key": "login:test-block-1765810145949",
  "timestampCount": 3
}
[2025-12-15T14:49:05.950Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-15T14:49:05.950Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-15T14:49:05.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.950Z] Found existing entry
{
  "key": "login:test-block-1765810145949",
  "timestampCount": 4
}
[2025-12-15T14:49:05.950Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-15T14:49:05.950Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-15T14:49:05.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1765810145949",
  "key": "login:test-block-1765810145949"
}
[2025-12-15T14:49:05.950Z] Found existing entry
{
  "key": "login:test-block-1765810145949",
  "timestampCount": 5
}
[2025-12-15T14:49:05.950Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-15T14:49:05.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765810145951",
  "key": "test-reset:test-reset-1765810145951"
}
[2025-12-15T14:49:05.951Z] Creating new entry
{
  "key": "test-reset:test-reset-1765810145951"
}
[2025-12-15T14:49:05.951Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-15T14:49:05.951Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-15T14:49:05.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765810145951",
  "key": "test-reset:test-reset-1765810145951"
}
[2025-12-15T14:49:05.951Z] Found existing entry
{
  "key": "test-reset:test-reset-1765810145951",
  "timestampCount": 1
}
[2025-12-15T14:49:05.951Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-15T14:49:05.951Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-15T14:49:05.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765810145951",
  "key": "test-reset:test-reset-1765810145951"
}
[2025-12-15T14:49:05.951Z] Found existing entry
{
  "key": "test-reset:test-reset-1765810145951",
  "timestampCount": 2
}
[2025-12-15T14:49:05.951Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-15T14:49:06.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1765810145951",
  "key": "test-reset:test-reset-1765810145951"
}
[2025-12-15T14:49:06.103Z] Found existing entry
{
  "key": "test-reset:test-reset-1765810145951",
  "timestampCount": 2
}
[2025-12-15T14:49:06.103Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T14:49:06.103Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-15T14:49:06.103Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-15T14:49:06.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.104Z] Creating new entry
{
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.104Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T14:49:06.104Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T14:49:06.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.104Z] Found existing entry
{
  "key": "login:test-multi-1-1765810146104",
  "timestampCount": 1
}
[2025-12-15T14:49:06.104Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-15T14:49:06.104Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-15T14:49:06.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.104Z] Found existing entry
{
  "key": "login:test-multi-1-1765810146104",
  "timestampCount": 2
}
[2025-12-15T14:49:06.104Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-15T14:49:06.104Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-15T14:49:06.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.104Z] Found existing entry
{
  "key": "login:test-multi-1-1765810146104",
  "timestampCount": 3
}
[2025-12-15T14:49:06.104Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-15T14:49:06.104Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-15T14:49:06.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.105Z] Found existing entry
{
  "key": "login:test-multi-1-1765810146104",
  "timestampCount": 4
}
[2025-12-15T14:49:06.105Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-15T14:49:06.105Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-15T14:49:06.105Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1765810146104",
  "key": "login:test-multi-1-1765810146104"
}
[2025-12-15T14:49:06.105Z] Found existing entry
{
  "key": "login:test-multi-1-1765810146104",
  "timestampCount": 5
}
[2025-12-15T14:49:06.105Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-15T14:49:06.105Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1765810146104",
  "key": "login:test-multi-2-1765810146104"
}
[2025-12-15T14:49:06.105Z] Creating new entry
{
  "key": "login:test-multi-2-1765810146104"
}
[2025-12-15T14:49:06.105Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T14:49:06.105Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T14:49:06.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1765810146106",
  "key": "login:test-reset-time-1765810146106"
}
[2025-12-15T14:49:06.106Z] Creating new entry
{
  "key": "login:test-reset-time-1765810146106"
}
[2025-12-15T14:49:06.106Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T14:49:06.106Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T14:49:06.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T14:49:06.107Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-15T14:49:06.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T14:49:06.107Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-15T14:49:06.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T14:49:06.107Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-15T14:49:06.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T14:49:06.107Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T14:49:06.107Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T14:49:06.108Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-15T14:49:06.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765810146108",
  "key": "test-sliding:test-sliding-1765810146108"
}
[2025-12-15T14:49:06.108Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1765810146108"
}
[2025-12-15T14:49:06.108Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-15T14:49:06.108Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-15T14:49:06.207Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765810146108",
  "key": "test-sliding:test-sliding-1765810146108"
}
[2025-12-15T14:49:06.207Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765810146108",
  "timestampCount": 1
}
[2025-12-15T14:49:06.207Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-15T14:49:06.207Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-15T14:49:06.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1765810146108",
  "key": "test-sliding:test-sliding-1765810146108"
}
[2025-12-15T14:49:06.309Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1765810146108",
  "timestampCount": 2
}
[2025-12-15T14:49:06.309Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-15T14:49:06.309Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-15T14:49:06.309Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-15T14:49:06.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1765810146309",
  "key": "register:test-format-allowed-1765810146309"
}
[2025-12-15T14:49:06.309Z] Creating new entry
{
  "key": "register:test-format-allowed-1765810146309"
}
[2025-12-15T14:49:06.309Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-15T14:49:06.309Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-15T14:49:06.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765810146309",
  "key": "register:test-format-blocked-1765810146309"
}
[2025-12-15T14:49:06.309Z] Creating new entry
{
  "key": "register:test-format-blocked-1765810146309"
}
[2025-12-15T14:49:06.309Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-15T14:49:06.310Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-15T14:49:06.310Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765810146309",
  "key": "register:test-format-blocked-1765810146309"
}
[2025-12-15T14:49:06.310Z] Found existing entry
{
  "key": "register:test-format-blocked-1765810146309",
  "timestampCount": 1
}
[2025-12-15T14:49:06.310Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-15T14:49:06.310Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-15T14:49:06.310Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765810146309",
  "key": "register:test-format-blocked-1765810146309"
}
[2025-12-15T14:49:06.310Z] Found existing entry
{
  "key": "register:test-format-blocked-1765810146309",
  "timestampCount": 2
}
[2025-12-15T14:49:06.310Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-15T14:49:06.310Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-15T14:49:06.310Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1765810146309",
  "key": "register:test-format-blocked-1765810146309"
}
[2025-12-15T14:49:06.310Z] Found existing entry
{
  "key": "register:test-format-blocked-1765810146309",
  "timestampCount": 3
}
[2025-12-15T14:49:06.310Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-15T15:37:16.020Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-15T15:37:16.020Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:37:16.021Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:37:16.021Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-15T15:37:16.021Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-15T15:37:16.021Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-15T15:37:16.021Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-15T15:37:16.021Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-15T15:38:16.021Z"
  }
}
[2025-12-15T15:37:22.228Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:37:22.228Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:37:22.228Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:37:22.228Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:37:22.228Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-15T15:37:22.228Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:37:22.228Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:37:22.228Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:38:22.228Z"
  }
}
[2025-12-15T15:37:22.845Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:37:22.845Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:37:22.845Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:37:22.845Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:37:22.845Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:37:22.853Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:37:22.853Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:37:22.856Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:38:22.228Z"
  }
}
[2025-12-15T15:41:49.573Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:41:49.574Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:41:49.574Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:41:49.574Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:41:49.574Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:41:49.575Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T15:41:49.575Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:41:49.575Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:41:49.575Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:42:49.574Z"
  }
}
[2025-12-15T15:41:50.191Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:41:50.191Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:41:50.191Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:41:50.191Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:41:50.191Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:41:50.191Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:41:50.191Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:41:50.191Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:42:49.574Z"
  }
}
[2025-12-15T15:42:02.183Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:42:02.183Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:42:02.183Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:42:02.183Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:42:02.183Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:42:02.183Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:42:02.183Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:42:02.183Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:42:49.574Z"
  }
}
[2025-12-15T15:42:02.788Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:42:02.788Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:42:02.788Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:42:02.788Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:42:02.788Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:42:02.788Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:42:02.788Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:42:02.788Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:42:49.574Z"
  }
}
[2025-12-15T15:43:48.245Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:43:48.246Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:43:48.246Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:43:48.246Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:43:48.246Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:43:48.246Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-15T15:43:48.246Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:43:48.246Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:43:48.246Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:43:48.836Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:43:48.836Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:43:48.836Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:43:48.836Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:43:48.836Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:43:48.836Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:43:48.836Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:43:48.836Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:43:56.550Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:43:56.550Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:43:56.551Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:43:56.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:43:56.551Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:43:56.551Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:43:56.553Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:43:56.553Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:43:57.241Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:43:57.241Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:43:57.242Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:43:57.242Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:43:57.242Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:43:57.242Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:43:57.242Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:43:57.243Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:04.920Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:04.920Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:04.920Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:04.920Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:04.920Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:44:04.920Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:44:04.920Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:44:04.920Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:05.650Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:05.657Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:05.657Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:05.658Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:05.658Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:44:05.658Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:44:05.658Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:44:05.658Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:07.735Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:07.735Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:07.735Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:07.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:07.735Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:44:07.735Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:44:07.735Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:44:07.735Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:08.349Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:08.349Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:08.349Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:08.349Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:08.349Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:44:08.349Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:44:08.349Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:44:08.349Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:14.222Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:14.223Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:14.223Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:14.223Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:14.223Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:44:14.223Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T15:44:14.223Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T15:44:14.223Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:14.869Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:14.869Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:14.869Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:14.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:14.869Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T15:44:14.869Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T15:44:14.869Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T15:44:14.869Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:40.600Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:40.601Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:40.601Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:40.601Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:40.601Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T15:44:40.601Z] Current state
{
  "countAfterFilter": 10,
  "maxRequests": 60
}
[2025-12-15T15:44:40.601Z] Request allowed
{
  "newCount": 11,
  "remaining": 49
}
[2025-12-15T15:44:40.601Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 49,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:44:41.217Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:44:41.217Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:44:41.217Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:44:41.218Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:44:41.218Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 11
}
[2025-12-15T15:44:41.218Z] Current state
{
  "countAfterFilter": 11,
  "maxRequests": 60
}
[2025-12-15T15:44:41.218Z] Request allowed
{
  "newCount": 12,
  "remaining": 48
}
[2025-12-15T15:44:41.218Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 48,
    "resetAt": "2025-12-15T15:44:48.246Z"
  }
}
[2025-12-15T15:45:25.367Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:25.368Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:25.368Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:25.368Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:25.368Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 12
}
[2025-12-15T15:45:25.368Z] Filtered old timestamps
{
  "before": 12,
  "after": 2,
  "removed": 10
}
[2025-12-15T15:45:25.368Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:45:25.368Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:45:25.368Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:26.004Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:26.005Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:26.005Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:26.005Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:26.005Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:45:26.005Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:45:26.005Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:45:26.005Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:26.769Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:26.769Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:26.769Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:26.769Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:26.769Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:45:26.769Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:45:26.769Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:45:26.769Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:27.393Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:27.393Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:27.393Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:27.393Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:27.393Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:45:27.393Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:45:27.393Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:45:27.393Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:28.798Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:28.798Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:28.798Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:28.798Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:28.798Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:45:28.798Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:45:28.798Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:45:28.798Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:29.392Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:29.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:29.393Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:29.393Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:29.393Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:45:29.393Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:45:29.393Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:45:29.393Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:31.697Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:31.697Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:31.697Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:31.697Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:31.697Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:45:31.697Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T15:45:31.697Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T15:45:31.697Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:32.320Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:32.320Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:32.320Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:32.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:32.320Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T15:45:32.320Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T15:45:32.320Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T15:45:32.320Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T15:45:40.601Z"
  }
}
[2025-12-15T15:45:41.305Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:41.306Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:41.306Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:41.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:41.306Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T15:45:41.307Z] Filtered old timestamps
{
  "before": 10,
  "after": 8,
  "removed": 2
}
[2025-12-15T15:45:41.307Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T15:45:41.307Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T15:45:41.307Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T15:46:25.368Z"
  }
}
[2025-12-15T15:45:41.924Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:45:41.924Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:45:41.924Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:45:41.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:45:41.924Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T15:45:41.925Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T15:45:41.925Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T15:45:41.925Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T15:46:25.368Z"
  }
}
[2025-12-15T15:47:13.299Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:13.300Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:13.300Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:13.300Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:13.300Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T15:47:13.300Z] Filtered old timestamps
{
  "before": 10,
  "after": 0,
  "removed": 10
}
[2025-12-15T15:47:13.300Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:47:13.300Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:47:13.300Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:13.918Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:13.918Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:13.918Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:13.918Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:13.918Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:47:13.918Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:47:13.918Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:47:13.918Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:18.480Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:18.480Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:18.480Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:18.480Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:18.480Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:47:18.480Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:47:18.480Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:47:18.480Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:19.081Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:19.081Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:19.081Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:19.081Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:19.081Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:47:19.081Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:47:19.081Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:47:19.081Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:29.381Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:29.382Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:29.382Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:29.383Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:29.383Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:47:29.383Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:47:29.383Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:47:29.383Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:30.020Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:30.020Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:30.020Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:30.020Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:30.020Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:47:30.020Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:47:30.020Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:47:30.020Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:34.630Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:34.630Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:34.631Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:34.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:34.631Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:47:34.631Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:47:34.631Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:47:34.631Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:35.241Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:35.241Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:35.241Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:35.243Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:35.243Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:47:35.243Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:47:35.243Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:47:35.243Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:40.922Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:40.923Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:40.923Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:40.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:40.923Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:47:40.924Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T15:47:40.924Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T15:47:40.924Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:47:41.557Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:47:41.557Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:47:41.557Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:47:41.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:47:41.559Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T15:47:41.559Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T15:47:41.559Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T15:47:41.559Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T15:48:13.300Z"
  }
}
[2025-12-15T15:48:19.263Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:19.263Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:19.264Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:19.264Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:19.264Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T15:48:19.264Z] Filtered old timestamps
{
  "before": 10,
  "after": 6,
  "removed": 4
}
[2025-12-15T15:48:19.264Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:48:19.264Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:48:19.264Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:48:29.383Z"
  }
}
[2025-12-15T15:48:19.864Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:19.864Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:19.864Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:19.864Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:19.864Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:48:19.864Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:48:19.864Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:48:19.864Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:48:29.383Z"
  }
}
[2025-12-15T15:48:34.861Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:34.862Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:34.862Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:34.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:34.862Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:48:34.862Z] Filtered old timestamps
{
  "before": 8,
  "after": 5,
  "removed": 3
}
[2025-12-15T15:48:34.862Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:48:34.862Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:48:34.862Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:48:35.243Z"
  }
}
[2025-12-15T15:48:35.473Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:35.478Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:35.478Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:35.478Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:35.484Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:48:35.484Z] Filtered old timestamps
{
  "before": 6,
  "after": 5,
  "removed": 1
}
[2025-12-15T15:48:35.484Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:48:35.484Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:48:35.484Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:48:40.923Z"
  }
}
[2025-12-15T15:48:43.426Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:43.426Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:43.426Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:43.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:43.426Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:48:43.426Z] Filtered old timestamps
{
  "before": 6,
  "after": 4,
  "removed": 2
}
[2025-12-15T15:48:43.426Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:48:43.426Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:48:43.426Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:48:44.051Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:44.051Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:44.051Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:44.051Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:44.051Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:48:44.051Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:48:44.051Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:48:44.051Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:48:58.296Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:58.296Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:58.296Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:58.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:58.297Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:48:58.297Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:48:58.297Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:48:58.297Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:48:58.923Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:48:58.923Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:48:58.923Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:48:58.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:48:58.923Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:48:58.923Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:48:58.924Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:48:58.924Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:49:07.334Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:49:07.334Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:49:07.334Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:49:07.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:49:07.334Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:49:07.334Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T15:49:07.334Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T15:49:07.334Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:49:07.945Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:49:07.945Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:49:07.945Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:49:07.945Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:49:07.945Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T15:49:07.945Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T15:49:07.945Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T15:49:07.945Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T15:49:19.264Z"
  }
}
[2025-12-15T15:49:38.861Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:49:38.862Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:49:38.862Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:49:38.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:49:38.862Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T15:49:38.862Z] Filtered old timestamps
{
  "before": 10,
  "after": 6,
  "removed": 4
}
[2025-12-15T15:49:38.862Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:49:38.862Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:49:38.862Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:49:43.426Z"
  }
}
[2025-12-15T15:49:39.617Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:49:39.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:49:39.617Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:49:39.618Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:49:39.618Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:49:39.618Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:49:39.618Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:49:39.618Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:49:43.426Z"
  }
}
[2025-12-15T15:52:50.802Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:52:50.802Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:52:50.802Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:52:50.807Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:52:50.811Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:52:50.811Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2025-12-15T15:52:50.811Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:52:50.811Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:52:50.815Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:53:50.807Z"
  }
}
[2025-12-15T15:52:51.435Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:52:51.435Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:52:51.435Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:52:51.435Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:52:51.435Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:52:51.435Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:52:51.435Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:52:51.435Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:53:50.807Z"
  }
}
[2025-12-15T15:53:37.811Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:53:37.812Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:53:37.812Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:53:37.813Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:53:37.813Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:53:37.813Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:53:37.813Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:53:37.813Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:53:50.807Z"
  }
}
[2025-12-15T15:53:38.685Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:53:38.685Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:53:38.685Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:53:38.685Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:53:38.685Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:53:38.685Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:53:38.685Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:53:38.685Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:53:50.807Z"
  }
}
[2025-12-15T15:54:09.073Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:54:09.074Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:54:09.074Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:54:09.074Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:54:09.074Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:54:09.074Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-15T15:54:09.074Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:54:09.074Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:54:09.074Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:54:37.813Z"
  }
}
[2025-12-15T15:54:10.026Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:54:10.026Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:54:10.028Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:54:10.028Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:54:10.029Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:54:10.029Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:54:10.029Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:54:10.030Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:54:37.813Z"
  }
}
[2025-12-15T15:54:24.108Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:54:24.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:54:24.108Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:54:24.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:54:24.109Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:54:24.109Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:54:24.109Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:54:24.109Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:54:37.813Z"
  }
}
[2025-12-15T15:54:25.008Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:54:25.008Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:54:25.009Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:54:25.009Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:54:25.009Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:54:25.009Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:54:25.009Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:54:25.009Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:54:37.813Z"
  }
}
[2025-12-15T15:55:11.087Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:11.087Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:11.087Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:11.087Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:11.087Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:55:11.087Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-15T15:55:11.087Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:55:11.087Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:55:11.087Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:11.964Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:11.964Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:11.964Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:11.964Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:11.964Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:55:11.965Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:55:11.965Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:55:11.965Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:14.339Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:14.339Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:14.339Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:14.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:14.339Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T15:55:14.339Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T15:55:14.339Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T15:55:14.339Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:14.956Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:14.956Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:14.956Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:14.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:14.956Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T15:55:14.956Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T15:55:14.956Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T15:55:14.956Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:16.476Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:16.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:16.476Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:16.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:16.476Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T15:55:16.476Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:55:16.476Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:55:16.476Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:17.079Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:17.080Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:17.080Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:17.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:17.080Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:55:17.080Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:55:17.080Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:55:17.080Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:55:24.108Z"
  }
}
[2025-12-15T15:55:36.022Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:36.022Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:36.022Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:36.023Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:36.023Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:55:36.023Z] Filtered old timestamps
{
  "before": 8,
  "after": 6,
  "removed": 2
}
[2025-12-15T15:55:36.023Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T15:55:36.023Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T15:55:36.023Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T15:56:11.087Z"
  }
}
[2025-12-15T15:55:36.935Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:55:36.935Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:55:36.935Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:55:36.936Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:55:36.936Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T15:55:36.936Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T15:55:36.936Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T15:55:36.936Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T15:56:11.087Z"
  }
}
[2025-12-15T15:56:49.736Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:56:49.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:56:49.737Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:56:49.737Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:56:49.738Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T15:56:49.738Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2025-12-15T15:56:49.738Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:56:49.738Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:56:49.738Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:57:49.737Z"
  }
}
[2025-12-15T15:56:50.376Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:56:50.377Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:56:50.378Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:56:50.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:56:50.378Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:56:50.378Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:56:50.378Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:56:50.378Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:57:49.737Z"
  }
}
[2025-12-15T15:58:30.627Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:58:30.627Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:58:30.627Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:58:30.627Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:58:30.627Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:58:30.627Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T15:58:30.627Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:58:30.627Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:58:30.627Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T15:59:30.627Z"
  }
}
[2025-12-15T15:58:31.253Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:58:31.253Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:58:31.253Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:58:31.253Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:58:31.253Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:58:31.253Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:58:31.254Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:58:31.254Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T15:59:30.627Z"
  }
}
[2025-12-15T15:58:35.252Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:58:35.252Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:58:35.252Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:58:35.252Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:58:35.252Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T15:58:35.252Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T15:58:35.252Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T15:58:35.252Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T15:59:30.627Z"
  }
}
[2025-12-15T15:58:35.847Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:58:35.848Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:58:35.848Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:58:35.848Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:58:35.848Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T15:58:35.848Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T15:58:35.849Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T15:58:35.849Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T15:59:30.627Z"
  }
}
[2025-12-15T15:59:27.290Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:59:27.290Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:59:27.290Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:59:27.290Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:59:27.290Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-15T15:59:27.290Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T15:59:27.291Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T15:59:27.291Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:00:27.290Z"
  }
}
[2025-12-15T15:59:28.169Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T15:59:28.170Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T15:59:28.170Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T15:59:28.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T15:59:28.170Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T15:59:28.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T15:59:28.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T15:59:28.170Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:00:27.290Z"
  }
}
[2025-12-15T16:00:29.541Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:29.542Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:29.542Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:29.542Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:29.542Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:00:29.542Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T16:00:29.542Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:00:29.542Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:00:29.542Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:30.126Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:30.127Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:30.127Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:30.127Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:30.127Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:00:30.127Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:00:30.127Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:00:30.127Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:34.002Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:34.003Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:34.003Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:34.003Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:34.003Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:00:34.003Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:00:34.003Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:00:34.003Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:34.682Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:34.683Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:34.683Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:34.683Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:34.683Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:00:34.683Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:00:34.683Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:00:34.683Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:36.885Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:36.886Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:36.886Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:36.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:36.886Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:00:36.886Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T16:00:36.886Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T16:00:36.886Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:37.551Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:37.552Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:37.552Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:37.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:37.552Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T16:00:37.552Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T16:00:37.552Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T16:00:37.552Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:39.466Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:39.466Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:39.466Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:39.466Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:39.466Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T16:00:39.466Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T16:00:39.466Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T16:00:39.466Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:40.090Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:40.090Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:40.091Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:40.091Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:40.091Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T16:00:40.091Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T16:00:40.091Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T16:00:40.091Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:46.594Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:46.594Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:46.595Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:46.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:46.595Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T16:00:46.595Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T16:00:46.595Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T16:00:46.596Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:47.203Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:47.203Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:47.204Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:47.204Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:47.204Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T16:00:47.204Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T16:00:47.204Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T16:00:47.204Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:50.283Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:50.283Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:50.283Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:50.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:50.283Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T16:00:50.283Z] Current state
{
  "countAfterFilter": 10,
  "maxRequests": 60
}
[2025-12-15T16:00:50.283Z] Request allowed
{
  "newCount": 11,
  "remaining": 49
}
[2025-12-15T16:00:50.284Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 49,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:50.928Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:50.928Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:50.928Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:50.928Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:50.928Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 11
}
[2025-12-15T16:00:50.928Z] Current state
{
  "countAfterFilter": 11,
  "maxRequests": 60
}
[2025-12-15T16:00:50.928Z] Request allowed
{
  "newCount": 12,
  "remaining": 48
}
[2025-12-15T16:00:50.928Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 48,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:56.032Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:56.032Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:56.032Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:56.033Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:56.033Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 12
}
[2025-12-15T16:00:56.033Z] Current state
{
  "countAfterFilter": 12,
  "maxRequests": 60
}
[2025-12-15T16:00:56.033Z] Request allowed
{
  "newCount": 13,
  "remaining": 47
}
[2025-12-15T16:00:56.033Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 47,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:00:56.636Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:00:56.636Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:00:56.638Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:00:56.638Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:00:56.639Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 13
}
[2025-12-15T16:00:56.639Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2025-12-15T16:00:56.639Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2025-12-15T16:00:56.639Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:06.959Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:06.959Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:06.959Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:06.960Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:06.960Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2025-12-15T16:01:06.960Z] Current state
{
  "countAfterFilter": 14,
  "maxRequests": 60
}
[2025-12-15T16:01:06.960Z] Request allowed
{
  "newCount": 15,
  "remaining": 45
}
[2025-12-15T16:01:06.960Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 45,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:07.560Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:07.560Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:07.560Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:07.560Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:07.560Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 15
}
[2025-12-15T16:01:07.560Z] Current state
{
  "countAfterFilter": 15,
  "maxRequests": 60
}
[2025-12-15T16:01:07.560Z] Request allowed
{
  "newCount": 16,
  "remaining": 44
}
[2025-12-15T16:01:07.560Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 44,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:11.233Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:11.233Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:11.233Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:11.233Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:11.234Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 16
}
[2025-12-15T16:01:11.234Z] Current state
{
  "countAfterFilter": 16,
  "maxRequests": 60
}
[2025-12-15T16:01:11.234Z] Request allowed
{
  "newCount": 17,
  "remaining": 43
}
[2025-12-15T16:01:11.234Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 43,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:11.829Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:11.829Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:11.831Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:11.831Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:11.831Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 17
}
[2025-12-15T16:01:11.831Z] Current state
{
  "countAfterFilter": 17,
  "maxRequests": 60
}
[2025-12-15T16:01:11.831Z] Request allowed
{
  "newCount": 18,
  "remaining": 42
}
[2025-12-15T16:01:11.831Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 42,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:16.732Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:16.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:16.733Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:16.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:16.733Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 18
}
[2025-12-15T16:01:16.733Z] Current state
{
  "countAfterFilter": 18,
  "maxRequests": 60
}
[2025-12-15T16:01:16.733Z] Request allowed
{
  "newCount": 19,
  "remaining": 41
}
[2025-12-15T16:01:16.733Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 41,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:17.332Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:17.332Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:17.333Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:17.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:17.334Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 19
}
[2025-12-15T16:01:17.335Z] Current state
{
  "countAfterFilter": 19,
  "maxRequests": 60
}
[2025-12-15T16:01:17.335Z] Request allowed
{
  "newCount": 20,
  "remaining": 40
}
[2025-12-15T16:01:17.335Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 40,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:24.213Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:24.213Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:24.213Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:24.213Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:24.214Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 20
}
[2025-12-15T16:01:24.214Z] Current state
{
  "countAfterFilter": 20,
  "maxRequests": 60
}
[2025-12-15T16:01:24.214Z] Request allowed
{
  "newCount": 21,
  "remaining": 39
}
[2025-12-15T16:01:24.214Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 39,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:01:24.817Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:01:24.817Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:01:24.817Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:01:24.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:01:24.818Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 21
}
[2025-12-15T16:01:24.818Z] Current state
{
  "countAfterFilter": 21,
  "maxRequests": 60
}
[2025-12-15T16:01:24.818Z] Request allowed
{
  "newCount": 22,
  "remaining": 38
}
[2025-12-15T16:01:24.818Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 38,
    "resetAt": "2025-12-15T16:01:29.542Z"
  }
}
[2025-12-15T16:04:26.432Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:26.432Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:26.432Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:26.433Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:26.433Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 22
}
[2025-12-15T16:04:26.433Z] Filtered old timestamps
{
  "before": 22,
  "after": 0,
  "removed": 22
}
[2025-12-15T16:04:26.433Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:04:26.433Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:04:26.433Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:27.326Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:27.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:27.326Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:27.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:27.326Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:04:27.327Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:04:27.327Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:04:27.327Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:28.730Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:28.730Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:28.730Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:28.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:28.730Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:04:28.730Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:04:28.730Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:04:28.731Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:29.345Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:29.345Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:29.345Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:29.345Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:29.345Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:04:29.345Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:04:29.346Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:04:29.346Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:33.620Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:33.620Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:33.620Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:33.620Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:33.620Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:04:33.620Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T16:04:33.620Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T16:04:33.621Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:34.247Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:34.247Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:34.247Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:34.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:34.247Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T16:04:34.247Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T16:04:34.247Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T16:04:34.247Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:36.226Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:36.226Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:36.226Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:36.226Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:36.226Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T16:04:36.226Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T16:04:36.226Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T16:04:36.226Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:36.820Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:36.821Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:36.821Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:36.821Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:36.821Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T16:04:36.821Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T16:04:36.821Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T16:04:36.821Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:38.737Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:38.737Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:38.737Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:38.737Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:38.737Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T16:04:38.737Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-15T16:04:38.737Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-15T16:04:38.738Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:39.555Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:39.555Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:39.555Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:39.555Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:39.555Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-15T16:04:39.555Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-15T16:04:39.555Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-15T16:04:39.555Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:41.958Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:41.958Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:41.959Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:41.959Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:41.959Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-15T16:04:41.959Z] Current state
{
  "countAfterFilter": 10,
  "maxRequests": 60
}
[2025-12-15T16:04:41.959Z] Request allowed
{
  "newCount": 11,
  "remaining": 49
}
[2025-12-15T16:04:41.959Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 49,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:42.571Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:42.571Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:42.571Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:42.571Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:42.571Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 11
}
[2025-12-15T16:04:42.571Z] Current state
{
  "countAfterFilter": 11,
  "maxRequests": 60
}
[2025-12-15T16:04:42.571Z] Request allowed
{
  "newCount": 12,
  "remaining": 48
}
[2025-12-15T16:04:42.571Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 48,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:45.719Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:45.720Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:45.720Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:45.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:45.720Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 12
}
[2025-12-15T16:04:45.720Z] Current state
{
  "countAfterFilter": 12,
  "maxRequests": 60
}
[2025-12-15T16:04:45.720Z] Request allowed
{
  "newCount": 13,
  "remaining": 47
}
[2025-12-15T16:04:45.720Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 47,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:46.613Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:46.613Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:46.613Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:46.613Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:46.613Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 13
}
[2025-12-15T16:04:46.613Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2025-12-15T16:04:46.613Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2025-12-15T16:04:46.614Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:48.185Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:48.186Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:48.186Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:48.186Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:48.186Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2025-12-15T16:04:48.186Z] Current state
{
  "countAfterFilter": 14,
  "maxRequests": 60
}
[2025-12-15T16:04:48.186Z] Request allowed
{
  "newCount": 15,
  "remaining": 45
}
[2025-12-15T16:04:48.186Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 45,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:49.078Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:49.078Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:49.078Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:49.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:49.078Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 15
}
[2025-12-15T16:04:49.079Z] Current state
{
  "countAfterFilter": 15,
  "maxRequests": 60
}
[2025-12-15T16:04:49.079Z] Request allowed
{
  "newCount": 16,
  "remaining": 44
}
[2025-12-15T16:04:49.079Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 44,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:52.555Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:52.563Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:52.566Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:52.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:52.567Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 16
}
[2025-12-15T16:04:52.567Z] Current state
{
  "countAfterFilter": 16,
  "maxRequests": 60
}
[2025-12-15T16:04:52.567Z] Request allowed
{
  "newCount": 17,
  "remaining": 43
}
[2025-12-15T16:04:52.567Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 43,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:53.806Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:53.806Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:53.807Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:53.807Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:53.807Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 17
}
[2025-12-15T16:04:53.807Z] Current state
{
  "countAfterFilter": 17,
  "maxRequests": 60
}
[2025-12-15T16:04:53.807Z] Request allowed
{
  "newCount": 18,
  "remaining": 42
}
[2025-12-15T16:04:53.807Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 42,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:58.059Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:58.059Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:58.059Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:58.059Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:58.060Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 18
}
[2025-12-15T16:04:58.060Z] Current state
{
  "countAfterFilter": 18,
  "maxRequests": 60
}
[2025-12-15T16:04:58.060Z] Request allowed
{
  "newCount": 19,
  "remaining": 41
}
[2025-12-15T16:04:58.060Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 41,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:04:58.672Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:04:58.673Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:04:58.673Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:04:58.676Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:04:58.681Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 19
}
[2025-12-15T16:04:58.682Z] Current state
{
  "countAfterFilter": 19,
  "maxRequests": 60
}
[2025-12-15T16:04:58.686Z] Request allowed
{
  "newCount": 20,
  "remaining": 40
}
[2025-12-15T16:04:58.689Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 40,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:05:02.934Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:05:02.934Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:05:02.935Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:05:02.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:05:02.935Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 20
}
[2025-12-15T16:05:02.935Z] Current state
{
  "countAfterFilter": 20,
  "maxRequests": 60
}
[2025-12-15T16:05:02.936Z] Request allowed
{
  "newCount": 21,
  "remaining": 39
}
[2025-12-15T16:05:02.936Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 39,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:05:03.530Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:05:03.530Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:05:03.530Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:05:03.530Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:05:03.530Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 21
}
[2025-12-15T16:05:03.530Z] Current state
{
  "countAfterFilter": 21,
  "maxRequests": 60
}
[2025-12-15T16:05:03.530Z] Request allowed
{
  "newCount": 22,
  "remaining": 38
}
[2025-12-15T16:05:03.530Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 38,
    "resetAt": "2025-12-15T16:05:26.433Z"
  }
}
[2025-12-15T16:10:24.790Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:24.795Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:24.795Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:24.795Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:24.798Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 22
}
[2025-12-15T16:10:24.799Z] Filtered old timestamps
{
  "before": 22,
  "after": 0,
  "removed": 22
}
[2025-12-15T16:10:24.799Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:10:24.799Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:10:24.799Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:10:25.500Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:25.501Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:25.501Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:25.501Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:25.501Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:10:25.501Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:10:25.501Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:10:25.501Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:10:38.925Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:38.925Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:38.926Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:38.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:38.926Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:10:38.926Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:10:38.926Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:10:38.926Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:10:39.523Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:39.523Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:39.523Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:39.523Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:39.523Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:10:39.523Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:10:39.523Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:10:39.523Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:10:50.467Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:50.468Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:50.468Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:50.468Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:50.468Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:10:50.468Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T16:10:50.468Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T16:10:50.468Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:10:51.062Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:10:51.062Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:10:51.063Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:10:51.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:10:51.063Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T16:10:51.063Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T16:10:51.063Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T16:10:51.063Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:11:19.196Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:11:19.196Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:11:19.197Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:11:19.197Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:11:19.197Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T16:11:19.197Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-15T16:11:19.197Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-15T16:11:19.197Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:11:19.801Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:11:19.801Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:11:19.801Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:11:19.801Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:11:19.801Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-15T16:11:19.801Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-15T16:11:19.801Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-15T16:11:19.801Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-15T16:11:24.795Z"
  }
}
[2025-12-15T16:12:25.775Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:12:25.775Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:12:25.775Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:12:25.775Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:12:25.775Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-15T16:12:25.775Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2025-12-15T16:12:25.775Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:12:25.775Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:12:25.775Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:13:25.775Z"
  }
}
[2025-12-15T16:12:26.377Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:12:26.377Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:12:26.377Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:12:26.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:12:26.377Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:12:26.377Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:12:26.377Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:12:26.377Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:13:25.775Z"
  }
}
[2025-12-15T16:13:01.074Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:13:01.074Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:13:01.074Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:13:01.074Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:13:01.074Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:13:01.074Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:13:01.074Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:13:01.074Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:13:25.775Z"
  }
}
[2025-12-15T16:13:01.666Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:13:01.667Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:13:01.667Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:13:01.667Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:13:01.667Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:13:01.667Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:13:01.667Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:13:01.667Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:13:25.775Z"
  }
}
[2025-12-15T16:14:01.455Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:14:01.456Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:14:01.456Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:14:01.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:14:01.456Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:14:01.456Z] Filtered old timestamps
{
  "before": 4,
  "after": 1,
  "removed": 3
}
[2025-12-15T16:14:01.456Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:14:01.456Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:14:01.456Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:14:01.667Z"
  }
}
[2025-12-15T16:14:02.059Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:14:02.059Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:14:02.059Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:14:02.059Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:14:02.059Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:14:02.059Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-15T16:14:02.059Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:14:02.059Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:14:02.059Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:15:01.456Z"
  }
}
[2025-12-15T16:15:36.745Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:15:36.746Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:15:36.746Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:15:36.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:15:36.746Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:15:36.746Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T16:15:36.746Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:15:36.746Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:15:36.746Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:16:36.746Z"
  }
}
[2025-12-15T16:15:37.343Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:15:37.344Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:15:37.344Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:15:37.344Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:15:37.344Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:15:37.344Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:15:37.344Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:15:37.344Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:16:36.746Z"
  }
}
[2025-12-15T16:15:45.153Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:15:45.153Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:15:45.153Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:15:45.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:15:45.153Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:15:45.153Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:15:45.153Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:15:45.153Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:16:36.746Z"
  }
}
[2025-12-15T16:15:45.739Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:15:45.739Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:15:45.739Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:15:45.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:15:45.739Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:15:45.739Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:15:45.739Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:15:45.739Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:16:36.746Z"
  }
}
[2025-12-15T16:22:15.301Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:15.302Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:15.302Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:15.302Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:15.302Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:22:15.302Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-15T16:22:15.302Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:22:15.302Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:22:15.302Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:22:16.189Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:16.189Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:16.189Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:16.189Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:16.189Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:22:16.189Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:22:16.189Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:22:16.189Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:22:26.230Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:26.230Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:26.231Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:26.231Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:26.231Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:22:26.231Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:22:26.231Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:22:26.231Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:22:27.097Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:27.097Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:27.098Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:27.098Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:27.098Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:22:27.098Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:22:27.098Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:22:27.098Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:22:55.041Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:55.041Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:55.042Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:55.042Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:55.042Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:22:55.042Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T16:22:55.042Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T16:22:55.042Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:22:55.643Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:22:55.643Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:22:55.643Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:22:55.643Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:22:55.643Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T16:22:55.643Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T16:22:55.643Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T16:22:55.643Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T16:23:15.302Z"
  }
}
[2025-12-15T16:28:25.637Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:28:25.637Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:28:25.637Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:28:25.637Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:28:25.638Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T16:28:25.638Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-15T16:28:25.638Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:28:25.638Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:28:25.638Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:29:25.637Z"
  }
}
[2025-12-15T16:28:26.342Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:28:26.342Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:28:26.348Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:28:26.348Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:28:26.348Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:28:26.348Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:28:26.348Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:28:26.348Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:29:25.637Z"
  }
}
[2025-12-15T16:31:03.450Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:03.451Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:03.451Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:03.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:03.451Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:31:03.451Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T16:31:03.451Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:31:03.451Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:31:03.451Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:31:04.320Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:04.320Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:04.321Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:04.321Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:04.321Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:31:04.321Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:31:04.321Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:31:04.321Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:31:06.663Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:06.663Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:06.663Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:06.663Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:06.663Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T16:31:06.663Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T16:31:06.663Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T16:31:06.663Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:31:07.260Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:07.260Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:07.260Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:07.261Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:07.261Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T16:31:07.261Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T16:31:07.261Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T16:31:07.261Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:31:37.233Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:37.235Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:37.235Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:37.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:37.235Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-15T16:31:37.235Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-15T16:31:37.235Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-15T16:31:37.235Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:31:37.836Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:31:37.836Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:31:37.836Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:31:37.837Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:31:37.837Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-15T16:31:37.837Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-15T16:31:37.837Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-15T16:31:37.837Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-15T16:32:03.451Z"
  }
}
[2025-12-15T16:33:16.103Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:33:16.104Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:33:16.104Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:33:16.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:33:16.104Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-15T16:33:16.104Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-15T16:33:16.104Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T16:33:16.104Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T16:33:16.105Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T16:34:16.104Z"
  }
}
[2025-12-15T16:33:16.732Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T16:33:16.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T16:33:16.733Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T16:33:16.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T16:33:16.733Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T16:33:16.733Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T16:33:16.733Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T16:33:16.733Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T16:34:16.104Z"
  }
}
[2025-12-15T17:09:44.012Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:09:44.013Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:09:44.013Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:09:44.013Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:09:44.013Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-15T17:09:44.013Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:09:44.013Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:09:44.013Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:10:44.013Z"
  }
}
[2025-12-15T17:09:44.624Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:09:44.624Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:09:44.625Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:09:44.625Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:09:44.625Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:09:44.625Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:09:44.625Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:09:44.625Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:10:44.013Z"
  }
}
[2025-12-15T17:11:59.029Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:11:59.031Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:11:59.031Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:11:59.031Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:11:59.031Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:11:59.031Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:11:59.031Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:11:59.031Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:11:59.031Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:12:59.031Z"
  }
}
[2025-12-15T17:11:59.625Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:11:59.625Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:11:59.626Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:11:59.626Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:11:59.626Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:11:59.626Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:11:59.626Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:11:59.626Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:12:59.031Z"
  }
}
[2025-12-15T17:16:43.941Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:16:43.941Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:16:43.941Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:16:43.941Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:16:43.941Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:16:43.941Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:16:43.941Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:16:43.941Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:16:43.941Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:17:43.941Z"
  }
}
[2025-12-15T17:16:44.538Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:16:44.538Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:16:44.538Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:16:44.538Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:16:44.538Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:16:44.538Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:16:44.538Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:16:44.538Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:17:43.941Z"
  }
}
[2025-12-15T17:23:10.332Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:23:10.333Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:23:10.333Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:23:10.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:23:10.333Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:23:10.333Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:23:10.333Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:23:10.333Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:23:10.333Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:24:10.333Z"
  }
}
[2025-12-15T17:23:10.935Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:23:10.935Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:23:10.935Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:23:10.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:23:10.935Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:23:10.935Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:23:10.935Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:23:10.935Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:24:10.333Z"
  }
}
[2025-12-15T17:24:18.988Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:24:18.990Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:24:18.990Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:24:18.990Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:24:18.990Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:24:18.990Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:24:18.990Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:24:18.990Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:24:18.990Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:25:18.990Z"
  }
}
[2025-12-15T17:24:19.659Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:24:19.659Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:24:19.659Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:24:19.659Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:24:19.659Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:24:19.659Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:24:19.659Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:24:19.659Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:25:18.990Z"
  }
}
[2025-12-15T17:29:26.507Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:29:26.508Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:29:26.508Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:29:26.509Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:29:26.509Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:29:26.509Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:29:26.509Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:29:26.509Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:29:26.509Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:30:26.509Z"
  }
}
[2025-12-15T17:29:27.935Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:29:27.935Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:29:27.935Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:29:27.935Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:29:27.935Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:29:27.935Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:29:27.935Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:29:27.935Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:30:26.509Z"
  }
}
[2025-12-15T17:32:26.610Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:32:26.610Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:32:26.610Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:32:26.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:32:26.611Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T17:32:26.611Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-15T17:32:26.611Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T17:32:26.611Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T17:32:26.611Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T17:33:26.611Z"
  }
}
[2025-12-15T17:32:27.215Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T17:32:27.216Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T17:32:27.216Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T17:32:27.216Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T17:32:27.216Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T17:32:27.216Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T17:32:27.217Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T17:32:27.217Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T17:33:26.611Z"
  }
}
[2025-12-15T20:41:04.679Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T20:41:04.680Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T20:41:04.680Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T20:41:04.680Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T20:41:04.680Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-15T20:41:04.680Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T20:41:04.680Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T20:41:04.680Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T20:42:04.680Z"
  }
}
[2025-12-15T20:41:05.292Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T20:41:05.292Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T20:41:05.292Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T20:41:05.292Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T20:41:05.292Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T20:41:05.293Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T20:41:05.293Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T20:41:05.293Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T20:42:04.680Z"
  }
}
[2025-12-15T20:59:52.994Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T20:59:52.994Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T20:59:52.995Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T20:59:52.995Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T20:59:52.995Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-15T20:59:52.995Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-15T20:59:52.995Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-15T20:59:52.995Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-15T21:00:52.995Z"
  }
}
[2025-12-15T20:59:53.683Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T20:59:53.683Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T20:59:53.683Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T20:59:53.683Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T20:59:53.683Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-15T20:59:53.683Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-15T20:59:53.683Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-15T20:59:53.683Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-15T21:00:52.995Z"
  }
}
[2025-12-15T21:00:02.377Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T21:00:02.377Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T21:00:02.377Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T21:00:02.377Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T21:00:02.377Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-15T21:00:02.378Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-15T21:00:02.378Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-15T21:00:02.378Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-15T21:00:52.995Z"
  }
}
[2025-12-15T21:00:03.104Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-15T21:00:03.105Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-15T21:00:03.105Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-15T21:00:03.105Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-15T21:00:03.105Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-15T21:00:03.105Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-15T21:00:03.105Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-15T21:00:03.106Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-15T21:00:52.995Z"
  }
}
[2025-12-16T09:11:37.322Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T09:11:37.323Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T09:11:37.323Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T09:11:37.323Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T09:11:37.323Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T09:11:37.323Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T09:11:37.323Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T09:11:37.323Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T09:12:37.323Z"
  }
}
[2025-12-16T09:11:38.176Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T09:11:38.176Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T09:11:38.177Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T09:11:38.177Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T09:11:38.177Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T09:11:38.177Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T09:11:38.177Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T09:11:38.177Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T09:12:37.323Z"
  }
}
[2025-12-16T09:11:42.259Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T09:11:42.259Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T09:11:42.259Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T09:11:42.259Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T09:11:42.259Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T09:11:42.259Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T09:11:42.259Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T09:11:42.259Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T09:12:37.323Z"
  }
}
[2025-12-16T09:11:42.851Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T09:11:42.851Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T09:11:42.851Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T09:11:42.851Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T09:11:42.852Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T09:11:42.852Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T09:11:42.852Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T09:11:42.852Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T09:12:37.323Z"
  }
}
[2025-12-16T10:35:56.598Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T10:35:56.598Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T10:35:56.598Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T10:35:56.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T10:35:56.598Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T10:35:56.598Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T10:35:56.598Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T10:35:56.598Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T10:36:56.598Z"
  }
}
[2025-12-16T10:35:57.197Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T10:35:57.197Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T10:35:57.197Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T10:35:57.197Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T10:35:57.197Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T10:35:57.198Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T10:35:57.198Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T10:35:57.198Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T10:36:56.598Z"
  }
}
[2025-12-16T11:08:36.276Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:36.276Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:36.277Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:36.277Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:36.277Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T11:08:36.277Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:08:36.277Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:08:36.277Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:36.851Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:36.851Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:36.851Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:36.851Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:36.851Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:08:36.851Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:08:36.851Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:08:36.851Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:41.473Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:41.474Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:41.474Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:41.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:41.474Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:08:41.474Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:08:41.474Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:08:41.474Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:42.046Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:42.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:42.046Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:42.046Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:42.046Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:08:42.046Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:08:42.046Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:08:42.046Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:46.815Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:46.815Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:46.815Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:46.815Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:46.815Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:08:46.815Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:08:46.815Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:08:46.815Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:47.735Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:47.735Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:47.735Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:47.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:47.735Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:08:47.735Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:08:47.735Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:08:47.735Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:50.093Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:50.093Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:50.093Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:50.093Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:50.093Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:08:50.094Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-16T11:08:50.094Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-16T11:08:50.094Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:50.669Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:50.670Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:50.670Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:50.670Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:50.670Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-16T11:08:50.670Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-16T11:08:50.670Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-16T11:08:50.670Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:53.358Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:53.358Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:53.358Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:53.358Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:53.358Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-16T11:08:53.359Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-16T11:08:53.359Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-16T11:08:53.359Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:53.926Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:53.927Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:53.927Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:53.927Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:53.927Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-16T11:08:53.927Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-16T11:08:53.927Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-16T11:08:53.927Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:57.394Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:57.394Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:57.394Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:57.394Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:57.394Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-16T11:08:57.394Z] Current state
{
  "countAfterFilter": 10,
  "maxRequests": 60
}
[2025-12-16T11:08:57.395Z] Request allowed
{
  "newCount": 11,
  "remaining": 49
}
[2025-12-16T11:08:57.395Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 49,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:08:57.954Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:08:57.955Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:08:57.955Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:08:57.955Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:08:57.955Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 11
}
[2025-12-16T11:08:57.955Z] Current state
{
  "countAfterFilter": 11,
  "maxRequests": 60
}
[2025-12-16T11:08:57.955Z] Request allowed
{
  "newCount": 12,
  "remaining": 48
}
[2025-12-16T11:08:57.955Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 48,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:01.820Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:01.820Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:01.820Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:01.820Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:01.820Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 12
}
[2025-12-16T11:09:01.820Z] Current state
{
  "countAfterFilter": 12,
  "maxRequests": 60
}
[2025-12-16T11:09:01.820Z] Request allowed
{
  "newCount": 13,
  "remaining": 47
}
[2025-12-16T11:09:01.820Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 47,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:02.514Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:02.514Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:02.514Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:02.514Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:02.518Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 13
}
[2025-12-16T11:09:02.518Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2025-12-16T11:09:02.518Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2025-12-16T11:09:02.518Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:11.550Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:11.551Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:11.551Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:11.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:11.551Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2025-12-16T11:09:11.551Z] Current state
{
  "countAfterFilter": 14,
  "maxRequests": 60
}
[2025-12-16T11:09:11.551Z] Request allowed
{
  "newCount": 15,
  "remaining": 45
}
[2025-12-16T11:09:11.551Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 45,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:12.114Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:12.115Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:12.115Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:12.115Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:12.115Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 15
}
[2025-12-16T11:09:12.115Z] Current state
{
  "countAfterFilter": 15,
  "maxRequests": 60
}
[2025-12-16T11:09:12.115Z] Request allowed
{
  "newCount": 16,
  "remaining": 44
}
[2025-12-16T11:09:12.115Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 44,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:19.167Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:19.167Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:19.167Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:19.168Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:19.168Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 16
}
[2025-12-16T11:09:19.168Z] Current state
{
  "countAfterFilter": 16,
  "maxRequests": 60
}
[2025-12-16T11:09:19.168Z] Request allowed
{
  "newCount": 17,
  "remaining": 43
}
[2025-12-16T11:09:19.168Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 43,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:19.743Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:19.743Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:19.743Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:19.743Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:19.744Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 17
}
[2025-12-16T11:09:19.745Z] Current state
{
  "countAfterFilter": 17,
  "maxRequests": 60
}
[2025-12-16T11:09:19.745Z] Request allowed
{
  "newCount": 18,
  "remaining": 42
}
[2025-12-16T11:09:19.745Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 42,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:24.394Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:24.394Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:24.395Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:24.395Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:24.395Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 18
}
[2025-12-16T11:09:24.395Z] Current state
{
  "countAfterFilter": 18,
  "maxRequests": 60
}
[2025-12-16T11:09:24.395Z] Request allowed
{
  "newCount": 19,
  "remaining": 41
}
[2025-12-16T11:09:24.395Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 41,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:24.951Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:24.952Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:24.952Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:24.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:24.952Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 19
}
[2025-12-16T11:09:24.952Z] Current state
{
  "countAfterFilter": 19,
  "maxRequests": 60
}
[2025-12-16T11:09:24.952Z] Request allowed
{
  "newCount": 20,
  "remaining": 40
}
[2025-12-16T11:09:24.952Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 40,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:28.880Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:28.880Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:28.880Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:28.880Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:28.880Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 20
}
[2025-12-16T11:09:28.880Z] Current state
{
  "countAfterFilter": 20,
  "maxRequests": 60
}
[2025-12-16T11:09:28.880Z] Request allowed
{
  "newCount": 21,
  "remaining": 39
}
[2025-12-16T11:09:28.880Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 39,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:29.599Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:29.599Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:29.599Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:29.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:29.599Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 21
}
[2025-12-16T11:09:29.599Z] Current state
{
  "countAfterFilter": 21,
  "maxRequests": 60
}
[2025-12-16T11:09:29.599Z] Request allowed
{
  "newCount": 22,
  "remaining": 38
}
[2025-12-16T11:09:29.599Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 38,
    "resetAt": "2025-12-16T11:09:36.277Z"
  }
}
[2025-12-16T11:09:37.716Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:37.716Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:37.716Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:37.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:37.716Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 22
}
[2025-12-16T11:09:37.716Z] Filtered old timestamps
{
  "before": 22,
  "after": 20,
  "removed": 2
}
[2025-12-16T11:09:37.716Z] Current state
{
  "countAfterFilter": 20,
  "maxRequests": 60
}
[2025-12-16T11:09:37.716Z] Request allowed
{
  "newCount": 21,
  "remaining": 39
}
[2025-12-16T11:09:37.716Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 39,
    "resetAt": "2025-12-16T11:09:41.474Z"
  }
}
[2025-12-16T11:09:38.344Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:38.344Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:38.344Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:38.344Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:38.344Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 21
}
[2025-12-16T11:09:38.344Z] Current state
{
  "countAfterFilter": 21,
  "maxRequests": 60
}
[2025-12-16T11:09:38.345Z] Request allowed
{
  "newCount": 22,
  "remaining": 38
}
[2025-12-16T11:09:38.345Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 38,
    "resetAt": "2025-12-16T11:09:41.474Z"
  }
}
[2025-12-16T11:09:52.627Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:52.628Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:52.628Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:52.628Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:52.629Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 22
}
[2025-12-16T11:09:52.629Z] Filtered old timestamps
{
  "before": 22,
  "after": 16,
  "removed": 6
}
[2025-12-16T11:09:52.629Z] Current state
{
  "countAfterFilter": 16,
  "maxRequests": 60
}
[2025-12-16T11:09:52.629Z] Request allowed
{
  "newCount": 17,
  "remaining": 43
}
[2025-12-16T11:09:52.629Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 43,
    "resetAt": "2025-12-16T11:09:53.358Z"
  }
}
[2025-12-16T11:09:53.193Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:09:53.193Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:09:53.193Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:09:53.193Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:09:53.193Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 17
}
[2025-12-16T11:09:53.194Z] Current state
{
  "countAfterFilter": 17,
  "maxRequests": 60
}
[2025-12-16T11:09:53.194Z] Request allowed
{
  "newCount": 18,
  "remaining": 42
}
[2025-12-16T11:09:53.194Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 42,
    "resetAt": "2025-12-16T11:09:53.358Z"
  }
}
[2025-12-16T11:10:21.806Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:21.807Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:21.807Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:21.807Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:21.807Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 18
}
[2025-12-16T11:10:21.807Z] Filtered old timestamps
{
  "before": 18,
  "after": 8,
  "removed": 10
}
[2025-12-16T11:10:21.807Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-16T11:10:21.808Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-16T11:10:21.808Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-16T11:10:24.395Z"
  }
}
[2025-12-16T11:10:22.370Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:22.370Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:22.371Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:22.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:22.371Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-16T11:10:22.371Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-16T11:10:22.371Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-16T11:10:22.371Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-16T11:10:24.395Z"
  }
}
[2025-12-16T11:10:27.862Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:27.862Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:27.862Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:27.863Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:27.863Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-16T11:10:27.863Z] Filtered old timestamps
{
  "before": 10,
  "after": 8,
  "removed": 2
}
[2025-12-16T11:10:27.863Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2025-12-16T11:10:27.863Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2025-12-16T11:10:27.863Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2025-12-16T11:10:28.880Z"
  }
}
[2025-12-16T11:10:28.598Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:28.598Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:28.599Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:28.599Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:28.599Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2025-12-16T11:10:28.599Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2025-12-16T11:10:28.599Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2025-12-16T11:10:28.599Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2025-12-16T11:10:28.880Z"
  }
}
[2025-12-16T11:10:38.338Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:38.340Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:38.340Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:38.340Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:38.341Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2025-12-16T11:10:38.342Z] Filtered old timestamps
{
  "before": 10,
  "after": 7,
  "removed": 3
}
[2025-12-16T11:10:38.342Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-16T11:10:38.342Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-16T11:10:38.342Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-16T11:10:38.344Z"
  }
}
[2025-12-16T11:10:38.912Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:10:38.912Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:10:38.912Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:10:38.912Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:10:38.912Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-16T11:10:38.912Z] Filtered old timestamps
{
  "before": 8,
  "after": 7,
  "removed": 1
}
[2025-12-16T11:10:38.912Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-16T11:10:38.912Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-16T11:10:38.912Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-16T11:10:52.628Z"
  }
}
[2025-12-16T11:11:26.608Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:11:26.608Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:11:26.609Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:11:26.609Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:11:26.609Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-16T11:11:26.609Z] Filtered old timestamps
{
  "before": 8,
  "after": 4,
  "removed": 4
}
[2025-12-16T11:11:26.609Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:11:26.609Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:11:26.609Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:11:27.863Z"
  }
}
[2025-12-16T11:11:27.346Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:11:27.346Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:11:27.346Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:11:27.346Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:11:27.346Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:11:27.346Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:11:27.346Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:11:27.346Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:11:27.863Z"
  }
}
[2025-12-16T11:11:41.702Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:11:41.702Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:11:41.703Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:11:41.703Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:11:41.703Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:11:41.703Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-16T11:11:41.703Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:11:41.703Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:11:41.703Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:12:26.609Z"
  }
}
[2025-12-16T11:11:42.283Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:11:42.284Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:11:42.284Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:11:42.284Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:11:42.285Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:11:42.285Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:11:42.285Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:11:42.285Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:12:26.609Z"
  }
}
[2025-12-16T11:12:01.447Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:12:01.448Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:12:01.448Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:12:01.449Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:12:01.449Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:12:01.449Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:12:01.449Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:12:01.449Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:12:26.609Z"
  }
}
[2025-12-16T11:12:02.011Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:12:02.011Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:12:02.012Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:12:02.012Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:12:02.015Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:12:02.015Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:12:02.015Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:12:02.015Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:12:26.609Z"
  }
}
[2025-12-16T11:12:57.056Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:12:57.056Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:12:57.056Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:12:57.056Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:12:57.056Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:12:57.056Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-16T11:12:57.056Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:12:57.056Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:12:57.056Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:13:01.449Z"
  }
}
[2025-12-16T11:12:57.605Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:12:57.605Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:12:57.606Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:12:57.606Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:12:57.606Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:12:57.606Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:12:57.606Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:12:57.606Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:13:01.449Z"
  }
}
[2025-12-16T11:13:18.524Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:13:18.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:13:18.526Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:13:18.526Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:13:18.526Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:13:18.526Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-16T11:13:18.526Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:13:18.526Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:13:18.526Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:13:57.056Z"
  }
}
[2025-12-16T11:13:19.568Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:13:19.569Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:13:19.569Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:13:19.569Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:13:19.569Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:13:19.569Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:13:19.569Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:13:19.570Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:13:57.056Z"
  }
}
[2025-12-16T11:13:50.971Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:13:50.972Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:13:50.972Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:13:50.972Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:13:50.972Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:13:50.972Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:13:50.972Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:13:50.972Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:13:57.056Z"
  }
}
[2025-12-16T11:13:51.551Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:13:51.552Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:13:51.552Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:13:51.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:13:51.552Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:13:51.552Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:13:51.552Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:13:51.552Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:13:57.056Z"
  }
}
[2025-12-16T11:14:55.473Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:14:55.473Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:14:55.474Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:14:55.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:14:55.474Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:14:55.474Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-16T11:14:55.474Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:14:55.474Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:14:55.474Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:15:55.474Z"
  }
}
[2025-12-16T11:14:56.328Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:14:56.328Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:14:56.329Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:14:56.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:14:56.329Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:14:56.329Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:14:56.329Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:14:56.329Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:15:55.474Z"
  }
}
[2025-12-16T11:14:56.997Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:14:56.997Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:14:56.997Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:14:56.998Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:14:56.998Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:14:56.998Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:14:56.998Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:14:56.998Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:15:55.474Z"
  }
}
[2025-12-16T11:14:57.636Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:14:57.636Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:14:57.636Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:14:57.636Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:14:57.637Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:14:57.637Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:14:57.637Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:14:57.637Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:15:55.474Z"
  }
}
[2025-12-16T11:19:13.926Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:19:13.926Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:19:13.926Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:19:13.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:19:13.926Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:19:13.926Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T11:19:13.926Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:19:13.926Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:19:13.926Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:20:13.926Z"
  }
}
[2025-12-16T11:19:15.083Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:19:15.083Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:19:15.084Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:19:15.084Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:19:15.084Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:19:15.086Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:19:15.087Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:19:15.087Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:20:13.926Z"
  }
}
[2025-12-16T11:23:26.664Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:23:26.665Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:23:26.665Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:23:26.665Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:23:26.665Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:23:26.665Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T11:23:26.665Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:23:26.665Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:23:26.665Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:24:26.665Z"
  }
}
[2025-12-16T11:23:27.238Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:23:27.238Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:23:27.238Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:23:27.238Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:23:27.238Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:23:27.238Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:23:27.238Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:23:27.238Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:24:26.665Z"
  }
}
[2025-12-16T11:24:05.109Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:24:05.110Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:24:05.111Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:24:05.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:24:05.111Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:24:05.111Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:24:05.111Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:24:05.111Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:24:26.665Z"
  }
}
[2025-12-16T11:24:06.161Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:24:06.162Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:24:06.162Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:24:06.162Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:24:06.162Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:24:06.162Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:24:06.163Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:24:06.163Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:24:26.665Z"
  }
}
[2025-12-16T11:24:06.994Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:24:06.995Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:24:06.995Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:24:06.995Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:24:06.995Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:24:06.995Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:24:06.995Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:24:06.995Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:24:26.665Z"
  }
}
[2025-12-16T11:25:36.500Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:25:36.511Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:25:36.513Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:25:36.513Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:25:36.513Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:25:36.513Z] Filtered old timestamps
{
  "before": 5,
  "after": 0,
  "removed": 5
}
[2025-12-16T11:25:36.514Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:25:36.514Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:25:36.514Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:26:36.513Z"
  }
}
[2025-12-16T11:25:37.094Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:25:37.095Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:25:37.095Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:25:37.095Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:25:37.095Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:25:37.096Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:25:37.096Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:25:37.096Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:26:36.513Z"
  }
}
[2025-12-16T11:26:19.681Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:19.682Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:19.683Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:19.683Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:19.683Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:26:19.683Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:26:19.683Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:26:19.683Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:26:36.513Z"
  }
}
[2025-12-16T11:26:20.274Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:20.274Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:20.274Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:20.275Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:20.275Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:26:20.275Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:26:20.275Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:26:20.275Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:26:36.513Z"
  }
}
[2025-12-16T11:26:56.389Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:56.390Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:56.390Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:56.390Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:56.390Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:26:56.390Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-16T11:26:56.391Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:26:56.391Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:26:56.391Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:27:19.683Z"
  }
}
[2025-12-16T11:26:57.423Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:57.423Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:57.423Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:57.423Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:57.423Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:26:57.423Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:26:57.423Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:26:57.423Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:27:19.683Z"
  }
}
[2025-12-16T11:26:58.309Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:58.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:58.309Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:58.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:58.309Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:26:58.309Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:26:58.309Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:26:58.309Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:27:19.683Z"
  }
}
[2025-12-16T11:26:58.907Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:26:58.907Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:26:58.907Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:26:58.907Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:26:58.907Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:26:58.907Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:26:58.907Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:26:58.907Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:27:19.683Z"
  }
}
[2025-12-16T11:27:34.163Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:27:34.163Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:27:34.163Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:27:34.163Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:27:34.163Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:27:34.163Z] Filtered old timestamps
{
  "before": 6,
  "after": 4,
  "removed": 2
}
[2025-12-16T11:27:34.163Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:27:34.163Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:27:34.164Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:27:56.390Z"
  }
}
[2025-12-16T11:27:34.734Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:27:34.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:27:34.735Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:27:34.735Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:27:34.735Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:27:34.735Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:27:34.735Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:27:34.735Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:27:56.390Z"
  }
}
[2025-12-16T11:27:39.338Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:27:39.338Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:27:39.338Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:27:39.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:27:39.338Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T11:27:39.338Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-16T11:27:39.338Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-16T11:27:39.338Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-16T11:27:56.390Z"
  }
}
[2025-12-16T11:27:40.109Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:27:40.109Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:27:40.110Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:27:40.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:27:40.110Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-16T11:27:40.111Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-16T11:27:40.111Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-16T11:27:40.111Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-16T11:27:56.390Z"
  }
}
[2025-12-16T11:28:11.661Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:28:11.662Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:28:11.662Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:28:11.662Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:28:11.662Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-16T11:28:11.662Z] Filtered old timestamps
{
  "before": 8,
  "after": 4,
  "removed": 4
}
[2025-12-16T11:28:11.662Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T11:28:11.662Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T11:28:11.662Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T11:28:34.163Z"
  }
}
[2025-12-16T11:28:12.217Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:28:12.219Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:28:12.219Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:28:12.220Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:28:12.220Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T11:28:12.220Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T11:28:12.220Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T11:28:12.221Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T11:28:34.163Z"
  }
}
[2025-12-16T11:44:07.811Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:44:07.811Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:44:07.812Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:44:07.812Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:44:07.812Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T11:44:07.812Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:44:07.812Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:44:07.812Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:45:07.812Z"
  }
}
[2025-12-16T11:44:08.633Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:44:08.634Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:44:08.634Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:44:08.634Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:44:08.634Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:44:08.634Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:44:08.634Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:44:08.634Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:45:07.812Z"
  }
}
[2025-12-16T11:44:35.517Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:44:35.523Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:44:35.523Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:44:35.523Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:44:35.523Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T11:44:35.523Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T11:44:35.523Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T11:44:35.523Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T11:45:07.812Z"
  }
}
[2025-12-16T11:44:36.081Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:44:36.081Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:44:36.081Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:44:36.081Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:44:36.081Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T11:44:36.081Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T11:44:36.081Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T11:44:36.081Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T11:45:07.812Z"
  }
}
[2025-12-16T11:51:02.329Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:51:02.329Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:51:02.330Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:51:02.330Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:51:02.330Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T11:51:02.330Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T11:51:02.330Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T11:51:02.330Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T11:51:02.330Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T11:52:02.330Z"
  }
}
[2025-12-16T11:51:03.156Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T11:51:03.156Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T11:51:03.156Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T11:51:03.156Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T11:51:03.156Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T11:51:03.156Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T11:51:03.156Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T11:51:03.156Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T11:52:02.330Z"
  }
}
[2025-12-16T12:07:36.616Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:07:36.616Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:07:36.616Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:07:36.616Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:07:36.616Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T12:07:36.617Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T12:07:36.617Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T12:07:36.617Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:07:37.180Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:07:37.181Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:07:37.181Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:07:37.181Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:07:37.181Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T12:07:37.181Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T12:07:37.181Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T12:07:37.181Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:08:13.567Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:08:13.568Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:08:13.568Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:08:13.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:08:13.568Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T12:08:13.568Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T12:08:13.569Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T12:08:13.569Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:08:14.535Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:08:14.535Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:08:14.535Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:08:14.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:08:14.535Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T12:08:14.535Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T12:08:14.536Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T12:08:14.536Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:08:16.026Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:08:16.026Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:08:16.026Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:08:16.026Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:08:16.026Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T12:08:16.026Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-16T12:08:16.026Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-16T12:08:16.026Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:08:16.653Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:08:16.653Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:08:16.653Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:08:16.653Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:08:16.653Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-16T12:08:16.653Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-16T12:08:16.654Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-16T12:08:16.654Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-16T12:08:36.616Z"
  }
}
[2025-12-16T12:18:42.184Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:18:42.184Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:18:42.185Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:18:42.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:18:42.185Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-16T12:18:42.185Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-16T12:18:42.185Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T12:18:42.185Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T12:18:42.185Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T12:19:42.185Z"
  }
}
[2025-12-16T12:18:43.169Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:18:43.170Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:18:43.170Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:18:43.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:18:43.170Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T12:18:43.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T12:18:43.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T12:18:43.170Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T12:19:42.185Z"
  }
}
[2025-12-16T12:30:51.975Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:30:51.975Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:30:51.975Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:30:51.976Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:30:51.976Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T12:30:51.976Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T12:30:51.976Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T12:30:51.976Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T12:30:51.976Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T12:31:51.976Z"
  }
}
[2025-12-16T12:30:52.617Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:30:52.617Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:30:52.617Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:30:52.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:30:52.617Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T12:30:52.618Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T12:30:52.618Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T12:30:52.618Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T12:31:51.976Z"
  }
}
[2025-12-16T12:37:15.217Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:37:15.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:37:15.218Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:37:15.218Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:37:15.218Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T12:37:15.218Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T12:37:15.218Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T12:37:15.218Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T12:37:15.218Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T12:38:15.218Z"
  }
}
[2025-12-16T12:37:15.908Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:37:15.909Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:37:15.909Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:37:15.909Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:37:15.909Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T12:37:15.909Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T12:37:15.909Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T12:37:15.909Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T12:38:15.218Z"
  }
}
[2025-12-16T12:52:25.265Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:52:25.266Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:52:25.266Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:52:25.266Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:52:25.266Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T12:52:25.266Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T12:52:25.266Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T12:52:25.266Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T12:53:25.266Z"
  }
}
[2025-12-16T12:52:26.097Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:52:26.097Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:52:26.097Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:52:26.098Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:52:26.098Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T12:52:26.098Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T12:52:26.098Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T12:52:26.098Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T12:53:25.266Z"
  }
}
[2025-12-16T12:53:24.877Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:53:24.877Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:53:24.877Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:53:24.877Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:53:24.877Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T12:53:24.877Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T12:53:24.877Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T12:53:24.877Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T12:53:25.266Z"
  }
}
[2025-12-16T12:53:25.937Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:53:25.937Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:53:25.937Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:53:25.937Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:53:25.937Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T12:53:25.937Z] Filtered old timestamps
{
  "before": 3,
  "after": 2,
  "removed": 1
}
[2025-12-16T12:53:25.937Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T12:53:25.937Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T12:53:25.938Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T12:53:26.098Z"
  }
}
[2025-12-16T12:53:56.534Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:53:56.535Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:53:56.535Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:53:56.535Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:53:56.535Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T12:53:56.535Z] Filtered old timestamps
{
  "before": 3,
  "after": 2,
  "removed": 1
}
[2025-12-16T12:53:56.535Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T12:53:56.535Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T12:53:56.535Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T12:54:24.877Z"
  }
}
[2025-12-16T12:53:57.363Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T12:53:57.363Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T12:53:57.364Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T12:53:57.364Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T12:53:57.364Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T12:53:57.364Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T12:53:57.364Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T12:53:57.364Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T12:54:24.877Z"
  }
}
[2025-12-16T13:01:35.242Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:01:35.242Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:01:35.242Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:01:35.242Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:01:35.242Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T13:01:35.243Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T13:01:35.243Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T13:01:35.243Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T13:01:35.243Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T13:02:35.242Z"
  }
}
[2025-12-16T13:01:36.061Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:01:36.061Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:01:36.061Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:01:36.061Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:01:36.061Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T13:01:36.061Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T13:01:36.062Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T13:01:36.062Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T13:02:35.242Z"
  }
}
[2025-12-16T13:21:02.739Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:21:02.739Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:21:02.739Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:21:02.739Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:21:02.739Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T13:21:02.740Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T13:21:02.740Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T13:21:02.740Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T13:22:02.739Z"
  }
}
[2025-12-16T13:21:03.317Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:21:03.317Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:21:03.317Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:21:03.317Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:21:03.317Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T13:21:03.317Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T13:21:03.317Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T13:21:03.317Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T13:22:02.739Z"
  }
}
[2025-12-16T13:53:15.100Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:53:15.101Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:53:15.101Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:53:15.101Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:53:15.101Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T13:53:15.101Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T13:53:15.101Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T13:53:15.101Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T13:54:15.101Z"
  }
}
[2025-12-16T13:53:15.948Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T13:53:15.948Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T13:53:15.949Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T13:53:15.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T13:53:15.949Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T13:53:15.949Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T13:53:15.949Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T13:53:15.949Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T13:54:15.101Z"
  }
}
[2025-12-16T14:05:03.738Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:05:03.738Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:05:03.738Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:05:03.738Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:05:03.738Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:05:03.738Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T14:05:03.738Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:05:03.738Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:05:03.738Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:06:03.738Z"
  }
}
[2025-12-16T14:05:04.312Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:05:04.312Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:05:04.312Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:05:04.313Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:05:04.313Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:05:04.313Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:05:04.313Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:05:04.313Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:06:03.738Z"
  }
}
[2025-12-16T14:05:40.487Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:05:40.488Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:05:40.488Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:05:40.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:05:40.488Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:05:40.488Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T14:05:40.488Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T14:05:40.488Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T14:06:03.738Z"
  }
}
[2025-12-16T14:05:41.596Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:05:41.597Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:05:41.597Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:05:41.597Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:05:41.597Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T14:05:41.597Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T14:05:41.597Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T14:05:41.598Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T14:06:03.738Z"
  }
}
[2025-12-16T14:13:26.431Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:13:26.432Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:13:26.432Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:13:26.432Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:13:26.432Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T14:13:26.432Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T14:13:26.432Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:13:26.432Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:13:26.432Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:14:26.432Z"
  }
}
[2025-12-16T14:13:27.296Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:13:27.297Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:13:27.297Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:13:27.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:13:27.298Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:13:27.298Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:13:27.298Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:13:27.298Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:14:26.432Z"
  }
}
[2025-12-16T14:21:19.473Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:21:19.474Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:21:19.474Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:21:19.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:21:19.474Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:21:19.475Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T14:21:19.475Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:21:19.475Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:21:19.475Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:22:19.474Z"
  }
}
[2025-12-16T14:21:20.301Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:21:20.301Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:21:20.301Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:21:20.301Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:21:20.302Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:21:20.302Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:21:20.302Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:21:20.302Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:22:19.474Z"
  }
}
[2025-12-16T14:22:08.123Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:22:08.124Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:22:08.124Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:22:08.124Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:22:08.124Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:22:08.124Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T14:22:08.124Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T14:22:08.124Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T14:22:19.474Z"
  }
}
[2025-12-16T14:22:08.954Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:22:08.955Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:22:08.955Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:22:08.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:22:08.956Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T14:22:08.956Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T14:22:08.956Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T14:22:08.956Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T14:22:19.474Z"
  }
}
[2025-12-16T14:26:23.228Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:26:23.228Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:26:23.228Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:26:23.228Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:26:23.228Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T14:26:23.228Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T14:26:23.228Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:26:23.228Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:26:23.228Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:27:23.228Z"
  }
}
[2025-12-16T14:26:24.061Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:26:24.061Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:26:24.061Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:26:24.061Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:26:24.061Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:26:24.061Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:26:24.061Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:26:24.061Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:27:23.228Z"
  }
}
[2025-12-16T14:26:49.198Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:26:49.200Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:26:49.200Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:26:49.200Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:26:49.200Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:26:49.200Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T14:26:49.200Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T14:26:49.200Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T14:27:23.228Z"
  }
}
[2025-12-16T14:26:50.032Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:26:50.032Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:26:50.032Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:26:50.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:26:50.032Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T14:26:50.032Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T14:26:50.032Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T14:26:50.032Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T14:27:23.228Z"
  }
}
[2025-12-16T14:34:57.517Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:34:57.517Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:34:57.517Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:34:57.517Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:34:57.517Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T14:34:57.517Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T14:34:57.517Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:34:57.517Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:34:57.517Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:35:57.517Z"
  }
}
[2025-12-16T14:34:58.337Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:34:58.337Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:34:58.337Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:34:58.337Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:34:58.337Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:34:58.337Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:34:58.337Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:34:58.337Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:35:57.517Z"
  }
}
[2025-12-16T14:35:18.041Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:35:18.041Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:35:18.041Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:35:18.041Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:35:18.041Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T14:35:18.042Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-16T14:35:18.042Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-16T14:35:18.042Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-16T14:35:57.517Z"
  }
}
[2025-12-16T14:35:19.064Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:35:19.064Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:35:19.065Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:35:19.065Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:35:19.065Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-16T14:35:19.065Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-16T14:35:19.065Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-16T14:35:19.065Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-16T14:35:57.517Z"
  }
}
[2025-12-16T14:39:38.352Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:39:38.352Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:39:38.352Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:39:38.352Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:39:38.352Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-16T14:39:38.352Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-16T14:39:38.352Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T14:39:38.352Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T14:39:38.352Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T14:40:38.352Z"
  }
}
[2025-12-16T14:39:39.185Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T14:39:39.185Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T14:39:39.185Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T14:39:39.185Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T14:39:39.186Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T14:39:39.186Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T14:39:39.186Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T14:39:39.186Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T14:40:38.352Z"
  }
}
[2025-12-16T15:49:46.926Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T15:49:46.926Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T15:49:46.926Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T15:49:46.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T15:49:46.926Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T15:49:46.926Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T15:49:46.926Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T15:49:46.926Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T15:50:46.926Z"
  }
}
[2025-12-16T15:49:48.073Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T15:49:48.074Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T15:49:48.074Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T15:49:48.074Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T15:49:48.074Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T15:49:48.074Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T15:49:48.074Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T15:49:48.074Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T15:50:46.926Z"
  }
}
[2025-12-16T15:50:57.721Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T15:50:57.722Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T15:50:57.722Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T15:50:57.722Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T15:50:57.722Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T15:50:57.722Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T15:50:57.722Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T15:50:57.722Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T15:50:57.722Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T15:51:57.722Z"
  }
}
[2025-12-16T15:50:58.340Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T15:50:58.340Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T15:50:58.341Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T15:50:58.341Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T15:50:58.341Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T15:50:58.341Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T15:50:58.341Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T15:50:58.341Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T15:51:57.722Z"
  }
}
[2025-12-16T16:05:32.013Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:05:32.014Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:05:32.014Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:05:32.014Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:05:32.014Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T16:05:32.014Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T16:05:32.014Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T16:05:32.014Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T16:06:32.014Z"
  }
}
[2025-12-16T16:05:32.596Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:05:32.596Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:05:32.596Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:05:32.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:05:32.596Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T16:05:32.596Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T16:05:32.596Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T16:05:32.596Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T16:06:32.014Z"
  }
}
[2025-12-16T16:23:57.239Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:23:57.240Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:23:57.240Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:23:57.240Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:23:57.240Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-16T16:23:57.240Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T16:23:57.240Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T16:23:57.240Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T16:24:57.240Z"
  }
}
[2025-12-16T16:23:58.118Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:23:58.118Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:23:58.118Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:23:58.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:23:58.118Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T16:23:58.118Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T16:23:58.118Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T16:23:58.118Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T16:24:57.240Z"
  }
}
[2025-12-16T16:31:35.387Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:31:35.387Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:31:35.388Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:31:35.388Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:31:35.388Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-16T16:31:35.388Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-16T16:31:35.388Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T16:31:35.388Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T16:31:35.388Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T16:32:35.388Z"
  }
}
[2025-12-16T16:31:37.281Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:31:37.281Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:31:37.281Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:31:37.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:31:37.281Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T16:31:37.282Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T16:31:37.282Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T16:31:37.282Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T16:32:35.388Z"
  }
}
[2025-12-16T16:45:16.317Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:45:16.317Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:45:16.317Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:45:16.317Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:45:16.317Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T16:45:16.317Z] Filtered old timestamps
{
  "before": 1,
  "after": 0,
  "removed": 1
}
[2025-12-16T16:45:16.317Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-16T16:45:16.317Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-16T16:45:16.317Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-16T16:46:16.317Z"
  }
}
[2025-12-16T16:45:17.192Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-16T16:45:17.192Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-16T16:45:17.193Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-16T16:45:17.193Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-16T16:45:17.193Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-16T16:45:17.193Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-16T16:45:17.193Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-16T16:45:17.193Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-16T16:46:16.317Z"
  }
}
[2025-12-17T06:26:47.120Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:26:47.121Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:26:47.121Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:26:47.121Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:26:47.121Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T06:26:47.121Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T06:26:47.121Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T06:26:47.121Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:26:47.160Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:26:47.160Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:26:47.160Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:26:47.160Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:26:47.160Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T06:26:47.160Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T06:26:47.160Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T06:26:47.160Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:26:48.060Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:26:48.060Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:26:48.060Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:26:48.060Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:26:48.060Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T06:26:48.060Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T06:26:48.060Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T06:26:48.060Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:26:48.654Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:26:48.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:26:48.656Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:26:48.657Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:26:48.657Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T06:26:48.657Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T06:26:48.657Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T06:26:48.658Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:27:13.741Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:27:13.743Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:27:13.743Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:27:13.743Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:27:13.743Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T06:27:13.743Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T06:27:13.743Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T06:27:13.743Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:27:14.579Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:27:14.581Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:27:14.581Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:27:14.581Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:27:14.581Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T06:27:14.581Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T06:27:14.581Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T06:27:14.581Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T06:27:47.121Z"
  }
}
[2025-12-17T06:29:09.930Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:09.931Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:09.931Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:09.931Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:09.931Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T06:29:09.931Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-17T06:29:09.931Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T06:29:09.931Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T06:29:09.931Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:29:10.531Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:10.532Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:10.532Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:10.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:10.533Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T06:29:10.533Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T06:29:10.533Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T06:29:10.533Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:29:30.880Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:30.881Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:30.881Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:30.882Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:30.882Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T06:29:30.882Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T06:29:30.882Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T06:29:30.883Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:29:31.755Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:31.756Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:31.756Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:31.757Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:31.757Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T06:29:31.757Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T06:29:31.757Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T06:29:31.758Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:29:32.561Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:32.562Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:32.562Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:32.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:32.563Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T06:29:32.563Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T06:29:32.563Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T06:29:32.563Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:29:33.178Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:29:33.179Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:29:33.180Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:29:33.180Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:29:33.180Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T06:29:33.181Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T06:29:33.181Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T06:29:33.181Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T06:30:09.931Z"
  }
}
[2025-12-17T06:46:50.976Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:46:50.978Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:46:50.978Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:46:50.978Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:46:50.978Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T06:46:50.978Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T06:46:50.979Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T06:46:50.979Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:46:51.591Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:46:51.591Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:46:51.592Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:46:51.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:46:51.593Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T06:46:51.593Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T06:46:51.593Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T06:46:51.593Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:47:12.783Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:47:12.783Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:47:12.784Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:47:12.784Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:47:12.785Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T06:47:12.785Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T06:47:12.785Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T06:47:12.785Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:47:13.651Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:47:13.652Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:47:13.653Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:47:13.653Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:47:13.653Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T06:47:13.654Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T06:47:13.654Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T06:47:13.654Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:47:14.369Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:47:14.370Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:47:14.370Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:47:14.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:47:14.371Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T06:47:14.371Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T06:47:14.372Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T06:47:14.372Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:47:14.976Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:47:14.976Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:47:14.977Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:47:14.977Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:47:14.978Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T06:47:14.978Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T06:47:14.978Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T06:47:14.979Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T06:47:50.978Z"
  }
}
[2025-12-17T06:51:19.649Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:51:19.649Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:51:19.649Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:51:19.649Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:51:19.649Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T06:51:19.649Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-17T06:51:19.650Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T06:51:19.650Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T06:51:19.650Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T06:52:19.649Z"
  }
}
[2025-12-17T06:51:20.240Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T06:51:20.241Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T06:51:20.241Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T06:51:20.241Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T06:51:20.241Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T06:51:20.241Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T06:51:20.241Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T06:51:20.241Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T06:52:19.649Z"
  }
}
[2025-12-17T07:01:03.132Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T07:01:03.133Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T07:01:03.134Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T07:01:03.134Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T07:01:03.134Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T07:01:03.134Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T07:01:03.134Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T07:01:03.134Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T07:01:03.134Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T07:02:03.134Z"
  }
}
[2025-12-17T07:01:04.005Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T07:01:04.006Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T07:01:04.006Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T07:01:04.006Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T07:01:04.006Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T07:01:04.006Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T07:01:04.007Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T07:01:04.007Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T07:02:03.134Z"
  }
}
[2025-12-17T07:01:04.797Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T07:01:04.797Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T07:01:04.797Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T07:01:04.797Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T07:01:04.797Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T07:01:04.797Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T07:01:04.797Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T07:01:04.797Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T07:02:03.134Z"
  }
}
[2025-12-17T07:01:05.395Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T07:01:05.396Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T07:01:05.397Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T07:01:05.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T07:01:05.397Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T07:01:05.398Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T07:01:05.398Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T07:01:05.398Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T07:02:03.134Z"
  }
}
[2025-12-17T08:44:33.307Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:44:33.308Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:44:33.308Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:44:33.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:44:33.308Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T08:44:33.308Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T08:44:33.308Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T08:44:33.309Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T08:45:33.308Z"
  }
}
[2025-12-17T08:44:33.919Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:44:33.919Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:44:33.919Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:44:33.919Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:44:33.919Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T08:44:33.919Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T08:44:33.919Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T08:44:33.919Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T08:45:33.308Z"
  }
}
[2025-12-17T08:57:06.889Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:57:06.890Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:57:06.890Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:57:06.890Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:57:06.890Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T08:57:06.890Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T08:57:06.890Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T08:57:06.890Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T08:58:06.890Z"
  }
}
[2025-12-17T08:57:07.769Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:57:07.770Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:57:07.770Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:57:07.771Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:57:07.771Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T08:57:07.771Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T08:57:07.772Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T08:57:07.772Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T08:58:06.890Z"
  }
}
[2025-12-17T08:57:08.500Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:57:08.500Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:57:08.501Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:57:08.501Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:57:08.501Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T08:57:08.501Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T08:57:08.501Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T08:57:08.501Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T08:58:06.890Z"
  }
}
[2025-12-17T08:57:09.110Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T08:57:09.110Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T08:57:09.111Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T08:57:09.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T08:57:09.112Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T08:57:09.112Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T08:57:09.113Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T08:57:09.113Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T08:58:06.890Z"
  }
}
[2025-12-17T09:04:37.818Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:04:37.818Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:04:37.818Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:04:37.827Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:04:37.828Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T09:04:37.828Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T09:04:37.828Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:04:37.828Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:04:37.830Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:04:38.432Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:04:38.433Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:04:38.434Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:04:38.434Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:04:38.434Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:04:38.434Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:04:38.435Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:04:38.435Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:05:14.744Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:05:14.745Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:05:14.745Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:05:14.745Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:05:14.745Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:05:14.745Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T09:05:14.746Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T09:05:14.746Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:05:15.620Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:05:15.621Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:05:15.622Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:05:15.622Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:05:15.622Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T09:05:15.622Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T09:05:15.623Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T09:05:15.623Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:05:16.374Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:05:16.374Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:05:16.375Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:05:16.375Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:05:16.375Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T09:05:16.375Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T09:05:16.375Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T09:05:16.375Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:05:17.012Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:05:17.013Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:05:17.013Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:05:17.013Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:05:17.013Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T09:05:17.014Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T09:05:17.014Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T09:05:17.014Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T09:05:37.827Z"
  }
}
[2025-12-17T09:36:54.695Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:36:54.696Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:36:54.696Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:36:54.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:36:54.696Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T09:36:54.696Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:36:54.696Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:36:54.696Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:37:54.696Z"
  }
}
[2025-12-17T09:36:55.567Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:36:55.568Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:36:55.568Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:36:55.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:36:55.568Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:36:55.568Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:36:55.569Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:36:55.569Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:37:54.696Z"
  }
}
[2025-12-17T09:37:24.525Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:37:24.526Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:37:24.526Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:37:24.527Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:37:24.528Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:37:24.528Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T09:37:24.529Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T09:37:24.529Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T09:37:54.696Z"
  }
}
[2025-12-17T09:37:25.407Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:37:25.407Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:37:25.408Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:37:25.408Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:37:25.409Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T09:37:25.409Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T09:37:25.410Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T09:37:25.410Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T09:37:54.696Z"
  }
}
[2025-12-17T09:38:54.881Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:38:54.882Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:38:54.883Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:38:54.884Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:38:54.884Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T09:38:54.884Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T09:38:54.884Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:38:54.884Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:38:54.884Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:39:54.884Z"
  }
}
[2025-12-17T09:38:55.498Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:38:55.498Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:38:55.498Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:38:55.498Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:38:55.498Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:38:55.499Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:38:55.499Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:38:55.499Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:39:54.884Z"
  }
}
[2025-12-17T09:48:28.361Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:48:28.362Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:48:28.362Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:48:28.362Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:48:28.362Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:48:28.362Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T09:48:28.362Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:48:28.362Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:48:28.362Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:49:28.362Z"
  }
}
[2025-12-17T09:48:28.969Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:48:28.970Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:48:28.970Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:48:28.970Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:48:28.970Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:48:28.971Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:48:28.971Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:48:28.971Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:49:28.362Z"
  }
}
[2025-12-17T09:49:22.879Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:49:22.880Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:49:22.880Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:49:22.880Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:49:22.880Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:49:22.880Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T09:49:22.880Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T09:49:22.881Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T09:49:28.362Z"
  }
}
[2025-12-17T09:49:23.769Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:49:23.770Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:49:23.770Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:49:23.770Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:49:23.770Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T09:49:23.770Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T09:49:23.770Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T09:49:23.771Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T09:49:28.362Z"
  }
}
[2025-12-17T09:55:02.706Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:55:02.707Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:55:02.707Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:55:02.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:55:02.707Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T09:55:02.707Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T09:55:02.707Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:55:02.707Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:55:02.707Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:56:02.707Z"
  }
}
[2025-12-17T09:55:03.585Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:55:03.585Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:55:03.586Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:55:03.586Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:55:03.586Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:55:03.586Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:55:03.586Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:55:03.586Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:56:02.707Z"
  }
}
[2025-12-17T09:56:05.412Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:05.413Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:05.413Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:05.413Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:05.413Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:56:05.413Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T09:56:05.413Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:56:05.413Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:56:05.413Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:56:06.275Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:06.275Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:06.275Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:06.275Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:06.275Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:56:06.275Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:56:06.275Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:56:06.275Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:56:30.822Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:30.823Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:30.823Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:30.823Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:30.823Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T09:56:30.823Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T09:56:30.823Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T09:56:30.823Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:56:31.426Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:31.426Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:31.426Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:31.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:31.426Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T09:56:31.426Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T09:56:31.426Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T09:56:31.426Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:56:57.301Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:57.302Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:57.302Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:57.303Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:57.303Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T09:56:57.303Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T09:56:57.303Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T09:56:57.303Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:56:58.169Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:56:58.169Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:56:58.169Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:56:58.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:56:58.169Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T09:56:58.169Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T09:56:58.169Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T09:56:58.169Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T09:57:05.413Z"
  }
}
[2025-12-17T09:58:36.964Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:58:36.965Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:58:36.965Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:58:36.965Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:58:36.965Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T09:58:36.965Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T09:58:36.965Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T09:58:36.965Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T09:59:36.965Z"
  }
}
[2025-12-17T09:58:37.837Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T09:58:37.837Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T09:58:37.838Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T09:58:37.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T09:58:37.838Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T09:58:37.838Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T09:58:37.838Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T09:58:37.838Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T09:59:36.965Z"
  }
}
[2025-12-17T10:00:25.712Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:00:25.714Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:00:25.714Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:00:25.714Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:00:25.714Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T10:00:25.714Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:00:25.714Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:00:25.714Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:01:25.714Z"
  }
}
[2025-12-17T10:00:26.583Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:00:26.583Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:00:26.583Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:00:26.583Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:00:26.584Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:00:26.584Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:00:26.584Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:00:26.584Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:01:25.714Z"
  }
}
[2025-12-17T10:01:16.767Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:01:16.769Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:01:16.769Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:01:16.769Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:01:16.769Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T10:01:16.769Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T10:01:16.769Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T10:01:16.769Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T10:01:25.714Z"
  }
}
[2025-12-17T10:01:17.643Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:01:17.644Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:01:17.644Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:01:17.645Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:01:17.645Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T10:01:17.645Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T10:01:17.645Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T10:01:17.645Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T10:01:25.714Z"
  }
}
[2025-12-17T10:02:30.525Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:02:30.525Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:02:30.525Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:02:30.525Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:02:30.525Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T10:02:30.525Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T10:02:30.525Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:02:30.525Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:02:30.525Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:03:30.525Z"
  }
}
[2025-12-17T10:02:31.652Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:02:31.653Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:02:31.653Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:02:31.654Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:02:31.654Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:02:31.654Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:02:31.654Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:02:31.655Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:03:30.525Z"
  }
}
[2025-12-17T10:04:37.081Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:04:37.081Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:04:37.081Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:04:37.082Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:04:37.082Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T10:04:37.082Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T10:04:37.082Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:04:37.082Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:04:37.082Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:05:37.082Z"
  }
}
[2025-12-17T10:04:37.966Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:04:37.967Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:04:37.967Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:04:37.967Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:04:37.967Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:04:37.967Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:04:37.968Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:04:37.968Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:05:37.082Z"
  }
}
[2025-12-17T10:19:42.096Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:19:42.096Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:19:42.097Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:19:42.097Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:19:42.097Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T10:19:42.097Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:19:42.097Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:19:42.097Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:20:42.097Z"
  }
}
[2025-12-17T10:19:42.708Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:19:42.710Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:19:42.710Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:19:42.710Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:19:42.710Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:19:42.710Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:19:42.710Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:19:42.710Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:20:42.097Z"
  }
}
[2025-12-17T10:21:37.023Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:21:37.023Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:21:37.023Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:21:37.024Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:21:37.024Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T10:21:37.024Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T10:21:37.024Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:21:37.024Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:21:37.024Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:22:37.024Z"
  }
}
[2025-12-17T10:21:37.969Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:21:37.969Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:21:37.969Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:21:37.969Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:21:37.969Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:21:37.969Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:21:37.970Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:21:37.970Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:22:37.024Z"
  }
}
[2025-12-17T10:24:03.305Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:24:03.305Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:24:03.305Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:24:03.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:24:03.306Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T10:24:03.306Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T10:24:03.306Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T10:24:03.306Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T10:24:03.306Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T10:25:03.305Z"
  }
}
[2025-12-17T10:24:04.189Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T10:24:04.189Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T10:24:04.190Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T10:24:04.190Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T10:24:04.190Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T10:24:04.190Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T10:24:04.190Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T10:24:04.190Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T10:25:03.305Z"
  }
}
[2025-12-17T11:05:50.123Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:05:50.123Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:05:50.123Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:05:50.123Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:05:50.123Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T11:05:50.123Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T11:05:50.123Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T11:05:50.123Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T11:06:50.123Z"
  }
}
[2025-12-17T11:05:51.003Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:05:51.004Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:05:51.004Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:05:51.004Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:05:51.004Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T11:05:51.005Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T11:05:51.005Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T11:05:51.005Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T11:06:50.123Z"
  }
}
[2025-12-17T11:06:22.090Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:06:22.091Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:06:22.091Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:06:22.091Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:06:22.091Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T11:06:22.091Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T11:06:22.091Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T11:06:22.091Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T11:06:50.123Z"
  }
}
[2025-12-17T11:06:22.696Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:06:22.696Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:06:22.696Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:06:22.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:06:22.696Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T11:06:22.696Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T11:06:22.696Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T11:06:22.696Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T11:06:50.123Z"
  }
}
[2025-12-17T11:09:16.872Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:09:16.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:09:16.872Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:09:16.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:09:16.873Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T11:09:16.873Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T11:09:16.873Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T11:09:16.873Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T11:09:16.873Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T11:10:16.873Z"
  }
}
[2025-12-17T11:09:19.135Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T11:09:19.135Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T11:09:19.135Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T11:09:19.135Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T11:09:19.135Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T11:09:19.135Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T11:09:19.136Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T11:09:19.136Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T11:10:16.873Z"
  }
}
[2025-12-17T13:15:18.557Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T13:15:18.557Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T13:15:18.557Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T13:15:18.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T13:15:18.557Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T13:15:18.557Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T13:15:18.557Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T13:15:18.558Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T13:16:18.557Z"
  }
}
[2025-12-17T13:15:19.154Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T13:15:19.157Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T13:15:19.157Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T13:15:19.157Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T13:15:19.157Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T13:15:19.157Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T13:15:19.157Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T13:15:19.157Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T13:16:18.557Z"
  }
}
[2025-12-17T14:32:04.560Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:32:04.560Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:32:04.561Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:32:04.561Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:32:04.561Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T14:32:04.561Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T14:32:04.561Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T14:32:04.561Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T14:33:04.561Z"
  }
}
[2025-12-17T14:32:05.156Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:32:05.157Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:32:05.157Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:32:05.157Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:32:05.158Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T14:32:05.158Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T14:32:05.158Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T14:32:05.158Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T14:33:04.561Z"
  }
}
[2025-12-17T14:35:45.295Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:35:45.296Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:35:45.296Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:35:45.296Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:35:45.296Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T14:35:45.296Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T14:35:45.296Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T14:35:45.296Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T14:35:45.296Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T14:36:45.296Z"
  }
}
[2025-12-17T14:35:46.175Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:35:46.176Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:35:46.177Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:35:46.177Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:35:46.178Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T14:35:46.178Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T14:35:46.178Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T14:35:46.178Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T14:36:45.296Z"
  }
}
[2025-12-17T14:35:46.934Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:35:46.934Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:35:46.934Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:35:46.934Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:35:46.934Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T14:35:46.935Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T14:35:46.935Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T14:35:46.935Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T14:36:45.296Z"
  }
}
[2025-12-17T14:35:47.532Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:35:47.533Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:35:47.533Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:35:47.533Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:35:47.533Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T14:35:47.533Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T14:35:47.533Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T14:35:47.533Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T14:36:45.296Z"
  }
}
[2025-12-17T14:45:29.822Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:45:29.823Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:45:29.823Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:45:29.823Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:45:29.823Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T14:45:29.823Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-17T14:45:29.823Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T14:45:29.823Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T14:45:29.823Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T14:46:29.823Z"
  }
}
[2025-12-17T14:45:30.698Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:45:30.698Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:45:30.698Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:45:30.698Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:45:30.698Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T14:45:30.698Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T14:45:30.698Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T14:45:30.698Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T14:46:29.823Z"
  }
}
[2025-12-17T14:46:39.275Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:46:39.276Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:46:39.276Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:46:39.276Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:46:39.277Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T14:46:39.277Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T14:46:39.277Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T14:46:39.277Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T14:46:39.277Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T14:47:39.276Z"
  }
}
[2025-12-17T14:46:40.130Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T14:46:40.130Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T14:46:40.130Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T14:46:40.130Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T14:46:40.130Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T14:46:40.130Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T14:46:40.131Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T14:46:40.131Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T14:47:39.276Z"
  }
}
[2025-12-17T15:24:33.868Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:24:33.869Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:24:33.869Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:24:33.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:24:33.869Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T15:24:33.870Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:24:33.870Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:24:33.870Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:24:34.563Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:24:34.564Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:24:34.565Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:24:34.565Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:24:34.566Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:24:34.566Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:24:34.566Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:24:34.566Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:24:57.957Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:24:57.957Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:24:57.958Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:24:57.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:24:57.959Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T15:24:57.959Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T15:24:57.959Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T15:24:57.960Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:24:58.908Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:24:58.909Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:24:58.910Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:24:58.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:24:58.910Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T15:24:58.911Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T15:24:58.911Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T15:24:58.911Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:24:59.604Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:24:59.604Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:24:59.604Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:24:59.604Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:24:59.604Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T15:24:59.604Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T15:24:59.605Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T15:24:59.605Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:25:00.219Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:25:00.219Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:25:00.220Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:25:00.220Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:25:00.220Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T15:25:00.220Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T15:25:00.220Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T15:25:00.220Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T15:25:33.869Z"
  }
}
[2025-12-17T15:26:39.242Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:26:39.243Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:26:39.243Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:26:39.243Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:26:39.243Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T15:26:39.243Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-17T15:26:39.243Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:26:39.243Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:26:39.243Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:27:39.243Z"
  }
}
[2025-12-17T15:26:40.122Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:26:40.122Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:26:40.122Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:26:40.122Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:26:40.122Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:26:40.123Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:26:40.123Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:26:40.123Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:27:39.243Z"
  }
}
[2025-12-17T15:28:36.638Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:28:36.638Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:28:36.638Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:28:36.638Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:28:36.638Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T15:28:36.638Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T15:28:36.638Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:28:36.638Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:28:36.638Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:29:36.638Z"
  }
}
[2025-12-17T15:28:37.478Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:28:37.478Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:28:37.479Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:28:37.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:28:37.479Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:28:37.479Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:28:37.479Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:28:37.479Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:29:36.638Z"
  }
}
[2025-12-17T15:30:02.898Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:30:02.898Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:30:02.898Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:30:02.898Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:30:02.898Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T15:30:02.898Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T15:30:02.898Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:30:02.899Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:30:02.899Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:31:02.898Z"
  }
}
[2025-12-17T15:30:03.759Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:30:03.759Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:30:03.760Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:30:03.760Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:30:03.760Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:30:03.761Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:30:03.761Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:30:03.761Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:31:02.898Z"
  }
}
[2025-12-17T15:39:59.200Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:39:59.200Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:39:59.200Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:39:59.200Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:39:59.200Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T15:39:59.200Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T15:39:59.200Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:39:59.200Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:39:59.200Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:40:59.200Z"
  }
}
[2025-12-17T15:40:00.063Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:40:00.063Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:40:00.063Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:40:00.063Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:40:00.063Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:40:00.063Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:40:00.063Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:40:00.063Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:40:59.200Z"
  }
}
[2025-12-17T15:53:04.596Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:53:04.596Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:53:04.596Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:53:04.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:53:04.596Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T15:53:04.596Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T15:53:04.596Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T15:53:04.596Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T15:54:04.596Z"
  }
}
[2025-12-17T15:53:05.468Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T15:53:05.469Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T15:53:05.469Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T15:53:05.469Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T15:53:05.469Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T15:53:05.469Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T15:53:05.469Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T15:53:05.469Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T15:54:04.596Z"
  }
}
[2025-12-17T16:04:49.573Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:04:49.574Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:04:49.574Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:04:49.574Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:04:49.574Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T16:04:49.574Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T16:04:49.574Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T16:04:49.574Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T16:04:49.574Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:04:50.441Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:04:50.442Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:04:50.442Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:04:50.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:04:50.442Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T16:04:50.442Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T16:04:50.442Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T16:04:50.442Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:05:38.365Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:05:38.367Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:05:38.367Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:05:38.367Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:05:38.367Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T16:05:38.367Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T16:05:38.367Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T16:05:38.367Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:05:39.232Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:05:39.233Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:05:39.233Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:05:39.233Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:05:39.233Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T16:05:39.233Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T16:05:39.234Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T16:05:39.234Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:05:48.309Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:05:48.309Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:05:48.309Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:05:48.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:05:48.309Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T16:05:48.309Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T16:05:48.309Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T16:05:48.309Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:05:48.914Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:05:48.914Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:05:48.915Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:05:48.915Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:05:48.915Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T16:05:48.915Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T16:05:48.915Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T16:05:48.915Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T16:05:49.574Z"
  }
}
[2025-12-17T16:08:31.289Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:31.291Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:31.291Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:31.291Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:31.291Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T16:08:31.291Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-17T16:08:31.291Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T16:08:31.291Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T16:08:31.291Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:08:32.153Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:32.154Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:32.154Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:32.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:32.154Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T16:08:32.154Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T16:08:32.154Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T16:08:32.154Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:08:47.506Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:47.507Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:47.507Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:47.507Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:47.508Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T16:08:47.508Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T16:08:47.508Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T16:08:47.508Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:08:48.359Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:48.360Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:48.360Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:48.360Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:48.360Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T16:08:48.360Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T16:08:48.360Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T16:08:48.360Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:08:52.961Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:52.962Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:52.962Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:52.962Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:52.962Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T16:08:52.962Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T16:08:52.962Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T16:08:52.962Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:08:53.838Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:08:53.838Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:08:53.838Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:08:53.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:08:53.838Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T16:08:53.838Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T16:08:53.839Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T16:08:53.839Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:09:27.908Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:09:27.908Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:09:27.908Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:09:27.908Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:09:27.908Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T16:09:27.908Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-17T16:09:27.908Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-17T16:09:27.908Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:09:28.763Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:09:28.763Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:09:28.763Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:09:28.763Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:09:28.763Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-17T16:09:28.763Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-17T16:09:28.763Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-17T16:09:28.763Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-17T16:09:31.291Z"
  }
}
[2025-12-17T16:09:33.405Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:09:33.405Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:09:33.405Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:09:33.405Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:09:33.405Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-17T16:09:33.405Z] Filtered old timestamps
{
  "before": 8,
  "after": 6,
  "removed": 2
}
[2025-12-17T16:09:33.405Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-17T16:09:33.405Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-17T16:09:33.405Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-17T16:09:47.507Z"
  }
}
[2025-12-17T16:09:34.272Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:09:34.272Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:09:34.273Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:09:34.273Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:09:34.273Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-17T16:09:34.273Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-17T16:09:34.273Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-17T16:09:34.273Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-17T16:09:47.507Z"
  }
}
[2025-12-17T16:10:10.027Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:10.028Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:10.028Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:10.029Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:10.029Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-17T16:10:10.029Z] Filtered old timestamps
{
  "before": 8,
  "after": 4,
  "removed": 4
}
[2025-12-17T16:10:10.029Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T16:10:10.029Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T16:10:10.029Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T16:10:27.908Z"
  }
}
[2025-12-17T16:10:10.896Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:10.896Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:10.897Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:10.897Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:10.897Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T16:10:10.897Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T16:10:10.897Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T16:10:10.897Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T16:10:27.908Z"
  }
}
[2025-12-17T16:10:44.147Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:44.148Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:44.148Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:44.148Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:44.148Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T16:10:44.148Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-17T16:10:44.148Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T16:10:44.148Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T16:10:44.148Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T16:11:10.028Z"
  }
}
[2025-12-17T16:10:45.018Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:45.018Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:45.018Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:45.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:45.018Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T16:10:45.018Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T16:10:45.018Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T16:10:45.018Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T16:11:10.028Z"
  }
}
[2025-12-17T16:10:57.740Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:57.740Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:57.740Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:57.740Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:57.740Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T16:10:57.740Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T16:10:57.741Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T16:10:57.741Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T16:11:10.028Z"
  }
}
[2025-12-17T16:10:58.610Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:10:58.611Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:10:58.611Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:10:58.611Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:10:58.611Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T16:10:58.611Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T16:10:58.611Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T16:10:58.611Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T16:11:10.028Z"
  }
}
[2025-12-17T16:12:07.098Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:12:07.098Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:12:07.099Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:12:07.099Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:12:07.099Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-17T16:12:07.099Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-17T16:12:07.099Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T16:12:07.099Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T16:12:07.099Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T16:13:07.099Z"
  }
}
[2025-12-17T16:12:07.992Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:12:07.992Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:12:07.993Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:12:07.993Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:12:07.993Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T16:12:07.994Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T16:12:07.994Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T16:12:07.994Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T16:13:07.099Z"
  }
}
[2025-12-17T16:13:11.203Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T16:13:11.203Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T16:13:11.203Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T16:13:11.203Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T16:13:11.203Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T16:13:11.203Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-17T16:13:11.203Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T16:13:11.203Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T16:13:11.203Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T16:14:11.203Z"
  }
}
[2025-12-17T19:11:32.403Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T19:11:32.404Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T19:11:32.404Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T19:11:32.404Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T19:11:32.404Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T19:11:32.404Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T19:11:32.404Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T19:11:32.404Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T19:12:32.404Z"
  }
}
[2025-12-17T19:11:33.353Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T19:11:33.353Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T19:11:33.353Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T19:11:33.354Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T19:11:33.354Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T19:11:33.354Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T19:11:33.354Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T19:11:33.354Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T19:12:32.404Z"
  }
}
[2025-12-17T22:45:07.799Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:07.799Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:07.799Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:07.800Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:07.800Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-17T22:45:07.800Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-17T22:45:07.800Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-17T22:45:07.800Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-17T22:45:09.912Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:09.912Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:09.912Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:09.912Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:09.912Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-17T22:45:09.912Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-17T22:45:09.912Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-17T22:45:09.912Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-17T22:45:10.361Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:10.361Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:10.361Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:10.361Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:10.361Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-17T22:45:10.361Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-17T22:45:10.361Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-17T22:45:10.361Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-17T22:45:11.070Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:11.070Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:11.070Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:11.070Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:11.070Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-17T22:45:11.071Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-17T22:45:11.071Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-17T22:45:11.071Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-17T22:45:19.414Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:19.414Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:19.414Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:19.414Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:19.414Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-17T22:45:19.415Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-17T22:45:19.415Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-17T22:45:19.415Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-17T22:45:20.321Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-17T22:45:20.322Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-17T22:45:20.322Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-17T22:45:20.322Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-17T22:45:20.322Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-17T22:45:20.322Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-17T22:45:20.322Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-17T22:45:20.322Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-17T22:46:07.800Z"
  }
}
[2025-12-18T08:59:58.729Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T08:59:58.730Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T08:59:58.730Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T08:59:58.731Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T08:59:58.731Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T08:59:58.731Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T08:59:58.731Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T08:59:58.731Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T09:00:58.731Z"
  }
}
[2025-12-18T08:59:59.569Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T08:59:59.569Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T08:59:59.569Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T08:59:59.569Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T08:59:59.570Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T08:59:59.570Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T08:59:59.570Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T08:59:59.570Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T09:00:58.731Z"
  }
}
[2025-12-18T09:21:12.157Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:21:12.158Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:21:12.158Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:21:12.158Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:21:12.158Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T09:21:12.158Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T09:21:12.158Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T09:21:12.158Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T09:22:12.158Z"
  }
}
[2025-12-18T09:21:12.802Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:21:12.803Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:21:12.803Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:21:12.803Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:21:12.803Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T09:21:12.803Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T09:21:12.803Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T09:21:12.803Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T09:22:12.158Z"
  }
}
[2025-12-18T09:21:17.750Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:21:17.750Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:21:17.750Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:21:17.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:21:17.750Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T09:21:17.750Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T09:21:17.750Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T09:21:17.750Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T09:22:12.158Z"
  }
}
[2025-12-18T09:21:18.657Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:21:18.657Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:21:18.657Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:21:18.657Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:21:18.657Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T09:21:18.657Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T09:21:18.657Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T09:21:18.657Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T09:22:12.158Z"
  }
}
[2025-12-18T09:40:10.919Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:40:10.921Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:40:10.921Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:40:10.921Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:40:10.921Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T09:40:10.921Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T09:40:10.921Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T09:40:10.921Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T09:41:10.921Z"
  }
}
[2025-12-18T09:40:11.764Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T09:40:11.764Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T09:40:11.764Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T09:40:11.764Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T09:40:11.764Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T09:40:11.764Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T09:40:11.764Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T09:40:11.764Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T09:41:10.921Z"
  }
}
[2025-12-18T10:35:35.650Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:35:35.651Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:35:35.651Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:35:35.653Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:35:35.653Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T10:35:35.653Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T10:35:35.653Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T10:35:35.653Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T10:36:35.653Z"
  }
}
[2025-12-18T10:35:36.501Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:35:36.501Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:35:36.501Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:35:36.502Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:35:36.502Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T10:35:36.502Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T10:35:36.502Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T10:35:36.502Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T10:36:35.653Z"
  }
}
[2025-12-18T10:44:16.278Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:44:16.278Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:44:16.278Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:44:16.278Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:44:16.278Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T10:44:16.278Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T10:44:16.278Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T10:44:16.278Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T10:44:16.278Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T10:45:16.278Z"
  }
}
[2025-12-18T10:44:17.150Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:44:17.151Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:44:17.151Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:44:17.152Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:44:17.152Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T10:44:17.152Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T10:44:17.152Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T10:44:17.152Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T10:45:16.278Z"
  }
}
[2025-12-18T10:50:59.904Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:50:59.905Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:50:59.905Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:50:59.905Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:50:59.906Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T10:50:59.907Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T10:50:59.907Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T10:50:59.907Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T10:50:59.907Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T10:51:59.905Z"
  }
}
[2025-12-18T10:51:00.784Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T10:51:00.785Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T10:51:00.785Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T10:51:00.785Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T10:51:00.785Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T10:51:00.785Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T10:51:00.785Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T10:51:00.785Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T10:51:59.905Z"
  }
}
[2025-12-18T11:43:17.973Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:43:17.975Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:43:17.975Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:43:17.975Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:43:17.975Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T11:43:17.976Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T11:43:17.976Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T11:43:17.976Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T11:44:17.975Z"
  }
}
[2025-12-18T11:43:19.683Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:43:19.683Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:43:19.683Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:43:19.683Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:43:19.683Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T11:43:19.683Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T11:43:19.683Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T11:43:19.683Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T11:44:17.975Z"
  }
}
[2025-12-18T11:44:24.502Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:24.502Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:24.502Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:24.502Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:24.502Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T11:44:24.503Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T11:44:24.503Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T11:44:24.503Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T11:44:24.503Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:44:25.387Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:25.387Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:25.387Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:25.387Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:25.387Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T11:44:25.387Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T11:44:25.387Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T11:44:25.387Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:44:33.313Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:33.313Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:33.314Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:33.314Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:33.314Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T11:44:33.314Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T11:44:33.314Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T11:44:33.314Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:44:34.154Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:34.154Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:34.154Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:34.154Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:34.155Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T11:44:34.155Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T11:44:34.155Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T11:44:34.155Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:44:46.365Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:46.365Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:46.366Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:46.366Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:46.366Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-18T11:44:46.366Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-18T11:44:46.366Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-18T11:44:46.366Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:44:47.222Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:44:47.223Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:44:47.223Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:44:47.223Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:44:47.223Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-18T11:44:47.223Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-18T11:44:47.223Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-18T11:44:47.223Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-18T11:45:24.502Z"
  }
}
[2025-12-18T11:45:41.990Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:45:41.991Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:45:41.991Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:45:41.991Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:45:41.991Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-18T11:45:41.991Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-18T11:45:41.991Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T11:45:41.991Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T11:45:41.991Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T11:45:46.366Z"
  }
}
[2025-12-18T11:45:43.495Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:45:43.496Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:45:43.496Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:45:43.496Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:45:43.496Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T11:45:43.497Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T11:45:43.497Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T11:45:43.497Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T11:45:46.366Z"
  }
}
[2025-12-18T11:45:48.444Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:45:48.444Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:45:48.444Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:45:48.444Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:45:48.444Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-18T11:45:48.444Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-18T11:45:48.444Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T11:45:48.444Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T11:45:48.444Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T11:46:41.991Z"
  }
}
[2025-12-18T11:45:49.197Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:45:49.198Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:45:49.198Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:45:49.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:45:49.198Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T11:45:49.198Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T11:45:49.198Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T11:45:49.198Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T11:46:41.991Z"
  }
}
[2025-12-18T11:46:49.922Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:46:49.922Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:46:49.923Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:46:49.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:46:49.923Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-18T11:46:49.923Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-18T11:46:49.923Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T11:46:49.923Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T11:46:49.923Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T11:47:49.923Z"
  }
}
[2025-12-18T11:46:50.997Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:46:50.997Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:46:50.997Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:46:50.997Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:46:50.997Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T11:46:50.997Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T11:46:50.997Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T11:46:50.997Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T11:47:49.923Z"
  }
}
[2025-12-18T11:47:42.197Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:47:42.198Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:47:42.198Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:47:42.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:47:42.198Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T11:47:42.198Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T11:47:42.198Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T11:47:42.198Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T11:47:49.923Z"
  }
}
[2025-12-18T11:47:43.151Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T11:47:43.152Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T11:47:43.152Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T11:47:43.152Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T11:47:43.152Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T11:47:43.152Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T11:47:43.152Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T11:47:43.152Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T11:47:49.923Z"
  }
}
[2025-12-18T13:08:59.539Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T13:08:59.539Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T13:08:59.539Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T13:08:59.539Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T13:08:59.539Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T13:08:59.539Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T13:08:59.539Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T13:08:59.540Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T13:09:59.539Z"
  }
}
[2025-12-18T13:09:01.919Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T13:09:01.919Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T13:09:01.919Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T13:09:01.919Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T13:09:01.919Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T13:09:01.919Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T13:09:01.919Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T13:09:01.919Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T13:09:59.539Z"
  }
}
[2025-12-18T13:10:07.242Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T13:10:07.243Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T13:10:07.243Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T13:10:07.243Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T13:10:07.243Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T13:10:07.243Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T13:10:07.243Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T13:10:07.243Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T13:10:07.243Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T13:11:07.243Z"
  }
}
[2025-12-18T13:10:08.197Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T13:10:08.197Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T13:10:08.197Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T13:10:08.197Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T13:10:08.197Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T13:10:08.197Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T13:10:08.197Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T13:10:08.197Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T13:11:07.243Z"
  }
}
[2025-12-18T14:02:34.269Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T14:02:34.269Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T14:02:34.270Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T14:02:34.270Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T14:02:34.270Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T14:02:34.270Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T14:02:34.270Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T14:02:34.270Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T14:03:34.270Z"
  }
}
[2025-12-18T14:02:35.282Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T14:02:35.283Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T14:02:35.283Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T14:02:35.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T14:02:35.283Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T14:02:35.283Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T14:02:35.283Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T14:02:35.283Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T14:03:34.270Z"
  }
}
[2025-12-18T15:20:18.708Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:20:18.708Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:20:18.708Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:20:18.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:20:18.708Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T15:20:18.708Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T15:20:18.708Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T15:20:18.708Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T15:21:18.708Z"
  }
}
[2025-12-18T15:20:19.733Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:20:19.734Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:20:19.734Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:20:19.734Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:20:19.735Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T15:20:19.735Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T15:20:19.735Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T15:20:19.735Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T15:21:18.708Z"
  }
}
[2025-12-18T15:28:17.887Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:28:17.888Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:28:17.888Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:28:17.888Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:28:17.888Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T15:28:17.888Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T15:28:17.888Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T15:28:17.888Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T15:28:17.888Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T15:29:17.888Z"
  }
}
[2025-12-18T15:28:18.868Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:28:18.868Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:28:18.868Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:28:18.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:28:18.868Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T15:28:18.869Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T15:28:18.869Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T15:28:18.869Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T15:29:17.888Z"
  }
}
[2025-12-18T15:40:59.633Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:40:59.634Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:40:59.634Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:40:59.634Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:40:59.634Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T15:40:59.634Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T15:40:59.634Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T15:40:59.634Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T15:41:59.634Z"
  }
}
[2025-12-18T15:41:00.687Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:41:00.687Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:41:00.687Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:41:00.687Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:41:00.687Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T15:41:00.687Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T15:41:00.687Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T15:41:00.687Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T15:41:59.634Z"
  }
}
[2025-12-18T15:41:49.461Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:41:49.461Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:41:49.461Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:41:49.461Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:41:49.461Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T15:41:49.461Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T15:41:49.461Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T15:41:49.461Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T15:41:59.634Z"
  }
}
[2025-12-18T15:41:50.319Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:41:50.320Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:41:50.320Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:41:50.320Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:41:50.320Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T15:41:50.320Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T15:41:50.320Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T15:41:50.320Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T15:41:59.634Z"
  }
}
[2025-12-18T15:50:15.612Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:50:15.613Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:50:15.613Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:50:15.613Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:50:15.613Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-18T15:50:15.613Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-18T15:50:15.613Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T15:50:15.613Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T15:50:15.613Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T15:51:15.613Z"
  }
}
[2025-12-18T15:50:16.494Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:50:16.494Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:50:16.494Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:50:16.494Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:50:16.494Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T15:50:16.495Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T15:50:16.495Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T15:50:16.495Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T15:51:15.613Z"
  }
}
[2025-12-18T15:54:00.613Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:54:00.614Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:54:00.614Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:54:00.614Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:54:00.614Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T15:54:00.614Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T15:54:00.614Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T15:54:00.614Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T15:54:00.614Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T15:55:00.614Z"
  }
}
[2025-12-18T15:54:01.579Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T15:54:01.579Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T15:54:01.580Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T15:54:01.580Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T15:54:01.580Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T15:54:01.580Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T15:54:01.580Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T15:54:01.580Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T15:55:00.614Z"
  }
}
[2025-12-18T16:11:41.109Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T16:11:41.111Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T16:11:41.111Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T16:11:41.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T16:11:41.111Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T16:11:41.111Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T16:11:41.111Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T16:11:41.111Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T16:12:41.111Z"
  }
}
[2025-12-18T16:11:42.038Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T16:11:42.038Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T16:11:42.038Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T16:11:42.039Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T16:11:42.039Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T16:11:42.039Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T16:11:42.039Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T16:11:42.039Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T16:12:41.111Z"
  }
}
[2025-12-18T21:11:08.732Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:11:08.733Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:11:08.733Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:11:08.733Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:11:08.733Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-18T21:11:08.733Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T21:11:08.734Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T21:11:08.734Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T21:12:08.733Z"
  }
}
[2025-12-18T21:11:09.893Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:11:09.894Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:11:09.894Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:11:09.894Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:11:09.894Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T21:11:09.894Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T21:11:09.894Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T21:11:09.894Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T21:12:08.733Z"
  }
}
[2025-12-18T21:11:47.873Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:11:47.874Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:11:47.874Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:11:47.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:11:47.874Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T21:11:47.874Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-18T21:11:47.874Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-18T21:11:47.874Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-18T21:12:08.733Z"
  }
}
[2025-12-18T21:11:48.921Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:11:48.921Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:11:48.922Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:11:48.922Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:11:48.922Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-18T21:11:48.922Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-18T21:11:48.922Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-18T21:11:48.922Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-18T21:12:08.733Z"
  }
}
[2025-12-18T21:17:28.496Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:17:28.496Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:17:28.496Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:17:28.496Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:17:28.496Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-18T21:17:28.497Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-18T21:17:28.497Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T21:17:28.497Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T21:17:28.497Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T21:18:28.496Z"
  }
}
[2025-12-18T21:17:29.124Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:17:29.124Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:17:29.124Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:17:29.124Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:17:29.124Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T21:17:29.125Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T21:17:29.125Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T21:17:29.125Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T21:18:28.496Z"
  }
}
[2025-12-18T21:18:32.856Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:18:32.857Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:18:32.857Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:18:32.857Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:18:32.857Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T21:18:32.857Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T21:18:32.857Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T21:18:32.857Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T21:18:32.857Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T21:19:32.857Z"
  }
}
[2025-12-18T21:18:33.942Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:18:33.942Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:18:33.942Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:18:33.942Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:18:33.942Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T21:18:33.942Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T21:18:33.942Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T21:18:33.942Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T21:19:32.857Z"
  }
}
[2025-12-18T21:27:01.233Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:27:01.234Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:27:01.234Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:27:01.234Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:27:01.235Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-18T21:27:01.235Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-18T21:27:01.235Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-18T21:27:01.235Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-18T21:27:01.235Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-18T21:28:01.234Z"
  }
}
[2025-12-18T21:27:02.009Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-18T21:27:02.012Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-18T21:27:02.017Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-18T21:27:02.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-18T21:27:02.018Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-18T21:27:02.018Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-18T21:27:02.018Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-18T21:27:02.018Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-18T21:28:01.234Z"
  }
}
[2025-12-19T08:35:06.457Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T08:35:06.457Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T08:35:06.457Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T08:35:06.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T08:35:06.458Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T08:35:06.458Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T08:35:06.458Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T08:35:06.458Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T08:36:06.458Z"
  }
}
[2025-12-19T08:35:07.339Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T08:35:07.339Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T08:35:07.339Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T08:35:07.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T08:35:07.340Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T08:35:07.340Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T08:35:07.340Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T08:35:07.340Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T08:36:06.458Z"
  }
}
[2025-12-19T10:20:33.997Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:20:33.997Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:20:33.997Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:20:33.997Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:20:33.997Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T10:20:33.997Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T10:20:33.997Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T10:20:33.997Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T10:21:33.997Z"
  }
}
[2025-12-19T10:20:34.919Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:20:34.920Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:20:34.920Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:20:34.920Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:20:34.920Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T10:20:34.921Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T10:20:34.921Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T10:20:34.921Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T10:21:33.997Z"
  }
}
[2025-12-19T10:22:57.043Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:22:57.044Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:22:57.044Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:22:57.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:22:57.044Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T10:22:57.044Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T10:22:57.044Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T10:22:57.044Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T10:22:57.044Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T10:23:57.044Z"
  }
}
[2025-12-19T10:22:57.994Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:22:57.994Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:22:57.995Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:22:57.995Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:22:57.995Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T10:22:57.995Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T10:22:57.995Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T10:22:57.996Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T10:23:57.044Z"
  }
}
[2025-12-19T10:26:15.432Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:26:15.432Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:26:15.432Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:26:15.432Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:26:15.433Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T10:26:15.433Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T10:26:15.433Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T10:26:15.433Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T10:26:15.433Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T10:27:15.432Z"
  }
}
[2025-12-19T10:26:16.358Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:26:16.358Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:26:16.359Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:26:16.359Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:26:16.359Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T10:26:16.359Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T10:26:16.359Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T10:26:16.359Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T10:27:15.432Z"
  }
}
[2025-12-19T10:26:31.762Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:26:31.762Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:26:31.762Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:26:31.762Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:26:31.763Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T10:26:31.763Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-19T10:26:31.763Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-19T10:26:31.763Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-19T10:27:15.432Z"
  }
}
[2025-12-19T10:26:32.674Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:26:32.675Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:26:32.676Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:26:32.676Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:26:32.676Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-19T10:26:32.676Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-19T10:26:32.676Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-19T10:26:32.676Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-19T10:27:15.432Z"
  }
}
[2025-12-19T10:45:30.462Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:45:30.462Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:45:30.462Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:45:30.462Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:45:30.462Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T10:45:30.462Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T10:45:30.462Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T10:45:30.462Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T10:46:30.462Z"
  }
}
[2025-12-19T10:45:31.400Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:45:31.400Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:45:31.400Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:45:31.400Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:45:31.400Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T10:45:31.401Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T10:45:31.401Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T10:45:31.401Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T10:46:30.462Z"
  }
}
[2025-12-19T10:47:14.252Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:47:14.254Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:47:14.254Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:47:14.254Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:47:14.255Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T10:47:14.255Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T10:47:14.255Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T10:47:14.255Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T10:47:14.255Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T10:48:14.254Z"
  }
}
[2025-12-19T10:47:15.199Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T10:47:15.199Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T10:47:15.199Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T10:47:15.199Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T10:47:15.199Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T10:47:15.199Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T10:47:15.200Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T10:47:15.200Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T10:48:14.254Z"
  }
}
[2025-12-19T11:03:26.823Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T11:03:26.823Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T11:03:26.823Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T11:03:26.823Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T11:03:26.823Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T11:03:26.823Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T11:03:26.824Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T11:03:26.824Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T11:04:26.823Z"
  }
}
[2025-12-19T11:03:27.716Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T11:03:27.716Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T11:03:27.716Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T11:03:27.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T11:03:27.716Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T11:03:27.716Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T11:03:27.716Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T11:03:27.716Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T11:04:26.823Z"
  }
}
[2025-12-19T11:06:40.748Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T11:06:40.748Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T11:06:40.748Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T11:06:40.748Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T11:06:40.748Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T11:06:40.748Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T11:06:40.748Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T11:06:40.748Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T11:06:40.748Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T11:07:40.748Z"
  }
}
[2025-12-19T11:06:41.673Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T11:06:41.673Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T11:06:41.673Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T11:06:41.673Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T11:06:41.674Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T11:06:41.674Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T11:06:41.674Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T11:06:41.674Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T11:07:40.748Z"
  }
}
[2025-12-19T12:55:40.022Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T12:55:40.022Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T12:55:40.022Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T12:55:40.023Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T12:55:40.023Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T12:55:40.023Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T12:55:40.023Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T12:55:40.023Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T12:56:40.023Z"
  }
}
[2025-12-19T12:55:40.957Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T12:55:40.958Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T12:55:40.958Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T12:55:40.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T12:55:40.959Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T12:55:40.959Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T12:55:40.959Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T12:55:40.959Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T12:56:40.023Z"
  }
}
[2025-12-19T13:24:35.999Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:24:36.000Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:24:36.000Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:24:36.000Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:24:36.000Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T13:24:36.000Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T13:24:36.000Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T13:24:36.000Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T13:25:36.000Z"
  }
}
[2025-12-19T13:24:36.874Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:24:36.875Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:24:36.875Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:24:36.875Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:24:36.875Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T13:24:36.875Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T13:24:36.876Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T13:24:36.876Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T13:25:36.000Z"
  }
}
[2025-12-19T13:36:56.897Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:36:56.898Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:36:56.898Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:36:56.898Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:36:56.898Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T13:36:56.898Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T13:36:56.898Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T13:36:56.898Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T13:37:56.898Z"
  }
}
[2025-12-19T13:36:57.887Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:36:57.888Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:36:57.888Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:36:57.889Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:36:57.889Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T13:36:57.889Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T13:36:57.889Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T13:36:57.889Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T13:37:56.898Z"
  }
}
[2025-12-19T13:42:07.974Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:42:07.975Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:42:07.975Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:42:07.975Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:42:07.975Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T13:42:07.975Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T13:42:07.975Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T13:42:07.975Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T13:42:07.975Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T13:43:07.975Z"
  }
}
[2025-12-19T13:42:08.886Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:42:08.886Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:42:08.886Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:42:08.886Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:42:08.886Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T13:42:08.886Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T13:42:08.887Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T13:42:08.887Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T13:43:07.975Z"
  }
}
[2025-12-19T13:47:01.324Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:47:01.325Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:47:01.325Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:47:01.325Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:47:01.325Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T13:47:01.325Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T13:47:01.325Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T13:47:01.325Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T13:47:01.325Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T13:48:01.325Z"
  }
}
[2025-12-19T13:47:02.347Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T13:47:02.348Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T13:47:02.348Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T13:47:02.348Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T13:47:02.348Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T13:47:02.348Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T13:47:02.348Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T13:47:02.348Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T13:48:01.325Z"
  }
}
[2025-12-19T14:31:57.821Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:31:57.821Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:31:57.821Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:31:57.821Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:31:57.821Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T14:31:57.821Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:31:57.821Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:31:57.821Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:32:57.821Z"
  }
}
[2025-12-19T14:31:59.563Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:31:59.563Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:31:59.563Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:31:59.564Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:31:59.564Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:31:59.564Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:31:59.564Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:31:59.564Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:32:57.821Z"
  }
}
[2025-12-19T14:32:01.792Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:32:01.792Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:32:01.792Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:32:01.792Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:32:01.792Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:32:01.793Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-19T14:32:01.793Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-19T14:32:01.793Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-19T14:32:57.821Z"
  }
}
[2025-12-19T14:32:02.527Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:32:02.528Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:32:02.528Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:32:02.528Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:32:02.528Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-19T14:32:02.528Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-19T14:32:02.528Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-19T14:32:02.528Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-19T14:32:57.821Z"
  }
}
[2025-12-19T14:38:34.511Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:38:34.511Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:38:34.512Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:38:34.512Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:38:34.512Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-19T14:38:34.512Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-19T14:38:34.512Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:38:34.512Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:38:34.512Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:39:34.512Z"
  }
}
[2025-12-19T14:38:35.518Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:38:35.518Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:38:35.518Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:38:35.519Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:38:35.519Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:38:35.519Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:38:35.519Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:38:35.519Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:39:34.512Z"
  }
}
[2025-12-19T14:40:00.247Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:40:00.247Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:40:00.247Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:40:00.247Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:40:00.247Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:40:00.247Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T14:40:00.248Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:40:00.248Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:40:00.248Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:41:00.247Z"
  }
}
[2025-12-19T14:40:01.290Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:40:01.290Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:40:01.290Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:40:01.291Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:40:01.291Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:40:01.291Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:40:01.291Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:40:01.291Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:41:00.247Z"
  }
}
[2025-12-19T14:41:08.768Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:41:08.768Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:41:08.768Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:41:08.768Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:41:08.768Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:41:08.768Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T14:41:08.769Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:41:08.769Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:41:08.769Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:42:08.768Z"
  }
}
[2025-12-19T14:41:09.789Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:41:09.789Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:41:09.789Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:41:09.789Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:41:09.789Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:41:09.789Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:41:09.789Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:41:09.789Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:42:08.768Z"
  }
}
[2025-12-19T14:47:41.870Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:47:41.871Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:47:41.871Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:47:41.871Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:47:41.871Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:47:41.871Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T14:47:41.871Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:47:41.871Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:47:41.871Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:48:41.871Z"
  }
}
[2025-12-19T14:47:42.871Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:47:42.871Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:47:42.871Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:47:42.871Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:47:42.871Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:47:42.871Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:47:42.871Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:47:42.871Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:48:41.871Z"
  }
}
[2025-12-19T14:50:31.561Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:50:31.562Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:50:31.563Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:50:31.563Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:50:31.563Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:50:31.563Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T14:50:31.563Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:50:31.563Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:50:31.563Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:50:32.550Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:50:32.550Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:50:32.550Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:50:32.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:50:32.553Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:50:32.553Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:50:32.553Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:50:32.553Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:50:49.381Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:50:49.381Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:50:49.381Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:50:49.381Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:50:49.381Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:50:49.381Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-19T14:50:49.381Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-19T14:50:49.381Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:50:50.372Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:50:50.372Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:50:50.372Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:50:50.372Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:50:50.372Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-19T14:50:50.372Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-19T14:50:50.372Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-19T14:50:50.372Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:51:14.361Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:51:14.362Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:51:14.362Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:51:14.362Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:51:14.362Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-19T14:51:14.362Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-19T14:51:14.362Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-19T14:51:14.362Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:51:15.230Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:51:15.230Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:51:15.230Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:51:15.230Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:51:15.230Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-19T14:51:15.230Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-19T14:51:15.230Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-19T14:51:15.230Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-19T14:51:31.563Z"
  }
}
[2025-12-19T14:57:19.220Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:57:19.220Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:57:19.220Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:57:19.220Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:57:19.220Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-19T14:57:19.220Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-19T14:57:19.220Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T14:57:19.220Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T14:57:19.220Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T14:58:19.220Z"
  }
}
[2025-12-19T14:57:20.101Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:57:20.101Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:57:20.102Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:57:20.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:57:20.102Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T14:57:20.102Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T14:57:20.102Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T14:57:20.102Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T14:58:19.220Z"
  }
}
[2025-12-19T14:57:37.369Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:57:37.369Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:57:37.371Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:57:37.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:57:37.371Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T14:57:37.371Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-19T14:57:37.371Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-19T14:57:37.371Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-19T14:58:19.220Z"
  }
}
[2025-12-19T14:57:38.377Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T14:57:38.377Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T14:57:38.378Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T14:57:38.378Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T14:57:38.378Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-19T14:57:38.378Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-19T14:57:38.378Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-19T14:57:38.378Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-19T14:58:19.220Z"
  }
}
[2025-12-19T15:11:39.735Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:11:39.736Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:11:39.736Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:11:39.737Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:11:39.737Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T15:11:39.737Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T15:11:39.737Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T15:11:39.737Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T15:12:39.737Z"
  }
}
[2025-12-19T15:11:40.752Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:11:40.753Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:11:40.753Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:11:40.753Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:11:40.753Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T15:11:40.753Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T15:11:40.753Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T15:11:40.753Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T15:12:39.737Z"
  }
}
[2025-12-19T15:12:15.622Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:12:15.623Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:12:15.623Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:12:15.623Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:12:15.623Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T15:12:15.623Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-19T15:12:15.623Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-19T15:12:15.623Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-19T15:12:39.737Z"
  }
}
[2025-12-19T15:12:16.510Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:12:16.510Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:12:16.510Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:12:16.510Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:12:16.511Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-19T15:12:16.511Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-19T15:12:16.511Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-19T15:12:16.511Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-19T15:12:39.737Z"
  }
}
[2025-12-19T15:14:54.427Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:14:54.427Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:14:54.427Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:14:54.427Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:14:54.427Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-19T15:14:54.427Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-19T15:14:54.427Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T15:14:54.427Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T15:14:54.427Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T15:15:54.427Z"
  }
}
[2025-12-19T15:14:55.325Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T15:14:55.326Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T15:14:55.326Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T15:14:55.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T15:14:55.326Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T15:14:55.326Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T15:14:55.326Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T15:14:55.326Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T15:15:54.427Z"
  }
}
[2025-12-19T18:04:26.547Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:04:26.548Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:04:26.548Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:04:26.549Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:04:26.549Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T18:04:26.549Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T18:04:26.549Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T18:04:26.550Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T18:05:26.549Z"
  }
}
[2025-12-19T18:04:27.656Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:04:27.656Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:04:27.657Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:04:27.657Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:04:27.657Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T18:04:27.657Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T18:04:27.657Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T18:04:27.657Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T18:05:26.549Z"
  }
}
[2025-12-19T18:05:31.383Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:05:31.384Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:05:31.384Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:05:31.384Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:05:31.384Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-19T18:05:31.384Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-19T18:05:31.384Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T18:05:31.384Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T18:05:31.384Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T18:06:31.384Z"
  }
}
[2025-12-19T18:05:32.289Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:05:32.290Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:05:32.290Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:05:32.290Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:05:32.290Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T18:05:32.290Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T18:05:32.290Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T18:05:32.290Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T18:06:31.384Z"
  }
}
[2025-12-19T18:20:40.011Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:20:40.013Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:20:40.013Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:20:40.013Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:20:40.013Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T18:20:40.013Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T18:20:40.013Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T18:20:40.013Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T18:21:40.013Z"
  }
}
[2025-12-19T18:20:40.915Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T18:20:40.915Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T18:20:40.915Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T18:20:40.915Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T18:20:40.916Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T18:20:40.916Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T18:20:40.916Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T18:20:40.916Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T18:21:40.013Z"
  }
}
[2025-12-19T22:29:37.104Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T22:29:37.106Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T22:29:37.106Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T22:29:37.106Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T22:29:37.106Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-19T22:29:37.106Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-19T22:29:37.106Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-19T22:29:37.106Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-19T22:30:37.106Z"
  }
}
[2025-12-19T22:29:38.001Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-19T22:29:38.001Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-19T22:29:38.001Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-19T22:29:38.002Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-19T22:29:38.002Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-19T22:29:38.002Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-19T22:29:38.002Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-19T22:29:38.002Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-19T22:30:37.106Z"
  }
}
[2025-12-20T06:41:57.385Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T06:41:57.385Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T06:41:57.386Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T06:41:57.386Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T06:41:57.386Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T06:41:57.386Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T06:41:57.386Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T06:41:57.386Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T06:42:57.386Z"
  }
}
[2025-12-20T06:41:58.373Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T06:41:58.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T06:41:58.374Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T06:41:58.374Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T06:41:58.374Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T06:41:58.374Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T06:41:58.374Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T06:41:58.374Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T06:42:57.386Z"
  }
}
[2025-12-20T06:44:55.263Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T06:44:55.263Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T06:44:55.263Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T06:44:55.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T06:44:55.263Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T06:44:55.263Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T06:44:55.263Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T06:44:55.263Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T06:44:55.263Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T06:45:55.263Z"
  }
}
[2025-12-20T06:44:56.170Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T06:44:56.170Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T06:44:56.170Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T06:44:56.170Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T06:44:56.170Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T06:44:56.170Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T06:44:56.170Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T06:44:56.171Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T06:45:55.263Z"
  }
}
[2025-12-20T08:34:48.692Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T08:34:48.692Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T08:34:48.693Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T08:34:48.693Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T08:34:48.693Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T08:34:48.693Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T08:34:48.694Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T08:34:48.694Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T08:35:48.693Z"
  }
}
[2025-12-20T08:34:49.583Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T08:34:49.593Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T08:34:49.593Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T08:34:49.593Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T08:34:49.594Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T08:34:49.594Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T08:34:49.594Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T08:34:49.594Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T08:35:48.693Z"
  }
}
[2025-12-20T12:46:33.927Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T12:46:33.928Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T12:46:33.929Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T12:46:33.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T12:46:33.929Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T12:46:33.929Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T12:46:33.929Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T12:46:33.929Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T12:47:33.929Z"
  }
}
[2025-12-20T12:46:34.886Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T12:46:34.886Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T12:46:34.887Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T12:46:34.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T12:46:34.887Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T12:46:34.887Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T12:46:34.887Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T12:46:34.887Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T12:47:33.929Z"
  }
}
[2025-12-20T13:27:34.855Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:27:34.855Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:27:34.856Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:27:34.856Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:27:34.856Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T13:27:34.856Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:27:34.856Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:27:34.856Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:28:34.856Z"
  }
}
[2025-12-20T13:27:35.872Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:27:35.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:27:35.872Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:27:35.872Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:27:35.872Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:27:35.873Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:27:35.873Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:27:35.873Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:28:34.856Z"
  }
}
[2025-12-20T13:28:36.340Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:28:36.341Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:28:36.341Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:28:36.341Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:28:36.341Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T13:28:36.341Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T13:28:36.341Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:28:36.341Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:28:36.341Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:29:36.341Z"
  }
}
[2025-12-20T13:28:37.338Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:28:37.339Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:28:37.339Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:28:37.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:28:37.339Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:28:37.339Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:28:37.339Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:28:37.339Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:29:36.341Z"
  }
}
[2025-12-20T13:30:30.109Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:30:30.111Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:30:30.111Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:30:30.111Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:30:30.111Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T13:30:30.111Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T13:30:30.111Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:30:30.112Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:30:30.112Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:31:30.111Z"
  }
}
[2025-12-20T13:30:31.063Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:30:31.063Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:30:31.064Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:30:31.064Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:30:31.064Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:30:31.064Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:30:31.064Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:30:31.064Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:31:30.111Z"
  }
}
[2025-12-20T13:32:06.133Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:32:06.133Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:32:06.134Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:32:06.134Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:32:06.134Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T13:32:06.134Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T13:32:06.134Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:32:06.134Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:32:06.134Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:33:06.134Z"
  }
}
[2025-12-20T13:32:07.183Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:32:07.183Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:32:07.184Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:32:07.184Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:32:07.184Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:32:07.184Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:32:07.184Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:32:07.184Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:33:06.134Z"
  }
}
[2025-12-20T13:36:24.170Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:36:24.172Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:36:24.172Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:36:24.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:36:24.172Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T13:36:24.172Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T13:36:24.172Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:36:24.172Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:36:24.172Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:37:24.172Z"
  }
}
[2025-12-20T13:36:25.204Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:36:25.204Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:36:25.205Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:36:25.205Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:36:25.205Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:36:25.205Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:36:25.205Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:36:25.205Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:37:24.172Z"
  }
}
[2025-12-20T13:37:31.365Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:37:31.367Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:37:31.367Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:37:31.367Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:37:31.367Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T13:37:31.367Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T13:37:31.368Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T13:37:31.368Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T13:37:31.368Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T13:38:31.367Z"
  }
}
[2025-12-20T13:37:32.258Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T13:37:32.259Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T13:37:32.259Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T13:37:32.259Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T13:37:32.259Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T13:37:32.260Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T13:37:32.260Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T13:37:32.260Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T13:38:31.367Z"
  }
}
[2025-12-20T14:14:51.436Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:14:51.436Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:14:51.436Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:14:51.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:14:51.436Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T14:14:51.436Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:14:51.436Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:14:51.437Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:14:52.493Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:14:52.493Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:14:52.493Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:14:52.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:14:52.493Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T14:14:52.493Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T14:14:52.493Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T14:14:52.493Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:15:03.851Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:15:03.851Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:15:03.852Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:15:03.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:15:03.852Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T14:15:03.852Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:15:03.852Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:15:03.852Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:15:04.890Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:15:04.890Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:15:04.890Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:15:04.890Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:15:04.890Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:15:04.890Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T14:15:04.890Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T14:15:04.890Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:15:17.171Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:15:17.171Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:15:17.171Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:15:17.171Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:15:17.172Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T14:15:17.172Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-20T14:15:17.172Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-20T14:15:17.172Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:15:18.178Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:15:18.178Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:15:18.178Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:15:18.178Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:15:18.178Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-20T14:15:18.178Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-20T14:15:18.179Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-20T14:15:18.179Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-20T14:15:51.436Z"
  }
}
[2025-12-20T14:16:14.735Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:16:14.736Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:16:14.737Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:16:14.737Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:16:14.737Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-20T14:16:14.737Z] Filtered old timestamps
{
  "before": 6,
  "after": 2,
  "removed": 4
}
[2025-12-20T14:16:14.737Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:16:14.737Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:16:14.737Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:16:17.171Z"
  }
}
[2025-12-20T14:16:15.783Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:16:15.784Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:16:15.784Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:16:15.784Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:16:15.785Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:16:15.785Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T14:16:15.785Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T14:16:15.785Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T14:16:17.171Z"
  }
}
[2025-12-20T14:16:32.558Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:16:32.558Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:16:32.558Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:16:32.558Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:16:32.559Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T14:16:32.559Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-20T14:16:32.559Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:16:32.559Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:16:32.559Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:17:14.737Z"
  }
}
[2025-12-20T14:16:33.609Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:16:33.610Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:16:33.610Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:16:33.610Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:16:33.610Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:16:33.610Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T14:16:33.610Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T14:16:33.611Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T14:17:14.737Z"
  }
}
[2025-12-20T14:17:02.195Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:17:02.195Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:17:02.196Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:17:02.196Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:17:02.196Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T14:17:02.196Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-20T14:17:02.196Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-20T14:17:02.196Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-20T14:17:14.737Z"
  }
}
[2025-12-20T14:17:03.093Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:17:03.093Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:17:03.094Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:17:03.094Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:17:03.094Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-20T14:17:03.094Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-20T14:17:03.094Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-20T14:17:03.094Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-20T14:17:14.737Z"
  }
}
[2025-12-20T14:21:55.894Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:21:55.895Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:21:55.895Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:21:55.895Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:21:55.895Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-20T14:21:55.895Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2025-12-20T14:21:55.895Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:21:55.895Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:21:55.895Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:22:55.895Z"
  }
}
[2025-12-20T14:21:56.940Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:21:56.940Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:21:56.940Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:21:56.940Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:21:56.941Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T14:21:56.941Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T14:21:56.941Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T14:21:56.941Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T14:22:55.895Z"
  }
}
[2025-12-20T14:26:47.289Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:26:47.290Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:26:47.290Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:26:47.290Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:26:47.290Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T14:26:47.290Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T14:26:47.290Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:26:47.290Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:26:47.290Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:27:47.290Z"
  }
}
[2025-12-20T14:26:48.484Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:26:48.484Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:26:48.485Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:26:48.485Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:26:48.485Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T14:26:48.485Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T14:26:48.485Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T14:26:48.485Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T14:27:47.290Z"
  }
}
[2025-12-20T14:27:31.696Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:27:31.696Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:27:31.696Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:27:31.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:27:31.696Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T14:27:31.696Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:27:31.696Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:27:31.696Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:27:47.290Z"
  }
}
[2025-12-20T14:29:25.453Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:29:25.454Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:29:25.454Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:29:25.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:29:25.454Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:29:25.454Z] Filtered old timestamps
{
  "before": 3,
  "after": 0,
  "removed": 3
}
[2025-12-20T14:29:25.454Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:29:25.454Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:29:25.454Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:30:25.454Z"
  }
}
[2025-12-20T14:47:47.056Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:47:47.057Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:47:47.057Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:47:47.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:47:47.057Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T14:47:47.057Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:47:47.057Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:47:47.057Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:48:47.057Z"
  }
}
[2025-12-20T14:47:48.052Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:47:48.052Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:47:48.052Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:47:48.052Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:47:48.052Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T14:47:48.052Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T14:47:48.052Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T14:47:48.052Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T14:48:47.057Z"
  }
}
[2025-12-20T14:48:37.976Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:48:37.977Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:48:37.977Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:48:37.977Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:48:37.977Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T14:48:37.977Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:48:37.977Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:48:37.977Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:48:47.057Z"
  }
}
[2025-12-20T14:48:39.009Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:48:39.009Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:48:39.010Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:48:39.010Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:48:39.010Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:48:39.010Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T14:48:39.010Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T14:48:39.010Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T14:48:47.057Z"
  }
}
[2025-12-20T14:52:50.093Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:52:50.094Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:52:50.094Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:52:50.094Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:52:50.094Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T14:52:50.094Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T14:52:50.094Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T14:52:50.094Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T14:52:50.094Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T14:53:50.094Z"
  }
}
[2025-12-20T14:52:51.139Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:52:51.140Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:52:51.140Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:52:51.140Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:52:51.140Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T14:52:51.140Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T14:52:51.140Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T14:52:51.140Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T14:53:50.094Z"
  }
}
[2025-12-20T14:53:24.337Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:53:24.338Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:53:24.338Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:53:24.338Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:53:24.338Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T14:53:24.338Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T14:53:24.338Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T14:53:24.338Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T14:53:50.094Z"
  }
}
[2025-12-20T14:53:25.307Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T14:53:25.307Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T14:53:25.307Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T14:53:25.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T14:53:25.307Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T14:53:25.307Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T14:53:25.307Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T14:53:25.307Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T14:53:50.094Z"
  }
}
[2025-12-20T15:03:21.091Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:03:21.092Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:03:21.092Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:03:21.092Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:03:21.093Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T15:03:21.093Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T15:03:21.093Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:03:21.093Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:03:21.093Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:04:21.092Z"
  }
}
[2025-12-20T15:03:22.137Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:03:22.137Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:03:22.138Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:03:22.138Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:03:22.138Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:03:22.138Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:03:22.138Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:03:22.138Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:04:21.092Z"
  }
}
[2025-12-20T15:03:40.553Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:03:40.553Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:03:40.554Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:03:40.554Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:03:40.554Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:03:40.554Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T15:03:40.554Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T15:03:40.554Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T15:04:21.092Z"
  }
}
[2025-12-20T15:03:41.531Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:03:41.531Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:03:41.532Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:03:41.532Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:03:41.532Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T15:03:41.532Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T15:03:41.532Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T15:03:41.532Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T15:04:21.092Z"
  }
}
[2025-12-20T15:05:46.837Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:05:46.837Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:05:46.837Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:05:46.837Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:05:46.837Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T15:05:46.837Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T15:05:46.837Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:05:46.837Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:05:46.837Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:06:46.837Z"
  }
}
[2025-12-20T15:05:47.844Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:05:47.844Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:05:47.845Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:05:47.845Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:05:47.845Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:05:47.845Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:05:47.845Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:05:47.845Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:06:46.837Z"
  }
}
[2025-12-20T15:07:22.964Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:07:22.965Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:07:22.965Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:07:22.966Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:07:22.966Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:07:22.966Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:07:22.966Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:07:22.966Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:07:22.966Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:08:22.966Z"
  }
}
[2025-12-20T15:07:23.865Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:07:23.866Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:07:23.866Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:07:23.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:07:23.866Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:07:23.866Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:07:23.866Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:07:23.866Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:08:22.966Z"
  }
}
[2025-12-20T15:09:36.126Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:09:36.126Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:09:36.127Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:09:36.127Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:09:36.127Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:09:36.127Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:09:36.127Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:09:36.127Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:09:36.127Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:10:36.127Z"
  }
}
[2025-12-20T15:09:37.156Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:09:37.157Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:09:37.157Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:09:37.157Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:09:37.157Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:09:37.157Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:09:37.157Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:09:37.157Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:10:36.127Z"
  }
}
[2025-12-20T15:09:48.168Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:09:48.168Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:09:48.169Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:09:48.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:09:48.169Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:09:48.169Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T15:09:48.169Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T15:09:48.169Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T15:10:36.127Z"
  }
}
[2025-12-20T15:09:49.056Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:09:49.057Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:09:49.057Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:09:49.057Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:09:49.057Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T15:09:49.057Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T15:09:49.057Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T15:09:49.057Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T15:10:36.127Z"
  }
}
[2025-12-20T15:11:20.517Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:11:20.517Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:11:20.517Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:11:20.517Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:11:20.518Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T15:11:20.518Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T15:11:20.518Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:11:20.518Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:11:20.518Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:12:20.517Z"
  }
}
[2025-12-20T15:11:21.467Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:11:21.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:11:21.467Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:11:21.467Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:11:21.467Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:11:21.467Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:11:21.467Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:11:21.467Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:12:20.517Z"
  }
}
[2025-12-20T15:14:51.086Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:14:51.086Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:14:51.086Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:14:51.086Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:14:51.086Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:14:51.086Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:14:51.087Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:14:51.087Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:14:51.087Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:15:51.086Z"
  }
}
[2025-12-20T15:14:52.028Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:14:52.028Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:14:52.028Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:14:52.028Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:14:52.028Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:14:52.028Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:14:52.028Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:14:52.029Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:15:51.086Z"
  }
}
[2025-12-20T15:23:07.218Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:23:07.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:23:07.218Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:23:07.218Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:23:07.218Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:23:07.218Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:23:07.218Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:23:07.218Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:23:07.218Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:24:07.218Z"
  }
}
[2025-12-20T15:23:08.137Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:23:08.137Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:23:08.137Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:23:08.138Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:23:08.138Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:23:08.138Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:23:08.138Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:23:08.138Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:24:07.218Z"
  }
}
[2025-12-20T15:24:10.066Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:24:10.066Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:24:10.066Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:24:10.066Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:24:10.066Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:24:10.066Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:24:10.066Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:24:10.066Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:24:10.066Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:25:10.066Z"
  }
}
[2025-12-20T15:24:11.000Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:24:11.000Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:24:11.001Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:24:11.001Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:24:11.001Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:24:11.001Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:24:11.001Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:24:11.001Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:25:10.066Z"
  }
}
[2025-12-20T15:25:58.864Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:25:58.865Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:25:58.865Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:25:58.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:25:58.865Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:25:58.865Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:25:58.865Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:25:58.865Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:25:58.865Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:26:58.865Z"
  }
}
[2025-12-20T15:25:59.873Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:25:59.874Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:25:59.874Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:25:59.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:25:59.874Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:25:59.874Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:25:59.875Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:25:59.875Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:26:58.865Z"
  }
}
[2025-12-20T15:27:33.338Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:27:33.339Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:27:33.339Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:27:33.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:27:33.339Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:27:33.339Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:27:33.339Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:27:33.339Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:27:33.339Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:28:33.339Z"
  }
}
[2025-12-20T15:27:34.313Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:27:34.313Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:27:34.314Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:27:34.314Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:27:34.314Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:27:34.314Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:27:34.314Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:27:34.314Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:28:33.339Z"
  }
}
[2025-12-20T15:30:40.887Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:30:40.887Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:30:40.887Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:30:40.887Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:30:40.887Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:30:40.887Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:30:40.887Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:30:40.887Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:30:40.887Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:31:40.887Z"
  }
}
[2025-12-20T15:30:41.889Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:30:41.889Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:30:41.890Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:30:41.890Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:30:41.890Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:30:41.890Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:30:41.890Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:30:41.890Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:31:40.887Z"
  }
}
[2025-12-20T15:32:05.512Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:32:05.512Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:32:05.512Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:32:05.512Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:32:05.512Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:32:05.512Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:32:05.512Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:32:05.512Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:32:05.512Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:33:05.512Z"
  }
}
[2025-12-20T15:32:06.556Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:32:06.556Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:32:06.557Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:32:06.557Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:32:06.557Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:32:06.557Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:32:06.557Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:32:06.557Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:33:05.512Z"
  }
}
[2025-12-20T15:36:45.357Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:36:45.357Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:36:45.357Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:36:45.357Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:36:45.357Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:36:45.357Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:36:45.358Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:36:45.358Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:36:45.358Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:37:45.357Z"
  }
}
[2025-12-20T15:36:46.347Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:36:46.348Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:36:46.348Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:36:46.348Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:36:46.348Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:36:46.348Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:36:46.348Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:36:46.348Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:37:45.357Z"
  }
}
[2025-12-20T15:38:09.688Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:38:09.689Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:38:09.689Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:38:09.690Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:38:09.690Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:38:09.690Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:38:09.690Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:38:09.690Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:38:09.690Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:39:09.690Z"
  }
}
[2025-12-20T15:38:10.607Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:38:10.607Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:38:10.608Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:38:10.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:38:10.608Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:38:10.608Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:38:10.608Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:38:10.608Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:39:09.690Z"
  }
}
[2025-12-20T15:39:42.948Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:39:42.949Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:39:42.949Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:39:42.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:39:42.950Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:39:42.950Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:39:42.950Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:39:42.950Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:39:42.950Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:40:42.950Z"
  }
}
[2025-12-20T15:39:43.986Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:39:43.986Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:39:43.986Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:39:43.986Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:39:43.986Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:39:43.987Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:39:43.987Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:39:43.987Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:40:42.950Z"
  }
}
[2025-12-20T15:41:13.518Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:41:13.518Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:41:13.519Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:41:13.519Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:41:13.519Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:41:13.519Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:41:13.519Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:41:13.519Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:41:13.519Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:42:13.519Z"
  }
}
[2025-12-20T15:41:14.515Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:41:14.515Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:41:14.515Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:41:14.516Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:41:14.516Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:41:14.516Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:41:14.516Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:41:14.516Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:42:13.519Z"
  }
}
[2025-12-20T15:42:59.421Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:42:59.422Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:42:59.422Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:42:59.423Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:42:59.423Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:42:59.423Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:42:59.423Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:42:59.423Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:42:59.423Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:43:59.423Z"
  }
}
[2025-12-20T15:43:00.373Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:43:00.373Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:43:00.374Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:43:00.374Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:43:00.374Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:43:00.374Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:43:00.374Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:43:00.374Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:43:59.423Z"
  }
}
[2025-12-20T15:44:13.801Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:44:13.802Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:44:13.802Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:44:13.802Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:44:13.803Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:44:13.803Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:44:13.803Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:44:13.803Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:44:13.803Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:45:13.802Z"
  }
}
[2025-12-20T15:44:14.812Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:44:14.812Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:44:14.812Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:44:14.812Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:44:14.812Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:44:14.812Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:44:14.812Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:44:14.812Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:45:13.802Z"
  }
}
[2025-12-20T15:45:26.565Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:45:26.566Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:45:26.566Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:45:26.566Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:45:26.566Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:45:26.566Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:45:26.566Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:45:26.566Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:45:26.566Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:46:26.566Z"
  }
}
[2025-12-20T15:45:27.530Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:45:27.531Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:45:27.531Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:45:27.531Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:45:27.531Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:45:27.531Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:45:27.531Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:45:27.531Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:46:26.566Z"
  }
}
[2025-12-20T15:47:02.854Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:47:02.856Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:47:02.856Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:47:02.856Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:47:02.857Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:47:02.857Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:47:02.857Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:47:02.857Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:47:02.857Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:48:02.856Z"
  }
}
[2025-12-20T15:47:04.223Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:47:04.223Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:47:04.223Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:47:04.223Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:47:04.223Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:47:04.223Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:47:04.223Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:47:04.223Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:48:02.856Z"
  }
}
[2025-12-20T15:50:28.140Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:50:28.141Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:50:28.141Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:50:28.141Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:50:28.141Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:50:28.141Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:50:28.142Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:50:28.142Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:50:28.142Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:51:28.141Z"
  }
}
[2025-12-20T15:50:29.369Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:50:29.369Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:50:29.369Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:50:29.369Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:50:29.369Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:50:29.370Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:50:29.370Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:50:29.370Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:51:28.141Z"
  }
}
[2025-12-20T15:52:50.239Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:52:50.239Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:52:50.239Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:52:50.239Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:52:50.239Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:52:50.239Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:52:50.239Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:52:50.239Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:52:50.239Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:53:50.239Z"
  }
}
[2025-12-20T15:52:51.281Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:52:51.281Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:52:51.281Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:52:51.281Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:52:51.282Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:52:51.282Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:52:51.282Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:52:51.282Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:53:50.239Z"
  }
}
[2025-12-20T15:53:52.943Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:53:52.944Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:53:52.944Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:53:52.944Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:53:52.944Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T15:53:52.944Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T15:53:52.944Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T15:53:52.944Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T15:53:52.944Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T15:54:52.944Z"
  }
}
[2025-12-20T15:53:53.811Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T15:53:53.811Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T15:53:53.811Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T15:53:53.811Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T15:53:53.811Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T15:53:53.811Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T15:53:53.811Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T15:53:53.811Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T15:54:52.944Z"
  }
}
[2025-12-20T16:17:04.251Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:17:04.252Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:17:04.252Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:17:04.252Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:17:04.252Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-20T16:17:04.252Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:17:04.252Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:17:04.252Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:18:04.252Z"
  }
}
[2025-12-20T16:17:05.212Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:17:05.212Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:17:05.213Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:17:05.213Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:17:05.213Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:17:05.213Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:17:05.213Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:17:05.213Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:18:04.252Z"
  }
}
[2025-12-20T16:17:19.385Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:17:19.385Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:17:19.385Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:17:19.385Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:17:19.385Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:17:19.385Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T16:17:19.385Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T16:17:19.385Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T16:18:04.252Z"
  }
}
[2025-12-20T16:17:20.370Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:17:20.370Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:17:20.370Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:17:20.370Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:17:20.370Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T16:17:20.370Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T16:17:20.371Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T16:17:20.371Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T16:18:04.252Z"
  }
}
[2025-12-20T16:18:35.657Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:18:35.658Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:18:35.658Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:18:35.658Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:18:35.658Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T16:18:35.658Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T16:18:35.658Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:18:35.658Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:18:35.658Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:19:35.658Z"
  }
}
[2025-12-20T16:18:36.676Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:18:36.676Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:18:36.676Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:18:36.677Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:18:36.677Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:18:36.677Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:18:36.677Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:18:36.677Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:19:35.658Z"
  }
}
[2025-12-20T16:20:10.297Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:20:10.297Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:20:10.297Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:20:10.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:20:10.297Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:20:10.297Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T16:20:10.297Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:20:10.297Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:20:10.297Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:21:10.297Z"
  }
}
[2025-12-20T16:20:11.291Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:20:11.292Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:20:11.292Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:20:11.292Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:20:11.292Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:20:11.292Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:20:11.292Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:20:11.292Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:21:10.297Z"
  }
}
[2025-12-20T16:21:35.981Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:21:35.982Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:21:35.982Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:21:35.982Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:21:35.982Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:21:35.982Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T16:21:35.982Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:21:35.982Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:21:35.982Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:22:35.982Z"
  }
}
[2025-12-20T16:21:36.931Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:21:36.931Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:21:36.931Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:21:36.931Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:21:36.931Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:21:36.932Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:21:36.932Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:21:36.932Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:22:35.982Z"
  }
}
[2025-12-20T16:22:19.255Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:22:19.255Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:22:19.255Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:22:19.255Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:22:19.255Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:22:19.255Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T16:22:19.255Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T16:22:19.255Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T16:22:35.982Z"
  }
}
[2025-12-20T16:22:20.304Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:22:20.304Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:22:20.304Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:22:20.304Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:22:20.304Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T16:22:20.304Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T16:22:20.304Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T16:22:20.304Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T16:22:35.982Z"
  }
}
[2025-12-20T16:27:22.465Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:27:22.465Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:27:22.466Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:27:22.466Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:27:22.466Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T16:27:22.466Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T16:27:22.466Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:27:22.466Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:27:22.466Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:28:22.466Z"
  }
}
[2025-12-20T16:27:23.436Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:27:23.436Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:27:23.436Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:27:23.436Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:27:23.436Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:27:23.436Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:27:23.436Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:27:23.436Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:28:22.466Z"
  }
}
[2025-12-20T16:30:53.011Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:30:53.012Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:30:53.012Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:30:53.012Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:30:53.012Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:30:53.012Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T16:30:53.012Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:30:53.012Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:30:53.012Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:31:53.012Z"
  }
}
[2025-12-20T16:30:54.150Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:30:54.150Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:30:54.150Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:30:54.150Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:30:54.150Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:30:54.150Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:30:54.150Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:30:54.150Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:31:53.012Z"
  }
}
[2025-12-20T16:32:18.714Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:32:18.715Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:32:18.715Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:32:18.715Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:32:18.715Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:32:18.715Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-20T16:32:18.715Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:32:18.715Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:32:18.715Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:33:18.715Z"
  }
}
[2025-12-20T16:32:19.751Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:32:19.751Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:32:19.751Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:32:19.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:32:19.751Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:32:19.752Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:32:19.752Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:32:19.752Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:33:18.715Z"
  }
}
[2025-12-20T16:32:37.568Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:32:37.568Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:32:37.568Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:32:37.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:32:37.568Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-20T16:32:37.568Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-20T16:32:37.569Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-20T16:32:37.569Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-20T16:33:18.715Z"
  }
}
[2025-12-20T16:32:38.618Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:32:38.619Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:32:38.619Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:32:38.619Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:32:38.619Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-20T16:32:38.619Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-20T16:32:38.619Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-20T16:32:38.619Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-20T16:33:18.715Z"
  }
}
[2025-12-20T16:34:37.327Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:34:37.328Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:34:37.328Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:34:37.328Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:34:37.328Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-20T16:34:37.328Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-20T16:34:37.328Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-20T16:34:37.328Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-20T16:34:37.328Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-20T16:35:37.328Z"
  }
}
[2025-12-20T16:34:38.211Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-20T16:34:38.212Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-20T16:34:38.212Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-20T16:34:38.212Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-20T16:34:38.212Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-20T16:34:38.212Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-20T16:34:38.212Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-20T16:34:38.212Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-20T16:35:37.328Z"
  }
}
[2025-12-21T07:30:04.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1766302204592",
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.593Z] Creating new entry
{
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.593Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T07:30:04.593Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T07:30:04.593Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1766302204592",
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.593Z] Found existing entry
{
  "key": "login:test-allow-1766302204592",
  "timestampCount": 1
}
[2025-12-21T07:30:04.593Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1766302204592",
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.594Z] Found existing entry
{
  "key": "login:test-allow-1766302204592",
  "timestampCount": 2
}
[2025-12-21T07:30:04.594Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1766302204592",
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.594Z] Found existing entry
{
  "key": "login:test-allow-1766302204592",
  "timestampCount": 3
}
[2025-12-21T07:30:04.594Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1766302204592",
  "key": "login:test-allow-1766302204592"
}
[2025-12-21T07:30:04.594Z] Found existing entry
{
  "key": "login:test-allow-1766302204592",
  "timestampCount": 4
}
[2025-12-21T07:30:04.594Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.594Z] Creating new entry
{
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.594Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.594Z] Found existing entry
{
  "key": "login:test-block-1766302204594",
  "timestampCount": 1
}
[2025-12-21T07:30:04.594Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-21T07:30:04.594Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-21T07:30:04.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.595Z] Found existing entry
{
  "key": "login:test-block-1766302204594",
  "timestampCount": 2
}
[2025-12-21T07:30:04.595Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-21T07:30:04.595Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-21T07:30:04.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.595Z] Found existing entry
{
  "key": "login:test-block-1766302204594",
  "timestampCount": 3
}
[2025-12-21T07:30:04.595Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-21T07:30:04.595Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-21T07:30:04.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.595Z] Found existing entry
{
  "key": "login:test-block-1766302204594",
  "timestampCount": 4
}
[2025-12-21T07:30:04.595Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-21T07:30:04.595Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-21T07:30:04.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1766302204594",
  "key": "login:test-block-1766302204594"
}
[2025-12-21T07:30:04.595Z] Found existing entry
{
  "key": "login:test-block-1766302204594",
  "timestampCount": 5
}
[2025-12-21T07:30:04.595Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-21T07:30:04.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1766302204595",
  "key": "test-reset:test-reset-1766302204595"
}
[2025-12-21T07:30:04.595Z] Creating new entry
{
  "key": "test-reset:test-reset-1766302204595"
}
[2025-12-21T07:30:04.595Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-21T07:30:04.596Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-21T07:30:04.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1766302204595",
  "key": "test-reset:test-reset-1766302204595"
}
[2025-12-21T07:30:04.596Z] Found existing entry
{
  "key": "test-reset:test-reset-1766302204595",
  "timestampCount": 1
}
[2025-12-21T07:30:04.596Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2025-12-21T07:30:04.596Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2025-12-21T07:30:04.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1766302204595",
  "key": "test-reset:test-reset-1766302204595"
}
[2025-12-21T07:30:04.596Z] Found existing entry
{
  "key": "test-reset:test-reset-1766302204595",
  "timestampCount": 2
}
[2025-12-21T07:30:04.596Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2025-12-21T07:30:04.748Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1766302204595",
  "key": "test-reset:test-reset-1766302204595"
}
[2025-12-21T07:30:04.748Z] Found existing entry
{
  "key": "test-reset:test-reset-1766302204595",
  "timestampCount": 2
}
[2025-12-21T07:30:04.748Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T07:30:04.748Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2025-12-21T07:30:04.749Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2025-12-21T07:30:04.749Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.749Z] Creating new entry
{
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.749Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T07:30:04.749Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T07:30:04.749Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.749Z] Found existing entry
{
  "key": "login:test-multi-1-1766302204749",
  "timestampCount": 1
}
[2025-12-21T07:30:04.750Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2025-12-21T07:30:04.750Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2025-12-21T07:30:04.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.750Z] Found existing entry
{
  "key": "login:test-multi-1-1766302204749",
  "timestampCount": 2
}
[2025-12-21T07:30:04.750Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2025-12-21T07:30:04.750Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2025-12-21T07:30:04.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.750Z] Found existing entry
{
  "key": "login:test-multi-1-1766302204749",
  "timestampCount": 3
}
[2025-12-21T07:30:04.750Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2025-12-21T07:30:04.750Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2025-12-21T07:30:04.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.750Z] Found existing entry
{
  "key": "login:test-multi-1-1766302204749",
  "timestampCount": 4
}
[2025-12-21T07:30:04.750Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2025-12-21T07:30:04.750Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2025-12-21T07:30:04.750Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1766302204749",
  "key": "login:test-multi-1-1766302204749"
}
[2025-12-21T07:30:04.750Z] Found existing entry
{
  "key": "login:test-multi-1-1766302204749",
  "timestampCount": 5
}
[2025-12-21T07:30:04.750Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2025-12-21T07:30:04.751Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1766302204749",
  "key": "login:test-multi-2-1766302204749"
}
[2025-12-21T07:30:04.751Z] Creating new entry
{
  "key": "login:test-multi-2-1766302204749"
}
[2025-12-21T07:30:04.751Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T07:30:04.751Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T07:30:04.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1766302204752",
  "key": "login:test-reset-time-1766302204752"
}
[2025-12-21T07:30:04.752Z] Creating new entry
{
  "key": "login:test-reset-time-1766302204752"
}
[2025-12-21T07:30:04.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T07:30:04.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T07:30:04.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:30:04.754Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-21T07:30:04.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:30:04.754Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2025-12-21T07:30:04.754Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:30:04.754Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-21T07:30:04.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:30:04.755Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:30:04.755Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:30:04.755Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2025-12-21T07:30:04.755Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1766302204755",
  "key": "test-sliding:test-sliding-1766302204755"
}
[2025-12-21T07:30:04.755Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1766302204755"
}
[2025-12-21T07:30:04.755Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-21T07:30:04.755Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-21T07:30:04.855Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1766302204755",
  "key": "test-sliding:test-sliding-1766302204755"
}
[2025-12-21T07:30:04.855Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1766302204755",
  "timestampCount": 1
}
[2025-12-21T07:30:04.855Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-21T07:30:04.855Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-21T07:30:04.960Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1766302204755",
  "key": "test-sliding:test-sliding-1766302204755"
}
[2025-12-21T07:30:04.960Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1766302204755",
  "timestampCount": 2
}
[2025-12-21T07:30:04.961Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2025-12-21T07:30:04.961Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-21T07:30:04.961Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-21T07:30:04.961Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1766302204961",
  "key": "register:test-format-allowed-1766302204961"
}
[2025-12-21T07:30:04.961Z] Creating new entry
{
  "key": "register:test-format-allowed-1766302204961"
}
[2025-12-21T07:30:04.961Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-21T07:30:04.961Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-21T07:30:04.962Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1766302204962",
  "key": "register:test-format-blocked-1766302204962"
}
[2025-12-21T07:30:04.962Z] Creating new entry
{
  "key": "register:test-format-blocked-1766302204962"
}
[2025-12-21T07:30:04.962Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2025-12-21T07:30:04.962Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2025-12-21T07:30:04.962Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1766302204962",
  "key": "register:test-format-blocked-1766302204962"
}
[2025-12-21T07:30:04.962Z] Found existing entry
{
  "key": "register:test-format-blocked-1766302204962",
  "timestampCount": 1
}
[2025-12-21T07:30:04.962Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2025-12-21T07:30:04.963Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2025-12-21T07:30:04.963Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1766302204962",
  "key": "register:test-format-blocked-1766302204962"
}
[2025-12-21T07:30:04.963Z] Found existing entry
{
  "key": "register:test-format-blocked-1766302204962",
  "timestampCount": 2
}
[2025-12-21T07:30:04.963Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2025-12-21T07:30:04.963Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2025-12-21T07:30:04.963Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1766302204962",
  "key": "register:test-format-blocked-1766302204962"
}
[2025-12-21T07:30:04.963Z] Found existing entry
{
  "key": "register:test-format-blocked-1766302204962",
  "timestampCount": 3
}
[2025-12-21T07:30:04.963Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2025-12-21T07:33:38.192Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:33:38.193Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:33:38.193Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:33:38.193Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:33:38.193Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T07:33:38.193Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T07:33:38.193Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T07:33:38.193Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T07:34:38.193Z"
  }
}
[2025-12-21T07:33:39.590Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:33:39.591Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:33:39.591Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:33:39.591Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:33:39.591Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T07:33:39.591Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T07:33:39.591Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T07:33:39.591Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T07:34:38.193Z"
  }
}
[2025-12-21T07:35:08.867Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:35:08.868Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:35:08.868Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:35:08.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:35:08.868Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T07:35:08.869Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T07:35:08.869Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T07:35:08.869Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T07:35:08.869Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T07:36:08.868Z"
  }
}
[2025-12-21T07:35:09.770Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:35:09.771Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:35:09.771Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:35:09.771Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:35:09.771Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T07:35:09.771Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T07:35:09.771Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T07:35:09.771Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T07:36:08.868Z"
  }
}
[2025-12-21T07:35:47.906Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:35:47.907Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:35:47.907Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:35:47.907Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:35:47.907Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T07:35:47.907Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T07:35:47.907Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T07:35:47.908Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T07:36:08.868Z"
  }
}
[2025-12-21T07:35:49.047Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:35:49.047Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:35:49.047Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:35:49.048Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:35:49.048Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T07:35:49.048Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T07:35:49.048Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T07:35:49.048Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T07:36:08.868Z"
  }
}
[2025-12-21T07:44:29.257Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:44:29.258Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:44:29.258Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:44:29.258Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:44:29.258Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T07:44:29.258Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T07:44:29.258Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T07:44:29.258Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T07:44:29.258Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T07:45:29.258Z"
  }
}
[2025-12-21T07:44:31.345Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:44:31.346Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:44:31.346Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:44:31.346Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:44:31.346Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T07:44:31.346Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T07:44:31.346Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T07:44:31.346Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T07:45:29.258Z"
  }
}
[2025-12-21T07:52:14.581Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:52:14.582Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:52:14.582Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:52:14.582Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:52:14.582Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T07:52:14.583Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T07:52:14.583Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T07:52:14.583Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T07:52:14.583Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T07:53:14.582Z"
  }
}
[2025-12-21T07:52:15.484Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:52:15.484Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:52:15.484Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:52:15.484Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:52:15.484Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T07:52:15.484Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T07:52:15.484Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T07:52:15.484Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T07:53:14.582Z"
  }
}
[2025-12-21T07:56:59.320Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:56:59.321Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:56:59.321Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:56:59.321Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:56:59.321Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T07:56:59.322Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T07:56:59.322Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T07:56:59.322Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T07:56:59.322Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T07:57:59.321Z"
  }
}
[2025-12-21T07:57:00.212Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T07:57:00.212Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T07:57:00.212Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T07:57:00.212Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T07:57:00.212Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T07:57:00.212Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T07:57:00.212Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T07:57:00.212Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T07:57:59.321Z"
  }
}
[2025-12-21T08:22:45.816Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:22:45.817Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:22:45.818Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:22:45.818Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:22:45.818Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T08:22:45.818Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T08:22:45.818Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T08:22:45.818Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T08:23:45.818Z"
  }
}
[2025-12-21T08:22:46.775Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:22:46.776Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:22:46.776Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:22:46.776Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:22:46.776Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T08:22:46.776Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T08:22:46.777Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T08:22:46.777Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T08:23:45.818Z"
  }
}
[2025-12-21T08:29:01.355Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:29:01.355Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:29:01.355Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:29:01.355Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:29:01.356Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T08:29:01.356Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T08:29:01.356Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T08:29:01.356Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T08:29:01.356Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T08:30:01.355Z"
  }
}
[2025-12-21T08:29:03.370Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:29:03.371Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:29:03.371Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:29:03.371Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:29:03.371Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T08:29:03.371Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T08:29:03.371Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T08:29:03.371Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T08:30:01.355Z"
  }
}
[2025-12-21T08:58:07.249Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:58:07.250Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:58:07.250Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:58:07.250Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:58:07.250Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T08:58:07.250Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T08:58:07.250Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T08:58:07.250Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T08:59:07.250Z"
  }
}
[2025-12-21T08:58:08.383Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T08:58:08.383Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T08:58:08.383Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T08:58:08.384Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T08:58:08.384Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T08:58:08.384Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T08:58:08.384Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T08:58:08.384Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T08:59:07.250Z"
  }
}
[2025-12-21T09:03:33.719Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:03:33.720Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:03:33.720Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:03:33.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:03:33.720Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T09:03:33.720Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T09:03:33.720Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T09:03:33.720Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T09:03:33.720Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T09:04:33.720Z"
  }
}
[2025-12-21T09:03:34.802Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:03:34.802Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:03:34.802Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:03:34.802Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:03:34.803Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T09:03:34.803Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T09:03:34.803Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T09:03:34.803Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T09:04:33.720Z"
  }
}
[2025-12-21T09:06:53.664Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:06:53.664Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:06:53.664Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:06:53.664Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:06:53.664Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T09:06:53.664Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T09:06:53.664Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T09:06:53.664Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T09:06:53.664Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T09:07:53.664Z"
  }
}
[2025-12-21T09:06:54.631Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:06:54.631Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:06:54.631Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:06:54.631Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:06:54.631Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T09:06:54.631Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T09:06:54.631Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T09:06:54.631Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T09:07:53.664Z"
  }
}
[2025-12-21T09:16:29.719Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:16:29.720Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:16:29.720Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:16:29.720Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:16:29.720Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T09:16:29.720Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T09:16:29.720Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T09:16:29.720Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T09:16:29.720Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T09:17:29.720Z"
  }
}
[2025-12-21T09:16:30.630Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:16:30.630Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:16:30.630Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:16:30.630Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:16:30.630Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T09:16:30.630Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T09:16:30.630Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T09:16:30.630Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T09:17:29.720Z"
  }
}
[2025-12-21T09:17:07.454Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:17:07.454Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:17:07.454Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:17:07.454Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:17:07.454Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T09:17:07.454Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T09:17:07.454Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T09:17:07.454Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T09:17:29.720Z"
  }
}
[2025-12-21T09:17:08.517Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:17:08.517Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:17:08.518Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:17:08.518Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:17:08.518Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T09:17:08.518Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T09:17:08.518Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T09:17:08.518Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T09:17:29.720Z"
  }
}
[2025-12-21T09:17:38.833Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:17:38.833Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:17:38.833Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:17:38.833Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:17:38.833Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T09:17:38.833Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-21T09:17:38.833Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T09:17:38.833Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T09:17:38.834Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T09:18:07.454Z"
  }
}
[2025-12-21T09:17:39.728Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:17:39.728Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:17:39.729Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:17:39.729Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:17:39.729Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T09:17:39.729Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T09:17:39.729Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T09:17:39.729Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T09:18:07.454Z"
  }
}
[2025-12-21T09:20:15.164Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:20:15.164Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:20:15.164Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:20:15.164Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:20:15.164Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T09:20:15.164Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T09:20:15.164Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T09:20:15.164Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T09:20:15.164Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T09:21:15.164Z"
  }
}
[2025-12-21T09:20:16.294Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:20:16.294Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:20:16.295Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:20:16.295Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:20:16.295Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T09:20:16.295Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T09:20:16.295Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T09:20:16.295Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T09:21:15.164Z"
  }
}
[2025-12-21T09:21:32.655Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:21:32.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:21:32.655Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:21:32.655Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:21:32.656Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T09:21:32.656Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T09:21:32.656Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T09:21:32.656Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T09:21:32.656Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T09:22:32.655Z"
  }
}
[2025-12-21T09:21:33.658Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T09:21:33.659Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T09:21:33.659Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T09:21:33.660Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T09:21:33.660Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T09:21:33.660Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T09:21:33.660Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T09:21:33.660Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T09:22:32.655Z"
  }
}
[2025-12-21T11:03:44.312Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:03:44.312Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:03:44.313Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:03:44.313Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:03:44.313Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T11:03:44.313Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:03:44.313Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:03:44.313Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:04:44.313Z"
  }
}
[2025-12-21T11:03:45.253Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:03:45.253Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:03:45.253Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:03:45.253Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:03:45.253Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:03:45.253Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:03:45.253Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:03:45.253Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:04:44.313Z"
  }
}
[2025-12-21T11:22:38.287Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:22:38.288Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:22:38.288Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:22:38.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:22:38.288Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T11:22:38.288Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:22:38.288Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:22:38.288Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:23:38.288Z"
  }
}
[2025-12-21T11:22:39.184Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:22:39.184Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:22:39.184Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:22:39.184Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:22:39.184Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:22:39.184Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:22:39.184Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:22:39.184Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:23:38.288Z"
  }
}
[2025-12-21T11:23:52.340Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:23:52.340Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:23:52.340Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:23:52.340Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:23:52.340Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T11:23:52.340Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T11:23:52.340Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:23:52.340Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:23:52.340Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:24:52.340Z"
  }
}
[2025-12-21T11:23:53.294Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:23:53.294Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:23:53.294Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:23:53.294Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:23:53.294Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:23:53.294Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:23:53.294Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:23:53.294Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:24:52.340Z"
  }
}
[2025-12-21T11:25:18.254Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:25:18.254Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:25:18.254Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:25:18.254Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:25:18.254Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T11:25:18.254Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T11:25:18.254Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:25:18.254Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:25:18.254Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:26:18.254Z"
  }
}
[2025-12-21T11:25:19.200Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:25:19.200Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:25:19.200Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:25:19.201Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:25:19.201Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:25:19.201Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:25:19.201Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:25:19.201Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:26:18.254Z"
  }
}
[2025-12-21T11:26:26.823Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:26:26.824Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:26:26.824Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:26:26.824Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:26:26.824Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T11:26:26.824Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T11:26:26.824Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:26:26.824Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:26:26.824Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:27:26.824Z"
  }
}
[2025-12-21T11:26:28.179Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:26:28.179Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:26:28.179Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:26:28.179Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:26:28.179Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:26:28.180Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:26:28.180Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:26:28.180Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:27:26.824Z"
  }
}
[2025-12-21T11:26:35.883Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:26:35.883Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:26:35.883Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:26:35.883Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:26:35.883Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T11:26:35.884Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T11:26:35.884Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T11:26:35.884Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T11:27:26.824Z"
  }
}
[2025-12-21T11:26:36.566Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:26:36.567Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:26:36.567Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:26:36.567Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:26:36.567Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T11:26:36.567Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T11:26:36.567Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T11:26:36.567Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T11:27:26.824Z"
  }
}
[2025-12-21T11:27:30.873Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:27:30.873Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:27:30.873Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:27:30.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:27:30.874Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T11:27:30.874Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-21T11:27:30.874Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T11:27:30.874Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T11:27:30.874Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T11:27:35.883Z"
  }
}
[2025-12-21T11:27:31.928Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:27:31.928Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:27:31.929Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:27:31.929Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:27:31.929Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T11:27:31.929Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T11:27:31.929Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T11:27:31.929Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T11:27:35.883Z"
  }
}
[2025-12-21T11:27:44.437Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:27:44.437Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:27:44.438Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:27:44.438Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:27:44.438Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T11:27:44.438Z] Filtered old timestamps
{
  "before": 4,
  "after": 2,
  "removed": 2
}
[2025-12-21T11:27:44.438Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T11:27:44.438Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T11:27:44.438Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T11:28:30.874Z"
  }
}
[2025-12-21T11:27:45.428Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:27:45.428Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:27:45.429Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:27:45.429Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:27:45.429Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T11:27:45.429Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T11:27:45.429Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T11:27:45.429Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T11:28:30.874Z"
  }
}
[2025-12-21T11:29:57.139Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:29:57.140Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:29:57.140Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:29:57.140Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:29:57.140Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T11:29:57.140Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T11:29:57.140Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T11:29:57.140Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T11:29:57.140Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T11:30:57.140Z"
  }
}
[2025-12-21T11:29:59.114Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T11:29:59.114Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T11:29:59.114Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T11:29:59.114Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T11:29:59.114Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T11:29:59.114Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T11:29:59.114Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T11:29:59.114Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T11:30:57.140Z"
  }
}
[2025-12-21T12:16:00.323Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T12:16:00.324Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T12:16:00.324Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T12:16:00.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T12:16:00.324Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T12:16:00.324Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T12:16:00.324Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T12:16:00.324Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T12:17:00.324Z"
  }
}
[2025-12-21T12:16:01.455Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T12:16:01.456Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T12:16:01.456Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T12:16:01.456Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T12:16:01.456Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T12:16:01.456Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T12:16:01.456Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T12:16:01.456Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T12:17:00.324Z"
  }
}
[2025-12-21T16:51:01.224Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T16:51:01.224Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T16:51:01.224Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T16:51:01.224Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T16:51:01.224Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T16:51:01.224Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T16:51:01.224Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T16:51:01.224Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T16:52:01.224Z"
  }
}
[2025-12-21T16:51:02.109Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T16:51:02.109Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T16:51:02.110Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T16:51:02.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T16:51:02.110Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T16:51:02.110Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T16:51:02.110Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T16:51:02.110Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T16:52:01.224Z"
  }
}
[2025-12-21T17:13:40.294Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:13:40.295Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:13:40.295Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:13:40.295Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:13:40.295Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T17:13:40.295Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T17:13:40.295Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T17:13:40.295Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T17:14:40.295Z"
  }
}
[2025-12-21T17:13:41.351Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:13:41.352Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:13:41.352Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:13:41.353Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:13:41.353Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T17:13:41.354Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T17:13:41.354Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T17:13:41.355Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T17:14:40.295Z"
  }
}
[2025-12-21T17:17:40.656Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:17:40.656Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:17:40.657Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:17:40.657Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:17:40.657Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T17:17:40.657Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T17:17:40.657Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T17:17:40.657Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T17:17:40.657Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T17:18:40.657Z"
  }
}
[2025-12-21T17:17:41.624Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:17:41.624Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:17:41.624Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:17:41.624Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:17:41.624Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T17:17:41.624Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T17:17:41.624Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T17:17:41.624Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T17:18:40.657Z"
  }
}
[2025-12-21T17:18:26.552Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:18:26.552Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:18:26.552Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:18:26.552Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:18:26.552Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T17:18:26.552Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T17:18:26.552Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T17:18:26.552Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T17:18:40.657Z"
  }
}
[2025-12-21T17:18:27.545Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:18:27.545Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:18:27.546Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:18:27.546Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:18:27.546Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T17:18:27.546Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T17:18:27.546Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T17:18:27.546Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T17:18:40.657Z"
  }
}
[2025-12-21T17:33:09.445Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:33:09.447Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:33:09.447Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:33:09.447Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:33:09.448Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T17:33:09.448Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T17:33:09.448Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T17:33:09.448Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T17:34:09.447Z"
  }
}
[2025-12-21T17:33:10.540Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:33:10.540Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:33:10.540Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:33:10.540Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:33:10.540Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T17:33:10.541Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T17:33:10.541Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T17:33:10.541Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T17:34:09.447Z"
  }
}
[2025-12-21T17:40:37.066Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:40:37.067Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:40:37.067Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:40:37.067Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:40:37.067Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T17:40:37.067Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T17:40:37.067Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T17:40:37.067Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T17:40:37.067Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T17:41:37.067Z"
  }
}
[2025-12-21T17:40:37.993Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T17:40:37.994Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T17:40:37.994Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T17:40:37.994Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T17:40:37.994Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T17:40:37.994Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T17:40:37.994Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T17:40:37.994Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T17:41:37.067Z"
  }
}
[2025-12-21T18:15:45.481Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T18:15:45.483Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T18:15:45.483Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T18:15:45.483Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T18:15:45.483Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T18:15:45.483Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T18:15:45.483Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T18:15:45.483Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T18:16:45.483Z"
  }
}
[2025-12-21T18:15:46.375Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T18:15:46.376Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T18:15:46.376Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T18:15:46.376Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T18:15:46.376Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T18:15:46.376Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T18:15:46.376Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T18:15:46.376Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T18:16:45.483Z"
  }
}
[2025-12-21T20:12:46.347Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:12:46.349Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:12:46.349Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:12:46.349Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:12:46.349Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T20:12:46.349Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:12:46.349Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:12:46.349Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:13:46.349Z"
  }
}
[2025-12-21T20:12:47.430Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:12:47.430Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:12:47.431Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:12:47.431Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:12:47.431Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:12:47.431Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:12:47.431Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:12:47.431Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:13:46.349Z"
  }
}
[2025-12-21T20:15:21.439Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:15:21.439Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:15:21.439Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:15:21.439Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:15:21.439Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:15:21.439Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:15:21.439Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:15:21.439Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:15:21.439Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:16:21.439Z"
  }
}
[2025-12-21T20:15:22.468Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:15:22.468Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:15:22.469Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:15:22.469Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:15:22.469Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:15:22.469Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:15:22.469Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:15:22.469Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:16:21.439Z"
  }
}
[2025-12-21T20:16:20.004Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:16:20.004Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:16:20.005Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:16:20.005Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:16:20.005Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:16:20.005Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T20:16:20.005Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T20:16:20.005Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T20:16:21.439Z"
  }
}
[2025-12-21T20:16:21.031Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:16:21.031Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:16:21.032Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:16:21.032Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:16:21.032Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T20:16:21.032Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T20:16:21.032Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T20:16:21.032Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T20:16:21.439Z"
  }
}
[2025-12-21T20:18:58.367Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:18:58.367Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:18:58.367Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:18:58.367Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:18:58.367Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T20:18:58.367Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T20:18:58.367Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:18:58.367Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:18:58.367Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:19:58.367Z"
  }
}
[2025-12-21T20:18:59.399Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:18:59.399Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:18:59.399Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:18:59.399Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:18:59.399Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:18:59.399Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:18:59.399Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:18:59.399Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:19:58.367Z"
  }
}
[2025-12-21T20:20:03.625Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:20:03.626Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:20:03.626Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:20:03.626Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:20:03.626Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:20:03.626Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:20:03.626Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:20:03.626Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:20:03.627Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:21:03.626Z"
  }
}
[2025-12-21T20:20:04.625Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:20:04.625Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:20:04.626Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:20:04.626Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:20:04.626Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:20:04.626Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:20:04.626Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:20:04.628Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:21:03.626Z"
  }
}
[2025-12-21T20:21:25.272Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:21:25.272Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:21:25.273Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:21:25.273Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:21:25.273Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:21:25.273Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:21:25.273Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:21:25.273Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:21:25.273Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:22:25.273Z"
  }
}
[2025-12-21T20:21:26.218Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:21:26.218Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:21:26.218Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:21:26.218Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:21:26.219Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:21:26.219Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:21:26.219Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:21:26.219Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:22:25.273Z"
  }
}
[2025-12-21T20:23:30.757Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:23:30.758Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:23:30.758Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:23:30.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:23:30.758Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:23:30.758Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:23:30.758Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:23:30.758Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:23:30.758Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:24:30.758Z"
  }
}
[2025-12-21T20:23:31.804Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:23:31.804Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:23:31.805Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:23:31.805Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:23:31.805Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:23:31.805Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:23:31.805Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:23:31.805Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:24:30.758Z"
  }
}
[2025-12-21T20:24:36.903Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:24:36.903Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:24:36.903Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:24:36.903Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:24:36.903Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:24:36.903Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:24:36.903Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:24:36.903Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:24:36.903Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:25:36.903Z"
  }
}
[2025-12-21T20:24:37.852Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:24:37.852Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:24:37.853Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:24:37.853Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:24:37.853Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:24:37.853Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:24:37.853Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:24:37.853Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:25:36.903Z"
  }
}
[2025-12-21T20:33:40.115Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:33:40.115Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:33:40.115Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:33:40.116Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:33:40.116Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:33:40.116Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:33:40.116Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:33:40.116Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:33:40.116Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:34:40.116Z"
  }
}
[2025-12-21T20:33:41.176Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:33:41.176Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:33:41.176Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:33:41.176Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:33:41.176Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:33:41.176Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:33:41.176Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:33:41.176Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:34:40.116Z"
  }
}
[2025-12-21T20:33:52.364Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2025-12-21T20:33:52.364Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:33:52.364Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:33:52.365Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2025-12-21T20:33:52.365Z] Creating new entry
{
  "key": "login:unknown"
}
[2025-12-21T20:33:52.365Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2025-12-21T20:33:52.365Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2025-12-21T20:33:52.365Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2025-12-21T20:34:52.365Z"
  }
}
[2025-12-21T20:34:30.153Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:34:30.153Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:34:30.153Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:34:30.153Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:34:30.153Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:34:30.153Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T20:34:30.154Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T20:34:30.154Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T20:34:40.116Z"
  }
}
[2025-12-21T20:34:31.153Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:34:31.154Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:34:31.155Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:34:31.155Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:34:31.155Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T20:34:31.156Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T20:34:31.156Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T20:34:31.156Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T20:34:40.116Z"
  }
}
[2025-12-21T20:38:36.690Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:38:36.691Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:38:36.691Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:38:36.691Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:38:36.691Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T20:38:36.691Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T20:38:36.691Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:38:36.691Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:38:36.691Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:39:36.691Z"
  }
}
[2025-12-21T20:38:37.680Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:38:37.681Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:38:37.681Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:38:37.681Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:38:37.681Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:38:37.681Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:38:37.681Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:38:37.681Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:39:36.691Z"
  }
}
[2025-12-21T20:39:25.611Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:39:25.611Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:39:25.612Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:39:25.612Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:39:25.612Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:39:25.613Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T20:39:25.613Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T20:39:25.613Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T20:39:36.691Z"
  }
}
[2025-12-21T20:39:26.602Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:39:26.602Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:39:26.602Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:39:26.602Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:39:26.602Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T20:39:26.603Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T20:39:26.603Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T20:39:26.603Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T20:39:36.691Z"
  }
}
[2025-12-21T20:41:26.263Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:41:26.263Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:41:26.263Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:41:26.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:41:26.263Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T20:41:26.263Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T20:41:26.263Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:41:26.263Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:41:26.263Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:42:26.263Z"
  }
}
[2025-12-21T20:41:27.310Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:41:27.311Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:41:27.311Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:41:27.311Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:41:27.311Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:41:27.311Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:41:27.311Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:41:27.311Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:42:26.263Z"
  }
}
[2025-12-21T20:41:32.785Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:41:32.786Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:41:32.786Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:41:32.786Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:41:32.786Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:41:32.786Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T20:41:32.786Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T20:41:32.786Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T20:42:26.263Z"
  }
}
[2025-12-21T20:41:35.159Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:41:35.159Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:41:35.160Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:41:35.160Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:41:35.160Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T20:41:35.160Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T20:41:35.160Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T20:41:35.160Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T20:42:26.263Z"
  }
}
[2025-12-21T20:45:01.543Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:45:01.543Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:45:01.543Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:45:01.543Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:45:01.543Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T20:45:01.544Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2025-12-21T20:45:01.544Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:45:01.544Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:45:01.544Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:46:01.543Z"
  }
}
[2025-12-21T20:45:02.595Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:45:02.595Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:45:02.596Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:45:02.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:45:02.596Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:45:02.596Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:45:02.596Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:45:02.596Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:46:01.543Z"
  }
}
[2025-12-21T20:47:22.868Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:47:22.868Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:47:22.868Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:47:22.868Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:47:22.868Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:47:22.868Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:47:22.868Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:47:22.869Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:47:22.869Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:48:22.868Z"
  }
}
[2025-12-21T20:47:23.915Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:47:23.916Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:47:23.916Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:47:23.916Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:47:23.916Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:47:23.916Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:47:23.916Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:47:23.916Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:48:22.868Z"
  }
}
[2025-12-21T20:50:36.694Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:50:36.695Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:50:36.696Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:50:36.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:50:36.696Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:50:36.696Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:50:36.696Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:50:36.696Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:50:36.697Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:51:36.696Z"
  }
}
[2025-12-21T20:50:37.499Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:50:37.500Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:50:37.500Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:50:37.500Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:50:37.500Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:50:37.500Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:50:37.501Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:50:37.501Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:51:36.696Z"
  }
}
[2025-12-21T20:52:09.254Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:52:09.255Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:52:09.255Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:52:09.255Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:52:09.255Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T20:52:09.255Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-21T20:52:09.255Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T20:52:09.255Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T20:52:09.255Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T20:53:09.255Z"
  }
}
[2025-12-21T20:52:10.302Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T20:52:10.302Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T20:52:10.302Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T20:52:10.302Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T20:52:10.302Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T20:52:10.302Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T20:52:10.302Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T20:52:10.303Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T20:53:09.255Z"
  }
}
[2025-12-21T21:06:34.502Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:06:34.503Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:06:34.503Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:06:34.503Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:06:34.503Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T21:06:34.503Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T21:06:34.503Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T21:06:34.503Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:06:35.395Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:06:35.395Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:06:35.395Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:06:35.395Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:06:35.395Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T21:06:35.395Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T21:06:35.395Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T21:06:35.395Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:06:48.470Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:06:48.473Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:06:48.473Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:06:48.473Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:06:48.473Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T21:06:48.473Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T21:06:48.473Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T21:06:48.473Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:06:49.516Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:06:49.517Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:06:49.517Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:06:49.517Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:06:49.518Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T21:06:49.518Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T21:06:49.518Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T21:06:49.518Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:07:03.195Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:07:03.196Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:07:03.196Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:07:03.196Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:07:03.196Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-21T21:07:03.196Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-21T21:07:03.196Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-21T21:07:03.197Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:07:04.262Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:07:04.262Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:07:04.263Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:07:04.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:07:04.264Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-21T21:07:04.264Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-21T21:07:04.264Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-21T21:07:04.264Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:07:18.540Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:07:18.541Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:07:18.541Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:07:18.541Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:07:18.541Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-21T21:07:18.541Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-21T21:07:18.541Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-21T21:07:18.541Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:07:19.466Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:07:19.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:07:19.467Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:07:19.467Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:07:19.468Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-21T21:07:19.468Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2025-12-21T21:07:19.468Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2025-12-21T21:07:19.468Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2025-12-21T21:07:34.503Z"
  }
}
[2025-12-21T21:13:20.909Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:13:20.910Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:13:20.910Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:13:20.910Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:13:20.910Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2025-12-21T21:13:20.911Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2025-12-21T21:13:20.911Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T21:13:20.911Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T21:13:20.911Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T21:14:20.910Z"
  }
}
[2025-12-21T21:13:21.895Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:13:21.895Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:13:21.896Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:13:21.896Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:13:21.896Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T21:13:21.896Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T21:13:21.896Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T21:13:21.896Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T21:14:20.910Z"
  }
}
[2025-12-21T21:13:36.225Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:13:36.225Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:13:36.225Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:13:36.225Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:13:36.225Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-21T21:13:36.225Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-21T21:13:36.225Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-21T21:13:36.225Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-21T21:14:20.910Z"
  }
}
[2025-12-21T21:13:37.171Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:13:37.172Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:13:37.172Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:13:37.172Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:13:37.172Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-21T21:13:37.172Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-21T21:13:37.172Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-21T21:13:37.172Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-21T21:14:20.910Z"
  }
}
[2025-12-21T21:25:09.832Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:25:09.834Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:25:09.834Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:25:09.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:25:09.835Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T21:25:09.835Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T21:25:09.835Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T21:25:09.835Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T21:26:09.834Z"
  }
}
[2025-12-21T21:25:10.708Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T21:25:10.708Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T21:25:10.708Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T21:25:10.709Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T21:25:10.709Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T21:25:10.709Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T21:25:10.709Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T21:25:10.709Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T21:26:09.834Z"
  }
}
[2025-12-21T22:33:58.615Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T22:33:58.616Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T22:33:58.617Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T22:33:58.617Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T22:33:58.617Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T22:33:58.617Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T22:33:58.617Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T22:33:58.617Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T22:34:58.617Z"
  }
}
[2025-12-21T22:33:59.460Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T22:33:59.460Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T22:33:59.460Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T22:33:59.460Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T22:33:59.461Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T22:33:59.461Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T22:33:59.461Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T22:33:59.461Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T22:34:58.617Z"
  }
}
[2025-12-21T22:53:47.937Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T22:53:47.938Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T22:53:47.938Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T22:53:47.939Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T22:53:47.939Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-21T22:53:47.939Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-21T22:53:47.939Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-21T22:53:47.939Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-21T22:54:47.939Z"
  }
}
[2025-12-21T22:53:48.706Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-21T22:53:48.707Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-21T22:53:48.707Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-21T22:53:48.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-21T22:53:48.707Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-21T22:53:48.708Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-21T22:53:48.708Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-21T22:53:48.708Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-21T22:54:47.939Z"
  }
}
[2025-12-22T12:12:26.449Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:26.451Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:26.451Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:26.451Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:26.452Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-22T12:12:26.452Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-22T12:12:26.452Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-22T12:12:26.452Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:12:27.336Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:27.336Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:27.337Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:27.337Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:27.337Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-22T12:12:27.337Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-22T12:12:27.337Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-22T12:12:27.337Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:12:35.624Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:35.625Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:35.625Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:35.625Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:35.625Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-22T12:12:35.625Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-22T12:12:35.625Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-22T12:12:35.625Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:12:36.681Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:36.681Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:36.682Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:36.682Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:36.682Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-22T12:12:36.682Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-22T12:12:36.682Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-22T12:12:36.682Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:12:37.791Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:37.791Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:37.792Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:37.792Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:37.792Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2025-12-22T12:12:37.792Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2025-12-22T12:12:37.792Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2025-12-22T12:12:37.792Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:12:38.770Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:12:38.770Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:12:38.771Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:12:38.771Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:12:38.771Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2025-12-22T12:12:38.771Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2025-12-22T12:12:38.771Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2025-12-22T12:12:38.771Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:13:25.478Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:13:25.479Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:13:25.479Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:13:25.479Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:13:25.479Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2025-12-22T12:13:25.479Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-22T12:13:25.479Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-22T12:13:25.479Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-22T12:13:26.451Z"
  }
}
[2025-12-22T12:13:26.554Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:13:26.554Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:13:26.554Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:13:26.555Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:13:26.555Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-22T12:13:26.555Z] Filtered old timestamps
{
  "before": 7,
  "after": 6,
  "removed": 1
}
[2025-12-22T12:13:26.555Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2025-12-22T12:13:26.555Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2025-12-22T12:13:26.555Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2025-12-22T12:13:27.337Z"
  }
}
[2025-12-22T12:16:40.789Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:16:40.789Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:16:40.789Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:16:40.789Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:16:40.789Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2025-12-22T12:16:40.789Z] Filtered old timestamps
{
  "before": 7,
  "after": 0,
  "removed": 7
}
[2025-12-22T12:16:40.789Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-22T12:16:40.789Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-22T12:16:40.790Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-22T12:17:40.789Z"
  }
}
[2025-12-22T12:16:42.340Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:16:42.340Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:16:42.340Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:16:42.341Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:16:42.341Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-22T12:16:42.341Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-22T12:16:42.341Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-22T12:16:42.341Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-22T12:17:40.789Z"
  }
}
[2025-12-22T12:28:15.168Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:28:15.169Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:28:15.169Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:28:15.169Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:28:15.169Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-22T12:28:15.169Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2025-12-22T12:28:15.170Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-22T12:28:15.170Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-22T12:28:15.170Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-22T12:29:15.169Z"
  }
}
[2025-12-22T12:28:15.274Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:28:15.274Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:28:15.274Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:28:15.274Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:28:15.274Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-22T12:28:15.274Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-22T12:28:15.274Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-22T12:28:15.274Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-22T12:29:15.169Z"
  }
}
[2025-12-22T12:28:16.046Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:28:16.046Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:28:16.046Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:28:16.046Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:28:16.046Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-22T12:28:16.046Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-22T12:28:16.046Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-22T12:28:16.047Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-22T12:29:15.169Z"
  }
}
[2025-12-22T12:28:16.092Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T12:28:16.093Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T12:28:16.093Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T12:28:16.093Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T12:28:16.093Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-22T12:28:16.093Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-22T12:28:16.093Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-22T12:28:16.093Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-22T12:29:15.169Z"
  }
}
[2025-12-22T22:45:50.715Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T22:45:50.716Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T22:45:50.716Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T22:45:50.716Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T22:45:50.716Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-22T22:45:50.716Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-22T22:45:50.716Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-22T22:45:50.716Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-22T22:46:50.716Z"
  }
}
[2025-12-22T22:45:51.267Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T22:45:51.268Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T22:45:51.268Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T22:45:51.268Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T22:45:51.268Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-22T22:45:51.268Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-22T22:45:51.268Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-22T22:45:51.268Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-22T22:46:50.716Z"
  }
}
[2025-12-22T22:45:51.575Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T22:45:51.575Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T22:45:51.575Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T22:45:51.575Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T22:45:51.575Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-22T22:45:51.575Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-22T22:45:51.575Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-22T22:45:51.575Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-22T22:46:50.716Z"
  }
}
[2025-12-22T22:45:51.889Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T22:45:51.889Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T22:45:51.889Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T22:45:51.890Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T22:45:51.890Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-22T22:45:51.890Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-22T22:45:51.890Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-22T22:45:51.890Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-22T22:46:50.716Z"
  }
}
[2025-12-22T23:21:29.156Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T23:21:29.156Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T23:21:29.156Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T23:21:29.156Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T23:21:29.156Z] Creating new entry
{
  "key": "token:unknown"
}
[2025-12-22T23:21:29.156Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2025-12-22T23:21:29.157Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2025-12-22T23:21:29.157Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2025-12-22T23:22:29.156Z"
  }
}
[2025-12-22T23:21:29.458Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T23:21:29.458Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T23:21:29.458Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T23:21:29.458Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T23:21:29.458Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2025-12-22T23:21:29.458Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2025-12-22T23:21:29.458Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2025-12-22T23:21:29.458Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2025-12-22T23:22:29.156Z"
  }
}
[2025-12-22T23:21:30.341Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T23:21:30.341Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T23:21:30.341Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T23:21:30.342Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T23:21:30.342Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2025-12-22T23:21:30.342Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2025-12-22T23:21:30.342Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2025-12-22T23:21:30.342Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2025-12-22T23:22:29.156Z"
  }
}
[2025-12-22T23:21:30.812Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2025-12-22T23:21:30.812Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2025-12-22T23:21:30.812Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2025-12-22T23:21:30.812Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2025-12-22T23:21:30.812Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2025-12-22T23:21:30.812Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2025-12-22T23:21:30.812Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2025-12-22T23:21:30.812Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2025-12-22T23:22:29.156Z"
  }
}
[2026-01-05T13:28:51.395Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:28:51.396Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:28:51.396Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:28:51.397Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:28:51.397Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T13:28:51.397Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T13:28:51.397Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T13:28:51.397Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:28:52.044Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:28:52.044Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:28:52.044Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:28:52.044Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:28:52.044Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T13:28:52.044Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T13:28:52.044Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T13:28:52.044Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:28:52.751Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:28:52.751Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:28:52.752Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:28:52.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:28:52.752Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-05T13:28:52.752Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-05T13:28:52.752Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-05T13:28:52.752Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:28:53.570Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:28:53.571Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:28:53.571Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:28:53.571Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:28:53.571Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-05T13:28:53.571Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-05T13:28:53.572Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-05T13:28:53.572Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:29:12.396Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:29:12.396Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:29:12.396Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:29:12.396Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:29:12.396Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-05T13:29:12.396Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-05T13:29:12.396Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-05T13:29:12.397Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:29:13.613Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:29:13.613Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:29:13.613Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:29:13.613Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:29:13.613Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-05T13:29:13.613Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-05T13:29:13.613Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-05T13:29:13.613Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-05T13:29:51.397Z"
  }
}
[2026-01-05T13:39:47.518Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:39:47.519Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:39:47.519Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:39:47.519Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:39:47.519Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-05T13:39:47.519Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2026-01-05T13:39:47.519Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T13:39:47.519Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T13:39:47.519Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:39:49.228Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:39:49.229Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:39:49.229Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:39:49.229Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:39:49.229Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T13:39:49.229Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T13:39:49.229Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T13:39:49.229Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:40:04.383Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:40:04.384Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:04.384Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:04.384Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:40:04.384Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-05T13:40:04.384Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-05T13:40:04.384Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-05T13:40:04.384Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:40:05.249Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:40:05.249Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:05.249Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:05.249Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:40:05.250Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-05T13:40:05.250Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-05T13:40:05.250Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-05T13:40:05.250Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:40:06.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620406923",
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.923Z] Creating new entry
{
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.923Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:06.923Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:06.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620406923",
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.924Z] Found existing entry
{
  "key": "login:test-allow-1767620406923",
  "timestampCount": 1
}
[2026-01-05T13:40:06.924Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:06.924Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:06.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620406923",
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.924Z] Found existing entry
{
  "key": "login:test-allow-1767620406923",
  "timestampCount": 2
}
[2026-01-05T13:40:06.924Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:06.924Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:06.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620406923",
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.924Z] Found existing entry
{
  "key": "login:test-allow-1767620406923",
  "timestampCount": 3
}
[2026-01-05T13:40:06.924Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:06.924Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:06.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620406923",
  "key": "login:test-allow-1767620406923"
}
[2026-01-05T13:40:06.924Z] Found existing entry
{
  "key": "login:test-allow-1767620406923",
  "timestampCount": 4
}
[2026-01-05T13:40:06.924Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:06.924Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:06.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Creating new entry
{
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:06.925Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:06.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Found existing entry
{
  "key": "login:test-block-1767620406925",
  "timestampCount": 1
}
[2026-01-05T13:40:06.925Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:06.925Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:06.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Found existing entry
{
  "key": "login:test-block-1767620406925",
  "timestampCount": 2
}
[2026-01-05T13:40:06.925Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:06.925Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:06.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Found existing entry
{
  "key": "login:test-block-1767620406925",
  "timestampCount": 3
}
[2026-01-05T13:40:06.925Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:06.925Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:06.925Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.925Z] Found existing entry
{
  "key": "login:test-block-1767620406925",
  "timestampCount": 4
}
[2026-01-05T13:40:06.925Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:06.925Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:06.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620406925",
  "key": "login:test-block-1767620406925"
}
[2026-01-05T13:40:06.926Z] Found existing entry
{
  "key": "login:test-block-1767620406925",
  "timestampCount": 5
}
[2026-01-05T13:40:06.926Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:40:06.926Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620406926",
  "key": "test-reset:test-reset-1767620406926"
}
[2026-01-05T13:40:06.926Z] Creating new entry
{
  "key": "test-reset:test-reset-1767620406926"
}
[2026-01-05T13:40:06.927Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:40:06.927Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:40:06.927Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620406926",
  "key": "test-reset:test-reset-1767620406926"
}
[2026-01-05T13:40:06.927Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620406926",
  "timestampCount": 1
}
[2026-01-05T13:40:06.927Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-05T13:40:06.927Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-05T13:40:06.927Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620406926",
  "key": "test-reset:test-reset-1767620406926"
}
[2026-01-05T13:40:06.927Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620406926",
  "timestampCount": 2
}
[2026-01-05T13:40:06.927Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-05T13:40:07.078Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620406926",
  "key": "test-reset:test-reset-1767620406926"
}
[2026-01-05T13:40:07.078Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620406926",
  "timestampCount": 2
}
[2026-01-05T13:40:07.078Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-05T13:40:07.078Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:40:07.079Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:40:07.079Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.079Z] Creating new entry
{
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.079Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:07.079Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:07.079Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.080Z] Found existing entry
{
  "key": "login:test-multi-1-1767620407079",
  "timestampCount": 1
}
[2026-01-05T13:40:07.080Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:07.080Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:07.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.080Z] Found existing entry
{
  "key": "login:test-multi-1-1767620407079",
  "timestampCount": 2
}
[2026-01-05T13:40:07.080Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:07.080Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:07.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.080Z] Found existing entry
{
  "key": "login:test-multi-1-1767620407079",
  "timestampCount": 3
}
[2026-01-05T13:40:07.080Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:07.080Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:07.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.080Z] Found existing entry
{
  "key": "login:test-multi-1-1767620407079",
  "timestampCount": 4
}
[2026-01-05T13:40:07.080Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:07.080Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:07.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620407079",
  "key": "login:test-multi-1-1767620407079"
}
[2026-01-05T13:40:07.080Z] Found existing entry
{
  "key": "login:test-multi-1-1767620407079",
  "timestampCount": 5
}
[2026-01-05T13:40:07.080Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:40:07.080Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767620407079",
  "key": "login:test-multi-2-1767620407079"
}
[2026-01-05T13:40:07.081Z] Creating new entry
{
  "key": "login:test-multi-2-1767620407079"
}
[2026-01-05T13:40:07.081Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:07.081Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:07.081Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767620407081",
  "key": "login:test-reset-time-1767620407081"
}
[2026-01-05T13:40:07.081Z] Creating new entry
{
  "key": "login:test-reset-time-1767620407081"
}
[2026-01-05T13:40:07.081Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:07.081Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:07.082Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:07.082Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:07.083Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:07.083Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-05T13:40:07.083Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:07.083Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:07.083Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:07.083Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:07.083Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:07.083Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:07.083Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620407083",
  "key": "test-sliding:test-sliding-1767620407083"
}
[2026-01-05T13:40:07.083Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767620407083"
}
[2026-01-05T13:40:07.083Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:07.083Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:07.184Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620407083",
  "key": "test-sliding:test-sliding-1767620407083"
}
[2026-01-05T13:40:07.184Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620407083",
  "timestampCount": 1
}
[2026-01-05T13:40:07.184Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:07.184Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:07.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620407083",
  "key": "test-sliding:test-sliding-1767620407083"
}
[2026-01-05T13:40:07.286Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620407083",
  "timestampCount": 2
}
[2026-01-05T13:40:07.286Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-05T13:40:07.286Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:07.286Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:07.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767620407286",
  "key": "register:test-format-allowed-1767620407286"
}
[2026-01-05T13:40:07.286Z] Creating new entry
{
  "key": "register:test-format-allowed-1767620407286"
}
[2026-01-05T13:40:07.286Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:07.286Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:07.287Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620407287",
  "key": "register:test-format-blocked-1767620407287"
}
[2026-01-05T13:40:07.287Z] Creating new entry
{
  "key": "register:test-format-blocked-1767620407287"
}
[2026-01-05T13:40:07.287Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:07.287Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:07.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620407287",
  "key": "register:test-format-blocked-1767620407287"
}
[2026-01-05T13:40:07.288Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620407287",
  "timestampCount": 1
}
[2026-01-05T13:40:07.288Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:07.288Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:07.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620407287",
  "key": "register:test-format-blocked-1767620407287"
}
[2026-01-05T13:40:07.288Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620407287",
  "timestampCount": 2
}
[2026-01-05T13:40:07.288Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-05T13:40:07.288Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-05T13:40:07.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620407287",
  "key": "register:test-format-blocked-1767620407287"
}
[2026-01-05T13:40:07.288Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620407287",
  "timestampCount": 3
}
[2026-01-05T13:40:07.288Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-05T13:40:19.745Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:40:19.745Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:19.752Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:19.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:40:19.758Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-05T13:40:19.758Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-05T13:40:19.759Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-05T13:40:19.759Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:40:20.712Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:40:20.712Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:20.712Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:20.712Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:40:20.712Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-05T13:40:20.712Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-05T13:40:20.712Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-05T13:40:20.712Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-05T13:40:47.519Z"
  }
}
[2026-01-05T13:40:24.679Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620424679",
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.698Z] Creating new entry
{
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.700Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:24.700Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:24.702Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620424679",
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.705Z] Found existing entry
{
  "key": "login:test-allow-1767620424679",
  "timestampCount": 1
}
[2026-01-05T13:40:24.706Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:24.706Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:24.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620424679",
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.707Z] Found existing entry
{
  "key": "login:test-allow-1767620424679",
  "timestampCount": 2
}
[2026-01-05T13:40:24.707Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:24.707Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:24.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620424679",
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.707Z] Found existing entry
{
  "key": "login:test-allow-1767620424679",
  "timestampCount": 3
}
[2026-01-05T13:40:24.707Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:24.707Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:24.707Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620424679",
  "key": "login:test-allow-1767620424679"
}
[2026-01-05T13:40:24.707Z] Found existing entry
{
  "key": "login:test-allow-1767620424679",
  "timestampCount": 4
}
[2026-01-05T13:40:24.707Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Creating new entry
{
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Found existing entry
{
  "key": "login:test-block-1767620424708",
  "timestampCount": 1
}
[2026-01-05T13:40:24.708Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Found existing entry
{
  "key": "login:test-block-1767620424708",
  "timestampCount": 2
}
[2026-01-05T13:40:24.708Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Found existing entry
{
  "key": "login:test-block-1767620424708",
  "timestampCount": 3
}
[2026-01-05T13:40:24.708Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.708Z] Found existing entry
{
  "key": "login:test-block-1767620424708",
  "timestampCount": 4
}
[2026-01-05T13:40:24.708Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:24.708Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:24.708Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620424708",
  "key": "login:test-block-1767620424708"
}
[2026-01-05T13:40:24.709Z] Found existing entry
{
  "key": "login:test-block-1767620424708",
  "timestampCount": 5
}
[2026-01-05T13:40:24.709Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:40:24.709Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620424709",
  "key": "test-reset:test-reset-1767620424709"
}
[2026-01-05T13:40:24.709Z] Creating new entry
{
  "key": "test-reset:test-reset-1767620424709"
}
[2026-01-05T13:40:24.709Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:40:24.709Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:40:24.709Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620424709",
  "key": "test-reset:test-reset-1767620424709"
}
[2026-01-05T13:40:24.709Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620424709",
  "timestampCount": 1
}
[2026-01-05T13:40:24.710Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-05T13:40:24.711Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-05T13:40:24.712Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620424709",
  "key": "test-reset:test-reset-1767620424709"
}
[2026-01-05T13:40:24.712Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620424709",
  "timestampCount": 2
}
[2026-01-05T13:40:24.712Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-05T13:40:24.865Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620424709",
  "key": "test-reset:test-reset-1767620424709"
}
[2026-01-05T13:40:24.865Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620424709",
  "timestampCount": 2
}
[2026-01-05T13:40:24.865Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-05T13:40:24.865Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:40:24.866Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:40:24.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.866Z] Creating new entry
{
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.866Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:24.866Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:24.866Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.866Z] Found existing entry
{
  "key": "login:test-multi-1-1767620424866",
  "timestampCount": 1
}
[2026-01-05T13:40:24.867Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:40:24.867Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:40:24.867Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.867Z] Found existing entry
{
  "key": "login:test-multi-1-1767620424866",
  "timestampCount": 2
}
[2026-01-05T13:40:24.867Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:40:24.867Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:40:24.867Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.867Z] Found existing entry
{
  "key": "login:test-multi-1-1767620424866",
  "timestampCount": 3
}
[2026-01-05T13:40:24.867Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:40:24.867Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:40:24.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.869Z] Found existing entry
{
  "key": "login:test-multi-1-1767620424866",
  "timestampCount": 4
}
[2026-01-05T13:40:24.869Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:40:24.869Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:40:24.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620424866",
  "key": "login:test-multi-1-1767620424866"
}
[2026-01-05T13:40:24.869Z] Found existing entry
{
  "key": "login:test-multi-1-1767620424866",
  "timestampCount": 5
}
[2026-01-05T13:40:24.869Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:40:24.870Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767620424866",
  "key": "login:test-multi-2-1767620424866"
}
[2026-01-05T13:40:24.870Z] Creating new entry
{
  "key": "login:test-multi-2-1767620424866"
}
[2026-01-05T13:40:24.870Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:24.870Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:24.870Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767620424870",
  "key": "login:test-reset-time-1767620424870"
}
[2026-01-05T13:40:24.871Z] Creating new entry
{
  "key": "login:test-reset-time-1767620424870"
}
[2026-01-05T13:40:24.871Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:40:24.871Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:40:24.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:24.872Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:24.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:24.872Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-05T13:40:24.872Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:24.872Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:24.873Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:24.873Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:40:24.874Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:40:24.874Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:40:24.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620424874",
  "key": "test-sliding:test-sliding-1767620424874"
}
[2026-01-05T13:40:24.874Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767620424874"
}
[2026-01-05T13:40:24.874Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:24.874Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:24.978Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620424874",
  "key": "test-sliding:test-sliding-1767620424874"
}
[2026-01-05T13:40:24.991Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620424874",
  "timestampCount": 1
}
[2026-01-05T13:40:24.994Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:25.006Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:25.110Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620424874",
  "key": "test-sliding:test-sliding-1767620424874"
}
[2026-01-05T13:40:25.116Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620424874",
  "timestampCount": 2
}
[2026-01-05T13:40:25.116Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-05T13:40:25.116Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:25.116Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:25.116Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767620425116",
  "key": "register:test-format-allowed-1767620425116"
}
[2026-01-05T13:40:25.116Z] Creating new entry
{
  "key": "register:test-format-allowed-1767620425116"
}
[2026-01-05T13:40:25.116Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:25.116Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:25.116Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620425116",
  "key": "register:test-format-blocked-1767620425116"
}
[2026-01-05T13:40:25.116Z] Creating new entry
{
  "key": "register:test-format-blocked-1767620425116"
}
[2026-01-05T13:40:25.116Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:40:25.117Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:40:25.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620425116",
  "key": "register:test-format-blocked-1767620425116"
}
[2026-01-05T13:40:25.117Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620425116",
  "timestampCount": 1
}
[2026-01-05T13:40:25.117Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:40:25.117Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:40:25.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620425116",
  "key": "register:test-format-blocked-1767620425116"
}
[2026-01-05T13:40:25.117Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620425116",
  "timestampCount": 2
}
[2026-01-05T13:40:25.117Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-05T13:40:25.117Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-05T13:40:25.117Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620425116",
  "key": "register:test-format-blocked-1767620425116"
}
[2026-01-05T13:40:25.117Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620425116",
  "timestampCount": 3
}
[2026-01-05T13:40:25.119Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-05T13:44:36.324Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620676324",
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.325Z] Creating new entry
{
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.325Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:44:36.325Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:44:36.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620676324",
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.326Z] Found existing entry
{
  "key": "login:test-allow-1767620676324",
  "timestampCount": 1
}
[2026-01-05T13:44:36.326Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:44:36.326Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:44:36.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620676324",
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.326Z] Found existing entry
{
  "key": "login:test-allow-1767620676324",
  "timestampCount": 2
}
[2026-01-05T13:44:36.326Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:44:36.326Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:44:36.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620676324",
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.326Z] Found existing entry
{
  "key": "login:test-allow-1767620676324",
  "timestampCount": 3
}
[2026-01-05T13:44:36.326Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:44:36.326Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:44:36.326Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767620676324",
  "key": "login:test-allow-1767620676324"
}
[2026-01-05T13:44:36.326Z] Found existing entry
{
  "key": "login:test-allow-1767620676324",
  "timestampCount": 4
}
[2026-01-05T13:44:36.326Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:44:36.327Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:44:36.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Creating new entry
{
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:44:36.327Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:44:36.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Found existing entry
{
  "key": "login:test-block-1767620676327",
  "timestampCount": 1
}
[2026-01-05T13:44:36.327Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:44:36.327Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:44:36.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Found existing entry
{
  "key": "login:test-block-1767620676327",
  "timestampCount": 2
}
[2026-01-05T13:44:36.327Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:44:36.327Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:44:36.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Found existing entry
{
  "key": "login:test-block-1767620676327",
  "timestampCount": 3
}
[2026-01-05T13:44:36.327Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:44:36.327Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:44:36.327Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.327Z] Found existing entry
{
  "key": "login:test-block-1767620676327",
  "timestampCount": 4
}
[2026-01-05T13:44:36.327Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:44:36.328Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:44:36.328Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767620676327",
  "key": "login:test-block-1767620676327"
}
[2026-01-05T13:44:36.328Z] Found existing entry
{
  "key": "login:test-block-1767620676327",
  "timestampCount": 5
}
[2026-01-05T13:44:36.328Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:44:36.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620676329",
  "key": "test-reset:test-reset-1767620676329"
}
[2026-01-05T13:44:36.329Z] Creating new entry
{
  "key": "test-reset:test-reset-1767620676329"
}
[2026-01-05T13:44:36.329Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:44:36.329Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:44:36.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620676329",
  "key": "test-reset:test-reset-1767620676329"
}
[2026-01-05T13:44:36.329Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620676329",
  "timestampCount": 1
}
[2026-01-05T13:44:36.329Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-05T13:44:36.329Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-05T13:44:36.329Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620676329",
  "key": "test-reset:test-reset-1767620676329"
}
[2026-01-05T13:44:36.329Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620676329",
  "timestampCount": 2
}
[2026-01-05T13:44:36.329Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-05T13:44:36.480Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767620676329",
  "key": "test-reset:test-reset-1767620676329"
}
[2026-01-05T13:44:36.481Z] Found existing entry
{
  "key": "test-reset:test-reset-1767620676329",
  "timestampCount": 2
}
[2026-01-05T13:44:36.481Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-05T13:44:36.481Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-05T13:44:36.481Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-05T13:44:36.481Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.481Z] Creating new entry
{
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.481Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:44:36.481Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:44:36.482Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.482Z] Found existing entry
{
  "key": "login:test-multi-1-1767620676481",
  "timestampCount": 1
}
[2026-01-05T13:44:36.482Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T13:44:36.482Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T13:44:36.482Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.482Z] Found existing entry
{
  "key": "login:test-multi-1-1767620676481",
  "timestampCount": 2
}
[2026-01-05T13:44:36.482Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T13:44:36.482Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T13:44:36.482Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.482Z] Found existing entry
{
  "key": "login:test-multi-1-1767620676481",
  "timestampCount": 3
}
[2026-01-05T13:44:36.482Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T13:44:36.482Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T13:44:36.482Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.482Z] Found existing entry
{
  "key": "login:test-multi-1-1767620676481",
  "timestampCount": 4
}
[2026-01-05T13:44:36.482Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T13:44:36.483Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T13:44:36.483Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767620676481",
  "key": "login:test-multi-1-1767620676481"
}
[2026-01-05T13:44:36.483Z] Found existing entry
{
  "key": "login:test-multi-1-1767620676481",
  "timestampCount": 5
}
[2026-01-05T13:44:36.483Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T13:44:36.483Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767620676481",
  "key": "login:test-multi-2-1767620676481"
}
[2026-01-05T13:44:36.483Z] Creating new entry
{
  "key": "login:test-multi-2-1767620676481"
}
[2026-01-05T13:44:36.483Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:44:36.483Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:44:36.483Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767620676483",
  "key": "login:test-reset-time-1767620676483"
}
[2026-01-05T13:44:36.483Z] Creating new entry
{
  "key": "login:test-reset-time-1767620676483"
}
[2026-01-05T13:44:36.483Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T13:44:36.483Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T13:44:36.484Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:36.484Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:44:36.485Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:36.485Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-05T13:44:36.485Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:36.485Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:44:36.485Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:36.485Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:44:36.485Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:36.485Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-05T13:44:36.485Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620676485",
  "key": "test-sliding:test-sliding-1767620676485"
}
[2026-01-05T13:44:36.485Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767620676485"
}
[2026-01-05T13:44:36.485Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:44:36.486Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:44:36.586Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620676485",
  "key": "test-sliding:test-sliding-1767620676485"
}
[2026-01-05T13:44:36.586Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620676485",
  "timestampCount": 1
}
[2026-01-05T13:44:36.586Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:44:36.586Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:44:36.687Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767620676485",
  "key": "test-sliding:test-sliding-1767620676485"
}
[2026-01-05T13:44:36.688Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767620676485",
  "timestampCount": 2
}
[2026-01-05T13:44:36.688Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-05T13:44:36.688Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:44:36.688Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:44:36.688Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767620676688",
  "key": "register:test-format-allowed-1767620676688"
}
[2026-01-05T13:44:36.689Z] Creating new entry
{
  "key": "register:test-format-allowed-1767620676688"
}
[2026-01-05T13:44:36.689Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:44:36.689Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:44:36.689Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620676689",
  "key": "register:test-format-blocked-1767620676689"
}
[2026-01-05T13:44:36.689Z] Creating new entry
{
  "key": "register:test-format-blocked-1767620676689"
}
[2026-01-05T13:44:36.689Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T13:44:36.689Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T13:44:36.689Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620676689",
  "key": "register:test-format-blocked-1767620676689"
}
[2026-01-05T13:44:36.689Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620676689",
  "timestampCount": 1
}
[2026-01-05T13:44:36.689Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T13:44:36.689Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T13:44:36.689Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620676689",
  "key": "register:test-format-blocked-1767620676689"
}
[2026-01-05T13:44:36.689Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620676689",
  "timestampCount": 2
}
[2026-01-05T13:44:36.689Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-05T13:44:36.689Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-05T13:44:36.689Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767620676689",
  "key": "register:test-format-blocked-1767620676689"
}
[2026-01-05T13:44:36.689Z] Found existing entry
{
  "key": "register:test-format-blocked-1767620676689",
  "timestampCount": 3
}
[2026-01-05T13:44:36.689Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-05T13:44:39.017Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:44:39.018Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:39.018Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:44:39.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:44:39.018Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-05T13:44:39.018Z] Filtered old timestamps
{
  "before": 6,
  "after": 0,
  "removed": 6
}
[2026-01-05T13:44:39.018Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T13:44:39.018Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T13:44:39.018Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T13:45:39.018Z"
  }
}
[2026-01-05T13:44:39.916Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:44:39.916Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:39.916Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:44:39.917Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:44:39.917Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T13:44:39.917Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T13:44:39.917Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T13:44:39.917Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T13:45:39.018Z"
  }
}
[2026-01-05T13:44:48.904Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:44:48.904Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:48.904Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:44:48.904Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:44:48.904Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-05T13:44:48.904Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-05T13:44:48.904Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-05T13:44:48.904Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-05T13:45:39.018Z"
  }
}
[2026-01-05T13:44:49.787Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T13:44:49.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T13:44:49.787Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T13:44:49.787Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T13:44:49.787Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-05T13:44:49.787Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-05T13:44:49.787Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-05T13:44:49.787Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-05T13:45:39.018Z"
  }
}
[2026-01-05T14:05:15.552Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:05:15.553Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:05:15.553Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:05:15.553Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:05:15.553Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T14:05:15.553Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T14:05:15.553Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T14:05:15.553Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T14:06:15.553Z"
  }
}
[2026-01-05T14:05:16.937Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:05:16.937Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:05:16.938Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:05:16.938Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:05:16.938Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T14:05:16.938Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T14:05:16.938Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T14:05:16.938Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T14:06:15.553Z"
  }
}
[2026-01-05T14:06:03.263Z] withRateLimit called
{
  "endpoint": "logout",
  "requestUrl": "/logout"
}
[2026-01-05T14:06:03.263Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:06:03.264Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:06:03.264Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "logout",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "logout:unknown"
}
[2026-01-05T14:06:03.264Z] Creating new entry
{
  "key": "logout:unknown"
}
[2026-01-05T14:06:03.264Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:06:03.264Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:06:03.265Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:07:03.264Z"
  }
}
[2026-01-05T14:10:35.922Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:10:35.923Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:10:35.923Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:10:35.923Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:10:35.923Z] Creating new entry
{
  "key": "register:unknown"
}
[2026-01-05T14:10:35.923Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:10:35.924Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:10:35.924Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:11:35.923Z"
  }
}
[2026-01-05T14:15:10.792Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/resend-code"
}
[2026-01-05T14:15:10.793Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:15:10.793Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:15:10.793Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:15:10.793Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2026-01-05T14:15:10.793Z] Filtered old timestamps
{
  "before": 1,
  "after": 0,
  "removed": 1
}
[2026-01-05T14:15:10.793Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:15:10.793Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:15:10.793Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:16:10.793Z"
  }
}
[2026-01-05T14:17:09.143Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/resend-code"
}
[2026-01-05T14:17:09.144Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:17:09.144Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:17:09.144Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:17:09.144Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2026-01-05T14:17:09.144Z] Filtered old timestamps
{
  "before": 1,
  "after": 0,
  "removed": 1
}
[2026-01-05T14:17:09.144Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:17:09.144Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:17:09.144Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:18:09.144Z"
  }
}
[2026-01-05T14:20:24.729Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:20:24.730Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:20:24.730Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:20:24.730Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:20:24.730Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2026-01-05T14:20:24.730Z] Filtered old timestamps
{
  "before": 1,
  "after": 0,
  "removed": 1
}
[2026-01-05T14:20:24.730Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:20:24.730Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:20:24.731Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:21:24.730Z"
  }
}
[2026-01-05T14:24:09.391Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:24:09.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:24:09.392Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:24:09.392Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:24:09.392Z] Creating new entry
{
  "key": "login:unknown"
}
[2026-01-05T14:24:09.392Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:24:09.392Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:24:09.392Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:25:09.392Z"
  }
}
[2026-01-05T14:24:28.018Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:24:28.018Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:24:28.018Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:24:28.018Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:24:28.018Z] Creating new entry
{
  "key": "register:unknown"
}
[2026-01-05T14:24:28.018Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:24:28.018Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:24:28.018Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:25:28.018Z"
  }
}
[2026-01-05T14:24:29.335Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:24:29.335Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:24:29.335Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:24:29.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:24:29.336Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2026-01-05T14:24:29.336Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:24:29.336Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:24:29.336Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:25:09.392Z"
  }
}
[2026-01-05T14:27:46.704Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:27:46.705Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:27:46.705Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:27:46.705Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:27:46.705Z] Creating new entry
{
  "key": "login:unknown"
}
[2026-01-05T14:27:46.705Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:27:46.705Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:27:46.705Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:28:46.705Z"
  }
}
[2026-01-05T14:28:04.108Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:28:04.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:28:04.108Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:28:04.108Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:28:04.108Z] Creating new entry
{
  "key": "register:unknown"
}
[2026-01-05T14:28:04.108Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:28:04.108Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:28:04.108Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:29:04.108Z"
  }
}
[2026-01-05T14:28:05.862Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:28:05.862Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:28:05.862Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:28:05.862Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:28:05.862Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2026-01-05T14:28:05.862Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:28:05.863Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:28:05.863Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:28:46.705Z"
  }
}
[2026-01-05T14:42:03.828Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:42:03.829Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:42:03.829Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:42:03.829Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:42:03.829Z] Creating new entry
{
  "key": "register:unknown"
}
[2026-01-05T14:42:03.829Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:42:03.829Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:42:03.830Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:43:03.829Z"
  }
}
[2026-01-05T14:42:24.160Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:42:24.160Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:42:24.161Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:42:24.161Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:42:24.161Z] Creating new entry
{
  "key": "login:unknown"
}
[2026-01-05T14:42:24.161Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:42:24.161Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:42:24.161Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:43:24.161Z"
  }
}
[2026-01-05T14:42:31.303Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:42:31.303Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:42:31.303Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:42:31.303Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:42:31.303Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T14:42:31.303Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T14:42:31.303Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T14:42:31.303Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T14:43:31.303Z"
  }
}
[2026-01-05T14:42:32.113Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:42:32.113Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:42:32.114Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:42:32.114Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:42:32.114Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T14:42:32.114Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T14:42:32.114Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T14:42:32.114Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T14:43:31.303Z"
  }
}
[2026-01-05T14:43:10.293Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:43:10.294Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:10.294Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:10.294Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:43:10.294Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T14:43:10.294Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T14:43:10.294Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T14:43:10.294Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T14:44:10.294Z"
  }
}
[2026-01-05T14:43:12.084Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:43:12.084Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:12.084Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:12.084Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:43:12.084Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T14:43:12.084Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T14:43:12.084Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T14:43:12.084Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T14:44:10.294Z"
  }
}
[2026-01-05T14:43:14.923Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:14.923Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:14.924Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:14.924Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:43:14.924Z] Creating new entry
{
  "key": "register:unknown"
}
[2026-01-05T14:43:14.924Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:43:14.924Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:43:14.924Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:14.924Z"
  }
}
[2026-01-05T14:43:15.108Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/forgot-password"
}
[2026-01-05T14:43:15.108Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:15.109Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:15.109Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:43:15.109Z] Creating new entry
{
  "key": "login:unknown"
}
[2026-01-05T14:43:15.109Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:15.110Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:15.110Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:15.109Z"
  }
}
[2026-01-05T14:43:15.930Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:15.930Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:15.930Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:15.930Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:43:15.930Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 1
}
[2026-01-05T14:43:15.930Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:15.930Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:15.930Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:15.109Z"
  }
}
[2026-01-05T14:43:16.262Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.262Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:16.263Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.263Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.263Z] Creating new entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.263Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:16.263Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:16.263Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:16.397Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/reset-password"
}
[2026-01-05T14:43:16.397Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:16.398Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:16.398Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "login:unknown"
}
[2026-01-05T14:43:16.398Z] Found existing entry
{
  "key": "login:unknown",
  "timestampCount": 2
}
[2026-01-05T14:43:16.398Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:16.398Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:16.398Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:15.109Z"
  }
}
[2026-01-05T14:43:16.476Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-headers-1767624196468-36767",
  "willUseTestId": true
}
[2026-01-05T14:43:16.476Z] Using test identifier
{
  "identifier": "test:login-headers-1767624196468-36767"
}
[2026-01-05T14:43:16.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-headers-1767624196468-36767",
  "key": "login:test:login-headers-1767624196468-36767"
}
[2026-01-05T14:43:16.476Z] Creating new entry
{
  "key": "login:test:login-headers-1767624196468-36767"
}
[2026-01-05T14:43:16.476Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:16.477Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:16.477Z] Rate limit check result
{
  "identifier": "test:login-headers-1767624196468-36767",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:16.476Z"
  }
}
[2026-01-05T14:43:16.544Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.544Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:16.544Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.544Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.544Z] Found existing entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8",
  "timestampCount": 1
}
[2026-01-05T14:43:16.544Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:16.544Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:16.544Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:16.660Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.660Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:16.660Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:16.660Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:16.660Z] Creating new entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:16.660Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:16.660Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:16.660Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:16.839Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.839Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:16.839Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.839Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:16.840Z] Found existing entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8",
  "timestampCount": 2
}
[2026-01-05T14:43:16.840Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:16.840Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:16.840Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:16.874Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:16.874Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1767624196870-1osiqp",
  "willUseTestId": true
}
[2026-01-05T14:43:16.874Z] Using test identifier
{
  "identifier": "test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:16.874Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "key": "register:test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:16.874Z] Creating new entry
{
  "key": "register:test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:16.874Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:43:16.874Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:43:16.874Z] Rate limit check result
{
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:16.874Z"
  }
}
[2026-01-05T14:43:16.878Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:16.879Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:16.879Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:16.879Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:16.879Z] Found existing entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd",
  "timestampCount": 1
}
[2026-01-05T14:43:16.879Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:16.879Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:16.879Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:17.123Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.123Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:17.124Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.124Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.124Z] Found existing entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8",
  "timestampCount": 3
}
[2026-01-05T14:43:17.124Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T14:43:17.124Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T14:43:17.124Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:17.148Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.148Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:17.148Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.148Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.148Z] Found existing entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd",
  "timestampCount": 2
}
[2026-01-05T14:43:17.148Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:17.148Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:17.148Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:17.224Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:17.224Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1767624196870-1osiqp",
  "willUseTestId": true
}
[2026-01-05T14:43:17.225Z] Using test identifier
{
  "identifier": "test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.225Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "key": "register:test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.225Z] Found existing entry
{
  "key": "register:test:register-excessive-1767624196870-1osiqp",
  "timestampCount": 1
}
[2026-01-05T14:43:17.225Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T14:43:17.225Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T14:43:17.225Z] Rate limit check result
{
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:16.874Z"
  }
}
[2026-01-05T14:43:17.385Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.385Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:17.385Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.386Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.386Z] Found existing entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd",
  "timestampCount": 3
}
[2026-01-05T14:43:17.386Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T14:43:17.386Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T14:43:17.386Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:17.405Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.405Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:17.405Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.405Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.405Z] Found existing entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8",
  "timestampCount": 4
}
[2026-01-05T14:43:17.405Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T14:43:17.405Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T14:43:17.405Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:17.409Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:17.409Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-headers-1767624197405-373pgk",
  "willUseTestId": true
}
[2026-01-05T14:43:17.409Z] Using test identifier
{
  "identifier": "test:register-headers-1767624197405-373pgk"
}
[2026-01-05T14:43:17.409Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-headers-1767624197405-373pgk",
  "key": "register:test:register-headers-1767624197405-373pgk"
}
[2026-01-05T14:43:17.409Z] Creating new entry
{
  "key": "register:test:register-headers-1767624197405-373pgk"
}
[2026-01-05T14:43:17.409Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:43:17.409Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:43:17.409Z] Rate limit check result
{
  "identifier": "test:register-headers-1767624197405-373pgk",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:17.409Z"
  }
}
[2026-01-05T14:43:17.592Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:17.592Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1767624196870-1osiqp",
  "willUseTestId": true
}
[2026-01-05T14:43:17.592Z] Using test identifier
{
  "identifier": "test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "key": "register:test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.592Z] Found existing entry
{
  "key": "register:test:register-excessive-1767624196870-1osiqp",
  "timestampCount": 2
}
[2026-01-05T14:43:17.592Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-05T14:43:17.592Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-05T14:43:17.593Z] Rate limit check result
{
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.874Z"
  }
}
[2026-01-05T14:43:17.608Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.608Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:17.608Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.608Z] Found existing entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd",
  "timestampCount": 4
}
[2026-01-05T14:43:17.608Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T14:43:17.608Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T14:43:17.608Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:17.787Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.787Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:17.787Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:17.787Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:17.787Z] Creating new entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:17.787Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:17.787Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:17.787Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:17.822Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.822Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-retry-after-1767624196649-2a2dtd",
  "willUseTestId": true
}
[2026-01-05T14:43:17.822Z] Using test identifier
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.822Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "key": "login:test:login-retry-after-1767624196649-2a2dtd"
}
[2026-01-05T14:43:17.822Z] Found existing entry
{
  "key": "login:test:login-retry-after-1767624196649-2a2dtd",
  "timestampCount": 5
}
[2026-01-05T14:43:17.822Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T14:43:17.823Z] Rate limit check result
{
  "identifier": "test:login-retry-after-1767624196649-2a2dtd",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.660Z"
  }
}
[2026-01-05T14:43:17.836Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.836Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1767624197834-mvndws",
  "willUseTestId": true
}
[2026-01-05T14:43:17.836Z] Using test identifier
{
  "identifier": "test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:17.836Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "key": "login:test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:17.836Z] Creating new entry
{
  "key": "login:test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:17.836Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:17.837Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:17.837Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:17.836Z"
  }
}
[2026-01-05T14:43:17.838Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.838Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "login-excessive-1767624196249-qzqrh8",
  "willUseTestId": true
}
[2026-01-05T14:43:17.838Z] Using test identifier
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.838Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "key": "login:test:login-excessive-1767624196249-qzqrh8"
}
[2026-01-05T14:43:17.838Z] Found existing entry
{
  "key": "login:test:login-excessive-1767624196249-qzqrh8",
  "timestampCount": 5
}
[2026-01-05T14:43:17.838Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T14:43:17.838Z] Rate limit check result
{
  "identifier": "test:login-excessive-1767624196249-qzqrh8",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.263Z"
  }
}
[2026-01-05T14:43:17.852Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.852Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1767624197850-jk6yx",
  "willUseTestId": true
}
[2026-01-05T14:43:17.852Z] Using test identifier
{
  "identifier": "test:headers-consistent-1767624197850-jk6yx"
}
[2026-01-05T14:43:17.852Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1767624197850-jk6yx",
  "key": "login:test:headers-consistent-1767624197850-jk6yx"
}
[2026-01-05T14:43:17.852Z] Creating new entry
{
  "key": "login:test:headers-consistent-1767624197850-jk6yx"
}
[2026-01-05T14:43:17.853Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:17.853Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:17.853Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1767624197850-jk6yx",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:17.852Z"
  }
}
[2026-01-05T14:43:17.934Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:17.938Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "register-excessive-1767624196870-1osiqp",
  "willUseTestId": true
}
[2026-01-05T14:43:17.938Z] Using test identifier
{
  "identifier": "test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.938Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "key": "register:test:register-excessive-1767624196870-1osiqp"
}
[2026-01-05T14:43:17.938Z] Found existing entry
{
  "key": "register:test:register-excessive-1767624196870-1osiqp",
  "timestampCount": 3
}
[2026-01-05T14:43:17.938Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-05T14:43:17.938Z] Rate limit check result
{
  "identifier": "test:register-excessive-1767624196870-1osiqp",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:16.874Z"
  }
}
[2026-01-05T14:43:17.956Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:17.956Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "perf-test-1767624197954-xkc5m",
  "willUseTestId": true
}
[2026-01-05T14:43:17.956Z] Using test identifier
{
  "identifier": "test:perf-test-1767624197954-xkc5m"
}
[2026-01-05T14:43:17.956Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:perf-test-1767624197954-xkc5m",
  "key": "login:test:perf-test-1767624197954-xkc5m"
}
[2026-01-05T14:43:17.956Z] Creating new entry
{
  "key": "login:test:perf-test-1767624197954-xkc5m"
}
[2026-01-05T14:43:17.956Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:17.956Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:17.956Z] Rate limit check result
{
  "identifier": "test:perf-test-1767624197954-xkc5m",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:17.956Z"
  }
}
[2026-01-05T14:43:18.050Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.050Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1767624197834-mvndws",
  "willUseTestId": true
}
[2026-01-05T14:43:18.050Z] Using test identifier
{
  "identifier": "test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:18.050Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "key": "login:test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:18.050Z] Found existing entry
{
  "key": "login:test:headers-remaining-1767624197834-mvndws",
  "timestampCount": 1
}
[2026-01-05T14:43:18.050Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:18.050Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:18.050Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:17.836Z"
  }
}
[2026-01-05T14:43:18.073Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.073Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-consistent-1767624197850-jk6yx",
  "willUseTestId": true
}
[2026-01-05T14:43:18.073Z] Using test identifier
{
  "identifier": "test:headers-consistent-1767624197850-jk6yx"
}
[2026-01-05T14:43:18.073Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-consistent-1767624197850-jk6yx",
  "key": "login:test:headers-consistent-1767624197850-jk6yx"
}
[2026-01-05T14:43:18.073Z] Found existing entry
{
  "key": "login:test:headers-consistent-1767624197850-jk6yx",
  "timestampCount": 1
}
[2026-01-05T14:43:18.073Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:18.073Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:18.073Z] Rate limit check result
{
  "identifier": "test:headers-consistent-1767624197850-jk6yx",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:17.852Z"
  }
}
[2026-01-05T14:43:18.102Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.102Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:18.102Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.102Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco",
  "timestampCount": 1
}
[2026-01-05T14:43:18.102Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:18.102Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:18.102Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:18.283Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.283Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "headers-remaining-1767624197834-mvndws",
  "willUseTestId": true
}
[2026-01-05T14:43:18.283Z] Using test identifier
{
  "identifier": "test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:18.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "key": "login:test:headers-remaining-1767624197834-mvndws"
}
[2026-01-05T14:43:18.283Z] Found existing entry
{
  "key": "login:test:headers-remaining-1767624197834-mvndws",
  "timestampCount": 2
}
[2026-01-05T14:43:18.283Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:18.283Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:18.284Z] Rate limit check result
{
  "identifier": "test:headers-remaining-1767624197834-mvndws",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:17.836Z"
  }
}
[2026-01-05T14:43:18.332Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.332Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:18.333Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.333Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco",
  "timestampCount": 2
}
[2026-01-05T14:43:18.333Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:18.333Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:18.333Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:18.564Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.565Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:18.565Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.565Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.565Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco",
  "timestampCount": 3
}
[2026-01-05T14:43:18.565Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T14:43:18.565Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T14:43:18.565Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:18.884Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:18.884Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:18.884Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.884Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:18.884Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco",
  "timestampCount": 4
}
[2026-01-05T14:43:18.884Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T14:43:18.884Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T14:43:18.884Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:19.117Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/login"
}
[2026-01-05T14:43:19.117Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:19.117Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:19.118Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "login:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:19.118Z] Found existing entry
{
  "key": "login:test:independent-endpoints-1767624197785-slosco",
  "timestampCount": 5
}
[2026-01-05T14:43:19.118Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-05T14:43:19.118Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": false,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:17.787Z"
  }
}
[2026-01-05T14:43:19.124Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:19.126Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "independent-endpoints-1767624197785-slosco",
  "willUseTestId": true
}
[2026-01-05T14:43:19.126Z] Using test identifier
{
  "identifier": "test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:19.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "key": "register:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:19.126Z] Creating new entry
{
  "key": "register:test:independent-endpoints-1767624197785-slosco"
}
[2026-01-05T14:43:19.126Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-05T14:43:19.126Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-05T14:43:19.126Z] Rate limit check result
{
  "identifier": "test:independent-endpoints-1767624197785-slosco",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:19.126Z"
  }
}
[2026-01-05T14:43:20.998Z] withRateLimit called
{
  "endpoint": "register",
  "requestUrl": "/auth/register"
}
[2026-01-05T14:43:20.999Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:43:20.999Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:43:20.999Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "register:unknown"
}
[2026-01-05T14:43:20.999Z] Found existing entry
{
  "key": "register:unknown",
  "timestampCount": 1
}
[2026-01-05T14:43:20.999Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-05T14:43:20.999Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-05T14:43:20.999Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:14.924Z"
  }
}
[2026-01-05T14:43:21.870Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:21.870Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "rate-limit-test-1767624199208",
  "willUseTestId": true
}
[2026-01-05T14:43:21.870Z] Using test identifier
{
  "identifier": "test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:21.871Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:rate-limit-test-1767624199208",
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:21.871Z] Creating new entry
{
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:21.871Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-05T14:43:21.871Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-05T14:43:21.871Z] Rate limit check result
{
  "identifier": "test:rate-limit-test-1767624199208",
  "result": {
    "allowed": true,
    "remaining": 4,
    "resetAt": "2026-01-05T14:44:21.871Z"
  }
}
[2026-01-05T14:43:22.155Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:22.155Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "rate-limit-test-1767624199208",
  "willUseTestId": true
}
[2026-01-05T14:43:22.155Z] Using test identifier
{
  "identifier": "test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.155Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:rate-limit-test-1767624199208",
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.156Z] Found existing entry
{
  "key": "login:test:rate-limit-test-1767624199208",
  "timestampCount": 1
}
[2026-01-05T14:43:22.156Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-05T14:43:22.156Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-05T14:43:22.156Z] Rate limit check result
{
  "identifier": "test:rate-limit-test-1767624199208",
  "result": {
    "allowed": true,
    "remaining": 3,
    "resetAt": "2026-01-05T14:44:21.871Z"
  }
}
[2026-01-05T14:43:22.442Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:22.442Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "rate-limit-test-1767624199208",
  "willUseTestId": true
}
[2026-01-05T14:43:22.443Z] Using test identifier
{
  "identifier": "test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.443Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:rate-limit-test-1767624199208",
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.443Z] Found existing entry
{
  "key": "login:test:rate-limit-test-1767624199208",
  "timestampCount": 2
}
[2026-01-05T14:43:22.443Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-05T14:43:22.443Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-05T14:43:22.443Z] Rate limit check result
{
  "identifier": "test:rate-limit-test-1767624199208",
  "result": {
    "allowed": true,
    "remaining": 2,
    "resetAt": "2026-01-05T14:44:21.871Z"
  }
}
[2026-01-05T14:43:22.740Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:22.740Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "rate-limit-test-1767624199208",
  "willUseTestId": true
}
[2026-01-05T14:43:22.740Z] Using test identifier
{
  "identifier": "test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.741Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:rate-limit-test-1767624199208",
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:22.741Z] Found existing entry
{
  "key": "login:test:rate-limit-test-1767624199208",
  "timestampCount": 3
}
[2026-01-05T14:43:22.741Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-05T14:43:22.741Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-05T14:43:22.741Z] Rate limit check result
{
  "identifier": "test:rate-limit-test-1767624199208",
  "result": {
    "allowed": true,
    "remaining": 1,
    "resetAt": "2026-01-05T14:44:21.871Z"
  }
}
[2026-01-05T14:43:23.035Z] withRateLimit called
{
  "endpoint": "login",
  "requestUrl": "/auth/verify-email"
}
[2026-01-05T14:43:23.036Z] getClientIdentifier START
{
  "e2eTestMode": {
    "processEnv": "true",
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": "rate-limit-test-1767624199208",
  "willUseTestId": true
}
[2026-01-05T14:43:23.036Z] Using test identifier
{
  "identifier": "test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:23.036Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test:rate-limit-test-1767624199208",
  "key": "login:test:rate-limit-test-1767624199208"
}
[2026-01-05T14:43:23.036Z] Found existing entry
{
  "key": "login:test:rate-limit-test-1767624199208",
  "timestampCount": 4
}
[2026-01-05T14:43:23.036Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-05T14:43:23.036Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-05T14:43:23.036Z] Rate limit check result
{
  "identifier": "test:rate-limit-test-1767624199208",
  "result": {
    "allowed": true,
    "remaining": 0,
    "resetAt": "2026-01-05T14:44:21.871Z"
  }
}
[2026-01-05T14:44:37.472Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:44:37.473Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:44:37.473Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:44:37.474Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:44:37.474Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T14:44:37.474Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T14:44:37.474Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T14:44:37.474Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:44:38.356Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:44:38.357Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:44:38.357Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:44:38.357Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:44:38.357Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T14:44:38.357Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T14:44:38.357Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T14:44:38.358Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:44:45.900Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:44:45.900Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:44:45.900Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:44:45.900Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:44:45.900Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-05T14:44:45.901Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-05T14:44:45.901Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-05T14:44:45.901Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:44:46.691Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:44:46.691Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:44:46.691Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:44:46.691Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:44:46.691Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-05T14:44:46.691Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-05T14:44:46.691Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-05T14:44:46.691Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:45:11.485Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:45:11.485Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:45:11.486Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:45:11.486Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:45:11.486Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-05T14:45:11.486Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-05T14:45:11.486Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-05T14:45:11.487Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:45:12.403Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:45:12.403Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:45:12.404Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:45:12.404Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:45:12.404Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-05T14:45:12.405Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-05T14:45:12.405Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-05T14:45:12.405Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:45:13.165Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:45:13.165Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:45:13.166Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:45:13.166Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:45:13.166Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-05T14:45:13.166Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-05T14:45:13.166Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-05T14:45:13.166Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:45:14.553Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:45:14.553Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:45:14.554Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:45:14.554Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:45:14.554Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-05T14:45:14.554Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-05T14:45:14.554Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-05T14:45:14.555Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-05T14:45:37.474Z"
  }
}
[2026-01-05T14:57:01.269Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:57:01.271Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:57:01.271Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:57:01.271Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:57:01.271Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2026-01-05T14:57:01.271Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2026-01-05T14:57:01.271Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T14:57:01.271Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T14:57:01.272Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T14:58:01.271Z"
  }
}
[2026-01-05T14:57:02.126Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T14:57:02.126Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T14:57:02.126Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T14:57:02.126Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T14:57:02.127Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T14:57:02.127Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T14:57:02.127Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T14:57:02.127Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T14:58:01.271Z"
  }
}
[2026-01-05T15:41:55.408Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T15:41:55.408Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T15:41:55.408Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T15:41:55.408Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T15:41:55.408Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T15:41:55.408Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T15:41:55.408Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T15:41:55.408Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T15:42:55.408Z"
  }
}
[2026-01-05T15:41:56.257Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T15:41:56.257Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T15:41:56.257Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T15:41:56.258Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T15:41:56.258Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T15:41:56.258Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T15:41:56.258Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T15:41:56.258Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T15:42:55.408Z"
  }
}
[2026-01-05T16:03:00.898Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T16:03:00.898Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T16:03:00.898Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T16:03:00.898Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T16:03:00.898Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T16:03:00.898Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T16:03:00.898Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T16:03:00.898Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T16:04:00.898Z"
  }
}
[2026-01-05T16:03:01.913Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T16:03:01.913Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T16:03:01.913Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T16:03:01.913Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T16:03:01.913Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T16:03:01.914Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T16:03:01.914Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T16:03:01.914Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T16:04:00.898Z"
  }
}
[2026-01-05T17:20:00.196Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T17:20:00.196Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T17:20:00.196Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T17:20:00.196Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T17:20:00.196Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T17:20:00.196Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T17:20:00.196Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T17:20:00.196Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T17:21:00.196Z"
  }
}
[2026-01-05T17:20:01.088Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T17:20:01.088Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T17:20:01.089Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T17:20:01.089Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T17:20:01.089Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T17:20:01.089Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T17:20:01.090Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T17:20:01.090Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T17:21:00.196Z"
  }
}
[2026-01-05T20:07:51.291Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T20:07:51.293Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T20:07:51.293Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T20:07:51.294Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T20:07:51.294Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-05T20:07:51.294Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-05T20:07:51.295Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-05T20:07:51.295Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-05T20:08:51.294Z"
  }
}
[2026-01-05T20:07:52.179Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-05T20:07:52.180Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-05T20:07:52.181Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-05T20:07:52.181Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-05T20:07:52.181Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-05T20:07:52.182Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-05T20:07:52.182Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-05T20:07:52.183Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-05T20:08:51.294Z"
  }
}
[2026-01-06T08:22:44.679Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:22:44.680Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:22:44.681Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:22:44.681Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:22:44.681Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T08:22:44.681Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T08:22:44.681Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T08:22:44.681Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:22:45.547Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:22:45.551Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:22:45.551Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:22:45.551Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:22:45.551Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T08:22:45.551Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T08:22:45.551Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T08:22:45.552Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:08.815Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:08.817Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:08.817Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:08.817Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:08.817Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T08:23:08.817Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T08:23:08.817Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T08:23:08.817Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:09.419Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:09.419Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:09.419Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:09.419Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:09.419Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T08:23:09.419Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T08:23:09.419Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T08:23:09.419Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:10.278Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:10.279Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:10.279Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:10.279Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:10.280Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T08:23:10.280Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T08:23:10.280Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T08:23:10.280Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:10.869Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:10.869Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:10.869Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:10.869Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:10.869Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T08:23:10.869Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T08:23:10.870Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T08:23:10.870Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:42.417Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:42.417Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:42.417Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:42.417Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:42.417Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T08:23:42.417Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T08:23:42.417Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T08:23:42.417Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T08:23:43.303Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T08:23:43.303Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T08:23:43.303Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T08:23:43.303Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T08:23:43.303Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T08:23:43.303Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T08:23:43.303Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T08:23:43.303Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T08:23:44.681Z"
  }
}
[2026-01-06T10:35:01.573Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T10:35:01.574Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T10:35:01.574Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T10:35:01.574Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T10:35:01.574Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T10:35:01.574Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T10:35:01.574Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T10:35:01.574Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T10:36:01.574Z"
  }
}
[2026-01-06T10:35:02.476Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T10:35:02.476Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T10:35:02.476Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T10:35:02.476Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T10:35:02.477Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T10:35:02.477Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T10:35:02.477Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T10:35:02.477Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T10:36:01.574Z"
  }
}
[2026-01-06T10:48:24.695Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T10:48:24.696Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T10:48:24.696Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T10:48:24.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T10:48:24.696Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T10:48:24.696Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T10:48:24.696Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T10:48:24.696Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T10:48:24.696Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T10:49:24.696Z"
  }
}
[2026-01-06T10:48:25.588Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T10:48:25.588Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T10:48:25.589Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T10:48:25.589Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T10:48:25.589Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T10:48:25.589Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T10:48:25.589Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T10:48:25.589Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T10:49:24.696Z"
  }
}
[2026-01-06T13:43:28.947Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707008947",
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.947Z] Creating new entry
{
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.948Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:43:28.948Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:43:28.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707008947",
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.948Z] Found existing entry
{
  "key": "login:test-allow-1767707008947",
  "timestampCount": 1
}
[2026-01-06T13:43:28.948Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:43:28.948Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:43:28.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707008947",
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.948Z] Found existing entry
{
  "key": "login:test-allow-1767707008947",
  "timestampCount": 2
}
[2026-01-06T13:43:28.948Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:43:28.948Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:43:28.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707008947",
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.948Z] Found existing entry
{
  "key": "login:test-allow-1767707008947",
  "timestampCount": 3
}
[2026-01-06T13:43:28.948Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:43:28.948Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:43:28.948Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707008947",
  "key": "login:test-allow-1767707008947"
}
[2026-01-06T13:43:28.948Z] Found existing entry
{
  "key": "login:test-allow-1767707008947",
  "timestampCount": 4
}
[2026-01-06T13:43:28.948Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:43:28.949Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:43:28.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Creating new entry
{
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:43:28.949Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:43:28.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Found existing entry
{
  "key": "login:test-block-1767707008949",
  "timestampCount": 1
}
[2026-01-06T13:43:28.949Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:43:28.949Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:43:28.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Found existing entry
{
  "key": "login:test-block-1767707008949",
  "timestampCount": 2
}
[2026-01-06T13:43:28.949Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:43:28.949Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:43:28.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Found existing entry
{
  "key": "login:test-block-1767707008949",
  "timestampCount": 3
}
[2026-01-06T13:43:28.949Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:43:28.949Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:43:28.949Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.949Z] Found existing entry
{
  "key": "login:test-block-1767707008949",
  "timestampCount": 4
}
[2026-01-06T13:43:28.949Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:43:28.950Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:43:28.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707008949",
  "key": "login:test-block-1767707008949"
}
[2026-01-06T13:43:28.950Z] Found existing entry
{
  "key": "login:test-block-1767707008949",
  "timestampCount": 5
}
[2026-01-06T13:43:28.950Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T13:43:28.950Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707008950",
  "key": "test-reset:test-reset-1767707008950"
}
[2026-01-06T13:43:28.951Z] Creating new entry
{
  "key": "test-reset:test-reset-1767707008950"
}
[2026-01-06T13:43:28.951Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T13:43:28.951Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T13:43:28.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707008950",
  "key": "test-reset:test-reset-1767707008950"
}
[2026-01-06T13:43:28.951Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707008950",
  "timestampCount": 1
}
[2026-01-06T13:43:28.951Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T13:43:28.951Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T13:43:28.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707008950",
  "key": "test-reset:test-reset-1767707008950"
}
[2026-01-06T13:43:28.951Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707008950",
  "timestampCount": 2
}
[2026-01-06T13:43:28.951Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T13:43:29.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707008950",
  "key": "test-reset:test-reset-1767707008950"
}
[2026-01-06T13:43:29.103Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707008950",
  "timestampCount": 2
}
[2026-01-06T13:43:29.103Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T13:43:29.103Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T13:43:29.103Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T13:43:29.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.103Z] Creating new entry
{
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.103Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:43:29.103Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:43:29.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.103Z] Found existing entry
{
  "key": "login:test-multi-1-1767707009103",
  "timestampCount": 1
}
[2026-01-06T13:43:29.103Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:43:29.103Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:43:29.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.103Z] Found existing entry
{
  "key": "login:test-multi-1-1767707009103",
  "timestampCount": 2
}
[2026-01-06T13:43:29.103Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:43:29.103Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:43:29.103Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.103Z] Found existing entry
{
  "key": "login:test-multi-1-1767707009103",
  "timestampCount": 3
}
[2026-01-06T13:43:29.104Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:43:29.104Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:43:29.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.104Z] Found existing entry
{
  "key": "login:test-multi-1-1767707009103",
  "timestampCount": 4
}
[2026-01-06T13:43:29.104Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:43:29.104Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:43:29.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707009103",
  "key": "login:test-multi-1-1767707009103"
}
[2026-01-06T13:43:29.104Z] Found existing entry
{
  "key": "login:test-multi-1-1767707009103",
  "timestampCount": 5
}
[2026-01-06T13:43:29.104Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T13:43:29.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767707009103",
  "key": "login:test-multi-2-1767707009103"
}
[2026-01-06T13:43:29.104Z] Creating new entry
{
  "key": "login:test-multi-2-1767707009103"
}
[2026-01-06T13:43:29.104Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:43:29.104Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:43:29.104Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767707009104",
  "key": "login:test-reset-time-1767707009104"
}
[2026-01-06T13:43:29.104Z] Creating new entry
{
  "key": "login:test-reset-time-1767707009104"
}
[2026-01-06T13:43:29.104Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:43:29.104Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:43:29.105Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:43:29.105Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:43:29.105Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:43:29.106Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T13:43:29.106Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:43:29.106Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:43:29.106Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:43:29.106Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T13:43:29.106Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:43:29.106Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:43:29.107Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707009107",
  "key": "test-sliding:test-sliding-1767707009107"
}
[2026-01-06T13:43:29.107Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767707009107"
}
[2026-01-06T13:43:29.107Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:43:29.107Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:43:29.208Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707009107",
  "key": "test-sliding:test-sliding-1767707009107"
}
[2026-01-06T13:43:29.208Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767707009107",
  "timestampCount": 1
}
[2026-01-06T13:43:29.208Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:43:29.208Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:43:29.310Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707009107",
  "key": "test-sliding:test-sliding-1767707009107"
}
[2026-01-06T13:43:29.310Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767707009107",
  "timestampCount": 2
}
[2026-01-06T13:43:29.310Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T13:43:29.310Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:43:29.310Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:43:29.311Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767707009311",
  "key": "register:test-format-allowed-1767707009311"
}
[2026-01-06T13:43:29.311Z] Creating new entry
{
  "key": "register:test-format-allowed-1767707009311"
}
[2026-01-06T13:43:29.311Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:43:29.311Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:43:29.311Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707009311",
  "key": "register:test-format-blocked-1767707009311"
}
[2026-01-06T13:43:29.312Z] Creating new entry
{
  "key": "register:test-format-blocked-1767707009311"
}
[2026-01-06T13:43:29.312Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:43:29.312Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:43:29.312Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707009311",
  "key": "register:test-format-blocked-1767707009311"
}
[2026-01-06T13:43:29.312Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707009311",
  "timestampCount": 1
}
[2026-01-06T13:43:29.312Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:43:29.312Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:43:29.312Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707009311",
  "key": "register:test-format-blocked-1767707009311"
}
[2026-01-06T13:43:29.312Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707009311",
  "timestampCount": 2
}
[2026-01-06T13:43:29.313Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T13:43:29.313Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T13:43:29.313Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707009311",
  "key": "register:test-format-blocked-1767707009311"
}
[2026-01-06T13:43:29.313Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707009311",
  "timestampCount": 3
}
[2026-01-06T13:43:29.313Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T13:47:58.332Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707278332",
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.332Z] Creating new entry
{
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.332Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:47:58.333Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:47:58.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707278332",
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.333Z] Found existing entry
{
  "key": "login:test-allow-1767707278332",
  "timestampCount": 1
}
[2026-01-06T13:47:58.333Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:47:58.333Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:47:58.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707278332",
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.333Z] Found existing entry
{
  "key": "login:test-allow-1767707278332",
  "timestampCount": 2
}
[2026-01-06T13:47:58.333Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:47:58.333Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:47:58.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707278332",
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.333Z] Found existing entry
{
  "key": "login:test-allow-1767707278332",
  "timestampCount": 3
}
[2026-01-06T13:47:58.333Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:47:58.333Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:47:58.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767707278332",
  "key": "login:test-allow-1767707278332"
}
[2026-01-06T13:47:58.333Z] Found existing entry
{
  "key": "login:test-allow-1767707278332",
  "timestampCount": 4
}
[2026-01-06T13:47:58.333Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:47:58.333Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:47:58.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.334Z] Creating new entry
{
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.334Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:47:58.334Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:47:58.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.335Z] Found existing entry
{
  "key": "login:test-block-1767707278334",
  "timestampCount": 1
}
[2026-01-06T13:47:58.335Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:47:58.335Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:47:58.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.335Z] Found existing entry
{
  "key": "login:test-block-1767707278334",
  "timestampCount": 2
}
[2026-01-06T13:47:58.335Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:47:58.335Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:47:58.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.335Z] Found existing entry
{
  "key": "login:test-block-1767707278334",
  "timestampCount": 3
}
[2026-01-06T13:47:58.335Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:47:58.335Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:47:58.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.335Z] Found existing entry
{
  "key": "login:test-block-1767707278334",
  "timestampCount": 4
}
[2026-01-06T13:47:58.335Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:47:58.335Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:47:58.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767707278334",
  "key": "login:test-block-1767707278334"
}
[2026-01-06T13:47:58.335Z] Found existing entry
{
  "key": "login:test-block-1767707278334",
  "timestampCount": 5
}
[2026-01-06T13:47:58.335Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T13:47:58.336Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707278336",
  "key": "test-reset:test-reset-1767707278336"
}
[2026-01-06T13:47:58.336Z] Creating new entry
{
  "key": "test-reset:test-reset-1767707278336"
}
[2026-01-06T13:47:58.336Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T13:47:58.336Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T13:47:58.336Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707278336",
  "key": "test-reset:test-reset-1767707278336"
}
[2026-01-06T13:47:58.336Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707278336",
  "timestampCount": 1
}
[2026-01-06T13:47:58.336Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T13:47:58.336Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T13:47:58.336Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707278336",
  "key": "test-reset:test-reset-1767707278336"
}
[2026-01-06T13:47:58.336Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707278336",
  "timestampCount": 2
}
[2026-01-06T13:47:58.336Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T13:47:58.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767707278336",
  "key": "test-reset:test-reset-1767707278336"
}
[2026-01-06T13:47:58.488Z] Found existing entry
{
  "key": "test-reset:test-reset-1767707278336",
  "timestampCount": 2
}
[2026-01-06T13:47:58.488Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T13:47:58.489Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T13:47:58.489Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T13:47:58.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.489Z] Creating new entry
{
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.489Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:47:58.489Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:47:58.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.490Z] Found existing entry
{
  "key": "login:test-multi-1-1767707278489",
  "timestampCount": 1
}
[2026-01-06T13:47:58.490Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T13:47:58.490Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T13:47:58.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.490Z] Found existing entry
{
  "key": "login:test-multi-1-1767707278489",
  "timestampCount": 2
}
[2026-01-06T13:47:58.490Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T13:47:58.490Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T13:47:58.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.490Z] Found existing entry
{
  "key": "login:test-multi-1-1767707278489",
  "timestampCount": 3
}
[2026-01-06T13:47:58.490Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T13:47:58.490Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T13:47:58.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.490Z] Found existing entry
{
  "key": "login:test-multi-1-1767707278489",
  "timestampCount": 4
}
[2026-01-06T13:47:58.490Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T13:47:58.490Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T13:47:58.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767707278489",
  "key": "login:test-multi-1-1767707278489"
}
[2026-01-06T13:47:58.490Z] Found existing entry
{
  "key": "login:test-multi-1-1767707278489",
  "timestampCount": 5
}
[2026-01-06T13:47:58.490Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T13:47:58.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767707278489",
  "key": "login:test-multi-2-1767707278489"
}
[2026-01-06T13:47:58.491Z] Creating new entry
{
  "key": "login:test-multi-2-1767707278489"
}
[2026-01-06T13:47:58.491Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:47:58.491Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:47:58.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767707278491",
  "key": "login:test-reset-time-1767707278491"
}
[2026-01-06T13:47:58.491Z] Creating new entry
{
  "key": "login:test-reset-time-1767707278491"
}
[2026-01-06T13:47:58.491Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T13:47:58.491Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T13:47:58.492Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:47:58.492Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:47:58.493Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:47:58.493Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T13:47:58.493Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:47:58.493Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:47:58.493Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:47:58.493Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T13:47:58.493Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T13:47:58.493Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T13:47:58.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707278493",
  "key": "test-sliding:test-sliding-1767707278493"
}
[2026-01-06T13:47:58.493Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767707278493"
}
[2026-01-06T13:47:58.493Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:47:58.493Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:47:58.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707278493",
  "key": "test-sliding:test-sliding-1767707278493"
}
[2026-01-06T13:47:58.594Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767707278493",
  "timestampCount": 1
}
[2026-01-06T13:47:58.594Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:47:58.594Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:47:58.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767707278493",
  "key": "test-sliding:test-sliding-1767707278493"
}
[2026-01-06T13:47:58.696Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767707278493",
  "timestampCount": 2
}
[2026-01-06T13:47:58.696Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T13:47:58.696Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:47:58.696Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:47:58.696Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767707278696",
  "key": "register:test-format-allowed-1767707278696"
}
[2026-01-06T13:47:58.696Z] Creating new entry
{
  "key": "register:test-format-allowed-1767707278696"
}
[2026-01-06T13:47:58.696Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:47:58.696Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:47:58.697Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707278697",
  "key": "register:test-format-blocked-1767707278697"
}
[2026-01-06T13:47:58.697Z] Creating new entry
{
  "key": "register:test-format-blocked-1767707278697"
}
[2026-01-06T13:47:58.697Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T13:47:58.697Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T13:47:58.697Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707278697",
  "key": "register:test-format-blocked-1767707278697"
}
[2026-01-06T13:47:58.697Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707278697",
  "timestampCount": 1
}
[2026-01-06T13:47:58.697Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T13:47:58.697Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T13:47:58.697Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707278697",
  "key": "register:test-format-blocked-1767707278697"
}
[2026-01-06T13:47:58.697Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707278697",
  "timestampCount": 2
}
[2026-01-06T13:47:58.697Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T13:47:58.697Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T13:47:58.697Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767707278697",
  "key": "register:test-format-blocked-1767707278697"
}
[2026-01-06T13:47:58.697Z] Found existing entry
{
  "key": "register:test-format-blocked-1767707278697",
  "timestampCount": 3
}
[2026-01-06T13:47:58.697Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:06:20.760Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:06:20.762Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:06:20.762Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:06:20.762Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:06:20.763Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T14:06:20.763Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T14:06:20.764Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T14:06:20.764Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T14:07:20.762Z"
  }
}
[2026-01-06T14:06:21.662Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:06:21.668Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:06:21.669Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:06:21.669Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:06:21.669Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T14:06:21.669Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T14:06:21.669Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T14:06:21.669Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T14:07:20.762Z"
  }
}
[2026-01-06T14:06:27.757Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:06:27.757Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:06:27.758Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:06:27.758Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:06:27.758Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T14:06:27.758Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T14:06:27.758Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T14:06:27.758Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T14:07:20.762Z"
  }
}
[2026-01-06T14:06:28.561Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:06:28.561Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:06:28.562Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:06:28.562Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:06:28.562Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T14:06:28.562Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T14:06:28.562Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T14:06:28.562Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T14:07:20.762Z"
  }
}
[2026-01-06T14:15:10.872Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:10.873Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:10.873Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:10.873Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:10.873Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T14:15:10.873Z] Filtered old timestamps
{
  "before": 4,
  "after": 0,
  "removed": 4
}
[2026-01-06T14:15:10.873Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T14:15:10.873Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T14:15:10.873Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:11.795Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:11.795Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:11.795Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:11.795Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:11.795Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T14:15:11.796Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T14:15:11.796Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T14:15:11.796Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:26.904Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:26.904Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:26.904Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:26.904Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:26.904Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T14:15:26.904Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T14:15:26.904Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T14:15:26.904Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:27.768Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:27.769Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:27.769Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:27.769Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:27.769Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T14:15:27.769Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T14:15:27.769Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T14:15:27.769Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:28.643Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:28.643Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:28.643Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:28.643Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:28.643Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T14:15:28.643Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T14:15:28.644Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T14:15:28.644Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:29.488Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:29.488Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:29.488Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:29.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:29.488Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T14:15:29.488Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T14:15:29.489Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T14:15:29.489Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:32.128Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:32.129Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:32.129Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:32.129Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:32.129Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T14:15:32.129Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T14:15:32.129Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T14:15:32.129Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:32.760Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:32.760Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:32.760Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:32.760Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:32.760Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T14:15:32.760Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T14:15:32.760Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T14:15:32.760Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:40.229Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:40.229Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:40.229Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:40.229Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:40.229Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2026-01-06T14:15:40.229Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2026-01-06T14:15:40.230Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2026-01-06T14:15:40.230Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:41.006Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:41.006Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:41.006Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:41.007Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:41.007Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2026-01-06T14:15:41.007Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2026-01-06T14:15:41.007Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2026-01-06T14:15:41.007Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:44.849Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:44.850Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:44.850Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:44.850Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:44.850Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2026-01-06T14:15:44.850Z] Current state
{
  "countAfterFilter": 10,
  "maxRequests": 60
}
[2026-01-06T14:15:44.850Z] Request allowed
{
  "newCount": 11,
  "remaining": 49
}
[2026-01-06T14:15:44.851Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 49,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:15:45.686Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:15:45.686Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:15:45.686Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:15:45.686Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:15:45.687Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 11
}
[2026-01-06T14:15:45.687Z] Current state
{
  "countAfterFilter": 11,
  "maxRequests": 60
}
[2026-01-06T14:15:45.687Z] Request allowed
{
  "newCount": 12,
  "remaining": 48
}
[2026-01-06T14:15:45.687Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 48,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:16:06.240Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:06.240Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:06.240Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:06.241Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:06.241Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 12
}
[2026-01-06T14:16:06.241Z] Current state
{
  "countAfterFilter": 12,
  "maxRequests": 60
}
[2026-01-06T14:16:06.241Z] Request allowed
{
  "newCount": 13,
  "remaining": 47
}
[2026-01-06T14:16:06.241Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 47,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:16:07.101Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:07.101Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:07.102Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:07.102Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:07.102Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 13
}
[2026-01-06T14:16:07.102Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2026-01-06T14:16:07.102Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2026-01-06T14:16:07.102Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:16:09.140Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:09.140Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:09.140Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:09.141Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:09.141Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2026-01-06T14:16:09.141Z] Current state
{
  "countAfterFilter": 14,
  "maxRequests": 60
}
[2026-01-06T14:16:09.141Z] Request allowed
{
  "newCount": 15,
  "remaining": 45
}
[2026-01-06T14:16:09.141Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 45,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:16:09.987Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:09.988Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:09.988Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:09.988Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:09.988Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 15
}
[2026-01-06T14:16:09.988Z] Current state
{
  "countAfterFilter": 15,
  "maxRequests": 60
}
[2026-01-06T14:16:09.988Z] Request allowed
{
  "newCount": 16,
  "remaining": 44
}
[2026-01-06T14:16:09.988Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 44,
    "resetAt": "2026-01-06T14:16:10.873Z"
  }
}
[2026-01-06T14:16:23.607Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:23.607Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:23.608Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:23.608Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:23.608Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 16
}
[2026-01-06T14:16:23.608Z] Filtered old timestamps
{
  "before": 16,
  "after": 14,
  "removed": 2
}
[2026-01-06T14:16:23.608Z] Current state
{
  "countAfterFilter": 14,
  "maxRequests": 60
}
[2026-01-06T14:16:23.608Z] Request allowed
{
  "newCount": 15,
  "remaining": 45
}
[2026-01-06T14:16:23.608Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 45,
    "resetAt": "2026-01-06T14:16:26.904Z"
  }
}
[2026-01-06T14:16:24.521Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:24.521Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:24.521Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:24.521Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:24.521Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 15
}
[2026-01-06T14:16:24.521Z] Current state
{
  "countAfterFilter": 15,
  "maxRequests": 60
}
[2026-01-06T14:16:24.522Z] Request allowed
{
  "newCount": 16,
  "remaining": 44
}
[2026-01-06T14:16:24.522Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 44,
    "resetAt": "2026-01-06T14:16:26.904Z"
  }
}
[2026-01-06T14:16:28.726Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:28.726Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:28.727Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:28.727Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:28.727Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 16
}
[2026-01-06T14:16:28.727Z] Filtered old timestamps
{
  "before": 16,
  "after": 13,
  "removed": 3
}
[2026-01-06T14:16:28.727Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2026-01-06T14:16:28.727Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2026-01-06T14:16:28.727Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2026-01-06T14:16:29.488Z"
  }
}
[2026-01-06T14:16:29.596Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:29.596Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:29.596Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:29.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:29.596Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2026-01-06T14:16:29.596Z] Filtered old timestamps
{
  "before": 14,
  "after": 13,
  "removed": 1
}
[2026-01-06T14:16:29.597Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2026-01-06T14:16:29.597Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2026-01-06T14:16:29.597Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2026-01-06T14:16:32.129Z"
  }
}
[2026-01-06T14:16:38.477Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:38.477Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:38.477Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:38.477Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:38.478Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 14
}
[2026-01-06T14:16:38.478Z] Filtered old timestamps
{
  "before": 14,
  "after": 12,
  "removed": 2
}
[2026-01-06T14:16:38.478Z] Current state
{
  "countAfterFilter": 12,
  "maxRequests": 60
}
[2026-01-06T14:16:38.478Z] Request allowed
{
  "newCount": 13,
  "remaining": 47
}
[2026-01-06T14:16:38.478Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 47,
    "resetAt": "2026-01-06T14:16:40.229Z"
  }
}
[2026-01-06T14:16:39.302Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:16:39.302Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:16:39.303Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:16:39.303Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:16:39.303Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 13
}
[2026-01-06T14:16:39.303Z] Current state
{
  "countAfterFilter": 13,
  "maxRequests": 60
}
[2026-01-06T14:16:39.303Z] Request allowed
{
  "newCount": 14,
  "remaining": 46
}
[2026-01-06T14:16:39.303Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 46,
    "resetAt": "2026-01-06T14:16:40.229Z"
  }
}
[2026-01-06T14:34:21.331Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710061331",
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.332Z] Creating new entry
{
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.332Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:21.332Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:21.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710061331",
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.333Z] Found existing entry
{
  "key": "login:test-allow-1767710061331",
  "timestampCount": 1
}
[2026-01-06T14:34:21.333Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:21.333Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:21.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710061331",
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.333Z] Found existing entry
{
  "key": "login:test-allow-1767710061331",
  "timestampCount": 2
}
[2026-01-06T14:34:21.333Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:21.333Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:21.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710061331",
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.333Z] Found existing entry
{
  "key": "login:test-allow-1767710061331",
  "timestampCount": 3
}
[2026-01-06T14:34:21.333Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:21.333Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:21.333Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710061331",
  "key": "login:test-allow-1767710061331"
}
[2026-01-06T14:34:21.333Z] Found existing entry
{
  "key": "login:test-allow-1767710061331",
  "timestampCount": 4
}
[2026-01-06T14:34:21.333Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:21.333Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:21.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Creating new entry
{
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:21.334Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:21.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Found existing entry
{
  "key": "login:test-block-1767710061334",
  "timestampCount": 1
}
[2026-01-06T14:34:21.334Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:21.334Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:21.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Found existing entry
{
  "key": "login:test-block-1767710061334",
  "timestampCount": 2
}
[2026-01-06T14:34:21.334Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:21.334Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:21.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Found existing entry
{
  "key": "login:test-block-1767710061334",
  "timestampCount": 3
}
[2026-01-06T14:34:21.334Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:21.334Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:21.334Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.334Z] Found existing entry
{
  "key": "login:test-block-1767710061334",
  "timestampCount": 4
}
[2026-01-06T14:34:21.334Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:21.334Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:21.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710061334",
  "key": "login:test-block-1767710061334"
}
[2026-01-06T14:34:21.335Z] Found existing entry
{
  "key": "login:test-block-1767710061334",
  "timestampCount": 5
}
[2026-01-06T14:34:21.335Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:21.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710061335",
  "key": "test-reset:test-reset-1767710061335"
}
[2026-01-06T14:34:21.335Z] Creating new entry
{
  "key": "test-reset:test-reset-1767710061335"
}
[2026-01-06T14:34:21.335Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:21.335Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:21.335Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710061335",
  "key": "test-reset:test-reset-1767710061335"
}
[2026-01-06T14:34:21.335Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710061335",
  "timestampCount": 1
}
[2026-01-06T14:34:21.335Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T14:34:21.335Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T14:34:21.336Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710061335",
  "key": "test-reset:test-reset-1767710061335"
}
[2026-01-06T14:34:21.336Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710061335",
  "timestampCount": 2
}
[2026-01-06T14:34:21.336Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T14:34:21.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710061335",
  "key": "test-reset:test-reset-1767710061335"
}
[2026-01-06T14:34:21.488Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710061335",
  "timestampCount": 2
}
[2026-01-06T14:34:21.488Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T14:34:21.488Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:21.488Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:21.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.488Z] Creating new entry
{
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.488Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:21.488Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:21.488Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.488Z] Found existing entry
{
  "key": "login:test-multi-1-1767710061488",
  "timestampCount": 1
}
[2026-01-06T14:34:21.488Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:21.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.489Z] Found existing entry
{
  "key": "login:test-multi-1-1767710061488",
  "timestampCount": 2
}
[2026-01-06T14:34:21.489Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:21.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.489Z] Found existing entry
{
  "key": "login:test-multi-1-1767710061488",
  "timestampCount": 3
}
[2026-01-06T14:34:21.489Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:21.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.489Z] Found existing entry
{
  "key": "login:test-multi-1-1767710061488",
  "timestampCount": 4
}
[2026-01-06T14:34:21.489Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:21.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710061488",
  "key": "login:test-multi-1-1767710061488"
}
[2026-01-06T14:34:21.489Z] Found existing entry
{
  "key": "login:test-multi-1-1767710061488",
  "timestampCount": 5
}
[2026-01-06T14:34:21.489Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767710061488",
  "key": "login:test-multi-2-1767710061488"
}
[2026-01-06T14:34:21.489Z] Creating new entry
{
  "key": "login:test-multi-2-1767710061488"
}
[2026-01-06T14:34:21.489Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:21.489Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:21.490Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767710061490",
  "key": "login:test-reset-time-1767710061490"
}
[2026-01-06T14:34:21.490Z] Creating new entry
{
  "key": "login:test-reset-time-1767710061490"
}
[2026-01-06T14:34:21.490Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:21.490Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:21.491Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:21.491Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:21.491Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:21.491Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T14:34:21.491Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:21.491Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:21.491Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:21.491Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:21.491Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:21.491Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:21.491Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710061491",
  "key": "test-sliding:test-sliding-1767710061491"
}
[2026-01-06T14:34:21.491Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767710061491"
}
[2026-01-06T14:34:21.491Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:21.491Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:21.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710061491",
  "key": "test-sliding:test-sliding-1767710061491"
}
[2026-01-06T14:34:21.592Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710061491",
  "timestampCount": 1
}
[2026-01-06T14:34:21.592Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:21.592Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:21.693Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710061491",
  "key": "test-sliding:test-sliding-1767710061491"
}
[2026-01-06T14:34:21.694Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710061491",
  "timestampCount": 2
}
[2026-01-06T14:34:21.694Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T14:34:21.694Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:21.694Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:21.694Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767710061694",
  "key": "register:test-format-allowed-1767710061694"
}
[2026-01-06T14:34:21.694Z] Creating new entry
{
  "key": "register:test-format-allowed-1767710061694"
}
[2026-01-06T14:34:21.694Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:21.694Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:21.694Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710061694",
  "key": "register:test-format-blocked-1767710061694"
}
[2026-01-06T14:34:21.694Z] Creating new entry
{
  "key": "register:test-format-blocked-1767710061694"
}
[2026-01-06T14:34:21.694Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:21.694Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:21.694Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710061694",
  "key": "register:test-format-blocked-1767710061694"
}
[2026-01-06T14:34:21.694Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710061694",
  "timestampCount": 1
}
[2026-01-06T14:34:21.694Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:21.695Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:21.695Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710061694",
  "key": "register:test-format-blocked-1767710061694"
}
[2026-01-06T14:34:21.695Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710061694",
  "timestampCount": 2
}
[2026-01-06T14:34:21.695Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T14:34:21.695Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T14:34:21.695Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710061694",
  "key": "register:test-format-blocked-1767710061694"
}
[2026-01-06T14:34:21.695Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710061694",
  "timestampCount": 3
}
[2026-01-06T14:34:21.695Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:34:23.067Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:23.067Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:23.067Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:23.067Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:23.067Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T14:34:23.067Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T14:34:23.067Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T14:34:23.067Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:34:24.003Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:24.003Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:24.003Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:24.003Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:24.003Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T14:34:24.003Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T14:34:24.003Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T14:34:24.003Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:34:35.576Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710075576",
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.577Z] Creating new entry
{
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.577Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:35.577Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:35.577Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710075576",
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.577Z] Found existing entry
{
  "key": "login:test-allow-1767710075576",
  "timestampCount": 1
}
[2026-01-06T14:34:35.578Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:35.578Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:35.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710075576",
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.578Z] Found existing entry
{
  "key": "login:test-allow-1767710075576",
  "timestampCount": 2
}
[2026-01-06T14:34:35.578Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:35.578Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:35.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710075576",
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.578Z] Found existing entry
{
  "key": "login:test-allow-1767710075576",
  "timestampCount": 3
}
[2026-01-06T14:34:35.578Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:35.578Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:35.578Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710075576",
  "key": "login:test-allow-1767710075576"
}
[2026-01-06T14:34:35.578Z] Found existing entry
{
  "key": "login:test-allow-1767710075576",
  "timestampCount": 4
}
[2026-01-06T14:34:35.578Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:35.578Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:35.579Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.579Z] Creating new entry
{
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.579Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:35.579Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:35.579Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.580Z] Found existing entry
{
  "key": "login:test-block-1767710075579",
  "timestampCount": 1
}
[2026-01-06T14:34:35.580Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:35.580Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:35.580Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.580Z] Found existing entry
{
  "key": "login:test-block-1767710075579",
  "timestampCount": 2
}
[2026-01-06T14:34:35.580Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:35.580Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:35.580Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.580Z] Found existing entry
{
  "key": "login:test-block-1767710075579",
  "timestampCount": 3
}
[2026-01-06T14:34:35.580Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:35.580Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:35.580Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.580Z] Found existing entry
{
  "key": "login:test-block-1767710075579",
  "timestampCount": 4
}
[2026-01-06T14:34:35.580Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:35.580Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:35.582Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710075579",
  "key": "login:test-block-1767710075579"
}
[2026-01-06T14:34:35.583Z] Found existing entry
{
  "key": "login:test-block-1767710075579",
  "timestampCount": 5
}
[2026-01-06T14:34:35.583Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:35.583Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710075583",
  "key": "test-reset:test-reset-1767710075583"
}
[2026-01-06T14:34:35.583Z] Creating new entry
{
  "key": "test-reset:test-reset-1767710075583"
}
[2026-01-06T14:34:35.583Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:35.584Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:35.584Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710075583",
  "key": "test-reset:test-reset-1767710075583"
}
[2026-01-06T14:34:35.584Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710075583",
  "timestampCount": 1
}
[2026-01-06T14:34:35.584Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T14:34:35.584Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T14:34:35.584Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710075583",
  "key": "test-reset:test-reset-1767710075583"
}
[2026-01-06T14:34:35.584Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710075583",
  "timestampCount": 2
}
[2026-01-06T14:34:35.584Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T14:34:35.740Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710075583",
  "key": "test-reset:test-reset-1767710075583"
}
[2026-01-06T14:34:35.740Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710075583",
  "timestampCount": 2
}
[2026-01-06T14:34:35.740Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T14:34:35.740Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:35.741Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:35.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Creating new entry
{
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:35.742Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:35.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Found existing entry
{
  "key": "login:test-multi-1-1767710075742",
  "timestampCount": 1
}
[2026-01-06T14:34:35.742Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:35.742Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:35.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Found existing entry
{
  "key": "login:test-multi-1-1767710075742",
  "timestampCount": 2
}
[2026-01-06T14:34:35.742Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:35.742Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:35.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Found existing entry
{
  "key": "login:test-multi-1-1767710075742",
  "timestampCount": 3
}
[2026-01-06T14:34:35.742Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:35.742Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:35.742Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.742Z] Found existing entry
{
  "key": "login:test-multi-1-1767710075742",
  "timestampCount": 4
}
[2026-01-06T14:34:35.742Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:35.743Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:35.743Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710075742",
  "key": "login:test-multi-1-1767710075742"
}
[2026-01-06T14:34:35.743Z] Found existing entry
{
  "key": "login:test-multi-1-1767710075742",
  "timestampCount": 5
}
[2026-01-06T14:34:35.743Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:35.743Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767710075742",
  "key": "login:test-multi-2-1767710075742"
}
[2026-01-06T14:34:35.743Z] Creating new entry
{
  "key": "login:test-multi-2-1767710075742"
}
[2026-01-06T14:34:35.743Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:35.743Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:35.744Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767710075744",
  "key": "login:test-reset-time-1767710075744"
}
[2026-01-06T14:34:35.744Z] Creating new entry
{
  "key": "login:test-reset-time-1767710075744"
}
[2026-01-06T14:34:35.744Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:35.744Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:35.746Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:35.746Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:35.747Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:35.747Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T14:34:35.747Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:35.747Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:35.747Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:35.748Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:35.748Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:35.748Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:35.748Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710075748",
  "key": "test-sliding:test-sliding-1767710075748"
}
[2026-01-06T14:34:35.748Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767710075748"
}
[2026-01-06T14:34:35.748Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:35.748Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:35.850Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710075748",
  "key": "test-sliding:test-sliding-1767710075748"
}
[2026-01-06T14:34:35.850Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710075748",
  "timestampCount": 1
}
[2026-01-06T14:34:35.850Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:35.850Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:35.951Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710075748",
  "key": "test-sliding:test-sliding-1767710075748"
}
[2026-01-06T14:34:35.951Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710075748",
  "timestampCount": 2
}
[2026-01-06T14:34:35.951Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T14:34:35.951Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:35.951Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:35.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767710075952",
  "key": "register:test-format-allowed-1767710075952"
}
[2026-01-06T14:34:35.952Z] Creating new entry
{
  "key": "register:test-format-allowed-1767710075952"
}
[2026-01-06T14:34:35.952Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:35.952Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:35.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710075952",
  "key": "register:test-format-blocked-1767710075952"
}
[2026-01-06T14:34:35.952Z] Creating new entry
{
  "key": "register:test-format-blocked-1767710075952"
}
[2026-01-06T14:34:35.952Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:35.952Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:35.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710075952",
  "key": "register:test-format-blocked-1767710075952"
}
[2026-01-06T14:34:35.952Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710075952",
  "timestampCount": 1
}
[2026-01-06T14:34:35.952Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:35.952Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:35.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710075952",
  "key": "register:test-format-blocked-1767710075952"
}
[2026-01-06T14:34:35.952Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710075952",
  "timestampCount": 2
}
[2026-01-06T14:34:35.952Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T14:34:35.952Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T14:34:35.952Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710075952",
  "key": "register:test-format-blocked-1767710075952"
}
[2026-01-06T14:34:35.952Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710075952",
  "timestampCount": 3
}
[2026-01-06T14:34:35.952Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:34:36.823Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:36.823Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:36.823Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:36.823Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:36.824Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T14:34:36.824Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T14:34:36.824Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T14:34:36.824Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:34:37.654Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:37.655Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:37.655Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:37.655Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:37.655Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T14:34:37.655Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T14:34:37.655Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T14:34:37.655Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:34:51.266Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:51.269Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.269Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:51.270Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:51.270Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T14:34:51.270Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T14:34:51.270Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T14:34:51.270Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:34:51.283Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710091283",
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.284Z] Creating new entry
{
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.284Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:51.284Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:51.285Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710091283",
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.285Z] Found existing entry
{
  "key": "login:test-allow-1767710091283",
  "timestampCount": 1
}
[2026-01-06T14:34:51.285Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:51.285Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:51.285Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710091283",
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.285Z] Found existing entry
{
  "key": "login:test-allow-1767710091283",
  "timestampCount": 2
}
[2026-01-06T14:34:51.285Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:51.285Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:51.285Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710091283",
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.285Z] Found existing entry
{
  "key": "login:test-allow-1767710091283",
  "timestampCount": 3
}
[2026-01-06T14:34:51.285Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:51.285Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:51.285Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710091283",
  "key": "login:test-allow-1767710091283"
}
[2026-01-06T14:34:51.285Z] Found existing entry
{
  "key": "login:test-allow-1767710091283",
  "timestampCount": 4
}
[2026-01-06T14:34:51.285Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:51.285Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:51.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.286Z] Creating new entry
{
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.286Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:51.286Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:51.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.286Z] Found existing entry
{
  "key": "login:test-block-1767710091286",
  "timestampCount": 1
}
[2026-01-06T14:34:51.286Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:51.286Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:51.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.286Z] Found existing entry
{
  "key": "login:test-block-1767710091286",
  "timestampCount": 2
}
[2026-01-06T14:34:51.286Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:51.286Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:51.286Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.287Z] Found existing entry
{
  "key": "login:test-block-1767710091286",
  "timestampCount": 3
}
[2026-01-06T14:34:51.287Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:51.287Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:51.287Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.287Z] Found existing entry
{
  "key": "login:test-block-1767710091286",
  "timestampCount": 4
}
[2026-01-06T14:34:51.287Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:51.287Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:51.287Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710091286",
  "key": "login:test-block-1767710091286"
}
[2026-01-06T14:34:51.287Z] Found existing entry
{
  "key": "login:test-block-1767710091286",
  "timestampCount": 5
}
[2026-01-06T14:34:51.287Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:51.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710091288",
  "key": "test-reset:test-reset-1767710091288"
}
[2026-01-06T14:34:51.288Z] Creating new entry
{
  "key": "test-reset:test-reset-1767710091288"
}
[2026-01-06T14:34:51.288Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:51.288Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:51.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710091288",
  "key": "test-reset:test-reset-1767710091288"
}
[2026-01-06T14:34:51.288Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710091288",
  "timestampCount": 1
}
[2026-01-06T14:34:51.288Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T14:34:51.288Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T14:34:51.288Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710091288",
  "key": "test-reset:test-reset-1767710091288"
}
[2026-01-06T14:34:51.288Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710091288",
  "timestampCount": 2
}
[2026-01-06T14:34:51.288Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T14:34:51.440Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710091288",
  "key": "test-reset:test-reset-1767710091288"
}
[2026-01-06T14:34:51.441Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710091288",
  "timestampCount": 2
}
[2026-01-06T14:34:51.441Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T14:34:51.441Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:34:51.441Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:34:51.441Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.442Z] Creating new entry
{
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.442Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:51.442Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:51.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.442Z] Found existing entry
{
  "key": "login:test-multi-1-1767710091441",
  "timestampCount": 1
}
[2026-01-06T14:34:51.442Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:34:51.442Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:34:51.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.442Z] Found existing entry
{
  "key": "login:test-multi-1-1767710091441",
  "timestampCount": 2
}
[2026-01-06T14:34:51.442Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:34:51.442Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:34:51.442Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.442Z] Found existing entry
{
  "key": "login:test-multi-1-1767710091441",
  "timestampCount": 3
}
[2026-01-06T14:34:51.442Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:34:51.443Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:34:51.443Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.443Z] Found existing entry
{
  "key": "login:test-multi-1-1767710091441",
  "timestampCount": 4
}
[2026-01-06T14:34:51.443Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:34:51.443Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:34:51.443Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710091441",
  "key": "login:test-multi-1-1767710091441"
}
[2026-01-06T14:34:51.443Z] Found existing entry
{
  "key": "login:test-multi-1-1767710091441",
  "timestampCount": 5
}
[2026-01-06T14:34:51.443Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:34:51.443Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767710091441",
  "key": "login:test-multi-2-1767710091441"
}
[2026-01-06T14:34:51.443Z] Creating new entry
{
  "key": "login:test-multi-2-1767710091441"
}
[2026-01-06T14:34:51.443Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:51.443Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:51.444Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767710091444",
  "key": "login:test-reset-time-1767710091444"
}
[2026-01-06T14:34:51.444Z] Creating new entry
{
  "key": "login:test-reset-time-1767710091444"
}
[2026-01-06T14:34:51.444Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:34:51.444Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:34:51.446Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.446Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:51.446Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.446Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T14:34:51.447Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.447Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:51.447Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.447Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:51.447Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:51.447Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:34:51.447Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710091447",
  "key": "test-sliding:test-sliding-1767710091447"
}
[2026-01-06T14:34:51.447Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767710091447"
}
[2026-01-06T14:34:51.447Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:51.447Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:51.548Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710091447",
  "key": "test-sliding:test-sliding-1767710091447"
}
[2026-01-06T14:34:51.549Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710091447",
  "timestampCount": 1
}
[2026-01-06T14:34:51.549Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:51.549Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:51.651Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710091447",
  "key": "test-sliding:test-sliding-1767710091447"
}
[2026-01-06T14:34:51.651Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710091447",
  "timestampCount": 2
}
[2026-01-06T14:34:51.652Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T14:34:51.652Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:51.652Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:51.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767710091652",
  "key": "register:test-format-allowed-1767710091652"
}
[2026-01-06T14:34:51.652Z] Creating new entry
{
  "key": "register:test-format-allowed-1767710091652"
}
[2026-01-06T14:34:51.652Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:51.652Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:51.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710091652",
  "key": "register:test-format-blocked-1767710091652"
}
[2026-01-06T14:34:51.652Z] Creating new entry
{
  "key": "register:test-format-blocked-1767710091652"
}
[2026-01-06T14:34:51.652Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:34:51.652Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:34:51.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710091652",
  "key": "register:test-format-blocked-1767710091652"
}
[2026-01-06T14:34:51.652Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710091652",
  "timestampCount": 1
}
[2026-01-06T14:34:51.652Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:34:51.652Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:34:51.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710091652",
  "key": "register:test-format-blocked-1767710091652"
}
[2026-01-06T14:34:51.652Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710091652",
  "timestampCount": 2
}
[2026-01-06T14:34:51.652Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T14:34:51.652Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T14:34:51.652Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710091652",
  "key": "register:test-format-blocked-1767710091652"
}
[2026-01-06T14:34:51.653Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710091652",
  "timestampCount": 3
}
[2026-01-06T14:34:51.653Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:34:52.092Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:34:52.093Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:34:52.093Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:34:52.093Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:34:52.093Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T14:34:52.093Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T14:34:52.093Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T14:34:52.095Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:35:12.230Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710112229",
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.231Z] Creating new entry
{
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.231Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:35:12.231Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:35:12.232Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710112229",
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.232Z] Found existing entry
{
  "key": "login:test-allow-1767710112229",
  "timestampCount": 1
}
[2026-01-06T14:35:12.232Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:35:12.232Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:35:12.232Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710112229",
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.232Z] Found existing entry
{
  "key": "login:test-allow-1767710112229",
  "timestampCount": 2
}
[2026-01-06T14:35:12.233Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:35:12.233Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:35:12.233Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710112229",
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.233Z] Found existing entry
{
  "key": "login:test-allow-1767710112229",
  "timestampCount": 3
}
[2026-01-06T14:35:12.234Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:35:12.234Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:35:12.234Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767710112229",
  "key": "login:test-allow-1767710112229"
}
[2026-01-06T14:35:12.234Z] Found existing entry
{
  "key": "login:test-allow-1767710112229",
  "timestampCount": 4
}
[2026-01-06T14:35:12.234Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:35:12.234Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Creating new entry
{
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:35:12.235Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Found existing entry
{
  "key": "login:test-block-1767710112235",
  "timestampCount": 1
}
[2026-01-06T14:35:12.235Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:35:12.235Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Found existing entry
{
  "key": "login:test-block-1767710112235",
  "timestampCount": 2
}
[2026-01-06T14:35:12.235Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:35:12.235Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Found existing entry
{
  "key": "login:test-block-1767710112235",
  "timestampCount": 3
}
[2026-01-06T14:35:12.235Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:35:12.235Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Found existing entry
{
  "key": "login:test-block-1767710112235",
  "timestampCount": 4
}
[2026-01-06T14:35:12.235Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:35:12.235Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:35:12.235Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767710112235",
  "key": "login:test-block-1767710112235"
}
[2026-01-06T14:35:12.235Z] Found existing entry
{
  "key": "login:test-block-1767710112235",
  "timestampCount": 5
}
[2026-01-06T14:35:12.236Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:35:12.236Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710112236",
  "key": "test-reset:test-reset-1767710112236"
}
[2026-01-06T14:35:12.236Z] Creating new entry
{
  "key": "test-reset:test-reset-1767710112236"
}
[2026-01-06T14:35:12.236Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:35:12.236Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:35:12.236Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710112236",
  "key": "test-reset:test-reset-1767710112236"
}
[2026-01-06T14:35:12.236Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710112236",
  "timestampCount": 1
}
[2026-01-06T14:35:12.236Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T14:35:12.237Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T14:35:12.237Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710112236",
  "key": "test-reset:test-reset-1767710112236"
}
[2026-01-06T14:35:12.237Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710112236",
  "timestampCount": 2
}
[2026-01-06T14:35:12.237Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T14:35:12.388Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767710112236",
  "key": "test-reset:test-reset-1767710112236"
}
[2026-01-06T14:35:12.388Z] Found existing entry
{
  "key": "test-reset:test-reset-1767710112236",
  "timestampCount": 2
}
[2026-01-06T14:35:12.388Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T14:35:12.388Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:35:12.388Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:35:12.389Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Creating new entry
{
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:35:12.389Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:35:12.389Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Found existing entry
{
  "key": "login:test-multi-1-1767710112389",
  "timestampCount": 1
}
[2026-01-06T14:35:12.389Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:35:12.389Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:35:12.389Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Found existing entry
{
  "key": "login:test-multi-1-1767710112389",
  "timestampCount": 2
}
[2026-01-06T14:35:12.389Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:35:12.389Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:35:12.389Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Found existing entry
{
  "key": "login:test-multi-1-1767710112389",
  "timestampCount": 3
}
[2026-01-06T14:35:12.389Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:35:12.389Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:35:12.389Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.389Z] Found existing entry
{
  "key": "login:test-multi-1-1767710112389",
  "timestampCount": 4
}
[2026-01-06T14:35:12.389Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:35:12.389Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:35:12.390Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767710112389",
  "key": "login:test-multi-1-1767710112389"
}
[2026-01-06T14:35:12.390Z] Found existing entry
{
  "key": "login:test-multi-1-1767710112389",
  "timestampCount": 5
}
[2026-01-06T14:35:12.390Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:35:12.390Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767710112389",
  "key": "login:test-multi-2-1767710112389"
}
[2026-01-06T14:35:12.390Z] Creating new entry
{
  "key": "login:test-multi-2-1767710112389"
}
[2026-01-06T14:35:12.390Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:35:12.390Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:35:12.390Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767710112390",
  "key": "login:test-reset-time-1767710112390"
}
[2026-01-06T14:35:12.390Z] Creating new entry
{
  "key": "login:test-reset-time-1767710112390"
}
[2026-01-06T14:35:12.390Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:35:12.390Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:35:12.391Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:12.391Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:35:12.391Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:12.391Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T14:35:12.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:12.392Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:35:12.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:12.392Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:35:12.392Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:12.392Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:35:12.392Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710112392",
  "key": "test-sliding:test-sliding-1767710112392"
}
[2026-01-06T14:35:12.392Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767710112392"
}
[2026-01-06T14:35:12.392Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:35:12.392Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:35:12.493Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710112392",
  "key": "test-sliding:test-sliding-1767710112392"
}
[2026-01-06T14:35:12.493Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710112392",
  "timestampCount": 1
}
[2026-01-06T14:35:12.493Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:35:12.493Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:35:12.595Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767710112392",
  "key": "test-sliding:test-sliding-1767710112392"
}
[2026-01-06T14:35:12.595Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767710112392",
  "timestampCount": 2
}
[2026-01-06T14:35:12.595Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T14:35:12.595Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:35:12.596Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:35:12.596Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767710112596",
  "key": "register:test-format-allowed-1767710112596"
}
[2026-01-06T14:35:12.596Z] Creating new entry
{
  "key": "register:test-format-allowed-1767710112596"
}
[2026-01-06T14:35:12.596Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:35:12.596Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:35:12.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710112598",
  "key": "register:test-format-blocked-1767710112598"
}
[2026-01-06T14:35:12.598Z] Creating new entry
{
  "key": "register:test-format-blocked-1767710112598"
}
[2026-01-06T14:35:12.598Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:35:12.598Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:35:12.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710112598",
  "key": "register:test-format-blocked-1767710112598"
}
[2026-01-06T14:35:12.598Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710112598",
  "timestampCount": 1
}
[2026-01-06T14:35:12.598Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:35:12.598Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:35:12.598Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710112598",
  "key": "register:test-format-blocked-1767710112598"
}
[2026-01-06T14:35:12.600Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710112598",
  "timestampCount": 2
}
[2026-01-06T14:35:12.601Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T14:35:12.601Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T14:35:12.601Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767710112598",
  "key": "register:test-format-blocked-1767710112598"
}
[2026-01-06T14:35:12.601Z] Found existing entry
{
  "key": "register:test-format-blocked-1767710112598",
  "timestampCount": 3
}
[2026-01-06T14:35:12.601Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:35:13.565Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:35:13.565Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:13.565Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:35:13.565Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:35:13.565Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T14:35:13.565Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T14:35:13.565Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T14:35:13.565Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:35:14.400Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:35:14.401Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:35:14.401Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:35:14.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:35:14.401Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T14:35:14.402Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T14:35:14.402Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T14:35:14.402Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T14:35:23.067Z"
  }
}
[2026-01-06T14:49:09.394Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:09.395Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:09.395Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:09.395Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:09.395Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T14:49:09.395Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T14:49:09.395Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T14:49:09.395Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:10.297Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:10.297Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:10.297Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:10.297Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:10.297Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T14:49:10.297Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T14:49:10.297Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T14:49:10.297Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:18.070Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:18.070Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:18.070Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:18.070Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:18.070Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T14:49:18.070Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T14:49:18.070Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T14:49:18.070Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:18.834Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:18.834Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:18.834Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:18.834Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:18.834Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T14:49:18.834Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T14:49:18.834Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T14:49:18.834Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:55.281Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:55.282Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:55.282Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:55.282Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:55.282Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T14:49:55.282Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T14:49:55.282Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T14:49:55.282Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:56.129Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:56.129Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:56.130Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:56.130Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:56.130Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T14:49:56.130Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T14:49:56.130Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T14:49:56.130Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:58.313Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:58.313Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:58.313Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:58.313Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:58.313Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T14:49:58.313Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T14:49:58.313Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T14:49:58.313Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:49:58.892Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:49:58.893Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:49:58.893Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:49:58.893Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:49:58.893Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T14:49:58.893Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T14:49:58.893Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T14:49:58.893Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T14:50:09.395Z"
  }
}
[2026-01-06T14:53:00.304Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711180304",
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.305Z] Creating new entry
{
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.305Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:53:00.305Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:53:00.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711180304",
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.305Z] Found existing entry
{
  "key": "login:test-allow-1767711180304",
  "timestampCount": 1
}
[2026-01-06T14:53:00.305Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:53:00.305Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:53:00.305Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711180304",
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.305Z] Found existing entry
{
  "key": "login:test-allow-1767711180304",
  "timestampCount": 2
}
[2026-01-06T14:53:00.305Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:53:00.306Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:53:00.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711180304",
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.306Z] Found existing entry
{
  "key": "login:test-allow-1767711180304",
  "timestampCount": 3
}
[2026-01-06T14:53:00.306Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:53:00.306Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:53:00.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711180304",
  "key": "login:test-allow-1767711180304"
}
[2026-01-06T14:53:00.306Z] Found existing entry
{
  "key": "login:test-allow-1767711180304",
  "timestampCount": 4
}
[2026-01-06T14:53:00.306Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:53:00.306Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:53:00.306Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.306Z] Creating new entry
{
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.306Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:53:00.306Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:53:00.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.307Z] Found existing entry
{
  "key": "login:test-block-1767711180306",
  "timestampCount": 1
}
[2026-01-06T14:53:00.307Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:53:00.307Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:53:00.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.307Z] Found existing entry
{
  "key": "login:test-block-1767711180306",
  "timestampCount": 2
}
[2026-01-06T14:53:00.307Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:53:00.307Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:53:00.307Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.307Z] Found existing entry
{
  "key": "login:test-block-1767711180306",
  "timestampCount": 3
}
[2026-01-06T14:53:00.307Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:53:00.307Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:53:00.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.308Z] Found existing entry
{
  "key": "login:test-block-1767711180306",
  "timestampCount": 4
}
[2026-01-06T14:53:00.308Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:53:00.308Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:53:00.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711180306",
  "key": "login:test-block-1767711180306"
}
[2026-01-06T14:53:00.308Z] Found existing entry
{
  "key": "login:test-block-1767711180306",
  "timestampCount": 5
}
[2026-01-06T14:53:00.308Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:53:00.308Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711180308",
  "key": "test-reset:test-reset-1767711180308"
}
[2026-01-06T14:53:00.309Z] Creating new entry
{
  "key": "test-reset:test-reset-1767711180308"
}
[2026-01-06T14:53:00.309Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:53:00.309Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:53:00.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711180308",
  "key": "test-reset:test-reset-1767711180308"
}
[2026-01-06T14:53:00.309Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711180308",
  "timestampCount": 1
}
[2026-01-06T14:53:00.309Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T14:53:00.309Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T14:53:00.309Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711180308",
  "key": "test-reset:test-reset-1767711180308"
}
[2026-01-06T14:53:00.309Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711180308",
  "timestampCount": 2
}
[2026-01-06T14:53:00.309Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T14:53:00.461Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711180308",
  "key": "test-reset:test-reset-1767711180308"
}
[2026-01-06T14:53:00.461Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711180308",
  "timestampCount": 2
}
[2026-01-06T14:53:00.462Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T14:53:00.462Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T14:53:00.462Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T14:53:00.462Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.462Z] Creating new entry
{
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.462Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:53:00.462Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:53:00.462Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.462Z] Found existing entry
{
  "key": "login:test-multi-1-1767711180462",
  "timestampCount": 1
}
[2026-01-06T14:53:00.462Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T14:53:00.462Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T14:53:00.462Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.462Z] Found existing entry
{
  "key": "login:test-multi-1-1767711180462",
  "timestampCount": 2
}
[2026-01-06T14:53:00.462Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T14:53:00.463Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T14:53:00.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.463Z] Found existing entry
{
  "key": "login:test-multi-1-1767711180462",
  "timestampCount": 3
}
[2026-01-06T14:53:00.463Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T14:53:00.463Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T14:53:00.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.463Z] Found existing entry
{
  "key": "login:test-multi-1-1767711180462",
  "timestampCount": 4
}
[2026-01-06T14:53:00.463Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T14:53:00.463Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T14:53:00.463Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711180462",
  "key": "login:test-multi-1-1767711180462"
}
[2026-01-06T14:53:00.463Z] Found existing entry
{
  "key": "login:test-multi-1-1767711180462",
  "timestampCount": 5
}
[2026-01-06T14:53:00.463Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T14:53:00.464Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767711180462",
  "key": "login:test-multi-2-1767711180462"
}
[2026-01-06T14:53:00.464Z] Creating new entry
{
  "key": "login:test-multi-2-1767711180462"
}
[2026-01-06T14:53:00.465Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:53:00.465Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:53:00.465Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767711180465",
  "key": "login:test-reset-time-1767711180465"
}
[2026-01-06T14:53:00.465Z] Creating new entry
{
  "key": "login:test-reset-time-1767711180465"
}
[2026-01-06T14:53:00.466Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T14:53:00.466Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T14:53:00.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:00.467Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:53:00.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:00.467Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T14:53:00.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:00.467Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:53:00.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:00.467Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:53:00.467Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:00.467Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T14:53:00.467Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711180467",
  "key": "test-sliding:test-sliding-1767711180467"
}
[2026-01-06T14:53:00.467Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767711180467"
}
[2026-01-06T14:53:00.467Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:53:00.468Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:53:00.568Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711180467",
  "key": "test-sliding:test-sliding-1767711180467"
}
[2026-01-06T14:53:00.568Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767711180467",
  "timestampCount": 1
}
[2026-01-06T14:53:00.568Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:53:00.568Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:53:00.669Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711180467",
  "key": "test-sliding:test-sliding-1767711180467"
}
[2026-01-06T14:53:00.670Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767711180467",
  "timestampCount": 2
}
[2026-01-06T14:53:00.670Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T14:53:00.670Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:53:00.670Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:53:00.670Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767711180670",
  "key": "register:test-format-allowed-1767711180670"
}
[2026-01-06T14:53:00.670Z] Creating new entry
{
  "key": "register:test-format-allowed-1767711180670"
}
[2026-01-06T14:53:00.670Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:53:00.671Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:53:00.671Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711180671",
  "key": "register:test-format-blocked-1767711180671"
}
[2026-01-06T14:53:00.671Z] Creating new entry
{
  "key": "register:test-format-blocked-1767711180671"
}
[2026-01-06T14:53:00.671Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T14:53:00.671Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T14:53:00.671Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711180671",
  "key": "register:test-format-blocked-1767711180671"
}
[2026-01-06T14:53:00.671Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711180671",
  "timestampCount": 1
}
[2026-01-06T14:53:00.671Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T14:53:00.672Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T14:53:00.672Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711180671",
  "key": "register:test-format-blocked-1767711180671"
}
[2026-01-06T14:53:00.672Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711180671",
  "timestampCount": 2
}
[2026-01-06T14:53:00.672Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T14:53:00.672Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T14:53:00.672Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711180671",
  "key": "register:test-format-blocked-1767711180671"
}
[2026-01-06T14:53:00.672Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711180671",
  "timestampCount": 3
}
[2026-01-06T14:53:00.672Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T14:53:04.071Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:53:04.071Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:04.071Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:53:04.071Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:53:04.071Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2026-01-06T14:53:04.071Z] Filtered old timestamps
{
  "before": 8,
  "after": 0,
  "removed": 8
}
[2026-01-06T14:53:04.071Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T14:53:04.072Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T14:53:04.072Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T14:54:04.071Z"
  }
}
[2026-01-06T14:53:04.964Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T14:53:04.965Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T14:53:04.965Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T14:53:04.965Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T14:53:04.965Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T14:53:04.965Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T14:53:04.965Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T14:53:04.965Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T14:54:04.071Z"
  }
}
[2026-01-06T15:04:56.583Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711896583",
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.585Z] Creating new entry
{
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.585Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T15:04:56.585Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T15:04:56.586Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711896583",
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.586Z] Found existing entry
{
  "key": "login:test-allow-1767711896583",
  "timestampCount": 1
}
[2026-01-06T15:04:56.586Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T15:04:56.586Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T15:04:56.586Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711896583",
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.586Z] Found existing entry
{
  "key": "login:test-allow-1767711896583",
  "timestampCount": 2
}
[2026-01-06T15:04:56.586Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T15:04:56.586Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T15:04:56.587Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711896583",
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.587Z] Found existing entry
{
  "key": "login:test-allow-1767711896583",
  "timestampCount": 3
}
[2026-01-06T15:04:56.587Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T15:04:56.587Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T15:04:56.587Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-allow-1767711896583",
  "key": "login:test-allow-1767711896583"
}
[2026-01-06T15:04:56.587Z] Found existing entry
{
  "key": "login:test-allow-1767711896583",
  "timestampCount": 4
}
[2026-01-06T15:04:56.587Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T15:04:56.587Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T15:04:56.588Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.588Z] Creating new entry
{
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.588Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T15:04:56.588Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T15:04:56.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.590Z] Found existing entry
{
  "key": "login:test-block-1767711896588",
  "timestampCount": 1
}
[2026-01-06T15:04:56.590Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T15:04:56.590Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T15:04:56.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.590Z] Found existing entry
{
  "key": "login:test-block-1767711896588",
  "timestampCount": 2
}
[2026-01-06T15:04:56.590Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T15:04:56.590Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T15:04:56.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.590Z] Found existing entry
{
  "key": "login:test-block-1767711896588",
  "timestampCount": 3
}
[2026-01-06T15:04:56.590Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T15:04:56.590Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T15:04:56.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.590Z] Found existing entry
{
  "key": "login:test-block-1767711896588",
  "timestampCount": 4
}
[2026-01-06T15:04:56.590Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T15:04:56.590Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T15:04:56.590Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-block-1767711896588",
  "key": "login:test-block-1767711896588"
}
[2026-01-06T15:04:56.590Z] Found existing entry
{
  "key": "login:test-block-1767711896588",
  "timestampCount": 5
}
[2026-01-06T15:04:56.590Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T15:04:56.591Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711896591",
  "key": "test-reset:test-reset-1767711896591"
}
[2026-01-06T15:04:56.591Z] Creating new entry
{
  "key": "test-reset:test-reset-1767711896591"
}
[2026-01-06T15:04:56.591Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T15:04:56.591Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T15:04:56.591Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711896591",
  "key": "test-reset:test-reset-1767711896591"
}
[2026-01-06T15:04:56.591Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711896591",
  "timestampCount": 1
}
[2026-01-06T15:04:56.591Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 2
}
[2026-01-06T15:04:56.591Z] Request allowed
{
  "newCount": 2,
  "remaining": 0
}
[2026-01-06T15:04:56.592Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711896591",
  "key": "test-reset:test-reset-1767711896591"
}
[2026-01-06T15:04:56.592Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711896591",
  "timestampCount": 2
}
[2026-01-06T15:04:56.592Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 2
}
[2026-01-06T15:04:56.745Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-reset",
    "maxRequests": 2,
    "windowMs": 100
  },
  "identifier": "test-reset-1767711896591",
  "key": "test-reset:test-reset-1767711896591"
}
[2026-01-06T15:04:56.745Z] Found existing entry
{
  "key": "test-reset:test-reset-1767711896591",
  "timestampCount": 2
}
[2026-01-06T15:04:56.745Z] Filtered old timestamps
{
  "before": 2,
  "after": 0,
  "removed": 2
}
[2026-01-06T15:04:56.745Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 2
}
[2026-01-06T15:04:56.745Z] Request allowed
{
  "newCount": 1,
  "remaining": 1
}
[2026-01-06T15:04:56.745Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Creating new entry
{
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T15:04:56.746Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T15:04:56.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Found existing entry
{
  "key": "login:test-multi-1-1767711896745",
  "timestampCount": 1
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 5
}
[2026-01-06T15:04:56.746Z] Request allowed
{
  "newCount": 2,
  "remaining": 3
}
[2026-01-06T15:04:56.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Found existing entry
{
  "key": "login:test-multi-1-1767711896745",
  "timestampCount": 2
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 5
}
[2026-01-06T15:04:56.746Z] Request allowed
{
  "newCount": 3,
  "remaining": 2
}
[2026-01-06T15:04:56.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Found existing entry
{
  "key": "login:test-multi-1-1767711896745",
  "timestampCount": 3
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 5
}
[2026-01-06T15:04:56.746Z] Request allowed
{
  "newCount": 4,
  "remaining": 1
}
[2026-01-06T15:04:56.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Found existing entry
{
  "key": "login:test-multi-1-1767711896745",
  "timestampCount": 4
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 5
}
[2026-01-06T15:04:56.746Z] Request allowed
{
  "newCount": 5,
  "remaining": 0
}
[2026-01-06T15:04:56.746Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-1-1767711896745",
  "key": "login:test-multi-1-1767711896745"
}
[2026-01-06T15:04:56.746Z] Found existing entry
{
  "key": "login:test-multi-1-1767711896745",
  "timestampCount": 5
}
[2026-01-06T15:04:56.746Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 5
}
[2026-01-06T15:04:56.747Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-multi-2-1767711896745",
  "key": "login:test-multi-2-1767711896745"
}
[2026-01-06T15:04:56.747Z] Creating new entry
{
  "key": "login:test-multi-2-1767711896745"
}
[2026-01-06T15:04:56.747Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T15:04:56.747Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T15:04:56.747Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "login",
    "maxRequests": 5,
    "windowMs": 60000
  },
  "identifier": "test-reset-time-1767711896747",
  "key": "login:test-reset-time-1767711896747"
}
[2026-01-06T15:04:56.748Z] Creating new entry
{
  "key": "login:test-reset-time-1767711896747"
}
[2026-01-06T15:04:56.748Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 5
}
[2026-01-06T15:04:56.748Z] Request allowed
{
  "newCount": 1,
  "remaining": 4
}
[2026-01-06T15:04:56.750Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:56.750Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T15:04:56.751Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:56.751Z] Using real IP
{
  "identifier": "192.168.1.2"
}
[2026-01-06T15:04:56.751Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:56.751Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T15:04:56.751Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:56.751Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:04:56.752Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:56.752Z] Using forwarded IP
{
  "identifier": "192.168.1.1"
}
[2026-01-06T15:04:56.752Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711896752",
  "key": "test-sliding:test-sliding-1767711896752"
}
[2026-01-06T15:04:56.752Z] Creating new entry
{
  "key": "test-sliding:test-sliding-1767711896752"
}
[2026-01-06T15:04:56.752Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T15:04:56.752Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T15:04:56.853Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711896752",
  "key": "test-sliding:test-sliding-1767711896752"
}
[2026-01-06T15:04:56.853Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767711896752",
  "timestampCount": 1
}
[2026-01-06T15:04:56.854Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T15:04:56.854Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T15:04:56.955Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "test-sliding",
    "maxRequests": 3,
    "windowMs": 200
  },
  "identifier": "test-sliding-1767711896752",
  "key": "test-sliding:test-sliding-1767711896752"
}
[2026-01-06T15:04:56.957Z] Found existing entry
{
  "key": "test-sliding:test-sliding-1767711896752",
  "timestampCount": 2
}
[2026-01-06T15:04:56.957Z] Filtered old timestamps
{
  "before": 2,
  "after": 1,
  "removed": 1
}
[2026-01-06T15:04:56.957Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T15:04:56.957Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T15:04:56.957Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-allowed-1767711896957",
  "key": "register:test-format-allowed-1767711896957"
}
[2026-01-06T15:04:56.957Z] Creating new entry
{
  "key": "register:test-format-allowed-1767711896957"
}
[2026-01-06T15:04:56.957Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T15:04:56.957Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T15:04:56.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711896958",
  "key": "register:test-format-blocked-1767711896958"
}
[2026-01-06T15:04:56.958Z] Creating new entry
{
  "key": "register:test-format-blocked-1767711896958"
}
[2026-01-06T15:04:56.958Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 3
}
[2026-01-06T15:04:56.958Z] Request allowed
{
  "newCount": 1,
  "remaining": 2
}
[2026-01-06T15:04:56.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711896958",
  "key": "register:test-format-blocked-1767711896958"
}
[2026-01-06T15:04:56.958Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711896958",
  "timestampCount": 1
}
[2026-01-06T15:04:56.958Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 3
}
[2026-01-06T15:04:56.958Z] Request allowed
{
  "newCount": 2,
  "remaining": 1
}
[2026-01-06T15:04:56.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711896958",
  "key": "register:test-format-blocked-1767711896958"
}
[2026-01-06T15:04:56.958Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711896958",
  "timestampCount": 2
}
[2026-01-06T15:04:56.958Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 3
}
[2026-01-06T15:04:56.958Z] Request allowed
{
  "newCount": 3,
  "remaining": 0
}
[2026-01-06T15:04:56.958Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "register",
    "maxRequests": 3,
    "windowMs": 60000
  },
  "identifier": "test-format-blocked-1767711896958",
  "key": "register:test-format-blocked-1767711896958"
}
[2026-01-06T15:04:56.958Z] Found existing entry
{
  "key": "register:test-format-blocked-1767711896958",
  "timestampCount": 3
}
[2026-01-06T15:04:56.958Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 3
}
[2026-01-06T15:04:58.280Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:04:58.280Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:58.280Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:04:58.280Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:04:58.280Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T15:04:58.280Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T15:04:58.280Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T15:04:58.280Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T15:05:58.280Z"
  }
}
[2026-01-06T15:04:59.193Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:04:59.194Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:04:59.194Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:04:59.198Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:04:59.198Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T15:04:59.199Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T15:04:59.199Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T15:04:59.199Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T15:05:58.280Z"
  }
}
[2026-01-06T15:39:54.400Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:39:54.401Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:39:54.401Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:39:54.401Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:39:54.401Z] Creating new entry
{
  "key": "token:unknown"
}
[2026-01-06T15:39:54.401Z] Current state
{
  "countAfterFilter": 0,
  "maxRequests": 60
}
[2026-01-06T15:39:54.402Z] Request allowed
{
  "newCount": 1,
  "remaining": 59
}
[2026-01-06T15:39:54.402Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 59,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:39:55.339Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:39:55.339Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:39:55.339Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:39:55.339Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:39:55.339Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 1
}
[2026-01-06T15:39:55.339Z] Current state
{
  "countAfterFilter": 1,
  "maxRequests": 60
}
[2026-01-06T15:39:55.339Z] Request allowed
{
  "newCount": 2,
  "remaining": 58
}
[2026-01-06T15:39:55.339Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 58,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:02.973Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:02.973Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:02.973Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:02.973Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:02.973Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 2
}
[2026-01-06T15:40:02.973Z] Current state
{
  "countAfterFilter": 2,
  "maxRequests": 60
}
[2026-01-06T15:40:02.973Z] Request allowed
{
  "newCount": 3,
  "remaining": 57
}
[2026-01-06T15:40:02.973Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 57,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:03.795Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:03.795Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:03.796Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:03.796Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:03.796Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 3
}
[2026-01-06T15:40:03.796Z] Current state
{
  "countAfterFilter": 3,
  "maxRequests": 60
}
[2026-01-06T15:40:03.796Z] Request allowed
{
  "newCount": 4,
  "remaining": 56
}
[2026-01-06T15:40:03.796Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 56,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:43.208Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:43.209Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:43.209Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:43.209Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:43.209Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 4
}
[2026-01-06T15:40:43.209Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T15:40:43.209Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T15:40:43.209Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:44.040Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:44.041Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:44.041Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:44.041Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:44.041Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T15:40:44.041Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T15:40:44.041Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T15:40:44.041Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:49.261Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:49.261Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:49.261Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:49.261Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:49.261Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T15:40:49.261Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T15:40:49.261Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T15:40:49.261Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:40:50.069Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:40:50.069Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:40:50.069Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:40:50.069Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:40:50.069Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T15:40:50.069Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T15:40:50.069Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T15:40:50.069Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T15:40:54.401Z"
  }
}
[2026-01-06T15:41:16.128Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:16.129Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:16.129Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:16.129Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:16.129Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2026-01-06T15:41:16.129Z] Filtered old timestamps
{
  "before": 8,
  "after": 4,
  "removed": 4
}
[2026-01-06T15:41:16.129Z] Current state
{
  "countAfterFilter": 4,
  "maxRequests": 60
}
[2026-01-06T15:41:16.129Z] Request allowed
{
  "newCount": 5,
  "remaining": 55
}
[2026-01-06T15:41:16.129Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 55,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:17.038Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:17.038Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:17.038Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:17.038Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:17.038Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 5
}
[2026-01-06T15:41:17.038Z] Current state
{
  "countAfterFilter": 5,
  "maxRequests": 60
}
[2026-01-06T15:41:17.038Z] Request allowed
{
  "newCount": 6,
  "remaining": 54
}
[2026-01-06T15:41:17.038Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 54,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:21.732Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:21.732Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:21.732Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:21.732Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:21.732Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 6
}
[2026-01-06T15:41:21.732Z] Current state
{
  "countAfterFilter": 6,
  "maxRequests": 60
}
[2026-01-06T15:41:21.732Z] Request allowed
{
  "newCount": 7,
  "remaining": 53
}
[2026-01-06T15:41:21.732Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 53,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:22.570Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:22.570Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:22.570Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:22.570Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:22.570Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 7
}
[2026-01-06T15:41:22.570Z] Current state
{
  "countAfterFilter": 7,
  "maxRequests": 60
}
[2026-01-06T15:41:22.570Z] Request allowed
{
  "newCount": 8,
  "remaining": 52
}
[2026-01-06T15:41:22.570Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 52,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:29.922Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:29.922Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:29.922Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:29.922Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:29.922Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 8
}
[2026-01-06T15:41:29.922Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2026-01-06T15:41:29.923Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2026-01-06T15:41:29.923Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:30.805Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:30.805Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:30.805Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:30.805Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:30.805Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2026-01-06T15:41:30.805Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2026-01-06T15:41:30.805Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2026-01-06T15:41:30.806Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2026-01-06T15:41:43.209Z"
  }
}
[2026-01-06T15:41:47.581Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:47.582Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:47.582Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:47.582Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:47.582Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2026-01-06T15:41:47.582Z] Filtered old timestamps
{
  "before": 10,
  "after": 8,
  "removed": 2
}
[2026-01-06T15:41:47.582Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2026-01-06T15:41:47.582Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2026-01-06T15:41:47.582Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2026-01-06T15:41:49.261Z"
  }
}
[2026-01-06T15:41:48.469Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:48.469Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:48.469Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:48.469Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:48.469Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2026-01-06T15:41:48.469Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2026-01-06T15:41:48.469Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2026-01-06T15:41:48.469Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2026-01-06T15:41:49.261Z"
  }
}
[2026-01-06T15:41:52.593Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:52.594Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:52.594Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:52.594Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:52.594Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 10
}
[2026-01-06T15:41:52.594Z] Filtered old timestamps
{
  "before": 10,
  "after": 8,
  "removed": 2
}
[2026-01-06T15:41:52.594Z] Current state
{
  "countAfterFilter": 8,
  "maxRequests": 60
}
[2026-01-06T15:41:52.594Z] Request allowed
{
  "newCount": 9,
  "remaining": 51
}
[2026-01-06T15:41:52.594Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 51,
    "resetAt": "2026-01-06T15:42:16.129Z"
  }
}
[2026-01-06T15:41:53.426Z] withRateLimit called
{
  "endpoint": "token",
  "requestUrl": "/auth/token"
}
[2026-01-06T15:41:53.426Z] getClientIdentifier START
{
  "e2eTestMode": {
    "envVar": "true",
    "final": "true"
  },
  "testIdHeader": null,
  "willUseTestId": false
}
[2026-01-06T15:41:53.426Z] Using fallback identifier
{
  "identifier": "unknown"
}
[2026-01-06T15:41:53.426Z] checkRateLimit START
{
  "config": {
    "keyPrefix": "token",
    "maxRequests": 60,
    "windowMs": 60000
  },
  "identifier": "unknown",
  "key": "token:unknown"
}
[2026-01-06T15:41:53.426Z] Found existing entry
{
  "key": "token:unknown",
  "timestampCount": 9
}
[2026-01-06T15:41:53.427Z] Current state
{
  "countAfterFilter": 9,
  "maxRequests": 60
}
[2026-01-06T15:41:53.427Z] Request allowed
{
  "newCount": 10,
  "remaining": 50
}
[2026-01-06T15:41:53.427Z] Rate limit check result
{
  "identifier": "unknown",
  "result": {
    "allowed": true,
    "remaining": 50,
    "resetAt": "2026-01-06T15:42:16.129Z"
  }
}
