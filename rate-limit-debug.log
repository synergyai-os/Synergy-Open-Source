=== NEW TEST RUN: 2025-11-15T21:27:32.917Z ===
[2025-11-15T21:27:32.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:32.922Z] Request URL: /auth/login
[2025-11-15T21:27:32.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:32.922Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.922Z] Will use test ID?: true
[2025-11-15T21:27:32.923Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:32.923Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:32.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:32.923Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Current count after filter: 0
[2025-11-15T21:27:32.923Z] Max requests allowed: 5
[2025-11-15T21:27:32.923Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:32.923Z] New count: 1
[2025-11-15T21:27:32.923Z] Remaining: 4
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:32.923Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.090Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.090Z] Request URL: /auth/login
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.090Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Will use test ID?: true
[2025-11-15T21:27:33.090Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.090Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.090Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Current count after filter: 0
[2025-11-15T21:27:33.090Z] Max requests allowed: 5
[2025-11-15T21:27:33.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.090Z] New count: 1
[2025-11-15T21:27:33.090Z] Remaining: 4
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113090
}
[2025-11-15T21:27:33.145Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.145Z] Request URL: /auth/login
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.145Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] Will use test ID?: true
[2025-11-15T21:27:33.145Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.146Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.146Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.146Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Current count after filter: 0
[2025-11-15T21:27:33.146Z] Max requests allowed: 5
[2025-11-15T21:27:33.146Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.146Z] New count: 1
[2025-11-15T21:27:33.146Z] Remaining: 4
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.146Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113146
}
[2025-11-15T21:27:33.147Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.147Z] Request URL: /auth/login
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.147Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Will use test ID?: true
[2025-11-15T21:27:33.147Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.147Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.147Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.147Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Existing timestamps: 1
[2025-11-15T21:27:33.147Z] Current count after filter: 1
[2025-11-15T21:27:33.147Z] Max requests allowed: 5
[2025-11-15T21:27:33.147Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.147Z] New count: 2
[2025-11-15T21:27:33.147Z] Remaining: 3
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.147Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.226Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.226Z] Request URL: /auth/register
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.226Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Will use test ID?: true
[2025-11-15T21:27:33.226Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.226Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.226Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.226Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Current count after filter: 0
[2025-11-15T21:27:33.226Z] Max requests allowed: 3
[2025-11-15T21:27:33.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.226Z] New count: 1
[2025-11-15T21:27:33.226Z] Remaining: 2
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.227Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113226
}
[2025-11-15T21:27:33.234Z] üßπ clearRateLimits: Cleared 4 entries from rate limit store
[2025-11-15T21:27:33.237Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.237Z] Request URL: /auth/login
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.237Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Will use test ID?: true
[2025-11-15T21:27:33.237Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.237Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.237Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.237Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] üìù Creating new entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Current count after filter: 0
[2025-11-15T21:27:33.237Z] Max requests allowed: 5
[2025-11-15T21:27:33.237Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.237Z] New count: 1
[2025-11-15T21:27:33.237Z] Remaining: 4
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.237Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.380Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.380Z] Request URL: /auth/login
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.380Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] Will use test ID?: true
[2025-11-15T21:27:33.380Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.381Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.381Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Current count after filter: 0
[2025-11-15T21:27:33.381Z] Max requests allowed: 5
[2025-11-15T21:27:33.381Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.381Z] New count: 1
[2025-11-15T21:27:33.381Z] Remaining: 4
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.381Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.394Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.394Z] Request URL: /auth/login
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.394Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Will use test ID?: true
[2025-11-15T21:27:33.394Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.394Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.394Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.394Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Current count after filter: 0
[2025-11-15T21:27:33.394Z] Max requests allowed: 5
[2025-11-15T21:27:33.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.394Z] New count: 1
[2025-11-15T21:27:33.394Z] Remaining: 4
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.395Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.421Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.421Z] Request URL: /auth/login
[2025-11-15T21:27:33.421Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.421Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Will use test ID?: true
[2025-11-15T21:27:33.422Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.422Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.422Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.422Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Current count after filter: 0
[2025-11-15T21:27:33.422Z] Max requests allowed: 5
[2025-11-15T21:27:33.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.422Z] New count: 1
[2025-11-15T21:27:33.422Z] Remaining: 4
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.422Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.590Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.590Z] Request URL: /auth/register
[2025-11-15T21:27:33.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.590Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Will use test ID?: true
[2025-11-15T21:27:33.591Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.591Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.591Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.591Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Current count after filter: 0
[2025-11-15T21:27:33.591Z] Max requests allowed: 3
[2025-11-15T21:27:33.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.591Z] New count: 1
[2025-11-15T21:27:33.591Z] Remaining: 2
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.608Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.608Z] Request URL: /auth/login
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.608Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Will use test ID?: true
[2025-11-15T21:27:33.608Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.608Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.608Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Existing timestamps: 1
[2025-11-15T21:27:33.608Z] Current count after filter: 1
[2025-11-15T21:27:33.608Z] Max requests allowed: 5
[2025-11-15T21:27:33.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.608Z] New count: 2
[2025-11-15T21:27:33.609Z] Remaining: 3
[2025-11-15T21:27:33.609Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.609Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.614Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.614Z] Request URL: /auth/login
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.614Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] Will use test ID?: true
[2025-11-15T21:27:33.614Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.614Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.615Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.615Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Existing timestamps: 1
[2025-11-15T21:27:33.615Z] Current count after filter: 1
[2025-11-15T21:27:33.615Z] Max requests allowed: 5
[2025-11-15T21:27:33.615Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.615Z] New count: 2
[2025-11-15T21:27:33.615Z] Remaining: 3
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.615Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.643Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.643Z] Request URL: /auth/login
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.643Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] Will use test ID?: true
[2025-11-15T21:27:33.643Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.644Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.644Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.644Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Existing timestamps: 1
[2025-11-15T21:27:33.644Z] Current count after filter: 1
[2025-11-15T21:27:33.644Z] Max requests allowed: 5
[2025-11-15T21:27:33.644Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.644Z] New count: 2
[2025-11-15T21:27:33.644Z] Remaining: 3
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.644Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.694Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.694Z] Request URL: /auth/login
[2025-11-15T21:27:33.694Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.694Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] Will use test ID?: true
[2025-11-15T21:27:33.695Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.695Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.696Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.696Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Existing timestamps: 1
[2025-11-15T21:27:33.696Z] Current count after filter: 1
[2025-11-15T21:27:33.696Z] Max requests allowed: 5
[2025-11-15T21:27:33.696Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.696Z] New count: 2
[2025-11-15T21:27:33.696Z] Remaining: 3
[2025-11-15T21:27:33.696Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.696Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.913Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.913Z] Request URL: /auth/login
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.914Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Will use test ID?: true
[2025-11-15T21:27:33.914Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.914Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.914Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.914Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.919Z] Existing timestamps: 2
[2025-11-15T21:27:33.919Z] Current count after filter: 2
[2025-11-15T21:27:33.920Z] Max requests allowed: 5
[2025-11-15T21:27:33.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.920Z] New count: 3
[2025-11-15T21:27:33.920Z] Remaining: 2
[2025-11-15T21:27:33.920Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.920Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.922Z] Request URL: /auth/login
[2025-11-15T21:27:33.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.922Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Will use test ID?: true
[2025-11-15T21:27:33.923Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.923Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.923Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Existing timestamps: 2
[2025-11-15T21:27:33.923Z] Current count after filter: 2
[2025-11-15T21:27:33.923Z] Max requests allowed: 5
[2025-11-15T21:27:33.924Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.924Z] New count: 3
[2025-11-15T21:27:33.924Z] Remaining: 2
[2025-11-15T21:27:33.924Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.924Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.929Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.929Z] Request URL: /auth/login
[2025-11-15T21:27:33.929Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.931Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Will use test ID?: true
[2025-11-15T21:27:33.931Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.931Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.931Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.931Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.933Z] Existing timestamps: 2
[2025-11-15T21:27:33.933Z] Current count after filter: 2
[2025-11-15T21:27:33.933Z] Max requests allowed: 5
[2025-11-15T21:27:33.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.934Z] New count: 3
[2025-11-15T21:27:33.934Z] Remaining: 2
[2025-11-15T21:27:33.934Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.934Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.950Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.951Z] Request URL: /auth/register
[2025-11-15T21:27:33.951Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.951Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.952Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] Will use test ID?: true
[2025-11-15T21:27:33.952Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.952Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.954Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.958Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.958Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.959Z] üìñ Found existing entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.960Z] Existing timestamps: 1
[2025-11-15T21:27:33.960Z] Current count after filter: 1
[2025-11-15T21:27:33.960Z] Max requests allowed: 3
[2025-11-15T21:27:33.960Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.960Z] New count: 2
[2025-11-15T21:27:33.961Z] Remaining: 1
[2025-11-15T21:27:33.966Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.966Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.993Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.994Z] Request URL: /auth/login
[2025-11-15T21:27:33.994Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.994Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.994Z] Will use test ID?: true
[2025-11-15T21:27:33.994Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.995Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.995Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.995Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Existing timestamps: 2
[2025-11-15T21:27:33.995Z] Current count after filter: 2
[2025-11-15T21:27:33.995Z] Max requests allowed: 5
[2025-11-15T21:27:33.996Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.996Z] New count: 3
[2025-11-15T21:27:33.996Z] Remaining: 2
[2025-11-15T21:27:33.996Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.996Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:34.151Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.152Z] Request URL: /auth/login
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.152Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Will use test ID?: true
[2025-11-15T21:27:34.152Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.152Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.152Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.152Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Existing timestamps: 3
[2025-11-15T21:27:34.152Z] Current count after filter: 3
[2025-11-15T21:27:34.152Z] Max requests allowed: 5
[2025-11-15T21:27:34.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.152Z] New count: 4
[2025-11-15T21:27:34.152Z] Remaining: 1
[2025-11-15T21:27:34.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:34.181Z] üßπ clearRateLimits: Cleared 5 entries from rate limit store
[2025-11-15T21:27:34.183Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.183Z] Request URL: /auth/login
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.183Z] X-Test-ID header: perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Will use test ID?: true
[2025-11-15T21:27:34.183Z] ‚úÖ Using test identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.183Z] Got identifier from getClientIdentifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.183Z] Identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] üìù Creating new entry for key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Current count after filter: 0
[2025-11-15T21:27:34.183Z] Max requests allowed: 5
[2025-11-15T21:27:34.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.183Z] New count: 1
[2025-11-15T21:27:34.184Z] Remaining: 4
[2025-11-15T21:27:34.184Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.184Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114183
}
[2025-11-15T21:27:34.860Z] üßπ clearRateLimits: Cleared 1 entries from rate limit store
[2025-11-15T21:27:34.868Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.869Z] Request URL: /auth/login
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.869Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Will use test ID?: true
[2025-11-15T21:27:34.869Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.869Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.869Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.869Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] üìù Creating new entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Current count after filter: 0
[2025-11-15T21:27:34.869Z] Max requests allowed: 5
[2025-11-15T21:27:34.870Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.870Z] New count: 1
[2025-11-15T21:27:34.870Z] Remaining: 4
[2025-11-15T21:27:34.870Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.870Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114869
}
[2025-11-15T21:27:35.190Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:35.190Z] Request URL: /auth/login
[2025-11-15T21:27:35.190Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:35.191Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:35.191Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Will use test ID?: true
[2025-11-15T21:27:35.191Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:35.191Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:35.191Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:35.191Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] Existing timestamps: 1
[2025-11-15T21:27:35.192Z] Current count after filter: 1
[2025-11-15T21:27:35.192Z] Max requests allowed: 5
[2025-11-15T21:27:35.192Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:35.192Z] New count: 2
[2025-11-15T21:27:35.192Z] Remaining: 3
[2025-11-15T21:27:35.192Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:35.192Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242114869
}
[2025-11-15T21:32:12.512Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.513Z] Request URL: /auth/login
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.513Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Will use test ID?: true
[2025-11-15T21:32:12.513Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.513Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.513Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] üìù Creating new entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Current count after filter: 0
[2025-11-15T21:32:12.513Z] Max requests allowed: 5
[2025-11-15T21:32:12.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.514Z] New count: 1
[2025-11-15T21:32:12.514Z] Remaining: 4
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.514Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:12.514Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.514Z] Request URL: /auth/login
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.514Z] X-Test-ID header: login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] Will use test ID?: true
[2025-11-15T21:32:12.514Z] ‚úÖ Using test identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.514Z] Got identifier from getClientIdentifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.514Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.514Z] Identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392514
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.515Z] Request URL: /auth/login
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.515Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Will use test ID?: true
[2025-11-15T21:32:12.515Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.515Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.515Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.515Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.515Z] Request URL: /auth/register
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] üìù Creating new entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Current count after filter: 0
[2025-11-15T21:32:12.516Z] Max requests allowed: 3
[2025-11-15T21:32:12.516Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.516Z] New count: 1
[2025-11-15T21:32:12.516Z] Remaining: 2
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.516Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:12.516Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.516Z] Request URL: /auth/register
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] üìù Creating new entry for key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] Current count after filter: 0
[2025-11-15T21:32:12.517Z] Max requests allowed: 3
[2025-11-15T21:32:12.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.517Z] New count: 1
[2025-11-15T21:32:12.517Z] Remaining: 2
[2025-11-15T21:32:12.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.517Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.041Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.041Z] Request URL: /auth/login
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.041Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] Will use test ID?: true
[2025-11-15T21:32:13.041Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.041Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.042Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.042Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Existing timestamps: 1
[2025-11-15T21:32:13.042Z] Current count after filter: 1
[2025-11-15T21:32:13.042Z] Max requests allowed: 5
[2025-11-15T21:32:13.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.042Z] New count: 2
[2025-11-15T21:32:13.042Z] Remaining: 3
[2025-11-15T21:32:13.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.042Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.089Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.089Z] Request URL: /auth/login
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.089Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] Will use test ID?: true
[2025-11-15T21:32:13.089Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.090Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.090Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Existing timestamps: 1
[2025-11-15T21:32:13.090Z] Current count after filter: 1
[2025-11-15T21:32:13.090Z] Max requests allowed: 5
[2025-11-15T21:32:13.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.090Z] New count: 2
[2025-11-15T21:32:13.090Z] Remaining: 3
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.121Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.121Z] Request URL: /auth/login
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.121Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Will use test ID?: true
[2025-11-15T21:32:13.121Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.121Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.121Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.121Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] Current count after filter: 0
[2025-11-15T21:32:13.122Z] Max requests allowed: 5
[2025-11-15T21:32:13.122Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.122Z] New count: 1
[2025-11-15T21:32:13.122Z] Remaining: 4
[2025-11-15T21:32:13.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.122Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.274Z] Request URL: /auth/login
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.274Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Will use test ID?: true
[2025-11-15T21:32:13.274Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.274Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.274Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.274Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.275Z] Existing timestamps: 2
[2025-11-15T21:32:13.275Z] Current count after filter: 2
[2025-11-15T21:32:13.275Z] Max requests allowed: 5
[2025-11-15T21:32:13.275Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.275Z] New count: 3
[2025-11-15T21:32:13.275Z] Remaining: 2
[2025-11-15T21:32:13.275Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.275Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.373Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.373Z] Request URL: /auth/login
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.373Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Will use test ID?: true
[2025-11-15T21:32:13.373Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.373Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.373Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.373Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Existing timestamps: 1
[2025-11-15T21:32:13.373Z] Current count after filter: 1
[2025-11-15T21:32:13.374Z] Max requests allowed: 5
[2025-11-15T21:32:13.374Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.374Z] New count: 2
[2025-11-15T21:32:13.374Z] Remaining: 3
[2025-11-15T21:32:13.374Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.374Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.498Z] Request URL: /auth/login
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.498Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] Will use test ID?: true
[2025-11-15T21:32:13.498Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.498Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.498Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Existing timestamps: 3
[2025-11-15T21:32:13.499Z] Current count after filter: 3
[2025-11-15T21:32:13.499Z] Max requests allowed: 5
[2025-11-15T21:32:13.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.499Z] New count: 4
[2025-11-15T21:32:13.499Z] Remaining: 1
[2025-11-15T21:32:13.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.579Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.580Z] Request URL: /auth/register
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.580Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Will use test ID?: true
[2025-11-15T21:32:13.580Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.580Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.580Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.580Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Existing timestamps: 1
[2025-11-15T21:32:13.580Z] Current count after filter: 1
[2025-11-15T21:32:13.580Z] Max requests allowed: 3
[2025-11-15T21:32:13.580Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.580Z] New count: 2
[2025-11-15T21:32:13.580Z] Remaining: 1
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.580Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.588Z] Request URL: /auth/login
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.588Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Will use test ID?: true
[2025-11-15T21:32:13.588Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.588Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.588Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] üìù Creating new entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] Current count after filter: 0
[2025-11-15T21:32:13.589Z] Max requests allowed: 5
[2025-11-15T21:32:13.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.589Z] New count: 1
[2025-11-15T21:32:13.589Z] Remaining: 4
[2025-11-15T21:32:13.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.589Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.596Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.596Z] Request URL: /auth/login
[2025-11-15T21:32:13.596Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.597Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.597Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Will use test ID?: true
[2025-11-15T21:32:13.597Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.597Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.597Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.597Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Existing timestamps: 2
[2025-11-15T21:32:13.597Z] Current count after filter: 2
[2025-11-15T21:32:13.597Z] Max requests allowed: 5
[2025-11-15T21:32:13.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.597Z] New count: 3
[2025-11-15T21:32:13.597Z] Remaining: 2
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.597Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.598Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.598Z] Request URL: /auth/login
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.598Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Will use test ID?: true
[2025-11-15T21:32:13.598Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.598Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.598Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.598Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Existing timestamps: 2
[2025-11-15T21:32:13.598Z] Current count after filter: 2
[2025-11-15T21:32:13.598Z] Max requests allowed: 5
[2025-11-15T21:32:13.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.598Z] New count: 3
[2025-11-15T21:32:13.598Z] Remaining: 2
[2025-11-15T21:32:13.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.599Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.747Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.747Z] Request URL: /auth/login
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.747Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] Will use test ID?: true
[2025-11-15T21:32:13.747Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.747Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.747Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.748Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Existing timestamps: 4
[2025-11-15T21:32:13.748Z] Current count after filter: 4
[2025-11-15T21:32:13.748Z] Max requests allowed: 5
[2025-11-15T21:32:13.748Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.748Z] New count: 5
[2025-11-15T21:32:13.748Z] Remaining: 0
[2025-11-15T21:32:13.748Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.748Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.798Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.798Z] Request URL: /auth/login
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.798Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] Will use test ID?: true
[2025-11-15T21:32:13.798Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.799Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.799Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.799Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Existing timestamps: 1
[2025-11-15T21:32:13.799Z] Current count after filter: 1
[2025-11-15T21:32:13.799Z] Max requests allowed: 5
[2025-11-15T21:32:13.799Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.799Z] New count: 2
[2025-11-15T21:32:13.799Z] Remaining: 3
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.799Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.832Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.832Z] Request URL: /auth/login
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.832Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] Will use test ID?: true
[2025-11-15T21:32:13.832Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.832Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.832Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.833Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Existing timestamps: 3
[2025-11-15T21:32:13.833Z] Current count after filter: 3
[2025-11-15T21:32:13.833Z] Max requests allowed: 5
[2025-11-15T21:32:13.833Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.833Z] New count: 4
[2025-11-15T21:32:13.833Z] Remaining: 1
[2025-11-15T21:32:13.833Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.833Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.872Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.872Z] Request URL: /auth/login
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.872Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] Will use test ID?: true
[2025-11-15T21:32:13.872Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.873Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.873Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.873Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Existing timestamps: 3
[2025-11-15T21:32:13.873Z] Current count after filter: 3
[2025-11-15T21:32:13.873Z] Max requests allowed: 5
[2025-11-15T21:32:13.873Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.873Z] New count: 4
[2025-11-15T21:32:13.873Z] Remaining: 1
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.873Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.926Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.926Z] Request URL: /auth/register
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.926Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Will use test ID?: true
[2025-11-15T21:32:13.926Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.926Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.926Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.926Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Existing timestamps: 2
[2025-11-15T21:32:13.926Z] Current count after filter: 2
[2025-11-15T21:32:13.926Z] Max requests allowed: 3
[2025-11-15T21:32:13.926Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.926Z] New count: 3
[2025-11-15T21:32:13.926Z] Remaining: 0
[2025-11-15T21:32:13.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.927Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.971Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.971Z] Request URL: /auth/login
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.971Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] Will use test ID?: true
[2025-11-15T21:32:13.971Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.971Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.971Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.972Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Existing timestamps: 5
[2025-11-15T21:32:13.972Z] Current count after filter: 5
[2025-11-15T21:32:13.972Z] Max requests allowed: 5
[2025-11-15T21:32:13.972Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:13.972Z] Current count: 5
[2025-11-15T21:32:13.972Z] Max allowed: 5
[2025-11-15T21:32:13.972Z] Retry after (seconds): 59
[2025-11-15T21:32:13.972Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:13.972Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392513,
  "retryAfter": 59
}
[2025-11-15T21:32:13.984Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.984Z] Request URL: /auth/login
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.984Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] Will use test ID?: true
[2025-11-15T21:32:13.984Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.984Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.985Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.985Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] üìù Creating new entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Current count after filter: 0
[2025-11-15T21:32:13.985Z] Max requests allowed: 5
[2025-11-15T21:32:13.985Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.985Z] New count: 1
[2025-11-15T21:32:13.985Z] Remaining: 4
[2025-11-15T21:32:13.985Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.985Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.033Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.033Z] Request URL: /auth/login
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.033Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Will use test ID?: true
[2025-11-15T21:32:14.033Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.033Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.033Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.033Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Existing timestamps: 2
[2025-11-15T21:32:14.033Z] Current count after filter: 2
[2025-11-15T21:32:14.033Z] Max requests allowed: 5
[2025-11-15T21:32:14.033Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.033Z] New count: 3
[2025-11-15T21:32:14.033Z] Remaining: 2
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:14.091Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.091Z] Request URL: /auth/login
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.091Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Will use test ID?: true
[2025-11-15T21:32:14.091Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.091Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.091Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.091Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.092Z] Existing timestamps: 4
[2025-11-15T21:32:14.092Z] Current count after filter: 4
[2025-11-15T21:32:14.092Z] Max requests allowed: 5
[2025-11-15T21:32:14.092Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.092Z] New count: 5
[2025-11-15T21:32:14.092Z] Remaining: 0
[2025-11-15T21:32:14.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.092Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:14.150Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.150Z] Request URL: /auth/login
[2025-11-15T21:32:14.150Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.151Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Will use test ID?: true
[2025-11-15T21:32:14.151Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.151Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.151Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.151Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Existing timestamps: 4
[2025-11-15T21:32:14.151Z] Current count after filter: 4
[2025-11-15T21:32:14.151Z] Max requests allowed: 5
[2025-11-15T21:32:14.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.151Z] New count: 5
[2025-11-15T21:32:14.151Z] Remaining: 0
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:14.268Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.268Z] Request URL: /auth/login
[2025-11-15T21:32:14.268Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.268Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Will use test ID?: true
[2025-11-15T21:32:14.269Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.269Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.269Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.269Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Existing timestamps: 1
[2025-11-15T21:32:14.269Z] Current count after filter: 1
[2025-11-15T21:32:14.269Z] Max requests allowed: 5
[2025-11-15T21:32:14.269Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.269Z] New count: 2
[2025-11-15T21:32:14.269Z] Remaining: 3
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.269Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.272Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.272Z] Request URL: /auth/register
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.272Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Will use test ID?: true
[2025-11-15T21:32:14.272Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.272Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.272Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.272Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Existing timestamps: 3
[2025-11-15T21:32:14.272Z] Current count after filter: 3
[2025-11-15T21:32:14.272Z] Max requests allowed: 3
[2025-11-15T21:32:14.272Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.272Z] Current count: 3
[2025-11-15T21:32:14.272Z] Max allowed: 3
[2025-11-15T21:32:14.272Z] Retry after (seconds): 59
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.272Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392516,
  "retryAfter": 59
}
[2025-11-15T21:32:14.284Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.284Z] Request URL: /auth/login
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.284Z] X-Test-ID header: perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Will use test ID?: true
[2025-11-15T21:32:14.284Z] ‚úÖ Using test identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.284Z] Got identifier from getClientIdentifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.284Z] Identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] üìù Creating new entry for key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Current count after filter: 0
[2025-11-15T21:32:14.284Z] Max requests allowed: 5
[2025-11-15T21:32:14.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.284Z] New count: 1
[2025-11-15T21:32:14.284Z] Remaining: 4
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242394284
}
[2025-11-15T21:32:14.343Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.343Z] Request URL: /auth/login
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.344Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Will use test ID?: true
[2025-11-15T21:32:14.344Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.344Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.344Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.344Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Existing timestamps: 5
[2025-11-15T21:32:14.344Z] Current count after filter: 5
[2025-11-15T21:32:14.344Z] Max requests allowed: 5
[2025-11-15T21:32:14.344Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.344Z] Current count: 5
[2025-11-15T21:32:14.344Z] Max allowed: 5
[2025-11-15T21:32:14.344Z] Retry after (seconds): 59
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.344Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242393121,
  "retryAfter": 59
}
[2025-11-15T21:32:14.346Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.346Z] Request URL: /auth/register
[2025-11-15T21:32:14.346Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.346Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.346Z] Will use test ID?: true
[2025-11-15T21:32:14.347Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.347Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.347Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.347Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Current count after filter: 0
[2025-11-15T21:32:14.347Z] Max requests allowed: 3
[2025-11-15T21:32:14.347Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.347Z] New count: 1
[2025-11-15T21:32:14.347Z] Remaining: 2
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.347Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242394347
}
[2025-11-15T21:32:14.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.448Z] Request URL: /auth/login
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.449Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Will use test ID?: true
[2025-11-15T21:32:14.449Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.449Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.449Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.449Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Existing timestamps: 5
[2025-11-15T21:32:14.449Z] Current count after filter: 5
[2025-11-15T21:32:14.449Z] Max requests allowed: 5
[2025-11-15T21:32:14.449Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.449Z] Current count: 5
[2025-11-15T21:32:14.449Z] Max allowed: 5
[2025-11-15T21:32:14.449Z] Retry after (seconds): 59
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.449Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392515,
  "retryAfter": 59
}
[2025-11-15T21:36:59.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.426Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.426Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] üìù Creating new entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Current count after filter: 0
[2025-11-15T21:36:59.426Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 1
[2025-11-15T21:36:59.427Z] Remaining: 4
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.427Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.427Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Existing timestamps: 1
[2025-11-15T21:36:59.427Z] Current count after filter: 1
[2025-11-15T21:36:59.427Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 2
[2025-11-15T21:36:59.427Z] Remaining: 3
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.428Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.428Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Existing timestamps: 2
[2025-11-15T21:36:59.428Z] Current count after filter: 2
[2025-11-15T21:36:59.428Z] Max requests allowed: 5
[2025-11-15T21:36:59.428Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.428Z] New count: 3
[2025-11-15T21:36:59.428Z] Remaining: 2
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 3
[2025-11-15T21:36:59.429Z] Current count after filter: 3
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 4
[2025-11-15T21:36:59.429Z] Remaining: 1
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 4
[2025-11-15T21:36:59.429Z] Current count after filter: 4
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 5
[2025-11-15T21:36:59.429Z] Remaining: 0
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìù Creating new entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Current count after filter: 0
[2025-11-15T21:36:59.430Z] Max requests allowed: 5
[2025-11-15T21:36:59.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.430Z] New count: 1
[2025-11-15T21:36:59.430Z] Remaining: 4
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Existing timestamps: 1
[2025-11-15T21:36:59.431Z] Current count after filter: 1
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 2
[2025-11-15T21:36:59.431Z] Remaining: 3
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 2
[2025-11-15T21:36:59.431Z] Current count after filter: 2
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 3
[2025-11-15T21:36:59.431Z] Remaining: 2
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 3
[2025-11-15T21:36:59.431Z] Current count after filter: 3
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 4
[2025-11-15T21:36:59.431Z] Remaining: 1
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 4
[2025-11-15T21:36:59.432Z] Current count after filter: 4
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.432Z] New count: 5
[2025-11-15T21:36:59.432Z] Remaining: 0
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 5
[2025-11-15T21:36:59.432Z] Current count after filter: 5
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.432Z] Current count: 5
[2025-11-15T21:36:59.432Z] Max allowed: 5
[2025-11-15T21:36:59.432Z] Retry after (seconds): 60
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.432Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.432Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìù Creating new entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Current count after filter: 0
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 1
[2025-11-15T21:36:59.433Z] Remaining: 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 1
[2025-11-15T21:36:59.433Z] Current count after filter: 1
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 2
[2025-11-15T21:36:59.433Z] Remaining: 0
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 2
[2025-11-15T21:36:59.433Z] Current count after filter: 2
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.433Z] Current count: 2
[2025-11-15T21:36:59.433Z] Max allowed: 2
[2025-11-15T21:36:59.433Z] Retry after (seconds): 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.585Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.585Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.585Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.585Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.585Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.586Z] Existing timestamps: 2
[2025-11-15T21:36:59.586Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.586Z] Max requests allowed: 2
[2025-11-15T21:36:59.586Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.586Z] New count: 1
[2025-11-15T21:36:59.586Z] Remaining: 1
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.586Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.586Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] üìù Creating new entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 1
[2025-11-15T21:36:59.587Z] Remaining: 4
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 1
[2025-11-15T21:36:59.587Z] Current count after filter: 1
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 2
[2025-11-15T21:36:59.587Z] Remaining: 3
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 2
[2025-11-15T21:36:59.588Z] Current count after filter: 2
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 3
[2025-11-15T21:36:59.588Z] Remaining: 2
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 3
[2025-11-15T21:36:59.588Z] Current count after filter: 3
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 4
[2025-11-15T21:36:59.588Z] Remaining: 1
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 4
[2025-11-15T21:36:59.588Z] Current count after filter: 4
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 5
[2025-11-15T21:36:59.588Z] Remaining: 0
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 5
[2025-11-15T21:36:59.589Z] Current count after filter: 5
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.589Z] Current count: 5
[2025-11-15T21:36:59.589Z] Max allowed: 5
[2025-11-15T21:36:59.589Z] Retry after (seconds): 60
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.589Z] Identifier: test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] üìù Creating new entry for key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Current count after filter: 0
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.589Z] New count: 1
[2025-11-15T21:36:59.589Z] Remaining: 4
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.590Z] Identifier: test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] üìù Creating new entry for key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Current count after filter: 0
[2025-11-15T21:36:59.590Z] Max requests allowed: 5
[2025-11-15T21:36:59.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.590Z] New count: 1
[2025-11-15T21:36:59.590Z] Remaining: 4
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.591Z] X-Test-ID header: null
[2025-11-15T21:36:59.591Z] Will use test ID?: false
[2025-11-15T21:36:59.591Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using real IP: 192.168.1.2
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.593Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.593Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.593Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] üìù Creating new entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Current count after filter: 0
[2025-11-15T21:36:59.593Z] Max requests allowed: 3
[2025-11-15T21:36:59.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.594Z] New count: 1
[2025-11-15T21:36:59.594Z] Remaining: 2
[2025-11-15T21:36:59.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.694Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.695Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.695Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Existing timestamps: 1
[2025-11-15T21:36:59.695Z] Current count after filter: 1
[2025-11-15T21:36:59.695Z] Max requests allowed: 3
[2025-11-15T21:36:59.695Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.695Z] New count: 2
[2025-11-15T21:36:59.695Z] Remaining: 1
[2025-11-15T21:36:59.695Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.795Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.795Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.795Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Existing timestamps: 2
[2025-11-15T21:36:59.795Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:36:59.795Z] Current count after filter: 1
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 2
[2025-11-15T21:36:59.796Z] Remaining: 1
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.796Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.796Z] Identifier: test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] üìù Creating new entry for key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Current count after filter: 0
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 1
[2025-11-15T21:36:59.796Z] Remaining: 2
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìù Creating new entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Current count after filter: 0
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 1
[2025-11-15T21:36:59.797Z] Remaining: 2
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 1
[2025-11-15T21:36:59.797Z] Current count after filter: 1
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 2
[2025-11-15T21:36:59.797Z] Remaining: 1
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 2
[2025-11-15T21:36:59.797Z] Current count after filter: 2
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 3
[2025-11-15T21:36:59.797Z] Remaining: 0
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Existing timestamps: 3
[2025-11-15T21:36:59.798Z] Current count after filter: 3
[2025-11-15T21:36:59.798Z] Max requests allowed: 3
[2025-11-15T21:36:59.798Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.798Z] Current count: 3
[2025-11-15T21:36:59.798Z] Max allowed: 3
[2025-11-15T21:36:59.798Z] Retry after (seconds): 60
[2025-11-15T21:36:59.798Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:17.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:17.151Z] Request URL: /auth/register
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:17.151Z] X-Test-ID header: null
[2025-11-15T21:37:17.151Z] Will use test ID?: false
[2025-11-15T21:37:17.151Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:17.151Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:17.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:17.151Z] Identifier: unknown
[2025-11-15T21:37:17.151Z] Key: register:unknown
[2025-11-15T21:37:17.151Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:37:17.151Z] Current count after filter: 0
[2025-11-15T21:37:17.151Z] Max requests allowed: 3
[2025-11-15T21:37:17.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:17.151Z] New count: 1
[2025-11-15T21:37:17.151Z] Remaining: 2
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:17.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:18.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.498Z] Request URL: /auth/verify-email
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.498Z] X-Test-ID header: null
[2025-11-15T21:37:18.498Z] Will use test ID?: false
[2025-11-15T21:37:18.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.498Z] Identifier: unknown
[2025-11-15T21:37:18.498Z] Key: login:unknown
[2025-11-15T21:37:18.498Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:37:18.498Z] Current count after filter: 0
[2025-11-15T21:37:18.498Z] Max requests allowed: 5
[2025-11-15T21:37:18.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.499Z] New count: 1
[2025-11-15T21:37:18.499Z] Remaining: 4
[2025-11-15T21:37:18.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:18.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.590Z] Request URL: /auth/forgot-password
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.590Z] X-Test-ID header: null
[2025-11-15T21:37:18.590Z] Will use test ID?: false
[2025-11-15T21:37:18.590Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.590Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.590Z] Identifier: unknown
[2025-11-15T21:37:18.590Z] Key: login:unknown
[2025-11-15T21:37:18.590Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:18.590Z] Existing timestamps: 1
[2025-11-15T21:37:18.590Z] Current count after filter: 1
[2025-11-15T21:37:18.590Z] Max requests allowed: 5
[2025-11-15T21:37:18.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.590Z] New count: 2
[2025-11-15T21:37:18.590Z] Remaining: 3
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:20.766Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:20.767Z] Request URL: /auth/reset-password
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:20.767Z] X-Test-ID header: null
[2025-11-15T21:37:20.767Z] Will use test ID?: false
[2025-11-15T21:37:20.767Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:20.767Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:20.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:20.767Z] Identifier: unknown
[2025-11-15T21:37:20.767Z] Key: login:unknown
[2025-11-15T21:37:20.767Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:20.767Z] Existing timestamps: 2
[2025-11-15T21:37:20.767Z] Current count after filter: 2
[2025-11-15T21:37:20.767Z] Max requests allowed: 5
[2025-11-15T21:37:20.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:20.768Z] New count: 3
[2025-11-15T21:37:20.768Z] Remaining: 2
[2025-11-15T21:37:20.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:20.768Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:22.065Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.065Z] Request URL: /auth/login
[2025-11-15T21:37:22.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.066Z] X-Test-ID header: login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Will use test ID?: true
[2025-11-15T21:37:22.066Z] ‚úÖ Using test identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.066Z] Got identifier from getClientIdentifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.066Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.066Z] Identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] üìù Creating new entry for key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Current count after filter: 0
[2025-11-15T21:37:22.066Z] Max requests allowed: 5
[2025-11-15T21:37:22.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.066Z] New count: 1
[2025-11-15T21:37:22.066Z] Remaining: 4
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702066
}
[2025-11-15T21:37:22.140Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.141Z] Request URL: /auth/login
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.141Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Will use test ID?: true
[2025-11-15T21:37:22.141Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.141Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.141Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.141Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] üìù Creating new entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Current count after filter: 0
[2025-11-15T21:37:22.141Z] Max requests allowed: 5
[2025-11-15T21:37:22.141Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.141Z] New count: 1
[2025-11-15T21:37:22.141Z] Remaining: 4
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.141Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.348Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.349Z] Request URL: /auth/login
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.349Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] Will use test ID?: true
[2025-11-15T21:37:22.349Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.349Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.349Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.350Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] üìù Creating new entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Current count after filter: 0
[2025-11-15T21:37:22.350Z] Max requests allowed: 5
[2025-11-15T21:37:22.350Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.350Z] New count: 1
[2025-11-15T21:37:22.350Z] Remaining: 4
[2025-11-15T21:37:22.350Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.350Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.568Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.568Z] Request URL: /auth/login
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.569Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Will use test ID?: true
[2025-11-15T21:37:22.569Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.569Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.569Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] Existing timestamps: 1
[2025-11-15T21:37:22.570Z] Current count after filter: 1
[2025-11-15T21:37:22.570Z] Max requests allowed: 5
[2025-11-15T21:37:22.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.570Z] New count: 2
[2025-11-15T21:37:22.570Z] Remaining: 3
[2025-11-15T21:37:22.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.571Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.581Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.581Z] Request URL: /auth/login
[2025-11-15T21:37:22.581Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.581Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.581Z] Will use test ID?: true
[2025-11-15T21:37:22.582Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.582Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.582Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.582Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Existing timestamps: 1
[2025-11-15T21:37:22.582Z] Current count after filter: 1
[2025-11-15T21:37:22.582Z] Max requests allowed: 5
[2025-11-15T21:37:22.582Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.582Z] New count: 2
[2025-11-15T21:37:22.582Z] Remaining: 3
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.582Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.821Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.821Z] Request URL: /auth/login
[2025-11-15T21:37:22.821Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.821Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.822Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] Will use test ID?: true
[2025-11-15T21:37:22.822Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.822Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.822Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.822Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Existing timestamps: 2
[2025-11-15T21:37:22.823Z] Current count after filter: 2
[2025-11-15T21:37:22.823Z] Max requests allowed: 5
[2025-11-15T21:37:22.824Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.824Z] New count: 3
[2025-11-15T21:37:22.824Z] Remaining: 2
[2025-11-15T21:37:22.824Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.824Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.892Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.892Z] Request URL: /auth/login
[2025-11-15T21:37:22.892Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.892Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Will use test ID?: true
[2025-11-15T21:37:22.893Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.893Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.893Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.893Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Existing timestamps: 2
[2025-11-15T21:37:22.893Z] Current count after filter: 2
[2025-11-15T21:37:22.894Z] Max requests allowed: 5
[2025-11-15T21:37:22.894Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.894Z] New count: 3
[2025-11-15T21:37:22.894Z] Remaining: 2
[2025-11-15T21:37:22.894Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.894Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.099Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.099Z] Request URL: /auth/login
[2025-11-15T21:37:23.099Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.100Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] Will use test ID?: true
[2025-11-15T21:37:23.101Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.101Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.102Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.102Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Existing timestamps: 3
[2025-11-15T21:37:23.102Z] Current count after filter: 3
[2025-11-15T21:37:23.102Z] Max requests allowed: 5
[2025-11-15T21:37:23.102Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.102Z] New count: 4
[2025-11-15T21:37:23.102Z] Remaining: 1
[2025-11-15T21:37:23.102Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.102Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.186Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.186Z] Request URL: /auth/register
[2025-11-15T21:37:23.187Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.187Z] X-Test-ID header: null
[2025-11-15T21:37:23.187Z] Will use test ID?: false
[2025-11-15T21:37:23.188Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.188Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.188Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.188Z] Identifier: unknown
[2025-11-15T21:37:23.188Z] Key: register:unknown
[2025-11-15T21:37:23.188Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:37:23.188Z] Existing timestamps: 1
[2025-11-15T21:37:23.188Z] Current count after filter: 1
[2025-11-15T21:37:23.188Z] Max requests allowed: 3
[2025-11-15T21:37:23.188Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.188Z] New count: 2
[2025-11-15T21:37:23.188Z] Remaining: 1
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.188Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:23.277Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.277Z] Request URL: /auth/login
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.277Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] Will use test ID?: true
[2025-11-15T21:37:23.277Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.277Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.278Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.278Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Existing timestamps: 3
[2025-11-15T21:37:23.279Z] Current count after filter: 3
[2025-11-15T21:37:23.279Z] Max requests allowed: 5
[2025-11-15T21:37:23.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.279Z] New count: 4
[2025-11-15T21:37:23.279Z] Remaining: 1
[2025-11-15T21:37:23.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.279Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.351Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.351Z] Request URL: /auth/login
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.352Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Will use test ID?: true
[2025-11-15T21:37:23.352Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.352Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.352Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.352Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Existing timestamps: 4
[2025-11-15T21:37:23.352Z] Current count after filter: 4
[2025-11-15T21:37:23.352Z] Max requests allowed: 5
[2025-11-15T21:37:23.352Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.352Z] New count: 5
[2025-11-15T21:37:23.352Z] Remaining: 0
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.353Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.588Z] Request URL: /auth/login
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.589Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Will use test ID?: true
[2025-11-15T21:37:23.589Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.589Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.589Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Existing timestamps: 4
[2025-11-15T21:37:23.589Z] Current count after filter: 4
[2025-11-15T21:37:23.589Z] Max requests allowed: 5
[2025-11-15T21:37:23.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.590Z] New count: 5
[2025-11-15T21:37:23.590Z] Remaining: 0
[2025-11-15T21:37:23.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.590Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.605Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.605Z] Request URL: /auth/login
[2025-11-15T21:37:23.605Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.605Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Will use test ID?: true
[2025-11-15T21:37:23.606Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.606Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.606Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.606Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Existing timestamps: 5
[2025-11-15T21:37:23.606Z] Current count after filter: 5
[2025-11-15T21:37:23.606Z] Max requests allowed: 5
[2025-11-15T21:37:23.606Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.606Z] Current count: 5
[2025-11-15T21:37:23.606Z] Max allowed: 5
[2025-11-15T21:37:23.606Z] Retry after (seconds): 59
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.606Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702349,
  "retryAfter": 59
}
[2025-11-15T21:37:23.613Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.613Z] Request URL: /auth/register
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.614Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Will use test ID?: true
[2025-11-15T21:37:23.614Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.614Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.614Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.614Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] üìù Creating new entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Current count after filter: 0
[2025-11-15T21:37:23.614Z] Max requests allowed: 3
[2025-11-15T21:37:23.614Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.614Z] New count: 1
[2025-11-15T21:37:23.614Z] Remaining: 2
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.614Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:23.873Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.873Z] Request URL: /auth/login
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.873Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] Will use test ID?: true
[2025-11-15T21:37:23.873Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.874Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.874Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.874Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Existing timestamps: 5
[2025-11-15T21:37:23.874Z] Current count after filter: 5
[2025-11-15T21:37:23.874Z] Max requests allowed: 5
[2025-11-15T21:37:23.874Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.874Z] Current count: 5
[2025-11-15T21:37:23.874Z] Max allowed: 5
[2025-11-15T21:37:23.874Z] Retry after (seconds): 59
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.874Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702141,
  "retryAfter": 59
}
[2025-11-15T21:37:23.888Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.888Z] Request URL: /auth/register
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.889Z] X-Test-ID header: register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Will use test ID?: true
[2025-11-15T21:37:23.889Z] ‚úÖ Using test identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.889Z] Got identifier from getClientIdentifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.889Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.889Z] Identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] üìù Creating new entry for key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Current count after filter: 0
[2025-11-15T21:37:23.889Z] Max requests allowed: 3
[2025-11-15T21:37:23.889Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.889Z] New count: 1
[2025-11-15T21:37:23.889Z] Remaining: 2
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.889Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703889
}
[2025-11-15T21:37:24.030Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.031Z] Request URL: /auth/register
[2025-11-15T21:37:24.031Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.031Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.031Z] Will use test ID?: true
[2025-11-15T21:37:24.032Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.032Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.032Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.032Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Existing timestamps: 1
[2025-11-15T21:37:24.032Z] Current count after filter: 1
[2025-11-15T21:37:24.032Z] Max requests allowed: 3
[2025-11-15T21:37:24.032Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.032Z] New count: 2
[2025-11-15T21:37:24.033Z] Remaining: 1
[2025-11-15T21:37:24.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.058Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.058Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.058Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] Will use test ID?: true
[2025-11-15T21:37:24.058Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.058Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.058Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.059Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] üìù Creating new entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Current count after filter: 0
[2025-11-15T21:37:24.059Z] Max requests allowed: 5
[2025-11-15T21:37:24.059Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.059Z] New count: 1
[2025-11-15T21:37:24.059Z] Remaining: 4
[2025-11-15T21:37:24.059Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.059Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.366Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.366Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.366Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.366Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Will use test ID?: true
[2025-11-15T21:37:24.367Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.367Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.367Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.367Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Existing timestamps: 1
[2025-11-15T21:37:24.368Z] Current count after filter: 1
[2025-11-15T21:37:24.368Z] Max requests allowed: 5
[2025-11-15T21:37:24.368Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.368Z] New count: 2
[2025-11-15T21:37:24.368Z] Remaining: 3
[2025-11-15T21:37:24.368Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.368Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.410Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.410Z] Request URL: /auth/login
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.410Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] Will use test ID?: true
[2025-11-15T21:37:24.410Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.410Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.411Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Current count after filter: 0
[2025-11-15T21:37:24.411Z] Max requests allowed: 5
[2025-11-15T21:37:24.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.411Z] New count: 1
[2025-11-15T21:37:24.411Z] Remaining: 4
[2025-11-15T21:37:24.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.411Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.703Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.704Z] Request URL: /auth/login
[2025-11-15T21:37:24.705Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.706Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Will use test ID?: true
[2025-11-15T21:37:24.706Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.706Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.706Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.706Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Existing timestamps: 1
[2025-11-15T21:37:24.706Z] Current count after filter: 1
[2025-11-15T21:37:24.706Z] Max requests allowed: 5
[2025-11-15T21:37:24.706Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.707Z] New count: 2
[2025-11-15T21:37:24.707Z] Remaining: 3
[2025-11-15T21:37:24.707Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.707Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.714Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.714Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.715Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Will use test ID?: true
[2025-11-15T21:37:24.715Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.715Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.715Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.715Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Existing timestamps: 2
[2025-11-15T21:37:24.715Z] Current count after filter: 2
[2025-11-15T21:37:24.715Z] Max requests allowed: 5
[2025-11-15T21:37:24.715Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.715Z] New count: 3
[2025-11-15T21:37:24.715Z] Remaining: 2
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.715Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.743Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.743Z] Request URL: /auth/register
[2025-11-15T21:37:24.743Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.743Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.743Z] Will use test ID?: true
[2025-11-15T21:37:24.744Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.744Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.744Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.744Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Existing timestamps: 2
[2025-11-15T21:37:24.744Z] Current count after filter: 2
[2025-11-15T21:37:24.744Z] Max requests allowed: 3
[2025-11-15T21:37:24.744Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.744Z] New count: 3
[2025-11-15T21:37:24.745Z] Remaining: 0
[2025-11-15T21:37:24.745Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.745Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.958Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.958Z] Request URL: /auth/login
[2025-11-15T21:37:24.958Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.958Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Will use test ID?: true
[2025-11-15T21:37:24.959Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.959Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.959Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Existing timestamps: 2
[2025-11-15T21:37:24.959Z] Current count after filter: 2
[2025-11-15T21:37:24.959Z] Max requests allowed: 5
[2025-11-15T21:37:24.959Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.959Z] New count: 3
[2025-11-15T21:37:24.959Z] Remaining: 2
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.959Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.005Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.005Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.005Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] Will use test ID?: true
[2025-11-15T21:37:25.005Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.005Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.005Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.006Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Existing timestamps: 3
[2025-11-15T21:37:25.006Z] Current count after filter: 3
[2025-11-15T21:37:25.006Z] Max requests allowed: 5
[2025-11-15T21:37:25.006Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.006Z] New count: 4
[2025-11-15T21:37:25.006Z] Remaining: 1
[2025-11-15T21:37:25.006Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.006Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.124Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.124Z] Request URL: /auth/register
[2025-11-15T21:37:25.124Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.125Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Will use test ID?: true
[2025-11-15T21:37:25.125Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.125Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.125Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.125Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Existing timestamps: 3
[2025-11-15T21:37:25.125Z] Current count after filter: 3
[2025-11-15T21:37:25.125Z] Max requests allowed: 3
[2025-11-15T21:37:25.125Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.125Z] Current count: 3
[2025-11-15T21:37:25.125Z] Max allowed: 3
[2025-11-15T21:37:25.125Z] Retry after (seconds): 59
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.126Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242703614,
  "retryAfter": 59
}
[2025-11-15T21:37:25.136Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.136Z] Request URL: /auth/login
[2025-11-15T21:37:25.136Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.137Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.137Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Will use test ID?: true
[2025-11-15T21:37:25.137Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.137Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.137Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.137Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] üìù Creating new entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Current count after filter: 0
[2025-11-15T21:37:25.137Z] Max requests allowed: 5
[2025-11-15T21:37:25.137Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.137Z] New count: 1
[2025-11-15T21:37:25.137Z] Remaining: 4
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.137Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.204Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.204Z] Request URL: /auth/login
[2025-11-15T21:37:25.204Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.204Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.206Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Will use test ID?: true
[2025-11-15T21:37:25.206Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.206Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.206Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.206Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Existing timestamps: 3
[2025-11-15T21:37:25.206Z] Current count after filter: 3
[2025-11-15T21:37:25.206Z] Max requests allowed: 5
[2025-11-15T21:37:25.206Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.206Z] New count: 4
[2025-11-15T21:37:25.206Z] Remaining: 1
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.206Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.360Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.360Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.360Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.361Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Will use test ID?: true
[2025-11-15T21:37:25.361Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.361Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.361Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.361Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Existing timestamps: 4
[2025-11-15T21:37:25.361Z] Current count after filter: 4
[2025-11-15T21:37:25.361Z] Max requests allowed: 5
[2025-11-15T21:37:25.361Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.361Z] New count: 5
[2025-11-15T21:37:25.361Z] Remaining: 0
[2025-11-15T21:37:25.362Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.362Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.367Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.368Z] Request URL: /auth/login
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.368Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Will use test ID?: true
[2025-11-15T21:37:25.368Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.368Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.368Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.368Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] Existing timestamps: 1
[2025-11-15T21:37:25.369Z] Current count after filter: 1
[2025-11-15T21:37:25.369Z] Max requests allowed: 5
[2025-11-15T21:37:25.369Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.369Z] New count: 2
[2025-11-15T21:37:25.369Z] Remaining: 3
[2025-11-15T21:37:25.369Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.369Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.432Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.433Z] Request URL: /auth/login
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.433Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] Will use test ID?: true
[2025-11-15T21:37:25.433Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.433Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.434Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.434Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Existing timestamps: 4
[2025-11-15T21:37:25.434Z] Current count after filter: 4
[2025-11-15T21:37:25.434Z] Max requests allowed: 5
[2025-11-15T21:37:25.434Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.434Z] New count: 5
[2025-11-15T21:37:25.435Z] Remaining: 0
[2025-11-15T21:37:25.435Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.435Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.618Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.618Z] Request URL: /auth/login
[2025-11-15T21:37:25.618Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.619Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Will use test ID?: true
[2025-11-15T21:37:25.619Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.619Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.619Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.619Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Existing timestamps: 2
[2025-11-15T21:37:25.619Z] Current count after filter: 2
[2025-11-15T21:37:25.619Z] Max requests allowed: 5
[2025-11-15T21:37:25.619Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.620Z] New count: 3
[2025-11-15T21:37:25.620Z] Remaining: 2
[2025-11-15T21:37:25.620Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.620Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.699Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.699Z] Request URL: /auth/login
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.699Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Will use test ID?: true
[2025-11-15T21:37:25.699Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.699Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.699Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.699Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Existing timestamps: 5
[2025-11-15T21:37:25.699Z] Current count after filter: 5
[2025-11-15T21:37:25.699Z] Max requests allowed: 5
[2025-11-15T21:37:25.699Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.700Z] Current count: 5
[2025-11-15T21:37:25.700Z] Max allowed: 5
[2025-11-15T21:37:25.700Z] Retry after (seconds): 59
[2025-11-15T21:37:25.700Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.700Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242704410,
  "retryAfter": 59
}
[2025-11-15T21:37:25.701Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.701Z] Request URL: /auth/register
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.701Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Will use test ID?: true
[2025-11-15T21:37:25.701Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.701Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.701Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.701Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Current count after filter: 0
[2025-11-15T21:37:25.701Z] Max requests allowed: 3
[2025-11-15T21:37:25.701Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.701Z] New count: 1
[2025-11-15T21:37:25.701Z] Remaining: 2
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.701Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705701
}
[2025-11-15T21:37:25.885Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.885Z] Request URL: /auth/login
[2025-11-15T21:37:25.885Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.886Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Will use test ID?: true
[2025-11-15T21:37:25.886Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.886Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.886Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.886Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] üìù Creating new entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Current count after filter: 0
[2025-11-15T21:37:25.886Z] Max requests allowed: 5
[2025-11-15T21:37:25.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.886Z] New count: 1
[2025-11-15T21:37:25.887Z] Remaining: 4
[2025-11-15T21:37:25.887Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.887Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.127Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.127Z] Request URL: /auth/login
[2025-11-15T21:37:26.127Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.127Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.128Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Will use test ID?: true
[2025-11-15T21:37:26.128Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.128Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.128Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Existing timestamps: 1
[2025-11-15T21:37:26.128Z] Current count after filter: 1
[2025-11-15T21:37:26.128Z] Max requests allowed: 5
[2025-11-15T21:37:26.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.128Z] New count: 2
[2025-11-15T21:37:26.129Z] Remaining: 3
[2025-11-15T21:37:26.129Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.129Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.133Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.133Z] Request URL: /auth/login
[2025-11-15T21:37:26.133Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.133Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.134Z] X-Test-ID header: perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Will use test ID?: true
[2025-11-15T21:37:26.134Z] ‚úÖ Using test identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.134Z] Got identifier from getClientIdentifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.134Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.134Z] Identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] üìù Creating new entry for key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Current count after filter: 0
[2025-11-15T21:37:26.134Z] Max requests allowed: 5
[2025-11-15T21:37:26.134Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.134Z] New count: 1
[2025-11-15T21:37:26.134Z] Remaining: 4
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.134Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242706134
}
[2025-11-15T21:59:17.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.508Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.509Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] üìù Creating new entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Current count after filter: 0
[2025-11-15T21:59:17.510Z] Max requests allowed: 5
[2025-11-15T21:59:17.510Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.510Z] New count: 1
[2025-11-15T21:59:17.510Z] Remaining: 4
[2025-11-15T21:59:17.510Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 1
[2025-11-15T21:59:17.511Z] Current count after filter: 1
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 2
[2025-11-15T21:59:17.511Z] Remaining: 3
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 2
[2025-11-15T21:59:17.511Z] Current count after filter: 2
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 3
[2025-11-15T21:59:17.511Z] Remaining: 2
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] Existing timestamps: 3
[2025-11-15T21:59:17.512Z] Current count after filter: 3
[2025-11-15T21:59:17.512Z] Max requests allowed: 5
[2025-11-15T21:59:17.512Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.512Z] New count: 4
[2025-11-15T21:59:17.512Z] Remaining: 1
[2025-11-15T21:59:17.512Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.513Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Existing timestamps: 4
[2025-11-15T21:59:17.513Z] Current count after filter: 4
[2025-11-15T21:59:17.513Z] Max requests allowed: 5
[2025-11-15T21:59:17.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.513Z] New count: 5
[2025-11-15T21:59:17.514Z] Remaining: 0
[2025-11-15T21:59:17.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.516Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.516Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.516Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] üìù Creating new entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] Current count after filter: 0
[2025-11-15T21:59:17.517Z] Max requests allowed: 5
[2025-11-15T21:59:17.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.517Z] New count: 1
[2025-11-15T21:59:17.517Z] Remaining: 4
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.517Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.517Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.517Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] Existing timestamps: 1
[2025-11-15T21:59:17.518Z] Current count after filter: 1
[2025-11-15T21:59:17.518Z] Max requests allowed: 5
[2025-11-15T21:59:17.518Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.518Z] New count: 2
[2025-11-15T21:59:17.519Z] Remaining: 3
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.519Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.519Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 2
[2025-11-15T21:59:17.520Z] Current count after filter: 2
[2025-11-15T21:59:17.520Z] Max requests allowed: 5
[2025-11-15T21:59:17.520Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.520Z] New count: 3
[2025-11-15T21:59:17.520Z] Remaining: 2
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.520Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.520Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 3
[2025-11-15T21:59:17.521Z] Current count after filter: 3
[2025-11-15T21:59:17.521Z] Max requests allowed: 5
[2025-11-15T21:59:17.521Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.521Z] New count: 4
[2025-11-15T21:59:17.521Z] Remaining: 1
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.521Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.521Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.521Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.521Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 4
[2025-11-15T21:59:17.522Z] Current count after filter: 4
[2025-11-15T21:59:17.522Z] Max requests allowed: 5
[2025-11-15T21:59:17.522Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.522Z] New count: 5
[2025-11-15T21:59:17.522Z] Remaining: 0
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.522Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.522Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.522Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 5
[2025-11-15T21:59:17.522Z] Current count after filter: 5
[2025-11-15T21:59:17.523Z] Max requests allowed: 5
[2025-11-15T21:59:17.523Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.523Z] Current count: 5
[2025-11-15T21:59:17.523Z] Max allowed: 5
[2025-11-15T21:59:17.523Z] Retry after (seconds): 60
[2025-11-15T21:59:17.523Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.525Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.525Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.525Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] üìù Creating new entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Current count after filter: 0
[2025-11-15T21:59:17.525Z] Max requests allowed: 2
[2025-11-15T21:59:17.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.525Z] New count: 1
[2025-11-15T21:59:17.525Z] Remaining: 1
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.526Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.526Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Existing timestamps: 1
[2025-11-15T21:59:17.526Z] Current count after filter: 1
[2025-11-15T21:59:17.526Z] Max requests allowed: 2
[2025-11-15T21:59:17.526Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.526Z] New count: 2
[2025-11-15T21:59:17.526Z] Remaining: 0
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.527Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.527Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Existing timestamps: 2
[2025-11-15T21:59:17.527Z] Current count after filter: 2
[2025-11-15T21:59:17.527Z] Max requests allowed: 2
[2025-11-15T21:59:17.528Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.528Z] Current count: 2
[2025-11-15T21:59:17.528Z] Max allowed: 2
[2025-11-15T21:59:17.528Z] Retry after (seconds): 1
[2025-11-15T21:59:17.528Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.678Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.679Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.679Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Existing timestamps: 2
[2025-11-15T21:59:17.679Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:59:17.679Z] Current count after filter: 0
[2025-11-15T21:59:17.679Z] Max requests allowed: 2
[2025-11-15T21:59:17.679Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.679Z] New count: 1
[2025-11-15T21:59:17.679Z] Remaining: 1
[2025-11-15T21:59:17.679Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìù Creating new entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Current count after filter: 0
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.681Z] New count: 1
[2025-11-15T21:59:17.681Z] Remaining: 4
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Existing timestamps: 1
[2025-11-15T21:59:17.681Z] Current count after filter: 1
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.682Z] New count: 2
[2025-11-15T21:59:17.682Z] Remaining: 3
[2025-11-15T21:59:17.682Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.683Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.683Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.683Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Existing timestamps: 2
[2025-11-15T21:59:17.683Z] Current count after filter: 2
[2025-11-15T21:59:17.683Z] Max requests allowed: 5
[2025-11-15T21:59:17.683Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.683Z] New count: 3
[2025-11-15T21:59:17.683Z] Remaining: 2
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.684Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.684Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Existing timestamps: 3
[2025-11-15T21:59:17.684Z] Current count after filter: 3
[2025-11-15T21:59:17.684Z] Max requests allowed: 5
[2025-11-15T21:59:17.684Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.684Z] New count: 4
[2025-11-15T21:59:17.685Z] Remaining: 1
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.685Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.685Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Existing timestamps: 4
[2025-11-15T21:59:17.685Z] Current count after filter: 4
[2025-11-15T21:59:17.685Z] Max requests allowed: 5
[2025-11-15T21:59:17.685Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.685Z] New count: 5
[2025-11-15T21:59:17.686Z] Remaining: 0
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Existing timestamps: 5
[2025-11-15T21:59:17.686Z] Current count after filter: 5
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.686Z] Current count: 5
[2025-11-15T21:59:17.686Z] Max allowed: 5
[2025-11-15T21:59:17.686Z] Retry after (seconds): 60
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] üìù Creating new entry for key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Current count after filter: 0
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.687Z] New count: 1
[2025-11-15T21:59:17.687Z] Remaining: 4
[2025-11-15T21:59:17.687Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.688Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.688Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.688Z] Identifier: test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] üìù Creating new entry for key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Current count after filter: 0
[2025-11-15T21:59:17.688Z] Max requests allowed: 5
[2025-11-15T21:59:17.689Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.690Z] New count: 1
[2025-11-15T21:59:17.690Z] Remaining: 4
[2025-11-15T21:59:17.690Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.692Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using real IP: 192.168.1.2
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.701Z] X-Test-ID header: null
[2025-11-15T21:59:17.701Z] Will use test ID?: false
[2025-11-15T21:59:17.701Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.702Z] X-Test-ID header: null
[2025-11-15T21:59:17.702Z] Will use test ID?: false
[2025-11-15T21:59:17.702Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.703Z] X-Test-ID header: null
[2025-11-15T21:59:17.703Z] Will use test ID?: false
[2025-11-15T21:59:17.703Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.703Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.703Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] üìù Creating new entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Current count after filter: 0
[2025-11-15T21:59:17.703Z] Max requests allowed: 3
[2025-11-15T21:59:17.703Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.703Z] New count: 1
[2025-11-15T21:59:17.704Z] Remaining: 2
[2025-11-15T21:59:17.704Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.810Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.811Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.812Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Existing timestamps: 1
[2025-11-15T21:59:17.812Z] Current count after filter: 1
[2025-11-15T21:59:17.812Z] Max requests allowed: 3
[2025-11-15T21:59:17.812Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.812Z] New count: 2
[2025-11-15T21:59:17.812Z] Remaining: 1
[2025-11-15T21:59:17.812Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.916Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.916Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.916Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Existing timestamps: 2
[2025-11-15T21:59:17.916Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:59:17.917Z] Current count after filter: 1
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 2
[2025-11-15T21:59:17.917Z] Remaining: 1
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.917Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.917Z] Identifier: test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] üìù Creating new entry for key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Current count after filter: 0
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 1
[2025-11-15T21:59:17.917Z] Remaining: 2
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìù Creating new entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Current count after filter: 0
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 1
[2025-11-15T21:59:17.918Z] Remaining: 2
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Existing timestamps: 1
[2025-11-15T21:59:17.918Z] Current count after filter: 1
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 2
[2025-11-15T21:59:17.918Z] Remaining: 1
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.919Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.919Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.919Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.919Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.920Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.921Z] Existing timestamps: 2
[2025-11-15T21:59:17.921Z] Current count after filter: 2
[2025-11-15T21:59:17.921Z] Max requests allowed: 3
[2025-11-15T21:59:17.921Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.921Z] New count: 3
[2025-11-15T21:59:17.921Z] Remaining: 0
[2025-11-15T21:59:17.921Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.922Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.922Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Existing timestamps: 3
[2025-11-15T21:59:17.922Z] Current count after filter: 3
[2025-11-15T21:59:17.922Z] Max requests allowed: 3
[2025-11-15T21:59:17.922Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.922Z] Current count: 3
[2025-11-15T21:59:17.922Z] Max allowed: 3
[2025-11-15T21:59:17.922Z] Retry after (seconds): 60
[2025-11-15T21:59:17.923Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:26.447Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:26.447Z] Request URL: /auth/token
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:26.448Z] X-Test-ID header: null
[2025-11-15T21:59:26.448Z] Will use test ID?: false
[2025-11-15T21:59:26.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:26.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:26.448Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:26.448Z] Identifier: unknown
[2025-11-15T21:59:26.448Z] Key: token:unknown
[2025-11-15T21:59:26.448Z] üìù Creating new entry for key: token:unknown
[2025-11-15T21:59:26.448Z] Current count after filter: 0
[2025-11-15T21:59:26.448Z] Max requests allowed: 60
[2025-11-15T21:59:26.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:26.448Z] New count: 1
[2025-11-15T21:59:26.448Z] Remaining: 59
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:26.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.104Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.104Z] Request URL: /auth/token
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.105Z] X-Test-ID header: null
[2025-11-15T21:59:27.105Z] Will use test ID?: false
[2025-11-15T21:59:27.105Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.105Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.105Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.105Z] Identifier: unknown
[2025-11-15T21:59:27.105Z] Key: token:unknown
[2025-11-15T21:59:27.105Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.105Z] Existing timestamps: 1
[2025-11-15T21:59:27.105Z] Current count after filter: 1
[2025-11-15T21:59:27.106Z] Max requests allowed: 60
[2025-11-15T21:59:27.106Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.106Z] New count: 2
[2025-11-15T21:59:27.106Z] Remaining: 58
[2025-11-15T21:59:27.106Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.106Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.981Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.982Z] Request URL: /auth/token
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.982Z] X-Test-ID header: null
[2025-11-15T21:59:27.982Z] Will use test ID?: false
[2025-11-15T21:59:27.982Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.982Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.982Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.983Z] Identifier: unknown
[2025-11-15T21:59:27.983Z] Key: token:unknown
[2025-11-15T21:59:27.983Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.983Z] Existing timestamps: 2
[2025-11-15T21:59:27.983Z] Current count after filter: 2
[2025-11-15T21:59:27.983Z] Max requests allowed: 60
[2025-11-15T21:59:27.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.983Z] New count: 3
[2025-11-15T21:59:27.983Z] Remaining: 57
[2025-11-15T21:59:27.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:28.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.448Z] Request URL: /auth/reset-password
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.448Z] X-Test-ID header: null
[2025-11-15T21:59:28.448Z] Will use test ID?: false
[2025-11-15T21:59:28.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.448Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.448Z] Identifier: unknown
[2025-11-15T21:59:28.448Z] Key: login:unknown
[2025-11-15T21:59:28.448Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:59:28.448Z] Current count after filter: 0
[2025-11-15T21:59:28.448Z] Max requests allowed: 5
[2025-11-15T21:59:28.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.448Z] New count: 1
[2025-11-15T21:59:28.448Z] Remaining: 4
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.463Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.463Z] Request URL: /auth/forgot-password
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.463Z] X-Test-ID header: null
[2025-11-15T21:59:28.463Z] Will use test ID?: false
[2025-11-15T21:59:28.463Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.463Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.463Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.463Z] Identifier: unknown
[2025-11-15T21:59:28.463Z] Key: login:unknown
[2025-11-15T21:59:28.463Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:28.463Z] Existing timestamps: 1
[2025-11-15T21:59:28.463Z] Current count after filter: 1
[2025-11-15T21:59:28.463Z] Max requests allowed: 5
[2025-11-15T21:59:28.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.464Z] New count: 2
[2025-11-15T21:59:28.464Z] Remaining: 3
[2025-11-15T21:59:28.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.464Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.498Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.498Z] Request URL: /auth/register
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.498Z] X-Test-ID header: null
[2025-11-15T21:59:28.498Z] Will use test ID?: false
[2025-11-15T21:59:28.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.498Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.498Z] Identifier: unknown
[2025-11-15T21:59:28.498Z] Key: register:unknown
[2025-11-15T21:59:28.498Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:59:28.498Z] Current count after filter: 0
[2025-11-15T21:59:28.498Z] Max requests allowed: 3
[2025-11-15T21:59:28.498Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.499Z] New count: 1
[2025-11-15T21:59:28.499Z] Remaining: 2
[2025-11-15T21:59:28.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:28.932Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.932Z] Request URL: /auth/register
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.932Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Will use test ID?: true
[2025-11-15T21:59:28.932Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.932Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.932Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.932Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] üìù Creating new entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] Current count after filter: 0
[2025-11-15T21:59:28.933Z] Max requests allowed: 3
[2025-11-15T21:59:28.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.933Z] New count: 1
[2025-11-15T21:59:28.933Z] Remaining: 2
[2025-11-15T21:59:28.933Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.933Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:28.982Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.982Z] Request URL: /auth/login
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.983Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Will use test ID?: true
[2025-11-15T21:59:28.983Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.983Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.983Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.983Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] üìù Creating new entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Current count after filter: 0
[2025-11-15T21:59:28.983Z] Max requests allowed: 5
[2025-11-15T21:59:28.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.983Z] New count: 1
[2025-11-15T21:59:28.983Z] Remaining: 4
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.176Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.176Z] Request URL: /auth/login
[2025-11-15T21:59:29.176Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.176Z] X-Test-ID header: login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Will use test ID?: true
[2025-11-15T21:59:29.177Z] ‚úÖ Using test identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.177Z] Got identifier from getClientIdentifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.177Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.177Z] Identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] üìù Creating new entry for key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Current count after filter: 0
[2025-11-15T21:59:29.177Z] Max requests allowed: 5
[2025-11-15T21:59:29.177Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.177Z] New count: 1
[2025-11-15T21:59:29.177Z] Remaining: 4
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.177Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029177
}
[2025-11-15T21:59:29.179Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.179Z] Request URL: /auth/login
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.179Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Will use test ID?: true
[2025-11-15T21:59:29.179Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.179Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.179Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.179Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] üìù Creating new entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Current count after filter: 0
[2025-11-15T21:59:29.179Z] Max requests allowed: 5
[2025-11-15T21:59:29.179Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.179Z] New count: 1
[2025-11-15T21:59:29.179Z] Remaining: 4
[2025-11-15T21:59:29.180Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.180Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.302Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.302Z] Request URL: /auth/login
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.302Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] Will use test ID?: true
[2025-11-15T21:59:29.302Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.302Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.302Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.303Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Existing timestamps: 1
[2025-11-15T21:59:29.303Z] Current count after filter: 1
[2025-11-15T21:59:29.303Z] Max requests allowed: 5
[2025-11-15T21:59:29.303Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.303Z] New count: 2
[2025-11-15T21:59:29.303Z] Remaining: 3
[2025-11-15T21:59:29.303Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.303Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.470Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.471Z] Request URL: /auth/register
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.471Z] X-Test-ID header: register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Will use test ID?: true
[2025-11-15T21:59:29.471Z] ‚úÖ Using test identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.471Z] Got identifier from getClientIdentifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.471Z] Identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] üìù Creating new entry for key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] Current count after filter: 0
[2025-11-15T21:59:29.472Z] Max requests allowed: 3
[2025-11-15T21:59:29.472Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.472Z] New count: 1
[2025-11-15T21:59:29.472Z] Remaining: 2
[2025-11-15T21:59:29.472Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.472Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029471
}
[2025-11-15T21:59:29.552Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.552Z] Request URL: /auth/register
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.552Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] Will use test ID?: true
[2025-11-15T21:59:29.552Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.553Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.553Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.553Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Existing timestamps: 1
[2025-11-15T21:59:29.553Z] Current count after filter: 1
[2025-11-15T21:59:29.553Z] Max requests allowed: 3
[2025-11-15T21:59:29.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.553Z] New count: 2
[2025-11-15T21:59:29.553Z] Remaining: 1
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.553Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.590Z] Request URL: /auth/login
[2025-11-15T21:59:29.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.591Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Will use test ID?: true
[2025-11-15T21:59:29.591Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.591Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.591Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Existing timestamps: 1
[2025-11-15T21:59:29.592Z] Current count after filter: 1
[2025-11-15T21:59:29.592Z] Max requests allowed: 5
[2025-11-15T21:59:29.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.592Z] New count: 2
[2025-11-15T21:59:29.592Z] Remaining: 3
[2025-11-15T21:59:29.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.592Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.606Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.606Z] Request URL: /auth/login
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.606Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] Will use test ID?: true
[2025-11-15T21:59:29.606Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.607Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.607Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.607Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Existing timestamps: 2
[2025-11-15T21:59:29.607Z] Current count after filter: 2
[2025-11-15T21:59:29.607Z] Max requests allowed: 5
[2025-11-15T21:59:29.607Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.607Z] New count: 3
[2025-11-15T21:59:29.607Z] Remaining: 2
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.607Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.850Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.850Z] Request URL: /auth/verify-email
[2025-11-15T21:59:29.850Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.850Z] X-Test-ID header: null
[2025-11-15T21:59:29.850Z] Will use test ID?: false
[2025-11-15T21:59:29.851Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.851Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.851Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.851Z] Identifier: unknown
[2025-11-15T21:59:29.851Z] Key: login:unknown
[2025-11-15T21:59:29.852Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:29.852Z] Existing timestamps: 2
[2025-11-15T21:59:29.852Z] Current count after filter: 2
[2025-11-15T21:59:29.852Z] Max requests allowed: 5
[2025-11-15T21:59:29.852Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.852Z] New count: 3
[2025-11-15T21:59:29.852Z] Remaining: 2
[2025-11-15T21:59:29.852Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.852Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:29.857Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.857Z] Request URL: /auth/login
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.858Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Will use test ID?: true
[2025-11-15T21:59:29.858Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.858Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.858Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.858Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Existing timestamps: 2
[2025-11-15T21:59:29.859Z] Current count after filter: 2
[2025-11-15T21:59:29.859Z] Max requests allowed: 5
[2025-11-15T21:59:29.859Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.859Z] New count: 3
[2025-11-15T21:59:29.859Z] Remaining: 2
[2025-11-15T21:59:29.859Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.859Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.886Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.886Z] Request URL: /auth/register
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.886Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] Will use test ID?: true
[2025-11-15T21:59:29.886Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.886Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.886Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.887Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Existing timestamps: 2
[2025-11-15T21:59:29.887Z] Current count after filter: 2
[2025-11-15T21:59:29.887Z] Max requests allowed: 3
[2025-11-15T21:59:29.887Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.887Z] New count: 3
[2025-11-15T21:59:29.888Z] Remaining: 0
[2025-11-15T21:59:29.888Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.888Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.941Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.941Z] Request URL: /auth/login
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.942Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] Will use test ID?: true
[2025-11-15T21:59:29.942Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.943Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.943Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] üìù Creating new entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Current count after filter: 0
[2025-11-15T21:59:29.943Z] Max requests allowed: 5
[2025-11-15T21:59:29.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.943Z] New count: 1
[2025-11-15T21:59:29.943Z] Remaining: 4
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.081Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.081Z] Request URL: /auth/login
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.081Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] Will use test ID?: true
[2025-11-15T21:59:30.081Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.081Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.082Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.082Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Existing timestamps: 3
[2025-11-15T21:59:30.082Z] Current count after filter: 3
[2025-11-15T21:59:30.082Z] Max requests allowed: 5
[2025-11-15T21:59:30.082Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.082Z] New count: 4
[2025-11-15T21:59:30.082Z] Remaining: 1
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.082Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.108Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.108Z] Request URL: /auth/login
[2025-11-15T21:59:30.108Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.108Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.109Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Will use test ID?: true
[2025-11-15T21:59:30.109Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.109Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.109Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.109Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Existing timestamps: 3
[2025-11-15T21:59:30.109Z] Current count after filter: 3
[2025-11-15T21:59:30.109Z] Max requests allowed: 5
[2025-11-15T21:59:30.109Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.109Z] New count: 4
[2025-11-15T21:59:30.109Z] Remaining: 1
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.109Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.180Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.180Z] Request URL: /auth/login
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.181Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Will use test ID?: true
[2025-11-15T21:59:30.181Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.181Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.181Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.181Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] Existing timestamps: 1
[2025-11-15T21:59:30.182Z] Current count after filter: 1
[2025-11-15T21:59:30.182Z] Max requests allowed: 5
[2025-11-15T21:59:30.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.182Z] New count: 2
[2025-11-15T21:59:30.182Z] Remaining: 3
[2025-11-15T21:59:30.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.182Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.267Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:30.267Z] Request URL: /auth/register
[2025-11-15T21:59:30.267Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.268Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] Will use test ID?: true
[2025-11-15T21:59:30.268Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.268Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.269Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:30.269Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Existing timestamps: 3
[2025-11-15T21:59:30.269Z] Current count after filter: 3
[2025-11-15T21:59:30.269Z] Max requests allowed: 3
[2025-11-15T21:59:30.269Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.269Z] Current count: 3
[2025-11-15T21:59:30.269Z] Max allowed: 3
[2025-11-15T21:59:30.269Z] Retry after (seconds): 59
[2025-11-15T21:59:30.270Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.270Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028932,
  "retryAfter": 59
}
[2025-11-15T21:59:30.283Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.283Z] Request URL: /auth/login
[2025-11-15T21:59:30.283Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.283Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.283Z] Will use test ID?: true
[2025-11-15T21:59:30.283Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.284Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.284Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] üìù Creating new entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Current count after filter: 0
[2025-11-15T21:59:30.284Z] Max requests allowed: 5
[2025-11-15T21:59:30.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.284Z] New count: 1
[2025-11-15T21:59:30.284Z] Remaining: 4
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.340Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.340Z] Request URL: /auth/login
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.340Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] Will use test ID?: true
[2025-11-15T21:59:30.340Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.340Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.340Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.341Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Existing timestamps: 4
[2025-11-15T21:59:30.341Z] Current count after filter: 4
[2025-11-15T21:59:30.341Z] Max requests allowed: 5
[2025-11-15T21:59:30.341Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.341Z] New count: 5
[2025-11-15T21:59:30.341Z] Remaining: 0
[2025-11-15T21:59:30.341Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.341Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.375Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.375Z] Request URL: /auth/login
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.375Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] Will use test ID?: true
[2025-11-15T21:59:30.375Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.375Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.375Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.375Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Existing timestamps: 4
[2025-11-15T21:59:30.376Z] Current count after filter: 4
[2025-11-15T21:59:30.376Z] Max requests allowed: 5
[2025-11-15T21:59:30.376Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.376Z] New count: 5
[2025-11-15T21:59:30.376Z] Remaining: 0
[2025-11-15T21:59:30.376Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.376Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.408Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.408Z] Request URL: /auth/login
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.408Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] Will use test ID?: true
[2025-11-15T21:59:30.408Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.408Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.408Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.409Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Existing timestamps: 2
[2025-11-15T21:59:30.409Z] Current count after filter: 2
[2025-11-15T21:59:30.409Z] Max requests allowed: 5
[2025-11-15T21:59:30.409Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.409Z] New count: 3
[2025-11-15T21:59:30.409Z] Remaining: 2
[2025-11-15T21:59:30.409Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.409Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.601Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.601Z] Request URL: /auth/login
[2025-11-15T21:59:30.601Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.601Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.601Z] Will use test ID?: true
[2025-11-15T21:59:30.601Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.602Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.602Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.602Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Existing timestamps: 5
[2025-11-15T21:59:30.602Z] Current count after filter: 5
[2025-11-15T21:59:30.602Z] Max requests allowed: 5
[2025-11-15T21:59:30.602Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.602Z] Current count: 5
[2025-11-15T21:59:30.602Z] Max allowed: 5
[2025-11-15T21:59:30.602Z] Retry after (seconds): 59
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.602Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029179,
  "retryAfter": 59
}
[2025-11-15T21:59:30.612Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.612Z] Request URL: /auth/login
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.612Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Will use test ID?: true
[2025-11-15T21:59:30.612Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.612Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.612Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] üìù Creating new entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Current count after filter: 0
[2025-11-15T21:59:30.612Z] Max requests allowed: 5
[2025-11-15T21:59:30.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.612Z] New count: 1
[2025-11-15T21:59:30.612Z] Remaining: 4
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.613Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.649Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.649Z] Request URL: /auth/login
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.649Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Will use test ID?: true
[2025-11-15T21:59:30.649Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.649Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.649Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.649Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.650Z] Existing timestamps: 3
[2025-11-15T21:59:30.650Z] Current count after filter: 3
[2025-11-15T21:59:30.650Z] Max requests allowed: 5
[2025-11-15T21:59:30.650Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.650Z] New count: 4
[2025-11-15T21:59:30.650Z] Remaining: 1
[2025-11-15T21:59:30.650Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.650Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.654Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.654Z] Request URL: /auth/login
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.654Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Will use test ID?: true
[2025-11-15T21:59:30.654Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.654Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.654Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.654Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Existing timestamps: 5
[2025-11-15T21:59:30.654Z] Current count after filter: 5
[2025-11-15T21:59:30.654Z] Max requests allowed: 5
[2025-11-15T21:59:30.654Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.654Z] Current count: 5
[2025-11-15T21:59:30.654Z] Max allowed: 5
[2025-11-15T21:59:30.654Z] Retry after (seconds): 59
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.654Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028983,
  "retryAfter": 59
}
[2025-11-15T21:59:30.664Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.664Z] Request URL: /auth/login
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.664Z] X-Test-ID header: perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Will use test ID?: true
[2025-11-15T21:59:30.664Z] ‚úÖ Using test identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.664Z] Got identifier from getClientIdentifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.664Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.664Z] Identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] üìù Creating new entry for key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Current count after filter: 0
[2025-11-15T21:59:30.664Z] Max requests allowed: 5
[2025-11-15T21:59:30.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.664Z] New count: 1
[2025-11-15T21:59:30.664Z] Remaining: 4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.664Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030664
}
[2025-11-15T21:59:30.668Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.668Z] Request URL: /auth/login
[2025-11-15T21:59:30.668Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.668Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Will use test ID?: true
[2025-11-15T21:59:30.669Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.669Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.669Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.669Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Existing timestamps: 1
[2025-11-15T21:59:30.669Z] Current count after filter: 1
[2025-11-15T21:59:30.669Z] Max requests allowed: 5
[2025-11-15T21:59:30.669Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.669Z] New count: 2
[2025-11-15T21:59:30.669Z] Remaining: 3
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.669Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.848Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.848Z] Request URL: /auth/login
[2025-11-15T21:59:30.848Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.848Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.848Z] Will use test ID?: true
[2025-11-15T21:59:30.849Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.849Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.849Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.849Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] üìñ Found existing entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Existing timestamps: 1
[2025-11-15T21:59:30.849Z] Current count after filter: 1
[2025-11-15T21:59:30.849Z] Max requests allowed: 5
[2025-11-15T21:59:30.849Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.849Z] New count: 2
[2025-11-15T21:59:30.849Z] Remaining: 3
[2025-11-15T21:59:30.850Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.850Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.881Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.887Z] Request URL: /auth/login
[2025-11-15T21:59:30.887Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.887Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.888Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.888Z] Will use test ID?: true
[2025-11-15T21:59:30.889Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.889Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.889Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.889Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Existing timestamps: 4
[2025-11-15T21:59:30.889Z] Current count after filter: 4
[2025-11-15T21:59:30.889Z] Max requests allowed: 5
[2025-11-15T21:59:30.890Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.890Z] New count: 5
[2025-11-15T21:59:30.890Z] Remaining: 0
[2025-11-15T21:59:30.890Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.890Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.909Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.909Z] Request URL: /auth/login
[2025-11-15T21:59:30.909Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.910Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Will use test ID?: true
[2025-11-15T21:59:30.910Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.910Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.910Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.910Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] Existing timestamps: 2
[2025-11-15T21:59:30.911Z] Current count after filter: 2
[2025-11-15T21:59:30.911Z] Max requests allowed: 5
[2025-11-15T21:59:30.911Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.911Z] New count: 3
[2025-11-15T21:59:30.911Z] Remaining: 2
[2025-11-15T21:59:30.911Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.911Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:31.137Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:31.137Z] Request URL: /auth/login
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.138Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] Will use test ID?: true
[2025-11-15T21:59:31.138Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.139Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.139Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:31.139Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Existing timestamps: 5
[2025-11-15T21:59:31.139Z] Current count after filter: 5
[2025-11-15T21:59:31.139Z] Max requests allowed: 5
[2025-11-15T21:59:31.140Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:31.140Z] Current count: 5
[2025-11-15T21:59:31.140Z] Max allowed: 5
[2025-11-15T21:59:31.140Z] Retry after (seconds): 59
[2025-11-15T21:59:31.140Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:31.140Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029943,
  "retryAfter": 59
}
[2025-11-15T21:59:31.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:31.150Z] Request URL: /auth/register
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.151Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] Will use test ID?: true
[2025-11-15T21:59:31.151Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.151Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:31.152Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] üìù Creating new entry for key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Current count after filter: 0
[2025-11-15T21:59:31.152Z] Max requests allowed: 3
[2025-11-15T21:59:31.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:31.152Z] New count: 1
[2025-11-15T21:59:31.152Z] Remaining: 2
[2025-11-15T21:59:31.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:31.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244031151
}
[2025-11-15T21:59:34.064Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:34.065Z] Request URL: /auth/register
[2025-11-15T21:59:34.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.065Z] X-Test-ID header: null
[2025-11-15T21:59:34.065Z] Will use test ID?: false
[2025-11-15T21:59:34.066Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.066Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.066Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:34.066Z] Identifier: unknown
[2025-11-15T21:59:34.066Z] Key: register:unknown
[2025-11-15T21:59:34.066Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:59:34.066Z] Existing timestamps: 1
[2025-11-15T21:59:34.066Z] Current count after filter: 1
[2025-11-15T21:59:34.066Z] Max requests allowed: 3
[2025-11-15T21:59:34.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.066Z] New count: 2
[2025-11-15T21:59:34.066Z] Remaining: 1
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:34.942Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:34.943Z] Request URL: /auth/verify-email
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.943Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Will use test ID?: true
[2025-11-15T21:59:34.943Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.943Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:34.943Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] üìù Creating new entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Current count after filter: 0
[2025-11-15T21:59:34.943Z] Max requests allowed: 5
[2025-11-15T21:59:34.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.943Z] New count: 1
[2025-11-15T21:59:34.943Z] Remaining: 4
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.253Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.253Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.253Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.254Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.254Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Will use test ID?: true
[2025-11-15T21:59:35.254Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.254Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.254Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Existing timestamps: 1
[2025-11-15T21:59:35.254Z] Current count after filter: 1
[2025-11-15T21:59:35.254Z] Max requests allowed: 5
[2025-11-15T21:59:35.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.254Z] New count: 2
[2025-11-15T21:59:35.254Z] Remaining: 3
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.255Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.625Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.626Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.626Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Will use test ID?: true
[2025-11-15T21:59:35.626Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.626Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.626Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.626Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Existing timestamps: 2
[2025-11-15T21:59:35.626Z] Current count after filter: 2
[2025-11-15T21:59:35.626Z] Max requests allowed: 5
[2025-11-15T21:59:35.626Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.626Z] New count: 3
[2025-11-15T21:59:35.626Z] Remaining: 2
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.626Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.975Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.975Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.975Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.976Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Will use test ID?: true
[2025-11-15T21:59:35.976Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.976Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.976Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Existing timestamps: 3
[2025-11-15T21:59:35.976Z] Current count after filter: 3
[2025-11-15T21:59:35.976Z] Max requests allowed: 5
[2025-11-15T21:59:35.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.976Z] New count: 4
[2025-11-15T21:59:35.976Z] Remaining: 1
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.976Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:36.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:36.274Z] Request URL: /auth/verify-email
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:36.275Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Will use test ID?: true
[2025-11-15T21:59:36.275Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:36.275Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:36.275Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:36.275Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] Existing timestamps: 4
[2025-11-15T21:59:36.276Z] Current count after filter: 4
[2025-11-15T21:59:36.276Z] Max requests allowed: 5
[2025-11-15T21:59:36.276Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:36.276Z] New count: 5
[2025-11-15T21:59:36.276Z] Remaining: 0
[2025-11-15T21:59:36.276Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:36.276Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244034943
}
[2025-11-17T07:56:21.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.946Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] üìù Creating new entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Current count after filter: 0
[2025-11-17T07:56:21.946Z] Max requests allowed: 5
[2025-11-17T07:56:21.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.946Z] New count: 1
[2025-11-17T07:56:21.946Z] Remaining: 4
[2025-11-17T07:56:21.946Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.946Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.946Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.946Z] Existing timestamps: 1
[2025-11-17T07:56:21.946Z] Current count after filter: 1
[2025-11-17T07:56:21.946Z] Max requests allowed: 5
[2025-11-17T07:56:21.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.946Z] New count: 2
[2025-11-17T07:56:21.946Z] Remaining: 3
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.947Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Existing timestamps: 2
[2025-11-17T07:56:21.947Z] Current count after filter: 2
[2025-11-17T07:56:21.947Z] Max requests allowed: 5
[2025-11-17T07:56:21.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.947Z] New count: 3
[2025-11-17T07:56:21.947Z] Remaining: 2
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.947Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.947Z] Existing timestamps: 3
[2025-11-17T07:56:21.947Z] Current count after filter: 3
[2025-11-17T07:56:21.947Z] Max requests allowed: 5
[2025-11-17T07:56:21.948Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.948Z] New count: 4
[2025-11-17T07:56:21.948Z] Remaining: 1
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.948Z] Identifier: test-allow-1763366181944
[2025-11-17T07:56:21.948Z] Key: login:test-allow-1763366181944
[2025-11-17T07:56:21.948Z] üìñ Found existing entry for key: login:test-allow-1763366181944
[2025-11-17T07:56:21.948Z] Existing timestamps: 4
[2025-11-17T07:56:21.948Z] Current count after filter: 4
[2025-11-17T07:56:21.948Z] Max requests allowed: 5
[2025-11-17T07:56:21.948Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.948Z] New count: 5
[2025-11-17T07:56:21.948Z] Remaining: 0
[2025-11-17T07:56:21.948Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.949Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] üìù Creating new entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] Current count after filter: 0
[2025-11-17T07:56:21.949Z] Max requests allowed: 5
[2025-11-17T07:56:21.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.949Z] New count: 1
[2025-11-17T07:56:21.949Z] Remaining: 4
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.949Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.949Z] Existing timestamps: 1
[2025-11-17T07:56:21.949Z] Current count after filter: 1
[2025-11-17T07:56:21.949Z] Max requests allowed: 5
[2025-11-17T07:56:21.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.949Z] New count: 2
[2025-11-17T07:56:21.949Z] Remaining: 3
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.949Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 2
[2025-11-17T07:56:21.950Z] Current count after filter: 2
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 3
[2025-11-17T07:56:21.950Z] Remaining: 2
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.950Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 3
[2025-11-17T07:56:21.950Z] Current count after filter: 3
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 4
[2025-11-17T07:56:21.950Z] Remaining: 1
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.950Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.950Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.950Z] Existing timestamps: 4
[2025-11-17T07:56:21.950Z] Current count after filter: 4
[2025-11-17T07:56:21.950Z] Max requests allowed: 5
[2025-11-17T07:56:21.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.950Z] New count: 5
[2025-11-17T07:56:21.950Z] Remaining: 0
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.950Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.950Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:21.951Z] Identifier: test-block-1763366181949
[2025-11-17T07:56:21.951Z] Key: login:test-block-1763366181949
[2025-11-17T07:56:21.951Z] üìñ Found existing entry for key: login:test-block-1763366181949
[2025-11-17T07:56:21.951Z] Existing timestamps: 5
[2025-11-17T07:56:21.951Z] Current count after filter: 5
[2025-11-17T07:56:21.951Z] Max requests allowed: 5
[2025-11-17T07:56:21.951Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:21.951Z] Current count: 5
[2025-11-17T07:56:21.951Z] Max allowed: 5
[2025-11-17T07:56:21.951Z] Retry after (seconds): 60
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.951Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.951Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.951Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.951Z] üìù Creating new entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.951Z] Current count after filter: 0
[2025-11-17T07:56:21.951Z] Max requests allowed: 2
[2025-11-17T07:56:21.951Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.951Z] New count: 1
[2025-11-17T07:56:21.951Z] Remaining: 1
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.951Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.951Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.951Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Existing timestamps: 1
[2025-11-17T07:56:21.952Z] Current count after filter: 1
[2025-11-17T07:56:21.952Z] Max requests allowed: 2
[2025-11-17T07:56:21.952Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:21.952Z] New count: 2
[2025-11-17T07:56:21.952Z] Remaining: 0
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:21.952Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:21.952Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:21.952Z] Existing timestamps: 2
[2025-11-17T07:56:21.952Z] Current count after filter: 2
[2025-11-17T07:56:21.952Z] Max requests allowed: 2
[2025-11-17T07:56:21.952Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:21.952Z] Current count: 2
[2025-11-17T07:56:21.952Z] Max allowed: 2
[2025-11-17T07:56:21.952Z] Retry after (seconds): 1
[2025-11-17T07:56:21.952Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:22.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.121Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T07:56:22.121Z] Identifier: test-reset-1763366181951
[2025-11-17T07:56:22.121Z] Key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:22.121Z] üìñ Found existing entry for key: test-reset:test-reset-1763366181951
[2025-11-17T07:56:22.121Z] Existing timestamps: 2
[2025-11-17T07:56:22.121Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-17T07:56:22.121Z] Current count after filter: 0
[2025-11-17T07:56:22.121Z] Max requests allowed: 2
[2025-11-17T07:56:22.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.121Z] New count: 1
[2025-11-17T07:56:22.122Z] Remaining: 1
[2025-11-17T07:56:22.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.122Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.122Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.122Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] üìù Creating new entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Current count after filter: 0
[2025-11-17T07:56:22.123Z] Max requests allowed: 5
[2025-11-17T07:56:22.123Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.123Z] New count: 1
[2025-11-17T07:56:22.123Z] Remaining: 4
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.123Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.123Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.123Z] Existing timestamps: 1
[2025-11-17T07:56:22.123Z] Current count after filter: 1
[2025-11-17T07:56:22.123Z] Max requests allowed: 5
[2025-11-17T07:56:22.123Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.123Z] New count: 2
[2025-11-17T07:56:22.123Z] Remaining: 3
[2025-11-17T07:56:22.123Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.124Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.124Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Existing timestamps: 2
[2025-11-17T07:56:22.124Z] Current count after filter: 2
[2025-11-17T07:56:22.124Z] Max requests allowed: 5
[2025-11-17T07:56:22.124Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.124Z] New count: 3
[2025-11-17T07:56:22.124Z] Remaining: 2
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.124Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.124Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.124Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.124Z] Existing timestamps: 3
[2025-11-17T07:56:22.124Z] Current count after filter: 3
[2025-11-17T07:56:22.125Z] Max requests allowed: 5
[2025-11-17T07:56:22.125Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.125Z] New count: 4
[2025-11-17T07:56:22.125Z] Remaining: 1
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.125Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.125Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Existing timestamps: 4
[2025-11-17T07:56:22.125Z] Current count after filter: 4
[2025-11-17T07:56:22.125Z] Max requests allowed: 5
[2025-11-17T07:56:22.125Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.125Z] New count: 5
[2025-11-17T07:56:22.125Z] Remaining: 0
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.125Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.125Z] Identifier: test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] Key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.125Z] üìñ Found existing entry for key: login:test-multi-1-1763366182122
[2025-11-17T07:56:22.126Z] Existing timestamps: 5
[2025-11-17T07:56:22.126Z] Current count after filter: 5
[2025-11-17T07:56:22.126Z] Max requests allowed: 5
[2025-11-17T07:56:22.126Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:22.126Z] Current count: 5
[2025-11-17T07:56:22.126Z] Max allowed: 5
[2025-11-17T07:56:22.126Z] Retry after (seconds): 60
[2025-11-17T07:56:22.126Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T07:56:22.126Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.127Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.127Z] Identifier: test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] Key: login:test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] üìù Creating new entry for key: login:test-multi-2-1763366182122
[2025-11-17T07:56:22.127Z] Current count after filter: 0
[2025-11-17T07:56:22.127Z] Max requests allowed: 5
[2025-11-17T07:56:22.127Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.127Z] New count: 1
[2025-11-17T07:56:22.127Z] Remaining: 4
[2025-11-17T07:56:22.127Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.128Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T07:56:22.128Z] Identifier: test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] Key: login:test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] üìù Creating new entry for key: login:test-reset-time-1763366182128
[2025-11-17T07:56:22.128Z] Current count after filter: 0
[2025-11-17T07:56:22.128Z] Max requests allowed: 5
[2025-11-17T07:56:22.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.128Z] New count: 1
[2025-11-17T07:56:22.128Z] Remaining: 4
[2025-11-17T07:56:22.128Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.129Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.129Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.129Z] X-Test-ID header: null
[2025-11-17T07:56:22.129Z] Will use test ID?: false
[2025-11-17T07:56:22.129Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.129Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.130Z] Using real IP: 192.168.1.2
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.130Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.130Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.130Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.130Z] X-Test-ID header: null
[2025-11-17T07:56:22.130Z] Will use test ID?: false
[2025-11-17T07:56:22.131Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (env): true
[2025-11-17T07:56:22.131Z] E2E_TEST_MODE (final): true
[2025-11-17T07:56:22.131Z] X-Test-ID header: null
[2025-11-17T07:56:22.131Z] Will use test ID?: false
[2025-11-17T07:56:22.131Z] Using forwarded IP: 192.168.1.1
[2025-11-17T07:56:22.131Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T07:56:22.131Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.131Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.131Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] üìù Creating new entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.131Z] Current count after filter: 0
[2025-11-17T07:56:22.131Z] Max requests allowed: 3
[2025-11-17T07:56:22.131Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.131Z] New count: 1
[2025-11-17T07:56:22.131Z] Remaining: 2
[2025-11-17T07:56:22.131Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.233Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.233Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.233Z] Existing timestamps: 1
[2025-11-17T07:56:22.233Z] Current count after filter: 1
[2025-11-17T07:56:22.233Z] Max requests allowed: 3
[2025-11-17T07:56:22.233Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.233Z] New count: 2
[2025-11-17T07:56:22.233Z] Remaining: 1
[2025-11-17T07:56:22.233Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.335Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.335Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T07:56:22.335Z] Identifier: test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] Key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366182131
[2025-11-17T07:56:22.335Z] Existing timestamps: 2
[2025-11-17T07:56:22.335Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-17T07:56:22.335Z] Current count after filter: 1
[2025-11-17T07:56:22.336Z] Max requests allowed: 3
[2025-11-17T07:56:22.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.336Z] New count: 2
[2025-11-17T07:56:22.336Z] Remaining: 1
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.336Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.336Z] Identifier: test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] Key: register:test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] üìù Creating new entry for key: register:test-format-allowed-1763366182336
[2025-11-17T07:56:22.336Z] Current count after filter: 0
[2025-11-17T07:56:22.336Z] Max requests allowed: 3
[2025-11-17T07:56:22.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.336Z] New count: 1
[2025-11-17T07:56:22.336Z] Remaining: 2
[2025-11-17T07:56:22.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìù Creating new entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Current count after filter: 0
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.337Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.337Z] New count: 1
[2025-11-17T07:56:22.337Z] Remaining: 2
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Existing timestamps: 1
[2025-11-17T07:56:22.337Z] Current count after filter: 1
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.337Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.337Z] New count: 2
[2025-11-17T07:56:22.337Z] Remaining: 1
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.337Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.337Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.337Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.337Z] Existing timestamps: 2
[2025-11-17T07:56:22.337Z] Current count after filter: 2
[2025-11-17T07:56:22.337Z] Max requests allowed: 3
[2025-11-17T07:56:22.338Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T07:56:22.338Z] New count: 3
[2025-11-17T07:56:22.338Z] Remaining: 0
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T07:56:22.338Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T07:56:22.338Z] Identifier: test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] Key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] üìñ Found existing entry for key: register:test-format-blocked-1763366182337
[2025-11-17T07:56:22.338Z] Existing timestamps: 3
[2025-11-17T07:56:22.338Z] Current count after filter: 3
[2025-11-17T07:56:22.338Z] Max requests allowed: 3
[2025-11-17T07:56:22.338Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T07:56:22.338Z] Current count: 3
[2025-11-17T07:56:22.338Z] Max allowed: 3
[2025-11-17T07:56:22.338Z] Retry after (seconds): 60
[2025-11-17T07:56:22.338Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.590Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.590Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.590Z] üìù Creating new entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.590Z] Current count after filter: 0
[2025-11-17T08:01:53.590Z] Max requests allowed: 5
[2025-11-17T08:01:53.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.590Z] New count: 1
[2025-11-17T08:01:53.590Z] Remaining: 4
[2025-11-17T08:01:53.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.591Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Existing timestamps: 1
[2025-11-17T08:01:53.591Z] Current count after filter: 1
[2025-11-17T08:01:53.591Z] Max requests allowed: 5
[2025-11-17T08:01:53.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.591Z] New count: 2
[2025-11-17T08:01:53.591Z] Remaining: 3
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.591Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.591Z] Existing timestamps: 2
[2025-11-17T08:01:53.591Z] Current count after filter: 2
[2025-11-17T08:01:53.591Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 3
[2025-11-17T08:01:53.592Z] Remaining: 2
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.592Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Existing timestamps: 3
[2025-11-17T08:01:53.592Z] Current count after filter: 3
[2025-11-17T08:01:53.592Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 4
[2025-11-17T08:01:53.592Z] Remaining: 1
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.592Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.592Z] Identifier: test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] üìñ Found existing entry for key: login:test-allow-1763366513589
[2025-11-17T08:01:53.592Z] Existing timestamps: 4
[2025-11-17T08:01:53.592Z] Current count after filter: 4
[2025-11-17T08:01:53.592Z] Max requests allowed: 5
[2025-11-17T08:01:53.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.592Z] New count: 5
[2025-11-17T08:01:53.592Z] Remaining: 0
[2025-11-17T08:01:53.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.593Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.593Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] üìù Creating new entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] Current count after filter: 0
[2025-11-17T08:01:53.593Z] Max requests allowed: 5
[2025-11-17T08:01:53.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.593Z] New count: 1
[2025-11-17T08:01:53.593Z] Remaining: 4
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.593Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.593Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.593Z] Existing timestamps: 1
[2025-11-17T08:01:53.593Z] Current count after filter: 1
[2025-11-17T08:01:53.593Z] Max requests allowed: 5
[2025-11-17T08:01:53.593Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.593Z] New count: 2
[2025-11-17T08:01:53.593Z] Remaining: 3
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 2
[2025-11-17T08:01:53.594Z] Current count after filter: 2
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 3
[2025-11-17T08:01:53.594Z] Remaining: 2
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 3
[2025-11-17T08:01:53.594Z] Current count after filter: 3
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 4
[2025-11-17T08:01:53.594Z] Remaining: 1
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.594Z] Existing timestamps: 4
[2025-11-17T08:01:53.594Z] Current count after filter: 4
[2025-11-17T08:01:53.594Z] Max requests allowed: 5
[2025-11-17T08:01:53.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.594Z] New count: 5
[2025-11-17T08:01:53.594Z] Remaining: 0
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.594Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.594Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.594Z] Identifier: test-block-1763366513593
[2025-11-17T08:01:53.594Z] Key: login:test-block-1763366513593
[2025-11-17T08:01:53.595Z] üìñ Found existing entry for key: login:test-block-1763366513593
[2025-11-17T08:01:53.595Z] Existing timestamps: 5
[2025-11-17T08:01:53.595Z] Current count after filter: 5
[2025-11-17T08:01:53.595Z] Max requests allowed: 5
[2025-11-17T08:01:53.595Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.595Z] Current count: 5
[2025-11-17T08:01:53.595Z] Max allowed: 5
[2025-11-17T08:01:53.595Z] Retry after (seconds): 60
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.595Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.595Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] üìù Creating new entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Current count after filter: 0
[2025-11-17T08:01:53.595Z] Max requests allowed: 2
[2025-11-17T08:01:53.595Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.595Z] New count: 1
[2025-11-17T08:01:53.595Z] Remaining: 1
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.595Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.595Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.595Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.595Z] Existing timestamps: 1
[2025-11-17T08:01:53.595Z] Current count after filter: 1
[2025-11-17T08:01:53.595Z] Max requests allowed: 2
[2025-11-17T08:01:53.596Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.596Z] New count: 2
[2025-11-17T08:01:53.596Z] Remaining: 0
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.596Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.596Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.596Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.596Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.596Z] Existing timestamps: 2
[2025-11-17T08:01:53.596Z] Current count after filter: 2
[2025-11-17T08:01:53.596Z] Max requests allowed: 2
[2025-11-17T08:01:53.596Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.596Z] Current count: 2
[2025-11-17T08:01:53.596Z] Max allowed: 2
[2025-11-17T08:01:53.596Z] Retry after (seconds): 1
[2025-11-17T08:01:53.596Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.749Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.749Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-17T08:01:53.749Z] Identifier: test-reset-1763366513595
[2025-11-17T08:01:53.749Z] Key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.749Z] üìñ Found existing entry for key: test-reset:test-reset-1763366513595
[2025-11-17T08:01:53.749Z] Existing timestamps: 2
[2025-11-17T08:01:53.749Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-17T08:01:53.749Z] Current count after filter: 0
[2025-11-17T08:01:53.749Z] Max requests allowed: 2
[2025-11-17T08:01:53.749Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.749Z] New count: 1
[2025-11-17T08:01:53.750Z] Remaining: 1
[2025-11-17T08:01:53.750Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.750Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.751Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.751Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] üìù Creating new entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.751Z] Current count after filter: 0
[2025-11-17T08:01:53.751Z] Max requests allowed: 5
[2025-11-17T08:01:53.751Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.751Z] New count: 1
[2025-11-17T08:01:53.751Z] Remaining: 4
[2025-11-17T08:01:53.752Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.752Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.752Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.753Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.754Z] Existing timestamps: 1
[2025-11-17T08:01:53.754Z] Current count after filter: 1
[2025-11-17T08:01:53.754Z] Max requests allowed: 5
[2025-11-17T08:01:53.754Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.754Z] New count: 2
[2025-11-17T08:01:53.754Z] Remaining: 3
[2025-11-17T08:01:53.754Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.754Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.754Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.755Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.755Z] Existing timestamps: 2
[2025-11-17T08:01:53.755Z] Current count after filter: 2
[2025-11-17T08:01:53.755Z] Max requests allowed: 5
[2025-11-17T08:01:53.755Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.755Z] New count: 3
[2025-11-17T08:01:53.755Z] Remaining: 2
[2025-11-17T08:01:53.755Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.755Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.755Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.756Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Existing timestamps: 3
[2025-11-17T08:01:53.756Z] Current count after filter: 3
[2025-11-17T08:01:53.756Z] Max requests allowed: 5
[2025-11-17T08:01:53.756Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.756Z] New count: 4
[2025-11-17T08:01:53.756Z] Remaining: 1
[2025-11-17T08:01:53.756Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.756Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.756Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.756Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.756Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Existing timestamps: 4
[2025-11-17T08:01:53.757Z] Current count after filter: 4
[2025-11-17T08:01:53.757Z] Max requests allowed: 5
[2025-11-17T08:01:53.757Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.757Z] New count: 5
[2025-11-17T08:01:53.757Z] Remaining: 0
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.757Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.757Z] Identifier: test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] üìñ Found existing entry for key: login:test-multi-1-1763366513750
[2025-11-17T08:01:53.757Z] Existing timestamps: 5
[2025-11-17T08:01:53.757Z] Current count after filter: 5
[2025-11-17T08:01:53.757Z] Max requests allowed: 5
[2025-11-17T08:01:53.757Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.757Z] Current count: 5
[2025-11-17T08:01:53.757Z] Max allowed: 5
[2025-11-17T08:01:53.757Z] Retry after (seconds): 60
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:01:53.757Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.757Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.757Z] Identifier: test-multi-2-1763366513750
[2025-11-17T08:01:53.757Z] Key: login:test-multi-2-1763366513750
[2025-11-17T08:01:53.759Z] üìù Creating new entry for key: login:test-multi-2-1763366513750
[2025-11-17T08:01:53.759Z] Current count after filter: 0
[2025-11-17T08:01:53.759Z] Max requests allowed: 5
[2025-11-17T08:01:53.759Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.759Z] New count: 1
[2025-11-17T08:01:53.759Z] Remaining: 4
[2025-11-17T08:01:53.759Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.760Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.760Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:01:53.760Z] Identifier: test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] Key: login:test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] üìù Creating new entry for key: login:test-reset-time-1763366513760
[2025-11-17T08:01:53.760Z] Current count after filter: 0
[2025-11-17T08:01:53.760Z] Max requests allowed: 5
[2025-11-17T08:01:53.760Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.760Z] New count: 1
[2025-11-17T08:01:53.760Z] Remaining: 4
[2025-11-17T08:01:53.760Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.761Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.761Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.761Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.762Z] X-Test-ID header: null
[2025-11-17T08:01:53.762Z] Will use test ID?: false
[2025-11-17T08:01:53.762Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.762Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.762Z] X-Test-ID header: null
[2025-11-17T08:01:53.762Z] Will use test ID?: false
[2025-11-17T08:01:53.762Z] Using real IP: 192.168.1.2
[2025-11-17T08:01:53.762Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.763Z] X-Test-ID header: null
[2025-11-17T08:01:53.763Z] Will use test ID?: false
[2025-11-17T08:01:53.763Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.763Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.763Z] X-Test-ID header: null
[2025-11-17T08:01:53.763Z] Will use test ID?: false
[2025-11-17T08:01:53.763Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:01:53.763Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.764Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (process.env): undefined
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (env): true
[2025-11-17T08:01:53.764Z] E2E_TEST_MODE (final): true
[2025-11-17T08:01:53.765Z] X-Test-ID header: null
[2025-11-17T08:01:53.765Z] Will use test ID?: false
[2025-11-17T08:01:53.765Z] Using forwarded IP: 192.168.1.1
[2025-11-17T08:01:53.765Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:01:53.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.765Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.765Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] üìù Creating new entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.765Z] Current count after filter: 0
[2025-11-17T08:01:53.765Z] Max requests allowed: 3
[2025-11-17T08:01:53.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.765Z] New count: 1
[2025-11-17T08:01:53.765Z] Remaining: 2
[2025-11-17T08:01:53.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.866Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.876Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.876Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.876Z] Existing timestamps: 1
[2025-11-17T08:01:53.876Z] Current count after filter: 1
[2025-11-17T08:01:53.876Z] Max requests allowed: 3
[2025-11-17T08:01:53.876Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.876Z] New count: 2
[2025-11-17T08:01:53.876Z] Remaining: 1
[2025-11-17T08:01:53.876Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.979Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-17T08:01:53.979Z] Identifier: test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] Key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763366513765
[2025-11-17T08:01:53.979Z] Existing timestamps: 2
[2025-11-17T08:01:53.979Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-17T08:01:53.979Z] Current count after filter: 1
[2025-11-17T08:01:53.979Z] Max requests allowed: 3
[2025-11-17T08:01:53.979Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.979Z] New count: 2
[2025-11-17T08:01:53.979Z] Remaining: 1
[2025-11-17T08:01:53.979Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.980Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.980Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.980Z] Identifier: test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] Key: register:test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] üìù Creating new entry for key: register:test-format-allowed-1763366513980
[2025-11-17T08:01:53.980Z] Current count after filter: 0
[2025-11-17T08:01:53.980Z] Max requests allowed: 3
[2025-11-17T08:01:53.980Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.980Z] New count: 1
[2025-11-17T08:01:53.980Z] Remaining: 2
[2025-11-17T08:01:53.980Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.981Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.981Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.981Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] üìù Creating new entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.981Z] Current count after filter: 0
[2025-11-17T08:01:53.981Z] Max requests allowed: 3
[2025-11-17T08:01:53.981Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.981Z] New count: 1
[2025-11-17T08:01:53.981Z] Remaining: 2
[2025-11-17T08:01:53.981Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.982Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.982Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Existing timestamps: 1
[2025-11-17T08:01:53.982Z] Current count after filter: 1
[2025-11-17T08:01:53.982Z] Max requests allowed: 3
[2025-11-17T08:01:53.982Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.982Z] New count: 2
[2025-11-17T08:01:53.982Z] Remaining: 1
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.982Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.982Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.982Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.983Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.983Z] Existing timestamps: 2
[2025-11-17T08:01:53.983Z] Current count after filter: 2
[2025-11-17T08:01:53.983Z] Max requests allowed: 3
[2025-11-17T08:01:53.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:01:53.984Z] New count: 3
[2025-11-17T08:01:53.984Z] Remaining: 0
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:01:53.985Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:01:53.985Z] Identifier: test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] Key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] üìñ Found existing entry for key: register:test-format-blocked-1763366513981
[2025-11-17T08:01:53.985Z] Existing timestamps: 3
[2025-11-17T08:01:53.985Z] Current count after filter: 3
[2025-11-17T08:01:53.985Z] Max requests allowed: 3
[2025-11-17T08:01:53.985Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:01:53.985Z] Current count: 3
[2025-11-17T08:01:53.985Z] Max allowed: 3
[2025-11-17T08:01:53.985Z] Retry after (seconds): 60
[2025-11-17T08:01:53.985Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:04.077Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.078Z] Request URL: /auth/forgot-password
[2025-11-17T08:02:04.078Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.078Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.078Z] X-Test-ID header: null
[2025-11-17T08:02:04.078Z] Will use test ID?: false
[2025-11-17T08:02:04.078Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.078Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.078Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.078Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.078Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.078Z] Identifier: unknown
[2025-11-17T08:02:04.078Z] Key: login:unknown
[2025-11-17T08:02:04.078Z] üìù Creating new entry for key: login:unknown
[2025-11-17T08:02:04.078Z] Current count after filter: 0
[2025-11-17T08:02:04.078Z] Max requests allowed: 5
[2025-11-17T08:02:04.078Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.078Z] New count: 1
[2025-11-17T08:02:04.078Z] Remaining: 4
[2025-11-17T08:02:04.078Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.079Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:04.109Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:04.113Z] Request URL: /auth/register
[2025-11-17T08:02:04.114Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.114Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.114Z] X-Test-ID header: null
[2025-11-17T08:02:04.115Z] Will use test ID?: false
[2025-11-17T08:02:04.115Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.115Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.115Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.115Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.115Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:04.115Z] Identifier: unknown
[2025-11-17T08:02:04.115Z] Key: register:unknown
[2025-11-17T08:02:04.115Z] üìù Creating new entry for key: register:unknown
[2025-11-17T08:02:04.115Z] Current count after filter: 0
[2025-11-17T08:02:04.115Z] Max requests allowed: 3
[2025-11-17T08:02:04.115Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.115Z] New count: 1
[2025-11-17T08:02:04.115Z] Remaining: 2
[2025-11-17T08:02:04.115Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.115Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584115
}
[2025-11-17T08:02:04.194Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.194Z] Request URL: /auth/reset-password
[2025-11-17T08:02:04.194Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.194Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.194Z] X-Test-ID header: null
[2025-11-17T08:02:04.194Z] Will use test ID?: false
[2025-11-17T08:02:04.194Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:04.194Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.194Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:04.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.194Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.194Z] Identifier: unknown
[2025-11-17T08:02:04.194Z] Key: login:unknown
[2025-11-17T08:02:04.194Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T08:02:04.194Z] Existing timestamps: 1
[2025-11-17T08:02:04.194Z] Current count after filter: 1
[2025-11-17T08:02:04.194Z] Max requests allowed: 5
[2025-11-17T08:02:04.194Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.194Z] New count: 2
[2025-11-17T08:02:04.194Z] Remaining: 3
[2025-11-17T08:02:04.194Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.195Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:04.660Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.661Z] Request URL: /auth/login
[2025-11-17T08:02:04.661Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.661Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.661Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Will use test ID?: true
[2025-11-17T08:02:04.661Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.661Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.661Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.661Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] üìù Creating new entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.661Z] Current count after filter: 0
[2025-11-17T08:02:04.661Z] Max requests allowed: 5
[2025-11-17T08:02:04.661Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.661Z] New count: 1
[2025-11-17T08:02:04.661Z] Remaining: 4
[2025-11-17T08:02:04.661Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.662Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:04.758Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.758Z] Request URL: /auth/login
[2025-11-17T08:02:04.758Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.759Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.759Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Will use test ID?: true
[2025-11-17T08:02:04.759Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.759Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.759Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.759Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] üìù Creating new entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:04.759Z] Current count after filter: 0
[2025-11-17T08:02:04.759Z] Max requests allowed: 5
[2025-11-17T08:02:04.759Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.759Z] New count: 1
[2025-11-17T08:02:04.759Z] Remaining: 4
[2025-11-17T08:02:04.759Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.759Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:04.837Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.837Z] Request URL: /auth/login
[2025-11-17T08:02:04.837Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.837Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.837Z] X-Test-ID header: login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] Will use test ID?: true
[2025-11-17T08:02:04.837Z] ‚úÖ Using test identifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.837Z] Got identifier from getClientIdentifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.837Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.837Z] Identifier: test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] Key: login:test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] üìù Creating new entry for key: login:test:login-headers-1763366524527-14bv4t
[2025-11-17T08:02:04.838Z] Current count after filter: 0
[2025-11-17T08:02:04.838Z] Max requests allowed: 5
[2025-11-17T08:02:04.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.838Z] New count: 1
[2025-11-17T08:02:04.838Z] Remaining: 4
[2025-11-17T08:02:04.838Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.838Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366584837
}
[2025-11-17T08:02:04.907Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:04.907Z] Request URL: /auth/login
[2025-11-17T08:02:04.907Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:04.907Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:04.907Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:04.908Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:04.908Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Will use test ID?: true
[2025-11-17T08:02:04.908Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:04.908Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:04.908Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:04.908Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:04.908Z] Existing timestamps: 1
[2025-11-17T08:02:04.908Z] Current count after filter: 1
[2025-11-17T08:02:04.908Z] Max requests allowed: 5
[2025-11-17T08:02:04.908Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:04.908Z] New count: 2
[2025-11-17T08:02:04.908Z] Remaining: 3
[2025-11-17T08:02:04.908Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:04.908Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.063Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.063Z] Request URL: /auth/login
[2025-11-17T08:02:05.064Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.064Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.064Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Will use test ID?: true
[2025-11-17T08:02:05.064Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.064Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.064Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.064Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.064Z] Existing timestamps: 1
[2025-11-17T08:02:05.064Z] Current count after filter: 1
[2025-11-17T08:02:05.064Z] Max requests allowed: 5
[2025-11-17T08:02:05.064Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.065Z] New count: 2
[2025-11-17T08:02:05.065Z] Remaining: 3
[2025-11-17T08:02:05.065Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.065Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.120Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.120Z] Request URL: /auth/login
[2025-11-17T08:02:05.120Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.120Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.120Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] Will use test ID?: true
[2025-11-17T08:02:05.120Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.120Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.120Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.121Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.121Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.121Z] Existing timestamps: 2
[2025-11-17T08:02:05.121Z] Current count after filter: 2
[2025-11-17T08:02:05.121Z] Max requests allowed: 5
[2025-11-17T08:02:05.121Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.121Z] New count: 3
[2025-11-17T08:02:05.121Z] Remaining: 2
[2025-11-17T08:02:05.121Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.121Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.175Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.175Z] Request URL: /auth/register
[2025-11-17T08:02:05.175Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.175Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.175Z] X-Test-ID header: register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Will use test ID?: true
[2025-11-17T08:02:05.175Z] ‚úÖ Using test identifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.175Z] Got identifier from getClientIdentifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.175Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.175Z] Identifier: test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Key: register:test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] üìù Creating new entry for key: register:test:register-headers-1763366525173-i42wok
[2025-11-17T08:02:05.175Z] Current count after filter: 0
[2025-11-17T08:02:05.175Z] Max requests allowed: 3
[2025-11-17T08:02:05.175Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.175Z] New count: 1
[2025-11-17T08:02:05.176Z] Remaining: 2
[2025-11-17T08:02:05.176Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.176Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585175
}
[2025-11-17T08:02:05.272Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.272Z] Request URL: /auth/register
[2025-11-17T08:02:05.273Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.273Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.273Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Will use test ID?: true
[2025-11-17T08:02:05.273Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.273Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.273Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.273Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] üìù Creating new entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.273Z] Current count after filter: 0
[2025-11-17T08:02:05.273Z] Max requests allowed: 3
[2025-11-17T08:02:05.273Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.274Z] New count: 1
[2025-11-17T08:02:05.274Z] Remaining: 2
[2025-11-17T08:02:05.274Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.274Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:05.330Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.330Z] Request URL: /auth/login
[2025-11-17T08:02:05.330Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.330Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.330Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Will use test ID?: true
[2025-11-17T08:02:05.330Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.330Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.330Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.330Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.330Z] Existing timestamps: 2
[2025-11-17T08:02:05.330Z] Current count after filter: 2
[2025-11-17T08:02:05.330Z] Max requests allowed: 5
[2025-11-17T08:02:05.330Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.330Z] New count: 3
[2025-11-17T08:02:05.330Z] Remaining: 2
[2025-11-17T08:02:05.330Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.330Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.346Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.346Z] Request URL: /auth/login
[2025-11-17T08:02:05.346Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.346Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.346Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.346Z] Will use test ID?: true
[2025-11-17T08:02:05.346Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.347Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.347Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.347Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.347Z] Existing timestamps: 3
[2025-11-17T08:02:05.347Z] Current count after filter: 3
[2025-11-17T08:02:05.347Z] Max requests allowed: 5
[2025-11-17T08:02:05.347Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.347Z] New count: 4
[2025-11-17T08:02:05.347Z] Remaining: 1
[2025-11-17T08:02:05.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.347Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.443Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.443Z] Request URL: /auth/verify-email
[2025-11-17T08:02:05.443Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.443Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.444Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.444Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.444Z] X-Test-ID header: null
[2025-11-17T08:02:05.444Z] Will use test ID?: false
[2025-11-17T08:02:05.444Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:05.444Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.444Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:05.444Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.444Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.444Z] Identifier: unknown
[2025-11-17T08:02:05.444Z] Key: login:unknown
[2025-11-17T08:02:05.444Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T08:02:05.444Z] Existing timestamps: 2
[2025-11-17T08:02:05.444Z] Current count after filter: 2
[2025-11-17T08:02:05.444Z] Max requests allowed: 5
[2025-11-17T08:02:05.444Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.444Z] New count: 3
[2025-11-17T08:02:05.444Z] Remaining: 2
[2025-11-17T08:02:05.444Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.444Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366584078
}
[2025-11-17T08:02:05.545Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.545Z] Request URL: /auth/login
[2025-11-17T08:02:05.546Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.546Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.546Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Will use test ID?: true
[2025-11-17T08:02:05.546Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.546Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.546Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.546Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] üìù Creating new entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.546Z] Current count after filter: 0
[2025-11-17T08:02:05.546Z] Max requests allowed: 5
[2025-11-17T08:02:05.546Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.546Z] New count: 1
[2025-11-17T08:02:05.546Z] Remaining: 4
[2025-11-17T08:02:05.546Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.546Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:05.580Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.580Z] Request URL: /auth/login
[2025-11-17T08:02:05.580Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.580Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.580Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Will use test ID?: true
[2025-11-17T08:02:05.581Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.581Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.581Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.581Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.581Z] Existing timestamps: 4
[2025-11-17T08:02:05.581Z] Current count after filter: 4
[2025-11-17T08:02:05.581Z] Max requests allowed: 5
[2025-11-17T08:02:05.581Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.581Z] New count: 5
[2025-11-17T08:02:05.581Z] Remaining: 0
[2025-11-17T08:02:05.581Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.581Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366584661
}
[2025-11-17T08:02:05.596Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.596Z] Request URL: /auth/login
[2025-11-17T08:02:05.596Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.596Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.597Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Will use test ID?: true
[2025-11-17T08:02:05.597Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.597Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.597Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.597Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.597Z] Existing timestamps: 3
[2025-11-17T08:02:05.597Z] Current count after filter: 3
[2025-11-17T08:02:05.597Z] Max requests allowed: 5
[2025-11-17T08:02:05.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.597Z] New count: 4
[2025-11-17T08:02:05.597Z] Remaining: 1
[2025-11-17T08:02:05.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.597Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:05.793Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.793Z] Request URL: /auth/login
[2025-11-17T08:02:05.793Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.793Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.793Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.794Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.794Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Will use test ID?: true
[2025-11-17T08:02:05.794Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.794Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.794Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.794Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:05.794Z] Existing timestamps: 1
[2025-11-17T08:02:05.794Z] Current count after filter: 1
[2025-11-17T08:02:05.794Z] Max requests allowed: 5
[2025-11-17T08:02:05.794Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.794Z] New count: 2
[2025-11-17T08:02:05.794Z] Remaining: 3
[2025-11-17T08:02:05.794Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.794Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:05.795Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.795Z] Request URL: /auth/login
[2025-11-17T08:02:05.795Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.795Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.796Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.796Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.796Z] X-Test-ID header: login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Will use test ID?: true
[2025-11-17T08:02:05.796Z] ‚úÖ Using test identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.796Z] Got identifier from getClientIdentifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.796Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.796Z] Identifier: test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] üìñ Found existing entry for key: login:test:login-retry-after-1763366524655-4hag5r
[2025-11-17T08:02:05.796Z] Existing timestamps: 5
[2025-11-17T08:02:05.796Z] Current count after filter: 5
[2025-11-17T08:02:05.796Z] Max requests allowed: 5
[2025-11-17T08:02:05.796Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:05.796Z] Current count: 5
[2025-11-17T08:02:05.796Z] Max allowed: 5
[2025-11-17T08:02:05.796Z] Retry after (seconds): 59
[2025-11-17T08:02:05.796Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:05.796Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366584661,
  "retryAfter": 59
}
[2025-11-17T08:02:05.805Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.805Z] Request URL: /auth/login
[2025-11-17T08:02:05.805Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.805Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.805Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.805Z] Will use test ID?: true
[2025-11-17T08:02:05.806Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.806Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.806Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.806Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] üìù Creating new entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:05.806Z] Current count after filter: 0
[2025-11-17T08:02:05.806Z] Max requests allowed: 5
[2025-11-17T08:02:05.806Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.806Z] New count: 1
[2025-11-17T08:02:05.806Z] Remaining: 4
[2025-11-17T08:02:05.806Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.806Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:05.967Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:05.967Z] Request URL: /auth/register
[2025-11-17T08:02:05.967Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.967Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.967Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Will use test ID?: true
[2025-11-17T08:02:05.967Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.967Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.967Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:05.967Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:05.967Z] Existing timestamps: 1
[2025-11-17T08:02:05.968Z] Current count after filter: 1
[2025-11-17T08:02:05.968Z] Max requests allowed: 3
[2025-11-17T08:02:05.968Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.968Z] New count: 2
[2025-11-17T08:02:05.968Z] Remaining: 1
[2025-11-17T08:02:05.968Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.968Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:05.971Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:05.971Z] Request URL: /auth/login
[2025-11-17T08:02:05.971Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:05.971Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:05.971Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] Will use test ID?: true
[2025-11-17T08:02:05.971Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:05.971Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.971Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:05.971Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:05.972Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:05.972Z] Existing timestamps: 4
[2025-11-17T08:02:05.972Z] Current count after filter: 4
[2025-11-17T08:02:05.972Z] Max requests allowed: 5
[2025-11-17T08:02:05.972Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:05.972Z] New count: 5
[2025-11-17T08:02:05.972Z] Remaining: 0
[2025-11-17T08:02:05.972Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:05.972Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366584759
}
[2025-11-17T08:02:06.022Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.022Z] Request URL: /auth/login
[2025-11-17T08:02:06.022Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.022Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.022Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Will use test ID?: true
[2025-11-17T08:02:06.022Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.022Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.022Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.022Z] Existing timestamps: 2
[2025-11-17T08:02:06.022Z] Current count after filter: 2
[2025-11-17T08:02:06.022Z] Max requests allowed: 5
[2025-11-17T08:02:06.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.023Z] New count: 3
[2025-11-17T08:02:06.023Z] Remaining: 2
[2025-11-17T08:02:06.023Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.023Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.074Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.074Z] Request URL: /auth/login
[2025-11-17T08:02:06.074Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.074Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.074Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Will use test ID?: true
[2025-11-17T08:02:06.075Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.075Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.075Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.075Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] üìñ Found existing entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.075Z] Existing timestamps: 1
[2025-11-17T08:02:06.075Z] Current count after filter: 1
[2025-11-17T08:02:06.075Z] Max requests allowed: 5
[2025-11-17T08:02:06.075Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.075Z] New count: 2
[2025-11-17T08:02:06.075Z] Remaining: 3
[2025-11-17T08:02:06.075Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.075Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:06.229Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.230Z] Request URL: /auth/login
[2025-11-17T08:02:06.230Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.230Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.230Z] X-Test-ID header: login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Will use test ID?: true
[2025-11-17T08:02:06.230Z] ‚úÖ Using test identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.230Z] Got identifier from getClientIdentifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.230Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.230Z] Identifier: test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] üìñ Found existing entry for key: login:test:login-excessive-1763366524449-qqtgd5
[2025-11-17T08:02:06.230Z] Existing timestamps: 5
[2025-11-17T08:02:06.230Z] Current count after filter: 5
[2025-11-17T08:02:06.230Z] Max requests allowed: 5
[2025-11-17T08:02:06.230Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.230Z] Current count: 5
[2025-11-17T08:02:06.230Z] Max allowed: 5
[2025-11-17T08:02:06.230Z] Retry after (seconds): 59
[2025-11-17T08:02:06.230Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.230Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366584759,
  "retryAfter": 59
}
[2025-11-17T08:02:06.240Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.240Z] Request URL: /auth/login
[2025-11-17T08:02:06.240Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.240Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.240Z] X-Test-ID header: headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Will use test ID?: true
[2025-11-17T08:02:06.240Z] ‚úÖ Using test identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.240Z] Got identifier from getClientIdentifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.240Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.240Z] Identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] üìù Creating new entry for key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.240Z] Current count after filter: 0
[2025-11-17T08:02:06.240Z] Max requests allowed: 5
[2025-11-17T08:02:06.240Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.240Z] New count: 1
[2025-11-17T08:02:06.240Z] Remaining: 4
[2025-11-17T08:02:06.240Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.240Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366586240
}
[2025-11-17T08:02:06.255Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.255Z] Request URL: /auth/login
[2025-11-17T08:02:06.255Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.255Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.255Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.256Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.256Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Will use test ID?: true
[2025-11-17T08:02:06.256Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.256Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.256Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.256Z] Existing timestamps: 3
[2025-11-17T08:02:06.256Z] Current count after filter: 3
[2025-11-17T08:02:06.256Z] Max requests allowed: 5
[2025-11-17T08:02:06.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.256Z] New count: 4
[2025-11-17T08:02:06.256Z] Remaining: 1
[2025-11-17T08:02:06.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.256Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.301Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.301Z] Request URL: /auth/login
[2025-11-17T08:02:06.301Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.301Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.301Z] X-Test-ID header: headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Will use test ID?: true
[2025-11-17T08:02:06.301Z] ‚úÖ Using test identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.301Z] Got identifier from getClientIdentifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.301Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.301Z] Identifier: test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] üìñ Found existing entry for key: login:test:headers-remaining-1763366525804-c8oqc4
[2025-11-17T08:02:06.301Z] Existing timestamps: 2
[2025-11-17T08:02:06.301Z] Current count after filter: 2
[2025-11-17T08:02:06.301Z] Max requests allowed: 5
[2025-11-17T08:02:06.301Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.301Z] New count: 3
[2025-11-17T08:02:06.301Z] Remaining: 2
[2025-11-17T08:02:06.301Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.301Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366585806
}
[2025-11-17T08:02:06.391Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.392Z] Request URL: /auth/register
[2025-11-17T08:02:06.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.392Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.392Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Will use test ID?: true
[2025-11-17T08:02:06.392Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.392Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.392Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.392Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.392Z] Existing timestamps: 2
[2025-11-17T08:02:06.392Z] Current count after filter: 2
[2025-11-17T08:02:06.392Z] Max requests allowed: 3
[2025-11-17T08:02:06.392Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.392Z] New count: 3
[2025-11-17T08:02:06.392Z] Remaining: 0
[2025-11-17T08:02:06.392Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.392Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366585273
}
[2025-11-17T08:02:06.456Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.456Z] Request URL: /auth/login
[2025-11-17T08:02:06.456Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.456Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.456Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.457Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.457Z] X-Test-ID header: headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Will use test ID?: true
[2025-11-17T08:02:06.457Z] ‚úÖ Using test identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.457Z] Got identifier from getClientIdentifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.457Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.457Z] Identifier: test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] üìñ Found existing entry for key: login:test:headers-consistent-1763366526238-ld8c1
[2025-11-17T08:02:06.457Z] Existing timestamps: 1
[2025-11-17T08:02:06.457Z] Current count after filter: 1
[2025-11-17T08:02:06.457Z] Max requests allowed: 5
[2025-11-17T08:02:06.457Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.457Z] New count: 2
[2025-11-17T08:02:06.458Z] Remaining: 3
[2025-11-17T08:02:06.458Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.458Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366586240
}
[2025-11-17T08:02:06.470Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.471Z] Request URL: /auth/login
[2025-11-17T08:02:06.471Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.471Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.471Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Will use test ID?: true
[2025-11-17T08:02:06.471Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.471Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.471Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.471Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.471Z] Existing timestamps: 4
[2025-11-17T08:02:06.471Z] Current count after filter: 4
[2025-11-17T08:02:06.471Z] Max requests allowed: 5
[2025-11-17T08:02:06.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.471Z] New count: 5
[2025-11-17T08:02:06.471Z] Remaining: 0
[2025-11-17T08:02:06.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.471Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366585546
}
[2025-11-17T08:02:06.553Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.553Z] Request URL: /auth/login
[2025-11-17T08:02:06.553Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.553Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.553Z] X-Test-ID header: perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Will use test ID?: true
[2025-11-17T08:02:06.553Z] ‚úÖ Using test identifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.553Z] Got identifier from getClientIdentifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.553Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.553Z] Identifier: test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Key: login:test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] üìù Creating new entry for key: login:test:perf-test-1763366526551-bjcohv
[2025-11-17T08:02:06.553Z] Current count after filter: 0
[2025-11-17T08:02:06.553Z] Max requests allowed: 5
[2025-11-17T08:02:06.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.553Z] New count: 1
[2025-11-17T08:02:06.553Z] Remaining: 4
[2025-11-17T08:02:06.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.553Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366586553
}
[2025-11-17T08:02:06.702Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:06.702Z] Request URL: /auth/login
[2025-11-17T08:02:06.702Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.702Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.702Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.702Z] Will use test ID?: true
[2025-11-17T08:02:06.703Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.703Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.703Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:06.703Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] Key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.703Z] Existing timestamps: 5
[2025-11-17T08:02:06.703Z] Current count after filter: 5
[2025-11-17T08:02:06.703Z] Max requests allowed: 5
[2025-11-17T08:02:06.703Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.703Z] Current count: 5
[2025-11-17T08:02:06.703Z] Max allowed: 5
[2025-11-17T08:02:06.703Z] Retry after (seconds): 59
[2025-11-17T08:02:06.703Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.703Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366585546,
  "retryAfter": 59
}
[2025-11-17T08:02:06.705Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.705Z] Request URL: /auth/register
[2025-11-17T08:02:06.705Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.705Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.705Z] X-Test-ID header: independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Will use test ID?: true
[2025-11-17T08:02:06.705Z] ‚úÖ Using test identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.705Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.705Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.705Z] Identifier: test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Key: register:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] üìù Creating new entry for key: register:test:independent-endpoints-1763366525544-tkq8s3
[2025-11-17T08:02:06.705Z] Current count after filter: 0
[2025-11-17T08:02:06.705Z] Max requests allowed: 3
[2025-11-17T08:02:06.705Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:06.705Z] New count: 1
[2025-11-17T08:02:06.705Z] Remaining: 2
[2025-11-17T08:02:06.705Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:06.705Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366586705
}
[2025-11-17T08:02:06.729Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:06.730Z] Request URL: /auth/register
[2025-11-17T08:02:06.730Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:06.730Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:06.730Z] X-Test-ID header: register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Will use test ID?: true
[2025-11-17T08:02:06.730Z] ‚úÖ Using test identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:06.730Z] Got identifier from getClientIdentifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:06.730Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:06.730Z] Identifier: test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] üìñ Found existing entry for key: register:test:register-excessive-1763366524961-4xeadd
[2025-11-17T08:02:06.730Z] Existing timestamps: 3
[2025-11-17T08:02:06.730Z] Current count after filter: 3
[2025-11-17T08:02:06.730Z] Max requests allowed: 3
[2025-11-17T08:02:06.730Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-17T08:02:06.730Z] Current count: 3
[2025-11-17T08:02:06.730Z] Max allowed: 3
[2025-11-17T08:02:06.730Z] Retry after (seconds): 59
[2025-11-17T08:02:06.730Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-17T08:02:06.730Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763366585273,
  "retryAfter": 59
}
[2025-11-17T08:02:10.622Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T08:02:10.622Z] Request URL: /auth/register
[2025-11-17T08:02:10.623Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:10.623Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:10.623Z] X-Test-ID header: null
[2025-11-17T08:02:10.626Z] Will use test ID?: false
[2025-11-17T08:02:10.627Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T08:02:10.627Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:10.627Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T08:02:10.627Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:10.627Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T08:02:10.627Z] Identifier: unknown
[2025-11-17T08:02:10.627Z] Key: register:unknown
[2025-11-17T08:02:10.627Z] üìñ Found existing entry for key: register:unknown
[2025-11-17T08:02:10.627Z] Existing timestamps: 1
[2025-11-17T08:02:10.627Z] Current count after filter: 1
[2025-11-17T08:02:10.627Z] Max requests allowed: 3
[2025-11-17T08:02:10.627Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:10.627Z] New count: 2
[2025-11-17T08:02:10.627Z] Remaining: 1
[2025-11-17T08:02:10.627Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:10.627Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366584115
}
[2025-11-17T08:02:10.992Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:10.992Z] Request URL: /auth/verify-email
[2025-11-17T08:02:10.992Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:10.992Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:10.992Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] Will use test ID?: true
[2025-11-17T08:02:10.992Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:10.992Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.992Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:10.992Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:10.993Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] üìù Creating new entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:10.993Z] Current count after filter: 0
[2025-11-17T08:02:10.993Z] Max requests allowed: 5
[2025-11-17T08:02:10.993Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:10.993Z] New count: 1
[2025-11-17T08:02:10.993Z] Remaining: 4
[2025-11-17T08:02:10.993Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:10.993Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.279Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.279Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.279Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.279Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.279Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Will use test ID?: true
[2025-11-17T08:02:11.279Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.279Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.279Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.279Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.279Z] Existing timestamps: 1
[2025-11-17T08:02:11.279Z] Current count after filter: 1
[2025-11-17T08:02:11.279Z] Max requests allowed: 5
[2025-11-17T08:02:11.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.279Z] New count: 2
[2025-11-17T08:02:11.279Z] Remaining: 3
[2025-11-17T08:02:11.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.280Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.578Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.579Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.579Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.579Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.579Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] Will use test ID?: true
[2025-11-17T08:02:11.579Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.579Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.579Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.579Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.579Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.580Z] Existing timestamps: 2
[2025-11-17T08:02:11.580Z] Current count after filter: 2
[2025-11-17T08:02:11.580Z] Max requests allowed: 5
[2025-11-17T08:02:11.580Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.580Z] New count: 3
[2025-11-17T08:02:11.580Z] Remaining: 2
[2025-11-17T08:02:11.580Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.580Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:11.859Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:11.859Z] Request URL: /auth/verify-email
[2025-11-17T08:02:11.859Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:11.859Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:11.859Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:11.859Z] Will use test ID?: true
[2025-11-17T08:02:11.859Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.859Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:11.859Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:11.860Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:11.860Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:11.860Z] Existing timestamps: 3
[2025-11-17T08:02:11.860Z] Current count after filter: 3
[2025-11-17T08:02:11.860Z] Max requests allowed: 5
[2025-11-17T08:02:11.860Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:11.860Z] New count: 4
[2025-11-17T08:02:11.860Z] Remaining: 1
[2025-11-17T08:02:11.860Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:11.860Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763366590992
}
[2025-11-17T08:02:12.144Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T08:02:12.144Z] Request URL: /auth/verify-email
[2025-11-17T08:02:12.145Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (process.env): true
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (env): true
[2025-11-17T08:02:12.145Z] E2E_TEST_MODE (final): true
[2025-11-17T08:02:12.145Z] X-Test-ID header: rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Will use test ID?: true
[2025-11-17T08:02:12.145Z] ‚úÖ Using test identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T08:02:12.145Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T08:02:12.145Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T08:02:12.145Z] Identifier: test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763366529383
[2025-11-17T08:02:12.145Z] Existing timestamps: 4
[2025-11-17T08:02:12.145Z] Current count after filter: 4
[2025-11-17T08:02:12.145Z] Max requests allowed: 5
[2025-11-17T08:02:12.145Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T08:02:12.145Z] New count: 5
[2025-11-17T08:02:12.146Z] Remaining: 0
[2025-11-17T08:02:12.146Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T08:02:12.146Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763366590992
}
[2025-11-17T12:19:16.398Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-17T12:19:16.399Z] Request URL: /auth/token
[2025-11-17T12:19:16.399Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:16.399Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:16.399Z] X-Test-ID header: null
[2025-11-17T12:19:16.399Z] Will use test ID?: false
[2025-11-17T12:19:16.399Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:16.400Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:16.400Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:16.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:16.400Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-17T12:19:16.400Z] Identifier: unknown
[2025-11-17T12:19:16.400Z] Key: token:unknown
[2025-11-17T12:19:16.400Z] üìù Creating new entry for key: token:unknown
[2025-11-17T12:19:16.400Z] Current count after filter: 0
[2025-11-17T12:19:16.400Z] Max requests allowed: 60
[2025-11-17T12:19:16.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:16.400Z] New count: 1
[2025-11-17T12:19:16.400Z] Remaining: 59
[2025-11-17T12:19:16.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:16.400Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763382016400
}
[2025-11-17T12:19:16.988Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-17T12:19:16.988Z] Request URL: /auth/register
[2025-11-17T12:19:16.988Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:16.988Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:16.988Z] X-Test-ID header: null
[2025-11-17T12:19:16.988Z] Will use test ID?: false
[2025-11-17T12:19:16.988Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:16.989Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:16.989Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:16.989Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:16.989Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-17T12:19:16.989Z] Identifier: unknown
[2025-11-17T12:19:16.989Z] Key: register:unknown
[2025-11-17T12:19:16.989Z] üìù Creating new entry for key: register:unknown
[2025-11-17T12:19:16.989Z] Current count after filter: 0
[2025-11-17T12:19:16.989Z] Max requests allowed: 3
[2025-11-17T12:19:16.989Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:16.989Z] New count: 1
[2025-11-17T12:19:16.989Z] Remaining: 2
[2025-11-17T12:19:16.989Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:16.989Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763382016989
}
[2025-11-17T12:19:17.143Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-17T12:19:17.143Z] Request URL: /auth/token
[2025-11-17T12:19:17.143Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.143Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.143Z] X-Test-ID header: null
[2025-11-17T12:19:17.143Z] Will use test ID?: false
[2025-11-17T12:19:17.143Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.143Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.143Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.144Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.144Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-17T12:19:17.144Z] Identifier: unknown
[2025-11-17T12:19:17.144Z] Key: token:unknown
[2025-11-17T12:19:17.144Z] üìñ Found existing entry for key: token:unknown
[2025-11-17T12:19:17.144Z] Existing timestamps: 1
[2025-11-17T12:19:17.144Z] Current count after filter: 1
[2025-11-17T12:19:17.144Z] Max requests allowed: 60
[2025-11-17T12:19:17.144Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.144Z] New count: 2
[2025-11-17T12:19:17.144Z] Remaining: 58
[2025-11-17T12:19:17.144Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.144Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763382016400
}
[2025-11-17T12:19:17.241Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:17.241Z] Request URL: /auth/forgot-password
[2025-11-17T12:19:17.241Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.241Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.241Z] X-Test-ID header: null
[2025-11-17T12:19:17.241Z] Will use test ID?: false
[2025-11-17T12:19:17.242Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.242Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.242Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.242Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.242Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:17.242Z] Identifier: unknown
[2025-11-17T12:19:17.242Z] Key: login:unknown
[2025-11-17T12:19:17.242Z] üìù Creating new entry for key: login:unknown
[2025-11-17T12:19:17.242Z] Current count after filter: 0
[2025-11-17T12:19:17.242Z] Max requests allowed: 5
[2025-11-17T12:19:17.242Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.242Z] New count: 1
[2025-11-17T12:19:17.242Z] Remaining: 4
[2025-11-17T12:19:17.242Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.242Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763382017242
}
[2025-11-17T12:19:17.361Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:17.364Z] Request URL: /auth/reset-password
[2025-11-17T12:19:17.369Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:17.378Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:17.382Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:17.393Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:17.394Z] X-Test-ID header: null
[2025-11-17T12:19:17.407Z] Will use test ID?: false
[2025-11-17T12:19:17.413Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:17.418Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:17.421Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:17.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:17.421Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:17.422Z] Identifier: unknown
[2025-11-17T12:19:17.422Z] Key: login:unknown
[2025-11-17T12:19:17.422Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T12:19:17.422Z] Existing timestamps: 1
[2025-11-17T12:19:17.422Z] Current count after filter: 1
[2025-11-17T12:19:17.422Z] Max requests allowed: 5
[2025-11-17T12:19:17.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:17.423Z] New count: 2
[2025-11-17T12:19:17.423Z] Remaining: 3
[2025-11-17T12:19:17.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:17.423Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763382017242
}
[2025-11-17T12:19:18.325Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-17T12:19:18.325Z] Request URL: /auth/verify-email
[2025-11-17T12:19:18.325Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (process.env): true
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (env): true
[2025-11-17T12:19:18.325Z] E2E_TEST_MODE (final): true
[2025-11-17T12:19:18.325Z] X-Test-ID header: null
[2025-11-17T12:19:18.325Z] Will use test ID?: false
[2025-11-17T12:19:18.325Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-17T12:19:18.325Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-17T12:19:18.325Z] Got identifier from getClientIdentifier: unknown
[2025-11-17T12:19:18.325Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-17T12:19:18.325Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-17T12:19:18.325Z] Identifier: unknown
[2025-11-17T12:19:18.325Z] Key: login:unknown
[2025-11-17T12:19:18.325Z] üìñ Found existing entry for key: login:unknown
[2025-11-17T12:19:18.325Z] Existing timestamps: 2
[2025-11-17T12:19:18.325Z] Current count after filter: 2
[2025-11-17T12:19:18.325Z] Max requests allowed: 5
[2025-11-17T12:19:18.325Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-17T12:19:18.325Z] New count: 3
[2025-11-17T12:19:18.325Z] Remaining: 2
[2025-11-17T12:19:18.325Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-17T12:19:18.326Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763382017242
}
[2025-11-19T08:01:31.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.593Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.594Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.594Z] üìù Creating new entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.594Z] Current count after filter: 0
[2025-11-19T08:01:31.594Z] Max requests allowed: 5
[2025-11-19T08:01:31.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.598Z] New count: 1
[2025-11-19T08:01:31.598Z] Remaining: 4
[2025-11-19T08:01:31.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.602Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.602Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.602Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.602Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.602Z] Existing timestamps: 1
[2025-11-19T08:01:31.602Z] Current count after filter: 1
[2025-11-19T08:01:31.607Z] Max requests allowed: 5
[2025-11-19T08:01:31.607Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.607Z] New count: 2
[2025-11-19T08:01:31.607Z] Remaining: 3
[2025-11-19T08:01:31.607Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.607Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.607Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.607Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.607Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.607Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.607Z] Existing timestamps: 2
[2025-11-19T08:01:31.607Z] Current count after filter: 2
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 3
[2025-11-19T08:01:31.608Z] Remaining: 2
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.608Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Existing timestamps: 3
[2025-11-19T08:01:31.608Z] Current count after filter: 3
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 4
[2025-11-19T08:01:31.608Z] Remaining: 1
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.608Z] Identifier: test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] üìñ Found existing entry for key: login:test-allow-1763539291587
[2025-11-19T08:01:31.608Z] Existing timestamps: 4
[2025-11-19T08:01:31.608Z] Current count after filter: 4
[2025-11-19T08:01:31.608Z] Max requests allowed: 5
[2025-11-19T08:01:31.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.608Z] New count: 5
[2025-11-19T08:01:31.608Z] Remaining: 0
[2025-11-19T08:01:31.608Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.609Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.609Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.609Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.609Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.609Z] üìù Creating new entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.609Z] Current count after filter: 0
[2025-11-19T08:01:31.609Z] Max requests allowed: 5
[2025-11-19T08:01:31.610Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.610Z] New count: 1
[2025-11-19T08:01:31.610Z] Remaining: 4
[2025-11-19T08:01:31.610Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.610Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.610Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.610Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.610Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] Existing timestamps: 1
[2025-11-19T08:01:31.611Z] Current count after filter: 1
[2025-11-19T08:01:31.611Z] Max requests allowed: 5
[2025-11-19T08:01:31.611Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.611Z] New count: 2
[2025-11-19T08:01:31.611Z] Remaining: 3
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.611Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.611Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.611Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.611Z] Existing timestamps: 2
[2025-11-19T08:01:31.611Z] Current count after filter: 2
[2025-11-19T08:01:31.611Z] Max requests allowed: 5
[2025-11-19T08:01:31.611Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.611Z] New count: 3
[2025-11-19T08:01:31.611Z] Remaining: 2
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.611Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.611Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 3
[2025-11-19T08:01:31.612Z] Current count after filter: 3
[2025-11-19T08:01:31.612Z] Max requests allowed: 5
[2025-11-19T08:01:31.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.612Z] New count: 4
[2025-11-19T08:01:31.612Z] Remaining: 1
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 4
[2025-11-19T08:01:31.612Z] Current count after filter: 4
[2025-11-19T08:01:31.612Z] Max requests allowed: 5
[2025-11-19T08:01:31.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.612Z] New count: 5
[2025-11-19T08:01:31.612Z] Remaining: 0
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.612Z] Identifier: test-block-1763539291609
[2025-11-19T08:01:31.612Z] Key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] üìñ Found existing entry for key: login:test-block-1763539291609
[2025-11-19T08:01:31.612Z] Existing timestamps: 5
[2025-11-19T08:01:31.613Z] Current count after filter: 5
[2025-11-19T08:01:31.613Z] Max requests allowed: 5
[2025-11-19T08:01:31.613Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.613Z] Current count: 5
[2025-11-19T08:01:31.613Z] Max allowed: 5
[2025-11-19T08:01:31.613Z] Retry after (seconds): 60
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.613Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.613Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.613Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.613Z] üìù Creating new entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.613Z] Current count after filter: 0
[2025-11-19T08:01:31.613Z] Max requests allowed: 2
[2025-11-19T08:01:31.613Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.613Z] New count: 1
[2025-11-19T08:01:31.613Z] Remaining: 1
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.613Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.613Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.614Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Existing timestamps: 1
[2025-11-19T08:01:31.614Z] Current count after filter: 1
[2025-11-19T08:01:31.614Z] Max requests allowed: 2
[2025-11-19T08:01:31.614Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.614Z] New count: 2
[2025-11-19T08:01:31.614Z] Remaining: 0
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.614Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.614Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.614Z] Existing timestamps: 2
[2025-11-19T08:01:31.614Z] Current count after filter: 2
[2025-11-19T08:01:31.614Z] Max requests allowed: 2
[2025-11-19T08:01:31.614Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.614Z] Current count: 2
[2025-11-19T08:01:31.614Z] Max allowed: 2
[2025-11-19T08:01:31.614Z] Retry after (seconds): 1
[2025-11-19T08:01:31.614Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.766Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:01:31.766Z] Identifier: test-reset-1763539291613
[2025-11-19T08:01:31.766Z] Key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.766Z] üìñ Found existing entry for key: test-reset:test-reset-1763539291613
[2025-11-19T08:01:31.766Z] Existing timestamps: 2
[2025-11-19T08:01:31.766Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:01:31.766Z] Current count after filter: 0
[2025-11-19T08:01:31.767Z] Max requests allowed: 2
[2025-11-19T08:01:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.767Z] New count: 1
[2025-11-19T08:01:31.767Z] Remaining: 1
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.767Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] üìù Creating new entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Current count after filter: 0
[2025-11-19T08:01:31.767Z] Max requests allowed: 5
[2025-11-19T08:01:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.767Z] New count: 1
[2025-11-19T08:01:31.767Z] Remaining: 4
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.767Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.767Z] Existing timestamps: 1
[2025-11-19T08:01:31.768Z] Current count after filter: 1
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 2
[2025-11-19T08:01:31.768Z] Remaining: 3
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Existing timestamps: 2
[2025-11-19T08:01:31.768Z] Current count after filter: 2
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 3
[2025-11-19T08:01:31.768Z] Remaining: 2
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.768Z] Existing timestamps: 3
[2025-11-19T08:01:31.768Z] Current count after filter: 3
[2025-11-19T08:01:31.768Z] Max requests allowed: 5
[2025-11-19T08:01:31.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.768Z] New count: 4
[2025-11-19T08:01:31.768Z] Remaining: 1
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.768Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Existing timestamps: 4
[2025-11-19T08:01:31.769Z] Current count after filter: 4
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.769Z] New count: 5
[2025-11-19T08:01:31.769Z] Remaining: 0
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.769Z] Identifier: test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] üìñ Found existing entry for key: login:test-multi-1-1763539291767
[2025-11-19T08:01:31.769Z] Existing timestamps: 5
[2025-11-19T08:01:31.769Z] Current count after filter: 5
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.769Z] Current count: 5
[2025-11-19T08:01:31.769Z] Max allowed: 5
[2025-11-19T08:01:31.769Z] Retry after (seconds): 60
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.769Z] Identifier: test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] Key: login:test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] üìù Creating new entry for key: login:test-multi-2-1763539291767
[2025-11-19T08:01:31.769Z] Current count after filter: 0
[2025-11-19T08:01:31.769Z] Max requests allowed: 5
[2025-11-19T08:01:31.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.769Z] New count: 1
[2025-11-19T08:01:31.769Z] Remaining: 4
[2025-11-19T08:01:31.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:01:31.770Z] Identifier: test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] Key: login:test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] üìù Creating new entry for key: login:test-reset-time-1763539291770
[2025-11-19T08:01:31.770Z] Current count after filter: 0
[2025-11-19T08:01:31.770Z] Max requests allowed: 5
[2025-11-19T08:01:31.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.770Z] New count: 1
[2025-11-19T08:01:31.770Z] Remaining: 4
[2025-11-19T08:01:31.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.771Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.771Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.771Z] X-Test-ID header: null
[2025-11-19T08:01:31.771Z] Will use test ID?: false
[2025-11-19T08:01:31.771Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.771Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.772Z] X-Test-ID header: null
[2025-11-19T08:01:31.772Z] Will use test ID?: false
[2025-11-19T08:01:31.772Z] Using real IP: 192.168.1.2
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.772Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.772Z] X-Test-ID header: null
[2025-11-19T08:01:31.772Z] Will use test ID?: false
[2025-11-19T08:01:31.772Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.772Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.773Z] X-Test-ID header: null
[2025-11-19T08:01:31.773Z] Will use test ID?: false
[2025-11-19T08:01:31.773Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (env): true
[2025-11-19T08:01:31.773Z] E2E_TEST_MODE (final): true
[2025-11-19T08:01:31.773Z] X-Test-ID header: null
[2025-11-19T08:01:31.773Z] Will use test ID?: false
[2025-11-19T08:01:31.773Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:01:31.773Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:01:31.773Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.773Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.774Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.774Z] Current count after filter: 0
[2025-11-19T08:01:31.774Z] Max requests allowed: 3
[2025-11-19T08:01:31.774Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.774Z] New count: 1
[2025-11-19T08:01:31.774Z] Remaining: 2
[2025-11-19T08:01:31.774Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.874Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.875Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.875Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.875Z] Existing timestamps: 1
[2025-11-19T08:01:31.875Z] Current count after filter: 1
[2025-11-19T08:01:31.875Z] Max requests allowed: 3
[2025-11-19T08:01:31.875Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.875Z] New count: 2
[2025-11-19T08:01:31.875Z] Remaining: 1
[2025-11-19T08:01:31.875Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.976Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:01:31.976Z] Identifier: test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] Key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539291773
[2025-11-19T08:01:31.976Z] Existing timestamps: 2
[2025-11-19T08:01:31.976Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:01:31.976Z] Current count after filter: 1
[2025-11-19T08:01:31.976Z] Max requests allowed: 3
[2025-11-19T08:01:31.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.976Z] New count: 2
[2025-11-19T08:01:31.976Z] Remaining: 1
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.976Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.976Z] Identifier: test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] Key: register:test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] üìù Creating new entry for key: register:test-format-allowed-1763539291976
[2025-11-19T08:01:31.977Z] Current count after filter: 0
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 1
[2025-11-19T08:01:31.977Z] Remaining: 2
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.977Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] üìù Creating new entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Current count after filter: 0
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 1
[2025-11-19T08:01:31.977Z] Remaining: 2
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.977Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.977Z] Existing timestamps: 1
[2025-11-19T08:01:31.977Z] Current count after filter: 1
[2025-11-19T08:01:31.977Z] Max requests allowed: 3
[2025-11-19T08:01:31.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.977Z] New count: 2
[2025-11-19T08:01:31.977Z] Remaining: 1
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.977Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.978Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Existing timestamps: 2
[2025-11-19T08:01:31.978Z] Current count after filter: 2
[2025-11-19T08:01:31.978Z] Max requests allowed: 3
[2025-11-19T08:01:31.978Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:01:31.978Z] New count: 3
[2025-11-19T08:01:31.978Z] Remaining: 0
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:01:31.978Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:01:31.978Z] Identifier: test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] üìñ Found existing entry for key: register:test-format-blocked-1763539291977
[2025-11-19T08:01:31.978Z] Existing timestamps: 3
[2025-11-19T08:01:31.978Z] Current count after filter: 3
[2025-11-19T08:01:31.978Z] Max requests allowed: 3
[2025-11-19T08:01:31.978Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:01:31.978Z] Current count: 3
[2025-11-19T08:01:31.978Z] Max allowed: 3
[2025-11-19T08:01:31.978Z] Retry after (seconds): 60
[2025-11-19T08:01:31.978Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.219Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.220Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.220Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.220Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.220Z] üìù Creating new entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.220Z] Current count after filter: 0
[2025-11-19T08:02:12.220Z] Max requests allowed: 5
[2025-11-19T08:02:12.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.221Z] New count: 1
[2025-11-19T08:02:12.221Z] Remaining: 4
[2025-11-19T08:02:12.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.222Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Existing timestamps: 1
[2025-11-19T08:02:12.222Z] Current count after filter: 1
[2025-11-19T08:02:12.222Z] Max requests allowed: 5
[2025-11-19T08:02:12.222Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.222Z] New count: 2
[2025-11-19T08:02:12.222Z] Remaining: 3
[2025-11-19T08:02:12.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.222Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.222Z] Existing timestamps: 2
[2025-11-19T08:02:12.222Z] Current count after filter: 2
[2025-11-19T08:02:12.222Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 3
[2025-11-19T08:02:12.223Z] Remaining: 2
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.223Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Existing timestamps: 3
[2025-11-19T08:02:12.223Z] Current count after filter: 3
[2025-11-19T08:02:12.223Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 4
[2025-11-19T08:02:12.223Z] Remaining: 1
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.223Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.223Z] Identifier: test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] üìñ Found existing entry for key: login:test-allow-1763539332219
[2025-11-19T08:02:12.223Z] Existing timestamps: 4
[2025-11-19T08:02:12.223Z] Current count after filter: 4
[2025-11-19T08:02:12.223Z] Max requests allowed: 5
[2025-11-19T08:02:12.223Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.223Z] New count: 5
[2025-11-19T08:02:12.223Z] Remaining: 0
[2025-11-19T08:02:12.223Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.224Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.224Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.224Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.224Z] üìù Creating new entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.224Z] Current count after filter: 0
[2025-11-19T08:02:12.224Z] Max requests allowed: 5
[2025-11-19T08:02:12.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.224Z] New count: 1
[2025-11-19T08:02:12.224Z] Remaining: 4
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.225Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.225Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] Existing timestamps: 1
[2025-11-19T08:02:12.225Z] Current count after filter: 1
[2025-11-19T08:02:12.225Z] Max requests allowed: 5
[2025-11-19T08:02:12.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.225Z] New count: 2
[2025-11-19T08:02:12.225Z] Remaining: 3
[2025-11-19T08:02:12.225Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.225Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.225Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.225Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.225Z] Existing timestamps: 2
[2025-11-19T08:02:12.225Z] Current count after filter: 2
[2025-11-19T08:02:12.225Z] Max requests allowed: 5
[2025-11-19T08:02:12.225Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.225Z] New count: 3
[2025-11-19T08:02:12.225Z] Remaining: 2
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.226Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.226Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] Existing timestamps: 3
[2025-11-19T08:02:12.226Z] Current count after filter: 3
[2025-11-19T08:02:12.226Z] Max requests allowed: 5
[2025-11-19T08:02:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.226Z] New count: 4
[2025-11-19T08:02:12.226Z] Remaining: 1
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.226Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.226Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.226Z] Existing timestamps: 4
[2025-11-19T08:02:12.226Z] Current count after filter: 4
[2025-11-19T08:02:12.226Z] Max requests allowed: 5
[2025-11-19T08:02:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.226Z] New count: 5
[2025-11-19T08:02:12.227Z] Remaining: 0
[2025-11-19T08:02:12.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.227Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.227Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.227Z] Identifier: test-block-1763539332224
[2025-11-19T08:02:12.227Z] Key: login:test-block-1763539332224
[2025-11-19T08:02:12.227Z] üìñ Found existing entry for key: login:test-block-1763539332224
[2025-11-19T08:02:12.227Z] Existing timestamps: 5
[2025-11-19T08:02:12.227Z] Current count after filter: 5
[2025-11-19T08:02:12.227Z] Max requests allowed: 5
[2025-11-19T08:02:12.227Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.227Z] Current count: 5
[2025-11-19T08:02:12.228Z] Max allowed: 5
[2025-11-19T08:02:12.228Z] Retry after (seconds): 60
[2025-11-19T08:02:12.228Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.229Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.229Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.229Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.229Z] üìù Creating new entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.229Z] Current count after filter: 0
[2025-11-19T08:02:12.229Z] Max requests allowed: 2
[2025-11-19T08:02:12.229Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.229Z] New count: 1
[2025-11-19T08:02:12.229Z] Remaining: 1
[2025-11-19T08:02:12.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.230Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.230Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Existing timestamps: 1
[2025-11-19T08:02:12.230Z] Current count after filter: 1
[2025-11-19T08:02:12.230Z] Max requests allowed: 2
[2025-11-19T08:02:12.230Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.230Z] New count: 2
[2025-11-19T08:02:12.230Z] Remaining: 0
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.230Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.230Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.230Z] Existing timestamps: 2
[2025-11-19T08:02:12.230Z] Current count after filter: 2
[2025-11-19T08:02:12.230Z] Max requests allowed: 2
[2025-11-19T08:02:12.230Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.230Z] Current count: 2
[2025-11-19T08:02:12.230Z] Max allowed: 2
[2025-11-19T08:02:12.230Z] Retry after (seconds): 1
[2025-11-19T08:02:12.230Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.382Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.382Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:12.382Z] Identifier: test-reset-1763539332229
[2025-11-19T08:02:12.382Z] Key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.382Z] üìñ Found existing entry for key: test-reset:test-reset-1763539332229
[2025-11-19T08:02:12.382Z] Existing timestamps: 2
[2025-11-19T08:02:12.382Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:02:12.382Z] Current count after filter: 0
[2025-11-19T08:02:12.382Z] Max requests allowed: 2
[2025-11-19T08:02:12.382Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.382Z] New count: 1
[2025-11-19T08:02:12.382Z] Remaining: 1
[2025-11-19T08:02:12.382Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.383Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] üìù Creating new entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.383Z] Current count after filter: 0
[2025-11-19T08:02:12.383Z] Max requests allowed: 5
[2025-11-19T08:02:12.383Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.383Z] New count: 1
[2025-11-19T08:02:12.383Z] Remaining: 4
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.384Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.384Z] Existing timestamps: 1
[2025-11-19T08:02:12.384Z] Current count after filter: 1
[2025-11-19T08:02:12.384Z] Max requests allowed: 5
[2025-11-19T08:02:12.384Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.384Z] New count: 2
[2025-11-19T08:02:12.384Z] Remaining: 3
[2025-11-19T08:02:12.384Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.384Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.384Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 2
[2025-11-19T08:02:12.385Z] Current count after filter: 2
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 3
[2025-11-19T08:02:12.385Z] Remaining: 2
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.385Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 3
[2025-11-19T08:02:12.385Z] Current count after filter: 3
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 4
[2025-11-19T08:02:12.385Z] Remaining: 1
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.385Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.385Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.385Z] Existing timestamps: 4
[2025-11-19T08:02:12.385Z] Current count after filter: 4
[2025-11-19T08:02:12.385Z] Max requests allowed: 5
[2025-11-19T08:02:12.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.385Z] New count: 5
[2025-11-19T08:02:12.386Z] Remaining: 0
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.386Z] Identifier: test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] Key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] üìñ Found existing entry for key: login:test-multi-1-1763539332383
[2025-11-19T08:02:12.386Z] Existing timestamps: 5
[2025-11-19T08:02:12.386Z] Current count after filter: 5
[2025-11-19T08:02:12.386Z] Max requests allowed: 5
[2025-11-19T08:02:12.386Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.386Z] Current count: 5
[2025-11-19T08:02:12.386Z] Max allowed: 5
[2025-11-19T08:02:12.386Z] Retry after (seconds): 60
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.386Z] Identifier: test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] Key: login:test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] üìù Creating new entry for key: login:test-multi-2-1763539332383
[2025-11-19T08:02:12.386Z] Current count after filter: 0
[2025-11-19T08:02:12.386Z] Max requests allowed: 5
[2025-11-19T08:02:12.386Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.386Z] New count: 1
[2025-11-19T08:02:12.386Z] Remaining: 4
[2025-11-19T08:02:12.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:12.387Z] Identifier: test-reset-time-1763539332387
[2025-11-19T08:02:12.387Z] Key: login:test-reset-time-1763539332387
[2025-11-19T08:02:12.388Z] üìù Creating new entry for key: login:test-reset-time-1763539332387
[2025-11-19T08:02:12.388Z] Current count after filter: 0
[2025-11-19T08:02:12.388Z] Max requests allowed: 5
[2025-11-19T08:02:12.388Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.388Z] New count: 1
[2025-11-19T08:02:12.388Z] Remaining: 4
[2025-11-19T08:02:12.388Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.389Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.390Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.390Z] X-Test-ID header: null
[2025-11-19T08:02:12.390Z] Will use test ID?: false
[2025-11-19T08:02:12.390Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.390Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.391Z] X-Test-ID header: null
[2025-11-19T08:02:12.391Z] Will use test ID?: false
[2025-11-19T08:02:12.391Z] Using real IP: 192.168.1.2
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.391Z] X-Test-ID header: null
[2025-11-19T08:02:12.392Z] Will use test ID?: false
[2025-11-19T08:02:12.392Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.392Z] X-Test-ID header: null
[2025-11-19T08:02:12.392Z] Will use test ID?: false
[2025-11-19T08:02:12.392Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:12.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:12.393Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:12.393Z] X-Test-ID header: null
[2025-11-19T08:02:12.393Z] Will use test ID?: false
[2025-11-19T08:02:12.393Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:12.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:12.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.393Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.393Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.393Z] Current count after filter: 0
[2025-11-19T08:02:12.393Z] Max requests allowed: 3
[2025-11-19T08:02:12.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.393Z] New count: 1
[2025-11-19T08:02:12.393Z] Remaining: 2
[2025-11-19T08:02:12.393Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.495Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.495Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.496Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.496Z] Existing timestamps: 1
[2025-11-19T08:02:12.496Z] Current count after filter: 1
[2025-11-19T08:02:12.496Z] Max requests allowed: 3
[2025-11-19T08:02:12.497Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.497Z] New count: 2
[2025-11-19T08:02:12.497Z] Remaining: 1
[2025-11-19T08:02:12.497Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.598Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:12.598Z] Identifier: test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] Key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539332393
[2025-11-19T08:02:12.598Z] Existing timestamps: 2
[2025-11-19T08:02:12.599Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:02:12.599Z] Current count after filter: 1
[2025-11-19T08:02:12.599Z] Max requests allowed: 3
[2025-11-19T08:02:12.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.599Z] New count: 2
[2025-11-19T08:02:12.599Z] Remaining: 1
[2025-11-19T08:02:12.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.599Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.599Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.599Z] Identifier: test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] Key: register:test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] üìù Creating new entry for key: register:test-format-allowed-1763539332599
[2025-11-19T08:02:12.599Z] Current count after filter: 0
[2025-11-19T08:02:12.599Z] Max requests allowed: 3
[2025-11-19T08:02:12.599Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.599Z] New count: 1
[2025-11-19T08:02:12.599Z] Remaining: 2
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìù Creating new entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Current count after filter: 0
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.600Z] New count: 1
[2025-11-19T08:02:12.600Z] Remaining: 2
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Existing timestamps: 1
[2025-11-19T08:02:12.600Z] Current count after filter: 1
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.600Z] New count: 2
[2025-11-19T08:02:12.600Z] Remaining: 1
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.600Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.600Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.600Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.600Z] Existing timestamps: 2
[2025-11-19T08:02:12.600Z] Current count after filter: 2
[2025-11-19T08:02:12.600Z] Max requests allowed: 3
[2025-11-19T08:02:12.600Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:12.601Z] New count: 3
[2025-11-19T08:02:12.602Z] Remaining: 0
[2025-11-19T08:02:12.602Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:12.602Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:12.602Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:12.602Z] Identifier: test-format-blocked-1763539332600
[2025-11-19T08:02:12.602Z] Key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.602Z] üìñ Found existing entry for key: register:test-format-blocked-1763539332600
[2025-11-19T08:02:12.603Z] Existing timestamps: 3
[2025-11-19T08:02:12.603Z] Current count after filter: 3
[2025-11-19T08:02:12.603Z] Max requests allowed: 3
[2025-11-19T08:02:12.603Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:12.603Z] Current count: 3
[2025-11-19T08:02:12.603Z] Max allowed: 3
[2025-11-19T08:02:12.603Z] Retry after (seconds): 60
[2025-11-19T08:02:12.603Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.020Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.021Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.021Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.021Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.021Z] üìù Creating new entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.021Z] Current count after filter: 0
[2025-11-19T08:02:29.021Z] Max requests allowed: 5
[2025-11-19T08:02:29.021Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.021Z] New count: 1
[2025-11-19T08:02:29.021Z] Remaining: 4
[2025-11-19T08:02:29.021Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.022Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Existing timestamps: 1
[2025-11-19T08:02:29.022Z] Current count after filter: 1
[2025-11-19T08:02:29.022Z] Max requests allowed: 5
[2025-11-19T08:02:29.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.022Z] New count: 2
[2025-11-19T08:02:29.022Z] Remaining: 3
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.022Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.022Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.022Z] Existing timestamps: 2
[2025-11-19T08:02:29.022Z] Current count after filter: 2
[2025-11-19T08:02:29.022Z] Max requests allowed: 5
[2025-11-19T08:02:29.022Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.022Z] New count: 3
[2025-11-19T08:02:29.022Z] Remaining: 2
[2025-11-19T08:02:29.022Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.023Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.023Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Existing timestamps: 3
[2025-11-19T08:02:29.023Z] Current count after filter: 3
[2025-11-19T08:02:29.023Z] Max requests allowed: 5
[2025-11-19T08:02:29.023Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.023Z] New count: 4
[2025-11-19T08:02:29.023Z] Remaining: 1
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.023Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.023Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.023Z] Identifier: test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] üìñ Found existing entry for key: login:test-allow-1763539349020
[2025-11-19T08:02:29.023Z] Existing timestamps: 4
[2025-11-19T08:02:29.023Z] Current count after filter: 4
[2025-11-19T08:02:29.023Z] Max requests allowed: 5
[2025-11-19T08:02:29.023Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.023Z] New count: 5
[2025-11-19T08:02:29.023Z] Remaining: 0
[2025-11-19T08:02:29.024Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.024Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.024Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.024Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.024Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.024Z] üìù Creating new entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.024Z] Current count after filter: 0
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 1
[2025-11-19T08:02:29.025Z] Remaining: 4
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 1
[2025-11-19T08:02:29.025Z] Current count after filter: 1
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 2
[2025-11-19T08:02:29.025Z] Remaining: 3
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 2
[2025-11-19T08:02:29.025Z] Current count after filter: 2
[2025-11-19T08:02:29.025Z] Max requests allowed: 5
[2025-11-19T08:02:29.025Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.025Z] New count: 3
[2025-11-19T08:02:29.025Z] Remaining: 2
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.025Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.025Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.025Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.025Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.025Z] Existing timestamps: 3
[2025-11-19T08:02:29.025Z] Current count after filter: 3
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.026Z] New count: 4
[2025-11-19T08:02:29.026Z] Remaining: 1
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.026Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.026Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.026Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] Existing timestamps: 4
[2025-11-19T08:02:29.026Z] Current count after filter: 4
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.026Z] New count: 5
[2025-11-19T08:02:29.026Z] Remaining: 0
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.026Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.026Z] Identifier: test-block-1763539349024
[2025-11-19T08:02:29.026Z] Key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] üìñ Found existing entry for key: login:test-block-1763539349024
[2025-11-19T08:02:29.026Z] Existing timestamps: 5
[2025-11-19T08:02:29.026Z] Current count after filter: 5
[2025-11-19T08:02:29.026Z] Max requests allowed: 5
[2025-11-19T08:02:29.026Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.026Z] Current count: 5
[2025-11-19T08:02:29.026Z] Max allowed: 5
[2025-11-19T08:02:29.026Z] Retry after (seconds): 60
[2025-11-19T08:02:29.026Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] üìù Creating new entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Current count after filter: 0
[2025-11-19T08:02:29.027Z] Max requests allowed: 2
[2025-11-19T08:02:29.027Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.027Z] New count: 1
[2025-11-19T08:02:29.027Z] Remaining: 1
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Existing timestamps: 1
[2025-11-19T08:02:29.027Z] Current count after filter: 1
[2025-11-19T08:02:29.027Z] Max requests allowed: 2
[2025-11-19T08:02:29.027Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.027Z] New count: 2
[2025-11-19T08:02:29.027Z] Remaining: 0
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.027Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.027Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.027Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.027Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.028Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.028Z] Existing timestamps: 2
[2025-11-19T08:02:29.028Z] Current count after filter: 2
[2025-11-19T08:02:29.028Z] Max requests allowed: 2
[2025-11-19T08:02:29.028Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.028Z] Current count: 2
[2025-11-19T08:02:29.028Z] Max allowed: 2
[2025-11-19T08:02:29.028Z] Retry after (seconds): 1
[2025-11-19T08:02:29.028Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.180Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.180Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:02:29.180Z] Identifier: test-reset-1763539349027
[2025-11-19T08:02:29.180Z] Key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.180Z] üìñ Found existing entry for key: test-reset:test-reset-1763539349027
[2025-11-19T08:02:29.180Z] Existing timestamps: 2
[2025-11-19T08:02:29.181Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:02:29.181Z] Current count after filter: 0
[2025-11-19T08:02:29.181Z] Max requests allowed: 2
[2025-11-19T08:02:29.181Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.181Z] New count: 1
[2025-11-19T08:02:29.181Z] Remaining: 1
[2025-11-19T08:02:29.181Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.181Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.181Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.181Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.181Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.181Z] üìù Creating new entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Current count after filter: 0
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.182Z] New count: 1
[2025-11-19T08:02:29.182Z] Remaining: 4
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.182Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.182Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Existing timestamps: 1
[2025-11-19T08:02:29.182Z] Current count after filter: 1
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.182Z] New count: 2
[2025-11-19T08:02:29.182Z] Remaining: 3
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.182Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.182Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.182Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.182Z] Existing timestamps: 2
[2025-11-19T08:02:29.182Z] Current count after filter: 2
[2025-11-19T08:02:29.182Z] Max requests allowed: 5
[2025-11-19T08:02:29.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 3
[2025-11-19T08:02:29.183Z] Remaining: 2
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 3
[2025-11-19T08:02:29.183Z] Current count after filter: 3
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 4
[2025-11-19T08:02:29.183Z] Remaining: 1
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 4
[2025-11-19T08:02:29.183Z] Current count after filter: 4
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.183Z] New count: 5
[2025-11-19T08:02:29.183Z] Remaining: 0
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.183Z] Identifier: test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] üìñ Found existing entry for key: login:test-multi-1-1763539349181
[2025-11-19T08:02:29.183Z] Existing timestamps: 5
[2025-11-19T08:02:29.183Z] Current count after filter: 5
[2025-11-19T08:02:29.183Z] Max requests allowed: 5
[2025-11-19T08:02:29.183Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.183Z] Current count: 5
[2025-11-19T08:02:29.183Z] Max allowed: 5
[2025-11-19T08:02:29.184Z] Retry after (seconds): 60
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.184Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.184Z] Identifier: test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] Key: login:test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] üìù Creating new entry for key: login:test-multi-2-1763539349181
[2025-11-19T08:02:29.184Z] Current count after filter: 0
[2025-11-19T08:02:29.184Z] Max requests allowed: 5
[2025-11-19T08:02:29.184Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.184Z] New count: 1
[2025-11-19T08:02:29.184Z] Remaining: 4
[2025-11-19T08:02:29.184Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.186Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.186Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:02:29.186Z] Identifier: test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] Key: login:test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] üìù Creating new entry for key: login:test-reset-time-1763539349186
[2025-11-19T08:02:29.186Z] Current count after filter: 0
[2025-11-19T08:02:29.186Z] Max requests allowed: 5
[2025-11-19T08:02:29.186Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.186Z] New count: 1
[2025-11-19T08:02:29.186Z] Remaining: 4
[2025-11-19T08:02:29.186Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.187Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.188Z] X-Test-ID header: null
[2025-11-19T08:02:29.188Z] Will use test ID?: false
[2025-11-19T08:02:29.188Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.188Z] X-Test-ID header: null
[2025-11-19T08:02:29.188Z] Will use test ID?: false
[2025-11-19T08:02:29.188Z] Using real IP: 192.168.1.2
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.188Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.188Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.189Z] X-Test-ID header: null
[2025-11-19T08:02:29.189Z] Will use test ID?: false
[2025-11-19T08:02:29.189Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.189Z] X-Test-ID header: null
[2025-11-19T08:02:29.189Z] Will use test ID?: false
[2025-11-19T08:02:29.189Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.189Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:02:29.189Z] E2E_TEST_MODE (env): true
[2025-11-19T08:02:29.190Z] E2E_TEST_MODE (final): true
[2025-11-19T08:02:29.190Z] X-Test-ID header: null
[2025-11-19T08:02:29.190Z] Will use test ID?: false
[2025-11-19T08:02:29.190Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:02:29.190Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:02:29.190Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.190Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.190Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.190Z] Current count after filter: 0
[2025-11-19T08:02:29.190Z] Max requests allowed: 3
[2025-11-19T08:02:29.190Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.190Z] New count: 1
[2025-11-19T08:02:29.190Z] Remaining: 2
[2025-11-19T08:02:29.190Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.292Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.292Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.292Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.292Z] Existing timestamps: 1
[2025-11-19T08:02:29.292Z] Current count after filter: 1
[2025-11-19T08:02:29.292Z] Max requests allowed: 3
[2025-11-19T08:02:29.292Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.292Z] New count: 2
[2025-11-19T08:02:29.292Z] Remaining: 1
[2025-11-19T08:02:29.292Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.394Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:02:29.394Z] Identifier: test-sliding-1763539349190
[2025-11-19T08:02:29.394Z] Key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.395Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539349190
[2025-11-19T08:02:29.395Z] Existing timestamps: 2
[2025-11-19T08:02:29.395Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:02:29.395Z] Current count after filter: 1
[2025-11-19T08:02:29.395Z] Max requests allowed: 3
[2025-11-19T08:02:29.395Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.395Z] New count: 2
[2025-11-19T08:02:29.395Z] Remaining: 1
[2025-11-19T08:02:29.395Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.395Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.395Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.395Z] Identifier: test-format-allowed-1763539349395
[2025-11-19T08:02:29.395Z] Key: register:test-format-allowed-1763539349395
[2025-11-19T08:02:29.395Z] üìù Creating new entry for key: register:test-format-allowed-1763539349395
[2025-11-19T08:02:29.396Z] Current count after filter: 0
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.396Z] New count: 1
[2025-11-19T08:02:29.396Z] Remaining: 2
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.396Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.396Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] üìù Creating new entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Current count after filter: 0
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.396Z] New count: 1
[2025-11-19T08:02:29.396Z] Remaining: 2
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.396Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.396Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.396Z] Existing timestamps: 1
[2025-11-19T08:02:29.396Z] Current count after filter: 1
[2025-11-19T08:02:29.396Z] Max requests allowed: 3
[2025-11-19T08:02:29.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.397Z] New count: 2
[2025-11-19T08:02:29.397Z] Remaining: 1
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.397Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.397Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Existing timestamps: 2
[2025-11-19T08:02:29.397Z] Current count after filter: 2
[2025-11-19T08:02:29.397Z] Max requests allowed: 3
[2025-11-19T08:02:29.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:02:29.397Z] New count: 3
[2025-11-19T08:02:29.397Z] Remaining: 0
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:02:29.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:02:29.397Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:02:29.397Z] Identifier: test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] üìñ Found existing entry for key: register:test-format-blocked-1763539349396
[2025-11-19T08:02:29.397Z] Existing timestamps: 3
[2025-11-19T08:02:29.397Z] Current count after filter: 3
[2025-11-19T08:02:29.397Z] Max requests allowed: 3
[2025-11-19T08:02:29.397Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:02:29.398Z] Current count: 3
[2025-11-19T08:02:29.398Z] Max allowed: 3
[2025-11-19T08:02:29.398Z] Retry after (seconds): 60
[2025-11-19T08:02:29.398Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.226Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.227Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.227Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.227Z] üìù Creating new entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.227Z] Current count after filter: 0
[2025-11-19T08:04:17.227Z] Max requests allowed: 5
[2025-11-19T08:04:17.227Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.227Z] New count: 1
[2025-11-19T08:04:17.227Z] Remaining: 4
[2025-11-19T08:04:17.227Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.228Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.228Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Existing timestamps: 1
[2025-11-19T08:04:17.228Z] Current count after filter: 1
[2025-11-19T08:04:17.228Z] Max requests allowed: 5
[2025-11-19T08:04:17.228Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.228Z] New count: 2
[2025-11-19T08:04:17.228Z] Remaining: 3
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.228Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.228Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.228Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.228Z] Existing timestamps: 2
[2025-11-19T08:04:17.228Z] Current count after filter: 2
[2025-11-19T08:04:17.228Z] Max requests allowed: 5
[2025-11-19T08:04:17.228Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.228Z] New count: 3
[2025-11-19T08:04:17.228Z] Remaining: 2
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.229Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.229Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.229Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.229Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.229Z] Existing timestamps: 3
[2025-11-19T08:04:17.229Z] Current count after filter: 3
[2025-11-19T08:04:17.229Z] Max requests allowed: 5
[2025-11-19T08:04:17.229Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.229Z] New count: 4
[2025-11-19T08:04:17.229Z] Remaining: 1
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.229Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.230Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.230Z] Identifier: test-allow-1763539457225
[2025-11-19T08:04:17.230Z] Key: login:test-allow-1763539457225
[2025-11-19T08:04:17.230Z] üìñ Found existing entry for key: login:test-allow-1763539457225
[2025-11-19T08:04:17.230Z] Existing timestamps: 4
[2025-11-19T08:04:17.230Z] Current count after filter: 4
[2025-11-19T08:04:17.230Z] Max requests allowed: 5
[2025-11-19T08:04:17.230Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.230Z] New count: 5
[2025-11-19T08:04:17.230Z] Remaining: 0
[2025-11-19T08:04:17.230Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.231Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] üìù Creating new entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] Current count after filter: 0
[2025-11-19T08:04:17.231Z] Max requests allowed: 5
[2025-11-19T08:04:17.231Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.231Z] New count: 1
[2025-11-19T08:04:17.231Z] Remaining: 4
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.231Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.231Z] Existing timestamps: 1
[2025-11-19T08:04:17.231Z] Current count after filter: 1
[2025-11-19T08:04:17.231Z] Max requests allowed: 5
[2025-11-19T08:04:17.231Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.231Z] New count: 2
[2025-11-19T08:04:17.231Z] Remaining: 3
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.231Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.231Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 2
[2025-11-19T08:04:17.232Z] Current count after filter: 2
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 3
[2025-11-19T08:04:17.232Z] Remaining: 2
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.232Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.232Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 3
[2025-11-19T08:04:17.232Z] Current count after filter: 3
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 4
[2025-11-19T08:04:17.232Z] Remaining: 1
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.232Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.232Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.232Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.232Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.232Z] Existing timestamps: 4
[2025-11-19T08:04:17.232Z] Current count after filter: 4
[2025-11-19T08:04:17.232Z] Max requests allowed: 5
[2025-11-19T08:04:17.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.232Z] New count: 5
[2025-11-19T08:04:17.233Z] Remaining: 0
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.233Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.233Z] Identifier: test-block-1763539457231
[2025-11-19T08:04:17.233Z] Key: login:test-block-1763539457231
[2025-11-19T08:04:17.233Z] üìñ Found existing entry for key: login:test-block-1763539457231
[2025-11-19T08:04:17.233Z] Existing timestamps: 5
[2025-11-19T08:04:17.233Z] Current count after filter: 5
[2025-11-19T08:04:17.233Z] Max requests allowed: 5
[2025-11-19T08:04:17.233Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.233Z] Current count: 5
[2025-11-19T08:04:17.233Z] Max allowed: 5
[2025-11-19T08:04:17.233Z] Retry after (seconds): 60
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.233Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.233Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.233Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.233Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.233Z] üìù Creating new entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.233Z] Current count after filter: 0
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.234Z] New count: 1
[2025-11-19T08:04:17.234Z] Remaining: 1
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.234Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.234Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Existing timestamps: 1
[2025-11-19T08:04:17.234Z] Current count after filter: 1
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.234Z] New count: 2
[2025-11-19T08:04:17.234Z] Remaining: 0
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.234Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.234Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.234Z] Existing timestamps: 2
[2025-11-19T08:04:17.234Z] Current count after filter: 2
[2025-11-19T08:04:17.234Z] Max requests allowed: 2
[2025-11-19T08:04:17.234Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.234Z] Current count: 2
[2025-11-19T08:04:17.234Z] Max allowed: 2
[2025-11-19T08:04:17.234Z] Retry after (seconds): 1
[2025-11-19T08:04:17.234Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.385Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.385Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:04:17.385Z] Identifier: test-reset-1763539457233
[2025-11-19T08:04:17.385Z] Key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.385Z] üìñ Found existing entry for key: test-reset:test-reset-1763539457233
[2025-11-19T08:04:17.385Z] Existing timestamps: 2
[2025-11-19T08:04:17.385Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:04:17.385Z] Current count after filter: 0
[2025-11-19T08:04:17.385Z] Max requests allowed: 2
[2025-11-19T08:04:17.385Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.385Z] New count: 1
[2025-11-19T08:04:17.385Z] Remaining: 1
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.386Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] üìù Creating new entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Current count after filter: 0
[2025-11-19T08:04:17.386Z] Max requests allowed: 5
[2025-11-19T08:04:17.386Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.386Z] New count: 1
[2025-11-19T08:04:17.386Z] Remaining: 4
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.386Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.386Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.386Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.386Z] Existing timestamps: 1
[2025-11-19T08:04:17.386Z] Current count after filter: 1
[2025-11-19T08:04:17.386Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 2
[2025-11-19T08:04:17.387Z] Remaining: 3
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Existing timestamps: 2
[2025-11-19T08:04:17.387Z] Current count after filter: 2
[2025-11-19T08:04:17.387Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 3
[2025-11-19T08:04:17.387Z] Remaining: 2
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Existing timestamps: 3
[2025-11-19T08:04:17.387Z] Current count after filter: 3
[2025-11-19T08:04:17.387Z] Max requests allowed: 5
[2025-11-19T08:04:17.387Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.387Z] New count: 4
[2025-11-19T08:04:17.387Z] Remaining: 1
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.387Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.387Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.387Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.387Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Existing timestamps: 4
[2025-11-19T08:04:17.388Z] Current count after filter: 4
[2025-11-19T08:04:17.388Z] Max requests allowed: 5
[2025-11-19T08:04:17.388Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.388Z] New count: 5
[2025-11-19T08:04:17.388Z] Remaining: 0
[2025-11-19T08:04:17.388Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.388Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.388Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.388Z] Identifier: test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] üìñ Found existing entry for key: login:test-multi-1-1763539457386
[2025-11-19T08:04:17.388Z] Existing timestamps: 5
[2025-11-19T08:04:17.388Z] Current count after filter: 5
[2025-11-19T08:04:17.388Z] Max requests allowed: 5
[2025-11-19T08:04:17.388Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.388Z] Current count: 5
[2025-11-19T08:04:17.388Z] Max allowed: 5
[2025-11-19T08:04:17.388Z] Retry after (seconds): 60
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.389Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.389Z] Identifier: test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] Key: login:test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] üìù Creating new entry for key: login:test-multi-2-1763539457386
[2025-11-19T08:04:17.389Z] Current count after filter: 0
[2025-11-19T08:04:17.389Z] Max requests allowed: 5
[2025-11-19T08:04:17.389Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.389Z] New count: 1
[2025-11-19T08:04:17.389Z] Remaining: 4
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.389Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.390Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:04:17.390Z] Identifier: test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] Key: login:test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] üìù Creating new entry for key: login:test-reset-time-1763539457389
[2025-11-19T08:04:17.390Z] Current count after filter: 0
[2025-11-19T08:04:17.390Z] Max requests allowed: 5
[2025-11-19T08:04:17.390Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.390Z] New count: 1
[2025-11-19T08:04:17.390Z] Remaining: 4
[2025-11-19T08:04:17.390Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.391Z] X-Test-ID header: null
[2025-11-19T08:04:17.391Z] Will use test ID?: false
[2025-11-19T08:04:17.391Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.391Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.391Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.391Z] X-Test-ID header: null
[2025-11-19T08:04:17.391Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] Using real IP: 192.168.1.2
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.392Z] X-Test-ID header: null
[2025-11-19T08:04:17.392Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.392Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.392Z] X-Test-ID header: null
[2025-11-19T08:04:17.392Z] Will use test ID?: false
[2025-11-19T08:04:17.392Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:04:17.392Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.393Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (env): true
[2025-11-19T08:04:17.393Z] E2E_TEST_MODE (final): true
[2025-11-19T08:04:17.393Z] X-Test-ID header: null
[2025-11-19T08:04:17.393Z] Will use test ID?: false
[2025-11-19T08:04:17.393Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:04:17.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:04:17.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.393Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.393Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.393Z] Current count after filter: 0
[2025-11-19T08:04:17.393Z] Max requests allowed: 3
[2025-11-19T08:04:17.393Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.393Z] New count: 1
[2025-11-19T08:04:17.393Z] Remaining: 2
[2025-11-19T08:04:17.393Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.493Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.493Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.494Z] Existing timestamps: 1
[2025-11-19T08:04:17.494Z] Current count after filter: 1
[2025-11-19T08:04:17.494Z] Max requests allowed: 3
[2025-11-19T08:04:17.494Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.494Z] New count: 2
[2025-11-19T08:04:17.494Z] Remaining: 1
[2025-11-19T08:04:17.494Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.596Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:04:17.596Z] Identifier: test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] Key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539457393
[2025-11-19T08:04:17.596Z] Existing timestamps: 2
[2025-11-19T08:04:17.596Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:04:17.596Z] Current count after filter: 1
[2025-11-19T08:04:17.596Z] Max requests allowed: 3
[2025-11-19T08:04:17.596Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.596Z] New count: 2
[2025-11-19T08:04:17.596Z] Remaining: 1
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.596Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.596Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.596Z] Identifier: test-format-allowed-1763539457596
[2025-11-19T08:04:17.596Z] Key: register:test-format-allowed-1763539457596
[2025-11-19T08:04:17.596Z] üìù Creating new entry for key: register:test-format-allowed-1763539457596
[2025-11-19T08:04:17.597Z] Current count after filter: 0
[2025-11-19T08:04:17.597Z] Max requests allowed: 3
[2025-11-19T08:04:17.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.597Z] New count: 1
[2025-11-19T08:04:17.597Z] Remaining: 2
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.597Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.597Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] üìù Creating new entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.597Z] Current count after filter: 0
[2025-11-19T08:04:17.597Z] Max requests allowed: 3
[2025-11-19T08:04:17.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.597Z] New count: 1
[2025-11-19T08:04:17.597Z] Remaining: 2
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.597Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 1
[2025-11-19T08:04:17.598Z] Current count after filter: 1
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.598Z] New count: 2
[2025-11-19T08:04:17.598Z] Remaining: 1
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.598Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 2
[2025-11-19T08:04:17.598Z] Current count after filter: 2
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:04:17.598Z] New count: 3
[2025-11-19T08:04:17.598Z] Remaining: 0
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:04:17.598Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:04:17.598Z] Identifier: test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] üìñ Found existing entry for key: register:test-format-blocked-1763539457597
[2025-11-19T08:04:17.598Z] Existing timestamps: 3
[2025-11-19T08:04:17.598Z] Current count after filter: 3
[2025-11-19T08:04:17.598Z] Max requests allowed: 3
[2025-11-19T08:04:17.598Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:04:17.598Z] Current count: 3
[2025-11-19T08:04:17.598Z] Max allowed: 3
[2025-11-19T08:04:17.598Z] Retry after (seconds): 60
[2025-11-19T08:04:17.598Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.091Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.091Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.091Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.091Z] üìù Creating new entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.091Z] Current count after filter: 0
[2025-11-19T08:06:51.091Z] Max requests allowed: 5
[2025-11-19T08:06:51.091Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.091Z] New count: 1
[2025-11-19T08:06:51.092Z] Remaining: 4
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.092Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.092Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.092Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.092Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.092Z] Existing timestamps: 1
[2025-11-19T08:06:51.092Z] Current count after filter: 1
[2025-11-19T08:06:51.092Z] Max requests allowed: 5
[2025-11-19T08:06:51.092Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.092Z] New count: 2
[2025-11-19T08:06:51.092Z] Remaining: 3
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.092Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 2
[2025-11-19T08:06:51.093Z] Current count after filter: 2
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.093Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.093Z] New count: 3
[2025-11-19T08:06:51.093Z] Remaining: 2
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 3
[2025-11-19T08:06:51.093Z] Current count after filter: 3
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.093Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.093Z] New count: 4
[2025-11-19T08:06:51.093Z] Remaining: 1
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.093Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.093Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.093Z] Identifier: test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] üìñ Found existing entry for key: login:test-allow-1763539611090
[2025-11-19T08:06:51.093Z] Existing timestamps: 4
[2025-11-19T08:06:51.093Z] Current count after filter: 4
[2025-11-19T08:06:51.093Z] Max requests allowed: 5
[2025-11-19T08:06:51.094Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.094Z] New count: 5
[2025-11-19T08:06:51.094Z] Remaining: 0
[2025-11-19T08:06:51.094Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.094Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.094Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.094Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.094Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.094Z] üìù Creating new entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.094Z] Current count after filter: 0
[2025-11-19T08:06:51.094Z] Max requests allowed: 5
[2025-11-19T08:06:51.094Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.094Z] New count: 1
[2025-11-19T08:06:51.094Z] Remaining: 4
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.095Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.095Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] Existing timestamps: 1
[2025-11-19T08:06:51.095Z] Current count after filter: 1
[2025-11-19T08:06:51.095Z] Max requests allowed: 5
[2025-11-19T08:06:51.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.095Z] New count: 2
[2025-11-19T08:06:51.095Z] Remaining: 3
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.095Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.095Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.095Z] Existing timestamps: 2
[2025-11-19T08:06:51.095Z] Current count after filter: 2
[2025-11-19T08:06:51.095Z] Max requests allowed: 5
[2025-11-19T08:06:51.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.095Z] New count: 3
[2025-11-19T08:06:51.095Z] Remaining: 2
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.095Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 3
[2025-11-19T08:06:51.096Z] Current count after filter: 3
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.096Z] New count: 4
[2025-11-19T08:06:51.096Z] Remaining: 1
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 4
[2025-11-19T08:06:51.096Z] Current count after filter: 4
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.096Z] New count: 5
[2025-11-19T08:06:51.096Z] Remaining: 0
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.096Z] Identifier: test-block-1763539611094
[2025-11-19T08:06:51.096Z] Key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] üìñ Found existing entry for key: login:test-block-1763539611094
[2025-11-19T08:06:51.096Z] Existing timestamps: 5
[2025-11-19T08:06:51.096Z] Current count after filter: 5
[2025-11-19T08:06:51.096Z] Max requests allowed: 5
[2025-11-19T08:06:51.097Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.097Z] Current count: 5
[2025-11-19T08:06:51.097Z] Max allowed: 5
[2025-11-19T08:06:51.097Z] Retry after (seconds): 60
[2025-11-19T08:06:51.097Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.098Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] üìù Creating new entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Current count after filter: 0
[2025-11-19T08:06:51.098Z] Max requests allowed: 2
[2025-11-19T08:06:51.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.098Z] New count: 1
[2025-11-19T08:06:51.098Z] Remaining: 1
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.098Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.098Z] Existing timestamps: 1
[2025-11-19T08:06:51.098Z] Current count after filter: 1
[2025-11-19T08:06:51.098Z] Max requests allowed: 2
[2025-11-19T08:06:51.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.098Z] New count: 2
[2025-11-19T08:06:51.098Z] Remaining: 0
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.098Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.099Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.099Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.099Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.099Z] Existing timestamps: 2
[2025-11-19T08:06:51.099Z] Current count after filter: 2
[2025-11-19T08:06:51.099Z] Max requests allowed: 2
[2025-11-19T08:06:51.099Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.099Z] Current count: 2
[2025-11-19T08:06:51.099Z] Max allowed: 2
[2025-11-19T08:06:51.099Z] Retry after (seconds): 1
[2025-11-19T08:06:51.099Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.250Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.250Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:06:51.250Z] Identifier: test-reset-1763539611098
[2025-11-19T08:06:51.250Z] Key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763539611098
[2025-11-19T08:06:51.251Z] Existing timestamps: 2
[2025-11-19T08:06:51.251Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:06:51.251Z] Current count after filter: 0
[2025-11-19T08:06:51.251Z] Max requests allowed: 2
[2025-11-19T08:06:51.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.251Z] New count: 1
[2025-11-19T08:06:51.251Z] Remaining: 1
[2025-11-19T08:06:51.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.251Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.251Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] üìù Creating new entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.251Z] Current count after filter: 0
[2025-11-19T08:06:51.251Z] Max requests allowed: 5
[2025-11-19T08:06:51.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.251Z] New count: 1
[2025-11-19T08:06:51.251Z] Remaining: 4
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.252Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.252Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Existing timestamps: 1
[2025-11-19T08:06:51.252Z] Current count after filter: 1
[2025-11-19T08:06:51.252Z] Max requests allowed: 5
[2025-11-19T08:06:51.252Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.252Z] New count: 2
[2025-11-19T08:06:51.252Z] Remaining: 3
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.252Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.252Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.252Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.252Z] Existing timestamps: 2
[2025-11-19T08:06:51.252Z] Current count after filter: 2
[2025-11-19T08:06:51.252Z] Max requests allowed: 5
[2025-11-19T08:06:51.253Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.253Z] New count: 3
[2025-11-19T08:06:51.253Z] Remaining: 2
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.253Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.253Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Existing timestamps: 3
[2025-11-19T08:06:51.253Z] Current count after filter: 3
[2025-11-19T08:06:51.253Z] Max requests allowed: 5
[2025-11-19T08:06:51.253Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.253Z] New count: 4
[2025-11-19T08:06:51.253Z] Remaining: 1
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.253Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.253Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.253Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.253Z] Existing timestamps: 4
[2025-11-19T08:06:51.254Z] Current count after filter: 4
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.254Z] New count: 5
[2025-11-19T08:06:51.254Z] Remaining: 0
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.254Z] Identifier: test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] Key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] üìñ Found existing entry for key: login:test-multi-1-1763539611251
[2025-11-19T08:06:51.254Z] Existing timestamps: 5
[2025-11-19T08:06:51.254Z] Current count after filter: 5
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.254Z] Current count: 5
[2025-11-19T08:06:51.254Z] Max allowed: 5
[2025-11-19T08:06:51.254Z] Retry after (seconds): 60
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:06:51.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.254Z] Identifier: test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] Key: login:test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] üìù Creating new entry for key: login:test-multi-2-1763539611251
[2025-11-19T08:06:51.254Z] Current count after filter: 0
[2025-11-19T08:06:51.254Z] Max requests allowed: 5
[2025-11-19T08:06:51.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.254Z] New count: 1
[2025-11-19T08:06:51.254Z] Remaining: 4
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:06:51.255Z] Identifier: test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] Key: login:test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] üìù Creating new entry for key: login:test-reset-time-1763539611255
[2025-11-19T08:06:51.255Z] Current count after filter: 0
[2025-11-19T08:06:51.255Z] Max requests allowed: 5
[2025-11-19T08:06:51.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.255Z] New count: 1
[2025-11-19T08:06:51.255Z] Remaining: 4
[2025-11-19T08:06:51.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.256Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.256Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.256Z] X-Test-ID header: null
[2025-11-19T08:06:51.257Z] Will use test ID?: false
[2025-11-19T08:06:51.257Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.257Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.257Z] X-Test-ID header: null
[2025-11-19T08:06:51.257Z] Will use test ID?: false
[2025-11-19T08:06:51.257Z] Using real IP: 192.168.1.2
[2025-11-19T08:06:51.257Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.258Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.258Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.258Z] X-Test-ID header: null
[2025-11-19T08:06:51.258Z] Will use test ID?: false
[2025-11-19T08:06:51.258Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.258Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.259Z] X-Test-ID header: null
[2025-11-19T08:06:51.259Z] Will use test ID?: false
[2025-11-19T08:06:51.259Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.259Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (env): true
[2025-11-19T08:06:51.259Z] E2E_TEST_MODE (final): true
[2025-11-19T08:06:51.260Z] X-Test-ID header: null
[2025-11-19T08:06:51.260Z] Will use test ID?: false
[2025-11-19T08:06:51.260Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:06:51.260Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:06:51.261Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.261Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.261Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.261Z] Current count after filter: 0
[2025-11-19T08:06:51.261Z] Max requests allowed: 3
[2025-11-19T08:06:51.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.261Z] New count: 1
[2025-11-19T08:06:51.261Z] Remaining: 2
[2025-11-19T08:06:51.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.361Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.361Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.361Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.361Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.361Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.362Z] Existing timestamps: 1
[2025-11-19T08:06:51.362Z] Current count after filter: 1
[2025-11-19T08:06:51.362Z] Max requests allowed: 3
[2025-11-19T08:06:51.362Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.362Z] New count: 2
[2025-11-19T08:06:51.362Z] Remaining: 1
[2025-11-19T08:06:51.362Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.463Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.463Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:06:51.463Z] Identifier: test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] Key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539611261
[2025-11-19T08:06:51.463Z] Existing timestamps: 2
[2025-11-19T08:06:51.463Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:06:51.463Z] Current count after filter: 1
[2025-11-19T08:06:51.463Z] Max requests allowed: 3
[2025-11-19T08:06:51.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.464Z] New count: 2
[2025-11-19T08:06:51.464Z] Remaining: 1
[2025-11-19T08:06:51.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.464Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.465Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.465Z] Identifier: test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] Key: register:test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] üìù Creating new entry for key: register:test-format-allowed-1763539611464
[2025-11-19T08:06:51.465Z] Current count after filter: 0
[2025-11-19T08:06:51.465Z] Max requests allowed: 3
[2025-11-19T08:06:51.465Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.465Z] New count: 1
[2025-11-19T08:06:51.465Z] Remaining: 2
[2025-11-19T08:06:51.465Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.466Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.466Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.466Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] üìù Creating new entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Current count after filter: 0
[2025-11-19T08:06:51.467Z] Max requests allowed: 3
[2025-11-19T08:06:51.467Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.467Z] New count: 1
[2025-11-19T08:06:51.467Z] Remaining: 2
[2025-11-19T08:06:51.467Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.467Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.467Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.467Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.467Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 1
[2025-11-19T08:06:51.468Z] Current count after filter: 1
[2025-11-19T08:06:51.468Z] Max requests allowed: 3
[2025-11-19T08:06:51.468Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.468Z] New count: 2
[2025-11-19T08:06:51.468Z] Remaining: 1
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.468Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.468Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 2
[2025-11-19T08:06:51.468Z] Current count after filter: 2
[2025-11-19T08:06:51.468Z] Max requests allowed: 3
[2025-11-19T08:06:51.468Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:06:51.468Z] New count: 3
[2025-11-19T08:06:51.468Z] Remaining: 0
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:06:51.468Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:06:51.468Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:06:51.468Z] Identifier: test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] üìñ Found existing entry for key: register:test-format-blocked-1763539611466
[2025-11-19T08:06:51.468Z] Existing timestamps: 3
[2025-11-19T08:06:51.469Z] Current count after filter: 3
[2025-11-19T08:06:51.469Z] Max requests allowed: 3
[2025-11-19T08:06:51.469Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:06:51.469Z] Current count: 3
[2025-11-19T08:06:51.469Z] Max allowed: 3
[2025-11-19T08:06:51.469Z] Retry after (seconds): 60
[2025-11-19T08:06:51.469Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.765Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] üìù Creating new entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Current count after filter: 0
[2025-11-19T08:08:39.766Z] Max requests allowed: 5
[2025-11-19T08:08:39.766Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.766Z] New count: 1
[2025-11-19T08:08:39.766Z] Remaining: 4
[2025-11-19T08:08:39.766Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.766Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.766Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.766Z] Existing timestamps: 1
[2025-11-19T08:08:39.766Z] Current count after filter: 1
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 2
[2025-11-19T08:08:39.767Z] Remaining: 3
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.767Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Existing timestamps: 2
[2025-11-19T08:08:39.767Z] Current count after filter: 2
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 3
[2025-11-19T08:08:39.767Z] Remaining: 2
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.767Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.767Z] Existing timestamps: 3
[2025-11-19T08:08:39.767Z] Current count after filter: 3
[2025-11-19T08:08:39.767Z] Max requests allowed: 5
[2025-11-19T08:08:39.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.767Z] New count: 4
[2025-11-19T08:08:39.767Z] Remaining: 1
[2025-11-19T08:08:39.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.768Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.768Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.768Z] Identifier: test-allow-1763539719764
[2025-11-19T08:08:39.768Z] Key: login:test-allow-1763539719764
[2025-11-19T08:08:39.768Z] üìñ Found existing entry for key: login:test-allow-1763539719764
[2025-11-19T08:08:39.768Z] Existing timestamps: 4
[2025-11-19T08:08:39.768Z] Current count after filter: 4
[2025-11-19T08:08:39.768Z] Max requests allowed: 5
[2025-11-19T08:08:39.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.768Z] New count: 5
[2025-11-19T08:08:39.768Z] Remaining: 0
[2025-11-19T08:08:39.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.769Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] üìù Creating new entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] Current count after filter: 0
[2025-11-19T08:08:39.769Z] Max requests allowed: 5
[2025-11-19T08:08:39.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.769Z] New count: 1
[2025-11-19T08:08:39.769Z] Remaining: 4
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.769Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.769Z] Existing timestamps: 1
[2025-11-19T08:08:39.769Z] Current count after filter: 1
[2025-11-19T08:08:39.769Z] Max requests allowed: 5
[2025-11-19T08:08:39.769Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.769Z] New count: 2
[2025-11-19T08:08:39.769Z] Remaining: 3
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.769Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.769Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 2
[2025-11-19T08:08:39.770Z] Current count after filter: 2
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 3
[2025-11-19T08:08:39.770Z] Remaining: 2
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 3
[2025-11-19T08:08:39.770Z] Current count after filter: 3
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 4
[2025-11-19T08:08:39.770Z] Remaining: 1
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 4
[2025-11-19T08:08:39.770Z] Current count after filter: 4
[2025-11-19T08:08:39.770Z] Max requests allowed: 5
[2025-11-19T08:08:39.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.770Z] New count: 5
[2025-11-19T08:08:39.770Z] Remaining: 0
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.770Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.770Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.770Z] Identifier: test-block-1763539719769
[2025-11-19T08:08:39.770Z] Key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] üìñ Found existing entry for key: login:test-block-1763539719769
[2025-11-19T08:08:39.770Z] Existing timestamps: 5
[2025-11-19T08:08:39.771Z] Current count after filter: 5
[2025-11-19T08:08:39.771Z] Max requests allowed: 5
[2025-11-19T08:08:39.771Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.771Z] Current count: 5
[2025-11-19T08:08:39.771Z] Max allowed: 5
[2025-11-19T08:08:39.771Z] Retry after (seconds): 60
[2025-11-19T08:08:39.771Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.772Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.772Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] üìù Creating new entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Current count after filter: 0
[2025-11-19T08:08:39.772Z] Max requests allowed: 2
[2025-11-19T08:08:39.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.772Z] New count: 1
[2025-11-19T08:08:39.772Z] Remaining: 1
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.772Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.772Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.772Z] Existing timestamps: 1
[2025-11-19T08:08:39.772Z] Current count after filter: 1
[2025-11-19T08:08:39.772Z] Max requests allowed: 2
[2025-11-19T08:08:39.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.772Z] New count: 2
[2025-11-19T08:08:39.773Z] Remaining: 0
[2025-11-19T08:08:39.773Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.773Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.773Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.774Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.774Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.774Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.774Z] Existing timestamps: 2
[2025-11-19T08:08:39.774Z] Current count after filter: 2
[2025-11-19T08:08:39.774Z] Max requests allowed: 2
[2025-11-19T08:08:39.774Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.774Z] Current count: 2
[2025-11-19T08:08:39.774Z] Max allowed: 2
[2025-11-19T08:08:39.774Z] Retry after (seconds): 1
[2025-11-19T08:08:39.774Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.926Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.926Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:08:39.926Z] Identifier: test-reset-1763539719772
[2025-11-19T08:08:39.926Z] Key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.926Z] üìñ Found existing entry for key: test-reset:test-reset-1763539719772
[2025-11-19T08:08:39.926Z] Existing timestamps: 2
[2025-11-19T08:08:39.926Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:08:39.926Z] Current count after filter: 0
[2025-11-19T08:08:39.926Z] Max requests allowed: 2
[2025-11-19T08:08:39.926Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.926Z] New count: 1
[2025-11-19T08:08:39.926Z] Remaining: 1
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.927Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] üìù Creating new entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Current count after filter: 0
[2025-11-19T08:08:39.927Z] Max requests allowed: 5
[2025-11-19T08:08:39.927Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.927Z] New count: 1
[2025-11-19T08:08:39.927Z] Remaining: 4
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.927Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.927Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.928Z] Existing timestamps: 1
[2025-11-19T08:08:39.928Z] Current count after filter: 1
[2025-11-19T08:08:39.928Z] Max requests allowed: 5
[2025-11-19T08:08:39.928Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.928Z] New count: 2
[2025-11-19T08:08:39.928Z] Remaining: 3
[2025-11-19T08:08:39.928Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.928Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.928Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.928Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.928Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.929Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.929Z] Existing timestamps: 2
[2025-11-19T08:08:39.929Z] Current count after filter: 2
[2025-11-19T08:08:39.929Z] Max requests allowed: 5
[2025-11-19T08:08:39.929Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.929Z] New count: 3
[2025-11-19T08:08:39.930Z] Remaining: 2
[2025-11-19T08:08:39.930Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.930Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.930Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.930Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.930Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.930Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Existing timestamps: 3
[2025-11-19T08:08:39.931Z] Current count after filter: 3
[2025-11-19T08:08:39.931Z] Max requests allowed: 5
[2025-11-19T08:08:39.931Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.931Z] New count: 4
[2025-11-19T08:08:39.931Z] Remaining: 1
[2025-11-19T08:08:39.931Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.931Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.931Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.931Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.931Z] Existing timestamps: 4
[2025-11-19T08:08:39.931Z] Current count after filter: 4
[2025-11-19T08:08:39.931Z] Max requests allowed: 5
[2025-11-19T08:08:39.931Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.931Z] New count: 5
[2025-11-19T08:08:39.932Z] Remaining: 0
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.932Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.932Z] Identifier: test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] Key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] üìñ Found existing entry for key: login:test-multi-1-1763539719927
[2025-11-19T08:08:39.932Z] Existing timestamps: 5
[2025-11-19T08:08:39.932Z] Current count after filter: 5
[2025-11-19T08:08:39.932Z] Max requests allowed: 5
[2025-11-19T08:08:39.932Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:39.932Z] Current count: 5
[2025-11-19T08:08:39.932Z] Max allowed: 5
[2025-11-19T08:08:39.932Z] Retry after (seconds): 60
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.932Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.932Z] Identifier: test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] Key: login:test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] üìù Creating new entry for key: login:test-multi-2-1763539719927
[2025-11-19T08:08:39.932Z] Current count after filter: 0
[2025-11-19T08:08:39.932Z] Max requests allowed: 5
[2025-11-19T08:08:39.932Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.932Z] New count: 1
[2025-11-19T08:08:39.932Z] Remaining: 4
[2025-11-19T08:08:39.932Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.933Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.933Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:08:39.933Z] Identifier: test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] Key: login:test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] üìù Creating new entry for key: login:test-reset-time-1763539719933
[2025-11-19T08:08:39.933Z] Current count after filter: 0
[2025-11-19T08:08:39.933Z] Max requests allowed: 5
[2025-11-19T08:08:39.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.933Z] New count: 1
[2025-11-19T08:08:39.933Z] Remaining: 4
[2025-11-19T08:08:39.933Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.935Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.935Z] X-Test-ID header: null
[2025-11-19T08:08:39.935Z] Will use test ID?: false
[2025-11-19T08:08:39.935Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.935Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.936Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.936Z] X-Test-ID header: null
[2025-11-19T08:08:39.936Z] Will use test ID?: false
[2025-11-19T08:08:39.936Z] Using real IP: 192.168.1.2
[2025-11-19T08:08:39.936Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.937Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.937Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.937Z] X-Test-ID header: null
[2025-11-19T08:08:39.937Z] Will use test ID?: false
[2025-11-19T08:08:39.937Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.937Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.938Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.938Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.938Z] X-Test-ID header: null
[2025-11-19T08:08:39.938Z] Will use test ID?: false
[2025-11-19T08:08:39.938Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:08:39.938Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.939Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (env): true
[2025-11-19T08:08:39.939Z] E2E_TEST_MODE (final): true
[2025-11-19T08:08:39.939Z] X-Test-ID header: null
[2025-11-19T08:08:39.939Z] Will use test ID?: false
[2025-11-19T08:08:39.939Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:08:39.939Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:08:39.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:39.940Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:39.940Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:39.940Z] Current count after filter: 0
[2025-11-19T08:08:39.940Z] Max requests allowed: 3
[2025-11-19T08:08:39.940Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:39.940Z] New count: 1
[2025-11-19T08:08:39.940Z] Remaining: 2
[2025-11-19T08:08:39.940Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.042Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:40.042Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.042Z] Existing timestamps: 1
[2025-11-19T08:08:40.042Z] Current count after filter: 1
[2025-11-19T08:08:40.042Z] Max requests allowed: 3
[2025-11-19T08:08:40.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.047Z] New count: 2
[2025-11-19T08:08:40.048Z] Remaining: 1
[2025-11-19T08:08:40.048Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.149Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.149Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:08:40.150Z] Identifier: test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] Key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539719940
[2025-11-19T08:08:40.150Z] Existing timestamps: 2
[2025-11-19T08:08:40.150Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:08:40.150Z] Current count after filter: 1
[2025-11-19T08:08:40.150Z] Max requests allowed: 3
[2025-11-19T08:08:40.150Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.150Z] New count: 2
[2025-11-19T08:08:40.150Z] Remaining: 1
[2025-11-19T08:08:40.150Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.150Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.150Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.150Z] Identifier: test-format-allowed-1763539720150
[2025-11-19T08:08:40.150Z] Key: register:test-format-allowed-1763539720150
[2025-11-19T08:08:40.150Z] üìù Creating new entry for key: register:test-format-allowed-1763539720150
[2025-11-19T08:08:40.151Z] Current count after filter: 0
[2025-11-19T08:08:40.151Z] Max requests allowed: 3
[2025-11-19T08:08:40.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.151Z] New count: 1
[2025-11-19T08:08:40.151Z] Remaining: 2
[2025-11-19T08:08:40.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.151Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] üìù Creating new entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.151Z] Current count after filter: 0
[2025-11-19T08:08:40.151Z] Max requests allowed: 3
[2025-11-19T08:08:40.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.152Z] New count: 1
[2025-11-19T08:08:40.152Z] Remaining: 2
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.152Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.152Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.152Z] Existing timestamps: 1
[2025-11-19T08:08:40.152Z] Current count after filter: 1
[2025-11-19T08:08:40.152Z] Max requests allowed: 3
[2025-11-19T08:08:40.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.152Z] New count: 2
[2025-11-19T08:08:40.152Z] Remaining: 1
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.152Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.153Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Existing timestamps: 2
[2025-11-19T08:08:40.153Z] Current count after filter: 2
[2025-11-19T08:08:40.153Z] Max requests allowed: 3
[2025-11-19T08:08:40.153Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:08:40.153Z] New count: 3
[2025-11-19T08:08:40.153Z] Remaining: 0
[2025-11-19T08:08:40.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:08:40.153Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:08:40.153Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:08:40.153Z] Identifier: test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] üìñ Found existing entry for key: register:test-format-blocked-1763539720151
[2025-11-19T08:08:40.153Z] Existing timestamps: 3
[2025-11-19T08:08:40.153Z] Current count after filter: 3
[2025-11-19T08:08:40.153Z] Max requests allowed: 3
[2025-11-19T08:08:40.153Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:08:40.153Z] Current count: 3
[2025-11-19T08:08:40.153Z] Max allowed: 3
[2025-11-19T08:08:40.154Z] Retry after (seconds): 60
[2025-11-19T08:08:40.154Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.094Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.095Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.095Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.095Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.095Z] üìù Creating new entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.095Z] Current count after filter: 0
[2025-11-19T08:10:08.095Z] Max requests allowed: 5
[2025-11-19T08:10:08.095Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.095Z] New count: 1
[2025-11-19T08:10:08.096Z] Remaining: 4
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.096Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.096Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.096Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.096Z] Existing timestamps: 1
[2025-11-19T08:10:08.096Z] Current count after filter: 1
[2025-11-19T08:10:08.096Z] Max requests allowed: 5
[2025-11-19T08:10:08.096Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.096Z] New count: 2
[2025-11-19T08:10:08.096Z] Remaining: 3
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.096Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.096Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.096Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 2
[2025-11-19T08:10:08.097Z] Current count after filter: 2
[2025-11-19T08:10:08.097Z] Max requests allowed: 5
[2025-11-19T08:10:08.097Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.097Z] New count: 3
[2025-11-19T08:10:08.097Z] Remaining: 2
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.097Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.097Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 3
[2025-11-19T08:10:08.097Z] Current count after filter: 3
[2025-11-19T08:10:08.097Z] Max requests allowed: 5
[2025-11-19T08:10:08.097Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.097Z] New count: 4
[2025-11-19T08:10:08.097Z] Remaining: 1
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.097Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.097Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.097Z] Identifier: test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] üìñ Found existing entry for key: login:test-allow-1763539808094
[2025-11-19T08:10:08.097Z] Existing timestamps: 4
[2025-11-19T08:10:08.098Z] Current count after filter: 4
[2025-11-19T08:10:08.098Z] Max requests allowed: 5
[2025-11-19T08:10:08.098Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.098Z] New count: 5
[2025-11-19T08:10:08.098Z] Remaining: 0
[2025-11-19T08:10:08.098Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.098Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.098Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.098Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìù Creating new entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Current count after filter: 0
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 1
[2025-11-19T08:10:08.099Z] Remaining: 4
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Existing timestamps: 1
[2025-11-19T08:10:08.099Z] Current count after filter: 1
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 2
[2025-11-19T08:10:08.099Z] Remaining: 3
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.099Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.099Z] Existing timestamps: 2
[2025-11-19T08:10:08.099Z] Current count after filter: 2
[2025-11-19T08:10:08.099Z] Max requests allowed: 5
[2025-11-19T08:10:08.099Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.099Z] New count: 3
[2025-11-19T08:10:08.099Z] Remaining: 2
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.099Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.099Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.099Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 3
[2025-11-19T08:10:08.100Z] Current count after filter: 3
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.100Z] New count: 4
[2025-11-19T08:10:08.100Z] Remaining: 1
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.100Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.100Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 4
[2025-11-19T08:10:08.100Z] Current count after filter: 4
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.100Z] New count: 5
[2025-11-19T08:10:08.100Z] Remaining: 0
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.100Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.100Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.100Z] Identifier: test-block-1763539808098
[2025-11-19T08:10:08.100Z] Key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] üìñ Found existing entry for key: login:test-block-1763539808098
[2025-11-19T08:10:08.100Z] Existing timestamps: 5
[2025-11-19T08:10:08.100Z] Current count after filter: 5
[2025-11-19T08:10:08.100Z] Max requests allowed: 5
[2025-11-19T08:10:08.100Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.101Z] Current count: 5
[2025-11-19T08:10:08.101Z] Max allowed: 5
[2025-11-19T08:10:08.101Z] Retry after (seconds): 60
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.101Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.101Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.101Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.101Z] üìù Creating new entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.101Z] Current count after filter: 0
[2025-11-19T08:10:08.101Z] Max requests allowed: 2
[2025-11-19T08:10:08.101Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.101Z] New count: 1
[2025-11-19T08:10:08.101Z] Remaining: 1
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.101Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.101Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Existing timestamps: 1
[2025-11-19T08:10:08.102Z] Current count after filter: 1
[2025-11-19T08:10:08.102Z] Max requests allowed: 2
[2025-11-19T08:10:08.102Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.102Z] New count: 2
[2025-11-19T08:10:08.102Z] Remaining: 0
[2025-11-19T08:10:08.102Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.102Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.102Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.102Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.102Z] Existing timestamps: 2
[2025-11-19T08:10:08.102Z] Current count after filter: 2
[2025-11-19T08:10:08.102Z] Max requests allowed: 2
[2025-11-19T08:10:08.102Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.102Z] Current count: 2
[2025-11-19T08:10:08.102Z] Max allowed: 2
[2025-11-19T08:10:08.103Z] Retry after (seconds): 1
[2025-11-19T08:10:08.103Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.254Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:10:08.254Z] Identifier: test-reset-1763539808101
[2025-11-19T08:10:08.254Z] Key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.254Z] üìñ Found existing entry for key: test-reset:test-reset-1763539808101
[2025-11-19T08:10:08.254Z] Existing timestamps: 2
[2025-11-19T08:10:08.254Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:10:08.254Z] Current count after filter: 0
[2025-11-19T08:10:08.254Z] Max requests allowed: 2
[2025-11-19T08:10:08.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.255Z] New count: 1
[2025-11-19T08:10:08.255Z] Remaining: 1
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.255Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] üìù Creating new entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.255Z] Current count after filter: 0
[2025-11-19T08:10:08.255Z] Max requests allowed: 5
[2025-11-19T08:10:08.255Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.255Z] New count: 1
[2025-11-19T08:10:08.255Z] Remaining: 4
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.255Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.255Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.255Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Existing timestamps: 1
[2025-11-19T08:10:08.256Z] Current count after filter: 1
[2025-11-19T08:10:08.256Z] Max requests allowed: 5
[2025-11-19T08:10:08.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.256Z] New count: 2
[2025-11-19T08:10:08.256Z] Remaining: 3
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.256Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Existing timestamps: 2
[2025-11-19T08:10:08.256Z] Current count after filter: 2
[2025-11-19T08:10:08.256Z] Max requests allowed: 5
[2025-11-19T08:10:08.256Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.256Z] New count: 3
[2025-11-19T08:10:08.256Z] Remaining: 2
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.256Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.256Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.256Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.256Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 3
[2025-11-19T08:10:08.257Z] Current count after filter: 3
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.257Z] New count: 4
[2025-11-19T08:10:08.257Z] Remaining: 1
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.257Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.257Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 4
[2025-11-19T08:10:08.257Z] Current count after filter: 4
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.257Z] New count: 5
[2025-11-19T08:10:08.257Z] Remaining: 0
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.257Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.257Z] Identifier: test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] üìñ Found existing entry for key: login:test-multi-1-1763539808255
[2025-11-19T08:10:08.257Z] Existing timestamps: 5
[2025-11-19T08:10:08.257Z] Current count after filter: 5
[2025-11-19T08:10:08.257Z] Max requests allowed: 5
[2025-11-19T08:10:08.257Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.257Z] Current count: 5
[2025-11-19T08:10:08.257Z] Max allowed: 5
[2025-11-19T08:10:08.257Z] Retry after (seconds): 60
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:10:08.257Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.258Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.258Z] Identifier: test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] Key: login:test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] üìù Creating new entry for key: login:test-multi-2-1763539808255
[2025-11-19T08:10:08.258Z] Current count after filter: 0
[2025-11-19T08:10:08.258Z] Max requests allowed: 5
[2025-11-19T08:10:08.258Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.258Z] New count: 1
[2025-11-19T08:10:08.258Z] Remaining: 4
[2025-11-19T08:10:08.258Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.259Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.259Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:10:08.259Z] Identifier: test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] Key: login:test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] üìù Creating new entry for key: login:test-reset-time-1763539808259
[2025-11-19T08:10:08.259Z] Current count after filter: 0
[2025-11-19T08:10:08.259Z] Max requests allowed: 5
[2025-11-19T08:10:08.259Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.259Z] New count: 1
[2025-11-19T08:10:08.259Z] Remaining: 4
[2025-11-19T08:10:08.259Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.261Z] X-Test-ID header: null
[2025-11-19T08:10:08.261Z] Will use test ID?: false
[2025-11-19T08:10:08.261Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.261Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.261Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.261Z] X-Test-ID header: null
[2025-11-19T08:10:08.261Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] Using real IP: 192.168.1.2
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.262Z] X-Test-ID header: null
[2025-11-19T08:10:08.262Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.262Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.262Z] X-Test-ID header: null
[2025-11-19T08:10:08.262Z] Will use test ID?: false
[2025-11-19T08:10:08.262Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:10:08.262Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.263Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (env): true
[2025-11-19T08:10:08.263Z] E2E_TEST_MODE (final): true
[2025-11-19T08:10:08.263Z] X-Test-ID header: null
[2025-11-19T08:10:08.263Z] Will use test ID?: false
[2025-11-19T08:10:08.263Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:10:08.263Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:10:08.263Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.263Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.263Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.263Z] Current count after filter: 0
[2025-11-19T08:10:08.263Z] Max requests allowed: 3
[2025-11-19T08:10:08.263Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.263Z] New count: 1
[2025-11-19T08:10:08.263Z] Remaining: 2
[2025-11-19T08:10:08.263Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.364Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.365Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.365Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.365Z] Existing timestamps: 1
[2025-11-19T08:10:08.365Z] Current count after filter: 1
[2025-11-19T08:10:08.365Z] Max requests allowed: 3
[2025-11-19T08:10:08.365Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.365Z] New count: 2
[2025-11-19T08:10:08.365Z] Remaining: 1
[2025-11-19T08:10:08.365Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.467Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.467Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:10:08.467Z] Identifier: test-sliding-1763539808263
[2025-11-19T08:10:08.467Z] Key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.467Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539808263
[2025-11-19T08:10:08.468Z] Existing timestamps: 2
[2025-11-19T08:10:08.468Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:10:08.468Z] Current count after filter: 1
[2025-11-19T08:10:08.468Z] Max requests allowed: 3
[2025-11-19T08:10:08.469Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.469Z] New count: 2
[2025-11-19T08:10:08.469Z] Remaining: 1
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.469Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.469Z] Identifier: test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] Key: register:test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] üìù Creating new entry for key: register:test-format-allowed-1763539808469
[2025-11-19T08:10:08.469Z] Current count after filter: 0
[2025-11-19T08:10:08.469Z] Max requests allowed: 3
[2025-11-19T08:10:08.469Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.469Z] New count: 1
[2025-11-19T08:10:08.469Z] Remaining: 2
[2025-11-19T08:10:08.469Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.470Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.470Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] üìù Creating new entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.470Z] Current count after filter: 0
[2025-11-19T08:10:08.470Z] Max requests allowed: 3
[2025-11-19T08:10:08.470Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.470Z] New count: 1
[2025-11-19T08:10:08.470Z] Remaining: 2
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.470Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.470Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.470Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Existing timestamps: 1
[2025-11-19T08:10:08.471Z] Current count after filter: 1
[2025-11-19T08:10:08.471Z] Max requests allowed: 3
[2025-11-19T08:10:08.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.471Z] New count: 2
[2025-11-19T08:10:08.471Z] Remaining: 1
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.471Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.471Z] Existing timestamps: 2
[2025-11-19T08:10:08.471Z] Current count after filter: 2
[2025-11-19T08:10:08.471Z] Max requests allowed: 3
[2025-11-19T08:10:08.471Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:10:08.471Z] New count: 3
[2025-11-19T08:10:08.471Z] Remaining: 0
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:10:08.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:10:08.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:10:08.472Z] Identifier: test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] Key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] üìñ Found existing entry for key: register:test-format-blocked-1763539808470
[2025-11-19T08:10:08.472Z] Existing timestamps: 3
[2025-11-19T08:10:08.472Z] Current count after filter: 3
[2025-11-19T08:10:08.472Z] Max requests allowed: 3
[2025-11-19T08:10:08.472Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:10:08.472Z] Current count: 3
[2025-11-19T08:10:08.472Z] Max allowed: 3
[2025-11-19T08:10:08.472Z] Retry after (seconds): 60
[2025-11-19T08:10:08.472Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.759Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.760Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.761Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] üìù Creating new entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Current count after filter: 0
[2025-11-19T08:12:12.761Z] Max requests allowed: 5
[2025-11-19T08:12:12.761Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.761Z] New count: 1
[2025-11-19T08:12:12.761Z] Remaining: 4
[2025-11-19T08:12:12.761Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.761Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.761Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.761Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.761Z] Existing timestamps: 1
[2025-11-19T08:12:12.762Z] Current count after filter: 1
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 2
[2025-11-19T08:12:12.762Z] Remaining: 3
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.762Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Existing timestamps: 2
[2025-11-19T08:12:12.762Z] Current count after filter: 2
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 3
[2025-11-19T08:12:12.762Z] Remaining: 2
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.762Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.762Z] Existing timestamps: 3
[2025-11-19T08:12:12.762Z] Current count after filter: 3
[2025-11-19T08:12:12.762Z] Max requests allowed: 5
[2025-11-19T08:12:12.762Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.762Z] New count: 4
[2025-11-19T08:12:12.762Z] Remaining: 1
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.762Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.762Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.763Z] Identifier: test-allow-1763539932759
[2025-11-19T08:12:12.763Z] Key: login:test-allow-1763539932759
[2025-11-19T08:12:12.763Z] üìñ Found existing entry for key: login:test-allow-1763539932759
[2025-11-19T08:12:12.763Z] Existing timestamps: 4
[2025-11-19T08:12:12.763Z] Current count after filter: 4
[2025-11-19T08:12:12.763Z] Max requests allowed: 5
[2025-11-19T08:12:12.763Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.763Z] New count: 5
[2025-11-19T08:12:12.763Z] Remaining: 0
[2025-11-19T08:12:12.763Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.763Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.763Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.763Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìù Creating new entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Current count after filter: 0
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.764Z] New count: 1
[2025-11-19T08:12:12.764Z] Remaining: 4
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.764Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.764Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Existing timestamps: 1
[2025-11-19T08:12:12.764Z] Current count after filter: 1
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.764Z] New count: 2
[2025-11-19T08:12:12.764Z] Remaining: 3
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.764Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.764Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.764Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.764Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.764Z] Existing timestamps: 2
[2025-11-19T08:12:12.764Z] Current count after filter: 2
[2025-11-19T08:12:12.764Z] Max requests allowed: 5
[2025-11-19T08:12:12.764Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 3
[2025-11-19T08:12:12.765Z] Remaining: 2
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.765Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.765Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] Existing timestamps: 3
[2025-11-19T08:12:12.765Z] Current count after filter: 3
[2025-11-19T08:12:12.765Z] Max requests allowed: 5
[2025-11-19T08:12:12.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 4
[2025-11-19T08:12:12.765Z] Remaining: 1
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.765Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.765Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.765Z] Existing timestamps: 4
[2025-11-19T08:12:12.765Z] Current count after filter: 4
[2025-11-19T08:12:12.765Z] Max requests allowed: 5
[2025-11-19T08:12:12.765Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.765Z] New count: 5
[2025-11-19T08:12:12.765Z] Remaining: 0
[2025-11-19T08:12:12.765Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.766Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.766Z] Identifier: test-block-1763539932763
[2025-11-19T08:12:12.766Z] Key: login:test-block-1763539932763
[2025-11-19T08:12:12.766Z] üìñ Found existing entry for key: login:test-block-1763539932763
[2025-11-19T08:12:12.766Z] Existing timestamps: 5
[2025-11-19T08:12:12.766Z] Current count after filter: 5
[2025-11-19T08:12:12.766Z] Max requests allowed: 5
[2025-11-19T08:12:12.766Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.766Z] Current count: 5
[2025-11-19T08:12:12.766Z] Max allowed: 5
[2025-11-19T08:12:12.766Z] Retry after (seconds): 60
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìù Creating new entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Current count after filter: 0
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.767Z] New count: 1
[2025-11-19T08:12:12.767Z] Remaining: 1
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Existing timestamps: 1
[2025-11-19T08:12:12.767Z] Current count after filter: 1
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.767Z] New count: 2
[2025-11-19T08:12:12.767Z] Remaining: 0
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.767Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.767Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.767Z] Existing timestamps: 2
[2025-11-19T08:12:12.767Z] Current count after filter: 2
[2025-11-19T08:12:12.767Z] Max requests allowed: 2
[2025-11-19T08:12:12.767Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.767Z] Current count: 2
[2025-11-19T08:12:12.767Z] Max allowed: 2
[2025-11-19T08:12:12.768Z] Retry after (seconds): 1
[2025-11-19T08:12:12.768Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.919Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.919Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:12:12.919Z] Identifier: test-reset-1763539932766
[2025-11-19T08:12:12.919Z] Key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.919Z] üìñ Found existing entry for key: test-reset:test-reset-1763539932766
[2025-11-19T08:12:12.920Z] Existing timestamps: 2
[2025-11-19T08:12:12.920Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:12:12.920Z] Current count after filter: 0
[2025-11-19T08:12:12.920Z] Max requests allowed: 2
[2025-11-19T08:12:12.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.920Z] New count: 1
[2025-11-19T08:12:12.920Z] Remaining: 1
[2025-11-19T08:12:12.920Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.920Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.920Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.920Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] üìù Creating new entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.920Z] Current count after filter: 0
[2025-11-19T08:12:12.920Z] Max requests allowed: 5
[2025-11-19T08:12:12.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.921Z] New count: 1
[2025-11-19T08:12:12.921Z] Remaining: 4
[2025-11-19T08:12:12.921Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.921Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.921Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.921Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.921Z] Existing timestamps: 1
[2025-11-19T08:12:12.921Z] Current count after filter: 1
[2025-11-19T08:12:12.921Z] Max requests allowed: 5
[2025-11-19T08:12:12.921Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.921Z] New count: 2
[2025-11-19T08:12:12.922Z] Remaining: 3
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.922Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.922Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Existing timestamps: 2
[2025-11-19T08:12:12.922Z] Current count after filter: 2
[2025-11-19T08:12:12.922Z] Max requests allowed: 5
[2025-11-19T08:12:12.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.922Z] New count: 3
[2025-11-19T08:12:12.922Z] Remaining: 2
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.922Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.922Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.922Z] Existing timestamps: 3
[2025-11-19T08:12:12.922Z] Current count after filter: 3
[2025-11-19T08:12:12.922Z] Max requests allowed: 5
[2025-11-19T08:12:12.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.922Z] New count: 4
[2025-11-19T08:12:12.923Z] Remaining: 1
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.923Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.923Z] Existing timestamps: 4
[2025-11-19T08:12:12.923Z] Current count after filter: 4
[2025-11-19T08:12:12.923Z] Max requests allowed: 5
[2025-11-19T08:12:12.923Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.923Z] New count: 5
[2025-11-19T08:12:12.923Z] Remaining: 0
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.923Z] Identifier: test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] Key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] üìñ Found existing entry for key: login:test-multi-1-1763539932920
[2025-11-19T08:12:12.924Z] Existing timestamps: 5
[2025-11-19T08:12:12.924Z] Current count after filter: 5
[2025-11-19T08:12:12.924Z] Max requests allowed: 5
[2025-11-19T08:12:12.924Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:12.924Z] Current count: 5
[2025-11-19T08:12:12.924Z] Max allowed: 5
[2025-11-19T08:12:12.924Z] Retry after (seconds): 60
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.924Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.924Z] Identifier: test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] Key: login:test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] üìù Creating new entry for key: login:test-multi-2-1763539932920
[2025-11-19T08:12:12.924Z] Current count after filter: 0
[2025-11-19T08:12:12.924Z] Max requests allowed: 5
[2025-11-19T08:12:12.924Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.924Z] New count: 1
[2025-11-19T08:12:12.924Z] Remaining: 4
[2025-11-19T08:12:12.924Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.925Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.925Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:12:12.925Z] Identifier: test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] Key: login:test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] üìù Creating new entry for key: login:test-reset-time-1763539932925
[2025-11-19T08:12:12.925Z] Current count after filter: 0
[2025-11-19T08:12:12.925Z] Max requests allowed: 5
[2025-11-19T08:12:12.925Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.925Z] New count: 1
[2025-11-19T08:12:12.925Z] Remaining: 4
[2025-11-19T08:12:12.925Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.926Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.926Z] X-Test-ID header: null
[2025-11-19T08:12:12.926Z] Will use test ID?: false
[2025-11-19T08:12:12.926Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.927Z] X-Test-ID header: null
[2025-11-19T08:12:12.927Z] Will use test ID?: false
[2025-11-19T08:12:12.927Z] Using real IP: 192.168.1.2
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.927Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.927Z] X-Test-ID header: null
[2025-11-19T08:12:12.927Z] Will use test ID?: false
[2025-11-19T08:12:12.927Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.928Z] X-Test-ID header: null
[2025-11-19T08:12:12.928Z] Will use test ID?: false
[2025-11-19T08:12:12.928Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (env): true
[2025-11-19T08:12:12.928Z] E2E_TEST_MODE (final): true
[2025-11-19T08:12:12.928Z] X-Test-ID header: null
[2025-11-19T08:12:12.928Z] Will use test ID?: false
[2025-11-19T08:12:12.928Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:12:12.928Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:12:12.928Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:12.928Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:12.928Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] üìù Creating new entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:12.929Z] Current count after filter: 0
[2025-11-19T08:12:12.929Z] Max requests allowed: 3
[2025-11-19T08:12:12.929Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:12.929Z] New count: 1
[2025-11-19T08:12:12.929Z] Remaining: 2
[2025-11-19T08:12:12.929Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.030Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.030Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:13.030Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:13.030Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.031Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.031Z] Existing timestamps: 1
[2025-11-19T08:12:13.031Z] Current count after filter: 1
[2025-11-19T08:12:13.031Z] Max requests allowed: 3
[2025-11-19T08:12:13.031Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.031Z] New count: 2
[2025-11-19T08:12:13.031Z] Remaining: 1
[2025-11-19T08:12:13.031Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.132Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.133Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:12:13.133Z] Identifier: test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] Key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763539932928
[2025-11-19T08:12:13.133Z] Existing timestamps: 2
[2025-11-19T08:12:13.133Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:12:13.133Z] Current count after filter: 1
[2025-11-19T08:12:13.133Z] Max requests allowed: 3
[2025-11-19T08:12:13.133Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.133Z] New count: 2
[2025-11-19T08:12:13.133Z] Remaining: 1
[2025-11-19T08:12:13.133Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.133Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.134Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.134Z] Identifier: test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] Key: register:test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] üìù Creating new entry for key: register:test-format-allowed-1763539933133
[2025-11-19T08:12:13.134Z] Current count after filter: 0
[2025-11-19T08:12:13.134Z] Max requests allowed: 3
[2025-11-19T08:12:13.134Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.134Z] New count: 1
[2025-11-19T08:12:13.134Z] Remaining: 2
[2025-11-19T08:12:13.134Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.135Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.135Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.135Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] üìù Creating new entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.135Z] Current count after filter: 0
[2025-11-19T08:12:13.136Z] Max requests allowed: 3
[2025-11-19T08:12:13.136Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.136Z] New count: 1
[2025-11-19T08:12:13.136Z] Remaining: 2
[2025-11-19T08:12:13.136Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.136Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.136Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.136Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.136Z] Existing timestamps: 1
[2025-11-19T08:12:13.136Z] Current count after filter: 1
[2025-11-19T08:12:13.136Z] Max requests allowed: 3
[2025-11-19T08:12:13.136Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.136Z] New count: 2
[2025-11-19T08:12:13.136Z] Remaining: 1
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.137Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.137Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.137Z] Existing timestamps: 2
[2025-11-19T08:12:13.137Z] Current count after filter: 2
[2025-11-19T08:12:13.137Z] Max requests allowed: 3
[2025-11-19T08:12:13.137Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:12:13.137Z] New count: 3
[2025-11-19T08:12:13.137Z] Remaining: 0
[2025-11-19T08:12:13.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:12:13.138Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:12:13.138Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:12:13.138Z] Identifier: test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] Key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] üìñ Found existing entry for key: register:test-format-blocked-1763539933135
[2025-11-19T08:12:13.138Z] Existing timestamps: 3
[2025-11-19T08:12:13.138Z] Current count after filter: 3
[2025-11-19T08:12:13.138Z] Max requests allowed: 3
[2025-11-19T08:12:13.138Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:12:13.138Z] Current count: 3
[2025-11-19T08:12:13.138Z] Max allowed: 3
[2025-11-19T08:12:13.138Z] Retry after (seconds): 60
[2025-11-19T08:12:13.138Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.657Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.658Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.658Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.658Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.658Z] üìù Creating new entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.658Z] Current count after filter: 0
[2025-11-19T08:43:39.658Z] Max requests allowed: 5
[2025-11-19T08:43:39.658Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.658Z] New count: 1
[2025-11-19T08:43:39.658Z] Remaining: 4
[2025-11-19T08:43:39.658Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.659Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.659Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Existing timestamps: 1
[2025-11-19T08:43:39.659Z] Current count after filter: 1
[2025-11-19T08:43:39.659Z] Max requests allowed: 5
[2025-11-19T08:43:39.659Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.659Z] New count: 2
[2025-11-19T08:43:39.659Z] Remaining: 3
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.659Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.659Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.659Z] Existing timestamps: 2
[2025-11-19T08:43:39.659Z] Current count after filter: 2
[2025-11-19T08:43:39.659Z] Max requests allowed: 5
[2025-11-19T08:43:39.659Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.659Z] New count: 3
[2025-11-19T08:43:39.659Z] Remaining: 2
[2025-11-19T08:43:39.659Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.660Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Existing timestamps: 3
[2025-11-19T08:43:39.660Z] Current count after filter: 3
[2025-11-19T08:43:39.660Z] Max requests allowed: 5
[2025-11-19T08:43:39.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.660Z] New count: 4
[2025-11-19T08:43:39.660Z] Remaining: 1
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.660Z] Identifier: test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] üìñ Found existing entry for key: login:test-allow-1763541819657
[2025-11-19T08:43:39.660Z] Existing timestamps: 4
[2025-11-19T08:43:39.660Z] Current count after filter: 4
[2025-11-19T08:43:39.660Z] Max requests allowed: 5
[2025-11-19T08:43:39.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.660Z] New count: 5
[2025-11-19T08:43:39.660Z] Remaining: 0
[2025-11-19T08:43:39.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.661Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.661Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.661Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.661Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.661Z] üìù Creating new entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.661Z] Current count after filter: 0
[2025-11-19T08:43:39.661Z] Max requests allowed: 5
[2025-11-19T08:43:39.661Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.661Z] New count: 1
[2025-11-19T08:43:39.662Z] Remaining: 4
[2025-11-19T08:43:39.662Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.662Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.662Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.662Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.662Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.662Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.662Z] Existing timestamps: 1
[2025-11-19T08:43:39.662Z] Current count after filter: 1
[2025-11-19T08:43:39.663Z] Max requests allowed: 5
[2025-11-19T08:43:39.663Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.663Z] New count: 2
[2025-11-19T08:43:39.663Z] Remaining: 3
[2025-11-19T08:43:39.663Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.663Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.663Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.663Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.663Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] Existing timestamps: 2
[2025-11-19T08:43:39.664Z] Current count after filter: 2
[2025-11-19T08:43:39.664Z] Max requests allowed: 5
[2025-11-19T08:43:39.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.664Z] New count: 3
[2025-11-19T08:43:39.664Z] Remaining: 2
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.664Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.664Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.664Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.664Z] Existing timestamps: 3
[2025-11-19T08:43:39.664Z] Current count after filter: 3
[2025-11-19T08:43:39.664Z] Max requests allowed: 5
[2025-11-19T08:43:39.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.664Z] New count: 4
[2025-11-19T08:43:39.664Z] Remaining: 1
[2025-11-19T08:43:39.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.665Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.665Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.665Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] Existing timestamps: 4
[2025-11-19T08:43:39.665Z] Current count after filter: 4
[2025-11-19T08:43:39.665Z] Max requests allowed: 5
[2025-11-19T08:43:39.665Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.665Z] New count: 5
[2025-11-19T08:43:39.665Z] Remaining: 0
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.665Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.665Z] Identifier: test-block-1763541819661
[2025-11-19T08:43:39.665Z] Key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] üìñ Found existing entry for key: login:test-block-1763541819661
[2025-11-19T08:43:39.665Z] Existing timestamps: 5
[2025-11-19T08:43:39.665Z] Current count after filter: 5
[2025-11-19T08:43:39.665Z] Max requests allowed: 5
[2025-11-19T08:43:39.665Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.665Z] Current count: 5
[2025-11-19T08:43:39.665Z] Max allowed: 5
[2025-11-19T08:43:39.665Z] Retry after (seconds): 60
[2025-11-19T08:43:39.665Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.666Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.666Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] üìù Creating new entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Current count after filter: 0
[2025-11-19T08:43:39.666Z] Max requests allowed: 2
[2025-11-19T08:43:39.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.666Z] New count: 1
[2025-11-19T08:43:39.666Z] Remaining: 1
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.666Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.666Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.666Z] Existing timestamps: 1
[2025-11-19T08:43:39.667Z] Current count after filter: 1
[2025-11-19T08:43:39.667Z] Max requests allowed: 2
[2025-11-19T08:43:39.667Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.667Z] New count: 2
[2025-11-19T08:43:39.667Z] Remaining: 0
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.667Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.667Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.667Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.667Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.667Z] Existing timestamps: 2
[2025-11-19T08:43:39.667Z] Current count after filter: 2
[2025-11-19T08:43:39.667Z] Max requests allowed: 2
[2025-11-19T08:43:39.667Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.667Z] Current count: 2
[2025-11-19T08:43:39.667Z] Max allowed: 2
[2025-11-19T08:43:39.667Z] Retry after (seconds): 1
[2025-11-19T08:43:39.667Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.819Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T08:43:39.819Z] Identifier: test-reset-1763541819666
[2025-11-19T08:43:39.819Z] Key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.819Z] üìñ Found existing entry for key: test-reset:test-reset-1763541819666
[2025-11-19T08:43:39.819Z] Existing timestamps: 2
[2025-11-19T08:43:39.819Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T08:43:39.819Z] Current count after filter: 0
[2025-11-19T08:43:39.819Z] Max requests allowed: 2
[2025-11-19T08:43:39.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.819Z] New count: 1
[2025-11-19T08:43:39.819Z] Remaining: 1
[2025-11-19T08:43:39.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.820Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] üìù Creating new entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Current count after filter: 0
[2025-11-19T08:43:39.820Z] Max requests allowed: 5
[2025-11-19T08:43:39.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.820Z] New count: 1
[2025-11-19T08:43:39.820Z] Remaining: 4
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.820Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.820Z] Existing timestamps: 1
[2025-11-19T08:43:39.820Z] Current count after filter: 1
[2025-11-19T08:43:39.820Z] Max requests allowed: 5
[2025-11-19T08:43:39.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.820Z] New count: 2
[2025-11-19T08:43:39.820Z] Remaining: 3
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.821Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.821Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Existing timestamps: 2
[2025-11-19T08:43:39.821Z] Current count after filter: 2
[2025-11-19T08:43:39.821Z] Max requests allowed: 5
[2025-11-19T08:43:39.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.821Z] New count: 3
[2025-11-19T08:43:39.821Z] Remaining: 2
[2025-11-19T08:43:39.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.821Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.821Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.821Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.821Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Existing timestamps: 3
[2025-11-19T08:43:39.822Z] Current count after filter: 3
[2025-11-19T08:43:39.822Z] Max requests allowed: 5
[2025-11-19T08:43:39.822Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.822Z] New count: 4
[2025-11-19T08:43:39.822Z] Remaining: 1
[2025-11-19T08:43:39.822Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.822Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.822Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.822Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.822Z] Existing timestamps: 4
[2025-11-19T08:43:39.823Z] Current count after filter: 4
[2025-11-19T08:43:39.823Z] Max requests allowed: 5
[2025-11-19T08:43:39.823Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.823Z] New count: 5
[2025-11-19T08:43:39.823Z] Remaining: 0
[2025-11-19T08:43:39.823Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.823Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.823Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.823Z] Identifier: test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] Key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] üìñ Found existing entry for key: login:test-multi-1-1763541819820
[2025-11-19T08:43:39.823Z] Existing timestamps: 5
[2025-11-19T08:43:39.824Z] Current count after filter: 5
[2025-11-19T08:43:39.824Z] Max requests allowed: 5
[2025-11-19T08:43:39.824Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:39.824Z] Current count: 5
[2025-11-19T08:43:39.824Z] Max allowed: 5
[2025-11-19T08:43:39.824Z] Retry after (seconds): 60
[2025-11-19T08:43:39.824Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T08:43:39.824Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.824Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.824Z] Identifier: test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] Key: login:test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] üìù Creating new entry for key: login:test-multi-2-1763541819820
[2025-11-19T08:43:39.824Z] Current count after filter: 0
[2025-11-19T08:43:39.825Z] Max requests allowed: 5
[2025-11-19T08:43:39.825Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.825Z] New count: 1
[2025-11-19T08:43:39.825Z] Remaining: 4
[2025-11-19T08:43:39.825Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.826Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.826Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T08:43:39.826Z] Identifier: test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] Key: login:test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] üìù Creating new entry for key: login:test-reset-time-1763541819826
[2025-11-19T08:43:39.826Z] Current count after filter: 0
[2025-11-19T08:43:39.827Z] Max requests allowed: 5
[2025-11-19T08:43:39.827Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.827Z] New count: 1
[2025-11-19T08:43:39.827Z] Remaining: 4
[2025-11-19T08:43:39.827Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.830Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.830Z] X-Test-ID header: null
[2025-11-19T08:43:39.830Z] Will use test ID?: false
[2025-11-19T08:43:39.830Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.830Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.831Z] X-Test-ID header: null
[2025-11-19T08:43:39.831Z] Will use test ID?: false
[2025-11-19T08:43:39.831Z] Using real IP: 192.168.1.2
[2025-11-19T08:43:39.831Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.831Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.831Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.831Z] X-Test-ID header: null
[2025-11-19T08:43:39.832Z] Will use test ID?: false
[2025-11-19T08:43:39.832Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.832Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.832Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.832Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.832Z] X-Test-ID header: null
[2025-11-19T08:43:39.832Z] Will use test ID?: false
[2025-11-19T08:43:39.835Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T08:43:39.836Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.836Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T08:43:39.836Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T08:43:39.837Z] E2E_TEST_MODE (env): true
[2025-11-19T08:43:39.837Z] E2E_TEST_MODE (final): true
[2025-11-19T08:43:39.837Z] X-Test-ID header: null
[2025-11-19T08:43:39.837Z] Will use test ID?: false
[2025-11-19T08:43:39.837Z] Using forwarded IP: 192.168.1.1
[2025-11-19T08:43:39.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T08:43:39.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.837Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:39.837Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] üìù Creating new entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.837Z] Current count after filter: 0
[2025-11-19T08:43:39.837Z] Max requests allowed: 3
[2025-11-19T08:43:39.837Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.837Z] New count: 1
[2025-11-19T08:43:39.837Z] Remaining: 2
[2025-11-19T08:43:39.837Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:39.938Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:39.938Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:39.938Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:39.938Z] Existing timestamps: 1
[2025-11-19T08:43:39.938Z] Current count after filter: 1
[2025-11-19T08:43:39.938Z] Max requests allowed: 3
[2025-11-19T08:43:39.939Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:39.939Z] New count: 2
[2025-11-19T08:43:39.939Z] Remaining: 1
[2025-11-19T08:43:39.939Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.040Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.040Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T08:43:40.040Z] Identifier: test-sliding-1763541819837
[2025-11-19T08:43:40.040Z] Key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:40.040Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763541819837
[2025-11-19T08:43:40.041Z] Existing timestamps: 2
[2025-11-19T08:43:40.041Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T08:43:40.041Z] Current count after filter: 1
[2025-11-19T08:43:40.041Z] Max requests allowed: 3
[2025-11-19T08:43:40.041Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.041Z] New count: 2
[2025-11-19T08:43:40.041Z] Remaining: 1
[2025-11-19T08:43:40.041Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.041Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.041Z] Identifier: test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] Key: register:test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] üìù Creating new entry for key: register:test-format-allowed-1763541820041
[2025-11-19T08:43:40.041Z] Current count after filter: 0
[2025-11-19T08:43:40.042Z] Max requests allowed: 3
[2025-11-19T08:43:40.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.042Z] New count: 1
[2025-11-19T08:43:40.042Z] Remaining: 2
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.042Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.042Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] üìù Creating new entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Current count after filter: 0
[2025-11-19T08:43:40.042Z] Max requests allowed: 3
[2025-11-19T08:43:40.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.042Z] New count: 1
[2025-11-19T08:43:40.042Z] Remaining: 2
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.042Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.042Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.042Z] Existing timestamps: 1
[2025-11-19T08:43:40.043Z] Current count after filter: 1
[2025-11-19T08:43:40.043Z] Max requests allowed: 3
[2025-11-19T08:43:40.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.043Z] New count: 2
[2025-11-19T08:43:40.043Z] Remaining: 1
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.043Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.043Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Existing timestamps: 2
[2025-11-19T08:43:40.043Z] Current count after filter: 2
[2025-11-19T08:43:40.043Z] Max requests allowed: 3
[2025-11-19T08:43:40.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T08:43:40.043Z] New count: 3
[2025-11-19T08:43:40.043Z] Remaining: 0
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T08:43:40.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T08:43:40.043Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T08:43:40.043Z] Identifier: test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] üìñ Found existing entry for key: register:test-format-blocked-1763541820042
[2025-11-19T08:43:40.043Z] Existing timestamps: 3
[2025-11-19T08:43:40.044Z] Current count after filter: 3
[2025-11-19T08:43:40.044Z] Max requests allowed: 3
[2025-11-19T08:43:40.044Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T08:43:40.044Z] Current count: 3
[2025-11-19T08:43:40.044Z] Max allowed: 3
[2025-11-19T08:43:40.044Z] Retry after (seconds): 60
[2025-11-19T08:43:40.044Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:25:12.648Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.649Z] Request URL: /auth/login
[2025-11-19T09:25:12.649Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.649Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.649Z] X-Test-ID header: null
[2025-11-19T09:25:12.649Z] Will use test ID?: false
[2025-11-19T09:25:12.649Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.649Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.649Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.649Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.649Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.649Z] Identifier: unknown
[2025-11-19T09:25:12.649Z] Key: login:unknown
[2025-11-19T09:25:12.649Z] üìù Creating new entry for key: login:unknown
[2025-11-19T09:25:12.649Z] Current count after filter: 0
[2025-11-19T09:25:12.649Z] Max requests allowed: 5
[2025-11-19T09:25:12.649Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.649Z] New count: 1
[2025-11-19T09:25:12.649Z] Remaining: 4
[2025-11-19T09:25:12.649Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.649Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.650Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.650Z] Request URL: /auth/login
[2025-11-19T09:25:12.650Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.650Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.650Z] X-Test-ID header: null
[2025-11-19T09:25:12.650Z] Will use test ID?: false
[2025-11-19T09:25:12.650Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.650Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.650Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.650Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.650Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.650Z] Identifier: unknown
[2025-11-19T09:25:12.650Z] Key: login:unknown
[2025-11-19T09:25:12.650Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.650Z] Existing timestamps: 1
[2025-11-19T09:25:12.651Z] Current count after filter: 1
[2025-11-19T09:25:12.651Z] Max requests allowed: 5
[2025-11-19T09:25:12.651Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.651Z] New count: 2
[2025-11-19T09:25:12.651Z] Remaining: 3
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.651Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.651Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.651Z] Request URL: /auth/login
[2025-11-19T09:25:12.651Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.651Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.651Z] X-Test-ID header: null
[2025-11-19T09:25:12.651Z] Will use test ID?: false
[2025-11-19T09:25:12.651Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.651Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.651Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.651Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.651Z] Identifier: unknown
[2025-11-19T09:25:12.651Z] Key: login:unknown
[2025-11-19T09:25:12.651Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.651Z] Existing timestamps: 2
[2025-11-19T09:25:12.651Z] Current count after filter: 2
[2025-11-19T09:25:12.651Z] Max requests allowed: 5
[2025-11-19T09:25:12.651Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.651Z] New count: 3
[2025-11-19T09:25:12.651Z] Remaining: 2
[2025-11-19T09:25:12.651Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.651Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763544372649
}
[2025-11-19T09:25:12.651Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:25:12.652Z] Request URL: /auth/login
[2025-11-19T09:25:12.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (env): true
[2025-11-19T09:25:12.652Z] E2E_TEST_MODE (final): true
[2025-11-19T09:25:12.652Z] X-Test-ID header: null
[2025-11-19T09:25:12.652Z] Will use test ID?: false
[2025-11-19T09:25:12.652Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:25:12.652Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:25:12.652Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:25:12.652Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:25:12.652Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:25:12.652Z] Identifier: unknown
[2025-11-19T09:25:12.652Z] Key: login:unknown
[2025-11-19T09:25:12.652Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:25:12.652Z] Existing timestamps: 3
[2025-11-19T09:25:12.652Z] Current count after filter: 3
[2025-11-19T09:25:12.652Z] Max requests allowed: 5
[2025-11-19T09:25:12.652Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:25:12.652Z] New count: 4
[2025-11-19T09:25:12.652Z] Remaining: 1
[2025-11-19T09:25:12.652Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:25:12.652Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763544372649
}
[2025-11-19T09:30:54.835Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.836Z] Request URL: /auth/login
[2025-11-19T09:30:54.836Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.836Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.836Z] X-Test-ID header: null
[2025-11-19T09:30:54.836Z] Will use test ID?: false
[2025-11-19T09:30:54.836Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.836Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.836Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.836Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.836Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.836Z] Identifier: unknown
[2025-11-19T09:30:54.836Z] Key: login:unknown
[2025-11-19T09:30:54.836Z] üìù Creating new entry for key: login:unknown
[2025-11-19T09:30:54.836Z] Current count after filter: 0
[2025-11-19T09:30:54.836Z] Max requests allowed: 5
[2025-11-19T09:30:54.836Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.836Z] New count: 1
[2025-11-19T09:30:54.836Z] Remaining: 4
[2025-11-19T09:30:54.836Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.836Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.837Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.837Z] Request URL: /auth/login
[2025-11-19T09:30:54.837Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.837Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.837Z] X-Test-ID header: null
[2025-11-19T09:30:54.837Z] Will use test ID?: false
[2025-11-19T09:30:54.837Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.837Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.837Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.837Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.837Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.837Z] Identifier: unknown
[2025-11-19T09:30:54.838Z] Key: login:unknown
[2025-11-19T09:30:54.838Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.838Z] Existing timestamps: 1
[2025-11-19T09:30:54.838Z] Current count after filter: 1
[2025-11-19T09:30:54.838Z] Max requests allowed: 5
[2025-11-19T09:30:54.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.838Z] New count: 2
[2025-11-19T09:30:54.838Z] Remaining: 3
[2025-11-19T09:30:54.838Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.838Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.838Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.838Z] Request URL: /auth/login
[2025-11-19T09:30:54.838Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.838Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.838Z] X-Test-ID header: null
[2025-11-19T09:30:54.838Z] Will use test ID?: false
[2025-11-19T09:30:54.838Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.838Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.838Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.838Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.838Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.838Z] Identifier: unknown
[2025-11-19T09:30:54.838Z] Key: login:unknown
[2025-11-19T09:30:54.838Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.838Z] Existing timestamps: 2
[2025-11-19T09:30:54.838Z] Current count after filter: 2
[2025-11-19T09:30:54.838Z] Max requests allowed: 5
[2025-11-19T09:30:54.838Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.838Z] New count: 3
[2025-11-19T09:30:54.838Z] Remaining: 2
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.839Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763544714836
}
[2025-11-19T09:30:54.839Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-19T09:30:54.839Z] Request URL: /auth/login
[2025-11-19T09:30:54.839Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (env): true
[2025-11-19T09:30:54.839Z] E2E_TEST_MODE (final): true
[2025-11-19T09:30:54.839Z] X-Test-ID header: null
[2025-11-19T09:30:54.839Z] Will use test ID?: false
[2025-11-19T09:30:54.839Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:30:54.839Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:30:54.839Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:30:54.839Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:30:54.839Z] Identifier: unknown
[2025-11-19T09:30:54.839Z] Key: login:unknown
[2025-11-19T09:30:54.839Z] üìñ Found existing entry for key: login:unknown
[2025-11-19T09:30:54.839Z] Existing timestamps: 3
[2025-11-19T09:30:54.839Z] Current count after filter: 3
[2025-11-19T09:30:54.839Z] Max requests allowed: 5
[2025-11-19T09:30:54.839Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:30:54.839Z] New count: 4
[2025-11-19T09:30:54.839Z] Remaining: 1
[2025-11-19T09:30:54.839Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:30:54.839Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763544714836
}
[2025-11-19T09:31:02.420Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.420Z] Request URL: /auth/token
[2025-11-19T09:31:02.421Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.421Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.421Z] X-Test-ID header: null
[2025-11-19T09:31:02.421Z] Will use test ID?: false
[2025-11-19T09:31:02.421Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.421Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.421Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.421Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.421Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.421Z] Identifier: unknown
[2025-11-19T09:31:02.421Z] Key: token:unknown
[2025-11-19T09:31:02.421Z] üìù Creating new entry for key: token:unknown
[2025-11-19T09:31:02.421Z] Current count after filter: 0
[2025-11-19T09:31:02.421Z] Max requests allowed: 60
[2025-11-19T09:31:02.421Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.422Z] New count: 1
[2025-11-19T09:31:02.422Z] Remaining: 59
[2025-11-19T09:31:02.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.422Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.422Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.422Z] Request URL: /auth/token
[2025-11-19T09:31:02.422Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.423Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.423Z] X-Test-ID header: null
[2025-11-19T09:31:02.423Z] Will use test ID?: false
[2025-11-19T09:31:02.423Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.423Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.423Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.423Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.423Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.423Z] Identifier: unknown
[2025-11-19T09:31:02.423Z] Key: token:unknown
[2025-11-19T09:31:02.423Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.423Z] Existing timestamps: 1
[2025-11-19T09:31:02.423Z] Current count after filter: 1
[2025-11-19T09:31:02.423Z] Max requests allowed: 60
[2025-11-19T09:31:02.423Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.423Z] New count: 2
[2025-11-19T09:31:02.423Z] Remaining: 58
[2025-11-19T09:31:02.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.423Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.451Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.451Z] Request URL: /auth/token
[2025-11-19T09:31:02.451Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.451Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.451Z] X-Test-ID header: null
[2025-11-19T09:31:02.451Z] Will use test ID?: false
[2025-11-19T09:31:02.451Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.451Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.451Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.451Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.451Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.451Z] Identifier: unknown
[2025-11-19T09:31:02.451Z] Key: token:unknown
[2025-11-19T09:31:02.451Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.451Z] Existing timestamps: 2
[2025-11-19T09:31:02.451Z] Current count after filter: 2
[2025-11-19T09:31:02.451Z] Max requests allowed: 60
[2025-11-19T09:31:02.451Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.451Z] New count: 3
[2025-11-19T09:31:02.451Z] Remaining: 57
[2025-11-19T09:31:02.451Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.451Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:02.485Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:02.485Z] Request URL: /auth/token
[2025-11-19T09:31:02.485Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:02.485Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:02.485Z] X-Test-ID header: null
[2025-11-19T09:31:02.485Z] Will use test ID?: false
[2025-11-19T09:31:02.485Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:02.485Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:02.485Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:02.485Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:02.485Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:02.486Z] Identifier: unknown
[2025-11-19T09:31:02.486Z] Key: token:unknown
[2025-11-19T09:31:02.486Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:02.486Z] Existing timestamps: 3
[2025-11-19T09:31:02.486Z] Current count after filter: 3
[2025-11-19T09:31:02.486Z] Max requests allowed: 60
[2025-11-19T09:31:02.486Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:02.486Z] New count: 4
[2025-11-19T09:31:02.486Z] Remaining: 56
[2025-11-19T09:31:02.486Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:02.486Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.198Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.198Z] Request URL: /auth/token
[2025-11-19T09:31:03.198Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.198Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.198Z] X-Test-ID header: null
[2025-11-19T09:31:03.198Z] Will use test ID?: false
[2025-11-19T09:31:03.199Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.199Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.199Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.199Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.199Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.199Z] Identifier: unknown
[2025-11-19T09:31:03.199Z] Key: token:unknown
[2025-11-19T09:31:03.199Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.199Z] Existing timestamps: 4
[2025-11-19T09:31:03.199Z] Current count after filter: 4
[2025-11-19T09:31:03.199Z] Max requests allowed: 60
[2025-11-19T09:31:03.199Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.199Z] New count: 5
[2025-11-19T09:31:03.199Z] Remaining: 55
[2025-11-19T09:31:03.199Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.199Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.203Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.203Z] Request URL: /auth/token
[2025-11-19T09:31:03.203Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.203Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.203Z] X-Test-ID header: null
[2025-11-19T09:31:03.203Z] Will use test ID?: false
[2025-11-19T09:31:03.203Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.203Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.203Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.203Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.203Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.203Z] Identifier: unknown
[2025-11-19T09:31:03.203Z] Key: token:unknown
[2025-11-19T09:31:03.203Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.203Z] Existing timestamps: 5
[2025-11-19T09:31:03.203Z] Current count after filter: 5
[2025-11-19T09:31:03.204Z] Max requests allowed: 60
[2025-11-19T09:31:03.204Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.204Z] New count: 6
[2025-11-19T09:31:03.204Z] Remaining: 54
[2025-11-19T09:31:03.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.204Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.225Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.226Z] Request URL: /auth/token
[2025-11-19T09:31:03.226Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.226Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.226Z] X-Test-ID header: null
[2025-11-19T09:31:03.226Z] Will use test ID?: false
[2025-11-19T09:31:03.226Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.226Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.226Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.226Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.226Z] Identifier: unknown
[2025-11-19T09:31:03.226Z] Key: token:unknown
[2025-11-19T09:31:03.226Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.226Z] Existing timestamps: 6
[2025-11-19T09:31:03.226Z] Current count after filter: 6
[2025-11-19T09:31:03.226Z] Max requests allowed: 60
[2025-11-19T09:31:03.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.226Z] New count: 7
[2025-11-19T09:31:03.226Z] Remaining: 53
[2025-11-19T09:31:03.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.226Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:03.231Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:03.231Z] Request URL: /auth/token
[2025-11-19T09:31:03.231Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:03.231Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:03.231Z] X-Test-ID header: null
[2025-11-19T09:31:03.231Z] Will use test ID?: false
[2025-11-19T09:31:03.231Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:03.231Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:03.231Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:03.231Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:03.231Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:03.232Z] Identifier: unknown
[2025-11-19T09:31:03.232Z] Key: token:unknown
[2025-11-19T09:31:03.232Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:03.232Z] Existing timestamps: 7
[2025-11-19T09:31:03.232Z] Current count after filter: 7
[2025-11-19T09:31:03.232Z] Max requests allowed: 60
[2025-11-19T09:31:03.232Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:03.232Z] New count: 8
[2025-11-19T09:31:03.232Z] Remaining: 52
[2025-11-19T09:31:03.232Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:03.232Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:07.955Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:07.955Z] Request URL: /auth/token
[2025-11-19T09:31:07.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:07.956Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:07.956Z] X-Test-ID header: null
[2025-11-19T09:31:07.956Z] Will use test ID?: false
[2025-11-19T09:31:07.956Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:07.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:07.956Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:07.956Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:07.956Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:07.956Z] Identifier: unknown
[2025-11-19T09:31:07.956Z] Key: token:unknown
[2025-11-19T09:31:07.956Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:07.956Z] Existing timestamps: 8
[2025-11-19T09:31:07.956Z] Current count after filter: 8
[2025-11-19T09:31:07.956Z] Max requests allowed: 60
[2025-11-19T09:31:07.956Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:07.956Z] New count: 9
[2025-11-19T09:31:07.956Z] Remaining: 51
[2025-11-19T09:31:07.956Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:07.956Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763544722421
}
[2025-11-19T09:31:08.784Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:31:08.784Z] Request URL: /auth/token
[2025-11-19T09:31:08.785Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (env): true
[2025-11-19T09:31:08.785Z] E2E_TEST_MODE (final): true
[2025-11-19T09:31:08.785Z] X-Test-ID header: null
[2025-11-19T09:31:08.785Z] Will use test ID?: false
[2025-11-19T09:31:08.785Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:31:08.785Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:31:08.785Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:31:08.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:31:08.785Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:31:08.785Z] Identifier: unknown
[2025-11-19T09:31:08.785Z] Key: token:unknown
[2025-11-19T09:31:08.785Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:31:08.786Z] Existing timestamps: 9
[2025-11-19T09:31:08.786Z] Current count after filter: 9
[2025-11-19T09:31:08.786Z] Max requests allowed: 60
[2025-11-19T09:31:08.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:31:08.786Z] New count: 10
[2025-11-19T09:31:08.786Z] Remaining: 50
[2025-11-19T09:31:08.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:31:08.786Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763544722421
}
[2025-11-19T09:32:06.852Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.853Z] Request URL: /auth/token
[2025-11-19T09:32:06.853Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.853Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.853Z] X-Test-ID header: null
[2025-11-19T09:32:06.853Z] Will use test ID?: false
[2025-11-19T09:32:06.853Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.853Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.853Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.853Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.853Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.853Z] Identifier: unknown
[2025-11-19T09:32:06.853Z] Key: token:unknown
[2025-11-19T09:32:06.853Z] üìù Creating new entry for key: token:unknown
[2025-11-19T09:32:06.853Z] Current count after filter: 0
[2025-11-19T09:32:06.853Z] Max requests allowed: 60
[2025-11-19T09:32:06.853Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.854Z] New count: 1
[2025-11-19T09:32:06.854Z] Remaining: 59
[2025-11-19T09:32:06.854Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.854Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.854Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.854Z] Request URL: /auth/token
[2025-11-19T09:32:06.854Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.854Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.855Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.855Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.855Z] X-Test-ID header: null
[2025-11-19T09:32:06.855Z] Will use test ID?: false
[2025-11-19T09:32:06.855Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.855Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.855Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.855Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.855Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.855Z] Identifier: unknown
[2025-11-19T09:32:06.855Z] Key: token:unknown
[2025-11-19T09:32:06.855Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.855Z] Existing timestamps: 1
[2025-11-19T09:32:06.855Z] Current count after filter: 1
[2025-11-19T09:32:06.855Z] Max requests allowed: 60
[2025-11-19T09:32:06.855Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.855Z] New count: 2
[2025-11-19T09:32:06.855Z] Remaining: 58
[2025-11-19T09:32:06.855Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.855Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.876Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.877Z] Request URL: /auth/token
[2025-11-19T09:32:06.877Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.877Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.877Z] X-Test-ID header: null
[2025-11-19T09:32:06.877Z] Will use test ID?: false
[2025-11-19T09:32:06.877Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.877Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.877Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.877Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.877Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.877Z] Identifier: unknown
[2025-11-19T09:32:06.877Z] Key: token:unknown
[2025-11-19T09:32:06.877Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.877Z] Existing timestamps: 2
[2025-11-19T09:32:06.877Z] Current count after filter: 2
[2025-11-19T09:32:06.877Z] Max requests allowed: 60
[2025-11-19T09:32:06.877Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.877Z] New count: 3
[2025-11-19T09:32:06.877Z] Remaining: 57
[2025-11-19T09:32:06.877Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.877Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:06.885Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:06.885Z] Request URL: /auth/token
[2025-11-19T09:32:06.885Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:06.885Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:06.885Z] X-Test-ID header: null
[2025-11-19T09:32:06.885Z] Will use test ID?: false
[2025-11-19T09:32:06.885Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:06.885Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:06.885Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:06.885Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:06.885Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:06.885Z] Identifier: unknown
[2025-11-19T09:32:06.885Z] Key: token:unknown
[2025-11-19T09:32:06.886Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:06.886Z] Existing timestamps: 3
[2025-11-19T09:32:06.886Z] Current count after filter: 3
[2025-11-19T09:32:06.886Z] Max requests allowed: 60
[2025-11-19T09:32:06.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:06.886Z] New count: 4
[2025-11-19T09:32:06.886Z] Remaining: 56
[2025-11-19T09:32:06.886Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:06.886Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.627Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.627Z] Request URL: /auth/token
[2025-11-19T09:32:07.628Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.628Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.628Z] X-Test-ID header: null
[2025-11-19T09:32:07.628Z] Will use test ID?: false
[2025-11-19T09:32:07.628Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.628Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.628Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.628Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.628Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.628Z] Identifier: unknown
[2025-11-19T09:32:07.628Z] Key: token:unknown
[2025-11-19T09:32:07.628Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.628Z] Existing timestamps: 4
[2025-11-19T09:32:07.628Z] Current count after filter: 4
[2025-11-19T09:32:07.628Z] Max requests allowed: 60
[2025-11-19T09:32:07.628Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.629Z] New count: 5
[2025-11-19T09:32:07.629Z] Remaining: 55
[2025-11-19T09:32:07.629Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.629Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.630Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.630Z] Request URL: /auth/token
[2025-11-19T09:32:07.630Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.630Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.630Z] X-Test-ID header: null
[2025-11-19T09:32:07.630Z] Will use test ID?: false
[2025-11-19T09:32:07.630Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.630Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.630Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.630Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.630Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.630Z] Identifier: unknown
[2025-11-19T09:32:07.630Z] Key: token:unknown
[2025-11-19T09:32:07.630Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.630Z] Existing timestamps: 5
[2025-11-19T09:32:07.630Z] Current count after filter: 5
[2025-11-19T09:32:07.630Z] Max requests allowed: 60
[2025-11-19T09:32:07.630Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.630Z] New count: 6
[2025-11-19T09:32:07.631Z] Remaining: 54
[2025-11-19T09:32:07.631Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.631Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.636Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.636Z] Request URL: /auth/token
[2025-11-19T09:32:07.636Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.636Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.636Z] X-Test-ID header: null
[2025-11-19T09:32:07.636Z] Will use test ID?: false
[2025-11-19T09:32:07.637Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.637Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.637Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.637Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.637Z] Identifier: unknown
[2025-11-19T09:32:07.637Z] Key: token:unknown
[2025-11-19T09:32:07.637Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.637Z] Existing timestamps: 6
[2025-11-19T09:32:07.637Z] Current count after filter: 6
[2025-11-19T09:32:07.637Z] Max requests allowed: 60
[2025-11-19T09:32:07.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.637Z] New count: 7
[2025-11-19T09:32:07.637Z] Remaining: 53
[2025-11-19T09:32:07.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.637Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:07.652Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:07.652Z] Request URL: /auth/token
[2025-11-19T09:32:07.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:07.652Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:07.652Z] X-Test-ID header: null
[2025-11-19T09:32:07.652Z] Will use test ID?: false
[2025-11-19T09:32:07.652Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:07.652Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:07.652Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:07.652Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:07.652Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:07.652Z] Identifier: unknown
[2025-11-19T09:32:07.652Z] Key: token:unknown
[2025-11-19T09:32:07.652Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:07.652Z] Existing timestamps: 7
[2025-11-19T09:32:07.652Z] Current count after filter: 7
[2025-11-19T09:32:07.652Z] Max requests allowed: 60
[2025-11-19T09:32:07.652Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:07.652Z] New count: 8
[2025-11-19T09:32:07.652Z] Remaining: 52
[2025-11-19T09:32:07.652Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:07.652Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:12.432Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:12.432Z] Request URL: /auth/token
[2025-11-19T09:32:12.432Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:12.432Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:12.432Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:12.433Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:12.433Z] X-Test-ID header: null
[2025-11-19T09:32:12.433Z] Will use test ID?: false
[2025-11-19T09:32:12.433Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:12.433Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:12.433Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:12.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:12.433Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:12.433Z] Identifier: unknown
[2025-11-19T09:32:12.433Z] Key: token:unknown
[2025-11-19T09:32:12.433Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:12.433Z] Existing timestamps: 8
[2025-11-19T09:32:12.433Z] Current count after filter: 8
[2025-11-19T09:32:12.433Z] Max requests allowed: 60
[2025-11-19T09:32:12.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:12.433Z] New count: 9
[2025-11-19T09:32:12.433Z] Remaining: 51
[2025-11-19T09:32:12.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:12.433Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763544786853
}
[2025-11-19T09:32:13.259Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-19T09:32:13.259Z] Request URL: /auth/token
[2025-11-19T09:32:13.260Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (process.env): true
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (env): true
[2025-11-19T09:32:13.260Z] E2E_TEST_MODE (final): true
[2025-11-19T09:32:13.260Z] X-Test-ID header: null
[2025-11-19T09:32:13.260Z] Will use test ID?: false
[2025-11-19T09:32:13.260Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:32:13.260Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:32:13.260Z] Got identifier from getClientIdentifier: unknown
[2025-11-19T09:32:13.260Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:32:13.260Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-19T09:32:13.260Z] Identifier: unknown
[2025-11-19T09:32:13.260Z] Key: token:unknown
[2025-11-19T09:32:13.260Z] üìñ Found existing entry for key: token:unknown
[2025-11-19T09:32:13.260Z] Existing timestamps: 9
[2025-11-19T09:32:13.260Z] Current count after filter: 9
[2025-11-19T09:32:13.261Z] Max requests allowed: 60
[2025-11-19T09:32:13.261Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:32:13.261Z] New count: 10
[2025-11-19T09:32:13.261Z] Remaining: 50
[2025-11-19T09:32:13.261Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:32:13.261Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763544786853
}
[2025-11-19T09:44:55.472Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.473Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.473Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.473Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.473Z] üìù Creating new entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Current count after filter: 0
[2025-11-19T09:44:55.474Z] Max requests allowed: 5
[2025-11-19T09:44:55.474Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.474Z] New count: 1
[2025-11-19T09:44:55.474Z] Remaining: 4
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.474Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.474Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.474Z] Existing timestamps: 1
[2025-11-19T09:44:55.474Z] Current count after filter: 1
[2025-11-19T09:44:55.474Z] Max requests allowed: 5
[2025-11-19T09:44:55.474Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.474Z] New count: 2
[2025-11-19T09:44:55.474Z] Remaining: 3
[2025-11-19T09:44:55.474Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Existing timestamps: 2
[2025-11-19T09:44:55.475Z] Current count after filter: 2
[2025-11-19T09:44:55.475Z] Max requests allowed: 5
[2025-11-19T09:44:55.475Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.475Z] New count: 3
[2025-11-19T09:44:55.475Z] Remaining: 2
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.475Z] Existing timestamps: 3
[2025-11-19T09:44:55.475Z] Current count after filter: 3
[2025-11-19T09:44:55.475Z] Max requests allowed: 5
[2025-11-19T09:44:55.475Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.475Z] New count: 4
[2025-11-19T09:44:55.475Z] Remaining: 1
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.475Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.475Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.475Z] Identifier: test-allow-1763545495472
[2025-11-19T09:44:55.476Z] Key: login:test-allow-1763545495472
[2025-11-19T09:44:55.476Z] üìñ Found existing entry for key: login:test-allow-1763545495472
[2025-11-19T09:44:55.476Z] Existing timestamps: 4
[2025-11-19T09:44:55.476Z] Current count after filter: 4
[2025-11-19T09:44:55.476Z] Max requests allowed: 5
[2025-11-19T09:44:55.476Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.476Z] New count: 5
[2025-11-19T09:44:55.476Z] Remaining: 0
[2025-11-19T09:44:55.476Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.476Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìù Creating new entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Current count after filter: 0
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 1
[2025-11-19T09:44:55.477Z] Remaining: 4
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Existing timestamps: 1
[2025-11-19T09:44:55.477Z] Current count after filter: 1
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 2
[2025-11-19T09:44:55.477Z] Remaining: 3
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.477Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.477Z] Existing timestamps: 2
[2025-11-19T09:44:55.477Z] Current count after filter: 2
[2025-11-19T09:44:55.477Z] Max requests allowed: 5
[2025-11-19T09:44:55.477Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.477Z] New count: 3
[2025-11-19T09:44:55.477Z] Remaining: 2
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.477Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.477Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 3
[2025-11-19T09:44:55.478Z] Current count after filter: 3
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.478Z] New count: 4
[2025-11-19T09:44:55.478Z] Remaining: 1
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.478Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.478Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 4
[2025-11-19T09:44:55.478Z] Current count after filter: 4
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.478Z] New count: 5
[2025-11-19T09:44:55.478Z] Remaining: 0
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.478Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.478Z] Identifier: test-block-1763545495476
[2025-11-19T09:44:55.478Z] Key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] üìñ Found existing entry for key: login:test-block-1763545495476
[2025-11-19T09:44:55.478Z] Existing timestamps: 5
[2025-11-19T09:44:55.478Z] Current count after filter: 5
[2025-11-19T09:44:55.478Z] Max requests allowed: 5
[2025-11-19T09:44:55.478Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.478Z] Current count: 5
[2025-11-19T09:44:55.478Z] Max allowed: 5
[2025-11-19T09:44:55.478Z] Retry after (seconds): 60
[2025-11-19T09:44:55.478Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.479Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.479Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.479Z] üìù Creating new entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Current count after filter: 0
[2025-11-19T09:44:55.479Z] Max requests allowed: 2
[2025-11-19T09:44:55.479Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.479Z] New count: 1
[2025-11-19T09:44:55.479Z] Remaining: 1
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.479Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.479Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.479Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Existing timestamps: 1
[2025-11-19T09:44:55.480Z] Current count after filter: 1
[2025-11-19T09:44:55.480Z] Max requests allowed: 2
[2025-11-19T09:44:55.480Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.480Z] New count: 2
[2025-11-19T09:44:55.480Z] Remaining: 0
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.480Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.480Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.480Z] Existing timestamps: 2
[2025-11-19T09:44:55.480Z] Current count after filter: 2
[2025-11-19T09:44:55.480Z] Max requests allowed: 2
[2025-11-19T09:44:55.480Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.480Z] Current count: 2
[2025-11-19T09:44:55.480Z] Max allowed: 2
[2025-11-19T09:44:55.480Z] Retry after (seconds): 1
[2025-11-19T09:44:55.480Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.631Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.632Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:44:55.632Z] Identifier: test-reset-1763545495479
[2025-11-19T09:44:55.632Z] Key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.632Z] üìñ Found existing entry for key: test-reset:test-reset-1763545495479
[2025-11-19T09:44:55.632Z] Existing timestamps: 2
[2025-11-19T09:44:55.632Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:44:55.632Z] Current count after filter: 0
[2025-11-19T09:44:55.633Z] Max requests allowed: 2
[2025-11-19T09:44:55.633Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.633Z] New count: 1
[2025-11-19T09:44:55.633Z] Remaining: 1
[2025-11-19T09:44:55.633Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.633Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.634Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.634Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] üìù Creating new entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.634Z] Current count after filter: 0
[2025-11-19T09:44:55.634Z] Max requests allowed: 5
[2025-11-19T09:44:55.634Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.634Z] New count: 1
[2025-11-19T09:44:55.634Z] Remaining: 4
[2025-11-19T09:44:55.634Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.634Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.634Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.634Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.635Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.635Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.636Z] Existing timestamps: 1
[2025-11-19T09:44:55.636Z] Current count after filter: 1
[2025-11-19T09:44:55.636Z] Max requests allowed: 5
[2025-11-19T09:44:55.636Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.636Z] New count: 2
[2025-11-19T09:44:55.636Z] Remaining: 3
[2025-11-19T09:44:55.636Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.636Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.636Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 2
[2025-11-19T09:44:55.637Z] Current count after filter: 2
[2025-11-19T09:44:55.637Z] Max requests allowed: 5
[2025-11-19T09:44:55.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.637Z] New count: 3
[2025-11-19T09:44:55.637Z] Remaining: 2
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.637Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 3
[2025-11-19T09:44:55.637Z] Current count after filter: 3
[2025-11-19T09:44:55.637Z] Max requests allowed: 5
[2025-11-19T09:44:55.637Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.637Z] New count: 4
[2025-11-19T09:44:55.637Z] Remaining: 1
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.637Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.637Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.637Z] Existing timestamps: 4
[2025-11-19T09:44:55.637Z] Current count after filter: 4
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.638Z] New count: 5
[2025-11-19T09:44:55.638Z] Remaining: 0
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.638Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.638Z] Identifier: test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] Key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] üìñ Found existing entry for key: login:test-multi-1-1763545495633
[2025-11-19T09:44:55.638Z] Existing timestamps: 5
[2025-11-19T09:44:55.638Z] Current count after filter: 5
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.638Z] Current count: 5
[2025-11-19T09:44:55.638Z] Max allowed: 5
[2025-11-19T09:44:55.638Z] Retry after (seconds): 60
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.638Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.638Z] Identifier: test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] Key: login:test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] üìù Creating new entry for key: login:test-multi-2-1763545495633
[2025-11-19T09:44:55.638Z] Current count after filter: 0
[2025-11-19T09:44:55.638Z] Max requests allowed: 5
[2025-11-19T09:44:55.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.638Z] New count: 1
[2025-11-19T09:44:55.638Z] Remaining: 4
[2025-11-19T09:44:55.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.639Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:44:55.639Z] Identifier: test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] Key: login:test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] üìù Creating new entry for key: login:test-reset-time-1763545495639
[2025-11-19T09:44:55.639Z] Current count after filter: 0
[2025-11-19T09:44:55.639Z] Max requests allowed: 5
[2025-11-19T09:44:55.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.639Z] New count: 1
[2025-11-19T09:44:55.639Z] Remaining: 4
[2025-11-19T09:44:55.639Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.640Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.641Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.641Z] X-Test-ID header: null
[2025-11-19T09:44:55.641Z] Will use test ID?: false
[2025-11-19T09:44:55.641Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.641Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.642Z] X-Test-ID header: null
[2025-11-19T09:44:55.642Z] Will use test ID?: false
[2025-11-19T09:44:55.642Z] Using real IP: 192.168.1.2
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.642Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.642Z] X-Test-ID header: null
[2025-11-19T09:44:55.642Z] Will use test ID?: false
[2025-11-19T09:44:55.642Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.643Z] X-Test-ID header: null
[2025-11-19T09:44:55.643Z] Will use test ID?: false
[2025-11-19T09:44:55.643Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (env): true
[2025-11-19T09:44:55.643Z] E2E_TEST_MODE (final): true
[2025-11-19T09:44:55.643Z] X-Test-ID header: null
[2025-11-19T09:44:55.643Z] Will use test ID?: false
[2025-11-19T09:44:55.643Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:44:55.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:44:55.644Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.644Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.644Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.644Z] Current count after filter: 0
[2025-11-19T09:44:55.645Z] Max requests allowed: 3
[2025-11-19T09:44:55.645Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.645Z] New count: 1
[2025-11-19T09:44:55.645Z] Remaining: 2
[2025-11-19T09:44:55.645Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.746Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.746Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.746Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.747Z] Existing timestamps: 1
[2025-11-19T09:44:55.747Z] Current count after filter: 1
[2025-11-19T09:44:55.747Z] Max requests allowed: 3
[2025-11-19T09:44:55.747Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.747Z] New count: 2
[2025-11-19T09:44:55.747Z] Remaining: 1
[2025-11-19T09:44:55.747Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.848Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.848Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:44:55.848Z] Identifier: test-sliding-1763545495644
[2025-11-19T09:44:55.848Z] Key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.849Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545495644
[2025-11-19T09:44:55.849Z] Existing timestamps: 2
[2025-11-19T09:44:55.849Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:44:55.849Z] Current count after filter: 1
[2025-11-19T09:44:55.849Z] Max requests allowed: 3
[2025-11-19T09:44:55.849Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.849Z] New count: 2
[2025-11-19T09:44:55.849Z] Remaining: 1
[2025-11-19T09:44:55.849Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.849Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.849Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.849Z] Identifier: test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] Key: register:test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] üìù Creating new entry for key: register:test-format-allowed-1763545495849
[2025-11-19T09:44:55.849Z] Current count after filter: 0
[2025-11-19T09:44:55.849Z] Max requests allowed: 3
[2025-11-19T09:44:55.850Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.850Z] New count: 1
[2025-11-19T09:44:55.850Z] Remaining: 2
[2025-11-19T09:44:55.850Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.850Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.850Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.850Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] üìù Creating new entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Current count after filter: 0
[2025-11-19T09:44:55.851Z] Max requests allowed: 3
[2025-11-19T09:44:55.851Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.851Z] New count: 1
[2025-11-19T09:44:55.851Z] Remaining: 2
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.851Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.851Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.851Z] Existing timestamps: 1
[2025-11-19T09:44:55.851Z] Current count after filter: 1
[2025-11-19T09:44:55.851Z] Max requests allowed: 3
[2025-11-19T09:44:55.851Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.851Z] New count: 2
[2025-11-19T09:44:55.851Z] Remaining: 1
[2025-11-19T09:44:55.851Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.852Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.852Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.852Z] Existing timestamps: 2
[2025-11-19T09:44:55.852Z] Current count after filter: 2
[2025-11-19T09:44:55.852Z] Max requests allowed: 3
[2025-11-19T09:44:55.852Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:44:55.852Z] New count: 3
[2025-11-19T09:44:55.852Z] Remaining: 0
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:44:55.852Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:44:55.852Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:44:55.853Z] Identifier: test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] Key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] üìñ Found existing entry for key: register:test-format-blocked-1763545495850
[2025-11-19T09:44:55.853Z] Existing timestamps: 3
[2025-11-19T09:44:55.853Z] Current count after filter: 3
[2025-11-19T09:44:55.853Z] Max requests allowed: 3
[2025-11-19T09:44:55.853Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:44:55.853Z] Current count: 3
[2025-11-19T09:44:55.853Z] Max allowed: 3
[2025-11-19T09:44:55.853Z] Retry after (seconds): 60
[2025-11-19T09:44:55.853Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.785Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.785Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.785Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.785Z] üìù Creating new entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.785Z] Current count after filter: 0
[2025-11-19T09:45:14.785Z] Max requests allowed: 5
[2025-11-19T09:45:14.785Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.786Z] New count: 1
[2025-11-19T09:45:14.786Z] Remaining: 4
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.786Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Existing timestamps: 1
[2025-11-19T09:45:14.786Z] Current count after filter: 1
[2025-11-19T09:45:14.786Z] Max requests allowed: 5
[2025-11-19T09:45:14.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.786Z] New count: 2
[2025-11-19T09:45:14.786Z] Remaining: 3
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.786Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.786Z] Existing timestamps: 2
[2025-11-19T09:45:14.786Z] Current count after filter: 2
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 3
[2025-11-19T09:45:14.787Z] Remaining: 2
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.787Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Existing timestamps: 3
[2025-11-19T09:45:14.787Z] Current count after filter: 3
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 4
[2025-11-19T09:45:14.787Z] Remaining: 1
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.787Z] Identifier: test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] üìñ Found existing entry for key: login:test-allow-1763545514784
[2025-11-19T09:45:14.787Z] Existing timestamps: 4
[2025-11-19T09:45:14.787Z] Current count after filter: 4
[2025-11-19T09:45:14.787Z] Max requests allowed: 5
[2025-11-19T09:45:14.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.787Z] New count: 5
[2025-11-19T09:45:14.787Z] Remaining: 0
[2025-11-19T09:45:14.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.788Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.788Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] üìù Creating new entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] Current count after filter: 0
[2025-11-19T09:45:14.788Z] Max requests allowed: 5
[2025-11-19T09:45:14.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.788Z] New count: 1
[2025-11-19T09:45:14.788Z] Remaining: 4
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.788Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.788Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.788Z] Existing timestamps: 1
[2025-11-19T09:45:14.789Z] Current count after filter: 1
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 2
[2025-11-19T09:45:14.789Z] Remaining: 3
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 2
[2025-11-19T09:45:14.789Z] Current count after filter: 2
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 3
[2025-11-19T09:45:14.789Z] Remaining: 2
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 3
[2025-11-19T09:45:14.789Z] Current count after filter: 3
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.789Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.789Z] New count: 4
[2025-11-19T09:45:14.789Z] Remaining: 1
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.789Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.789Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.789Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.789Z] Existing timestamps: 4
[2025-11-19T09:45:14.789Z] Current count after filter: 4
[2025-11-19T09:45:14.789Z] Max requests allowed: 5
[2025-11-19T09:45:14.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.790Z] New count: 5
[2025-11-19T09:45:14.790Z] Remaining: 0
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.790Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.790Z] Identifier: test-block-1763545514788
[2025-11-19T09:45:14.790Z] Key: login:test-block-1763545514788
[2025-11-19T09:45:14.790Z] üìñ Found existing entry for key: login:test-block-1763545514788
[2025-11-19T09:45:14.790Z] Existing timestamps: 5
[2025-11-19T09:45:14.790Z] Current count after filter: 5
[2025-11-19T09:45:14.790Z] Max requests allowed: 5
[2025-11-19T09:45:14.790Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.790Z] Current count: 5
[2025-11-19T09:45:14.790Z] Max allowed: 5
[2025-11-19T09:45:14.790Z] Retry after (seconds): 60
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.790Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.790Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.790Z] üìù Creating new entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.790Z] Current count after filter: 0
[2025-11-19T09:45:14.791Z] Max requests allowed: 2
[2025-11-19T09:45:14.791Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.791Z] New count: 1
[2025-11-19T09:45:14.791Z] Remaining: 1
[2025-11-19T09:45:14.791Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.791Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.791Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.791Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.791Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.791Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.791Z] Existing timestamps: 1
[2025-11-19T09:45:14.791Z] Current count after filter: 1
[2025-11-19T09:45:14.791Z] Max requests allowed: 2
[2025-11-19T09:45:14.791Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.791Z] New count: 2
[2025-11-19T09:45:14.792Z] Remaining: 0
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.792Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.792Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.792Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.792Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.792Z] Existing timestamps: 2
[2025-11-19T09:45:14.792Z] Current count after filter: 2
[2025-11-19T09:45:14.792Z] Max requests allowed: 2
[2025-11-19T09:45:14.792Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.792Z] Current count: 2
[2025-11-19T09:45:14.792Z] Max allowed: 2
[2025-11-19T09:45:14.792Z] Retry after (seconds): 1
[2025-11-19T09:45:14.792Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.947Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:14.947Z] Identifier: test-reset-1763545514790
[2025-11-19T09:45:14.947Z] Key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.947Z] üìñ Found existing entry for key: test-reset:test-reset-1763545514790
[2025-11-19T09:45:14.947Z] Existing timestamps: 2
[2025-11-19T09:45:14.947Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:45:14.947Z] Current count after filter: 0
[2025-11-19T09:45:14.947Z] Max requests allowed: 2
[2025-11-19T09:45:14.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.950Z] New count: 1
[2025-11-19T09:45:14.951Z] Remaining: 1
[2025-11-19T09:45:14.951Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.952Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.952Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.952Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.952Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìù Creating new entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Current count after filter: 0
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 1
[2025-11-19T09:45:14.953Z] Remaining: 4
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 1
[2025-11-19T09:45:14.953Z] Current count after filter: 1
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 2
[2025-11-19T09:45:14.953Z] Remaining: 3
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 2
[2025-11-19T09:45:14.953Z] Current count after filter: 2
[2025-11-19T09:45:14.953Z] Max requests allowed: 5
[2025-11-19T09:45:14.953Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.953Z] New count: 3
[2025-11-19T09:45:14.953Z] Remaining: 2
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.953Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.953Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.953Z] Existing timestamps: 3
[2025-11-19T09:45:14.953Z] Current count after filter: 3
[2025-11-19T09:45:14.956Z] Max requests allowed: 5
[2025-11-19T09:45:14.956Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.956Z] New count: 4
[2025-11-19T09:45:14.956Z] Remaining: 1
[2025-11-19T09:45:14.956Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.956Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.956Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.956Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.956Z] Existing timestamps: 4
[2025-11-19T09:45:14.957Z] Current count after filter: 4
[2025-11-19T09:45:14.957Z] Max requests allowed: 5
[2025-11-19T09:45:14.957Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.957Z] New count: 5
[2025-11-19T09:45:14.957Z] Remaining: 0
[2025-11-19T09:45:14.957Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.957Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.957Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.957Z] Identifier: test-multi-1-1763545514952
[2025-11-19T09:45:14.958Z] Key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.959Z] üìñ Found existing entry for key: login:test-multi-1-1763545514952
[2025-11-19T09:45:14.959Z] Existing timestamps: 5
[2025-11-19T09:45:14.959Z] Current count after filter: 5
[2025-11-19T09:45:14.959Z] Max requests allowed: 5
[2025-11-19T09:45:14.959Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:14.959Z] Current count: 5
[2025-11-19T09:45:14.959Z] Max allowed: 5
[2025-11-19T09:45:14.959Z] Retry after (seconds): 60
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.959Z] Identifier: test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] Key: login:test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] üìù Creating new entry for key: login:test-multi-2-1763545514952
[2025-11-19T09:45:14.959Z] Current count after filter: 0
[2025-11-19T09:45:14.959Z] Max requests allowed: 5
[2025-11-19T09:45:14.959Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.959Z] New count: 1
[2025-11-19T09:45:14.959Z] Remaining: 4
[2025-11-19T09:45:14.959Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.960Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.960Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:14.960Z] Identifier: test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] Key: login:test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] üìù Creating new entry for key: login:test-reset-time-1763545514960
[2025-11-19T09:45:14.960Z] Current count after filter: 0
[2025-11-19T09:45:14.960Z] Max requests allowed: 5
[2025-11-19T09:45:14.960Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.960Z] New count: 1
[2025-11-19T09:45:14.960Z] Remaining: 4
[2025-11-19T09:45:14.960Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:14.961Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.962Z] X-Test-ID header: null
[2025-11-19T09:45:14.962Z] Will use test ID?: false
[2025-11-19T09:45:14.962Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.962Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.962Z] X-Test-ID header: null
[2025-11-19T09:45:14.962Z] Will use test ID?: false
[2025-11-19T09:45:14.962Z] Using real IP: 192.168.1.2
[2025-11-19T09:45:14.962Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.963Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.963Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.963Z] X-Test-ID header: null
[2025-11-19T09:45:14.963Z] Will use test ID?: false
[2025-11-19T09:45:14.963Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.963Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.964Z] X-Test-ID header: null
[2025-11-19T09:45:14.964Z] Will use test ID?: false
[2025-11-19T09:45:14.964Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.964Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:14.964Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:14.965Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:14.965Z] X-Test-ID header: null
[2025-11-19T09:45:14.965Z] Will use test ID?: false
[2025-11-19T09:45:14.965Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:14.965Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:14.965Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:14.965Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:14.965Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:14.965Z] Current count after filter: 0
[2025-11-19T09:45:14.965Z] Max requests allowed: 3
[2025-11-19T09:45:14.965Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:14.965Z] New count: 1
[2025-11-19T09:45:14.965Z] Remaining: 2
[2025-11-19T09:45:14.965Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.084Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.088Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:15.089Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.089Z] Existing timestamps: 1
[2025-11-19T09:45:15.089Z] Current count after filter: 1
[2025-11-19T09:45:15.090Z] Max requests allowed: 3
[2025-11-19T09:45:15.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.090Z] New count: 2
[2025-11-19T09:45:15.090Z] Remaining: 1
[2025-11-19T09:45:15.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.192Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.192Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:15.192Z] Identifier: test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] Key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545514965
[2025-11-19T09:45:15.192Z] Existing timestamps: 2
[2025-11-19T09:45:15.192Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:45:15.192Z] Current count after filter: 1
[2025-11-19T09:45:15.192Z] Max requests allowed: 3
[2025-11-19T09:45:15.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.193Z] New count: 2
[2025-11-19T09:45:15.193Z] Remaining: 1
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.193Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.193Z] Identifier: test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] Key: register:test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] üìù Creating new entry for key: register:test-format-allowed-1763545515193
[2025-11-19T09:45:15.193Z] Current count after filter: 0
[2025-11-19T09:45:15.193Z] Max requests allowed: 3
[2025-11-19T09:45:15.193Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.193Z] New count: 1
[2025-11-19T09:45:15.193Z] Remaining: 2
[2025-11-19T09:45:15.193Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.194Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.194Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] üìù Creating new entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Current count after filter: 0
[2025-11-19T09:45:15.194Z] Max requests allowed: 3
[2025-11-19T09:45:15.194Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.194Z] New count: 1
[2025-11-19T09:45:15.194Z] Remaining: 2
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.194Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.194Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.194Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.194Z] Existing timestamps: 1
[2025-11-19T09:45:15.194Z] Current count after filter: 1
[2025-11-19T09:45:15.195Z] Max requests allowed: 3
[2025-11-19T09:45:15.195Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.195Z] New count: 2
[2025-11-19T09:45:15.195Z] Remaining: 1
[2025-11-19T09:45:15.195Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.195Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.195Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.196Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.196Z] Existing timestamps: 2
[2025-11-19T09:45:15.196Z] Current count after filter: 2
[2025-11-19T09:45:15.196Z] Max requests allowed: 3
[2025-11-19T09:45:15.196Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:15.196Z] New count: 3
[2025-11-19T09:45:15.197Z] Remaining: 0
[2025-11-19T09:45:15.197Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:15.197Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:15.197Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:15.197Z] Identifier: test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] Key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] üìñ Found existing entry for key: register:test-format-blocked-1763545515194
[2025-11-19T09:45:15.197Z] Existing timestamps: 3
[2025-11-19T09:45:15.197Z] Current count after filter: 3
[2025-11-19T09:45:15.197Z] Max requests allowed: 3
[2025-11-19T09:45:15.197Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:15.197Z] Current count: 3
[2025-11-19T09:45:15.198Z] Max allowed: 3
[2025-11-19T09:45:15.198Z] Retry after (seconds): 60
[2025-11-19T09:45:15.198Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.395Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.395Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.395Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.395Z] üìù Creating new entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.395Z] Current count after filter: 0
[2025-11-19T09:45:36.396Z] Max requests allowed: 5
[2025-11-19T09:45:36.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.396Z] New count: 1
[2025-11-19T09:45:36.396Z] Remaining: 4
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.396Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.396Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.396Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.396Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.396Z] Existing timestamps: 1
[2025-11-19T09:45:36.396Z] Current count after filter: 1
[2025-11-19T09:45:36.396Z] Max requests allowed: 5
[2025-11-19T09:45:36.396Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.396Z] New count: 2
[2025-11-19T09:45:36.396Z] Remaining: 3
[2025-11-19T09:45:36.396Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.397Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.397Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.397Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.397Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.397Z] Existing timestamps: 2
[2025-11-19T09:45:36.397Z] Current count after filter: 2
[2025-11-19T09:45:36.397Z] Max requests allowed: 5
[2025-11-19T09:45:36.397Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.397Z] New count: 3
[2025-11-19T09:45:36.397Z] Remaining: 2
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.397Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.397Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.397Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Existing timestamps: 3
[2025-11-19T09:45:36.398Z] Current count after filter: 3
[2025-11-19T09:45:36.398Z] Max requests allowed: 5
[2025-11-19T09:45:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.398Z] New count: 4
[2025-11-19T09:45:36.398Z] Remaining: 1
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.398Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.398Z] Identifier: test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] üìñ Found existing entry for key: login:test-allow-1763545536394
[2025-11-19T09:45:36.398Z] Existing timestamps: 4
[2025-11-19T09:45:36.398Z] Current count after filter: 4
[2025-11-19T09:45:36.398Z] Max requests allowed: 5
[2025-11-19T09:45:36.398Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.398Z] New count: 5
[2025-11-19T09:45:36.398Z] Remaining: 0
[2025-11-19T09:45:36.398Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.399Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.399Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] üìù Creating new entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] Current count after filter: 0
[2025-11-19T09:45:36.399Z] Max requests allowed: 5
[2025-11-19T09:45:36.399Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.399Z] New count: 1
[2025-11-19T09:45:36.399Z] Remaining: 4
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.399Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.399Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.399Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.399Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.399Z] Existing timestamps: 1
[2025-11-19T09:45:36.399Z] Current count after filter: 1
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 2
[2025-11-19T09:45:36.400Z] Remaining: 3
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] Existing timestamps: 2
[2025-11-19T09:45:36.400Z] Current count after filter: 2
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 3
[2025-11-19T09:45:36.400Z] Remaining: 2
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.400Z] Existing timestamps: 3
[2025-11-19T09:45:36.400Z] Current count after filter: 3
[2025-11-19T09:45:36.400Z] Max requests allowed: 5
[2025-11-19T09:45:36.400Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.400Z] New count: 4
[2025-11-19T09:45:36.400Z] Remaining: 1
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.400Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.400Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.400Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.400Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] Existing timestamps: 4
[2025-11-19T09:45:36.401Z] Current count after filter: 4
[2025-11-19T09:45:36.401Z] Max requests allowed: 5
[2025-11-19T09:45:36.401Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.401Z] New count: 5
[2025-11-19T09:45:36.401Z] Remaining: 0
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.401Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.401Z] Identifier: test-block-1763545536399
[2025-11-19T09:45:36.401Z] Key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] üìñ Found existing entry for key: login:test-block-1763545536399
[2025-11-19T09:45:36.401Z] Existing timestamps: 5
[2025-11-19T09:45:36.401Z] Current count after filter: 5
[2025-11-19T09:45:36.401Z] Max requests allowed: 5
[2025-11-19T09:45:36.401Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.401Z] Current count: 5
[2025-11-19T09:45:36.401Z] Max allowed: 5
[2025-11-19T09:45:36.401Z] Retry after (seconds): 60
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.401Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.401Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.401Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.401Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] üìù Creating new entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] Current count after filter: 0
[2025-11-19T09:45:36.402Z] Max requests allowed: 2
[2025-11-19T09:45:36.402Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.402Z] New count: 1
[2025-11-19T09:45:36.402Z] Remaining: 1
[2025-11-19T09:45:36.402Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.402Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.402Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.402Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.402Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.402Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Existing timestamps: 1
[2025-11-19T09:45:36.403Z] Current count after filter: 1
[2025-11-19T09:45:36.403Z] Max requests allowed: 2
[2025-11-19T09:45:36.403Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.403Z] New count: 2
[2025-11-19T09:45:36.403Z] Remaining: 0
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.403Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.403Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.403Z] Existing timestamps: 2
[2025-11-19T09:45:36.403Z] Current count after filter: 2
[2025-11-19T09:45:36.403Z] Max requests allowed: 2
[2025-11-19T09:45:36.403Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.403Z] Current count: 2
[2025-11-19T09:45:36.403Z] Max allowed: 2
[2025-11-19T09:45:36.403Z] Retry after (seconds): 1
[2025-11-19T09:45:36.403Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.554Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.554Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:45:36.554Z] Identifier: test-reset-1763545536401
[2025-11-19T09:45:36.554Z] Key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.554Z] üìñ Found existing entry for key: test-reset:test-reset-1763545536401
[2025-11-19T09:45:36.554Z] Existing timestamps: 2
[2025-11-19T09:45:36.554Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:45:36.554Z] Current count after filter: 0
[2025-11-19T09:45:36.554Z] Max requests allowed: 2
[2025-11-19T09:45:36.554Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.555Z] New count: 1
[2025-11-19T09:45:36.555Z] Remaining: 1
[2025-11-19T09:45:36.555Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.555Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.555Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.555Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] üìù Creating new entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.555Z] Current count after filter: 0
[2025-11-19T09:45:36.555Z] Max requests allowed: 5
[2025-11-19T09:45:36.555Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.556Z] New count: 1
[2025-11-19T09:45:36.556Z] Remaining: 4
[2025-11-19T09:45:36.556Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.556Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.556Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.556Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.556Z] Existing timestamps: 1
[2025-11-19T09:45:36.556Z] Current count after filter: 1
[2025-11-19T09:45:36.556Z] Max requests allowed: 5
[2025-11-19T09:45:36.556Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.556Z] New count: 2
[2025-11-19T09:45:36.556Z] Remaining: 3
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.557Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.557Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.557Z] Existing timestamps: 2
[2025-11-19T09:45:36.557Z] Current count after filter: 2
[2025-11-19T09:45:36.557Z] Max requests allowed: 5
[2025-11-19T09:45:36.557Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.557Z] New count: 3
[2025-11-19T09:45:36.557Z] Remaining: 2
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.557Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.557Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.558Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Existing timestamps: 3
[2025-11-19T09:45:36.558Z] Current count after filter: 3
[2025-11-19T09:45:36.558Z] Max requests allowed: 5
[2025-11-19T09:45:36.558Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.558Z] New count: 4
[2025-11-19T09:45:36.558Z] Remaining: 1
[2025-11-19T09:45:36.558Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.558Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.558Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.558Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.558Z] Existing timestamps: 4
[2025-11-19T09:45:36.558Z] Current count after filter: 4
[2025-11-19T09:45:36.558Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.559Z] New count: 5
[2025-11-19T09:45:36.559Z] Remaining: 0
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.559Z] Identifier: test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] Key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] üìñ Found existing entry for key: login:test-multi-1-1763545536555
[2025-11-19T09:45:36.559Z] Existing timestamps: 5
[2025-11-19T09:45:36.559Z] Current count after filter: 5
[2025-11-19T09:45:36.559Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.559Z] Current count: 5
[2025-11-19T09:45:36.559Z] Max allowed: 5
[2025-11-19T09:45:36.559Z] Retry after (seconds): 60
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:45:36.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.559Z] Identifier: test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] Key: login:test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] üìù Creating new entry for key: login:test-multi-2-1763545536555
[2025-11-19T09:45:36.559Z] Current count after filter: 0
[2025-11-19T09:45:36.559Z] Max requests allowed: 5
[2025-11-19T09:45:36.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.559Z] New count: 1
[2025-11-19T09:45:36.559Z] Remaining: 4
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.560Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:45:36.560Z] Identifier: test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] Key: login:test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] üìù Creating new entry for key: login:test-reset-time-1763545536560
[2025-11-19T09:45:36.560Z] Current count after filter: 0
[2025-11-19T09:45:36.560Z] Max requests allowed: 5
[2025-11-19T09:45:36.560Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.560Z] New count: 1
[2025-11-19T09:45:36.560Z] Remaining: 4
[2025-11-19T09:45:36.560Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.561Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.561Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.561Z] X-Test-ID header: null
[2025-11-19T09:45:36.561Z] Will use test ID?: false
[2025-11-19T09:45:36.561Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.561Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.562Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.562Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.562Z] X-Test-ID header: null
[2025-11-19T09:45:36.562Z] Will use test ID?: false
[2025-11-19T09:45:36.562Z] Using real IP: 192.168.1.2
[2025-11-19T09:45:36.562Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.563Z] X-Test-ID header: null
[2025-11-19T09:45:36.563Z] Will use test ID?: false
[2025-11-19T09:45:36.563Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.563Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.563Z] X-Test-ID header: null
[2025-11-19T09:45:36.563Z] Will use test ID?: false
[2025-11-19T09:45:36.563Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.563Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (env): true
[2025-11-19T09:45:36.564Z] E2E_TEST_MODE (final): true
[2025-11-19T09:45:36.564Z] X-Test-ID header: null
[2025-11-19T09:45:36.564Z] Will use test ID?: false
[2025-11-19T09:45:36.564Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:45:36.564Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:45:36.564Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.564Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.564Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] üìù Creating new entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.564Z] Current count after filter: 0
[2025-11-19T09:45:36.564Z] Max requests allowed: 3
[2025-11-19T09:45:36.564Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.564Z] New count: 1
[2025-11-19T09:45:36.564Z] Remaining: 2
[2025-11-19T09:45:36.564Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.665Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.665Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.666Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.666Z] Existing timestamps: 1
[2025-11-19T09:45:36.666Z] Current count after filter: 1
[2025-11-19T09:45:36.666Z] Max requests allowed: 3
[2025-11-19T09:45:36.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.666Z] New count: 2
[2025-11-19T09:45:36.666Z] Remaining: 1
[2025-11-19T09:45:36.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.767Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:45:36.767Z] Identifier: test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] Key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763545536564
[2025-11-19T09:45:36.768Z] Existing timestamps: 2
[2025-11-19T09:45:36.768Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:45:36.768Z] Current count after filter: 1
[2025-11-19T09:45:36.768Z] Max requests allowed: 3
[2025-11-19T09:45:36.768Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.768Z] New count: 2
[2025-11-19T09:45:36.768Z] Remaining: 1
[2025-11-19T09:45:36.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.769Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.769Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.769Z] Identifier: test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] Key: register:test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] üìù Creating new entry for key: register:test-format-allowed-1763545536769
[2025-11-19T09:45:36.769Z] Current count after filter: 0
[2025-11-19T09:45:36.770Z] Max requests allowed: 3
[2025-11-19T09:45:36.770Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.770Z] New count: 1
[2025-11-19T09:45:36.770Z] Remaining: 2
[2025-11-19T09:45:36.770Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.771Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.771Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] üìù Creating new entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Current count after filter: 0
[2025-11-19T09:45:36.771Z] Max requests allowed: 3
[2025-11-19T09:45:36.771Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.771Z] New count: 1
[2025-11-19T09:45:36.771Z] Remaining: 2
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.771Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.771Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.771Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.771Z] Existing timestamps: 1
[2025-11-19T09:45:36.771Z] Current count after filter: 1
[2025-11-19T09:45:36.772Z] Max requests allowed: 3
[2025-11-19T09:45:36.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.772Z] New count: 2
[2025-11-19T09:45:36.772Z] Remaining: 1
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.772Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.772Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.772Z] Existing timestamps: 2
[2025-11-19T09:45:36.772Z] Current count after filter: 2
[2025-11-19T09:45:36.772Z] Max requests allowed: 3
[2025-11-19T09:45:36.772Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:45:36.772Z] New count: 3
[2025-11-19T09:45:36.772Z] Remaining: 0
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:45:36.772Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:45:36.772Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:45:36.772Z] Identifier: test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] Key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] üìñ Found existing entry for key: register:test-format-blocked-1763545536771
[2025-11-19T09:45:36.773Z] Existing timestamps: 3
[2025-11-19T09:45:36.773Z] Current count after filter: 3
[2025-11-19T09:45:36.773Z] Max requests allowed: 3
[2025-11-19T09:45:36.773Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:45:36.773Z] Current count: 3
[2025-11-19T09:45:36.773Z] Max allowed: 3
[2025-11-19T09:45:36.773Z] Retry after (seconds): 60
[2025-11-19T09:45:36.774Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.242Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.243Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.243Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.243Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.243Z] üìù Creating new entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.243Z] Current count after filter: 0
[2025-11-19T09:53:48.243Z] Max requests allowed: 5
[2025-11-19T09:53:48.243Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.243Z] New count: 1
[2025-11-19T09:53:48.243Z] Remaining: 4
[2025-11-19T09:53:48.243Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.244Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.244Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.244Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.244Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.244Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.244Z] Existing timestamps: 1
[2025-11-19T09:53:48.244Z] Current count after filter: 1
[2025-11-19T09:53:48.244Z] Max requests allowed: 5
[2025-11-19T09:53:48.244Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.244Z] New count: 2
[2025-11-19T09:53:48.244Z] Remaining: 3
[2025-11-19T09:53:48.244Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.245Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.245Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Existing timestamps: 2
[2025-11-19T09:53:48.245Z] Current count after filter: 2
[2025-11-19T09:53:48.245Z] Max requests allowed: 5
[2025-11-19T09:53:48.245Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.245Z] New count: 3
[2025-11-19T09:53:48.245Z] Remaining: 2
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.245Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.245Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.245Z] Existing timestamps: 3
[2025-11-19T09:53:48.245Z] Current count after filter: 3
[2025-11-19T09:53:48.245Z] Max requests allowed: 5
[2025-11-19T09:53:48.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.246Z] New count: 4
[2025-11-19T09:53:48.246Z] Remaining: 1
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.246Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.246Z] Identifier: test-allow-1763546028242
[2025-11-19T09:53:48.246Z] Key: login:test-allow-1763546028242
[2025-11-19T09:53:48.246Z] üìñ Found existing entry for key: login:test-allow-1763546028242
[2025-11-19T09:53:48.246Z] Existing timestamps: 4
[2025-11-19T09:53:48.246Z] Current count after filter: 4
[2025-11-19T09:53:48.246Z] Max requests allowed: 5
[2025-11-19T09:53:48.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.246Z] New count: 5
[2025-11-19T09:53:48.246Z] Remaining: 0
[2025-11-19T09:53:48.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.247Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.247Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] üìù Creating new entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] Current count after filter: 0
[2025-11-19T09:53:48.247Z] Max requests allowed: 5
[2025-11-19T09:53:48.247Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.247Z] New count: 1
[2025-11-19T09:53:48.247Z] Remaining: 4
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.247Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.247Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.247Z] Existing timestamps: 1
[2025-11-19T09:53:48.247Z] Current count after filter: 1
[2025-11-19T09:53:48.247Z] Max requests allowed: 5
[2025-11-19T09:53:48.247Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.247Z] New count: 2
[2025-11-19T09:53:48.247Z] Remaining: 3
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.247Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.247Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.248Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.248Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] Existing timestamps: 2
[2025-11-19T09:53:48.248Z] Current count after filter: 2
[2025-11-19T09:53:48.248Z] Max requests allowed: 5
[2025-11-19T09:53:48.248Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.248Z] New count: 3
[2025-11-19T09:53:48.248Z] Remaining: 2
[2025-11-19T09:53:48.248Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.248Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.248Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.248Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.248Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.248Z] Existing timestamps: 3
[2025-11-19T09:53:48.248Z] Current count after filter: 3
[2025-11-19T09:53:48.248Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.249Z] New count: 4
[2025-11-19T09:53:48.249Z] Remaining: 1
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.249Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.249Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.249Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] Existing timestamps: 4
[2025-11-19T09:53:48.249Z] Current count after filter: 4
[2025-11-19T09:53:48.249Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.249Z] New count: 5
[2025-11-19T09:53:48.249Z] Remaining: 0
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.249Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.249Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.249Z] Identifier: test-block-1763546028247
[2025-11-19T09:53:48.249Z] Key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] üìñ Found existing entry for key: login:test-block-1763546028247
[2025-11-19T09:53:48.249Z] Existing timestamps: 5
[2025-11-19T09:53:48.249Z] Current count after filter: 5
[2025-11-19T09:53:48.249Z] Max requests allowed: 5
[2025-11-19T09:53:48.249Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.249Z] Current count: 5
[2025-11-19T09:53:48.249Z] Max allowed: 5
[2025-11-19T09:53:48.249Z] Retry after (seconds): 60
[2025-11-19T09:53:48.250Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.250Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.250Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.250Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.250Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.250Z] üìù Creating new entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.250Z] Current count after filter: 0
[2025-11-19T09:53:48.250Z] Max requests allowed: 2
[2025-11-19T09:53:48.250Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.250Z] New count: 1
[2025-11-19T09:53:48.251Z] Remaining: 1
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.251Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.251Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Existing timestamps: 1
[2025-11-19T09:53:48.251Z] Current count after filter: 1
[2025-11-19T09:53:48.251Z] Max requests allowed: 2
[2025-11-19T09:53:48.251Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.251Z] New count: 2
[2025-11-19T09:53:48.251Z] Remaining: 0
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.251Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.251Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.251Z] Existing timestamps: 2
[2025-11-19T09:53:48.251Z] Current count after filter: 2
[2025-11-19T09:53:48.251Z] Max requests allowed: 2
[2025-11-19T09:53:48.251Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.251Z] Current count: 2
[2025-11-19T09:53:48.251Z] Max allowed: 2
[2025-11-19T09:53:48.251Z] Retry after (seconds): 1
[2025-11-19T09:53:48.251Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.402Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.403Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T09:53:48.403Z] Identifier: test-reset-1763546028250
[2025-11-19T09:53:48.403Z] Key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.403Z] üìñ Found existing entry for key: test-reset:test-reset-1763546028250
[2025-11-19T09:53:48.403Z] Existing timestamps: 2
[2025-11-19T09:53:48.403Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T09:53:48.403Z] Current count after filter: 0
[2025-11-19T09:53:48.403Z] Max requests allowed: 2
[2025-11-19T09:53:48.403Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.403Z] New count: 1
[2025-11-19T09:53:48.403Z] Remaining: 1
[2025-11-19T09:53:48.403Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.404Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.404Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìù Creating new entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Current count after filter: 0
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 1
[2025-11-19T09:53:48.405Z] Remaining: 4
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.405Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Existing timestamps: 1
[2025-11-19T09:53:48.405Z] Current count after filter: 1
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 2
[2025-11-19T09:53:48.405Z] Remaining: 3
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.405Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.405Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.405Z] Existing timestamps: 2
[2025-11-19T09:53:48.405Z] Current count after filter: 2
[2025-11-19T09:53:48.405Z] Max requests allowed: 5
[2025-11-19T09:53:48.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.405Z] New count: 3
[2025-11-19T09:53:48.405Z] Remaining: 2
[2025-11-19T09:53:48.406Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.406Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.406Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.406Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.406Z] Existing timestamps: 3
[2025-11-19T09:53:48.406Z] Current count after filter: 3
[2025-11-19T09:53:48.406Z] Max requests allowed: 5
[2025-11-19T09:53:48.406Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.406Z] New count: 4
[2025-11-19T09:53:48.406Z] Remaining: 1
[2025-11-19T09:53:48.410Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.410Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.410Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.410Z] Existing timestamps: 4
[2025-11-19T09:53:48.410Z] Current count after filter: 4
[2025-11-19T09:53:48.410Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.411Z] New count: 5
[2025-11-19T09:53:48.411Z] Remaining: 0
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.411Z] Identifier: test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] Key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] üìñ Found existing entry for key: login:test-multi-1-1763546028404
[2025-11-19T09:53:48.411Z] Existing timestamps: 5
[2025-11-19T09:53:48.411Z] Current count after filter: 5
[2025-11-19T09:53:48.411Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.411Z] Current count: 5
[2025-11-19T09:53:48.411Z] Max allowed: 5
[2025-11-19T09:53:48.411Z] Retry after (seconds): 60
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.411Z] Identifier: test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] Key: login:test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] üìù Creating new entry for key: login:test-multi-2-1763546028404
[2025-11-19T09:53:48.411Z] Current count after filter: 0
[2025-11-19T09:53:48.411Z] Max requests allowed: 5
[2025-11-19T09:53:48.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.411Z] New count: 1
[2025-11-19T09:53:48.411Z] Remaining: 4
[2025-11-19T09:53:48.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.413Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.417Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T09:53:48.417Z] Identifier: test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] Key: login:test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] üìù Creating new entry for key: login:test-reset-time-1763546028413
[2025-11-19T09:53:48.417Z] Current count after filter: 0
[2025-11-19T09:53:48.417Z] Max requests allowed: 5
[2025-11-19T09:53:48.417Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.417Z] New count: 1
[2025-11-19T09:53:48.417Z] Remaining: 4
[2025-11-19T09:53:48.417Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.418Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.419Z] X-Test-ID header: null
[2025-11-19T09:53:48.419Z] Will use test ID?: false
[2025-11-19T09:53:48.419Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.419Z] X-Test-ID header: null
[2025-11-19T09:53:48.419Z] Will use test ID?: false
[2025-11-19T09:53:48.419Z] Using real IP: 192.168.1.2
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.419Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.419Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.420Z] Will use test ID?: false
[2025-11-19T09:53:48.420Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.420Z] Will use test ID?: false
[2025-11-19T09:53:48.420Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.420Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (env): true
[2025-11-19T09:53:48.420Z] E2E_TEST_MODE (final): true
[2025-11-19T09:53:48.420Z] X-Test-ID header: null
[2025-11-19T09:53:48.421Z] Will use test ID?: false
[2025-11-19T09:53:48.421Z] Using forwarded IP: 192.168.1.1
[2025-11-19T09:53:48.421Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T09:53:48.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.422Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.422Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] üìù Creating new entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.422Z] Current count after filter: 0
[2025-11-19T09:53:48.422Z] Max requests allowed: 3
[2025-11-19T09:53:48.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.423Z] New count: 1
[2025-11-19T09:53:48.423Z] Remaining: 2
[2025-11-19T09:53:48.423Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.524Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.525Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.525Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.525Z] Existing timestamps: 1
[2025-11-19T09:53:48.525Z] Current count after filter: 1
[2025-11-19T09:53:48.525Z] Max requests allowed: 3
[2025-11-19T09:53:48.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.525Z] New count: 2
[2025-11-19T09:53:48.525Z] Remaining: 1
[2025-11-19T09:53:48.525Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.637Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.638Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T09:53:48.638Z] Identifier: test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] Key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763546028422
[2025-11-19T09:53:48.638Z] Existing timestamps: 2
[2025-11-19T09:53:48.638Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T09:53:48.638Z] Current count after filter: 1
[2025-11-19T09:53:48.638Z] Max requests allowed: 3
[2025-11-19T09:53:48.638Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.638Z] New count: 2
[2025-11-19T09:53:48.638Z] Remaining: 1
[2025-11-19T09:53:48.638Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.639Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.639Z] Identifier: test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] Key: register:test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] üìù Creating new entry for key: register:test-format-allowed-1763546028639
[2025-11-19T09:53:48.639Z] Current count after filter: 0
[2025-11-19T09:53:48.639Z] Max requests allowed: 3
[2025-11-19T09:53:48.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.639Z] New count: 1
[2025-11-19T09:53:48.639Z] Remaining: 2
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.639Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.639Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.639Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] üìù Creating new entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.639Z] Current count after filter: 0
[2025-11-19T09:53:48.639Z] Max requests allowed: 3
[2025-11-19T09:53:48.639Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.639Z] New count: 1
[2025-11-19T09:53:48.640Z] Remaining: 2
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.640Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.640Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Existing timestamps: 1
[2025-11-19T09:53:48.640Z] Current count after filter: 1
[2025-11-19T09:53:48.640Z] Max requests allowed: 3
[2025-11-19T09:53:48.640Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.640Z] New count: 2
[2025-11-19T09:53:48.640Z] Remaining: 1
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.640Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.640Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.640Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.640Z] Existing timestamps: 2
[2025-11-19T09:53:48.640Z] Current count after filter: 2
[2025-11-19T09:53:48.640Z] Max requests allowed: 3
[2025-11-19T09:53:48.640Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T09:53:48.641Z] New count: 3
[2025-11-19T09:53:48.641Z] Remaining: 0
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T09:53:48.641Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T09:53:48.641Z] Identifier: test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] Key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] üìñ Found existing entry for key: register:test-format-blocked-1763546028639
[2025-11-19T09:53:48.641Z] Existing timestamps: 3
[2025-11-19T09:53:48.641Z] Current count after filter: 3
[2025-11-19T09:53:48.641Z] Max requests allowed: 3
[2025-11-19T09:53:48.641Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T09:53:48.641Z] Current count: 3
[2025-11-19T09:53:48.641Z] Max allowed: 3
[2025-11-19T09:53:48.641Z] Retry after (seconds): 60
[2025-11-19T09:53:48.641Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.040Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.041Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.042Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.042Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.042Z] üìù Creating new entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.042Z] Current count after filter: 0
[2025-11-19T11:18:39.042Z] Max requests allowed: 5
[2025-11-19T11:18:39.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.042Z] New count: 1
[2025-11-19T11:18:39.042Z] Remaining: 4
[2025-11-19T11:18:39.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.042Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.042Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 1
[2025-11-19T11:18:39.043Z] Current count after filter: 1
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.043Z] New count: 2
[2025-11-19T11:18:39.043Z] Remaining: 3
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.043Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 2
[2025-11-19T11:18:39.043Z] Current count after filter: 2
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.043Z] New count: 3
[2025-11-19T11:18:39.043Z] Remaining: 2
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.043Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.043Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.043Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.043Z] Existing timestamps: 3
[2025-11-19T11:18:39.043Z] Current count after filter: 3
[2025-11-19T11:18:39.043Z] Max requests allowed: 5
[2025-11-19T11:18:39.043Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.044Z] New count: 4
[2025-11-19T11:18:39.044Z] Remaining: 1
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.044Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.044Z] Identifier: test-allow-1763551119040
[2025-11-19T11:18:39.044Z] Key: login:test-allow-1763551119040
[2025-11-19T11:18:39.044Z] üìñ Found existing entry for key: login:test-allow-1763551119040
[2025-11-19T11:18:39.044Z] Existing timestamps: 4
[2025-11-19T11:18:39.044Z] Current count after filter: 4
[2025-11-19T11:18:39.044Z] Max requests allowed: 5
[2025-11-19T11:18:39.044Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.044Z] New count: 5
[2025-11-19T11:18:39.044Z] Remaining: 0
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.044Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.045Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] üìù Creating new entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] Current count after filter: 0
[2025-11-19T11:18:39.045Z] Max requests allowed: 5
[2025-11-19T11:18:39.045Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.045Z] New count: 1
[2025-11-19T11:18:39.045Z] Remaining: 4
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.045Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.045Z] Existing timestamps: 1
[2025-11-19T11:18:39.045Z] Current count after filter: 1
[2025-11-19T11:18:39.045Z] Max requests allowed: 5
[2025-11-19T11:18:39.045Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.045Z] New count: 2
[2025-11-19T11:18:39.045Z] Remaining: 3
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.045Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.045Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.045Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] Existing timestamps: 2
[2025-11-19T11:18:39.046Z] Current count after filter: 2
[2025-11-19T11:18:39.046Z] Max requests allowed: 5
[2025-11-19T11:18:39.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.046Z] New count: 3
[2025-11-19T11:18:39.046Z] Remaining: 2
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.046Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] Existing timestamps: 3
[2025-11-19T11:18:39.046Z] Current count after filter: 3
[2025-11-19T11:18:39.046Z] Max requests allowed: 5
[2025-11-19T11:18:39.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.046Z] New count: 4
[2025-11-19T11:18:39.046Z] Remaining: 1
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.046Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.046Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.046Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.046Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] Existing timestamps: 4
[2025-11-19T11:18:39.047Z] Current count after filter: 4
[2025-11-19T11:18:39.047Z] Max requests allowed: 5
[2025-11-19T11:18:39.047Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.047Z] New count: 5
[2025-11-19T11:18:39.047Z] Remaining: 0
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.047Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.047Z] Identifier: test-block-1763551119044
[2025-11-19T11:18:39.047Z] Key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] üìñ Found existing entry for key: login:test-block-1763551119044
[2025-11-19T11:18:39.047Z] Existing timestamps: 5
[2025-11-19T11:18:39.047Z] Current count after filter: 5
[2025-11-19T11:18:39.047Z] Max requests allowed: 5
[2025-11-19T11:18:39.047Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.047Z] Current count: 5
[2025-11-19T11:18:39.047Z] Max allowed: 5
[2025-11-19T11:18:39.047Z] Retry after (seconds): 60
[2025-11-19T11:18:39.047Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.048Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.048Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] üìù Creating new entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Current count after filter: 0
[2025-11-19T11:18:39.048Z] Max requests allowed: 2
[2025-11-19T11:18:39.048Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.048Z] New count: 1
[2025-11-19T11:18:39.048Z] Remaining: 1
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.048Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.048Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.048Z] Existing timestamps: 1
[2025-11-19T11:18:39.048Z] Current count after filter: 1
[2025-11-19T11:18:39.048Z] Max requests allowed: 2
[2025-11-19T11:18:39.048Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.049Z] New count: 2
[2025-11-19T11:18:39.049Z] Remaining: 0
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.049Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.049Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.049Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.049Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.049Z] Existing timestamps: 2
[2025-11-19T11:18:39.049Z] Current count after filter: 2
[2025-11-19T11:18:39.049Z] Max requests allowed: 2
[2025-11-19T11:18:39.049Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.049Z] Current count: 2
[2025-11-19T11:18:39.049Z] Max allowed: 2
[2025-11-19T11:18:39.049Z] Retry after (seconds): 1
[2025-11-19T11:18:39.049Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.201Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.202Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T11:18:39.202Z] Identifier: test-reset-1763551119048
[2025-11-19T11:18:39.202Z] Key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.202Z] üìñ Found existing entry for key: test-reset:test-reset-1763551119048
[2025-11-19T11:18:39.202Z] Existing timestamps: 2
[2025-11-19T11:18:39.202Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T11:18:39.202Z] Current count after filter: 0
[2025-11-19T11:18:39.202Z] Max requests allowed: 2
[2025-11-19T11:18:39.202Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.202Z] New count: 1
[2025-11-19T11:18:39.202Z] Remaining: 1
[2025-11-19T11:18:39.202Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.202Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.202Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.202Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] üìù Creating new entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.202Z] Current count after filter: 0
[2025-11-19T11:18:39.202Z] Max requests allowed: 5
[2025-11-19T11:18:39.203Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.203Z] New count: 1
[2025-11-19T11:18:39.203Z] Remaining: 4
[2025-11-19T11:18:39.203Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.203Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.203Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.203Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.203Z] Existing timestamps: 1
[2025-11-19T11:18:39.203Z] Current count after filter: 1
[2025-11-19T11:18:39.203Z] Max requests allowed: 5
[2025-11-19T11:18:39.203Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.204Z] New count: 2
[2025-11-19T11:18:39.204Z] Remaining: 3
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.204Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.204Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Existing timestamps: 2
[2025-11-19T11:18:39.204Z] Current count after filter: 2
[2025-11-19T11:18:39.204Z] Max requests allowed: 5
[2025-11-19T11:18:39.204Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.204Z] New count: 3
[2025-11-19T11:18:39.204Z] Remaining: 2
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.204Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.204Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.204Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.204Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Existing timestamps: 3
[2025-11-19T11:18:39.205Z] Current count after filter: 3
[2025-11-19T11:18:39.205Z] Max requests allowed: 5
[2025-11-19T11:18:39.205Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.205Z] New count: 4
[2025-11-19T11:18:39.205Z] Remaining: 1
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.205Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.205Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.205Z] Existing timestamps: 4
[2025-11-19T11:18:39.205Z] Current count after filter: 4
[2025-11-19T11:18:39.205Z] Max requests allowed: 5
[2025-11-19T11:18:39.205Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.205Z] New count: 5
[2025-11-19T11:18:39.205Z] Remaining: 0
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.205Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.205Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.206Z] Identifier: test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] Key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] üìñ Found existing entry for key: login:test-multi-1-1763551119202
[2025-11-19T11:18:39.206Z] Existing timestamps: 5
[2025-11-19T11:18:39.206Z] Current count after filter: 5
[2025-11-19T11:18:39.206Z] Max requests allowed: 5
[2025-11-19T11:18:39.206Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.206Z] Current count: 5
[2025-11-19T11:18:39.206Z] Max allowed: 5
[2025-11-19T11:18:39.206Z] Retry after (seconds): 60
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.206Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.206Z] Identifier: test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] Key: login:test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] üìù Creating new entry for key: login:test-multi-2-1763551119202
[2025-11-19T11:18:39.206Z] Current count after filter: 0
[2025-11-19T11:18:39.206Z] Max requests allowed: 5
[2025-11-19T11:18:39.206Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.206Z] New count: 1
[2025-11-19T11:18:39.206Z] Remaining: 4
[2025-11-19T11:18:39.206Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.207Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.210Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T11:18:39.211Z] Identifier: test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] Key: login:test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] üìù Creating new entry for key: login:test-reset-time-1763551119207
[2025-11-19T11:18:39.211Z] Current count after filter: 0
[2025-11-19T11:18:39.211Z] Max requests allowed: 5
[2025-11-19T11:18:39.211Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.211Z] New count: 1
[2025-11-19T11:18:39.211Z] Remaining: 4
[2025-11-19T11:18:39.211Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.220Z] X-Test-ID header: null
[2025-11-19T11:18:39.220Z] Will use test ID?: false
[2025-11-19T11:18:39.220Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.220Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.220Z] X-Test-ID header: null
[2025-11-19T11:18:39.220Z] Will use test ID?: false
[2025-11-19T11:18:39.220Z] Using real IP: 192.168.1.2
[2025-11-19T11:18:39.220Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.221Z] X-Test-ID header: null
[2025-11-19T11:18:39.221Z] Will use test ID?: false
[2025-11-19T11:18:39.221Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.221Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.221Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.222Z] X-Test-ID header: null
[2025-11-19T11:18:39.222Z] Will use test ID?: false
[2025-11-19T11:18:39.222Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T11:18:39.222Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.223Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (env): true
[2025-11-19T11:18:39.223Z] E2E_TEST_MODE (final): true
[2025-11-19T11:18:39.223Z] X-Test-ID header: null
[2025-11-19T11:18:39.223Z] Will use test ID?: false
[2025-11-19T11:18:39.223Z] Using forwarded IP: 192.168.1.1
[2025-11-19T11:18:39.223Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T11:18:39.224Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.224Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.224Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] üìù Creating new entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.224Z] Current count after filter: 0
[2025-11-19T11:18:39.224Z] Max requests allowed: 3
[2025-11-19T11:18:39.224Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.224Z] New count: 1
[2025-11-19T11:18:39.224Z] Remaining: 2
[2025-11-19T11:18:39.224Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.327Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.327Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.331Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.331Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.331Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.335Z] Existing timestamps: 1
[2025-11-19T11:18:39.336Z] Current count after filter: 1
[2025-11-19T11:18:39.336Z] Max requests allowed: 3
[2025-11-19T11:18:39.336Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.336Z] New count: 2
[2025-11-19T11:18:39.336Z] Remaining: 1
[2025-11-19T11:18:39.336Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.438Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.438Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T11:18:39.439Z] Identifier: test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] Key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763551119224
[2025-11-19T11:18:39.439Z] Existing timestamps: 2
[2025-11-19T11:18:39.439Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T11:18:39.439Z] Current count after filter: 1
[2025-11-19T11:18:39.439Z] Max requests allowed: 3
[2025-11-19T11:18:39.439Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.439Z] New count: 2
[2025-11-19T11:18:39.439Z] Remaining: 1
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.439Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.439Z] Identifier: test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] Key: register:test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] üìù Creating new entry for key: register:test-format-allowed-1763551119439
[2025-11-19T11:18:39.439Z] Current count after filter: 0
[2025-11-19T11:18:39.439Z] Max requests allowed: 3
[2025-11-19T11:18:39.439Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.439Z] New count: 1
[2025-11-19T11:18:39.439Z] Remaining: 2
[2025-11-19T11:18:39.439Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.440Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] üìù Creating new entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Current count after filter: 0
[2025-11-19T11:18:39.440Z] Max requests allowed: 3
[2025-11-19T11:18:39.440Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.440Z] New count: 1
[2025-11-19T11:18:39.440Z] Remaining: 2
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.440Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.440Z] Existing timestamps: 1
[2025-11-19T11:18:39.440Z] Current count after filter: 1
[2025-11-19T11:18:39.440Z] Max requests allowed: 3
[2025-11-19T11:18:39.440Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.440Z] New count: 2
[2025-11-19T11:18:39.440Z] Remaining: 1
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.440Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.440Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.441Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Existing timestamps: 2
[2025-11-19T11:18:39.441Z] Current count after filter: 2
[2025-11-19T11:18:39.441Z] Max requests allowed: 3
[2025-11-19T11:18:39.441Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T11:18:39.441Z] New count: 3
[2025-11-19T11:18:39.441Z] Remaining: 0
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T11:18:39.441Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T11:18:39.441Z] Identifier: test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] üìñ Found existing entry for key: register:test-format-blocked-1763551119440
[2025-11-19T11:18:39.441Z] Existing timestamps: 3
[2025-11-19T11:18:39.441Z] Current count after filter: 3
[2025-11-19T11:18:39.441Z] Max requests allowed: 3
[2025-11-19T11:18:39.441Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T11:18:39.441Z] Current count: 3
[2025-11-19T11:18:39.441Z] Max allowed: 3
[2025-11-19T11:18:39.441Z] Retry after (seconds): 60
[2025-11-19T11:18:39.441Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.779Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.781Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.781Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.781Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] üìù Creating new entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Current count after filter: 0
[2025-11-19T15:14:34.782Z] Max requests allowed: 5
[2025-11-19T15:14:34.782Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.782Z] New count: 1
[2025-11-19T15:14:34.782Z] Remaining: 4
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.782Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.782Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.782Z] Existing timestamps: 1
[2025-11-19T15:14:34.782Z] Current count after filter: 1
[2025-11-19T15:14:34.782Z] Max requests allowed: 5
[2025-11-19T15:14:34.782Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.782Z] New count: 2
[2025-11-19T15:14:34.782Z] Remaining: 3
[2025-11-19T15:14:34.782Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.783Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.783Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.783Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.783Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.783Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.783Z] Existing timestamps: 2
[2025-11-19T15:14:34.783Z] Current count after filter: 2
[2025-11-19T15:14:34.783Z] Max requests allowed: 5
[2025-11-19T15:14:34.783Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.783Z] New count: 3
[2025-11-19T15:14:34.783Z] Remaining: 2
[2025-11-19T15:14:34.783Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.784Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.784Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.784Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.784Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.784Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.784Z] Existing timestamps: 3
[2025-11-19T15:14:34.784Z] Current count after filter: 3
[2025-11-19T15:14:34.784Z] Max requests allowed: 5
[2025-11-19T15:14:34.784Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.784Z] New count: 4
[2025-11-19T15:14:34.784Z] Remaining: 1
[2025-11-19T15:14:34.784Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.785Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.785Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.785Z] Identifier: test-allow-1763565274779
[2025-11-19T15:14:34.785Z] Key: login:test-allow-1763565274779
[2025-11-19T15:14:34.785Z] üìñ Found existing entry for key: login:test-allow-1763565274779
[2025-11-19T15:14:34.785Z] Existing timestamps: 4
[2025-11-19T15:14:34.785Z] Current count after filter: 4
[2025-11-19T15:14:34.785Z] Max requests allowed: 5
[2025-11-19T15:14:34.785Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.785Z] New count: 5
[2025-11-19T15:14:34.785Z] Remaining: 0
[2025-11-19T15:14:34.785Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.786Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.786Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] üìù Creating new entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] Current count after filter: 0
[2025-11-19T15:14:34.786Z] Max requests allowed: 5
[2025-11-19T15:14:34.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.786Z] New count: 1
[2025-11-19T15:14:34.786Z] Remaining: 4
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.786Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.786Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.786Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.786Z] Existing timestamps: 1
[2025-11-19T15:14:34.786Z] Current count after filter: 1
[2025-11-19T15:14:34.786Z] Max requests allowed: 5
[2025-11-19T15:14:34.786Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.786Z] New count: 2
[2025-11-19T15:14:34.786Z] Remaining: 3
[2025-11-19T15:14:34.786Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.787Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.787Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] Existing timestamps: 2
[2025-11-19T15:14:34.787Z] Current count after filter: 2
[2025-11-19T15:14:34.787Z] Max requests allowed: 5
[2025-11-19T15:14:34.787Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.787Z] New count: 3
[2025-11-19T15:14:34.787Z] Remaining: 2
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.787Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.787Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.787Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.787Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.787Z] Existing timestamps: 3
[2025-11-19T15:14:34.787Z] Current count after filter: 3
[2025-11-19T15:14:34.787Z] Max requests allowed: 5
[2025-11-19T15:14:34.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.788Z] New count: 4
[2025-11-19T15:14:34.788Z] Remaining: 1
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.788Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.788Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.788Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.788Z] Existing timestamps: 4
[2025-11-19T15:14:34.788Z] Current count after filter: 4
[2025-11-19T15:14:34.788Z] Max requests allowed: 5
[2025-11-19T15:14:34.788Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.788Z] New count: 5
[2025-11-19T15:14:34.788Z] Remaining: 0
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.788Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.788Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.789Z] Identifier: test-block-1763565274786
[2025-11-19T15:14:34.789Z] Key: login:test-block-1763565274786
[2025-11-19T15:14:34.789Z] üìñ Found existing entry for key: login:test-block-1763565274786
[2025-11-19T15:14:34.789Z] Existing timestamps: 5
[2025-11-19T15:14:34.789Z] Current count after filter: 5
[2025-11-19T15:14:34.789Z] Max requests allowed: 5
[2025-11-19T15:14:34.789Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.789Z] Current count: 5
[2025-11-19T15:14:34.789Z] Max allowed: 5
[2025-11-19T15:14:34.789Z] Retry after (seconds): 60
[2025-11-19T15:14:34.789Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.789Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.789Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.789Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.789Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.789Z] üìù Creating new entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.789Z] Current count after filter: 0
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.790Z] New count: 1
[2025-11-19T15:14:34.790Z] Remaining: 1
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.790Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Existing timestamps: 1
[2025-11-19T15:14:34.790Z] Current count after filter: 1
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.790Z] New count: 2
[2025-11-19T15:14:34.790Z] Remaining: 0
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.790Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.790Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.790Z] Existing timestamps: 2
[2025-11-19T15:14:34.790Z] Current count after filter: 2
[2025-11-19T15:14:34.790Z] Max requests allowed: 2
[2025-11-19T15:14:34.790Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.790Z] Current count: 2
[2025-11-19T15:14:34.790Z] Max allowed: 2
[2025-11-19T15:14:34.790Z] Retry after (seconds): 1
[2025-11-19T15:14:34.790Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.943Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:34.943Z] Identifier: test-reset-1763565274789
[2025-11-19T15:14:34.943Z] Key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.943Z] üìñ Found existing entry for key: test-reset:test-reset-1763565274789
[2025-11-19T15:14:34.943Z] Existing timestamps: 2
[2025-11-19T15:14:34.943Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T15:14:34.943Z] Current count after filter: 0
[2025-11-19T15:14:34.943Z] Max requests allowed: 2
[2025-11-19T15:14:34.944Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.944Z] New count: 1
[2025-11-19T15:14:34.944Z] Remaining: 1
[2025-11-19T15:14:34.944Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.944Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìù Creating new entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Current count after filter: 0
[2025-11-19T15:14:34.945Z] Max requests allowed: 5
[2025-11-19T15:14:34.945Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.945Z] New count: 1
[2025-11-19T15:14:34.945Z] Remaining: 4
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Existing timestamps: 1
[2025-11-19T15:14:34.945Z] Current count after filter: 1
[2025-11-19T15:14:34.945Z] Max requests allowed: 5
[2025-11-19T15:14:34.945Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.945Z] New count: 2
[2025-11-19T15:14:34.945Z] Remaining: 3
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.945Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.945Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.945Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.945Z] Existing timestamps: 2
[2025-11-19T15:14:34.945Z] Current count after filter: 2
[2025-11-19T15:14:34.946Z] Max requests allowed: 5
[2025-11-19T15:14:34.946Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.946Z] New count: 3
[2025-11-19T15:14:34.946Z] Remaining: 2
[2025-11-19T15:14:34.946Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.946Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.946Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.946Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.946Z] Existing timestamps: 3
[2025-11-19T15:14:34.946Z] Current count after filter: 3
[2025-11-19T15:14:34.946Z] Max requests allowed: 5
[2025-11-19T15:14:34.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.947Z] New count: 4
[2025-11-19T15:14:34.947Z] Remaining: 1
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.947Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.947Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.947Z] Existing timestamps: 4
[2025-11-19T15:14:34.947Z] Current count after filter: 4
[2025-11-19T15:14:34.947Z] Max requests allowed: 5
[2025-11-19T15:14:34.947Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.947Z] New count: 5
[2025-11-19T15:14:34.947Z] Remaining: 0
[2025-11-19T15:14:34.947Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.948Z] Identifier: test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] Key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] üìñ Found existing entry for key: login:test-multi-1-1763565274944
[2025-11-19T15:14:34.948Z] Existing timestamps: 5
[2025-11-19T15:14:34.948Z] Current count after filter: 5
[2025-11-19T15:14:34.948Z] Max requests allowed: 5
[2025-11-19T15:14:34.948Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:34.948Z] Current count: 5
[2025-11-19T15:14:34.948Z] Max allowed: 5
[2025-11-19T15:14:34.948Z] Retry after (seconds): 60
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:34.948Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.948Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.948Z] Identifier: test-multi-2-1763565274944
[2025-11-19T15:14:34.948Z] Key: login:test-multi-2-1763565274944
[2025-11-19T15:14:34.948Z] üìù Creating new entry for key: login:test-multi-2-1763565274944
[2025-11-19T15:14:34.949Z] Current count after filter: 0
[2025-11-19T15:14:34.949Z] Max requests allowed: 5
[2025-11-19T15:14:34.949Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.949Z] New count: 1
[2025-11-19T15:14:34.949Z] Remaining: 4
[2025-11-19T15:14:34.949Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.949Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.949Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:34.949Z] Identifier: test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] Key: login:test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] üìù Creating new entry for key: login:test-reset-time-1763565274949
[2025-11-19T15:14:34.949Z] Current count after filter: 0
[2025-11-19T15:14:34.949Z] Max requests allowed: 5
[2025-11-19T15:14:34.950Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.950Z] New count: 1
[2025-11-19T15:14:34.950Z] Remaining: 4
[2025-11-19T15:14:34.950Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:34.952Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.952Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.952Z] X-Test-ID header: null
[2025-11-19T15:14:34.952Z] Will use test ID?: false
[2025-11-19T15:14:34.952Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.952Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.954Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.955Z] X-Test-ID header: null
[2025-11-19T15:14:34.955Z] Will use test ID?: false
[2025-11-19T15:14:34.955Z] Using real IP: 192.168.1.2
[2025-11-19T15:14:34.955Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.955Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.955Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.955Z] X-Test-ID header: null
[2025-11-19T15:14:34.955Z] Will use test ID?: false
[2025-11-19T15:14:34.956Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.956Z] X-Test-ID header: null
[2025-11-19T15:14:34.956Z] Will use test ID?: false
[2025-11-19T15:14:34.956Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.956Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:34.956Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:34.958Z] X-Test-ID header: null
[2025-11-19T15:14:34.959Z] Will use test ID?: false
[2025-11-19T15:14:34.959Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:34.959Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:34.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:34.961Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:34.961Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:34.961Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:34.961Z] üìù Creating new entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:34.962Z] Current count after filter: 0
[2025-11-19T15:14:34.962Z] Max requests allowed: 3
[2025-11-19T15:14:34.962Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:34.962Z] New count: 1
[2025-11-19T15:14:34.962Z] Remaining: 2
[2025-11-19T15:14:34.962Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.064Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.064Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:35.064Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.064Z] Existing timestamps: 1
[2025-11-19T15:14:35.064Z] Current count after filter: 1
[2025-11-19T15:14:35.064Z] Max requests allowed: 3
[2025-11-19T15:14:35.064Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.064Z] New count: 2
[2025-11-19T15:14:35.065Z] Remaining: 1
[2025-11-19T15:14:35.065Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.165Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.166Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:35.166Z] Identifier: test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] Key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565274959
[2025-11-19T15:14:35.166Z] Existing timestamps: 2
[2025-11-19T15:14:35.166Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T15:14:35.166Z] Current count after filter: 1
[2025-11-19T15:14:35.166Z] Max requests allowed: 3
[2025-11-19T15:14:35.166Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.166Z] New count: 2
[2025-11-19T15:14:35.166Z] Remaining: 1
[2025-11-19T15:14:35.166Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.166Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.166Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.166Z] Identifier: test-format-allowed-1763565275166
[2025-11-19T15:14:35.166Z] Key: register:test-format-allowed-1763565275166
[2025-11-19T15:14:35.166Z] üìù Creating new entry for key: register:test-format-allowed-1763565275166
[2025-11-19T15:14:35.167Z] Current count after filter: 0
[2025-11-19T15:14:35.167Z] Max requests allowed: 3
[2025-11-19T15:14:35.167Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.167Z] New count: 1
[2025-11-19T15:14:35.167Z] Remaining: 2
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.167Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.167Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] üìù Creating new entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.167Z] Current count after filter: 0
[2025-11-19T15:14:35.167Z] Max requests allowed: 3
[2025-11-19T15:14:35.167Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.167Z] New count: 1
[2025-11-19T15:14:35.167Z] Remaining: 2
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.167Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.167Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Existing timestamps: 1
[2025-11-19T15:14:35.168Z] Current count after filter: 1
[2025-11-19T15:14:35.168Z] Max requests allowed: 3
[2025-11-19T15:14:35.168Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.168Z] New count: 2
[2025-11-19T15:14:35.168Z] Remaining: 1
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.168Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Existing timestamps: 2
[2025-11-19T15:14:35.168Z] Current count after filter: 2
[2025-11-19T15:14:35.168Z] Max requests allowed: 3
[2025-11-19T15:14:35.168Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:35.168Z] New count: 3
[2025-11-19T15:14:35.168Z] Remaining: 0
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:35.168Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:35.168Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:35.168Z] Identifier: test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] Key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.168Z] üìñ Found existing entry for key: register:test-format-blocked-1763565275167
[2025-11-19T15:14:35.169Z] Existing timestamps: 3
[2025-11-19T15:14:35.169Z] Current count after filter: 3
[2025-11-19T15:14:35.169Z] Max requests allowed: 3
[2025-11-19T15:14:35.169Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:35.169Z] Current count: 3
[2025-11-19T15:14:35.169Z] Max allowed: 3
[2025-11-19T15:14:35.169Z] Retry after (seconds): 60
[2025-11-19T15:14:35.169Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.565Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.566Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.566Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.566Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.566Z] üìù Creating new entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.566Z] Current count after filter: 0
[2025-11-19T15:14:39.566Z] Max requests allowed: 5
[2025-11-19T15:14:39.566Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.566Z] New count: 1
[2025-11-19T15:14:39.566Z] Remaining: 4
[2025-11-19T15:14:39.567Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.567Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.567Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.567Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.567Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.567Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.567Z] Existing timestamps: 1
[2025-11-19T15:14:39.567Z] Current count after filter: 1
[2025-11-19T15:14:39.567Z] Max requests allowed: 5
[2025-11-19T15:14:39.567Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.567Z] New count: 2
[2025-11-19T15:14:39.567Z] Remaining: 3
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.568Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.568Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Existing timestamps: 2
[2025-11-19T15:14:39.568Z] Current count after filter: 2
[2025-11-19T15:14:39.568Z] Max requests allowed: 5
[2025-11-19T15:14:39.568Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.568Z] New count: 3
[2025-11-19T15:14:39.568Z] Remaining: 2
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.568Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.568Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.568Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.568Z] Existing timestamps: 3
[2025-11-19T15:14:39.568Z] Current count after filter: 3
[2025-11-19T15:14:39.568Z] Max requests allowed: 5
[2025-11-19T15:14:39.568Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.568Z] New count: 4
[2025-11-19T15:14:39.569Z] Remaining: 1
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.569Z] Identifier: test-allow-1763565279565
[2025-11-19T15:14:39.569Z] Key: login:test-allow-1763565279565
[2025-11-19T15:14:39.569Z] üìñ Found existing entry for key: login:test-allow-1763565279565
[2025-11-19T15:14:39.569Z] Existing timestamps: 4
[2025-11-19T15:14:39.569Z] Current count after filter: 4
[2025-11-19T15:14:39.569Z] Max requests allowed: 5
[2025-11-19T15:14:39.569Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.569Z] New count: 5
[2025-11-19T15:14:39.569Z] Remaining: 0
[2025-11-19T15:14:39.569Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.570Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.570Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.570Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] üìù Creating new entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] Current count after filter: 0
[2025-11-19T15:14:39.570Z] Max requests allowed: 5
[2025-11-19T15:14:39.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.570Z] New count: 1
[2025-11-19T15:14:39.570Z] Remaining: 4
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.570Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.570Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.570Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.570Z] Existing timestamps: 1
[2025-11-19T15:14:39.570Z] Current count after filter: 1
[2025-11-19T15:14:39.570Z] Max requests allowed: 5
[2025-11-19T15:14:39.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.570Z] New count: 2
[2025-11-19T15:14:39.570Z] Remaining: 3
[2025-11-19T15:14:39.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 2
[2025-11-19T15:14:39.571Z] Current count after filter: 2
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 3
[2025-11-19T15:14:39.571Z] Remaining: 2
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 3
[2025-11-19T15:14:39.571Z] Current count after filter: 3
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 4
[2025-11-19T15:14:39.571Z] Remaining: 1
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.571Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.571Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.571Z] Existing timestamps: 4
[2025-11-19T15:14:39.571Z] Current count after filter: 4
[2025-11-19T15:14:39.571Z] Max requests allowed: 5
[2025-11-19T15:14:39.571Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.571Z] New count: 5
[2025-11-19T15:14:39.571Z] Remaining: 0
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.571Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.571Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.572Z] Identifier: test-block-1763565279570
[2025-11-19T15:14:39.572Z] Key: login:test-block-1763565279570
[2025-11-19T15:14:39.572Z] üìñ Found existing entry for key: login:test-block-1763565279570
[2025-11-19T15:14:39.572Z] Existing timestamps: 5
[2025-11-19T15:14:39.572Z] Current count after filter: 5
[2025-11-19T15:14:39.572Z] Max requests allowed: 5
[2025-11-19T15:14:39.572Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.572Z] Current count: 5
[2025-11-19T15:14:39.572Z] Max allowed: 5
[2025-11-19T15:14:39.572Z] Retry after (seconds): 60
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.572Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.572Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.572Z] üìù Creating new entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Current count after filter: 0
[2025-11-19T15:14:39.572Z] Max requests allowed: 2
[2025-11-19T15:14:39.572Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.572Z] New count: 1
[2025-11-19T15:14:39.572Z] Remaining: 1
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.572Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.572Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.572Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.572Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Existing timestamps: 1
[2025-11-19T15:14:39.573Z] Current count after filter: 1
[2025-11-19T15:14:39.573Z] Max requests allowed: 2
[2025-11-19T15:14:39.573Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.573Z] New count: 2
[2025-11-19T15:14:39.573Z] Remaining: 0
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.573Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.573Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.573Z] Existing timestamps: 2
[2025-11-19T15:14:39.573Z] Current count after filter: 2
[2025-11-19T15:14:39.573Z] Max requests allowed: 2
[2025-11-19T15:14:39.573Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.573Z] Current count: 2
[2025-11-19T15:14:39.573Z] Max allowed: 2
[2025-11-19T15:14:39.573Z] Retry after (seconds): 1
[2025-11-19T15:14:39.573Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.724Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.725Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-19T15:14:39.726Z] Identifier: test-reset-1763565279572
[2025-11-19T15:14:39.726Z] Key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.727Z] üìñ Found existing entry for key: test-reset:test-reset-1763565279572
[2025-11-19T15:14:39.727Z] Existing timestamps: 2
[2025-11-19T15:14:39.727Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-19T15:14:39.727Z] Current count after filter: 0
[2025-11-19T15:14:39.728Z] Max requests allowed: 2
[2025-11-19T15:14:39.728Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.728Z] New count: 1
[2025-11-19T15:14:39.728Z] Remaining: 1
[2025-11-19T15:14:39.728Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìù Creating new entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Current count after filter: 0
[2025-11-19T15:14:39.729Z] Max requests allowed: 5
[2025-11-19T15:14:39.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.729Z] New count: 1
[2025-11-19T15:14:39.729Z] Remaining: 4
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Existing timestamps: 1
[2025-11-19T15:14:39.729Z] Current count after filter: 1
[2025-11-19T15:14:39.729Z] Max requests allowed: 5
[2025-11-19T15:14:39.729Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.729Z] New count: 2
[2025-11-19T15:14:39.729Z] Remaining: 3
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.729Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.729Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.729Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.729Z] Existing timestamps: 2
[2025-11-19T15:14:39.730Z] Current count after filter: 2
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 3
[2025-11-19T15:14:39.730Z] Remaining: 2
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Existing timestamps: 3
[2025-11-19T15:14:39.730Z] Current count after filter: 3
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 4
[2025-11-19T15:14:39.730Z] Remaining: 1
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Existing timestamps: 4
[2025-11-19T15:14:39.730Z] Current count after filter: 4
[2025-11-19T15:14:39.730Z] Max requests allowed: 5
[2025-11-19T15:14:39.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.730Z] New count: 5
[2025-11-19T15:14:39.730Z] Remaining: 0
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.730Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.730Z] Identifier: test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] Key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.730Z] üìñ Found existing entry for key: login:test-multi-1-1763565279729
[2025-11-19T15:14:39.731Z] Existing timestamps: 5
[2025-11-19T15:14:39.731Z] Current count after filter: 5
[2025-11-19T15:14:39.731Z] Max requests allowed: 5
[2025-11-19T15:14:39.731Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.731Z] Current count: 5
[2025-11-19T15:14:39.731Z] Max allowed: 5
[2025-11-19T15:14:39.731Z] Retry after (seconds): 60
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.731Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.731Z] Identifier: test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] Key: login:test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] üìù Creating new entry for key: login:test-multi-2-1763565279729
[2025-11-19T15:14:39.731Z] Current count after filter: 0
[2025-11-19T15:14:39.731Z] Max requests allowed: 5
[2025-11-19T15:14:39.731Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.731Z] New count: 1
[2025-11-19T15:14:39.731Z] Remaining: 4
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.731Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.732Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-19T15:14:39.732Z] Identifier: test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] Key: login:test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] üìù Creating new entry for key: login:test-reset-time-1763565279731
[2025-11-19T15:14:39.732Z] Current count after filter: 0
[2025-11-19T15:14:39.732Z] Max requests allowed: 5
[2025-11-19T15:14:39.732Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.732Z] New count: 1
[2025-11-19T15:14:39.732Z] Remaining: 4
[2025-11-19T15:14:39.732Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.733Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.733Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.733Z] X-Test-ID header: null
[2025-11-19T15:14:39.733Z] Will use test ID?: false
[2025-11-19T15:14:39.734Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.734Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.734Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.734Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.735Z] X-Test-ID header: null
[2025-11-19T15:14:39.735Z] Will use test ID?: false
[2025-11-19T15:14:39.735Z] Using real IP: 192.168.1.2
[2025-11-19T15:14:39.735Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.736Z] X-Test-ID header: null
[2025-11-19T15:14:39.736Z] Will use test ID?: false
[2025-11-19T15:14:39.736Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.736Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.736Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.736Z] X-Test-ID header: null
[2025-11-19T15:14:39.736Z] Will use test ID?: false
[2025-11-19T15:14:39.737Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (process.env): undefined
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (env): true
[2025-11-19T15:14:39.737Z] E2E_TEST_MODE (final): true
[2025-11-19T15:14:39.737Z] X-Test-ID header: null
[2025-11-19T15:14:39.737Z] Will use test ID?: false
[2025-11-19T15:14:39.737Z] Using forwarded IP: 192.168.1.1
[2025-11-19T15:14:39.737Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-19T15:14:39.737Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.737Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.737Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] üìù Creating new entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.737Z] Current count after filter: 0
[2025-11-19T15:14:39.737Z] Max requests allowed: 3
[2025-11-19T15:14:39.737Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.737Z] New count: 1
[2025-11-19T15:14:39.737Z] Remaining: 2
[2025-11-19T15:14:39.737Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.839Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.839Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.839Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.840Z] Existing timestamps: 1
[2025-11-19T15:14:39.840Z] Current count after filter: 1
[2025-11-19T15:14:39.840Z] Max requests allowed: 3
[2025-11-19T15:14:39.840Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.840Z] New count: 2
[2025-11-19T15:14:39.840Z] Remaining: 1
[2025-11-19T15:14:39.840Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.941Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-19T15:14:39.941Z] Identifier: test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] Key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763565279737
[2025-11-19T15:14:39.941Z] Existing timestamps: 2
[2025-11-19T15:14:39.941Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-19T15:14:39.941Z] Current count after filter: 1
[2025-11-19T15:14:39.941Z] Max requests allowed: 3
[2025-11-19T15:14:39.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.941Z] New count: 2
[2025-11-19T15:14:39.941Z] Remaining: 1
[2025-11-19T15:14:39.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.942Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.942Z] Identifier: test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] Key: register:test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] üìù Creating new entry for key: register:test-format-allowed-1763565279942
[2025-11-19T15:14:39.942Z] Current count after filter: 0
[2025-11-19T15:14:39.942Z] Max requests allowed: 3
[2025-11-19T15:14:39.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.942Z] New count: 1
[2025-11-19T15:14:39.942Z] Remaining: 2
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.943Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.943Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] üìù Creating new entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Current count after filter: 0
[2025-11-19T15:14:39.943Z] Max requests allowed: 3
[2025-11-19T15:14:39.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.943Z] New count: 1
[2025-11-19T15:14:39.943Z] Remaining: 2
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.943Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.943Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.943Z] Existing timestamps: 1
[2025-11-19T15:14:39.943Z] Current count after filter: 1
[2025-11-19T15:14:39.943Z] Max requests allowed: 3
[2025-11-19T15:14:39.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.943Z] New count: 2
[2025-11-19T15:14:39.943Z] Remaining: 1
[2025-11-19T15:14:39.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.944Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.944Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Existing timestamps: 2
[2025-11-19T15:14:39.944Z] Current count after filter: 2
[2025-11-19T15:14:39.944Z] Max requests allowed: 3
[2025-11-19T15:14:39.944Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-19T15:14:39.944Z] New count: 3
[2025-11-19T15:14:39.944Z] Remaining: 0
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-19T15:14:39.944Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-19T15:14:39.944Z] Identifier: test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] üìñ Found existing entry for key: register:test-format-blocked-1763565279942
[2025-11-19T15:14:39.944Z] Existing timestamps: 3
[2025-11-19T15:14:39.944Z] Current count after filter: 3
[2025-11-19T15:14:39.944Z] Max requests allowed: 3
[2025-11-19T15:14:39.944Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-19T15:14:39.944Z] Current count: 3
[2025-11-19T15:14:39.944Z] Max allowed: 3
[2025-11-19T15:14:39.944Z] Retry after (seconds): 60
[2025-11-19T15:14:39.944Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.482Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.483Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.484Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.484Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.484Z] üìù Creating new entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.484Z] Current count after filter: 0
[2025-11-20T00:07:00.484Z] Max requests allowed: 5
[2025-11-20T00:07:00.484Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.485Z] New count: 1
[2025-11-20T00:07:00.485Z] Remaining: 4
[2025-11-20T00:07:00.485Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.485Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.486Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.486Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.486Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.486Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.486Z] Existing timestamps: 1
[2025-11-20T00:07:00.486Z] Current count after filter: 1
[2025-11-20T00:07:00.487Z] Max requests allowed: 5
[2025-11-20T00:07:00.487Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.487Z] New count: 2
[2025-11-20T00:07:00.487Z] Remaining: 3
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.487Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.487Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Existing timestamps: 2
[2025-11-20T00:07:00.487Z] Current count after filter: 2
[2025-11-20T00:07:00.487Z] Max requests allowed: 5
[2025-11-20T00:07:00.487Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.487Z] New count: 3
[2025-11-20T00:07:00.487Z] Remaining: 2
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.487Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.487Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.487Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.487Z] Existing timestamps: 3
[2025-11-20T00:07:00.487Z] Current count after filter: 3
[2025-11-20T00:07:00.488Z] Max requests allowed: 5
[2025-11-20T00:07:00.488Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.488Z] New count: 4
[2025-11-20T00:07:00.488Z] Remaining: 1
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.488Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.488Z] Identifier: test-allow-1763597220482
[2025-11-20T00:07:00.488Z] Key: login:test-allow-1763597220482
[2025-11-20T00:07:00.488Z] üìñ Found existing entry for key: login:test-allow-1763597220482
[2025-11-20T00:07:00.488Z] Existing timestamps: 4
[2025-11-20T00:07:00.488Z] Current count after filter: 4
[2025-11-20T00:07:00.488Z] Max requests allowed: 5
[2025-11-20T00:07:00.488Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.488Z] New count: 5
[2025-11-20T00:07:00.488Z] Remaining: 0
[2025-11-20T00:07:00.488Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.489Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.489Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.489Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] üìù Creating new entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] Current count after filter: 0
[2025-11-20T00:07:00.489Z] Max requests allowed: 5
[2025-11-20T00:07:00.489Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.489Z] New count: 1
[2025-11-20T00:07:00.489Z] Remaining: 4
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.489Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.489Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.489Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.489Z] Existing timestamps: 1
[2025-11-20T00:07:00.489Z] Current count after filter: 1
[2025-11-20T00:07:00.489Z] Max requests allowed: 5
[2025-11-20T00:07:00.489Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.489Z] New count: 2
[2025-11-20T00:07:00.489Z] Remaining: 3
[2025-11-20T00:07:00.489Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.490Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.490Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.490Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] Existing timestamps: 2
[2025-11-20T00:07:00.490Z] Current count after filter: 2
[2025-11-20T00:07:00.490Z] Max requests allowed: 5
[2025-11-20T00:07:00.490Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.490Z] New count: 3
[2025-11-20T00:07:00.490Z] Remaining: 2
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.490Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.490Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.490Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.490Z] Existing timestamps: 3
[2025-11-20T00:07:00.490Z] Current count after filter: 3
[2025-11-20T00:07:00.490Z] Max requests allowed: 5
[2025-11-20T00:07:00.490Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.490Z] New count: 4
[2025-11-20T00:07:00.491Z] Remaining: 1
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.491Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.491Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.491Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] Existing timestamps: 4
[2025-11-20T00:07:00.491Z] Current count after filter: 4
[2025-11-20T00:07:00.491Z] Max requests allowed: 5
[2025-11-20T00:07:00.491Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.491Z] New count: 5
[2025-11-20T00:07:00.491Z] Remaining: 0
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.491Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.491Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.491Z] Identifier: test-block-1763597220489
[2025-11-20T00:07:00.491Z] Key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] üìñ Found existing entry for key: login:test-block-1763597220489
[2025-11-20T00:07:00.491Z] Existing timestamps: 5
[2025-11-20T00:07:00.491Z] Current count after filter: 5
[2025-11-20T00:07:00.491Z] Max requests allowed: 5
[2025-11-20T00:07:00.491Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.491Z] Current count: 5
[2025-11-20T00:07:00.492Z] Max allowed: 5
[2025-11-20T00:07:00.492Z] Retry after (seconds): 60
[2025-11-20T00:07:00.492Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.492Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìù Creating new entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Current count after filter: 0
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.493Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.493Z] New count: 1
[2025-11-20T00:07:00.493Z] Remaining: 1
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Existing timestamps: 1
[2025-11-20T00:07:00.493Z] Current count after filter: 1
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.493Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.493Z] New count: 2
[2025-11-20T00:07:00.493Z] Remaining: 0
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.493Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.493Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.493Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.493Z] Existing timestamps: 2
[2025-11-20T00:07:00.493Z] Current count after filter: 2
[2025-11-20T00:07:00.493Z] Max requests allowed: 2
[2025-11-20T00:07:00.494Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.494Z] Current count: 2
[2025-11-20T00:07:00.494Z] Max allowed: 2
[2025-11-20T00:07:00.494Z] Retry after (seconds): 1
[2025-11-20T00:07:00.494Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.645Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.646Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T00:07:00.646Z] Identifier: test-reset-1763597220492
[2025-11-20T00:07:00.646Z] Key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.646Z] üìñ Found existing entry for key: test-reset:test-reset-1763597220492
[2025-11-20T00:07:00.652Z] Existing timestamps: 2
[2025-11-20T00:07:00.652Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T00:07:00.652Z] Current count after filter: 0
[2025-11-20T00:07:00.653Z] Max requests allowed: 2
[2025-11-20T00:07:00.653Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.653Z] New count: 1
[2025-11-20T00:07:00.653Z] Remaining: 1
[2025-11-20T00:07:00.653Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.654Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.654Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.654Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] üìù Creating new entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.654Z] Current count after filter: 0
[2025-11-20T00:07:00.654Z] Max requests allowed: 5
[2025-11-20T00:07:00.654Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.654Z] New count: 1
[2025-11-20T00:07:00.654Z] Remaining: 4
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.655Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.655Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.655Z] Existing timestamps: 1
[2025-11-20T00:07:00.655Z] Current count after filter: 1
[2025-11-20T00:07:00.655Z] Max requests allowed: 5
[2025-11-20T00:07:00.655Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.655Z] New count: 2
[2025-11-20T00:07:00.655Z] Remaining: 3
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.655Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.655Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.656Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.656Z] Existing timestamps: 2
[2025-11-20T00:07:00.656Z] Current count after filter: 2
[2025-11-20T00:07:00.656Z] Max requests allowed: 5
[2025-11-20T00:07:00.656Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.656Z] New count: 3
[2025-11-20T00:07:00.656Z] Remaining: 2
[2025-11-20T00:07:00.656Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.656Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.660Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.660Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.660Z] Existing timestamps: 3
[2025-11-20T00:07:00.666Z] Current count after filter: 3
[2025-11-20T00:07:00.666Z] Max requests allowed: 5
[2025-11-20T00:07:00.666Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.666Z] New count: 4
[2025-11-20T00:07:00.666Z] Remaining: 1
[2025-11-20T00:07:00.666Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.666Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.666Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.666Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.666Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.666Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.667Z] Existing timestamps: 4
[2025-11-20T00:07:00.669Z] Current count after filter: 4
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.670Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.670Z] New count: 5
[2025-11-20T00:07:00.670Z] Remaining: 0
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.670Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.670Z] Identifier: test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] Key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] üìñ Found existing entry for key: login:test-multi-1-1763597220654
[2025-11-20T00:07:00.670Z] Existing timestamps: 5
[2025-11-20T00:07:00.670Z] Current count after filter: 5
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.670Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.670Z] Current count: 5
[2025-11-20T00:07:00.670Z] Max allowed: 5
[2025-11-20T00:07:00.670Z] Retry after (seconds): 60
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T00:07:00.670Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.670Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.670Z] Identifier: test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] Key: login:test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] üìù Creating new entry for key: login:test-multi-2-1763597220654
[2025-11-20T00:07:00.670Z] Current count after filter: 0
[2025-11-20T00:07:00.670Z] Max requests allowed: 5
[2025-11-20T00:07:00.676Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.676Z] New count: 1
[2025-11-20T00:07:00.676Z] Remaining: 4
[2025-11-20T00:07:00.676Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.677Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T00:07:00.681Z] Identifier: test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] Key: login:test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] üìù Creating new entry for key: login:test-reset-time-1763597220677
[2025-11-20T00:07:00.681Z] Current count after filter: 0
[2025-11-20T00:07:00.681Z] Max requests allowed: 5
[2025-11-20T00:07:00.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.686Z] New count: 1
[2025-11-20T00:07:00.687Z] Remaining: 4
[2025-11-20T00:07:00.687Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.689Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.690Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.692Z] X-Test-ID header: null
[2025-11-20T00:07:00.692Z] Will use test ID?: false
[2025-11-20T00:07:00.692Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.692Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.693Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.693Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.693Z] X-Test-ID header: null
[2025-11-20T00:07:00.693Z] Will use test ID?: false
[2025-11-20T00:07:00.693Z] Using real IP: 192.168.1.2
[2025-11-20T00:07:00.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.694Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.694Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.694Z] X-Test-ID header: null
[2025-11-20T00:07:00.694Z] Will use test ID?: false
[2025-11-20T00:07:00.694Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.694Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.700Z] X-Test-ID header: null
[2025-11-20T00:07:00.700Z] Will use test ID?: false
[2025-11-20T00:07:00.700Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (env): true
[2025-11-20T00:07:00.700Z] E2E_TEST_MODE (final): true
[2025-11-20T00:07:00.700Z] X-Test-ID header: null
[2025-11-20T00:07:00.700Z] Will use test ID?: false
[2025-11-20T00:07:00.700Z] Using forwarded IP: 192.168.1.1
[2025-11-20T00:07:00.700Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T00:07:00.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.701Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.701Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] üìù Creating new entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.701Z] Current count after filter: 0
[2025-11-20T00:07:00.701Z] Max requests allowed: 3
[2025-11-20T00:07:00.706Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.707Z] New count: 1
[2025-11-20T00:07:00.707Z] Remaining: 2
[2025-11-20T00:07:00.707Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.836Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.836Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.837Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.837Z] Existing timestamps: 1
[2025-11-20T00:07:00.837Z] Current count after filter: 1
[2025-11-20T00:07:00.837Z] Max requests allowed: 3
[2025-11-20T00:07:00.837Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.837Z] New count: 2
[2025-11-20T00:07:00.837Z] Remaining: 1
[2025-11-20T00:07:00.837Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.938Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.939Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T00:07:00.939Z] Identifier: test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] Key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763597220701
[2025-11-20T00:07:00.939Z] Existing timestamps: 2
[2025-11-20T00:07:00.939Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-20T00:07:00.939Z] Current count after filter: 1
[2025-11-20T00:07:00.939Z] Max requests allowed: 3
[2025-11-20T00:07:00.939Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.939Z] New count: 2
[2025-11-20T00:07:00.939Z] Remaining: 1
[2025-11-20T00:07:00.939Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.940Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.940Z] Identifier: test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] Key: register:test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] üìù Creating new entry for key: register:test-format-allowed-1763597220940
[2025-11-20T00:07:00.940Z] Current count after filter: 0
[2025-11-20T00:07:00.940Z] Max requests allowed: 3
[2025-11-20T00:07:00.940Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.940Z] New count: 1
[2025-11-20T00:07:00.940Z] Remaining: 2
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.940Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.940Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.941Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] üìù Creating new entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Current count after filter: 0
[2025-11-20T00:07:00.941Z] Max requests allowed: 3
[2025-11-20T00:07:00.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.941Z] New count: 1
[2025-11-20T00:07:00.941Z] Remaining: 2
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.941Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.941Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.941Z] Existing timestamps: 1
[2025-11-20T00:07:00.941Z] Current count after filter: 1
[2025-11-20T00:07:00.941Z] Max requests allowed: 3
[2025-11-20T00:07:00.941Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.941Z] New count: 2
[2025-11-20T00:07:00.941Z] Remaining: 1
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.941Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.941Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.942Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.942Z] Existing timestamps: 2
[2025-11-20T00:07:00.942Z] Current count after filter: 2
[2025-11-20T00:07:00.942Z] Max requests allowed: 3
[2025-11-20T00:07:00.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T00:07:00.942Z] New count: 3
[2025-11-20T00:07:00.942Z] Remaining: 0
[2025-11-20T00:07:00.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T00:07:00.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T00:07:00.942Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T00:07:00.942Z] Identifier: test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] Key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] üìñ Found existing entry for key: register:test-format-blocked-1763597220940
[2025-11-20T00:07:00.943Z] Existing timestamps: 3
[2025-11-20T00:07:00.943Z] Current count after filter: 3
[2025-11-20T00:07:00.943Z] Max requests allowed: 3
[2025-11-20T00:07:00.943Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T00:07:00.943Z] Current count: 3
[2025-11-20T00:07:00.943Z] Max allowed: 3
[2025-11-20T00:07:00.943Z] Retry after (seconds): 60
[2025-11-20T00:07:00.943Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.815Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.815Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.816Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] üìù Creating new entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Current count after filter: 0
[2025-11-20T07:12:01.816Z] Max requests allowed: 5
[2025-11-20T07:12:01.816Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.816Z] New count: 1
[2025-11-20T07:12:01.816Z] Remaining: 4
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.816Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.816Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.816Z] Existing timestamps: 1
[2025-11-20T07:12:01.816Z] Current count after filter: 1
[2025-11-20T07:12:01.816Z] Max requests allowed: 5
[2025-11-20T07:12:01.816Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.816Z] New count: 2
[2025-11-20T07:12:01.816Z] Remaining: 3
[2025-11-20T07:12:01.816Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 2
[2025-11-20T07:12:01.817Z] Current count after filter: 2
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 3
[2025-11-20T07:12:01.817Z] Remaining: 2
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 3
[2025-11-20T07:12:01.817Z] Current count after filter: 3
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 4
[2025-11-20T07:12:01.817Z] Remaining: 1
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.817Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.817Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.817Z] Identifier: test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] üìñ Found existing entry for key: login:test-allow-1763622721815
[2025-11-20T07:12:01.817Z] Existing timestamps: 4
[2025-11-20T07:12:01.817Z] Current count after filter: 4
[2025-11-20T07:12:01.817Z] Max requests allowed: 5
[2025-11-20T07:12:01.817Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.817Z] New count: 5
[2025-11-20T07:12:01.817Z] Remaining: 0
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.818Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.818Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.818Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] üìù Creating new entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] Current count after filter: 0
[2025-11-20T07:12:01.818Z] Max requests allowed: 5
[2025-11-20T07:12:01.818Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.818Z] New count: 1
[2025-11-20T07:12:01.818Z] Remaining: 4
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.818Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.818Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.818Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.818Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.818Z] Existing timestamps: 1
[2025-11-20T07:12:01.818Z] Current count after filter: 1
[2025-11-20T07:12:01.818Z] Max requests allowed: 5
[2025-11-20T07:12:01.818Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.818Z] New count: 2
[2025-11-20T07:12:01.819Z] Remaining: 3
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 2
[2025-11-20T07:12:01.819Z] Current count after filter: 2
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.819Z] New count: 3
[2025-11-20T07:12:01.819Z] Remaining: 2
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 3
[2025-11-20T07:12:01.819Z] Current count after filter: 3
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.819Z] New count: 4
[2025-11-20T07:12:01.819Z] Remaining: 1
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.819Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.819Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.819Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.819Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.819Z] Existing timestamps: 4
[2025-11-20T07:12:01.819Z] Current count after filter: 4
[2025-11-20T07:12:01.819Z] Max requests allowed: 5
[2025-11-20T07:12:01.819Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.820Z] New count: 5
[2025-11-20T07:12:01.820Z] Remaining: 0
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.820Z] Identifier: test-block-1763622721818
[2025-11-20T07:12:01.820Z] Key: login:test-block-1763622721818
[2025-11-20T07:12:01.820Z] üìñ Found existing entry for key: login:test-block-1763622721818
[2025-11-20T07:12:01.820Z] Existing timestamps: 5
[2025-11-20T07:12:01.820Z] Current count after filter: 5
[2025-11-20T07:12:01.820Z] Max requests allowed: 5
[2025-11-20T07:12:01.820Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.820Z] Current count: 5
[2025-11-20T07:12:01.820Z] Max allowed: 5
[2025-11-20T07:12:01.820Z] Retry after (seconds): 60
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.820Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] üìù Creating new entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Current count after filter: 0
[2025-11-20T07:12:01.820Z] Max requests allowed: 2
[2025-11-20T07:12:01.820Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.820Z] New count: 1
[2025-11-20T07:12:01.820Z] Remaining: 1
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.820Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.820Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.820Z] Existing timestamps: 1
[2025-11-20T07:12:01.820Z] Current count after filter: 1
[2025-11-20T07:12:01.821Z] Max requests allowed: 2
[2025-11-20T07:12:01.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.821Z] New count: 2
[2025-11-20T07:12:01.821Z] Remaining: 0
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.821Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.821Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.821Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.821Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.821Z] Existing timestamps: 2
[2025-11-20T07:12:01.821Z] Current count after filter: 2
[2025-11-20T07:12:01.821Z] Max requests allowed: 2
[2025-11-20T07:12:01.821Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.821Z] Current count: 2
[2025-11-20T07:12:01.821Z] Max allowed: 2
[2025-11-20T07:12:01.821Z] Retry after (seconds): 1
[2025-11-20T07:12:01.821Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.974Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.974Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T07:12:01.974Z] Identifier: test-reset-1763622721820
[2025-11-20T07:12:01.974Z] Key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.974Z] üìñ Found existing entry for key: test-reset:test-reset-1763622721820
[2025-11-20T07:12:01.974Z] Existing timestamps: 2
[2025-11-20T07:12:01.974Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T07:12:01.974Z] Current count after filter: 0
[2025-11-20T07:12:01.974Z] Max requests allowed: 2
[2025-11-20T07:12:01.974Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.975Z] New count: 1
[2025-11-20T07:12:01.975Z] Remaining: 1
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.975Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.975Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] üìù Creating new entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Current count after filter: 0
[2025-11-20T07:12:01.975Z] Max requests allowed: 5
[2025-11-20T07:12:01.975Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.975Z] New count: 1
[2025-11-20T07:12:01.975Z] Remaining: 4
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.975Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.975Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.975Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.975Z] Existing timestamps: 1
[2025-11-20T07:12:01.975Z] Current count after filter: 1
[2025-11-20T07:12:01.975Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 2
[2025-11-20T07:12:01.976Z] Remaining: 3
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.976Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Existing timestamps: 2
[2025-11-20T07:12:01.976Z] Current count after filter: 2
[2025-11-20T07:12:01.976Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 3
[2025-11-20T07:12:01.976Z] Remaining: 2
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.976Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.976Z] Existing timestamps: 3
[2025-11-20T07:12:01.976Z] Current count after filter: 3
[2025-11-20T07:12:01.976Z] Max requests allowed: 5
[2025-11-20T07:12:01.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.976Z] New count: 4
[2025-11-20T07:12:01.976Z] Remaining: 1
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Existing timestamps: 4
[2025-11-20T07:12:01.977Z] Current count after filter: 4
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.977Z] New count: 5
[2025-11-20T07:12:01.977Z] Remaining: 0
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.977Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] üìñ Found existing entry for key: login:test-multi-1-1763622721975
[2025-11-20T07:12:01.977Z] Existing timestamps: 5
[2025-11-20T07:12:01.977Z] Current count after filter: 5
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T07:12:01.977Z] Current count: 5
[2025-11-20T07:12:01.977Z] Max allowed: 5
[2025-11-20T07:12:01.977Z] Retry after (seconds): 60
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.977Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.977Z] Identifier: test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] Key: login:test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] üìù Creating new entry for key: login:test-multi-2-1763622721975
[2025-11-20T07:12:01.977Z] Current count after filter: 0
[2025-11-20T07:12:01.977Z] Max requests allowed: 5
[2025-11-20T07:12:01.977Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.977Z] New count: 1
[2025-11-20T07:12:01.977Z] Remaining: 4
[2025-11-20T07:12:01.977Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.978Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.978Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T07:12:01.978Z] Identifier: test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] Key: login:test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] üìù Creating new entry for key: login:test-reset-time-1763622721978
[2025-11-20T07:12:01.978Z] Current count after filter: 0
[2025-11-20T07:12:01.978Z] Max requests allowed: 5
[2025-11-20T07:12:01.978Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.978Z] New count: 1
[2025-11-20T07:12:01.978Z] Remaining: 4
[2025-11-20T07:12:01.978Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.979Z] X-Test-ID header: null
[2025-11-20T07:12:01.979Z] Will use test ID?: false
[2025-11-20T07:12:01.979Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.979Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.979Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] Using real IP: 192.168.1.2
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.980Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.980Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.980Z] X-Test-ID header: null
[2025-11-20T07:12:01.980Z] Will use test ID?: false
[2025-11-20T07:12:01.980Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (env): true
[2025-11-20T07:12:01.981Z] E2E_TEST_MODE (final): true
[2025-11-20T07:12:01.981Z] X-Test-ID header: null
[2025-11-20T07:12:01.981Z] Will use test ID?: false
[2025-11-20T07:12:01.981Z] Using forwarded IP: 192.168.1.1
[2025-11-20T07:12:01.981Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T07:12:01.981Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T07:12:01.981Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T07:12:01.981Z] Identifier: test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] Key: test-sliding:test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] üìù Creating new entry for key: test-sliding:test-sliding-1763622721981
[2025-11-20T07:12:01.981Z] Current count after filter: 0
[2025-11-20T07:12:01.981Z] Max requests allowed: 3
[2025-11-20T07:12:01.981Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T07:12:01.981Z] New count: 1
[2025-11-20T07:12:01.981Z] Remaining: 2
[2025-11-20T07:12:01.981Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.048Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.048Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.049Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.049Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.049Z] üìù Creating new entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.049Z] Current count after filter: 0
[2025-11-20T11:45:12.049Z] Max requests allowed: 5
[2025-11-20T11:45:12.049Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.049Z] New count: 1
[2025-11-20T11:45:12.049Z] Remaining: 4
[2025-11-20T11:45:12.049Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.049Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.049Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.050Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Existing timestamps: 1
[2025-11-20T11:45:12.050Z] Current count after filter: 1
[2025-11-20T11:45:12.050Z] Max requests allowed: 5
[2025-11-20T11:45:12.050Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.050Z] New count: 2
[2025-11-20T11:45:12.050Z] Remaining: 3
[2025-11-20T11:45:12.050Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.050Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.050Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.050Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.050Z] Existing timestamps: 2
[2025-11-20T11:45:12.050Z] Current count after filter: 2
[2025-11-20T11:45:12.050Z] Max requests allowed: 5
[2025-11-20T11:45:12.050Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.050Z] New count: 3
[2025-11-20T11:45:12.051Z] Remaining: 2
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.051Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.051Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Existing timestamps: 3
[2025-11-20T11:45:12.051Z] Current count after filter: 3
[2025-11-20T11:45:12.051Z] Max requests allowed: 5
[2025-11-20T11:45:12.051Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.051Z] New count: 4
[2025-11-20T11:45:12.051Z] Remaining: 1
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.051Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.051Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.051Z] Identifier: test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] üìñ Found existing entry for key: login:test-allow-1763639112047
[2025-11-20T11:45:12.051Z] Existing timestamps: 4
[2025-11-20T11:45:12.051Z] Current count after filter: 4
[2025-11-20T11:45:12.051Z] Max requests allowed: 5
[2025-11-20T11:45:12.051Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.051Z] New count: 5
[2025-11-20T11:45:12.052Z] Remaining: 0
[2025-11-20T11:45:12.052Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.053Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.054Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.054Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.054Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.054Z] üìù Creating new entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.054Z] Current count after filter: 0
[2025-11-20T11:45:12.054Z] Max requests allowed: 5
[2025-11-20T11:45:12.054Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.054Z] New count: 1
[2025-11-20T11:45:12.055Z] Remaining: 4
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.055Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.055Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.055Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] Existing timestamps: 1
[2025-11-20T11:45:12.055Z] Current count after filter: 1
[2025-11-20T11:45:12.055Z] Max requests allowed: 5
[2025-11-20T11:45:12.055Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.055Z] New count: 2
[2025-11-20T11:45:12.055Z] Remaining: 3
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.055Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.055Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.055Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.055Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.055Z] Existing timestamps: 2
[2025-11-20T11:45:12.055Z] Current count after filter: 2
[2025-11-20T11:45:12.055Z] Max requests allowed: 5
[2025-11-20T11:45:12.055Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.055Z] New count: 3
[2025-11-20T11:45:12.056Z] Remaining: 2
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] Existing timestamps: 3
[2025-11-20T11:45:12.056Z] Current count after filter: 3
[2025-11-20T11:45:12.056Z] Max requests allowed: 5
[2025-11-20T11:45:12.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.056Z] New count: 4
[2025-11-20T11:45:12.056Z] Remaining: 1
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.056Z] Existing timestamps: 4
[2025-11-20T11:45:12.056Z] Current count after filter: 4
[2025-11-20T11:45:12.056Z] Max requests allowed: 5
[2025-11-20T11:45:12.056Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.056Z] New count: 5
[2025-11-20T11:45:12.056Z] Remaining: 0
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.056Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.056Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.056Z] Identifier: test-block-1763639112053
[2025-11-20T11:45:12.056Z] Key: login:test-block-1763639112053
[2025-11-20T11:45:12.057Z] üìñ Found existing entry for key: login:test-block-1763639112053
[2025-11-20T11:45:12.057Z] Existing timestamps: 5
[2025-11-20T11:45:12.057Z] Current count after filter: 5
[2025-11-20T11:45:12.057Z] Max requests allowed: 5
[2025-11-20T11:45:12.057Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.057Z] Current count: 5
[2025-11-20T11:45:12.057Z] Max allowed: 5
[2025-11-20T11:45:12.057Z] Retry after (seconds): 60
[2025-11-20T11:45:12.057Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.057Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.057Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.057Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.057Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.057Z] üìù Creating new entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.057Z] Current count after filter: 0
[2025-11-20T11:45:12.057Z] Max requests allowed: 2
[2025-11-20T11:45:12.057Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.058Z] New count: 1
[2025-11-20T11:45:12.058Z] Remaining: 1
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.058Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.058Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Existing timestamps: 1
[2025-11-20T11:45:12.058Z] Current count after filter: 1
[2025-11-20T11:45:12.058Z] Max requests allowed: 2
[2025-11-20T11:45:12.058Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.058Z] New count: 2
[2025-11-20T11:45:12.058Z] Remaining: 0
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.058Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.058Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.058Z] Existing timestamps: 2
[2025-11-20T11:45:12.058Z] Current count after filter: 2
[2025-11-20T11:45:12.058Z] Max requests allowed: 2
[2025-11-20T11:45:12.058Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.058Z] Current count: 2
[2025-11-20T11:45:12.058Z] Max allowed: 2
[2025-11-20T11:45:12.058Z] Retry after (seconds): 1
[2025-11-20T11:45:12.058Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.210Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.210Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-20T11:45:12.210Z] Identifier: test-reset-1763639112057
[2025-11-20T11:45:12.210Z] Key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.210Z] üìñ Found existing entry for key: test-reset:test-reset-1763639112057
[2025-11-20T11:45:12.210Z] Existing timestamps: 2
[2025-11-20T11:45:12.210Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-20T11:45:12.211Z] Current count after filter: 0
[2025-11-20T11:45:12.211Z] Max requests allowed: 2
[2025-11-20T11:45:12.211Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.211Z] New count: 1
[2025-11-20T11:45:12.211Z] Remaining: 1
[2025-11-20T11:45:12.212Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.212Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.212Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.212Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.212Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.212Z] üìù Creating new entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.213Z] Current count after filter: 0
[2025-11-20T11:45:12.214Z] Max requests allowed: 5
[2025-11-20T11:45:12.214Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.214Z] New count: 1
[2025-11-20T11:45:12.214Z] Remaining: 4
[2025-11-20T11:45:12.214Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.214Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.214Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.215Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Existing timestamps: 1
[2025-11-20T11:45:12.215Z] Current count after filter: 1
[2025-11-20T11:45:12.215Z] Max requests allowed: 5
[2025-11-20T11:45:12.215Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.215Z] New count: 2
[2025-11-20T11:45:12.215Z] Remaining: 3
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.215Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.215Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.215Z] Existing timestamps: 2
[2025-11-20T11:45:12.215Z] Current count after filter: 2
[2025-11-20T11:45:12.215Z] Max requests allowed: 5
[2025-11-20T11:45:12.215Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.215Z] New count: 3
[2025-11-20T11:45:12.215Z] Remaining: 2
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.215Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.216Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.216Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Existing timestamps: 3
[2025-11-20T11:45:12.216Z] Current count after filter: 3
[2025-11-20T11:45:12.216Z] Max requests allowed: 5
[2025-11-20T11:45:12.216Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.216Z] New count: 4
[2025-11-20T11:45:12.216Z] Remaining: 1
[2025-11-20T11:45:12.216Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.216Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.216Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.216Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.216Z] Existing timestamps: 4
[2025-11-20T11:45:12.216Z] Current count after filter: 4
[2025-11-20T11:45:12.216Z] Max requests allowed: 5
[2025-11-20T11:45:12.220Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.220Z] New count: 5
[2025-11-20T11:45:12.220Z] Remaining: 0
[2025-11-20T11:45:12.220Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.220Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.220Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.220Z] Identifier: test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] Key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] üìñ Found existing entry for key: login:test-multi-1-1763639112212
[2025-11-20T11:45:12.220Z] Existing timestamps: 5
[2025-11-20T11:45:12.220Z] Current count after filter: 5
[2025-11-20T11:45:12.220Z] Max requests allowed: 5
[2025-11-20T11:45:12.220Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.220Z] Current count: 5
[2025-11-20T11:45:12.221Z] Max allowed: 5
[2025-11-20T11:45:12.221Z] Retry after (seconds): 60
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.221Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.221Z] Identifier: test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] Key: login:test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] üìù Creating new entry for key: login:test-multi-2-1763639112212
[2025-11-20T11:45:12.221Z] Current count after filter: 0
[2025-11-20T11:45:12.221Z] Max requests allowed: 5
[2025-11-20T11:45:12.221Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.221Z] New count: 1
[2025-11-20T11:45:12.221Z] Remaining: 4
[2025-11-20T11:45:12.221Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.222Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.222Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:12.222Z] Identifier: test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] Key: login:test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] üìù Creating new entry for key: login:test-reset-time-1763639112222
[2025-11-20T11:45:12.222Z] Current count after filter: 0
[2025-11-20T11:45:12.222Z] Max requests allowed: 5
[2025-11-20T11:45:12.222Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.222Z] New count: 1
[2025-11-20T11:45:12.222Z] Remaining: 4
[2025-11-20T11:45:12.222Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.223Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.223Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.223Z] X-Test-ID header: null
[2025-11-20T11:45:12.223Z] Will use test ID?: false
[2025-11-20T11:45:12.223Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.223Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.224Z] X-Test-ID header: null
[2025-11-20T11:45:12.224Z] Will use test ID?: false
[2025-11-20T11:45:12.224Z] Using real IP: 192.168.1.2
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.224Z] X-Test-ID header: null
[2025-11-20T11:45:12.224Z] Will use test ID?: false
[2025-11-20T11:45:12.224Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.224Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.224Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.225Z] X-Test-ID header: null
[2025-11-20T11:45:12.225Z] Will use test ID?: false
[2025-11-20T11:45:12.225Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (process.env): undefined
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:12.225Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:12.225Z] X-Test-ID header: null
[2025-11-20T11:45:12.225Z] Will use test ID?: false
[2025-11-20T11:45:12.225Z] Using forwarded IP: 192.168.1.1
[2025-11-20T11:45:12.225Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:12.225Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.225Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.225Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] üìù Creating new entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.225Z] Current count after filter: 0
[2025-11-20T11:45:12.226Z] Max requests allowed: 3
[2025-11-20T11:45:12.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.226Z] New count: 1
[2025-11-20T11:45:12.226Z] Remaining: 2
[2025-11-20T11:45:12.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.327Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.327Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.327Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.327Z] Existing timestamps: 1
[2025-11-20T11:45:12.328Z] Current count after filter: 1
[2025-11-20T11:45:12.328Z] Max requests allowed: 3
[2025-11-20T11:45:12.328Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.328Z] New count: 2
[2025-11-20T11:45:12.328Z] Remaining: 1
[2025-11-20T11:45:12.328Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.430Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-20T11:45:12.430Z] Identifier: test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] Key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763639112225
[2025-11-20T11:45:12.430Z] Existing timestamps: 2
[2025-11-20T11:45:12.430Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-20T11:45:12.430Z] Current count after filter: 1
[2025-11-20T11:45:12.430Z] Max requests allowed: 3
[2025-11-20T11:45:12.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.430Z] New count: 2
[2025-11-20T11:45:12.430Z] Remaining: 1
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.430Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.430Z] Identifier: test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] Key: register:test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] üìù Creating new entry for key: register:test-format-allowed-1763639112430
[2025-11-20T11:45:12.430Z] Current count after filter: 0
[2025-11-20T11:45:12.430Z] Max requests allowed: 3
[2025-11-20T11:45:12.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.430Z] New count: 1
[2025-11-20T11:45:12.430Z] Remaining: 2
[2025-11-20T11:45:12.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìù Creating new entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Current count after filter: 0
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 1
[2025-11-20T11:45:12.431Z] Remaining: 2
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Existing timestamps: 1
[2025-11-20T11:45:12.431Z] Current count after filter: 1
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 2
[2025-11-20T11:45:12.431Z] Remaining: 1
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.431Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.431Z] Existing timestamps: 2
[2025-11-20T11:45:12.431Z] Current count after filter: 2
[2025-11-20T11:45:12.431Z] Max requests allowed: 3
[2025-11-20T11:45:12.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:12.431Z] New count: 3
[2025-11-20T11:45:12.431Z] Remaining: 0
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:12.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:12.431Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:12.432Z] Identifier: test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] Key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] üìñ Found existing entry for key: register:test-format-blocked-1763639112431
[2025-11-20T11:45:12.432Z] Existing timestamps: 3
[2025-11-20T11:45:12.432Z] Current count after filter: 3
[2025-11-20T11:45:12.432Z] Max requests allowed: 3
[2025-11-20T11:45:12.432Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:12.432Z] Current count: 3
[2025-11-20T11:45:12.432Z] Max allowed: 3
[2025-11-20T11:45:12.432Z] Retry after (seconds): 60
[2025-11-20T11:45:12.432Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:21.382Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:21.383Z] Request URL: /auth/login
[2025-11-20T11:45:21.383Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:21.383Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:21.383Z] X-Test-ID header: null
[2025-11-20T11:45:21.383Z] Will use test ID?: false
[2025-11-20T11:45:21.383Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:21.383Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:21.383Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:21.383Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:21.383Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:21.383Z] Identifier: unknown
[2025-11-20T11:45:21.383Z] Key: login:unknown
[2025-11-20T11:45:21.384Z] üìù Creating new entry for key: login:unknown
[2025-11-20T11:45:21.384Z] Current count after filter: 0
[2025-11-20T11:45:21.384Z] Max requests allowed: 5
[2025-11-20T11:45:21.384Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:21.384Z] New count: 1
[2025-11-20T11:45:21.384Z] Remaining: 4
[2025-11-20T11:45:21.384Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:21.384Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:23.921Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.921Z] Request URL: /auth/token
[2025-11-20T11:45:23.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.922Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.922Z] X-Test-ID header: null
[2025-11-20T11:45:23.922Z] Will use test ID?: false
[2025-11-20T11:45:23.922Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.922Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.922Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.922Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.922Z] Identifier: unknown
[2025-11-20T11:45:23.922Z] Key: token:unknown
[2025-11-20T11:45:23.922Z] üìù Creating new entry for key: token:unknown
[2025-11-20T11:45:23.922Z] Current count after filter: 0
[2025-11-20T11:45:23.922Z] Max requests allowed: 60
[2025-11-20T11:45:23.922Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.922Z] New count: 1
[2025-11-20T11:45:23.922Z] Remaining: 59
[2025-11-20T11:45:23.922Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.922Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:23.968Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.968Z] Request URL: /auth/token
[2025-11-20T11:45:23.968Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.968Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.968Z] X-Test-ID header: null
[2025-11-20T11:45:23.969Z] Will use test ID?: false
[2025-11-20T11:45:23.969Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.969Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.969Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.969Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.969Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.969Z] Identifier: unknown
[2025-11-20T11:45:23.969Z] Key: token:unknown
[2025-11-20T11:45:23.969Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:23.969Z] Existing timestamps: 1
[2025-11-20T11:45:23.969Z] Current count after filter: 1
[2025-11-20T11:45:23.969Z] Max requests allowed: 60
[2025-11-20T11:45:23.969Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.969Z] New count: 2
[2025-11-20T11:45:23.969Z] Remaining: 58
[2025-11-20T11:45:23.969Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.969Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:23.970Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:23.970Z] Request URL: /auth/token
[2025-11-20T11:45:23.970Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:23.970Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:23.970Z] X-Test-ID header: null
[2025-11-20T11:45:23.970Z] Will use test ID?: false
[2025-11-20T11:45:23.970Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:23.970Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:23.970Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:23.970Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:23.970Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:23.970Z] Identifier: unknown
[2025-11-20T11:45:23.970Z] Key: token:unknown
[2025-11-20T11:45:23.970Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:23.970Z] Existing timestamps: 2
[2025-11-20T11:45:23.970Z] Current count after filter: 2
[2025-11-20T11:45:23.970Z] Max requests allowed: 60
[2025-11-20T11:45:23.970Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:23.970Z] New count: 3
[2025-11-20T11:45:23.970Z] Remaining: 57
[2025-11-20T11:45:23.970Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:23.970Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.514Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.514Z] Request URL: /auth/token
[2025-11-20T11:45:24.514Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.515Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.515Z] X-Test-ID header: null
[2025-11-20T11:45:24.515Z] Will use test ID?: false
[2025-11-20T11:45:24.515Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.515Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.515Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.515Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.515Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.515Z] Identifier: unknown
[2025-11-20T11:45:24.515Z] Key: token:unknown
[2025-11-20T11:45:24.515Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.515Z] Existing timestamps: 3
[2025-11-20T11:45:24.515Z] Current count after filter: 3
[2025-11-20T11:45:24.515Z] Max requests allowed: 60
[2025-11-20T11:45:24.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.515Z] New count: 4
[2025-11-20T11:45:24.515Z] Remaining: 56
[2025-11-20T11:45:24.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 56,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.548Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.549Z] Request URL: /auth/token
[2025-11-20T11:45:24.549Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.549Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.549Z] X-Test-ID header: null
[2025-11-20T11:45:24.549Z] Will use test ID?: false
[2025-11-20T11:45:24.549Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.549Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.549Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.549Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.549Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.549Z] Identifier: unknown
[2025-11-20T11:45:24.549Z] Key: token:unknown
[2025-11-20T11:45:24.549Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.549Z] Existing timestamps: 4
[2025-11-20T11:45:24.550Z] Current count after filter: 4
[2025-11-20T11:45:24.550Z] Max requests allowed: 60
[2025-11-20T11:45:24.550Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.550Z] New count: 5
[2025-11-20T11:45:24.550Z] Remaining: 55
[2025-11-20T11:45:24.550Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.550Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 55,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:24.552Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:24.552Z] Request URL: /auth/token
[2025-11-20T11:45:24.552Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:24.552Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:24.552Z] X-Test-ID header: null
[2025-11-20T11:45:24.552Z] Will use test ID?: false
[2025-11-20T11:45:24.552Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:24.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:24.552Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:24.552Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:24.552Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:24.552Z] Identifier: unknown
[2025-11-20T11:45:24.552Z] Key: token:unknown
[2025-11-20T11:45:24.552Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:24.552Z] Existing timestamps: 5
[2025-11-20T11:45:24.552Z] Current count after filter: 5
[2025-11-20T11:45:24.552Z] Max requests allowed: 60
[2025-11-20T11:45:24.552Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:24.552Z] New count: 6
[2025-11-20T11:45:24.552Z] Remaining: 54
[2025-11-20T11:45:24.552Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:24.552Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 54,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:25.490Z] üîí withRateLimit CALLED for endpoint: logout
[2025-11-20T11:45:25.490Z] Request URL: /logout
[2025-11-20T11:45:25.490Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.490Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.490Z] X-Test-ID header: null
[2025-11-20T11:45:25.490Z] Will use test ID?: false
[2025-11-20T11:45:25.490Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.490Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.490Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.490Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.490Z] Config: {
  "keyPrefix": "logout",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:25.490Z] Identifier: unknown
[2025-11-20T11:45:25.490Z] Key: logout:unknown
[2025-11-20T11:45:25.491Z] üìù Creating new entry for key: logout:unknown
[2025-11-20T11:45:25.491Z] Current count after filter: 0
[2025-11-20T11:45:25.491Z] Max requests allowed: 5
[2025-11-20T11:45:25.491Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.491Z] New count: 1
[2025-11-20T11:45:25.491Z] Remaining: 4
[2025-11-20T11:45:25.491Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.491Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639185490
}
[2025-11-20T11:45:25.522Z] üîí withRateLimit CALLED for endpoint: logout
[2025-11-20T11:45:25.522Z] Request URL: /logout
[2025-11-20T11:45:25.522Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.522Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.522Z] X-Test-ID header: null
[2025-11-20T11:45:25.522Z] Will use test ID?: false
[2025-11-20T11:45:25.522Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.522Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.522Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.522Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.522Z] Config: {
  "keyPrefix": "logout",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:25.522Z] Identifier: unknown
[2025-11-20T11:45:25.522Z] Key: logout:unknown
[2025-11-20T11:45:25.522Z] üìñ Found existing entry for key: logout:unknown
[2025-11-20T11:45:25.522Z] Existing timestamps: 1
[2025-11-20T11:45:25.522Z] Current count after filter: 1
[2025-11-20T11:45:25.523Z] Max requests allowed: 5
[2025-11-20T11:45:25.523Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.523Z] New count: 2
[2025-11-20T11:45:25.523Z] Remaining: 3
[2025-11-20T11:45:25.523Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.523Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639185490
}
[2025-11-20T11:45:25.729Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:25.729Z] Request URL: /auth/token
[2025-11-20T11:45:25.729Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:25.729Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:25.729Z] X-Test-ID header: null
[2025-11-20T11:45:25.729Z] Will use test ID?: false
[2025-11-20T11:45:25.729Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:25.729Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:25.730Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:25.730Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:25.730Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:25.730Z] Identifier: unknown
[2025-11-20T11:45:25.730Z] Key: token:unknown
[2025-11-20T11:45:25.730Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:25.730Z] Existing timestamps: 6
[2025-11-20T11:45:25.730Z] Current count after filter: 6
[2025-11-20T11:45:25.730Z] Max requests allowed: 60
[2025-11-20T11:45:25.730Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:25.730Z] New count: 7
[2025-11-20T11:45:25.730Z] Remaining: 53
[2025-11-20T11:45:25.730Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:25.730Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 53,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:26.320Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:26.320Z] Request URL: /auth/token
[2025-11-20T11:45:26.320Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:26.320Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:26.320Z] X-Test-ID header: null
[2025-11-20T11:45:26.320Z] Will use test ID?: false
[2025-11-20T11:45:26.320Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:26.320Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:26.320Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:26.320Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:26.320Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:26.321Z] Identifier: unknown
[2025-11-20T11:45:26.321Z] Key: token:unknown
[2025-11-20T11:45:26.321Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:26.321Z] Existing timestamps: 7
[2025-11-20T11:45:26.321Z] Current count after filter: 7
[2025-11-20T11:45:26.321Z] Max requests allowed: 60
[2025-11-20T11:45:26.321Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:26.321Z] New count: 8
[2025-11-20T11:45:26.321Z] Remaining: 52
[2025-11-20T11:45:26.321Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:26.321Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 52,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:27.321Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:27.321Z] Request URL: /auth/token
[2025-11-20T11:45:27.322Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:27.322Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:27.322Z] X-Test-ID header: null
[2025-11-20T11:45:27.322Z] Will use test ID?: false
[2025-11-20T11:45:27.322Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:27.322Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:27.322Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:27.322Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:27.322Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:27.322Z] Identifier: unknown
[2025-11-20T11:45:27.322Z] Key: token:unknown
[2025-11-20T11:45:27.322Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:27.322Z] Existing timestamps: 8
[2025-11-20T11:45:27.323Z] Current count after filter: 8
[2025-11-20T11:45:27.323Z] Max requests allowed: 60
[2025-11-20T11:45:27.323Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:27.323Z] New count: 9
[2025-11-20T11:45:27.323Z] Remaining: 51
[2025-11-20T11:45:27.323Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:27.323Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 51,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:27.909Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:27.909Z] Request URL: /auth/token
[2025-11-20T11:45:27.909Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:27.909Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:27.909Z] X-Test-ID header: null
[2025-11-20T11:45:27.909Z] Will use test ID?: false
[2025-11-20T11:45:27.910Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:27.910Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:27.910Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:27.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:27.910Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:27.910Z] Identifier: unknown
[2025-11-20T11:45:27.910Z] Key: token:unknown
[2025-11-20T11:45:27.910Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:27.910Z] Existing timestamps: 9
[2025-11-20T11:45:27.910Z] Current count after filter: 9
[2025-11-20T11:45:27.910Z] Max requests allowed: 60
[2025-11-20T11:45:27.910Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:27.910Z] New count: 10
[2025-11-20T11:45:27.910Z] Remaining: 50
[2025-11-20T11:45:27.910Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:27.911Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 50,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:28.820Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:28.820Z] Request URL: /auth/token
[2025-11-20T11:45:28.820Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:28.820Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:28.820Z] X-Test-ID header: null
[2025-11-20T11:45:28.820Z] Will use test ID?: false
[2025-11-20T11:45:28.820Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:28.820Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:28.820Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:28.820Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:28.821Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:28.821Z] Identifier: unknown
[2025-11-20T11:45:28.821Z] Key: token:unknown
[2025-11-20T11:45:28.821Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:28.821Z] Existing timestamps: 10
[2025-11-20T11:45:28.821Z] Current count after filter: 10
[2025-11-20T11:45:28.821Z] Max requests allowed: 60
[2025-11-20T11:45:28.821Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:28.821Z] New count: 11
[2025-11-20T11:45:28.821Z] Remaining: 49
[2025-11-20T11:45:28.821Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:28.821Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 49,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.278Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.278Z] Request URL: /auth/token
[2025-11-20T11:45:29.279Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.279Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.279Z] X-Test-ID header: null
[2025-11-20T11:45:29.279Z] Will use test ID?: false
[2025-11-20T11:45:29.279Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.279Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.279Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.279Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.279Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.279Z] Identifier: unknown
[2025-11-20T11:45:29.279Z] Key: token:unknown
[2025-11-20T11:45:29.279Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.279Z] Existing timestamps: 11
[2025-11-20T11:45:29.279Z] Current count after filter: 11
[2025-11-20T11:45:29.279Z] Max requests allowed: 60
[2025-11-20T11:45:29.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.279Z] New count: 12
[2025-11-20T11:45:29.279Z] Remaining: 48
[2025-11-20T11:45:29.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.279Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 48,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.404Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.404Z] Request URL: /auth/token
[2025-11-20T11:45:29.404Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.404Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.404Z] X-Test-ID header: null
[2025-11-20T11:45:29.404Z] Will use test ID?: false
[2025-11-20T11:45:29.404Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.404Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.405Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.405Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.405Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.405Z] Identifier: unknown
[2025-11-20T11:45:29.405Z] Key: token:unknown
[2025-11-20T11:45:29.405Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.405Z] Existing timestamps: 12
[2025-11-20T11:45:29.405Z] Current count after filter: 12
[2025-11-20T11:45:29.405Z] Max requests allowed: 60
[2025-11-20T11:45:29.405Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.405Z] New count: 13
[2025-11-20T11:45:29.405Z] Remaining: 47
[2025-11-20T11:45:29.405Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.405Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 47,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:29.867Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:29.867Z] Request URL: /auth/token
[2025-11-20T11:45:29.867Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:29.867Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:29.867Z] X-Test-ID header: null
[2025-11-20T11:45:29.867Z] Will use test ID?: false
[2025-11-20T11:45:29.867Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:29.868Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:29.868Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:29.868Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:29.868Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:29.868Z] Identifier: unknown
[2025-11-20T11:45:29.868Z] Key: token:unknown
[2025-11-20T11:45:29.868Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:29.868Z] Existing timestamps: 13
[2025-11-20T11:45:29.868Z] Current count after filter: 13
[2025-11-20T11:45:29.868Z] Max requests allowed: 60
[2025-11-20T11:45:29.868Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:29.868Z] New count: 14
[2025-11-20T11:45:29.868Z] Remaining: 46
[2025-11-20T11:45:29.868Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:29.868Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 46,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.112Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.112Z] Request URL: /auth/token
[2025-11-20T11:45:31.112Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.112Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.112Z] X-Test-ID header: null
[2025-11-20T11:45:31.112Z] Will use test ID?: false
[2025-11-20T11:45:31.112Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.112Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.112Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.112Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.112Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.113Z] Identifier: unknown
[2025-11-20T11:45:31.113Z] Key: token:unknown
[2025-11-20T11:45:31.113Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.113Z] Existing timestamps: 14
[2025-11-20T11:45:31.113Z] Current count after filter: 14
[2025-11-20T11:45:31.113Z] Max requests allowed: 60
[2025-11-20T11:45:31.113Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.113Z] New count: 15
[2025-11-20T11:45:31.113Z] Remaining: 45
[2025-11-20T11:45:31.113Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.113Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 45,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.695Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.695Z] Request URL: /auth/token
[2025-11-20T11:45:31.696Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.696Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.696Z] X-Test-ID header: null
[2025-11-20T11:45:31.696Z] Will use test ID?: false
[2025-11-20T11:45:31.696Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.696Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.696Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.696Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.696Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.696Z] Identifier: unknown
[2025-11-20T11:45:31.696Z] Key: token:unknown
[2025-11-20T11:45:31.696Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.696Z] Existing timestamps: 15
[2025-11-20T11:45:31.697Z] Current count after filter: 15
[2025-11-20T11:45:31.697Z] Max requests allowed: 60
[2025-11-20T11:45:31.697Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.697Z] New count: 16
[2025-11-20T11:45:31.697Z] Remaining: 44
[2025-11-20T11:45:31.697Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.697Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 44,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.765Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:31.765Z] Request URL: /auth/token
[2025-11-20T11:45:31.766Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.766Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.766Z] X-Test-ID header: null
[2025-11-20T11:45:31.766Z] Will use test ID?: false
[2025-11-20T11:45:31.766Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.766Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.766Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.766Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.766Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:31.766Z] Identifier: unknown
[2025-11-20T11:45:31.766Z] Key: token:unknown
[2025-11-20T11:45:31.766Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:31.766Z] Existing timestamps: 16
[2025-11-20T11:45:31.766Z] Current count after filter: 16
[2025-11-20T11:45:31.766Z] Max requests allowed: 60
[2025-11-20T11:45:31.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.767Z] New count: 17
[2025-11-20T11:45:31.767Z] Remaining: 43
[2025-11-20T11:45:31.767Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.767Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 43,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:31.992Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:31.992Z] Request URL: /auth/register
[2025-11-20T11:45:31.992Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:31.992Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:31.992Z] X-Test-ID header: null
[2025-11-20T11:45:31.992Z] Will use test ID?: false
[2025-11-20T11:45:31.992Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:31.992Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:31.992Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:31.992Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:31.992Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:31.992Z] Identifier: unknown
[2025-11-20T11:45:31.992Z] Key: register:unknown
[2025-11-20T11:45:31.992Z] üìù Creating new entry for key: register:unknown
[2025-11-20T11:45:31.992Z] Current count after filter: 0
[2025-11-20T11:45:31.992Z] Max requests allowed: 3
[2025-11-20T11:45:31.992Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:31.992Z] New count: 1
[2025-11-20T11:45:31.992Z] Remaining: 2
[2025-11-20T11:45:31.993Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:31.993Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639191992
}
[2025-11-20T11:45:32.343Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:32.344Z] Request URL: /auth/token
[2025-11-20T11:45:32.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:32.344Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:32.344Z] X-Test-ID header: null
[2025-11-20T11:45:32.344Z] Will use test ID?: false
[2025-11-20T11:45:32.344Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:32.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:32.344Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:32.344Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:32.344Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:32.344Z] Identifier: unknown
[2025-11-20T11:45:32.344Z] Key: token:unknown
[2025-11-20T11:45:32.344Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:32.344Z] Existing timestamps: 17
[2025-11-20T11:45:32.345Z] Current count after filter: 17
[2025-11-20T11:45:32.345Z] Max requests allowed: 60
[2025-11-20T11:45:32.345Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:32.345Z] New count: 18
[2025-11-20T11:45:32.345Z] Remaining: 42
[2025-11-20T11:45:32.345Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:32.345Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 42,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:33.023Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:33.023Z] Request URL: /auth/verify-email
[2025-11-20T11:45:33.023Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:33.023Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:33.024Z] X-Test-ID header: null
[2025-11-20T11:45:33.024Z] Will use test ID?: false
[2025-11-20T11:45:33.024Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:33.024Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:33.024Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:33.024Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:33.024Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:33.024Z] Identifier: unknown
[2025-11-20T11:45:33.024Z] Key: login:unknown
[2025-11-20T11:45:33.024Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:33.024Z] Existing timestamps: 1
[2025-11-20T11:45:33.024Z] Current count after filter: 1
[2025-11-20T11:45:33.024Z] Max requests allowed: 5
[2025-11-20T11:45:33.024Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:33.024Z] New count: 2
[2025-11-20T11:45:33.024Z] Remaining: 3
[2025-11-20T11:45:33.024Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:33.024Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:34.324Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:34.324Z] Request URL: /auth/forgot-password
[2025-11-20T11:45:34.324Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:34.324Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:34.324Z] X-Test-ID header: null
[2025-11-20T11:45:34.325Z] Will use test ID?: false
[2025-11-20T11:45:34.325Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:34.325Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:34.325Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:34.325Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:34.325Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:34.325Z] Identifier: unknown
[2025-11-20T11:45:34.325Z] Key: login:unknown
[2025-11-20T11:45:34.325Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:34.325Z] Existing timestamps: 2
[2025-11-20T11:45:34.325Z] Current count after filter: 2
[2025-11-20T11:45:34.325Z] Max requests allowed: 5
[2025-11-20T11:45:34.325Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:34.325Z] New count: 3
[2025-11-20T11:45:34.325Z] Remaining: 2
[2025-11-20T11:45:34.325Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:34.325Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:34.659Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:34.659Z] Request URL: /auth/token
[2025-11-20T11:45:34.659Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:34.659Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:34.659Z] X-Test-ID header: null
[2025-11-20T11:45:34.659Z] Will use test ID?: false
[2025-11-20T11:45:34.659Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:34.659Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:34.659Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:34.659Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:34.659Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:34.659Z] Identifier: unknown
[2025-11-20T11:45:34.659Z] Key: token:unknown
[2025-11-20T11:45:34.659Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:34.659Z] Existing timestamps: 18
[2025-11-20T11:45:34.659Z] Current count after filter: 18
[2025-11-20T11:45:34.659Z] Max requests allowed: 60
[2025-11-20T11:45:34.660Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:34.660Z] New count: 19
[2025-11-20T11:45:34.660Z] Remaining: 41
[2025-11-20T11:45:34.660Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:34.660Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 41,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:35.244Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-20T11:45:35.244Z] Request URL: /auth/token
[2025-11-20T11:45:35.245Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:35.245Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:35.245Z] X-Test-ID header: null
[2025-11-20T11:45:35.245Z] Will use test ID?: false
[2025-11-20T11:45:35.245Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:35.245Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:35.245Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:35.245Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:35.245Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-20T11:45:35.245Z] Identifier: unknown
[2025-11-20T11:45:35.245Z] Key: token:unknown
[2025-11-20T11:45:35.245Z] üìñ Found existing entry for key: token:unknown
[2025-11-20T11:45:35.245Z] Existing timestamps: 19
[2025-11-20T11:45:35.245Z] Current count after filter: 19
[2025-11-20T11:45:35.245Z] Max requests allowed: 60
[2025-11-20T11:45:35.246Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:35.246Z] New count: 20
[2025-11-20T11:45:35.246Z] Remaining: 40
[2025-11-20T11:45:35.246Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:35.246Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 40,
  "resetAt": 1763639183922
}
[2025-11-20T11:45:35.641Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:35.641Z] Request URL: /auth/reset-password
[2025-11-20T11:45:35.641Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:35.641Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:35.642Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:35.642Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:35.642Z] X-Test-ID header: null
[2025-11-20T11:45:35.642Z] Will use test ID?: false
[2025-11-20T11:45:35.642Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:35.642Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:35.642Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:35.642Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:35.642Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:35.642Z] Identifier: unknown
[2025-11-20T11:45:35.642Z] Key: login:unknown
[2025-11-20T11:45:35.642Z] üìñ Found existing entry for key: login:unknown
[2025-11-20T11:45:35.642Z] Existing timestamps: 3
[2025-11-20T11:45:35.642Z] Current count after filter: 3
[2025-11-20T11:45:35.642Z] Max requests allowed: 5
[2025-11-20T11:45:35.642Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:35.642Z] New count: 4
[2025-11-20T11:45:35.642Z] Remaining: 1
[2025-11-20T11:45:35.642Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:35.642Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639181383
}
[2025-11-20T11:45:37.270Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.271Z] Request URL: /auth/login
[2025-11-20T11:45:37.271Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.271Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.271Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Will use test ID?: true
[2025-11-20T11:45:37.271Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.271Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.271Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.271Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] üìù Creating new entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.271Z] Current count after filter: 0
[2025-11-20T11:45:37.271Z] Max requests allowed: 5
[2025-11-20T11:45:37.271Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.271Z] New count: 1
[2025-11-20T11:45:37.271Z] Remaining: 4
[2025-11-20T11:45:37.271Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.271Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:37.338Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.338Z] Request URL: /auth/login
[2025-11-20T11:45:37.338Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.338Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.338Z] X-Test-ID header: login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Will use test ID?: true
[2025-11-20T11:45:37.339Z] ‚úÖ Using test identifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.339Z] Got identifier from getClientIdentifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.339Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.339Z] Identifier: test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Key: login:test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] üìù Creating new entry for key: login:test:login-headers-1763639137309-skw74h
[2025-11-20T11:45:37.339Z] Current count after filter: 0
[2025-11-20T11:45:37.339Z] Max requests allowed: 5
[2025-11-20T11:45:37.339Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.339Z] New count: 1
[2025-11-20T11:45:37.339Z] Remaining: 4
[2025-11-20T11:45:37.339Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.339Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197339
}
[2025-11-20T11:45:37.592Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.592Z] Request URL: /auth/login
[2025-11-20T11:45:37.593Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.593Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.593Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] Will use test ID?: true
[2025-11-20T11:45:37.593Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.593Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.593Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.593Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.593Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.594Z] Existing timestamps: 1
[2025-11-20T11:45:37.594Z] Current count after filter: 1
[2025-11-20T11:45:37.594Z] Max requests allowed: 5
[2025-11-20T11:45:37.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.594Z] New count: 2
[2025-11-20T11:45:37.594Z] Remaining: 3
[2025-11-20T11:45:37.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.594Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:37.641Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.641Z] Request URL: /auth/login
[2025-11-20T11:45:37.641Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.641Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.641Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] Will use test ID?: true
[2025-11-20T11:45:37.641Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.641Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.641Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.641Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.641Z] üìù Creating new entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.642Z] Current count after filter: 0
[2025-11-20T11:45:37.642Z] Max requests allowed: 5
[2025-11-20T11:45:37.642Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.642Z] New count: 1
[2025-11-20T11:45:37.642Z] Remaining: 4
[2025-11-20T11:45:37.642Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.642Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:37.871Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:37.871Z] Request URL: /auth/register
[2025-11-20T11:45:37.871Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.871Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.871Z] X-Test-ID header: null
[2025-11-20T11:45:37.871Z] Will use test ID?: false
[2025-11-20T11:45:37.871Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-20T11:45:37.872Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.872Z] Got identifier from getClientIdentifier: unknown
[2025-11-20T11:45:37.872Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.872Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:37.872Z] Identifier: unknown
[2025-11-20T11:45:37.872Z] Key: register:unknown
[2025-11-20T11:45:37.872Z] üìñ Found existing entry for key: register:unknown
[2025-11-20T11:45:37.872Z] Existing timestamps: 1
[2025-11-20T11:45:37.872Z] Current count after filter: 1
[2025-11-20T11:45:37.872Z] Max requests allowed: 3
[2025-11-20T11:45:37.872Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.872Z] New count: 2
[2025-11-20T11:45:37.872Z] Remaining: 1
[2025-11-20T11:45:37.872Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.872Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639191992
}
[2025-11-20T11:45:37.890Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.890Z] Request URL: /auth/login
[2025-11-20T11:45:37.890Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.890Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.890Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.891Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.891Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Will use test ID?: true
[2025-11-20T11:45:37.891Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.891Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.891Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.891Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:37.891Z] Existing timestamps: 1
[2025-11-20T11:45:37.891Z] Current count after filter: 1
[2025-11-20T11:45:37.891Z] Max requests allowed: 5
[2025-11-20T11:45:37.891Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.891Z] New count: 2
[2025-11-20T11:45:37.891Z] Remaining: 3
[2025-11-20T11:45:37.891Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.891Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:37.927Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:37.927Z] Request URL: /auth/login
[2025-11-20T11:45:37.927Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:37.927Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:37.927Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] Will use test ID?: true
[2025-11-20T11:45:37.927Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:37.927Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.927Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:37.927Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:37.928Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:37.928Z] Existing timestamps: 2
[2025-11-20T11:45:37.928Z] Current count after filter: 2
[2025-11-20T11:45:37.928Z] Max requests allowed: 5
[2025-11-20T11:45:37.928Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:37.928Z] New count: 3
[2025-11-20T11:45:37.928Z] Remaining: 2
[2025-11-20T11:45:37.928Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:37.928Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.045Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.045Z] Request URL: /auth/register
[2025-11-20T11:45:38.045Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.045Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.045Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.046Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.046Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Will use test ID?: true
[2025-11-20T11:45:38.046Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.046Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.046Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.046Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] üìù Creating new entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.046Z] Current count after filter: 0
[2025-11-20T11:45:38.046Z] Max requests allowed: 3
[2025-11-20T11:45:38.046Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.046Z] New count: 1
[2025-11-20T11:45:38.046Z] Remaining: 2
[2025-11-20T11:45:38.046Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.046Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.151Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.151Z] Request URL: /auth/login
[2025-11-20T11:45:38.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.151Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.152Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.152Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.152Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Will use test ID?: true
[2025-11-20T11:45:38.152Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.152Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.152Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.152Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.152Z] Existing timestamps: 2
[2025-11-20T11:45:38.152Z] Current count after filter: 2
[2025-11-20T11:45:38.152Z] Max requests allowed: 5
[2025-11-20T11:45:38.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.152Z] New count: 3
[2025-11-20T11:45:38.152Z] Remaining: 2
[2025-11-20T11:45:38.152Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.152Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.239Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.239Z] Request URL: /auth/login
[2025-11-20T11:45:38.239Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.239Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.240Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.240Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.240Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Will use test ID?: true
[2025-11-20T11:45:38.240Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.240Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.240Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.240Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.240Z] Existing timestamps: 3
[2025-11-20T11:45:38.240Z] Current count after filter: 3
[2025-11-20T11:45:38.240Z] Max requests allowed: 5
[2025-11-20T11:45:38.240Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.240Z] New count: 4
[2025-11-20T11:45:38.240Z] Remaining: 1
[2025-11-20T11:45:38.240Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.240Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.392Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.393Z] Request URL: /auth/login
[2025-11-20T11:45:38.393Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.393Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.393Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Will use test ID?: true
[2025-11-20T11:45:38.393Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.393Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.393Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.393Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.393Z] Existing timestamps: 3
[2025-11-20T11:45:38.393Z] Current count after filter: 3
[2025-11-20T11:45:38.394Z] Max requests allowed: 5
[2025-11-20T11:45:38.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.394Z] New count: 4
[2025-11-20T11:45:38.394Z] Remaining: 1
[2025-11-20T11:45:38.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.394Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.463Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.464Z] Request URL: /auth/register
[2025-11-20T11:45:38.464Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.464Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.464Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Will use test ID?: true
[2025-11-20T11:45:38.464Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.464Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.464Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.464Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.464Z] Existing timestamps: 1
[2025-11-20T11:45:38.464Z] Current count after filter: 1
[2025-11-20T11:45:38.464Z] Max requests allowed: 3
[2025-11-20T11:45:38.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.464Z] New count: 2
[2025-11-20T11:45:38.464Z] Remaining: 1
[2025-11-20T11:45:38.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.464Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.562Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.562Z] Request URL: /auth/login
[2025-11-20T11:45:38.562Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.562Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.562Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] Will use test ID?: true
[2025-11-20T11:45:38.562Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.562Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.562Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.562Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.562Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.563Z] Existing timestamps: 4
[2025-11-20T11:45:38.563Z] Current count after filter: 4
[2025-11-20T11:45:38.563Z] Max requests allowed: 5
[2025-11-20T11:45:38.563Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.563Z] New count: 5
[2025-11-20T11:45:38.563Z] Remaining: 0
[2025-11-20T11:45:38.563Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.563Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639197271
}
[2025-11-20T11:45:38.652Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.652Z] Request URL: /auth/login
[2025-11-20T11:45:38.652Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.652Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.653Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.653Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.653Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Will use test ID?: true
[2025-11-20T11:45:38.653Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.653Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.653Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.653Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.653Z] Existing timestamps: 4
[2025-11-20T11:45:38.653Z] Current count after filter: 4
[2025-11-20T11:45:38.653Z] Max requests allowed: 5
[2025-11-20T11:45:38.653Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.653Z] New count: 5
[2025-11-20T11:45:38.653Z] Remaining: 0
[2025-11-20T11:45:38.653Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.653Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639197641
}
[2025-11-20T11:45:38.739Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.739Z] Request URL: /auth/verify-email
[2025-11-20T11:45:38.739Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.739Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.739Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] Will use test ID?: true
[2025-11-20T11:45:38.739Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.739Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.739Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.739Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.739Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.740Z] üìù Creating new entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:38.740Z] Current count after filter: 0
[2025-11-20T11:45:38.740Z] Max requests allowed: 5
[2025-11-20T11:45:38.740Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.740Z] New count: 1
[2025-11-20T11:45:38.740Z] Remaining: 4
[2025-11-20T11:45:38.740Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.740Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:38.807Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.807Z] Request URL: /auth/register
[2025-11-20T11:45:38.807Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.807Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.808Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Will use test ID?: true
[2025-11-20T11:45:38.808Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.808Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.808Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.808Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:38.808Z] Existing timestamps: 2
[2025-11-20T11:45:38.808Z] Current count after filter: 2
[2025-11-20T11:45:38.808Z] Max requests allowed: 3
[2025-11-20T11:45:38.808Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.808Z] New count: 3
[2025-11-20T11:45:38.808Z] Remaining: 0
[2025-11-20T11:45:38.808Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.808Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198046
}
[2025-11-20T11:45:38.893Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.893Z] Request URL: /auth/login
[2025-11-20T11:45:38.893Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.893Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.894Z] X-Test-ID header: login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Will use test ID?: true
[2025-11-20T11:45:38.894Z] ‚úÖ Using test identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.894Z] Got identifier from getClientIdentifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.894Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.894Z] Identifier: test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] üìñ Found existing entry for key: login:test:login-retry-after-1763639137639-9zcr6s
[2025-11-20T11:45:38.894Z] Existing timestamps: 5
[2025-11-20T11:45:38.894Z] Current count after filter: 5
[2025-11-20T11:45:38.894Z] Max requests allowed: 5
[2025-11-20T11:45:38.894Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:38.894Z] Current count: 5
[2025-11-20T11:45:38.894Z] Max allowed: 5
[2025-11-20T11:45:38.894Z] Retry after (seconds): 59
[2025-11-20T11:45:38.894Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:38.894Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639197641,
  "retryAfter": 59
}
[2025-11-20T11:45:38.898Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.899Z] Request URL: /auth/login
[2025-11-20T11:45:38.899Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.899Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.899Z] X-Test-ID header: login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Will use test ID?: true
[2025-11-20T11:45:38.899Z] ‚úÖ Using test identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.899Z] Got identifier from getClientIdentifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.899Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.899Z] Identifier: test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] üìñ Found existing entry for key: login:test:login-excessive-1763639137257-kstmvs
[2025-11-20T11:45:38.899Z] Existing timestamps: 5
[2025-11-20T11:45:38.899Z] Current count after filter: 5
[2025-11-20T11:45:38.899Z] Max requests allowed: 5
[2025-11-20T11:45:38.899Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:38.899Z] Current count: 5
[2025-11-20T11:45:38.899Z] Max allowed: 5
[2025-11-20T11:45:38.899Z] Retry after (seconds): 59
[2025-11-20T11:45:38.899Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:38.899Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639197271,
  "retryAfter": 59
}
[2025-11-20T11:45:38.906Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:38.906Z] Request URL: /auth/register
[2025-11-20T11:45:38.906Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.906Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.906Z] X-Test-ID header: register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.906Z] Will use test ID?: true
[2025-11-20T11:45:38.906Z] ‚úÖ Using test identifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.907Z] Got identifier from getClientIdentifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.907Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:38.907Z] Identifier: test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] Key: register:test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] üìù Creating new entry for key: register:test:register-headers-1763639138904-mcrrpc
[2025-11-20T11:45:38.907Z] Current count after filter: 0
[2025-11-20T11:45:38.907Z] Max requests allowed: 3
[2025-11-20T11:45:38.907Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.907Z] New count: 1
[2025-11-20T11:45:38.907Z] Remaining: 2
[2025-11-20T11:45:38.907Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.907Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198907
}
[2025-11-20T11:45:38.924Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:38.925Z] Request URL: /auth/login
[2025-11-20T11:45:38.925Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:38.925Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:38.925Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Will use test ID?: true
[2025-11-20T11:45:38.925Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:38.925Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:38.925Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:38.925Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] üìù Creating new entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:38.925Z] Current count after filter: 0
[2025-11-20T11:45:38.925Z] Max requests allowed: 5
[2025-11-20T11:45:38.925Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:38.925Z] New count: 1
[2025-11-20T11:45:38.925Z] Remaining: 4
[2025-11-20T11:45:38.925Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:38.925Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.012Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.012Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.013Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.013Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.013Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Will use test ID?: true
[2025-11-20T11:45:39.013Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.013Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.013Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.013Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.013Z] Existing timestamps: 1
[2025-11-20T11:45:39.013Z] Current count after filter: 1
[2025-11-20T11:45:39.013Z] Max requests allowed: 5
[2025-11-20T11:45:39.013Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.013Z] New count: 2
[2025-11-20T11:45:39.013Z] Remaining: 3
[2025-11-20T11:45:39.013Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.013Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.152Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:39.153Z] Request URL: /auth/register
[2025-11-20T11:45:39.153Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.153Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.153Z] X-Test-ID header: register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Will use test ID?: true
[2025-11-20T11:45:39.153Z] ‚úÖ Using test identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.153Z] Got identifier from getClientIdentifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.153Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:39.153Z] Identifier: test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] üìñ Found existing entry for key: register:test:register-excessive-1763639138036-a1hujq
[2025-11-20T11:45:39.153Z] Existing timestamps: 3
[2025-11-20T11:45:39.153Z] Current count after filter: 3
[2025-11-20T11:45:39.153Z] Max requests allowed: 3
[2025-11-20T11:45:39.153Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:39.153Z] Current count: 3
[2025-11-20T11:45:39.153Z] Max allowed: 3
[2025-11-20T11:45:39.153Z] Retry after (seconds): 59
[2025-11-20T11:45:39.153Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:39.153Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639198046,
  "retryAfter": 59
}
[2025-11-20T11:45:39.165Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.165Z] Request URL: /auth/login
[2025-11-20T11:45:39.165Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.165Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.165Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Will use test ID?: true
[2025-11-20T11:45:39.165Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.165Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.165Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.165Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] üìù Creating new entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.165Z] Current count after filter: 0
[2025-11-20T11:45:39.165Z] Max requests allowed: 5
[2025-11-20T11:45:39.165Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.166Z] New count: 1
[2025-11-20T11:45:39.166Z] Remaining: 4
[2025-11-20T11:45:39.166Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.166Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.172Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.172Z] Request URL: /auth/login
[2025-11-20T11:45:39.172Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.172Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.172Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Will use test ID?: true
[2025-11-20T11:45:39.172Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.172Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.172Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.172Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.172Z] Existing timestamps: 1
[2025-11-20T11:45:39.172Z] Current count after filter: 1
[2025-11-20T11:45:39.172Z] Max requests allowed: 5
[2025-11-20T11:45:39.172Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.172Z] New count: 2
[2025-11-20T11:45:39.172Z] Remaining: 3
[2025-11-20T11:45:39.172Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.172Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.271Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.272Z] Request URL: /auth/login
[2025-11-20T11:45:39.272Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.272Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.272Z] X-Test-ID header: headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Will use test ID?: true
[2025-11-20T11:45:39.272Z] ‚úÖ Using test identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.272Z] Got identifier from getClientIdentifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.272Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.272Z] Identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] üìù Creating new entry for key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.272Z] Current count after filter: 0
[2025-11-20T11:45:39.272Z] Max requests allowed: 5
[2025-11-20T11:45:39.272Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.272Z] New count: 1
[2025-11-20T11:45:39.272Z] Remaining: 4
[2025-11-20T11:45:39.272Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.272Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199272
}
[2025-11-20T11:45:39.291Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.291Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.291Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.291Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.291Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.292Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.292Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Will use test ID?: true
[2025-11-20T11:45:39.292Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.292Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.292Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.292Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.292Z] Existing timestamps: 2
[2025-11-20T11:45:39.292Z] Current count after filter: 2
[2025-11-20T11:45:39.292Z] Max requests allowed: 5
[2025-11-20T11:45:39.292Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.292Z] New count: 3
[2025-11-20T11:45:39.292Z] Remaining: 2
[2025-11-20T11:45:39.292Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.292Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.424Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.424Z] Request URL: /auth/login
[2025-11-20T11:45:39.424Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.424Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.424Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Will use test ID?: true
[2025-11-20T11:45:39.425Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.425Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.425Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.425Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.425Z] Existing timestamps: 2
[2025-11-20T11:45:39.425Z] Current count after filter: 2
[2025-11-20T11:45:39.425Z] Max requests allowed: 5
[2025-11-20T11:45:39.425Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.425Z] New count: 3
[2025-11-20T11:45:39.425Z] Remaining: 2
[2025-11-20T11:45:39.425Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.425Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.478Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.478Z] Request URL: /auth/login
[2025-11-20T11:45:39.479Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.479Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.479Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Will use test ID?: true
[2025-11-20T11:45:39.479Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.479Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.479Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.479Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] üìñ Found existing entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.479Z] Existing timestamps: 1
[2025-11-20T11:45:39.479Z] Current count after filter: 1
[2025-11-20T11:45:39.479Z] Max requests allowed: 5
[2025-11-20T11:45:39.479Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.479Z] New count: 2
[2025-11-20T11:45:39.479Z] Remaining: 3
[2025-11-20T11:45:39.479Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.480Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.507Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.508Z] Request URL: /auth/login
[2025-11-20T11:45:39.508Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.508Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.508Z] X-Test-ID header: headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Will use test ID?: true
[2025-11-20T11:45:39.508Z] ‚úÖ Using test identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.508Z] Got identifier from getClientIdentifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.508Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.508Z] Identifier: test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] üìñ Found existing entry for key: login:test:headers-consistent-1763639139270-1rg5vj
[2025-11-20T11:45:39.508Z] Existing timestamps: 1
[2025-11-20T11:45:39.508Z] Current count after filter: 1
[2025-11-20T11:45:39.508Z] Max requests allowed: 5
[2025-11-20T11:45:39.508Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.508Z] New count: 2
[2025-11-20T11:45:39.508Z] Remaining: 3
[2025-11-20T11:45:39.508Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.508Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763639199272
}
[2025-11-20T11:45:39.558Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.559Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.559Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.559Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.559Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Will use test ID?: true
[2025-11-20T11:45:39.559Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.559Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.559Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.559Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.559Z] Existing timestamps: 3
[2025-11-20T11:45:39.559Z] Current count after filter: 3
[2025-11-20T11:45:39.559Z] Max requests allowed: 5
[2025-11-20T11:45:39.559Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.559Z] New count: 4
[2025-11-20T11:45:39.559Z] Remaining: 1
[2025-11-20T11:45:39.559Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.559Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.672Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.672Z] Request URL: /auth/login
[2025-11-20T11:45:39.672Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.672Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.672Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.673Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.673Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Will use test ID?: true
[2025-11-20T11:45:39.673Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.673Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.673Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.673Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:39.673Z] Existing timestamps: 3
[2025-11-20T11:45:39.673Z] Current count after filter: 3
[2025-11-20T11:45:39.673Z] Max requests allowed: 5
[2025-11-20T11:45:39.673Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.673Z] New count: 4
[2025-11-20T11:45:39.673Z] Remaining: 1
[2025-11-20T11:45:39.673Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.673Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:39.764Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.765Z] Request URL: /auth/login
[2025-11-20T11:45:39.765Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.765Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.765Z] X-Test-ID header: headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] Will use test ID?: true
[2025-11-20T11:45:39.765Z] ‚úÖ Using test identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.765Z] Got identifier from getClientIdentifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.765Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.765Z] Identifier: test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.765Z] Key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.766Z] üìñ Found existing entry for key: login:test:headers-remaining-1763639139161-i8mx0p
[2025-11-20T11:45:39.766Z] Existing timestamps: 2
[2025-11-20T11:45:39.766Z] Current count after filter: 2
[2025-11-20T11:45:39.766Z] Max requests allowed: 5
[2025-11-20T11:45:39.766Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.766Z] New count: 3
[2025-11-20T11:45:39.766Z] Remaining: 2
[2025-11-20T11:45:39.766Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.766Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639199165
}
[2025-11-20T11:45:39.842Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.842Z] Request URL: /auth/verify-email
[2025-11-20T11:45:39.842Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.843Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.843Z] X-Test-ID header: rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Will use test ID?: true
[2025-11-20T11:45:39.843Z] ‚úÖ Using test identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.843Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.843Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.843Z] Identifier: test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763639136964
[2025-11-20T11:45:39.843Z] Existing timestamps: 4
[2025-11-20T11:45:39.843Z] Current count after filter: 4
[2025-11-20T11:45:39.843Z] Max requests allowed: 5
[2025-11-20T11:45:39.843Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.843Z] New count: 5
[2025-11-20T11:45:39.843Z] Remaining: 0
[2025-11-20T11:45:39.843Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.843Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198739
}
[2025-11-20T11:45:39.941Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:39.941Z] Request URL: /auth/login
[2025-11-20T11:45:39.942Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:39.942Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:39.942Z] X-Test-ID header: perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Will use test ID?: true
[2025-11-20T11:45:39.942Z] ‚úÖ Using test identifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:39.942Z] Got identifier from getClientIdentifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:39.942Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:39.942Z] Identifier: test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Key: login:test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] üìù Creating new entry for key: login:test:perf-test-1763639139932-s2bkiw
[2025-11-20T11:45:39.942Z] Current count after filter: 0
[2025-11-20T11:45:39.942Z] Max requests allowed: 5
[2025-11-20T11:45:39.942Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:39.942Z] New count: 1
[2025-11-20T11:45:39.942Z] Remaining: 4
[2025-11-20T11:45:39.942Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:39.942Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763639199942
}
[2025-11-20T11:45:40.127Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:40.127Z] Request URL: /auth/login
[2025-11-20T11:45:40.127Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.127Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.127Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] Will use test ID?: true
[2025-11-20T11:45:40.127Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.127Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.127Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:40.128Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.128Z] Existing timestamps: 4
[2025-11-20T11:45:40.128Z] Current count after filter: 4
[2025-11-20T11:45:40.128Z] Max requests allowed: 5
[2025-11-20T11:45:40.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:40.128Z] New count: 5
[2025-11-20T11:45:40.128Z] Remaining: 0
[2025-11-20T11:45:40.128Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:40.128Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763639198925
}
[2025-11-20T11:45:40.439Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-20T11:45:40.439Z] Request URL: /auth/login
[2025-11-20T11:45:40.439Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.439Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.439Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] Will use test ID?: true
[2025-11-20T11:45:40.439Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.439Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.439Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.440Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-20T11:45:40.440Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] Key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.440Z] Existing timestamps: 5
[2025-11-20T11:45:40.440Z] Current count after filter: 5
[2025-11-20T11:45:40.440Z] Max requests allowed: 5
[2025-11-20T11:45:40.440Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-20T11:45:40.440Z] Current count: 5
[2025-11-20T11:45:40.440Z] Max allowed: 5
[2025-11-20T11:45:40.440Z] Retry after (seconds): 59
[2025-11-20T11:45:40.440Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-20T11:45:40.440Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763639198925,
  "retryAfter": 59
}
[2025-11-20T11:45:40.442Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-20T11:45:40.442Z] Request URL: /auth/register
[2025-11-20T11:45:40.442Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (process.env): true
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (env): true
[2025-11-20T11:45:40.442Z] E2E_TEST_MODE (final): true
[2025-11-20T11:45:40.442Z] X-Test-ID header: independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Will use test ID?: true
[2025-11-20T11:45:40.442Z] ‚úÖ Using test identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-20T11:45:40.442Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-20T11:45:40.442Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-20T11:45:40.442Z] Identifier: test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Key: register:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] üìù Creating new entry for key: register:test:independent-endpoints-1763639138923-3p00y3
[2025-11-20T11:45:40.442Z] Current count after filter: 0
[2025-11-20T11:45:40.442Z] Max requests allowed: 3
[2025-11-20T11:45:40.442Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-20T11:45:40.442Z] New count: 1
[2025-11-20T11:45:40.442Z] Remaining: 2
[2025-11-20T11:45:40.442Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-20T11:45:40.442Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763639200442
}
