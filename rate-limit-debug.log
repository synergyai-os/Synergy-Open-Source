=== NEW TEST RUN: 2025-11-15T21:27:32.917Z ===
[2025-11-15T21:27:32.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:32.922Z] Request URL: /auth/login
[2025-11-15T21:27:32.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:32.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:32.922Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.922Z] Will use test ID?: true
[2025-11-15T21:27:32.923Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:32.923Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:32.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:32.923Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:32.923Z] Current count after filter: 0
[2025-11-15T21:27:32.923Z] Max requests allowed: 5
[2025-11-15T21:27:32.923Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:32.923Z] New count: 1
[2025-11-15T21:27:32.923Z] Remaining: 4
[2025-11-15T21:27:32.923Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:32.923Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.090Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.090Z] Request URL: /auth/login
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.090Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.090Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Will use test ID?: true
[2025-11-15T21:27:33.090Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.090Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.090Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.090Z] Current count after filter: 0
[2025-11-15T21:27:33.090Z] Max requests allowed: 5
[2025-11-15T21:27:33.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.090Z] New count: 1
[2025-11-15T21:27:33.090Z] Remaining: 4
[2025-11-15T21:27:33.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113090
}
[2025-11-15T21:27:33.145Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.145Z] Request URL: /auth/login
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.145Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.145Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] Will use test ID?: true
[2025-11-15T21:27:33.145Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.145Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.146Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.146Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.146Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.146Z] Current count after filter: 0
[2025-11-15T21:27:33.146Z] Max requests allowed: 5
[2025-11-15T21:27:33.146Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.146Z] New count: 1
[2025-11-15T21:27:33.146Z] Remaining: 4
[2025-11-15T21:27:33.146Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.146Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113146
}
[2025-11-15T21:27:33.147Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.147Z] Request URL: /auth/login
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.147Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.147Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Will use test ID?: true
[2025-11-15T21:27:33.147Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.147Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.147Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.147Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.147Z] Existing timestamps: 1
[2025-11-15T21:27:33.147Z] Current count after filter: 1
[2025-11-15T21:27:33.147Z] Max requests allowed: 5
[2025-11-15T21:27:33.147Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.147Z] New count: 2
[2025-11-15T21:27:33.147Z] Remaining: 3
[2025-11-15T21:27:33.147Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.147Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242112923
}
[2025-11-15T21:27:33.226Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.226Z] Request URL: /auth/register
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.226Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.226Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Will use test ID?: true
[2025-11-15T21:27:33.226Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.226Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.226Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.226Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.226Z] Current count after filter: 0
[2025-11-15T21:27:33.226Z] Max requests allowed: 3
[2025-11-15T21:27:33.226Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.226Z] New count: 1
[2025-11-15T21:27:33.226Z] Remaining: 2
[2025-11-15T21:27:33.226Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.227Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113226
}
[2025-11-15T21:27:33.234Z] üßπ clearRateLimits: Cleared 4 entries from rate limit store
[2025-11-15T21:27:33.237Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.237Z] Request URL: /auth/login
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.237Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.237Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Will use test ID?: true
[2025-11-15T21:27:33.237Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.237Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.237Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.237Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] üìù Creating new entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.237Z] Current count after filter: 0
[2025-11-15T21:27:33.237Z] Max requests allowed: 5
[2025-11-15T21:27:33.237Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.237Z] New count: 1
[2025-11-15T21:27:33.237Z] Remaining: 4
[2025-11-15T21:27:33.237Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.237Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.380Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.380Z] Request URL: /auth/login
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.380Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.380Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] Will use test ID?: true
[2025-11-15T21:27:33.380Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.380Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.381Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.381Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.381Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] üìù Creating new entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.381Z] Current count after filter: 0
[2025-11-15T21:27:33.381Z] Max requests allowed: 5
[2025-11-15T21:27:33.381Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.381Z] New count: 1
[2025-11-15T21:27:33.381Z] Remaining: 4
[2025-11-15T21:27:33.381Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.381Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.394Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.394Z] Request URL: /auth/login
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.394Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.394Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Will use test ID?: true
[2025-11-15T21:27:33.394Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.394Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.394Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.394Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.394Z] Current count after filter: 0
[2025-11-15T21:27:33.394Z] Max requests allowed: 5
[2025-11-15T21:27:33.394Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.394Z] New count: 1
[2025-11-15T21:27:33.394Z] Remaining: 4
[2025-11-15T21:27:33.394Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.395Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.421Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.421Z] Request URL: /auth/login
[2025-11-15T21:27:33.421Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.421Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.421Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Will use test ID?: true
[2025-11-15T21:27:33.422Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.422Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.422Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.422Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] üìù Creating new entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.422Z] Current count after filter: 0
[2025-11-15T21:27:33.422Z] Max requests allowed: 5
[2025-11-15T21:27:33.422Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.422Z] New count: 1
[2025-11-15T21:27:33.422Z] Remaining: 4
[2025-11-15T21:27:33.422Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.422Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.590Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.590Z] Request URL: /auth/register
[2025-11-15T21:27:33.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.590Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Will use test ID?: true
[2025-11-15T21:27:33.591Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.591Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.591Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.591Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] üìù Creating new entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.591Z] Current count after filter: 0
[2025-11-15T21:27:33.591Z] Max requests allowed: 3
[2025-11-15T21:27:33.591Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.591Z] New count: 1
[2025-11-15T21:27:33.591Z] Remaining: 2
[2025-11-15T21:27:33.591Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.608Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.608Z] Request URL: /auth/login
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.608Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.608Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Will use test ID?: true
[2025-11-15T21:27:33.608Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.608Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.608Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.608Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.608Z] Existing timestamps: 1
[2025-11-15T21:27:33.608Z] Current count after filter: 1
[2025-11-15T21:27:33.608Z] Max requests allowed: 5
[2025-11-15T21:27:33.608Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.608Z] New count: 2
[2025-11-15T21:27:33.609Z] Remaining: 3
[2025-11-15T21:27:33.609Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.609Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.614Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.614Z] Request URL: /auth/login
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.614Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] Will use test ID?: true
[2025-11-15T21:27:33.614Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.614Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.615Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.615Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.615Z] Existing timestamps: 1
[2025-11-15T21:27:33.615Z] Current count after filter: 1
[2025-11-15T21:27:33.615Z] Max requests allowed: 5
[2025-11-15T21:27:33.615Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.615Z] New count: 2
[2025-11-15T21:27:33.615Z] Remaining: 3
[2025-11-15T21:27:33.615Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.615Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.643Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.643Z] Request URL: /auth/login
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.643Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.643Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] Will use test ID?: true
[2025-11-15T21:27:33.643Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.643Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.644Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.644Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.644Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.644Z] Existing timestamps: 1
[2025-11-15T21:27:33.644Z] Current count after filter: 1
[2025-11-15T21:27:33.644Z] Max requests allowed: 5
[2025-11-15T21:27:33.644Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.644Z] New count: 2
[2025-11-15T21:27:33.644Z] Remaining: 3
[2025-11-15T21:27:33.644Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.644Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.694Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.694Z] Request URL: /auth/login
[2025-11-15T21:27:33.694Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.694Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.694Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] Will use test ID?: true
[2025-11-15T21:27:33.695Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.695Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.695Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.696Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.696Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.696Z] Existing timestamps: 1
[2025-11-15T21:27:33.696Z] Current count after filter: 1
[2025-11-15T21:27:33.696Z] Max requests allowed: 5
[2025-11-15T21:27:33.696Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.696Z] New count: 2
[2025-11-15T21:27:33.696Z] Remaining: 3
[2025-11-15T21:27:33.696Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.696Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:33.913Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.913Z] Request URL: /auth/login
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.914Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.914Z] X-Test-ID header: login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Will use test ID?: true
[2025-11-15T21:27:33.914Z] ‚úÖ Using test identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.914Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.914Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.914Z] Identifier: test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] Key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.914Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242052311-0zfo8q
[2025-11-15T21:27:33.919Z] Existing timestamps: 2
[2025-11-15T21:27:33.919Z] Current count after filter: 2
[2025-11-15T21:27:33.920Z] Max requests allowed: 5
[2025-11-15T21:27:33.920Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.920Z] New count: 3
[2025-11-15T21:27:33.920Z] Remaining: 2
[2025-11-15T21:27:33.920Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.920Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113381
}
[2025-11-15T21:27:33.922Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.922Z] Request URL: /auth/login
[2025-11-15T21:27:33.922Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.922Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.922Z] X-Test-ID header: headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Will use test ID?: true
[2025-11-15T21:27:33.923Z] ‚úÖ Using test identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.923Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.923Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.923Z] Identifier: test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242053234-9hlkhr
[2025-11-15T21:27:33.923Z] Existing timestamps: 2
[2025-11-15T21:27:33.923Z] Current count after filter: 2
[2025-11-15T21:27:33.923Z] Max requests allowed: 5
[2025-11-15T21:27:33.924Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.924Z] New count: 3
[2025-11-15T21:27:33.924Z] Remaining: 2
[2025-11-15T21:27:33.924Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.924Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113237
}
[2025-11-15T21:27:33.929Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.929Z] Request URL: /auth/login
[2025-11-15T21:27:33.929Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.931Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.931Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Will use test ID?: true
[2025-11-15T21:27:33.931Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.931Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.931Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.931Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.931Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:33.933Z] Existing timestamps: 2
[2025-11-15T21:27:33.933Z] Current count after filter: 2
[2025-11-15T21:27:33.933Z] Max requests allowed: 5
[2025-11-15T21:27:33.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.934Z] New count: 3
[2025-11-15T21:27:33.934Z] Remaining: 2
[2025-11-15T21:27:33.934Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.934Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:33.950Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:27:33.951Z] Request URL: /auth/register
[2025-11-15T21:27:33.951Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.951Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.952Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.952Z] X-Test-ID header: register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] Will use test ID?: true
[2025-11-15T21:27:33.952Z] ‚úÖ Using test identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.952Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.952Z] Got identifier from getClientIdentifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.953Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.954Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:27:33.958Z] Identifier: test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.958Z] Key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.959Z] üìñ Found existing entry for key: register:test:register-excessive-1763242052306-t7lcp4
[2025-11-15T21:27:33.960Z] Existing timestamps: 1
[2025-11-15T21:27:33.960Z] Current count after filter: 1
[2025-11-15T21:27:33.960Z] Max requests allowed: 3
[2025-11-15T21:27:33.960Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.960Z] New count: 2
[2025-11-15T21:27:33.961Z] Remaining: 1
[2025-11-15T21:27:33.966Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.966Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113591
}
[2025-11-15T21:27:33.993Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:33.994Z] Request URL: /auth/login
[2025-11-15T21:27:33.994Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:33.994Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:33.994Z] X-Test-ID header: login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.994Z] Will use test ID?: true
[2025-11-15T21:27:33.994Z] ‚úÖ Using test identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:33.995Z] Got identifier from getClientIdentifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:33.995Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:33.995Z] Identifier: test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] üìñ Found existing entry for key: login:test:login-excessive-1763242052318-stb3aj
[2025-11-15T21:27:33.995Z] Existing timestamps: 2
[2025-11-15T21:27:33.995Z] Current count after filter: 2
[2025-11-15T21:27:33.995Z] Max requests allowed: 5
[2025-11-15T21:27:33.996Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:33.996Z] New count: 3
[2025-11-15T21:27:33.996Z] Remaining: 2
[2025-11-15T21:27:33.996Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:33.996Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242113422
}
[2025-11-15T21:27:34.151Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.152Z] Request URL: /auth/login
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.152Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.152Z] X-Test-ID header: independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Will use test ID?: true
[2025-11-15T21:27:34.152Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.152Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.152Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.152Z] Identifier: test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242052919-zgp3n
[2025-11-15T21:27:34.152Z] Existing timestamps: 3
[2025-11-15T21:27:34.152Z] Current count after filter: 3
[2025-11-15T21:27:34.152Z] Max requests allowed: 5
[2025-11-15T21:27:34.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.152Z] New count: 4
[2025-11-15T21:27:34.152Z] Remaining: 1
[2025-11-15T21:27:34.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242113394
}
[2025-11-15T21:27:34.181Z] üßπ clearRateLimits: Cleared 5 entries from rate limit store
[2025-11-15T21:27:34.183Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.183Z] Request URL: /auth/login
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.183Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.183Z] X-Test-ID header: perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Will use test ID?: true
[2025-11-15T21:27:34.183Z] ‚úÖ Using test identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.183Z] Got identifier from getClientIdentifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.183Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.183Z] Identifier: test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] üìù Creating new entry for key: login:test:perf-test-1763242054182-fpirg
[2025-11-15T21:27:34.183Z] Current count after filter: 0
[2025-11-15T21:27:34.183Z] Max requests allowed: 5
[2025-11-15T21:27:34.183Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.183Z] New count: 1
[2025-11-15T21:27:34.184Z] Remaining: 4
[2025-11-15T21:27:34.184Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.184Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114183
}
[2025-11-15T21:27:34.860Z] üßπ clearRateLimits: Cleared 1 entries from rate limit store
[2025-11-15T21:27:34.868Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:34.869Z] Request URL: /auth/login
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:34.869Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:34.869Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Will use test ID?: true
[2025-11-15T21:27:34.869Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:34.869Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:34.869Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:34.869Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] üìù Creating new entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:34.869Z] Current count after filter: 0
[2025-11-15T21:27:34.869Z] Max requests allowed: 5
[2025-11-15T21:27:34.870Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:34.870Z] New count: 1
[2025-11-15T21:27:34.870Z] Remaining: 4
[2025-11-15T21:27:34.870Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:34.870Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242114869
}
[2025-11-15T21:27:35.190Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:27:35.190Z] Request URL: /auth/login
[2025-11-15T21:27:35.190Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:27:35.190Z] E2E_TEST_MODE (env): true
[2025-11-15T21:27:35.191Z] E2E_TEST_MODE (final): true
[2025-11-15T21:27:35.191Z] X-Test-ID header: headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Will use test ID?: true
[2025-11-15T21:27:35.191Z] ‚úÖ Using test identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:27:35.191Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:27:35.191Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:27:35.191Z] Identifier: test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.191Z] Key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242054865-nyftq0f
[2025-11-15T21:27:35.192Z] Existing timestamps: 1
[2025-11-15T21:27:35.192Z] Current count after filter: 1
[2025-11-15T21:27:35.192Z] Max requests allowed: 5
[2025-11-15T21:27:35.192Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:27:35.192Z] New count: 2
[2025-11-15T21:27:35.192Z] Remaining: 3
[2025-11-15T21:27:35.192Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:27:35.192Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242114869
}
[2025-11-15T21:32:12.512Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.513Z] Request URL: /auth/login
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.513Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.513Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Will use test ID?: true
[2025-11-15T21:32:12.513Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.513Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.513Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] üìù Creating new entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:12.513Z] Current count after filter: 0
[2025-11-15T21:32:12.513Z] Max requests allowed: 5
[2025-11-15T21:32:12.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.514Z] New count: 1
[2025-11-15T21:32:12.514Z] Remaining: 4
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.514Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:12.514Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.514Z] Request URL: /auth/login
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.514Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.514Z] X-Test-ID header: login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] Will use test ID?: true
[2025-11-15T21:32:12.514Z] ‚úÖ Using test identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.514Z] Got identifier from getClientIdentifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.514Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.514Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.514Z] Identifier: test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-headers-1763242332193-wpcx5a
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392514
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:12.515Z] Request URL: /auth/login
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.515Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.515Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Will use test ID?: true
[2025-11-15T21:32:12.515Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.515Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.515Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:12.515Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] üìù Creating new entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:12.515Z] Current count after filter: 0
[2025-11-15T21:32:12.515Z] Max requests allowed: 5
[2025-11-15T21:32:12.515Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.515Z] New count: 1
[2025-11-15T21:32:12.515Z] Remaining: 4
[2025-11-15T21:32:12.515Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.515Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:12.515Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.515Z] Request URL: /auth/register
[2025-11-15T21:32:12.515Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] üìù Creating new entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:12.516Z] Current count after filter: 0
[2025-11-15T21:32:12.516Z] Max requests allowed: 3
[2025-11-15T21:32:12.516Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.516Z] New count: 1
[2025-11-15T21:32:12.516Z] Remaining: 2
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.516Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:12.516Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:12.516Z] Request URL: /auth/register
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:12.516Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:12.516Z] X-Test-ID header: register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Will use test ID?: true
[2025-11-15T21:32:12.516Z] ‚úÖ Using test identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:12.516Z] Got identifier from getClientIdentifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:12.516Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:12.516Z] Identifier: test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.516Z] Key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] üìù Creating new entry for key: register:test:register-headers-1763242332193-j0l91
[2025-11-15T21:32:12.517Z] Current count after filter: 0
[2025-11-15T21:32:12.517Z] Max requests allowed: 3
[2025-11-15T21:32:12.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:12.517Z] New count: 1
[2025-11-15T21:32:12.517Z] Remaining: 2
[2025-11-15T21:32:12.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:12.517Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.041Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.041Z] Request URL: /auth/login
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.041Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.041Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] Will use test ID?: true
[2025-11-15T21:32:13.041Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.041Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.041Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.042Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.042Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.042Z] Existing timestamps: 1
[2025-11-15T21:32:13.042Z] Current count after filter: 1
[2025-11-15T21:32:13.042Z] Max requests allowed: 5
[2025-11-15T21:32:13.042Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.042Z] New count: 2
[2025-11-15T21:32:13.042Z] Remaining: 3
[2025-11-15T21:32:13.042Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.042Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.089Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.089Z] Request URL: /auth/login
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.089Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.089Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] Will use test ID?: true
[2025-11-15T21:32:13.089Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.089Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.090Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.090Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.090Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.090Z] Existing timestamps: 1
[2025-11-15T21:32:13.090Z] Current count after filter: 1
[2025-11-15T21:32:13.090Z] Max requests allowed: 5
[2025-11-15T21:32:13.090Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.090Z] New count: 2
[2025-11-15T21:32:13.090Z] Remaining: 3
[2025-11-15T21:32:13.090Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.090Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.121Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.121Z] Request URL: /auth/login
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.121Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.121Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Will use test ID?: true
[2025-11-15T21:32:13.121Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.121Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.121Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.121Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.121Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.122Z] Current count after filter: 0
[2025-11-15T21:32:13.122Z] Max requests allowed: 5
[2025-11-15T21:32:13.122Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.122Z] New count: 1
[2025-11-15T21:32:13.122Z] Remaining: 4
[2025-11-15T21:32:13.122Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.122Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.274Z] Request URL: /auth/login
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.274Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.274Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Will use test ID?: true
[2025-11-15T21:32:13.274Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.274Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.274Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.274Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.274Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.275Z] Existing timestamps: 2
[2025-11-15T21:32:13.275Z] Current count after filter: 2
[2025-11-15T21:32:13.275Z] Max requests allowed: 5
[2025-11-15T21:32:13.275Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.275Z] New count: 3
[2025-11-15T21:32:13.275Z] Remaining: 2
[2025-11-15T21:32:13.275Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.275Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.373Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.373Z] Request URL: /auth/login
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.373Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.373Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Will use test ID?: true
[2025-11-15T21:32:13.373Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.373Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.373Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.373Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.373Z] Existing timestamps: 1
[2025-11-15T21:32:13.373Z] Current count after filter: 1
[2025-11-15T21:32:13.374Z] Max requests allowed: 5
[2025-11-15T21:32:13.374Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.374Z] New count: 2
[2025-11-15T21:32:13.374Z] Remaining: 3
[2025-11-15T21:32:13.374Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.374Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.498Z] Request URL: /auth/login
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.498Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] Will use test ID?: true
[2025-11-15T21:32:13.498Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.498Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.498Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.499Z] Existing timestamps: 3
[2025-11-15T21:32:13.499Z] Current count after filter: 3
[2025-11-15T21:32:13.499Z] Max requests allowed: 5
[2025-11-15T21:32:13.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.499Z] New count: 4
[2025-11-15T21:32:13.499Z] Remaining: 1
[2025-11-15T21:32:13.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.579Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.580Z] Request URL: /auth/register
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.580Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.580Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Will use test ID?: true
[2025-11-15T21:32:13.580Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.580Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.580Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.580Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.580Z] Existing timestamps: 1
[2025-11-15T21:32:13.580Z] Current count after filter: 1
[2025-11-15T21:32:13.580Z] Max requests allowed: 3
[2025-11-15T21:32:13.580Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.580Z] New count: 2
[2025-11-15T21:32:13.580Z] Remaining: 1
[2025-11-15T21:32:13.580Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.580Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.588Z] Request URL: /auth/login
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.588Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.588Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Will use test ID?: true
[2025-11-15T21:32:13.588Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.588Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.588Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.588Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] üìù Creating new entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.589Z] Current count after filter: 0
[2025-11-15T21:32:13.589Z] Max requests allowed: 5
[2025-11-15T21:32:13.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.589Z] New count: 1
[2025-11-15T21:32:13.589Z] Remaining: 4
[2025-11-15T21:32:13.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.589Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.596Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.596Z] Request URL: /auth/login
[2025-11-15T21:32:13.596Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.596Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.597Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.597Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Will use test ID?: true
[2025-11-15T21:32:13.597Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.597Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.597Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.597Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.597Z] Existing timestamps: 2
[2025-11-15T21:32:13.597Z] Current count after filter: 2
[2025-11-15T21:32:13.597Z] Max requests allowed: 5
[2025-11-15T21:32:13.597Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.597Z] New count: 3
[2025-11-15T21:32:13.597Z] Remaining: 2
[2025-11-15T21:32:13.597Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.597Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.598Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.598Z] Request URL: /auth/login
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.598Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.598Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Will use test ID?: true
[2025-11-15T21:32:13.598Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.598Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.598Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.598Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.598Z] Existing timestamps: 2
[2025-11-15T21:32:13.598Z] Current count after filter: 2
[2025-11-15T21:32:13.598Z] Max requests allowed: 5
[2025-11-15T21:32:13.598Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.598Z] New count: 3
[2025-11-15T21:32:13.598Z] Remaining: 2
[2025-11-15T21:32:13.599Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.599Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.747Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.747Z] Request URL: /auth/login
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.747Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.747Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] Will use test ID?: true
[2025-11-15T21:32:13.747Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.747Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.747Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.747Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.748Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.748Z] Existing timestamps: 4
[2025-11-15T21:32:13.748Z] Current count after filter: 4
[2025-11-15T21:32:13.748Z] Max requests allowed: 5
[2025-11-15T21:32:13.748Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.748Z] New count: 5
[2025-11-15T21:32:13.748Z] Remaining: 0
[2025-11-15T21:32:13.748Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.748Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392513
}
[2025-11-15T21:32:13.798Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.798Z] Request URL: /auth/login
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.798Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.798Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] Will use test ID?: true
[2025-11-15T21:32:13.798Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.798Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.799Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.799Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.799Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:13.799Z] Existing timestamps: 1
[2025-11-15T21:32:13.799Z] Current count after filter: 1
[2025-11-15T21:32:13.799Z] Max requests allowed: 5
[2025-11-15T21:32:13.799Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.799Z] New count: 2
[2025-11-15T21:32:13.799Z] Remaining: 3
[2025-11-15T21:32:13.799Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.799Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:13.832Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.832Z] Request URL: /auth/login
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.832Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.832Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] Will use test ID?: true
[2025-11-15T21:32:13.832Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.832Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.832Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.832Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.833Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:13.833Z] Existing timestamps: 3
[2025-11-15T21:32:13.833Z] Current count after filter: 3
[2025-11-15T21:32:13.833Z] Max requests allowed: 5
[2025-11-15T21:32:13.833Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.833Z] New count: 4
[2025-11-15T21:32:13.833Z] Remaining: 1
[2025-11-15T21:32:13.833Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.833Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:13.872Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.872Z] Request URL: /auth/login
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.872Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.872Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] Will use test ID?: true
[2025-11-15T21:32:13.872Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.872Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.873Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.873Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.873Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:13.873Z] Existing timestamps: 3
[2025-11-15T21:32:13.873Z] Current count after filter: 3
[2025-11-15T21:32:13.873Z] Max requests allowed: 5
[2025-11-15T21:32:13.873Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.873Z] New count: 4
[2025-11-15T21:32:13.873Z] Remaining: 1
[2025-11-15T21:32:13.873Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.873Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:13.926Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:13.926Z] Request URL: /auth/register
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.926Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.926Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Will use test ID?: true
[2025-11-15T21:32:13.926Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.926Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.926Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:13.926Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:13.926Z] Existing timestamps: 2
[2025-11-15T21:32:13.926Z] Current count after filter: 2
[2025-11-15T21:32:13.926Z] Max requests allowed: 3
[2025-11-15T21:32:13.926Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.926Z] New count: 3
[2025-11-15T21:32:13.926Z] Remaining: 0
[2025-11-15T21:32:13.927Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.927Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392516
}
[2025-11-15T21:32:13.971Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.971Z] Request URL: /auth/login
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.971Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.971Z] X-Test-ID header: login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] Will use test ID?: true
[2025-11-15T21:32:13.971Z] ‚úÖ Using test identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.971Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.971Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.971Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.972Z] Identifier: test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242332194-scrdck
[2025-11-15T21:32:13.972Z] Existing timestamps: 5
[2025-11-15T21:32:13.972Z] Current count after filter: 5
[2025-11-15T21:32:13.972Z] Max requests allowed: 5
[2025-11-15T21:32:13.972Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:13.972Z] Current count: 5
[2025-11-15T21:32:13.972Z] Max allowed: 5
[2025-11-15T21:32:13.972Z] Retry after (seconds): 59
[2025-11-15T21:32:13.972Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:13.972Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392513,
  "retryAfter": 59
}
[2025-11-15T21:32:13.984Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:13.984Z] Request URL: /auth/login
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:13.984Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:13.984Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] Will use test ID?: true
[2025-11-15T21:32:13.984Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:13.984Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.984Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:13.985Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:13.985Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] üìù Creating new entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:13.985Z] Current count after filter: 0
[2025-11-15T21:32:13.985Z] Max requests allowed: 5
[2025-11-15T21:32:13.985Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:13.985Z] New count: 1
[2025-11-15T21:32:13.985Z] Remaining: 4
[2025-11-15T21:32:13.985Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:13.985Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.033Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.033Z] Request URL: /auth/login
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.033Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.033Z] X-Test-ID header: headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Will use test ID?: true
[2025-11-15T21:32:14.033Z] ‚úÖ Using test identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.033Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.033Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.033Z] Identifier: test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242333587-dngll
[2025-11-15T21:32:14.033Z] Existing timestamps: 2
[2025-11-15T21:32:14.033Z] Current count after filter: 2
[2025-11-15T21:32:14.033Z] Max requests allowed: 5
[2025-11-15T21:32:14.033Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.033Z] New count: 3
[2025-11-15T21:32:14.033Z] Remaining: 2
[2025-11-15T21:32:14.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242393588
}
[2025-11-15T21:32:14.091Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.091Z] Request URL: /auth/login
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.091Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.091Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Will use test ID?: true
[2025-11-15T21:32:14.091Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.091Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.091Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.091Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.091Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.092Z] Existing timestamps: 4
[2025-11-15T21:32:14.092Z] Current count after filter: 4
[2025-11-15T21:32:14.092Z] Max requests allowed: 5
[2025-11-15T21:32:14.092Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.092Z] New count: 5
[2025-11-15T21:32:14.092Z] Remaining: 0
[2025-11-15T21:32:14.092Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.092Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242393121
}
[2025-11-15T21:32:14.150Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.150Z] Request URL: /auth/login
[2025-11-15T21:32:14.150Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.150Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.151Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Will use test ID?: true
[2025-11-15T21:32:14.151Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.151Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.151Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.151Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.151Z] Existing timestamps: 4
[2025-11-15T21:32:14.151Z] Current count after filter: 4
[2025-11-15T21:32:14.151Z] Max requests allowed: 5
[2025-11-15T21:32:14.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.151Z] New count: 5
[2025-11-15T21:32:14.151Z] Remaining: 0
[2025-11-15T21:32:14.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242392515
}
[2025-11-15T21:32:14.268Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.268Z] Request URL: /auth/login
[2025-11-15T21:32:14.268Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.268Z] X-Test-ID header: headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Will use test ID?: true
[2025-11-15T21:32:14.269Z] ‚úÖ Using test identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.269Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.269Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.269Z] Identifier: test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242333983-0rx8ik
[2025-11-15T21:32:14.269Z] Existing timestamps: 1
[2025-11-15T21:32:14.269Z] Current count after filter: 1
[2025-11-15T21:32:14.269Z] Max requests allowed: 5
[2025-11-15T21:32:14.269Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.269Z] New count: 2
[2025-11-15T21:32:14.269Z] Remaining: 3
[2025-11-15T21:32:14.269Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.269Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242393984
}
[2025-11-15T21:32:14.272Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.272Z] Request URL: /auth/register
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.272Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.272Z] X-Test-ID header: register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Will use test ID?: true
[2025-11-15T21:32:14.272Z] ‚úÖ Using test identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.272Z] Got identifier from getClientIdentifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.272Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.272Z] Identifier: test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] üìñ Found existing entry for key: register:test:register-excessive-1763242332190-cqtuj
[2025-11-15T21:32:14.272Z] Existing timestamps: 3
[2025-11-15T21:32:14.272Z] Current count after filter: 3
[2025-11-15T21:32:14.272Z] Max requests allowed: 3
[2025-11-15T21:32:14.272Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.272Z] Current count: 3
[2025-11-15T21:32:14.272Z] Max allowed: 3
[2025-11-15T21:32:14.272Z] Retry after (seconds): 59
[2025-11-15T21:32:14.272Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.272Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392516,
  "retryAfter": 59
}
[2025-11-15T21:32:14.284Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.284Z] Request URL: /auth/login
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.284Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.284Z] X-Test-ID header: perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Will use test ID?: true
[2025-11-15T21:32:14.284Z] ‚úÖ Using test identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.284Z] Got identifier from getClientIdentifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.284Z] Identifier: test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] üìù Creating new entry for key: login:test:perf-test-1763242334280-7ulh1
[2025-11-15T21:32:14.284Z] Current count after filter: 0
[2025-11-15T21:32:14.284Z] Max requests allowed: 5
[2025-11-15T21:32:14.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.284Z] New count: 1
[2025-11-15T21:32:14.284Z] Remaining: 4
[2025-11-15T21:32:14.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242394284
}
[2025-11-15T21:32:14.343Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.343Z] Request URL: /auth/login
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.344Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.344Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Will use test ID?: true
[2025-11-15T21:32:14.344Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.344Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.344Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.344Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.344Z] Existing timestamps: 5
[2025-11-15T21:32:14.344Z] Current count after filter: 5
[2025-11-15T21:32:14.344Z] Max requests allowed: 5
[2025-11-15T21:32:14.344Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.344Z] Current count: 5
[2025-11-15T21:32:14.344Z] Max allowed: 5
[2025-11-15T21:32:14.344Z] Retry after (seconds): 59
[2025-11-15T21:32:14.344Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.344Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242393121,
  "retryAfter": 59
}
[2025-11-15T21:32:14.346Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:32:14.346Z] Request URL: /auth/register
[2025-11-15T21:32:14.346Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.346Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.346Z] X-Test-ID header: independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.346Z] Will use test ID?: true
[2025-11-15T21:32:14.347Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.347Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.347Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:32:14.347Z] Identifier: test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242333119-gzaj2o
[2025-11-15T21:32:14.347Z] Current count after filter: 0
[2025-11-15T21:32:14.347Z] Max requests allowed: 3
[2025-11-15T21:32:14.347Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:32:14.347Z] New count: 1
[2025-11-15T21:32:14.347Z] Remaining: 2
[2025-11-15T21:32:14.347Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:32:14.347Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242394347
}
[2025-11-15T21:32:14.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:32:14.448Z] Request URL: /auth/login
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (env): true
[2025-11-15T21:32:14.449Z] E2E_TEST_MODE (final): true
[2025-11-15T21:32:14.449Z] X-Test-ID header: login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Will use test ID?: true
[2025-11-15T21:32:14.449Z] ‚úÖ Using test identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:32:14.449Z] Got identifier from getClientIdentifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:32:14.449Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:32:14.449Z] Identifier: test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] üìñ Found existing entry for key: login:test:login-excessive-1763242332194-jj457c
[2025-11-15T21:32:14.449Z] Existing timestamps: 5
[2025-11-15T21:32:14.449Z] Current count after filter: 5
[2025-11-15T21:32:14.449Z] Max requests allowed: 5
[2025-11-15T21:32:14.449Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:32:14.449Z] Current count: 5
[2025-11-15T21:32:14.449Z] Max allowed: 5
[2025-11-15T21:32:14.449Z] Retry after (seconds): 59
[2025-11-15T21:32:14.449Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:32:14.449Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242392515,
  "retryAfter": 59
}
[2025-11-15T21:36:59.425Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.426Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.426Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] üìù Creating new entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.426Z] Current count after filter: 0
[2025-11-15T21:36:59.426Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 1
[2025-11-15T21:36:59.427Z] Remaining: 4
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.427Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.427Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.427Z] Existing timestamps: 1
[2025-11-15T21:36:59.427Z] Current count after filter: 1
[2025-11-15T21:36:59.427Z] Max requests allowed: 5
[2025-11-15T21:36:59.427Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.427Z] New count: 2
[2025-11-15T21:36:59.427Z] Remaining: 3
[2025-11-15T21:36:59.427Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.428Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.428Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.428Z] Existing timestamps: 2
[2025-11-15T21:36:59.428Z] Current count after filter: 2
[2025-11-15T21:36:59.428Z] Max requests allowed: 5
[2025-11-15T21:36:59.428Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.428Z] New count: 3
[2025-11-15T21:36:59.428Z] Remaining: 2
[2025-11-15T21:36:59.428Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 3
[2025-11-15T21:36:59.429Z] Current count after filter: 3
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 4
[2025-11-15T21:36:59.429Z] Remaining: 1
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.429Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.429Z] Identifier: test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] üìñ Found existing entry for key: login:test-allow-1763242619425
[2025-11-15T21:36:59.429Z] Existing timestamps: 4
[2025-11-15T21:36:59.429Z] Current count after filter: 4
[2025-11-15T21:36:59.429Z] Max requests allowed: 5
[2025-11-15T21:36:59.429Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.429Z] New count: 5
[2025-11-15T21:36:59.429Z] Remaining: 0
[2025-11-15T21:36:59.429Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìù Creating new entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Current count after filter: 0
[2025-11-15T21:36:59.430Z] Max requests allowed: 5
[2025-11-15T21:36:59.430Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.430Z] New count: 1
[2025-11-15T21:36:59.430Z] Remaining: 4
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.430Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.430Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.430Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.430Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.430Z] Existing timestamps: 1
[2025-11-15T21:36:59.431Z] Current count after filter: 1
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 2
[2025-11-15T21:36:59.431Z] Remaining: 3
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 2
[2025-11-15T21:36:59.431Z] Current count after filter: 2
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 3
[2025-11-15T21:36:59.431Z] Remaining: 2
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.431Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.431Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.431Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.431Z] Existing timestamps: 3
[2025-11-15T21:36:59.431Z] Current count after filter: 3
[2025-11-15T21:36:59.431Z] Max requests allowed: 5
[2025-11-15T21:36:59.431Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.431Z] New count: 4
[2025-11-15T21:36:59.431Z] Remaining: 1
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.431Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 4
[2025-11-15T21:36:59.432Z] Current count after filter: 4
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.432Z] New count: 5
[2025-11-15T21:36:59.432Z] Remaining: 0
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.432Z] Identifier: test-block-1763242619430
[2025-11-15T21:36:59.432Z] Key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] üìñ Found existing entry for key: login:test-block-1763242619430
[2025-11-15T21:36:59.432Z] Existing timestamps: 5
[2025-11-15T21:36:59.432Z] Current count after filter: 5
[2025-11-15T21:36:59.432Z] Max requests allowed: 5
[2025-11-15T21:36:59.432Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.432Z] Current count: 5
[2025-11-15T21:36:59.432Z] Max allowed: 5
[2025-11-15T21:36:59.432Z] Retry after (seconds): 60
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.432Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.432Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.432Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.432Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìù Creating new entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Current count after filter: 0
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 1
[2025-11-15T21:36:59.433Z] Remaining: 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 1
[2025-11-15T21:36:59.433Z] Current count after filter: 1
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.433Z] New count: 2
[2025-11-15T21:36:59.433Z] Remaining: 0
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.433Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.433Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.433Z] Existing timestamps: 2
[2025-11-15T21:36:59.433Z] Current count after filter: 2
[2025-11-15T21:36:59.433Z] Max requests allowed: 2
[2025-11-15T21:36:59.433Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.433Z] Current count: 2
[2025-11-15T21:36:59.433Z] Max allowed: 2
[2025-11-15T21:36:59.433Z] Retry after (seconds): 1
[2025-11-15T21:36:59.433Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.585Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.585Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:36:59.585Z] Identifier: test-reset-1763242619432
[2025-11-15T21:36:59.585Z] Key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.585Z] üìñ Found existing entry for key: test-reset:test-reset-1763242619432
[2025-11-15T21:36:59.586Z] Existing timestamps: 2
[2025-11-15T21:36:59.586Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.586Z] Max requests allowed: 2
[2025-11-15T21:36:59.586Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.586Z] New count: 1
[2025-11-15T21:36:59.586Z] Remaining: 1
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.586Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.586Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.586Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] üìù Creating new entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.586Z] Current count after filter: 0
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 1
[2025-11-15T21:36:59.587Z] Remaining: 4
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 1
[2025-11-15T21:36:59.587Z] Current count after filter: 1
[2025-11-15T21:36:59.587Z] Max requests allowed: 5
[2025-11-15T21:36:59.587Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.587Z] New count: 2
[2025-11-15T21:36:59.587Z] Remaining: 3
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.587Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.587Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.587Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.587Z] Existing timestamps: 2
[2025-11-15T21:36:59.588Z] Current count after filter: 2
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 3
[2025-11-15T21:36:59.588Z] Remaining: 2
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 3
[2025-11-15T21:36:59.588Z] Current count after filter: 3
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 4
[2025-11-15T21:36:59.588Z] Remaining: 1
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 4
[2025-11-15T21:36:59.588Z] Current count after filter: 4
[2025-11-15T21:36:59.588Z] Max requests allowed: 5
[2025-11-15T21:36:59.588Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.588Z] New count: 5
[2025-11-15T21:36:59.588Z] Remaining: 0
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.588Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.588Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.588Z] Identifier: test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] üìñ Found existing entry for key: login:test-multi-1-1763242619586
[2025-11-15T21:36:59.588Z] Existing timestamps: 5
[2025-11-15T21:36:59.589Z] Current count after filter: 5
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.589Z] Current count: 5
[2025-11-15T21:36:59.589Z] Max allowed: 5
[2025-11-15T21:36:59.589Z] Retry after (seconds): 60
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.589Z] Identifier: test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] üìù Creating new entry for key: login:test-multi-2-1763242619586
[2025-11-15T21:36:59.589Z] Current count after filter: 0
[2025-11-15T21:36:59.589Z] Max requests allowed: 5
[2025-11-15T21:36:59.589Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.589Z] New count: 1
[2025-11-15T21:36:59.589Z] Remaining: 4
[2025-11-15T21:36:59.589Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:36:59.590Z] Identifier: test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] üìù Creating new entry for key: login:test-reset-time-1763242619590
[2025-11-15T21:36:59.590Z] Current count after filter: 0
[2025-11-15T21:36:59.590Z] Max requests allowed: 5
[2025-11-15T21:36:59.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.590Z] New count: 1
[2025-11-15T21:36:59.590Z] Remaining: 4
[2025-11-15T21:36:59.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.591Z] X-Test-ID header: null
[2025-11-15T21:36:59.591Z] Will use test ID?: false
[2025-11-15T21:36:59.591Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.591Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using real IP: 192.168.1.2
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.592Z] Will use test ID?: false
[2025-11-15T21:36:59.592Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.592Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.592Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.592Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (env): true
[2025-11-15T21:36:59.593Z] E2E_TEST_MODE (final): true
[2025-11-15T21:36:59.593Z] X-Test-ID header: null
[2025-11-15T21:36:59.593Z] Will use test ID?: false
[2025-11-15T21:36:59.593Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:36:59.593Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:36:59.593Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.593Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.593Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] üìù Creating new entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.593Z] Current count after filter: 0
[2025-11-15T21:36:59.593Z] Max requests allowed: 3
[2025-11-15T21:36:59.594Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.594Z] New count: 1
[2025-11-15T21:36:59.594Z] Remaining: 2
[2025-11-15T21:36:59.594Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.694Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.695Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.695Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.695Z] Existing timestamps: 1
[2025-11-15T21:36:59.695Z] Current count after filter: 1
[2025-11-15T21:36:59.695Z] Max requests allowed: 3
[2025-11-15T21:36:59.695Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.695Z] New count: 2
[2025-11-15T21:36:59.695Z] Remaining: 1
[2025-11-15T21:36:59.695Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.795Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.795Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:36:59.795Z] Identifier: test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763242619593
[2025-11-15T21:36:59.795Z] Existing timestamps: 2
[2025-11-15T21:36:59.795Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:36:59.795Z] Current count after filter: 1
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 2
[2025-11-15T21:36:59.796Z] Remaining: 1
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.796Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.796Z] Identifier: test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] üìù Creating new entry for key: register:test-format-allowed-1763242619796
[2025-11-15T21:36:59.796Z] Current count after filter: 0
[2025-11-15T21:36:59.796Z] Max requests allowed: 3
[2025-11-15T21:36:59.796Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.796Z] New count: 1
[2025-11-15T21:36:59.796Z] Remaining: 2
[2025-11-15T21:36:59.796Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìù Creating new entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Current count after filter: 0
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 1
[2025-11-15T21:36:59.797Z] Remaining: 2
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 1
[2025-11-15T21:36:59.797Z] Current count after filter: 1
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 2
[2025-11-15T21:36:59.797Z] Remaining: 1
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.797Z] Existing timestamps: 2
[2025-11-15T21:36:59.797Z] Current count after filter: 2
[2025-11-15T21:36:59.797Z] Max requests allowed: 3
[2025-11-15T21:36:59.797Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:36:59.797Z] New count: 3
[2025-11-15T21:36:59.797Z] Remaining: 0
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:36:59.797Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:36:59.797Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:36:59.797Z] Identifier: test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] üìñ Found existing entry for key: register:test-format-blocked-1763242619797
[2025-11-15T21:36:59.798Z] Existing timestamps: 3
[2025-11-15T21:36:59.798Z] Current count after filter: 3
[2025-11-15T21:36:59.798Z] Max requests allowed: 3
[2025-11-15T21:36:59.798Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:36:59.798Z] Current count: 3
[2025-11-15T21:36:59.798Z] Max allowed: 3
[2025-11-15T21:36:59.798Z] Retry after (seconds): 60
[2025-11-15T21:36:59.798Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:17.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:17.151Z] Request URL: /auth/register
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:17.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:17.151Z] X-Test-ID header: null
[2025-11-15T21:37:17.151Z] Will use test ID?: false
[2025-11-15T21:37:17.151Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:17.151Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:17.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:17.151Z] Identifier: unknown
[2025-11-15T21:37:17.151Z] Key: register:unknown
[2025-11-15T21:37:17.151Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:37:17.151Z] Current count after filter: 0
[2025-11-15T21:37:17.151Z] Max requests allowed: 3
[2025-11-15T21:37:17.151Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:17.151Z] New count: 1
[2025-11-15T21:37:17.151Z] Remaining: 2
[2025-11-15T21:37:17.151Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:17.151Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:18.498Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.498Z] Request URL: /auth/verify-email
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.498Z] X-Test-ID header: null
[2025-11-15T21:37:18.498Z] Will use test ID?: false
[2025-11-15T21:37:18.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.498Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.498Z] Identifier: unknown
[2025-11-15T21:37:18.498Z] Key: login:unknown
[2025-11-15T21:37:18.498Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:37:18.498Z] Current count after filter: 0
[2025-11-15T21:37:18.498Z] Max requests allowed: 5
[2025-11-15T21:37:18.499Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.499Z] New count: 1
[2025-11-15T21:37:18.499Z] Remaining: 4
[2025-11-15T21:37:18.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:18.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:18.590Z] Request URL: /auth/forgot-password
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:18.590Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:18.590Z] X-Test-ID header: null
[2025-11-15T21:37:18.590Z] Will use test ID?: false
[2025-11-15T21:37:18.590Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:18.590Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:18.590Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:18.590Z] Identifier: unknown
[2025-11-15T21:37:18.590Z] Key: login:unknown
[2025-11-15T21:37:18.590Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:18.590Z] Existing timestamps: 1
[2025-11-15T21:37:18.590Z] Current count after filter: 1
[2025-11-15T21:37:18.590Z] Max requests allowed: 5
[2025-11-15T21:37:18.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:18.590Z] New count: 2
[2025-11-15T21:37:18.590Z] Remaining: 3
[2025-11-15T21:37:18.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:18.591Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:20.766Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:20.767Z] Request URL: /auth/reset-password
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:20.767Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:20.767Z] X-Test-ID header: null
[2025-11-15T21:37:20.767Z] Will use test ID?: false
[2025-11-15T21:37:20.767Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:20.767Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:20.767Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:20.767Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:20.767Z] Identifier: unknown
[2025-11-15T21:37:20.767Z] Key: login:unknown
[2025-11-15T21:37:20.767Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:37:20.767Z] Existing timestamps: 2
[2025-11-15T21:37:20.767Z] Current count after filter: 2
[2025-11-15T21:37:20.767Z] Max requests allowed: 5
[2025-11-15T21:37:20.767Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:20.768Z] New count: 3
[2025-11-15T21:37:20.768Z] Remaining: 2
[2025-11-15T21:37:20.768Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:20.768Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242698498
}
[2025-11-15T21:37:22.065Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.065Z] Request URL: /auth/login
[2025-11-15T21:37:22.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.066Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.066Z] X-Test-ID header: login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Will use test ID?: true
[2025-11-15T21:37:22.066Z] ‚úÖ Using test identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.066Z] Got identifier from getClientIdentifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.066Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.066Z] Identifier: test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] üìù Creating new entry for key: login:test:login-headers-1763242642043-rxz9eq
[2025-11-15T21:37:22.066Z] Current count after filter: 0
[2025-11-15T21:37:22.066Z] Max requests allowed: 5
[2025-11-15T21:37:22.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.066Z] New count: 1
[2025-11-15T21:37:22.066Z] Remaining: 4
[2025-11-15T21:37:22.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702066
}
[2025-11-15T21:37:22.140Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.141Z] Request URL: /auth/login
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.141Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.141Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Will use test ID?: true
[2025-11-15T21:37:22.141Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.141Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.141Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.141Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] üìù Creating new entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.141Z] Current count after filter: 0
[2025-11-15T21:37:22.141Z] Max requests allowed: 5
[2025-11-15T21:37:22.141Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.141Z] New count: 1
[2025-11-15T21:37:22.141Z] Remaining: 4
[2025-11-15T21:37:22.141Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.141Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.348Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.349Z] Request URL: /auth/login
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.349Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.349Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] Will use test ID?: true
[2025-11-15T21:37:22.349Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.349Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.349Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.349Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.350Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] üìù Creating new entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.350Z] Current count after filter: 0
[2025-11-15T21:37:22.350Z] Max requests allowed: 5
[2025-11-15T21:37:22.350Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.350Z] New count: 1
[2025-11-15T21:37:22.350Z] Remaining: 4
[2025-11-15T21:37:22.350Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.350Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.568Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.568Z] Request URL: /auth/login
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.569Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.569Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Will use test ID?: true
[2025-11-15T21:37:22.569Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.569Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.569Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.569Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.569Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.570Z] Existing timestamps: 1
[2025-11-15T21:37:22.570Z] Current count after filter: 1
[2025-11-15T21:37:22.570Z] Max requests allowed: 5
[2025-11-15T21:37:22.570Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.570Z] New count: 2
[2025-11-15T21:37:22.570Z] Remaining: 3
[2025-11-15T21:37:22.570Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.571Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.581Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.581Z] Request URL: /auth/login
[2025-11-15T21:37:22.581Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.581Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.581Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.581Z] Will use test ID?: true
[2025-11-15T21:37:22.582Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.582Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.582Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.582Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.582Z] Existing timestamps: 1
[2025-11-15T21:37:22.582Z] Current count after filter: 1
[2025-11-15T21:37:22.582Z] Max requests allowed: 5
[2025-11-15T21:37:22.582Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.582Z] New count: 2
[2025-11-15T21:37:22.582Z] Remaining: 3
[2025-11-15T21:37:22.582Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.582Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:22.821Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.821Z] Request URL: /auth/login
[2025-11-15T21:37:22.821Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.821Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.822Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.822Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] Will use test ID?: true
[2025-11-15T21:37:22.822Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.822Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.822Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.822Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.822Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:22.823Z] Existing timestamps: 2
[2025-11-15T21:37:22.823Z] Current count after filter: 2
[2025-11-15T21:37:22.823Z] Max requests allowed: 5
[2025-11-15T21:37:22.824Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.824Z] New count: 3
[2025-11-15T21:37:22.824Z] Remaining: 2
[2025-11-15T21:37:22.824Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.824Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:22.892Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:22.892Z] Request URL: /auth/login
[2025-11-15T21:37:22.892Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:22.892Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:22.892Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Will use test ID?: true
[2025-11-15T21:37:22.893Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:22.893Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:22.893Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:22.893Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:22.893Z] Existing timestamps: 2
[2025-11-15T21:37:22.893Z] Current count after filter: 2
[2025-11-15T21:37:22.894Z] Max requests allowed: 5
[2025-11-15T21:37:22.894Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:22.894Z] New count: 3
[2025-11-15T21:37:22.894Z] Remaining: 2
[2025-11-15T21:37:22.894Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:22.894Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.099Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.099Z] Request URL: /auth/login
[2025-11-15T21:37:23.099Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.100Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.100Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] Will use test ID?: true
[2025-11-15T21:37:23.101Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.101Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.101Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.102Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.102Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.102Z] Existing timestamps: 3
[2025-11-15T21:37:23.102Z] Current count after filter: 3
[2025-11-15T21:37:23.102Z] Max requests allowed: 5
[2025-11-15T21:37:23.102Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.102Z] New count: 4
[2025-11-15T21:37:23.102Z] Remaining: 1
[2025-11-15T21:37:23.102Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.102Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.186Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.186Z] Request URL: /auth/register
[2025-11-15T21:37:23.187Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.187Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.187Z] X-Test-ID header: null
[2025-11-15T21:37:23.187Z] Will use test ID?: false
[2025-11-15T21:37:23.188Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.188Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.188Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.188Z] Identifier: unknown
[2025-11-15T21:37:23.188Z] Key: register:unknown
[2025-11-15T21:37:23.188Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:37:23.188Z] Existing timestamps: 1
[2025-11-15T21:37:23.188Z] Current count after filter: 1
[2025-11-15T21:37:23.188Z] Max requests allowed: 3
[2025-11-15T21:37:23.188Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.188Z] New count: 2
[2025-11-15T21:37:23.188Z] Remaining: 1
[2025-11-15T21:37:23.188Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.188Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242697151
}
[2025-11-15T21:37:23.277Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.277Z] Request URL: /auth/login
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.277Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.277Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] Will use test ID?: true
[2025-11-15T21:37:23.277Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.277Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.277Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.278Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.278Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.278Z] Existing timestamps: 3
[2025-11-15T21:37:23.279Z] Current count after filter: 3
[2025-11-15T21:37:23.279Z] Max requests allowed: 5
[2025-11-15T21:37:23.279Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.279Z] New count: 4
[2025-11-15T21:37:23.279Z] Remaining: 1
[2025-11-15T21:37:23.279Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.279Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.351Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.351Z] Request URL: /auth/login
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.352Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.352Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Will use test ID?: true
[2025-11-15T21:37:23.352Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.352Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.352Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.352Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.352Z] Existing timestamps: 4
[2025-11-15T21:37:23.352Z] Current count after filter: 4
[2025-11-15T21:37:23.352Z] Max requests allowed: 5
[2025-11-15T21:37:23.352Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.352Z] New count: 5
[2025-11-15T21:37:23.352Z] Remaining: 0
[2025-11-15T21:37:23.352Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.353Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702349
}
[2025-11-15T21:37:23.588Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.588Z] Request URL: /auth/login
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.589Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.589Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Will use test ID?: true
[2025-11-15T21:37:23.589Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.589Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.589Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.589Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.589Z] Existing timestamps: 4
[2025-11-15T21:37:23.589Z] Current count after filter: 4
[2025-11-15T21:37:23.589Z] Max requests allowed: 5
[2025-11-15T21:37:23.590Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.590Z] New count: 5
[2025-11-15T21:37:23.590Z] Remaining: 0
[2025-11-15T21:37:23.590Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.590Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242702141
}
[2025-11-15T21:37:23.605Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.605Z] Request URL: /auth/login
[2025-11-15T21:37:23.605Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.605Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.605Z] X-Test-ID header: login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Will use test ID?: true
[2025-11-15T21:37:23.606Z] ‚úÖ Using test identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.606Z] Got identifier from getClientIdentifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.606Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.606Z] Identifier: test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] üìñ Found existing entry for key: login:test:login-retry-after-1763242642347-bmbzf
[2025-11-15T21:37:23.606Z] Existing timestamps: 5
[2025-11-15T21:37:23.606Z] Current count after filter: 5
[2025-11-15T21:37:23.606Z] Max requests allowed: 5
[2025-11-15T21:37:23.606Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.606Z] Current count: 5
[2025-11-15T21:37:23.606Z] Max allowed: 5
[2025-11-15T21:37:23.606Z] Retry after (seconds): 59
[2025-11-15T21:37:23.606Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.606Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702349,
  "retryAfter": 59
}
[2025-11-15T21:37:23.613Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.613Z] Request URL: /auth/register
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.614Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.614Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Will use test ID?: true
[2025-11-15T21:37:23.614Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.614Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.614Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.614Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] üìù Creating new entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:23.614Z] Current count after filter: 0
[2025-11-15T21:37:23.614Z] Max requests allowed: 3
[2025-11-15T21:37:23.614Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.614Z] New count: 1
[2025-11-15T21:37:23.614Z] Remaining: 2
[2025-11-15T21:37:23.614Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.614Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:23.873Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:23.873Z] Request URL: /auth/login
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.873Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.873Z] X-Test-ID header: login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] Will use test ID?: true
[2025-11-15T21:37:23.873Z] ‚úÖ Using test identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.873Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.874Z] Got identifier from getClientIdentifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.874Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:23.874Z] Identifier: test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] üìñ Found existing entry for key: login:test:login-excessive-1763242641735-u40mvv
[2025-11-15T21:37:23.874Z] Existing timestamps: 5
[2025-11-15T21:37:23.874Z] Current count after filter: 5
[2025-11-15T21:37:23.874Z] Max requests allowed: 5
[2025-11-15T21:37:23.874Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:23.874Z] Current count: 5
[2025-11-15T21:37:23.874Z] Max allowed: 5
[2025-11-15T21:37:23.874Z] Retry after (seconds): 59
[2025-11-15T21:37:23.874Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:23.874Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242702141,
  "retryAfter": 59
}
[2025-11-15T21:37:23.888Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:23.888Z] Request URL: /auth/register
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:23.889Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:23.889Z] X-Test-ID header: register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Will use test ID?: true
[2025-11-15T21:37:23.889Z] ‚úÖ Using test identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:23.889Z] Got identifier from getClientIdentifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:23.889Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:23.889Z] Identifier: test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] üìù Creating new entry for key: register:test:register-headers-1763242643887-46ll4q
[2025-11-15T21:37:23.889Z] Current count after filter: 0
[2025-11-15T21:37:23.889Z] Max requests allowed: 3
[2025-11-15T21:37:23.889Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:23.889Z] New count: 1
[2025-11-15T21:37:23.889Z] Remaining: 2
[2025-11-15T21:37:23.889Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:23.889Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242703889
}
[2025-11-15T21:37:24.030Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.031Z] Request URL: /auth/register
[2025-11-15T21:37:24.031Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.031Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.031Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.031Z] Will use test ID?: true
[2025-11-15T21:37:24.032Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.032Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.032Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.032Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.032Z] Existing timestamps: 1
[2025-11-15T21:37:24.032Z] Current count after filter: 1
[2025-11-15T21:37:24.032Z] Max requests allowed: 3
[2025-11-15T21:37:24.032Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.032Z] New count: 2
[2025-11-15T21:37:24.033Z] Remaining: 1
[2025-11-15T21:37:24.033Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.033Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.058Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.058Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.058Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.058Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] Will use test ID?: true
[2025-11-15T21:37:24.058Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.058Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.058Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.058Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.059Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] üìù Creating new entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.059Z] Current count after filter: 0
[2025-11-15T21:37:24.059Z] Max requests allowed: 5
[2025-11-15T21:37:24.059Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.059Z] New count: 1
[2025-11-15T21:37:24.059Z] Remaining: 4
[2025-11-15T21:37:24.059Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.059Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.366Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.366Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.366Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.366Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.366Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Will use test ID?: true
[2025-11-15T21:37:24.367Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.367Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.367Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.367Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.367Z] Existing timestamps: 1
[2025-11-15T21:37:24.368Z] Current count after filter: 1
[2025-11-15T21:37:24.368Z] Max requests allowed: 5
[2025-11-15T21:37:24.368Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.368Z] New count: 2
[2025-11-15T21:37:24.368Z] Remaining: 3
[2025-11-15T21:37:24.368Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.368Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.410Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.410Z] Request URL: /auth/login
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.410Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.410Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] Will use test ID?: true
[2025-11-15T21:37:24.410Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.410Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.410Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.411Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.411Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] üìù Creating new entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.411Z] Current count after filter: 0
[2025-11-15T21:37:24.411Z] Max requests allowed: 5
[2025-11-15T21:37:24.411Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.411Z] New count: 1
[2025-11-15T21:37:24.411Z] Remaining: 4
[2025-11-15T21:37:24.411Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.411Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.703Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.704Z] Request URL: /auth/login
[2025-11-15T21:37:24.705Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.706Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.706Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Will use test ID?: true
[2025-11-15T21:37:24.706Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.706Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.706Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.706Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.706Z] Existing timestamps: 1
[2025-11-15T21:37:24.706Z] Current count after filter: 1
[2025-11-15T21:37:24.706Z] Max requests allowed: 5
[2025-11-15T21:37:24.706Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.707Z] New count: 2
[2025-11-15T21:37:24.707Z] Remaining: 3
[2025-11-15T21:37:24.707Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.707Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:24.714Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.714Z] Request URL: /auth/verify-email
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.715Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.715Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Will use test ID?: true
[2025-11-15T21:37:24.715Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.715Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.715Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.715Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:24.715Z] Existing timestamps: 2
[2025-11-15T21:37:24.715Z] Current count after filter: 2
[2025-11-15T21:37:24.715Z] Max requests allowed: 5
[2025-11-15T21:37:24.715Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.715Z] New count: 3
[2025-11-15T21:37:24.715Z] Remaining: 2
[2025-11-15T21:37:24.715Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.715Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:24.743Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:24.743Z] Request URL: /auth/register
[2025-11-15T21:37:24.743Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.743Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.743Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.743Z] Will use test ID?: true
[2025-11-15T21:37:24.744Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.744Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.744Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:24.744Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:24.744Z] Existing timestamps: 2
[2025-11-15T21:37:24.744Z] Current count after filter: 2
[2025-11-15T21:37:24.744Z] Max requests allowed: 3
[2025-11-15T21:37:24.744Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.744Z] New count: 3
[2025-11-15T21:37:24.745Z] Remaining: 0
[2025-11-15T21:37:24.745Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.745Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242703614
}
[2025-11-15T21:37:24.958Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:24.958Z] Request URL: /auth/login
[2025-11-15T21:37:24.958Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:24.958Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:24.958Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Will use test ID?: true
[2025-11-15T21:37:24.959Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:24.959Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:24.959Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:24.959Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:24.959Z] Existing timestamps: 2
[2025-11-15T21:37:24.959Z] Current count after filter: 2
[2025-11-15T21:37:24.959Z] Max requests allowed: 5
[2025-11-15T21:37:24.959Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:24.959Z] New count: 3
[2025-11-15T21:37:24.959Z] Remaining: 2
[2025-11-15T21:37:24.959Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:24.959Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.005Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.005Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.005Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.005Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] Will use test ID?: true
[2025-11-15T21:37:25.005Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.005Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.005Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.005Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.006Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.006Z] Existing timestamps: 3
[2025-11-15T21:37:25.006Z] Current count after filter: 3
[2025-11-15T21:37:25.006Z] Max requests allowed: 5
[2025-11-15T21:37:25.006Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.006Z] New count: 4
[2025-11-15T21:37:25.006Z] Remaining: 1
[2025-11-15T21:37:25.006Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.006Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.124Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.124Z] Request URL: /auth/register
[2025-11-15T21:37:25.124Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.125Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.125Z] X-Test-ID header: register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Will use test ID?: true
[2025-11-15T21:37:25.125Z] ‚úÖ Using test identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.125Z] Got identifier from getClientIdentifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.125Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.125Z] Identifier: test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] üìñ Found existing entry for key: register:test:register-excessive-1763242643612-j0kx4g
[2025-11-15T21:37:25.125Z] Existing timestamps: 3
[2025-11-15T21:37:25.125Z] Current count after filter: 3
[2025-11-15T21:37:25.125Z] Max requests allowed: 3
[2025-11-15T21:37:25.125Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.125Z] Current count: 3
[2025-11-15T21:37:25.125Z] Max allowed: 3
[2025-11-15T21:37:25.125Z] Retry after (seconds): 59
[2025-11-15T21:37:25.125Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.126Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242703614,
  "retryAfter": 59
}
[2025-11-15T21:37:25.136Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.136Z] Request URL: /auth/login
[2025-11-15T21:37:25.136Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.136Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.137Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.137Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Will use test ID?: true
[2025-11-15T21:37:25.137Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.137Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.137Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.137Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] üìù Creating new entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.137Z] Current count after filter: 0
[2025-11-15T21:37:25.137Z] Max requests allowed: 5
[2025-11-15T21:37:25.137Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.137Z] New count: 1
[2025-11-15T21:37:25.137Z] Remaining: 4
[2025-11-15T21:37:25.137Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.137Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.204Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.204Z] Request URL: /auth/login
[2025-11-15T21:37:25.204Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.204Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.205Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.206Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Will use test ID?: true
[2025-11-15T21:37:25.206Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.206Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.206Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.206Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.206Z] Existing timestamps: 3
[2025-11-15T21:37:25.206Z] Current count after filter: 3
[2025-11-15T21:37:25.206Z] Max requests allowed: 5
[2025-11-15T21:37:25.206Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.206Z] New count: 4
[2025-11-15T21:37:25.206Z] Remaining: 1
[2025-11-15T21:37:25.206Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.206Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.360Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.360Z] Request URL: /auth/verify-email
[2025-11-15T21:37:25.360Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.360Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.361Z] X-Test-ID header: rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Will use test ID?: true
[2025-11-15T21:37:25.361Z] ‚úÖ Using test identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.361Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.361Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.361Z] Identifier: test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763242641460
[2025-11-15T21:37:25.361Z] Existing timestamps: 4
[2025-11-15T21:37:25.361Z] Current count after filter: 4
[2025-11-15T21:37:25.361Z] Max requests allowed: 5
[2025-11-15T21:37:25.361Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.361Z] New count: 5
[2025-11-15T21:37:25.361Z] Remaining: 0
[2025-11-15T21:37:25.362Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.362Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704058
}
[2025-11-15T21:37:25.367Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.368Z] Request URL: /auth/login
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.368Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.368Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Will use test ID?: true
[2025-11-15T21:37:25.368Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.368Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.368Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.368Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.368Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.369Z] Existing timestamps: 1
[2025-11-15T21:37:25.369Z] Current count after filter: 1
[2025-11-15T21:37:25.369Z] Max requests allowed: 5
[2025-11-15T21:37:25.369Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.369Z] New count: 2
[2025-11-15T21:37:25.369Z] Remaining: 3
[2025-11-15T21:37:25.369Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.369Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.432Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.433Z] Request URL: /auth/login
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.433Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.433Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] Will use test ID?: true
[2025-11-15T21:37:25.433Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.433Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.433Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.434Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.434Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.434Z] Existing timestamps: 4
[2025-11-15T21:37:25.434Z] Current count after filter: 4
[2025-11-15T21:37:25.434Z] Max requests allowed: 5
[2025-11-15T21:37:25.434Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.434Z] New count: 5
[2025-11-15T21:37:25.435Z] Remaining: 0
[2025-11-15T21:37:25.435Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.435Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763242704410
}
[2025-11-15T21:37:25.618Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.618Z] Request URL: /auth/login
[2025-11-15T21:37:25.618Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.618Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.619Z] X-Test-ID header: headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Will use test ID?: true
[2025-11-15T21:37:25.619Z] ‚úÖ Using test identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.619Z] Got identifier from getClientIdentifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.619Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.619Z] Identifier: test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] üìñ Found existing entry for key: login:test:headers-remaining-1763242645135-7xpnc
[2025-11-15T21:37:25.619Z] Existing timestamps: 2
[2025-11-15T21:37:25.619Z] Current count after filter: 2
[2025-11-15T21:37:25.619Z] Max requests allowed: 5
[2025-11-15T21:37:25.619Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.620Z] New count: 3
[2025-11-15T21:37:25.620Z] Remaining: 2
[2025-11-15T21:37:25.620Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.620Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705137
}
[2025-11-15T21:37:25.699Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.699Z] Request URL: /auth/login
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.699Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.699Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Will use test ID?: true
[2025-11-15T21:37:25.699Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.699Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.699Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.699Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.699Z] Existing timestamps: 5
[2025-11-15T21:37:25.699Z] Current count after filter: 5
[2025-11-15T21:37:25.699Z] Max requests allowed: 5
[2025-11-15T21:37:25.699Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:37:25.700Z] Current count: 5
[2025-11-15T21:37:25.700Z] Max allowed: 5
[2025-11-15T21:37:25.700Z] Retry after (seconds): 59
[2025-11-15T21:37:25.700Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:37:25.700Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763242704410,
  "retryAfter": 59
}
[2025-11-15T21:37:25.701Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:37:25.701Z] Request URL: /auth/register
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.701Z] X-Test-ID header: independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Will use test ID?: true
[2025-11-15T21:37:25.701Z] ‚úÖ Using test identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.701Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.701Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:37:25.701Z] Identifier: test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] üìù Creating new entry for key: register:test:independent-endpoints-1763242644408-i9fqjl
[2025-11-15T21:37:25.701Z] Current count after filter: 0
[2025-11-15T21:37:25.701Z] Max requests allowed: 3
[2025-11-15T21:37:25.701Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.701Z] New count: 1
[2025-11-15T21:37:25.701Z] Remaining: 2
[2025-11-15T21:37:25.701Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.701Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763242705701
}
[2025-11-15T21:37:25.885Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:25.885Z] Request URL: /auth/login
[2025-11-15T21:37:25.885Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:25.885Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:25.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:25.886Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Will use test ID?: true
[2025-11-15T21:37:25.886Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:25.886Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:25.886Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:25.886Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] üìù Creating new entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:25.886Z] Current count after filter: 0
[2025-11-15T21:37:25.886Z] Max requests allowed: 5
[2025-11-15T21:37:25.886Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:25.886Z] New count: 1
[2025-11-15T21:37:25.887Z] Remaining: 4
[2025-11-15T21:37:25.887Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:25.887Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.127Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.127Z] Request URL: /auth/login
[2025-11-15T21:37:26.127Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.127Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.128Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.128Z] X-Test-ID header: headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Will use test ID?: true
[2025-11-15T21:37:26.128Z] ‚úÖ Using test identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.128Z] Got identifier from getClientIdentifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.128Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.128Z] Identifier: test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] üìñ Found existing entry for key: login:test:headers-consistent-1763242645880-jsndmp
[2025-11-15T21:37:26.128Z] Existing timestamps: 1
[2025-11-15T21:37:26.128Z] Current count after filter: 1
[2025-11-15T21:37:26.128Z] Max requests allowed: 5
[2025-11-15T21:37:26.128Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.128Z] New count: 2
[2025-11-15T21:37:26.129Z] Remaining: 3
[2025-11-15T21:37:26.129Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.129Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763242705886
}
[2025-11-15T21:37:26.133Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:37:26.133Z] Request URL: /auth/login
[2025-11-15T21:37:26.133Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:37:26.133Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (env): true
[2025-11-15T21:37:26.134Z] E2E_TEST_MODE (final): true
[2025-11-15T21:37:26.134Z] X-Test-ID header: perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Will use test ID?: true
[2025-11-15T21:37:26.134Z] ‚úÖ Using test identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:37:26.134Z] Got identifier from getClientIdentifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:37:26.134Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:37:26.134Z] Identifier: test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] üìù Creating new entry for key: login:test:perf-test-1763242646132-zi14a
[2025-11-15T21:37:26.134Z] Current count after filter: 0
[2025-11-15T21:37:26.134Z] Max requests allowed: 5
[2025-11-15T21:37:26.134Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:37:26.134Z] New count: 1
[2025-11-15T21:37:26.134Z] Remaining: 4
[2025-11-15T21:37:26.134Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:37:26.134Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763242706134
}
[2025-11-15T21:59:17.477Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.508Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.509Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] üìù Creating new entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.509Z] Current count after filter: 0
[2025-11-15T21:59:17.510Z] Max requests allowed: 5
[2025-11-15T21:59:17.510Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.510Z] New count: 1
[2025-11-15T21:59:17.510Z] Remaining: 4
[2025-11-15T21:59:17.510Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 1
[2025-11-15T21:59:17.511Z] Current count after filter: 1
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 2
[2025-11-15T21:59:17.511Z] Remaining: 3
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Existing timestamps: 2
[2025-11-15T21:59:17.511Z] Current count after filter: 2
[2025-11-15T21:59:17.511Z] Max requests allowed: 5
[2025-11-15T21:59:17.511Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.511Z] New count: 3
[2025-11-15T21:59:17.511Z] Remaining: 2
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.511Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.511Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.511Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.511Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.512Z] Existing timestamps: 3
[2025-11-15T21:59:17.512Z] Current count after filter: 3
[2025-11-15T21:59:17.512Z] Max requests allowed: 5
[2025-11-15T21:59:17.512Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.512Z] New count: 4
[2025-11-15T21:59:17.512Z] Remaining: 1
[2025-11-15T21:59:17.512Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.513Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.513Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.513Z] Identifier: test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] üìñ Found existing entry for key: login:test-allow-1763243957477
[2025-11-15T21:59:17.513Z] Existing timestamps: 4
[2025-11-15T21:59:17.513Z] Current count after filter: 4
[2025-11-15T21:59:17.513Z] Max requests allowed: 5
[2025-11-15T21:59:17.513Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.513Z] New count: 5
[2025-11-15T21:59:17.514Z] Remaining: 0
[2025-11-15T21:59:17.514Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.516Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.516Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.516Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.516Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] üìù Creating new entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.516Z] Current count after filter: 0
[2025-11-15T21:59:17.517Z] Max requests allowed: 5
[2025-11-15T21:59:17.517Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.517Z] New count: 1
[2025-11-15T21:59:17.517Z] Remaining: 4
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.517Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.517Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.517Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.517Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.518Z] Existing timestamps: 1
[2025-11-15T21:59:17.518Z] Current count after filter: 1
[2025-11-15T21:59:17.518Z] Max requests allowed: 5
[2025-11-15T21:59:17.518Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.518Z] New count: 2
[2025-11-15T21:59:17.519Z] Remaining: 3
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.519Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.519Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.519Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 2
[2025-11-15T21:59:17.520Z] Current count after filter: 2
[2025-11-15T21:59:17.520Z] Max requests allowed: 5
[2025-11-15T21:59:17.520Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.520Z] New count: 3
[2025-11-15T21:59:17.520Z] Remaining: 2
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.520Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.520Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.520Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.520Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.520Z] Existing timestamps: 3
[2025-11-15T21:59:17.521Z] Current count after filter: 3
[2025-11-15T21:59:17.521Z] Max requests allowed: 5
[2025-11-15T21:59:17.521Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.521Z] New count: 4
[2025-11-15T21:59:17.521Z] Remaining: 1
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.521Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.521Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.521Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.521Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.521Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 4
[2025-11-15T21:59:17.522Z] Current count after filter: 4
[2025-11-15T21:59:17.522Z] Max requests allowed: 5
[2025-11-15T21:59:17.522Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.522Z] New count: 5
[2025-11-15T21:59:17.522Z] Remaining: 0
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.522Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.522Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.522Z] Identifier: test-block-1763243957516
[2025-11-15T21:59:17.522Z] Key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] üìñ Found existing entry for key: login:test-block-1763243957516
[2025-11-15T21:59:17.522Z] Existing timestamps: 5
[2025-11-15T21:59:17.522Z] Current count after filter: 5
[2025-11-15T21:59:17.523Z] Max requests allowed: 5
[2025-11-15T21:59:17.523Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.523Z] Current count: 5
[2025-11-15T21:59:17.523Z] Max allowed: 5
[2025-11-15T21:59:17.523Z] Retry after (seconds): 60
[2025-11-15T21:59:17.523Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.525Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.525Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.525Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] üìù Creating new entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.525Z] Current count after filter: 0
[2025-11-15T21:59:17.525Z] Max requests allowed: 2
[2025-11-15T21:59:17.525Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.525Z] New count: 1
[2025-11-15T21:59:17.525Z] Remaining: 1
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.526Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.526Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.526Z] Existing timestamps: 1
[2025-11-15T21:59:17.526Z] Current count after filter: 1
[2025-11-15T21:59:17.526Z] Max requests allowed: 2
[2025-11-15T21:59:17.526Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.526Z] New count: 2
[2025-11-15T21:59:17.526Z] Remaining: 0
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.526Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.527Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.527Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.527Z] Existing timestamps: 2
[2025-11-15T21:59:17.527Z] Current count after filter: 2
[2025-11-15T21:59:17.527Z] Max requests allowed: 2
[2025-11-15T21:59:17.528Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.528Z] Current count: 2
[2025-11-15T21:59:17.528Z] Max allowed: 2
[2025-11-15T21:59:17.528Z] Retry after (seconds): 1
[2025-11-15T21:59:17.528Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.678Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.679Z] Config: {
  "keyPrefix": "test-reset",
  "maxRequests": 2,
  "windowMs": 100
}
[2025-11-15T21:59:17.679Z] Identifier: test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] üìñ Found existing entry for key: test-reset:test-reset-1763243957525
[2025-11-15T21:59:17.679Z] Existing timestamps: 2
[2025-11-15T21:59:17.679Z] üßπ Filtered old timestamps: 2 ‚Üí 0
[2025-11-15T21:59:17.679Z] Current count after filter: 0
[2025-11-15T21:59:17.679Z] Max requests allowed: 2
[2025-11-15T21:59:17.679Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.679Z] New count: 1
[2025-11-15T21:59:17.679Z] Remaining: 1
[2025-11-15T21:59:17.679Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìù Creating new entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Current count after filter: 0
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.681Z] New count: 1
[2025-11-15T21:59:17.681Z] Remaining: 4
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.681Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.681Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.681Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.681Z] Existing timestamps: 1
[2025-11-15T21:59:17.681Z] Current count after filter: 1
[2025-11-15T21:59:17.681Z] Max requests allowed: 5
[2025-11-15T21:59:17.681Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.682Z] New count: 2
[2025-11-15T21:59:17.682Z] Remaining: 3
[2025-11-15T21:59:17.682Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.683Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.683Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.683Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.683Z] Existing timestamps: 2
[2025-11-15T21:59:17.683Z] Current count after filter: 2
[2025-11-15T21:59:17.683Z] Max requests allowed: 5
[2025-11-15T21:59:17.683Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.683Z] New count: 3
[2025-11-15T21:59:17.683Z] Remaining: 2
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.684Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.684Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.684Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.684Z] Existing timestamps: 3
[2025-11-15T21:59:17.684Z] Current count after filter: 3
[2025-11-15T21:59:17.684Z] Max requests allowed: 5
[2025-11-15T21:59:17.684Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.684Z] New count: 4
[2025-11-15T21:59:17.685Z] Remaining: 1
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.685Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.685Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.685Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.685Z] Existing timestamps: 4
[2025-11-15T21:59:17.685Z] Current count after filter: 4
[2025-11-15T21:59:17.685Z] Max requests allowed: 5
[2025-11-15T21:59:17.685Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.685Z] New count: 5
[2025-11-15T21:59:17.686Z] Remaining: 0
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] üìñ Found existing entry for key: login:test-multi-1-1763243957681
[2025-11-15T21:59:17.686Z] Existing timestamps: 5
[2025-11-15T21:59:17.686Z] Current count after filter: 5
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.686Z] Current count: 5
[2025-11-15T21:59:17.686Z] Max allowed: 5
[2025-11-15T21:59:17.686Z] Retry after (seconds): 60
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:17.686Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.686Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.686Z] Identifier: test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] üìù Creating new entry for key: login:test-multi-2-1763243957681
[2025-11-15T21:59:17.686Z] Current count after filter: 0
[2025-11-15T21:59:17.686Z] Max requests allowed: 5
[2025-11-15T21:59:17.686Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.687Z] New count: 1
[2025-11-15T21:59:17.687Z] Remaining: 4
[2025-11-15T21:59:17.687Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.688Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.688Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:17.688Z] Identifier: test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] üìù Creating new entry for key: login:test-reset-time-1763243957688
[2025-11-15T21:59:17.688Z] Current count after filter: 0
[2025-11-15T21:59:17.688Z] Max requests allowed: 5
[2025-11-15T21:59:17.689Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.690Z] New count: 1
[2025-11-15T21:59:17.690Z] Remaining: 4
[2025-11-15T21:59:17.690Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.692Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.692Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.693Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.693Z] X-Test-ID header: null
[2025-11-15T21:59:17.693Z] Will use test ID?: false
[2025-11-15T21:59:17.693Z] Using real IP: 192.168.1.2
[2025-11-15T21:59:17.693Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.701Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.701Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.701Z] X-Test-ID header: null
[2025-11-15T21:59:17.701Z] Will use test ID?: false
[2025-11-15T21:59:17.701Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.702Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.702Z] X-Test-ID header: null
[2025-11-15T21:59:17.702Z] Will use test ID?: false
[2025-11-15T21:59:17.702Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:17.702Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (process.env): undefined
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:17.703Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:17.703Z] X-Test-ID header: null
[2025-11-15T21:59:17.703Z] Will use test ID?: false
[2025-11-15T21:59:17.703Z] Using forwarded IP: 192.168.1.1
[2025-11-15T21:59:17.703Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:17.703Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.703Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.703Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] üìù Creating new entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.703Z] Current count after filter: 0
[2025-11-15T21:59:17.703Z] Max requests allowed: 3
[2025-11-15T21:59:17.703Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.703Z] New count: 1
[2025-11-15T21:59:17.704Z] Remaining: 2
[2025-11-15T21:59:17.704Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.810Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.811Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.812Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.812Z] Existing timestamps: 1
[2025-11-15T21:59:17.812Z] Current count after filter: 1
[2025-11-15T21:59:17.812Z] Max requests allowed: 3
[2025-11-15T21:59:17.812Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.812Z] New count: 2
[2025-11-15T21:59:17.812Z] Remaining: 1
[2025-11-15T21:59:17.812Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.916Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.916Z] Config: {
  "keyPrefix": "test-sliding",
  "maxRequests": 3,
  "windowMs": 200
}
[2025-11-15T21:59:17.916Z] Identifier: test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] üìñ Found existing entry for key: test-sliding:test-sliding-1763243957703
[2025-11-15T21:59:17.916Z] Existing timestamps: 2
[2025-11-15T21:59:17.916Z] üßπ Filtered old timestamps: 2 ‚Üí 1
[2025-11-15T21:59:17.917Z] Current count after filter: 1
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 2
[2025-11-15T21:59:17.917Z] Remaining: 1
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.917Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.917Z] Identifier: test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] üìù Creating new entry for key: register:test-format-allowed-1763243957917
[2025-11-15T21:59:17.917Z] Current count after filter: 0
[2025-11-15T21:59:17.917Z] Max requests allowed: 3
[2025-11-15T21:59:17.917Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.917Z] New count: 1
[2025-11-15T21:59:17.917Z] Remaining: 2
[2025-11-15T21:59:17.917Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìù Creating new entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Current count after filter: 0
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 1
[2025-11-15T21:59:17.918Z] Remaining: 2
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.918Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.918Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.918Z] Existing timestamps: 1
[2025-11-15T21:59:17.918Z] Current count after filter: 1
[2025-11-15T21:59:17.918Z] Max requests allowed: 3
[2025-11-15T21:59:17.918Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.918Z] New count: 2
[2025-11-15T21:59:17.918Z] Remaining: 1
[2025-11-15T21:59:17.918Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.919Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.919Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.919Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.919Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.920Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.921Z] Existing timestamps: 2
[2025-11-15T21:59:17.921Z] Current count after filter: 2
[2025-11-15T21:59:17.921Z] Max requests allowed: 3
[2025-11-15T21:59:17.921Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:17.921Z] New count: 3
[2025-11-15T21:59:17.921Z] Remaining: 0
[2025-11-15T21:59:17.921Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:17.922Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:17.922Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:17.922Z] Identifier: test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] üìñ Found existing entry for key: register:test-format-blocked-1763243957918
[2025-11-15T21:59:17.922Z] Existing timestamps: 3
[2025-11-15T21:59:17.922Z] Current count after filter: 3
[2025-11-15T21:59:17.922Z] Max requests allowed: 3
[2025-11-15T21:59:17.922Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:17.922Z] Current count: 3
[2025-11-15T21:59:17.922Z] Max allowed: 3
[2025-11-15T21:59:17.922Z] Retry after (seconds): 60
[2025-11-15T21:59:17.923Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:26.447Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:26.447Z] Request URL: /auth/token
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:26.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:26.448Z] X-Test-ID header: null
[2025-11-15T21:59:26.448Z] Will use test ID?: false
[2025-11-15T21:59:26.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:26.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:26.448Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:26.448Z] Identifier: unknown
[2025-11-15T21:59:26.448Z] Key: token:unknown
[2025-11-15T21:59:26.448Z] üìù Creating new entry for key: token:unknown
[2025-11-15T21:59:26.448Z] Current count after filter: 0
[2025-11-15T21:59:26.448Z] Max requests allowed: 60
[2025-11-15T21:59:26.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:26.448Z] New count: 1
[2025-11-15T21:59:26.448Z] Remaining: 59
[2025-11-15T21:59:26.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:26.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 59,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.104Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.104Z] Request URL: /auth/token
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.105Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.105Z] X-Test-ID header: null
[2025-11-15T21:59:27.105Z] Will use test ID?: false
[2025-11-15T21:59:27.105Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.105Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.105Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.105Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.105Z] Identifier: unknown
[2025-11-15T21:59:27.105Z] Key: token:unknown
[2025-11-15T21:59:27.105Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.105Z] Existing timestamps: 1
[2025-11-15T21:59:27.105Z] Current count after filter: 1
[2025-11-15T21:59:27.106Z] Max requests allowed: 60
[2025-11-15T21:59:27.106Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.106Z] New count: 2
[2025-11-15T21:59:27.106Z] Remaining: 58
[2025-11-15T21:59:27.106Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.106Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 58,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:27.981Z] üîí withRateLimit CALLED for endpoint: token
[2025-11-15T21:59:27.982Z] Request URL: /auth/token
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:27.982Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:27.982Z] X-Test-ID header: null
[2025-11-15T21:59:27.982Z] Will use test ID?: false
[2025-11-15T21:59:27.982Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:27.982Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:27.982Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:27.982Z] Config: {
  "keyPrefix": "token",
  "maxRequests": 60,
  "windowMs": 60000
}
[2025-11-15T21:59:27.983Z] Identifier: unknown
[2025-11-15T21:59:27.983Z] Key: token:unknown
[2025-11-15T21:59:27.983Z] üìñ Found existing entry for key: token:unknown
[2025-11-15T21:59:27.983Z] Existing timestamps: 2
[2025-11-15T21:59:27.983Z] Current count after filter: 2
[2025-11-15T21:59:27.983Z] Max requests allowed: 60
[2025-11-15T21:59:27.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:27.983Z] New count: 3
[2025-11-15T21:59:27.983Z] Remaining: 57
[2025-11-15T21:59:27.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:27.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 57,
  "resetAt": 1763244026448
}
[2025-11-15T21:59:28.448Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.448Z] Request URL: /auth/reset-password
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.448Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.448Z] X-Test-ID header: null
[2025-11-15T21:59:28.448Z] Will use test ID?: false
[2025-11-15T21:59:28.448Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.448Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.448Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.448Z] Identifier: unknown
[2025-11-15T21:59:28.448Z] Key: login:unknown
[2025-11-15T21:59:28.448Z] üìù Creating new entry for key: login:unknown
[2025-11-15T21:59:28.448Z] Current count after filter: 0
[2025-11-15T21:59:28.448Z] Max requests allowed: 5
[2025-11-15T21:59:28.448Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.448Z] New count: 1
[2025-11-15T21:59:28.448Z] Remaining: 4
[2025-11-15T21:59:28.448Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.448Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.463Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.463Z] Request URL: /auth/forgot-password
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.463Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.463Z] X-Test-ID header: null
[2025-11-15T21:59:28.463Z] Will use test ID?: false
[2025-11-15T21:59:28.463Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.463Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.463Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.463Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.463Z] Identifier: unknown
[2025-11-15T21:59:28.463Z] Key: login:unknown
[2025-11-15T21:59:28.463Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:28.463Z] Existing timestamps: 1
[2025-11-15T21:59:28.463Z] Current count after filter: 1
[2025-11-15T21:59:28.463Z] Max requests allowed: 5
[2025-11-15T21:59:28.464Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.464Z] New count: 2
[2025-11-15T21:59:28.464Z] Remaining: 3
[2025-11-15T21:59:28.464Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.464Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:28.498Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.498Z] Request URL: /auth/register
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.498Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.498Z] X-Test-ID header: null
[2025-11-15T21:59:28.498Z] Will use test ID?: false
[2025-11-15T21:59:28.498Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.498Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:28.498Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.498Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.498Z] Identifier: unknown
[2025-11-15T21:59:28.498Z] Key: register:unknown
[2025-11-15T21:59:28.498Z] üìù Creating new entry for key: register:unknown
[2025-11-15T21:59:28.498Z] Current count after filter: 0
[2025-11-15T21:59:28.498Z] Max requests allowed: 3
[2025-11-15T21:59:28.498Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.499Z] New count: 1
[2025-11-15T21:59:28.499Z] Remaining: 2
[2025-11-15T21:59:28.499Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.499Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:28.932Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:28.932Z] Request URL: /auth/register
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.932Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.932Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Will use test ID?: true
[2025-11-15T21:59:28.932Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.932Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.932Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:28.932Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.932Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] üìù Creating new entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:28.933Z] Current count after filter: 0
[2025-11-15T21:59:28.933Z] Max requests allowed: 3
[2025-11-15T21:59:28.933Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.933Z] New count: 1
[2025-11-15T21:59:28.933Z] Remaining: 2
[2025-11-15T21:59:28.933Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.933Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:28.982Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:28.982Z] Request URL: /auth/login
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:28.983Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:28.983Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Will use test ID?: true
[2025-11-15T21:59:28.983Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:28.983Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:28.983Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:28.983Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] üìù Creating new entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:28.983Z] Current count after filter: 0
[2025-11-15T21:59:28.983Z] Max requests allowed: 5
[2025-11-15T21:59:28.983Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:28.983Z] New count: 1
[2025-11-15T21:59:28.983Z] Remaining: 4
[2025-11-15T21:59:28.983Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:28.983Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.176Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.176Z] Request URL: /auth/login
[2025-11-15T21:59:29.176Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.176Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.176Z] X-Test-ID header: login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Will use test ID?: true
[2025-11-15T21:59:29.177Z] ‚úÖ Using test identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.177Z] Got identifier from getClientIdentifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.177Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.177Z] Identifier: test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] üìù Creating new entry for key: login:test:login-headers-1763243968866-6sa9sk
[2025-11-15T21:59:29.177Z] Current count after filter: 0
[2025-11-15T21:59:29.177Z] Max requests allowed: 5
[2025-11-15T21:59:29.177Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.177Z] New count: 1
[2025-11-15T21:59:29.177Z] Remaining: 4
[2025-11-15T21:59:29.177Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.177Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029177
}
[2025-11-15T21:59:29.179Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.179Z] Request URL: /auth/login
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.179Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.179Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Will use test ID?: true
[2025-11-15T21:59:29.179Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.179Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.179Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.179Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] üìù Creating new entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.179Z] Current count after filter: 0
[2025-11-15T21:59:29.179Z] Max requests allowed: 5
[2025-11-15T21:59:29.179Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.179Z] New count: 1
[2025-11-15T21:59:29.179Z] Remaining: 4
[2025-11-15T21:59:29.180Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.180Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.302Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.302Z] Request URL: /auth/login
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.302Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.302Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] Will use test ID?: true
[2025-11-15T21:59:29.302Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.302Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.302Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.302Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.303Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.303Z] Existing timestamps: 1
[2025-11-15T21:59:29.303Z] Current count after filter: 1
[2025-11-15T21:59:29.303Z] Max requests allowed: 5
[2025-11-15T21:59:29.303Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.303Z] New count: 2
[2025-11-15T21:59:29.303Z] Remaining: 3
[2025-11-15T21:59:29.303Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.303Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.470Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.471Z] Request URL: /auth/register
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.471Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.471Z] X-Test-ID header: register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Will use test ID?: true
[2025-11-15T21:59:29.471Z] ‚úÖ Using test identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.471Z] Got identifier from getClientIdentifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.471Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.471Z] Identifier: test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.471Z] Key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] üìù Creating new entry for key: register:test:register-headers-1763243969469-fzf7ct
[2025-11-15T21:59:29.472Z] Current count after filter: 0
[2025-11-15T21:59:29.472Z] Max requests allowed: 3
[2025-11-15T21:59:29.472Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.472Z] New count: 1
[2025-11-15T21:59:29.472Z] Remaining: 2
[2025-11-15T21:59:29.472Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.472Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029471
}
[2025-11-15T21:59:29.552Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.552Z] Request URL: /auth/register
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.552Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.552Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] Will use test ID?: true
[2025-11-15T21:59:29.552Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.552Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.553Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.553Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.553Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.553Z] Existing timestamps: 1
[2025-11-15T21:59:29.553Z] Current count after filter: 1
[2025-11-15T21:59:29.553Z] Max requests allowed: 3
[2025-11-15T21:59:29.553Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.553Z] New count: 2
[2025-11-15T21:59:29.553Z] Remaining: 1
[2025-11-15T21:59:29.553Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.553Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.590Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.590Z] Request URL: /auth/login
[2025-11-15T21:59:29.590Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.591Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.591Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Will use test ID?: true
[2025-11-15T21:59:29.591Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.591Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.591Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.591Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.591Z] Existing timestamps: 1
[2025-11-15T21:59:29.592Z] Current count after filter: 1
[2025-11-15T21:59:29.592Z] Max requests allowed: 5
[2025-11-15T21:59:29.592Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.592Z] New count: 2
[2025-11-15T21:59:29.592Z] Remaining: 3
[2025-11-15T21:59:29.592Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.592Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.606Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.606Z] Request URL: /auth/login
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.606Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.606Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] Will use test ID?: true
[2025-11-15T21:59:29.606Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.606Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.607Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.607Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.607Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:29.607Z] Existing timestamps: 2
[2025-11-15T21:59:29.607Z] Current count after filter: 2
[2025-11-15T21:59:29.607Z] Max requests allowed: 5
[2025-11-15T21:59:29.607Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.607Z] New count: 3
[2025-11-15T21:59:29.607Z] Remaining: 2
[2025-11-15T21:59:29.607Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.607Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:29.850Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.850Z] Request URL: /auth/verify-email
[2025-11-15T21:59:29.850Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.850Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.850Z] X-Test-ID header: null
[2025-11-15T21:59:29.850Z] Will use test ID?: false
[2025-11-15T21:59:29.851Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.851Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:29.851Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.851Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.851Z] Identifier: unknown
[2025-11-15T21:59:29.851Z] Key: login:unknown
[2025-11-15T21:59:29.852Z] üìñ Found existing entry for key: login:unknown
[2025-11-15T21:59:29.852Z] Existing timestamps: 2
[2025-11-15T21:59:29.852Z] Current count after filter: 2
[2025-11-15T21:59:29.852Z] Max requests allowed: 5
[2025-11-15T21:59:29.852Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.852Z] New count: 3
[2025-11-15T21:59:29.852Z] Remaining: 2
[2025-11-15T21:59:29.852Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.852Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244028448
}
[2025-11-15T21:59:29.857Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.857Z] Request URL: /auth/login
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.858Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.858Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Will use test ID?: true
[2025-11-15T21:59:29.858Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.858Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.858Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.858Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:29.858Z] Existing timestamps: 2
[2025-11-15T21:59:29.859Z] Current count after filter: 2
[2025-11-15T21:59:29.859Z] Max requests allowed: 5
[2025-11-15T21:59:29.859Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.859Z] New count: 3
[2025-11-15T21:59:29.859Z] Remaining: 2
[2025-11-15T21:59:29.859Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.859Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:29.886Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:29.886Z] Request URL: /auth/register
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.886Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.886Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] Will use test ID?: true
[2025-11-15T21:59:29.886Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.886Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.886Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.886Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:29.887Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:29.887Z] Existing timestamps: 2
[2025-11-15T21:59:29.887Z] Current count after filter: 2
[2025-11-15T21:59:29.887Z] Max requests allowed: 3
[2025-11-15T21:59:29.887Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.887Z] New count: 3
[2025-11-15T21:59:29.888Z] Remaining: 0
[2025-11-15T21:59:29.888Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.888Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028932
}
[2025-11-15T21:59:29.941Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:29.941Z] Request URL: /auth/login
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:29.942Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:29.942Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] Will use test ID?: true
[2025-11-15T21:59:29.942Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.942Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:29.943Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:29.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:29.943Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] üìù Creating new entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:29.943Z] Current count after filter: 0
[2025-11-15T21:59:29.943Z] Max requests allowed: 5
[2025-11-15T21:59:29.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:29.943Z] New count: 1
[2025-11-15T21:59:29.943Z] Remaining: 4
[2025-11-15T21:59:29.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:29.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.081Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.081Z] Request URL: /auth/login
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.081Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.081Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] Will use test ID?: true
[2025-11-15T21:59:30.081Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.081Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.081Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.082Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.082Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.082Z] Existing timestamps: 3
[2025-11-15T21:59:30.082Z] Current count after filter: 3
[2025-11-15T21:59:30.082Z] Max requests allowed: 5
[2025-11-15T21:59:30.082Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.082Z] New count: 4
[2025-11-15T21:59:30.082Z] Remaining: 1
[2025-11-15T21:59:30.082Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.082Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.108Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.108Z] Request URL: /auth/login
[2025-11-15T21:59:30.108Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.108Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.109Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.109Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Will use test ID?: true
[2025-11-15T21:59:30.109Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.109Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.109Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.109Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.109Z] Existing timestamps: 3
[2025-11-15T21:59:30.109Z] Current count after filter: 3
[2025-11-15T21:59:30.109Z] Max requests allowed: 5
[2025-11-15T21:59:30.109Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.109Z] New count: 4
[2025-11-15T21:59:30.109Z] Remaining: 1
[2025-11-15T21:59:30.109Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.109Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.180Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.180Z] Request URL: /auth/login
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.181Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.181Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Will use test ID?: true
[2025-11-15T21:59:30.181Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.181Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.181Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.181Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.181Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.182Z] Existing timestamps: 1
[2025-11-15T21:59:30.182Z] Current count after filter: 1
[2025-11-15T21:59:30.182Z] Max requests allowed: 5
[2025-11-15T21:59:30.182Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.182Z] New count: 2
[2025-11-15T21:59:30.182Z] Remaining: 3
[2025-11-15T21:59:30.182Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.182Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.267Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:30.267Z] Request URL: /auth/register
[2025-11-15T21:59:30.267Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.268Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.268Z] X-Test-ID header: register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] Will use test ID?: true
[2025-11-15T21:59:30.268Z] ‚úÖ Using test identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.268Z] Got identifier from getClientIdentifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.268Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.269Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:30.269Z] Identifier: test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] üìñ Found existing entry for key: register:test:register-excessive-1763243968930-wug52
[2025-11-15T21:59:30.269Z] Existing timestamps: 3
[2025-11-15T21:59:30.269Z] Current count after filter: 3
[2025-11-15T21:59:30.269Z] Max requests allowed: 3
[2025-11-15T21:59:30.269Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.269Z] Current count: 3
[2025-11-15T21:59:30.269Z] Max allowed: 3
[2025-11-15T21:59:30.269Z] Retry after (seconds): 59
[2025-11-15T21:59:30.270Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.270Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028932,
  "retryAfter": 59
}
[2025-11-15T21:59:30.283Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.283Z] Request URL: /auth/login
[2025-11-15T21:59:30.283Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.283Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.283Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.283Z] Will use test ID?: true
[2025-11-15T21:59:30.283Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.284Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.284Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.284Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] üìù Creating new entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.284Z] Current count after filter: 0
[2025-11-15T21:59:30.284Z] Max requests allowed: 5
[2025-11-15T21:59:30.284Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.284Z] New count: 1
[2025-11-15T21:59:30.284Z] Remaining: 4
[2025-11-15T21:59:30.284Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.284Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.340Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.340Z] Request URL: /auth/login
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.340Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.340Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] Will use test ID?: true
[2025-11-15T21:59:30.340Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.340Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.340Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.340Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.341Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.341Z] Existing timestamps: 4
[2025-11-15T21:59:30.341Z] Current count after filter: 4
[2025-11-15T21:59:30.341Z] Max requests allowed: 5
[2025-11-15T21:59:30.341Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.341Z] New count: 5
[2025-11-15T21:59:30.341Z] Remaining: 0
[2025-11-15T21:59:30.341Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.341Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029179
}
[2025-11-15T21:59:30.375Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.375Z] Request URL: /auth/login
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.375Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.375Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] Will use test ID?: true
[2025-11-15T21:59:30.375Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.375Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.375Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.375Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.375Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.376Z] Existing timestamps: 4
[2025-11-15T21:59:30.376Z] Current count after filter: 4
[2025-11-15T21:59:30.376Z] Max requests allowed: 5
[2025-11-15T21:59:30.376Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.376Z] New count: 5
[2025-11-15T21:59:30.376Z] Remaining: 0
[2025-11-15T21:59:30.376Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.376Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244028983
}
[2025-11-15T21:59:30.408Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.408Z] Request URL: /auth/login
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.408Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.408Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] Will use test ID?: true
[2025-11-15T21:59:30.408Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.408Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.408Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.408Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.409Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.409Z] Existing timestamps: 2
[2025-11-15T21:59:30.409Z] Current count after filter: 2
[2025-11-15T21:59:30.409Z] Max requests allowed: 5
[2025-11-15T21:59:30.409Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.409Z] New count: 3
[2025-11-15T21:59:30.409Z] Remaining: 2
[2025-11-15T21:59:30.409Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.409Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.601Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.601Z] Request URL: /auth/login
[2025-11-15T21:59:30.601Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.601Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.601Z] X-Test-ID header: login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.601Z] Will use test ID?: true
[2025-11-15T21:59:30.601Z] ‚úÖ Using test identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.602Z] Got identifier from getClientIdentifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.602Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.602Z] Identifier: test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] üìñ Found existing entry for key: login:test:login-retry-after-1763243968867-zonce
[2025-11-15T21:59:30.602Z] Existing timestamps: 5
[2025-11-15T21:59:30.602Z] Current count after filter: 5
[2025-11-15T21:59:30.602Z] Max requests allowed: 5
[2025-11-15T21:59:30.602Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.602Z] Current count: 5
[2025-11-15T21:59:30.602Z] Max allowed: 5
[2025-11-15T21:59:30.602Z] Retry after (seconds): 59
[2025-11-15T21:59:30.602Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.602Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029179,
  "retryAfter": 59
}
[2025-11-15T21:59:30.612Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.612Z] Request URL: /auth/login
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.612Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.612Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Will use test ID?: true
[2025-11-15T21:59:30.612Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.612Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.612Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.612Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] üìù Creating new entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.612Z] Current count after filter: 0
[2025-11-15T21:59:30.612Z] Max requests allowed: 5
[2025-11-15T21:59:30.612Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.612Z] New count: 1
[2025-11-15T21:59:30.612Z] Remaining: 4
[2025-11-15T21:59:30.612Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.613Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.649Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.649Z] Request URL: /auth/login
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.649Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.649Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Will use test ID?: true
[2025-11-15T21:59:30.649Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.649Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.649Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.649Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.649Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.650Z] Existing timestamps: 3
[2025-11-15T21:59:30.650Z] Current count after filter: 3
[2025-11-15T21:59:30.650Z] Max requests allowed: 5
[2025-11-15T21:59:30.650Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.650Z] New count: 4
[2025-11-15T21:59:30.650Z] Remaining: 1
[2025-11-15T21:59:30.650Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.650Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.654Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.654Z] Request URL: /auth/login
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.654Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.654Z] X-Test-ID header: login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Will use test ID?: true
[2025-11-15T21:59:30.654Z] ‚úÖ Using test identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.654Z] Got identifier from getClientIdentifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.654Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.654Z] Identifier: test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] üìñ Found existing entry for key: login:test:login-excessive-1763243968669-gr9c9
[2025-11-15T21:59:30.654Z] Existing timestamps: 5
[2025-11-15T21:59:30.654Z] Current count after filter: 5
[2025-11-15T21:59:30.654Z] Max requests allowed: 5
[2025-11-15T21:59:30.654Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:30.654Z] Current count: 5
[2025-11-15T21:59:30.654Z] Max allowed: 5
[2025-11-15T21:59:30.654Z] Retry after (seconds): 59
[2025-11-15T21:59:30.654Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:30.654Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244028983,
  "retryAfter": 59
}
[2025-11-15T21:59:30.664Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.664Z] Request URL: /auth/login
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.664Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.664Z] X-Test-ID header: perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Will use test ID?: true
[2025-11-15T21:59:30.664Z] ‚úÖ Using test identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.664Z] Got identifier from getClientIdentifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.664Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.664Z] Identifier: test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] üìù Creating new entry for key: login:test:perf-test-1763243970662-4b4ts4
[2025-11-15T21:59:30.664Z] Current count after filter: 0
[2025-11-15T21:59:30.664Z] Max requests allowed: 5
[2025-11-15T21:59:30.664Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.664Z] New count: 1
[2025-11-15T21:59:30.664Z] Remaining: 4
[2025-11-15T21:59:30.664Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.664Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244030664
}
[2025-11-15T21:59:30.668Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.668Z] Request URL: /auth/login
[2025-11-15T21:59:30.668Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.668Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.668Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Will use test ID?: true
[2025-11-15T21:59:30.669Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.669Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.669Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.669Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.669Z] Existing timestamps: 1
[2025-11-15T21:59:30.669Z] Current count after filter: 1
[2025-11-15T21:59:30.669Z] Max requests allowed: 5
[2025-11-15T21:59:30.669Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.669Z] New count: 2
[2025-11-15T21:59:30.669Z] Remaining: 3
[2025-11-15T21:59:30.669Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.669Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:30.848Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.848Z] Request URL: /auth/login
[2025-11-15T21:59:30.848Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.848Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.848Z] X-Test-ID header: headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.848Z] Will use test ID?: true
[2025-11-15T21:59:30.849Z] ‚úÖ Using test identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.849Z] Got identifier from getClientIdentifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.849Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.849Z] Identifier: test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] üìñ Found existing entry for key: login:test:headers-consistent-1763243970610-gzzehp
[2025-11-15T21:59:30.849Z] Existing timestamps: 1
[2025-11-15T21:59:30.849Z] Current count after filter: 1
[2025-11-15T21:59:30.849Z] Max requests allowed: 5
[2025-11-15T21:59:30.849Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.849Z] New count: 2
[2025-11-15T21:59:30.849Z] Remaining: 3
[2025-11-15T21:59:30.850Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.850Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244030612
}
[2025-11-15T21:59:30.881Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.887Z] Request URL: /auth/login
[2025-11-15T21:59:30.887Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.887Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.888Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.888Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.888Z] Will use test ID?: true
[2025-11-15T21:59:30.889Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.889Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.889Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.889Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:30.889Z] Existing timestamps: 4
[2025-11-15T21:59:30.889Z] Current count after filter: 4
[2025-11-15T21:59:30.889Z] Max requests allowed: 5
[2025-11-15T21:59:30.890Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.890Z] New count: 5
[2025-11-15T21:59:30.890Z] Remaining: 0
[2025-11-15T21:59:30.890Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.890Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244029943
}
[2025-11-15T21:59:30.909Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:30.909Z] Request URL: /auth/login
[2025-11-15T21:59:30.909Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:30.910Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:30.910Z] X-Test-ID header: headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Will use test ID?: true
[2025-11-15T21:59:30.910Z] ‚úÖ Using test identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:30.910Z] Got identifier from getClientIdentifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:30.910Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:30.910Z] Identifier: test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.910Z] Key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] üìñ Found existing entry for key: login:test:headers-remaining-1763243970281-2u8ob
[2025-11-15T21:59:30.911Z] Existing timestamps: 2
[2025-11-15T21:59:30.911Z] Current count after filter: 2
[2025-11-15T21:59:30.911Z] Max requests allowed: 5
[2025-11-15T21:59:30.911Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:30.911Z] New count: 3
[2025-11-15T21:59:30.911Z] Remaining: 2
[2025-11-15T21:59:30.911Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:30.911Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244030284
}
[2025-11-15T21:59:31.137Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:31.137Z] Request URL: /auth/login
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.138Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.138Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] Will use test ID?: true
[2025-11-15T21:59:31.138Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.138Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.139Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.139Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:31.139Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] üìñ Found existing entry for key: login:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.139Z] Existing timestamps: 5
[2025-11-15T21:59:31.139Z] Current count after filter: 5
[2025-11-15T21:59:31.139Z] Max requests allowed: 5
[2025-11-15T21:59:31.140Z] üö´ RATE LIMIT EXCEEDED!
[2025-11-15T21:59:31.140Z] Current count: 5
[2025-11-15T21:59:31.140Z] Max allowed: 5
[2025-11-15T21:59:31.140Z] Retry after (seconds): 59
[2025-11-15T21:59:31.140Z] === RATE LIMIT: checkRateLimit END (BLOCKED) ===
[2025-11-15T21:59:31.140Z] checkRateLimit result: {
  "allowed": false,
  "remaining": 0,
  "resetAt": 1763244029943,
  "retryAfter": 59
}
[2025-11-15T21:59:31.150Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:31.150Z] Request URL: /auth/register
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:31.151Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:31.151Z] X-Test-ID header: independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] Will use test ID?: true
[2025-11-15T21:59:31.151Z] ‚úÖ Using test identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:31.151Z] Got identifier from getClientIdentifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.151Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:31.151Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:31.152Z] Identifier: test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] üìù Creating new entry for key: register:test:independent-endpoints-1763243969939-hnyonn
[2025-11-15T21:59:31.152Z] Current count after filter: 0
[2025-11-15T21:59:31.152Z] Max requests allowed: 3
[2025-11-15T21:59:31.152Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:31.152Z] New count: 1
[2025-11-15T21:59:31.152Z] Remaining: 2
[2025-11-15T21:59:31.153Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:31.153Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244031151
}
[2025-11-15T21:59:34.064Z] üîí withRateLimit CALLED for endpoint: register
[2025-11-15T21:59:34.065Z] Request URL: /auth/register
[2025-11-15T21:59:34.065Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.065Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.065Z] X-Test-ID header: null
[2025-11-15T21:59:34.065Z] Will use test ID?: false
[2025-11-15T21:59:34.066Z] ‚ö†Ô∏è Using fallback: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.066Z] Got identifier from getClientIdentifier: unknown
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.066Z] Config: {
  "keyPrefix": "register",
  "maxRequests": 3,
  "windowMs": 60000
}
[2025-11-15T21:59:34.066Z] Identifier: unknown
[2025-11-15T21:59:34.066Z] Key: register:unknown
[2025-11-15T21:59:34.066Z] üìñ Found existing entry for key: register:unknown
[2025-11-15T21:59:34.066Z] Existing timestamps: 1
[2025-11-15T21:59:34.066Z] Current count after filter: 1
[2025-11-15T21:59:34.066Z] Max requests allowed: 3
[2025-11-15T21:59:34.066Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.066Z] New count: 2
[2025-11-15T21:59:34.066Z] Remaining: 1
[2025-11-15T21:59:34.066Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.066Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244028498
}
[2025-11-15T21:59:34.942Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:34.943Z] Request URL: /auth/verify-email
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:34.943Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:34.943Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Will use test ID?: true
[2025-11-15T21:59:34.943Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:34.943Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:34.943Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:34.943Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] üìù Creating new entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:34.943Z] Current count after filter: 0
[2025-11-15T21:59:34.943Z] Max requests allowed: 5
[2025-11-15T21:59:34.943Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:34.943Z] New count: 1
[2025-11-15T21:59:34.943Z] Remaining: 4
[2025-11-15T21:59:34.943Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:34.943Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 4,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.253Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.253Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.253Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.253Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.254Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.254Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Will use test ID?: true
[2025-11-15T21:59:35.254Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.254Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.254Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.254Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.254Z] Existing timestamps: 1
[2025-11-15T21:59:35.254Z] Current count after filter: 1
[2025-11-15T21:59:35.254Z] Max requests allowed: 5
[2025-11-15T21:59:35.254Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.254Z] New count: 2
[2025-11-15T21:59:35.254Z] Remaining: 3
[2025-11-15T21:59:35.254Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.255Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 3,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.625Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.626Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.626Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.626Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Will use test ID?: true
[2025-11-15T21:59:35.626Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.626Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.626Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.626Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.626Z] Existing timestamps: 2
[2025-11-15T21:59:35.626Z] Current count after filter: 2
[2025-11-15T21:59:35.626Z] Max requests allowed: 5
[2025-11-15T21:59:35.626Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.626Z] New count: 3
[2025-11-15T21:59:35.626Z] Remaining: 2
[2025-11-15T21:59:35.626Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.626Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 2,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:35.975Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:35.975Z] Request URL: /auth/verify-email
[2025-11-15T21:59:35.975Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:35.975Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:35.976Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Will use test ID?: true
[2025-11-15T21:59:35.976Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:35.976Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:35.976Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:35.976Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:35.976Z] Existing timestamps: 3
[2025-11-15T21:59:35.976Z] Current count after filter: 3
[2025-11-15T21:59:35.976Z] Max requests allowed: 5
[2025-11-15T21:59:35.976Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:35.976Z] New count: 4
[2025-11-15T21:59:35.976Z] Remaining: 1
[2025-11-15T21:59:35.976Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:35.976Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 1,
  "resetAt": 1763244034943
}
[2025-11-15T21:59:36.274Z] üîí withRateLimit CALLED for endpoint: login
[2025-11-15T21:59:36.274Z] Request URL: /auth/verify-email
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier START ===
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (process.env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (env): true
[2025-11-15T21:59:36.275Z] E2E_TEST_MODE (final): true
[2025-11-15T21:59:36.275Z] X-Test-ID header: rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Will use test ID?: true
[2025-11-15T21:59:36.275Z] ‚úÖ Using test identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: getClientIdentifier END ===
[2025-11-15T21:59:36.275Z] Got identifier from getClientIdentifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] === RATE LIMIT: checkRateLimit START ===
[2025-11-15T21:59:36.275Z] Config: {
  "keyPrefix": "login",
  "maxRequests": 5,
  "windowMs": 60000
}
[2025-11-15T21:59:36.275Z] Identifier: test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.275Z] Key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] üìñ Found existing entry for key: login:test:rate-limit-test-1763243972814
[2025-11-15T21:59:36.276Z] Existing timestamps: 4
[2025-11-15T21:59:36.276Z] Current count after filter: 4
[2025-11-15T21:59:36.276Z] Max requests allowed: 5
[2025-11-15T21:59:36.276Z] ‚úÖ Request allowed, recorded timestamp
[2025-11-15T21:59:36.276Z] New count: 5
[2025-11-15T21:59:36.276Z] Remaining: 0
[2025-11-15T21:59:36.276Z] === RATE LIMIT: checkRateLimit END (ALLOWED) ===
[2025-11-15T21:59:36.276Z] checkRateLimit result: {
  "allowed": true,
  "remaining": 0,
  "resetAt": 1763244034943
}
